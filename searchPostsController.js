(window.webpackJsonpUnataWidgets=window.webpackJsonpUnataWidgets||[]).push([[39],{"5b197bc3371f9ba3fe83":function(e,t,s){"use strict";s.r(t);var n=s("46f8f4ccfe1b73ca4d0c"),a=s.n(n),o=s("2befd5a067fda4f72081");function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class i{constructor(e){r(this,"searchContent",async(e,t,s)=>{const n=encodeURIComponent(e),a=await o.v.fetchWithTimeout(`${this.apiUrl}${this.apiEndpoint}/${n}?limit=${s}&offset=${t*s}`,this.requestHeaders);return this.formatResponse(a)}),r(this,"formatResponse",async e=>{const t=await e.json(),s=t.items.map(this.formatSearchResult),{itemCount:n}=t;return{items:s,itemCount:n}}),r(this,"formatSearchResult",e=>e);const t=o.e.selectors.getConfig();this.apiUrl=e.url||t.dotComModule.url,this.apiEndpoint=e.endpoint||"/search",this.requestHeaders={"Content-Type":"application/json"}}}const c=()=>s("ab7b8b884519dd255423");function l(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function h(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var u={BaseContentSearch:i,TheFreshMarketContentSearch:class extends i{constructor(e){super(e),l(this,"formatSearchResult",e=>({link:e.id,excerpt:e.fields.description,thumbnail:e.fields.search_thumbnail?e.fields.search_thumbnail:c(),title:e.fields.title,type:e.fields.category})),l(this,"searchContent",async(e,t,s)=>{const n=encodeURIComponent(e),a=await o.v.fetchWithTimeout(`${this.apiUrl}${this.apiEndpoint}?search_term=${n}&limit=${s}&offset=${t*s}&max_results=${this.maxResults}`,this.requestHeaders);return this.formatResponse(a)}),l(this,"formatResponse",async e=>{const t=await e.json();return{items:t.hits?t.hits.map(this.formatSearchResult):[],itemCount:t.found>this.maxResults?this.maxResults:t.found}}),this.maxResults=e.maxResults||50}},WordPressContentSearch:class extends i{constructor(e){super(e),h(this,"formatSearchResult",e=>(e.excerpt=this.formatContent(e.excerpt),e.thumbnail?e.thumbnail:e.thumbnail=c(),e)),h(this,"formatContent",e=>e.replace(/<\/?p[^>]*>/g,"")),this.apiEndpoint=e.endpoint||"/wp-json/unata/v2/search"}}};t.default=a.a.module("SearchPostsControllerModule",[]).controller("SearchPostsController",["$interval","$scope","$state","$stateParams","config","filterModalService","lang","mobileService","searchService",function(e,t,s,n,a,o,r,i,c){t.enableFacetedSearchFilters=a.enableFacetedSearchFilters,t.config=a,t.state=s,t.term=n.search_term,t.mobile=i,t.skeletonPosts=[];const l=new u[a.contentSearchService.class](a.contentSearchService.props);t.contentSearchPagination={currentPage:1,limit:a.dotComModule.searchPostsPerPage},t.thumbnailImages={},t.changePage=()=>{t.getContentSearchResults(),t.skeletonPosts=[],delete t.posts},t.$on("$stateChangeStart",()=>{t.loading=!0,delete t.posts}),t.hideSideNav=!0,t.getContentSearchResults=async()=>{const s=e(()=>{t.posts&&t.posts.length||t.skeletonPosts.length>=5?e.cancel(s):t.skeletonPosts.push({})},500),n=await l.searchContent(t.term,t.contentSearchPagination.currentPage-1,t.contentSearchPagination.limit);t.searchTotalLength=n.itemCount,t.searchContentResults=n.items},t.getContentSearchResults(),t.getPageHeaderResults=()=>t.searchContentResults?`${t.searchTotalLength?t.searchTotalLength:r.values.no} ${r.values.resultsFor}"${t.term}"`:"",t.openFilterModal=function(){o.open({content:"Content",isSearch:!0}).then(({content:e})=>{const t=c.getTypeBy(e);t&&s.go(t.state)})}}])}}]);