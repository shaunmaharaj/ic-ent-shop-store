(window.webpackJsonpUnataWidgets=window.webpackJsonpUnataWidgets||[]).push([[40],{"323046ecaa1a4d6f1b2c":function(e,t,a){var r=a("f2ef6f6e544aad97aa22");e.exports=function(){if(!arguments.length)return[];var e=arguments[0];return r(e)?e:[e]}},"35797e682401ecb33f05":function(e,t,a){"use strict";a.r(t);var r=a("f2ef6f6e544aad97aa22"),s=a.n(r),c=a("323046ecaa1a4d6f1b2c"),n=a.n(c),o=a("46f8f4ccfe1b73ca4d0c"),l=a.n(o);t.default=l.a.module("SearchRecipesControllerModule",[]).controller("SearchRecipesController",["$filter","$scope","$state","Restangular","analytics","config","facetedFilterModalService","filterModalService","lang","recipeCategories","recipeTags","searchCategories","searchService",function(e,t,a,r,c,o,l,i,g,u,p,d,h){t.enableFacetedSearchFilters=o.enableFacetedSearchFilters,t.term=a.params.search_term||"",t.page={current:a.params.page||1},t.config=o,t.filterTags=p,t.resetFacets=()=>{a.go(".",{page:null,tags:null,category_id:null})},t.shouldShowSeeAll=()=>a.params.category_id,t.categoryFacets=d;const f=u.flatMap(e=>e.id);if(t.rootCategoryFacets=t.categoryFacets.filter(e=>f.includes(e.id.toString())),a.params.category_id){const e=a.params.category_id,r=new Set(Array.isArray(e)?e:[e]);t.rootCategoryFacets=t.rootCategoryFacets.filter(({id:e})=>r.has(e))}const m=({content:e,tags:t})=>{const r=h.getTypeBy(e);r&&a.go(r.state,{tags:t})};t.openFacetedFilterModal=function(){l.open({content:"Recipes",tagOptions:t.filterTags,facetOptions:t.filterTags,sort:a.params.sort,tags:n()(a.params.tags||[]),searchTerm:null,isSearch:!0,showSort:!1}).then(m)},t.searchContext="recipes",t.tags=s()(a.params.tags)?a.params.tags:[a.params.tags],t.hideFacets=!0,t.$watch("page.current",(e,t)=>{t&&e!==t&&a.go(".",{page:e})}),t.getSearchResultsText=()=>t.results&&t.results.item_count?g.templateAsString(g.values.resultsForTerm,{count:t.results.item_count,label:e("pluralize")("result",t.results.item_count),searchTerm:t.term}):t.results&&0===t.results.item_count?g.templateAsString(g.values.nothingFound,{searchResult:t.term}):g.templateAsString(g.values.searchingFor,{searchTerm:t.term}),t.getPageHeaderResults=()=>t.getSearchResultsText(),t.loadResults=()=>{t.loadingResults=!0;const e={search_term:a.params.search_term,offset:t.page.current?(t.page.current-1)*o.productsPerPage:0,limit:o.productsPerPage,tags:a.params.tags,recipe_category_id:a.params.category_id},s=h.getSnrid();r.all("recipes").getList(e,{"X-Snr-Id":s}).then(e=>{t.loadingResults=!1,t.results=e,c.logSegmentEvent("search.recipe_search_results",{snrid:s,search_value:t.term,search_results_count:e.length,search_results:c.getRecipeListAnalytics(e,e.snrid),search_results_page:t.page.current})})},t.openFilterModal=function(){i.open({content:"Recipes",isSearch:!0}).then(({content:e})=>{const t=h.getTypeBy(e);t&&a.go(t.state)})},t.filterCategory=function(e){a.go(".",{category_id:e,page:null})}}])}}]);