(window.webpackJsonpUnataWidgets=window.webpackJsonpUnataWidgets||[]).push([[29],{"26d2db85cfb3a6b67744":function(e,r,a){"use strict";a.r(r);var t=a("46f8f4ccfe1b73ca4d0c"),o=a.n(t),s=a("45cec0a70e71322cebfa");r.default=o.a.module("OrderAddOnControllerModule",[]).controller("OrderAddOnController",["$rootScope","$scope","$state","$stateParams","Restangular","analytics","config","lang","mobileService","utilService",function(e,r,a,t,o,c,l,n,d,i){var u;const g=Object.assign(this,(null===(u=a.current.data)||void 0===u?void 0:u.vmExtras)||{});g.order=g.order||t.order,g.isLoading=()=>{var e,r;return null===(e=a.current.data)||void 0===e||null===(r=e.vmExtras)||void 0===r?void 0:r.isLoading},g.config=l,g.lang=n,g.mobile=d,g.productsPerPage=12,r.page={current:t.page||1},g.search={results:[],term:t.search_term||"",loading:!1},g.getResults=()=>{var e,r,t;return g.isLoading()||g.search.loading?[]:(null===(e=g.search.results)||void 0===e?void 0:e.length)>0?g.search.results:g.search.term?void 0:(null===(r=a.current.data)||void 0===r||null===(t=r.vmExtras)||void 0===t?void 0:t.upsellResults)||[]},g.setSearchingTo=e=>{g.searching=e,g.searching||(g.focusSearchBar=!1,g.inListOrCartPage&&(g.hideSearch=!0,g.showSearchFromClick=!1))},g.focusSearch=function(){g.focusSearchBar=!0,g.searching=!0,g.hideSearch=!1,g.inListOrCartPage&&(g.showSearchFromClick=!0)},g.timeslotLabelFn=()=>s.utils.getMainLabel(g.order,{verboseLevel:1,format:g.config.apiDateFormat});r.$watch("page.current",(e,r)=>{r&&e!==r&&(i.scrollToTop(),a.go(".",{page:e}))}),(()=>{g.search.loading=!0;const e={search_term:t.search_term,page:null,offset:r.page.current&&r.page.current?(r.page.current-1)*g.productsPerPage:0,limit:g.productsPerPage,sort:"rank",store_id:g.order.store.id,delivery_postal_code:g.order.delivery_address.postal_code,fulfillment_type:g.order.fulfillment_type,order_id:g.order.id};o.all("store_products").getList(e).then(e=>{g.search.loading=!1,g.search.results=e,c.logEvent("search results","search",g.term,e.length)})})()}]).run(["$templateCache",e=>{e.put("orderAddOn.html",a("3676dce91b5dd3b45b42"))}])}}]);