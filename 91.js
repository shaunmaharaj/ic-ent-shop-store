(window.webpackJsonpUnataWidgets=window.webpackJsonpUnataWidgets||[]).push([[91],{db9dc257337d7e500f37:function(t,e,n){"use strict";n.r(e);var i=n("8af190b70a6bc55c6f1b"),o=n("2befd5a067fda4f72081"),a=n("30b94d4dc013151d5bc2"),r=n("c72272a7287d0d0d7bf8");let s,c,l;!function(t){t.ORDER_PLACED="orderPlaced",t.IN_PROGRESS="inProgress",t.ORDER_COMPLETE="orderComplete",t.CANCELLED_STAGE="orderCancelled"}(s||(s={})),function(t){t.SUCCESS="success",t.ERROR="error"}(c||(c={})),function(t){t.SMALL="small",t.REGULAR="regular",t.LARGE="large"}(l||(l={}));const d=[s.ORDER_PLACED,s.IN_PROGRESS,s.ORDER_COMPLETE],u={authapproved:s.IN_PROGRESS,autherror:s.IN_PROGRESS,authrequest:s.IN_PROGRESS,cancelled:s.CANCELLED_STAGE,done:s.ORDER_COMPLETE,inprogress:s.IN_PROGRESS,loaded:s.IN_PROGRESS,new:s.ORDER_PLACED,shipped:s.ORDER_COMPLETE,unassigned:s.IN_PROGRESS},b=[s.ORDER_PLACED,s.IN_PROGRESS];var g=n("9a0b4e03ea3c43527074");const p=Object(r.hb)(t=>{const e=r.pb.mediaQuery.minWidth(t.breakpoint.small),n=t.color.brand.primary.regular,i=t.color.neutral.grey3,o=t.color.neutral.grey4;return{container:{display:"flex",width:"100%",height:"100%",padding:"0 2.5%",flexDirection:"column",alignItems:"flex-start",justifyContent:"flex-start",[e]:{padding:"0 15%",flexDirection:"row",alignItems:"center",justifyContent:"center"}},item:{base:{flex:"1 0 auto",display:"block",fontSize:t.size.font.body,color:o,":last-child":{flex:"0 1 auto"}},active:{color:n},current:{color:n}},dot:{base:{background:i,position:"absolute",zIndex:1,width:8,height:8,borderRadius:t.border.radius.circle,display:"inline-block",float:"left",marginTop:-3,marginLeft:-3,[e]:{marginLeft:0}},active:{background:n},current:{transition:r.pb.toMs`all 0ms ease-out ${t.animation.speed.slow-50}`,background:n}},line:{base:{display:"block",width:2,height:"100%",background:`linear-gradient(to bottom, ${n} 50%, ${i} 50%)`,backgroundSize:"100% 200%",backgroundPosition:"right bottom",[e]:{width:"100%",height:2,background:`linear-gradient(to right, ${n} 50%, ${i} 50%)`,backgroundSize:"200% 100%",backgroundPosition:"right top"}},active:{backgroundPosition:"left top",[e]:{backgroundPosition:"left bottom"}},prior:{transition:r.pb.toMs`all ${t.animation.speed.slow} ease-out`},current:{}},text:{position:"absolute",marginLeft:t.size.spacing.small,transform:"translate(0, -50%)",marginTop:0,textAlign:"left",[e]:{marginLeft:0,transform:"translate(-50%, 0)",marginTop:t.size.spacing.small,textAlign:"center"}}}}),m=t=>{const{stage:e}=t,n=p(t),i=o.e.selectors.getConfig().lang.orderTracker.orderProgress,a=d.indexOf(e);return Object(g.b)("div",{"data-test":"orderProgress",css:n.container,children:d.map((t,e)=>Object(g.c)("span",{"data-test":`stageLabel-${t}`,"aria-current":e===a&&"step",css:[n.item.base,e<a&&n.item.active,e===a&&n.item.current],children:[Object(g.b)("span",{css:[n.dot.base,e<a&&n.dot.active,e===a&&n.dot.current]}),Object(g.b)(r.ab,{css:n.text,component:"span",children:i.label[t]}),Object(g.b)("span",{css:[n.line.base,e<a&&n.line.active,e===a-1&&n.line.prior,e===a&&n.line.current]})]},t))})};var O=Object(i.memo)(m);const h=Object(r.hb)(t=>{const e=r.pb.mediaQuery.minWidth(t.breakpoint.small);return{container:{position:"relative",background:t.color.neutral.grey1,padding:t.size.spacing.xSmall,[e]:{padding:t.size.spacing.large}},title:{fontWeight:t.font.weight.bold,fontSize:t.size.font.large,marginBottom:t.size.spacing.xxSmall,[e]:{fontSize:t.size.font.large}},description:{fontSize:t.size.font.body,[e]:{fontSize:t.size.font.body}},poweredByInstacart:{container:{position:"absolute",left:t.size.layout.xxSmall,bottom:t.size.layout.xSmall,[e]:{left:"auto",right:t.size.layout.medium}},text:{display:"inline-block",color:t.color.neutral.grey4,fontSize:t.size.font.body,fontWeight:600,textTransform:"capitalize"},image:{marginLeft:t.size.spacing.xxSmall,img:{position:"relative",top:2,height:t.size.spacing.medium}}},buttonRow:{minHeight:t.size.layout.large,marginBottom:t.size.layout.large,[e]:{marginBottom:t.size.spacing.xxxSmall}},buttonContainer:{display:"inline-block",marginTop:t.size.spacing.xSmall,marginRight:t.size.spacing.xxSmall,[e]:{marginTop:t.size.spacing.medium},button:{textTransform:"capitalize"}},buttonContainerCancel:{button:{padding:t.size.spacing.xxxSmall}}}}),f=t=>{const{stage:e,resources:n,buttonSize:i=l.REGULAR,enableOrderDetailButton:a=!0,enablePickupDetailButton:s=!0,enableModifyButton:c=!0,enableCancelButton:d=!0,enableTipsRatingButton:u=!0,showOrderDetailButton:b=!1,showPickupDetailButton:p=!1,showModifyButton:m=!1,showCancelButton:O=!1,showTipsRatingButton:f=!1,onOrderDetail:y,onPickupDetail:E,onModify:R,onCancel:S,onTipRating:C,notice:w}=t,j=h(t),P=o.e.selectors.getConfig().lang.orderTracker.orderStatus;return Object(g.c)("div",{"data-test":"orderStatus",css:j.container,children:[Object(g.b)(r.ab,{"data-test":"orderStatusTitle",css:j.title,children:P.title[e]}),Object(g.b)(r.ab,{"data-test":"orderStatusDesc",css:j.description,children:P.description[e]}),w?Object(g.b)(r.ab,{"data-test":"orderStatusNotice",css:j.description,children:w}):null,Object(g.c)("div",{"data-test":"orderStatusProvidedByInstacart",css:j.poweredByInstacart.container,children:[Object(g.c)(r.ab,{css:j.poweredByInstacart.text,children:[n.fulfillmentTypeLang," ",P.providedBy]}),Object(g.b)(r.s,{src:n.poweredByInstacart,alt:P.providedByInstacartLogoAria,"aria-hidden":"true",css:j.poweredByInstacart.image})]}),Object(g.c)("div",{css:j.buttonRow,"data-test":`button-row-${i}`,children:[m&&Object(g.b)("span",{css:j.buttonContainer,children:Object(g.b)(r.h,{"data-test":"orderModify",disabled:!c,size:i,onClick:R,children:n.modifyButtonLang||P.modifyButton})}),b&&Object(g.b)("span",{css:j.buttonContainer,children:Object(g.b)(r.h,{"data-test":"orderDetail",disabled:!a,size:i,onClick:y,children:P.viewOrderProgressButton})}),p&&Object(g.b)("span",{css:j.buttonContainer,children:Object(g.b)(r.h,{"data-test":"pickupDetail",disabled:!s,size:i,variant:"outline",onClick:E,children:P.pickupDetailsButton})}),O&&Object(g.b)("span",{css:[j.buttonContainer,j.buttonContainerCancel],children:Object(g.b)(r.h,{"data-test":"orderCancel",disabled:!d,size:i,variant:"link",color:"highlight",onClick:S,children:P.cancelButton})}),f&&Object(g.b)("span",{css:j.buttonContainer,children:Object(g.b)(r.h,{"data-test":"orderTipRating",disabled:!u,size:i,color:"secondary",onClick:C,children:P.tipsRatingButton})})]})]})};var y=Object(i.memo)(f);function E(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function R(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?E(Object(n),!0).forEach((function(e){S(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function S(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const C=Object(r.hb)(t=>{const e=r.pb.mediaQuery.minWidth(t.breakpoint.small),n=n=>({container:{width:`calc(100% - ${t.size.spacing.medium}px)`,left:t.size.spacing.medium,top:t.size.layout.xLarge,animation:r.pb.toMs`
        ${w(n)} ${1.25*t.animation.speed.slow} ease-in
      `,[e]:{width:"100%",left:0,top:0,animation:"none"}},buttonRow:{":empty":n===s.ORDER_COMPLETE?{minHeight:0}:{}}}),i=()=>{const e=n(s.CANCELLED_STAGE);return Object.assign(e.container,{animation:"none",left:0,width:`calc(100% - ${t.size.spacing.xxSmall}px)`}),e.buttonRow[":empty"]={minHeight:0},e};return{container:{position:"relative"},stageBox:{display:"block",minHeight:50,[e]:{display:"inline",minHeight:"none"}},alertBox:{marginBottom:t.size.spacing.medium},orderProgress:{container:{position:"absolute",marginTop:t.size.layout.medium,marginBottom:t.size.layout.xLarge,[e]:{position:"static"}},item:{base:{maxHeight:50,[e]:{maxHeight:"none"}},current:{maxHeight:"none"}}},orderStatuses:Object.values(s).reduce((t,e)=>R(R({},t),{},{[e]:e===s.CANCELLED_STAGE?i():n(e)}),{})}});function w(t){return Object(a.h)({"0%":{opacity:0,content:`'${t}'`},"50%":{opacity:0},"100%":{opacity:1}})}var j=t=>{var e;const{resources:n,buttonSize:a,enableOrderDetailButton:l=!0,enablePickupDetailButton:p=!0,enableModifyButton:m=!0,enableCancelButton:h=!0,enableTipsRatingButton:f=!0,initialOrderStatus:E,pollingFrequencyMs:R,onOrderDetail:S,onPickupDetail:w,onModify:j,onCancel:P,onTipRating:D,orderId:B,showOrderDetailButton:z=!0,showPickupDetailButton:x=!0,showModifyButton:k=!0,showCancelButton:v=!0,showTipsRatingButton:L=!0}=t,T=C(t),_=o.e.selectors.getConfig(),A=_.lang.orderTracker.app,I=u[E],M="number"==typeof(G=R)&&Number.isInteger(G)&&G>=0?R:6e4;var G;const[N,$]=Object(i.useState)({stage:I,timeout:M,error:Object.values(s).includes(I)?void 0:new Error(`Invalid initial: "${I}"`)});Object(i.useEffect)(()=>{if(!N.timeout)return;if(!b.includes(N.stage))return;const t=setTimeout(async()=>{try{const t=await async function(t,e){const n=await t(e),i=(null==n?void 0:n.status)&&u[n.status];if(!i)throw new Error(`Invalid stage returned by the server: "${n.status}"`);return i}(o.l.api.orders.get,B);$({stage:t,timeout:M})}catch(t){console.warn(t,`${N.timeout} ms`),$({stage:N.stage,timeout:2*N.timeout,error:t})}},N.timeout);return()=>clearTimeout(t)},[B,N,M]);const{error:H,stage:W}=N,U=W!==I&&W!==s.CANCELLED_STAGE,Q=H?c.ERROR:c.SUCCESS,q=Object.values(s).includes(W),J=d.includes(W),F=W===s.IN_PROGRESS||W===s.ORDER_COMPLETE;return Object(g.c)("div",{"data-test":"orderApp","data-stage":W,children:[H||U?Object(g.b)(r.f,{"data-test":`alert-${Q}`,variant:Q,css:T.alertBox,children:H&&A.updatingError||U&&A.updatingSuccess}):"",q&&Object(g.c)("div",{"data-test":"orderContainer",css:T.container,children:[J&&(null===(e=_.orderHistoryView)||void 0===e?void 0:e.includeOrderTrackerProgressLine)&&Object(g.b)(O,{stage:W,styles:T.orderProgress,"data-test":"orderProgress"}),J?d.map(t=>Object(g.b)("span",{css:T.stageBox,children:t===W&&Object(g.b)(y,{stage:W,resources:n,buttonSize:a,enableOrderDetailButton:l,enablePickupDetailButton:p,enableTipsRatingButton:f,enableCancelButton:h,enableModifyButton:m,onOrderDetail:S,onPickupDetail:w,onModify:j,onCancel:P,onTipRating:D,notice:W===s.ORDER_PLACED&&m&&k?A.orderPlacedModifyNotice:"",styles:T.orderStatuses[W],showOrderDetailButton:z&&F,showPickupDetailButton:x&&F,showModifyButton:k&&W===s.ORDER_PLACED,showCancelButton:v&&W===s.ORDER_PLACED,showTipsRatingButton:L&&W===s.ORDER_COMPLETE,"data-test":"orderStatus"})},t)):Object(g.b)("span",{css:T.stageBox,children:Object(g.b)(y,{stage:W,resources:n,styles:T.orderStatuses[s.CANCELLED_STAGE],"data-test":"orderStatus"})})]})]})};e.default=j}}]);