(window.webpackJsonpUnataWidgets=window.webpackJsonpUnataWidgets||[]).push([[35],{d52e7da9d72dd24d7e29:function(e,t,o){"use strict";o.r(t);var n=o("46f8f4ccfe1b73ca4d0c"),a=o.n(n),r=o("2befd5a067fda4f72081");t.default=a.a.module("RateProductsControllerModule",[]).controller("RateProductsController",["$element","$filter","$scope","$timeout","config","imageURLService","lang","mobileService",function(e,t,o,n,d,u,i,c){o.currentProductIndex=0,o.currentProduct=null,o.totalPointsAwarded=0,o.imageURLService=u,o.config=d,o.mobile=c,o.fetchProducts=function(){r.m.api.product.getAll({tags:["purchased","has_not_rated"],has_image:!1}).then(e=>{o.products=e.items,o.currentProductIndex=0,o.currentProduct=o.products[0],o.updateRemainingMessage(),o.$apply()})},o.fetchProducts(),o.nextProduct=function(){const e=a.a.element(document.querySelector(".rate-products-stack"));e.addClass("out"),n(()=>{e.removeClass("out"),o.currentProductIndex++,o.currentProduct=o.products[o.currentProductIndex],o.updateRemainingMessage()},500)},o.updateRemainingMessage=function(){o.remaining=o.products.length-o.currentProductIndex,o.message=i.template(i.values.ratingsRemaining,{remaining:o.remaining,pluralizedItem:t("pluralize")(i.values.item,o.remaining)})},o.onRate=function(e){if(e.points&&e.points.awarded){const n=e.points.awarded,a=e.points.balance;o.totalPointsAwarded+=n,o.message=i.template(i.values.pointsAdded,{points:n,pluralizedPoint:t("pluralize")(i.values.point,n),total:a,pluralizedPointTotal:t("pluralize")(i.values.point,a)})}},o.mode="",o.mode=function(){o.products&&0==o.products.length&&(o.mode="empty"),o.products||(o.mode="loading"),o.products&&o.products.length>0&&o.currentProductIndex<o.products.length&&(o.mode="rating"),o.products&&o.products.length>0&&o.currentProductIndex==o.products.length&&(o.mode="done")},o.$watch(o.mode),o.totalPointsMessage=function(){return i.template(i.values.totalPointsAwarded,{total:o.totalPointsAwarded,pluralizedPoint:t("pluralize")(i.values.point,o.totalPointsAwarded),loyaltyCard:i.values.loyaltyCard})}}])}}]);