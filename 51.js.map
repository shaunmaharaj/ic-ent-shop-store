{"version":3,"sources":["webpack://UnataWidgets/./app/angular/components/recipes/cookingModeModal.html","webpack://UnataWidgets/./app/angular/optionalComponents/wegpay/wegpayPaymentForm.html","webpack://UnataWidgets/./app/angular/components/reservation/views/reservationConfirmation.html","webpack://UnataWidgets/./app/angular/components/shared/storeList/storeList.html","webpack://UnataWidgets/./app/angular/components/icExpress/views/expressPlansModal.html","webpack://UnataWidgets/./app/angular/components/shared/storesMap/storesMap.html","webpack://UnataWidgets/./app/angular/components/shared/loyaltyPlacement/loyaltyPlacement.html","webpack://UnataWidgets/./app/angular/components/shared/notificationSettings/notificationSettingsTable.html","webpack://UnataWidgets/./app/angular/components/productDetails/productDetailsMainContent.html","webpack://UnataWidgets/./app/angular/components/shared/errorModal/errorModal.html","webpack://UnataWidgets/./app/angular/components/sideCart/sideCartListItem.html","webpack://UnataWidgets/./app/angular/components/checkout/views/checkoutConfirmation.html","webpack://UnataWidgets/./frontend-config/the-garden/config/components.js","webpack://UnataWidgets/./app/utils/sleep.ts","webpack://UnataWidgets/./app/utils/preloadCheckoutPage.ts","webpack://UnataWidgets/./app/utils/mobileApp/fixCapacitorCookies.ts","webpack://UnataWidgets/./app/angular/constants/httpErrors.js","webpack://UnataWidgets/./app/angular/components/errorPages/errorPages.js","webpack://UnataWidgets/./app/angular/components/errorPages/index.js","webpack://UnataWidgets/./app/angular/components/account/addressBook/addressBookRoutes.js","webpack://UnataWidgets/./app/angular/components/account/credits/creditsRoutes.js","webpack://UnataWidgets/./app/angular/components/account/lists/listRoutes.js","webpack://UnataWidgets/./app/angular/components/account/loyalty/loyaltyRoutes.js","webpack://UnataWidgets/./app/angular/constants/authActions.ts","webpack://UnataWidgets/./app/angular/components/account/nav/accountMenuService.js","webpack://UnataWidgets/./app/angular/components/account/nav/accountRoutes.js","webpack://UnataWidgets/./app/angular/components/account/notifications/notificationsRoutes.js","webpack://UnataWidgets/./app/angular/constants/instacart.js","webpack://UnataWidgets/./app/angular/constants/orders.js","webpack://UnataWidgets/./app/angular/constants/cart.js","webpack://UnataWidgets/./app/angular/constants/payments.js","webpack://UnataWidgets/./app/angular/components/account/orderHistory/orderController.js","webpack://UnataWidgets/./app/angular/components/account/orderHistory/orderHistoryController.js","webpack://UnataWidgets/./app/angular/constants/uom.js","webpack://UnataWidgets/./app/angular/components/account/orderHistory/orderEditItemController.js","webpack://UnataWidgets/./app/angular/constants/alcoholValidation.js","webpack://UnataWidgets/./app/angular/components/account/orderHistory/orderIcRedirectController.js","webpack://UnataWidgets/./app/angular/components/account/orderHistory/purchaseController.js","webpack://UnataWidgets/./app/angular/components/account/orderHistory/orderHistoryRoutes.js","webpack://UnataWidgets/./app/angular/components/account/passwordChange/passwordChangeRoutes.js","webpack://UnataWidgets/./app/angular/components/account/priceAlerts/priceAlertsRoutes.js","webpack://UnataWidgets/./app/angular/components/account/profile/profileRoutes.js","webpack://UnataWidgets/./app/angular/components/account/rateProducts/rateProductsRoutes.js","webpack://UnataWidgets/./app/angular/components/account/subscription/subscriptionsRoutes.js","webpack://UnataWidgets/./app/angular/components/account/substitutions/substitutionsRoutes.js","webpack://UnataWidgets/./app/angular/components/account/snapEBT/snapEBTAddModalController.js","webpack://UnataWidgets/./app/angular/components/account/snapEBT/snapEbtRemoveModalController.js","webpack://UnataWidgets/./app/angular/components/account/snapEBT/snapEBTRoutes.js","webpack://UnataWidgets/./app/angular/components/account/index.js","webpack://UnataWidgets/./app/angular/components/addressValidation/addressValidationModalController.js","webpack://UnataWidgets/./app/angular/constants/address.js","webpack://UnataWidgets/./app/angular/components/addressValidation/addressValidationService.js","webpack://UnataWidgets/./app/angular/components/addressValidation/index.js","webpack://UnataWidgets/./app/angular/components/alert/alert.js","webpack://UnataWidgets/./app/angular/components/alert/index.js","webpack://UnataWidgets/./app/angular/components/carousel/carousel.js","webpack://UnataWidgets/./app/angular/components/carousel/index.js","webpack://UnataWidgets/./app/angular/components/chat/chatIntegration.js","webpack://UnataWidgets/./app/angular/components/chat/index.js","webpack://UnataWidgets/./app/angular/components/checkout/paymentGateways/default/defaultPaymentsService.js","webpack://UnataWidgets/./app/angular/components/checkout/paymentGateways/payPal/paypalPaymentService.js","webpack://UnataWidgets/./app/angular/components/checkout/paymentGateways/houseAccount/houseAccountPaymentService.js","webpack://UnataWidgets/./app/angular/components/checkout/paymentGateways/houseAccount/houseAccountController.js","webpack://UnataWidgets/./app/angular/services/reflect.js","webpack://UnataWidgets/./app/angular/services/modules/analytics/analyticsHelper.service.js","webpack://UnataWidgets/./app/angular/services/modules/analytics/analyticsConstants.js","webpack://UnataWidgets/./app/angular/services/modules/tokens.js","webpack://UnataWidgets/./app/angular/components/checkout/checkoutCartController.js","webpack://UnataWidgets/./app/angular/components/checkout/checkoutConfirmationController.js","webpack://UnataWidgets/./app/angular/components/checkout/checkoutManualUpsellController.js","webpack://UnataWidgets/./app/angular/components/checkout/checkoutPageController.js","webpack://UnataWidgets/./app/angular/components/checkout/checkoutPaymentController.js","webpack://UnataWidgets/./app/angular/components/reservation/reservationController.js","webpack://UnataWidgets/./app/angular/components/reservation/fulfillmentAddressController.js","webpack://UnataWidgets/./app/angular/components/reservation/reservationConfirmationController.js","webpack://UnataWidgets/./app/angular/components/checkout/checkout.js","webpack://UnataWidgets/./app/angular/components/checkout/fulfillmentList/fulfillmentList.js","webpack://UnataWidgets/./app/angular/components/checkout/totals/cartTotals.js","webpack://UnataWidgets/./app/angular/components/checkout/paymentGateways/paymentGatewayService.js","webpack://UnataWidgets/./app/angular/components/checkout/index.js","webpack://UnataWidgets/./app/angular/components/checkoutSteps/checkoutSteps.js","webpack://UnataWidgets/./app/angular/components/checkoutSteps/index.js","webpack://UnataWidgets/./app/angular/components/collections/productCollection.js","webpack://UnataWidgets/./app/angular/components/collections/index.js","webpack://UnataWidgets/./app/angular/components/compareCart/compareCart.component.js","webpack://UnataWidgets/./app/angular/components/compareCart/compareCart.routes.js","webpack://UnataWidgets/./app/angular/components/compareCart/compareCartModal.controller.js","webpack://UnataWidgets/./app/angular/components/compareCart/compareCartService.js","webpack://UnataWidgets/./app/angular/components/compareCart/index.js","webpack://UnataWidgets/./app/angular/components/externalPage/externalPageRoutes.js","webpack://UnataWidgets/./app/angular/components/externalPage/index.js","webpack://UnataWidgets/./app/angular/components/flyerPreview/flyerPreviewModal.controller.js","webpack://UnataWidgets/./app/angular/components/flyerPreview/flyerPreview.component.js","webpack://UnataWidgets/./app/angular/components/flyerPreview/index.js","webpack://UnataWidgets/./app/angular/components/footer/footerController.js","webpack://UnataWidgets/./app/angular/components/footer/index.js","webpack://UnataWidgets/./app/utils/appendMetaTagDescription.js","webpack://UnataWidgets/./app/angular/components/home/homeRoutes.js","webpack://UnataWidgets/./app/angular/constants/personalizationLoading.js","webpack://UnataWidgets/./app/angular/components/shared/categoryCard/categoryCard.js","webpack://UnataWidgets/./app/angular/components/shared/categoryCard/index.js","webpack://UnataWidgets/./app/angular/components/home/index.js","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressRoutes.js","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressCancellation/steps/firstStep.js","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressCancellation/steps/secondStep.js","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressCancellation/steps/thirdStep.js","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressCancellation/steps/forthStep.js","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressCancellation/icExpressCancellation.js","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressCancellation/index.js","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressProfilePageController.js","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressProfile/icExpressProfile.js","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressProfile/index.js","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressSignin/icExpressSignin.js","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressSignin/index.js","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressAd/icExpressAd.js","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressAd/index.js","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressCheckout/icExpressCheckout.js","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressCheckout/index.js","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressEntry/icExpressEntry.js","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressEntry/index.js","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressForm/icExpressForm.js","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressForm/index.js","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressPopover/icExpressPopover.js","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressPopover/index.js","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressPostCheckout/icExpressPostCheckout.js","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressPostCheckout/index.js","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressSideCart/icExpressSideCart.js","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressSideCart/index.js","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressTimeslot/icExpressTimeslot.js","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressTimeslot/index.js","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressPlans/icExpressPlans.js","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressPlans/index.js","webpack://UnataWidgets/./app/angular/components/icExpress/IcExpressPostCheckoutCreditCardPageController.js","webpack://UnataWidgets/./app/angular/components/icExpress/index.js","webpack://UnataWidgets/./app/angular/components/icFulfillmentBanner/icFulfillmentBanner.js","webpack://UnataWidgets/./app/angular/components/icFulfillmentBanner/index.js","webpack://UnataWidgets/./app/angular/components/importIcAccount/importIcAccountService.js","webpack://UnataWidgets/./app/angular/components/importIcAccount/index.js","webpack://UnataWidgets/./app/angular/components/instacartCustomerLink/instacartCustomerLinkConfirm.js","webpack://UnataWidgets/./app/angular/components/instacartCustomerLink/instacartCustomerLinkHeader.js","webpack://UnataWidgets/./app/angular/components/instacartCustomerLink/instacartCustomerLinkInput.js","webpack://UnataWidgets/./app/angular/components/instacartCustomerLink/instacartCustomerLinkModalController.js","webpack://UnataWidgets/./app/angular/components/instacartCustomerLink/instacartCustomerLinkService.js","webpack://UnataWidgets/./app/angular/components/instacartCustomerLink/instacartCustomerLinkModalService.js","webpack://UnataWidgets/./app/angular/components/instacartCustomerLink/instacartCustomerLinkNotify.js","webpack://UnataWidgets/./app/angular/components/instacartCustomerLink/instacartCustomerLinkRoutes.js","webpack://UnataWidgets/./app/angular/components/instacartCustomerLink/instacartCustomerLinkSubheader.js","webpack://UnataWidgets/./app/angular/components/instacartCustomerLink/index.js","webpack://UnataWidgets/./app/angular/components/inStoreList/inStoreListRoutes.js","webpack://UnataWidgets/./app/angular/components/inStoreList/index.js","webpack://UnataWidgets/./app/angular/constants/loyaltyOnboarding.js","webpack://UnataWidgets/./app/angular/components/loyaltyOnboarding/controllers/loyaltyOnboardingModalController.js","webpack://UnataWidgets/./app/angular/components/loyaltyOnboarding/loyaltyOnboardingService.js","webpack://UnataWidgets/./app/angular/components/loyaltyOnboarding/index.js","webpack://UnataWidgets/./app/angular/components/maintenance/maintenance.js","webpack://UnataWidgets/./app/angular/components/maintenance/index.js","webpack://UnataWidgets/./app/angular/components/modifyOrderBanner/modifyOrderBanner.js","webpack://UnataWidgets/./app/angular/components/modifyOrderBanner/index.js","webpack://UnataWidgets/./app/angular/components/mobileOnboarding/mobileOnboardingModalController.js","webpack://UnataWidgets/./app/angular/components/mobileOnboarding/mobileOnboardingService.js","webpack://UnataWidgets/./app/angular/components/mobileOnboarding/index.js","webpack://UnataWidgets/./app/angular/components/nav/categoriesMenu/index.js","webpack://UnataWidgets/./app/angular/components/nav/mobileNavController.js","webpack://UnataWidgets/./app/angular/constants/navigation.js","webpack://UnataWidgets/./app/angular/components/nav/navCart.js","webpack://UnataWidgets/./app/angular/components/nav/navCartController.js","webpack://UnataWidgets/./app/angular/components/nav/navController.js","webpack://UnataWidgets/./app/angular/components/nav/searchNav.js","webpack://UnataWidgets/./app/angular/components/nav/shoppingContextIcon.js","webpack://UnataWidgets/./app/angular/components/nav/shoppingSelectorNav.js","webpack://UnataWidgets/./app/angular/components/nav/sideNavController.js","webpack://UnataWidgets/./app/angular/components/nav/storeidLabel.js","webpack://UnataWidgets/./app/angular/components/nav/registrationDropdown/firstNameLabel.js","webpack://UnataWidgets/./app/angular/components/nav/registrationDropdown/registrationDropdown.js","webpack://UnataWidgets/./app/angular/components/nav/navToggleButton/navToggleButton.js","webpack://UnataWidgets/./app/angular/components/nav/mobileHeaderHomeButton.js","webpack://UnataWidgets/./app/angular/components/nav/index.js","webpack://UnataWidgets/./app/angular/components/nav-logout-button/navLogoutButton.js","webpack://UnataWidgets/./app/angular/components/nav-logout-button/index.js","webpack://UnataWidgets/./app/angular/components/offers/offerDetailsController.js","webpack://UnataWidgets/./app/angular/components/offers/offersRoutes.js","webpack://UnataWidgets/./app/angular/components/offers/index.js","webpack://UnataWidgets/./app/angular/components/offline/offline.js","webpack://UnataWidgets/./app/angular/components/offline/offlineRoutes.js","webpack://UnataWidgets/./app/angular/components/offline/index.js","webpack://UnataWidgets/./app/angular/components/orderAddOn/orderAddOnRoutes.js","webpack://UnataWidgets/./app/angular/components/orderAddOn/index.js","webpack://UnataWidgets/./app/angular/components/payments/stripe/stripeForm/stripeForm.js","webpack://UnataWidgets/./app/angular/components/payments/stripe/stripeForm/index.js","webpack://UnataWidgets/./app/angular/components/payments/creditCardList/creditCardList.js","webpack://UnataWidgets/./app/angular/components/payments/creditCardList/index.js","webpack://UnataWidgets/./app/angular/components/payments/index.js","webpack://UnataWidgets/./app/utils/productHelpers.js","webpack://UnataWidgets/./app/angular/constants/shoppingSelectorStages.js","webpack://UnataWidgets/./app/angular/components/orderAddOn/orderAddOnConfirmModalController.js","webpack://UnataWidgets/./app/angular/components/productDetails/productDetailsController.js","webpack://UnataWidgets/./app/angular/components/productDetails/configurableProduct/configurableProduct.directive.js","webpack://UnataWidgets/./app/angular/components/productDetails/configurableProduct/configurableProduct.service.js","webpack://UnataWidgets/./app/angular/components/productDetails/configurableProduct/configurableProductDropdown.js","webpack://UnataWidgets/./app/angular/components/productDetails/productDetailsRoutes.js","webpack://UnataWidgets/./app/angular/components/productDetails/index.js","webpack://UnataWidgets/./app/angular/reactComponents/checkbox/tagHelper.js","webpack://UnataWidgets/./app/angular/components/recipes/recipeCategoriesService.js","webpack://UnataWidgets/./app/angular/components/recipes/recipeDetailsModalService.js","webpack://UnataWidgets/./app/angular/components/recipes/recipeIngredients.js","webpack://UnataWidgets/./app/angular/components/recipes/recipeMeta.js","webpack://UnataWidgets/./app/angular/components/recipes/recipeProducts.js","webpack://UnataWidgets/./app/angular/components/recipes/savedRecipesCell.js","webpack://UnataWidgets/./app/angular/components/recipes/recipesRoutes.js","webpack://UnataWidgets/./app/angular/components/recipes/savedRecipesService.js","webpack://UnataWidgets/./app/angular/components/recipes/index.js","webpack://UnataWidgets/./app/angular/components/registration/registrationService.js","webpack://UnataWidgets/./app/angular/components/registration/controllers/registrationController.js","webpack://UnataWidgets/./app/angular/components/registration/registrationRoutes.js","webpack://UnataWidgets/./app/angular/components/registration/index.js","webpack://UnataWidgets/./app/angular/components/reservation/fulfillmentTypeController.js","webpack://UnataWidgets/./app/angular/components/reservation/timeslotController.js","webpack://UnataWidgets/./app/angular/components/reservation/timeslotSelectors.js","webpack://UnataWidgets/./app/angular/components/reservation/timeslotSelectorState.controller.js","webpack://UnataWidgets/./app/angular/components/reservation/timeslotRoutes.js","webpack://UnataWidgets/./app/angular/components/reservation/index.js","webpack://UnataWidgets/./app/angular/components/search/searchRoutes.js","webpack://UnataWidgets/./app/angular/components/search/index.js","webpack://UnataWidgets/./app/angular/components/shared/addressAutocomplete/addressAutocomplete.component.js","webpack://UnataWidgets/./app/angular/components/shared/addressAutocomplete/index.js","webpack://UnataWidgets/./app/angular/components/shared/addressList/addressList.component.js","webpack://UnataWidgets/./app/angular/components/shared/addressList/index.js","webpack://UnataWidgets/./app/angular/components/shared/addressListForm/addressListForm.component.js","webpack://UnataWidgets/./app/angular/components/shared/addressListForm/index.js","webpack://UnataWidgets/./app/angular/components/shared/addToCartButton/addToCartButton.js","webpack://UnataWidgets/./app/angular/components/shared/addToCartButton/orderWeightOptionsService.js","webpack://UnataWidgets/./app/angular/components/shared/addToCartButton/index.js","webpack://UnataWidgets/./app/angular/components/shared/addToList/addToList.component.js","webpack://UnataWidgets/./app/angular/components/shared/addToList/index.js","webpack://UnataWidgets/./app/react/mobile/plugins/urbanAirshipPlugin.ts","webpack://UnataWidgets/./app/utils/getUrbanAirshipChannelId.ts","webpack://UnataWidgets/./app/angular/services/modules/mobile.js","webpack://UnataWidgets/./app/utils/codePushUtils.ts","webpack://UnataWidgets/./app/angular/components/shared/autoFocus/autoFocus.js","webpack://UnataWidgets/./app/angular/components/shared/autoFocus/index.js","webpack://UnataWidgets/./app/angular/components/shared/bannerImage/bannerImage.component.js","webpack://UnataWidgets/./app/angular/components/shared/bannerImage/index.js","webpack://UnataWidgets/./app/angular/components/shared/bannerForm/bannerForm.js","webpack://UnataWidgets/./app/angular/components/shared/bannerForm/index.js","webpack://UnataWidgets/./app/angular/components/shared/bannerTags/bannerTags.js","webpack://UnataWidgets/./app/angular/components/shared/bannerTags/index.js","webpack://UnataWidgets/./app/angular/components/shared/billingInformationForm/billingInformationForm.js","webpack://UnataWidgets/./app/angular/components/shared/billingInformationForm/index.js","webpack://UnataWidgets/./app/angular/components/shared/barcodeScannerButton/barcodeScanner.js","webpack://UnataWidgets/./app/angular/components/shared/barcodeScannerButton/barcodeRoutes.js","webpack://UnataWidgets/./app/angular/components/shared/barcodeScannerButton/index.js","webpack://UnataWidgets/./app/angular/components/shared/cartCompareDialog/cartCompareDialog.js","webpack://UnataWidgets/./app/angular/components/shared/cartCompareDialog/index.js","webpack://UnataWidgets/./app/angular/components/shared/cartForm/cartForm.js","webpack://UnataWidgets/./app/angular/components/shared/cartForm/index.js","webpack://UnataWidgets/./app/angular/components/shared/cartSummary/cartSummary.js","webpack://UnataWidgets/./app/angular/components/shared/cartSummary/index.js","webpack://UnataWidgets/./app/angular/components/shared/cell/cellService.js","webpack://UnataWidgets/./app/angular/components/shared/cell/cellImage.js","webpack://UnataWidgets/./app/angular/components/shared/cell/index.js","webpack://UnataWidgets/./app/angular/components/shared/cellSlider/cellSlider.js","webpack://UnataWidgets/./app/angular/components/shared/cellSlider/index.js","webpack://UnataWidgets/./app/angular/components/shared/collectionModal/collectionModalController.js","webpack://UnataWidgets/./app/angular/components/shared/collectionModal/collectionModalService.js","webpack://UnataWidgets/./app/angular/components/shared/collectionModal/index.js","webpack://UnataWidgets/./app/angular/components/shared/contactForm/contactForm.js","webpack://UnataWidgets/./app/angular/components/shared/contactForm/index.js","webpack://UnataWidgets/./app/angular/components/shared/continuityOfferCell/continuityOfferCell.js","webpack://UnataWidgets/./app/angular/components/shared/continuityOfferCell/index.js","webpack://UnataWidgets/./app/angular/components/shared/couponClipper/couponClipper.js","webpack://UnataWidgets/./app/angular/components/shared/couponClipper/index.js","webpack://UnataWidgets/./app/angular/components/shared/couponUnclippedModal/couponUnclippedModal.js","webpack://UnataWidgets/./app/angular/components/shared/couponUnclippedModal/index.js","webpack://UnataWidgets/./app/angular/components/shared/creditCardLogos/creditCardLogos.js","webpack://UnataWidgets/./app/angular/components/shared/creditCardLogos/index.js","webpack://UnataWidgets/./app/angular/components/shared/deliveryForm/deliveryForm.js","webpack://UnataWidgets/./app/angular/components/shared/deliveryForm/index.js","webpack://UnataWidgets/./app/angular/components/shared/deliveryZipCode/deliveryZipCode.js","webpack://UnataWidgets/./app/angular/components/shared/deliveryZipCode/index.js","webpack://UnataWidgets/./app/angular/components/shared/emptyResultsContextSwitcher/emptyResultsContextSwitcher.js","webpack://UnataWidgets/./app/angular/components/shared/emptyResultsContextSwitcher/index.js","webpack://UnataWidgets/./app/angular/components/shared/errorModal/errorModal.js","webpack://UnataWidgets/./app/angular/components/shared/errorModal/index.js","webpack://UnataWidgets/./app/angular/components/shared/facetedFilterModal/facetedFilterModalController.js","webpack://UnataWidgets/./app/angular/components/shared/facetedFilterModal/facetedFilterModalLineItem.js","webpack://UnataWidgets/./app/angular/components/shared/facetedFilterModal/facetedFilterModal.js","webpack://UnataWidgets/./app/angular/components/shared/facetedFilterModal/facetedFilterModalSection.js","webpack://UnataWidgets/./app/angular/components/shared/facetedFilterModal/index.js","webpack://UnataWidgets/./app/utils/getStickyHeaderHeight.ts","webpack://UnataWidgets/./app/angular/components/shared/facetedSearchBar/facetedFiltersBar/index.js","webpack://UnataWidgets/./app/angular/components/shared/facetedSearchBar/facetedSearchCheckbox/index.js","webpack://UnataWidgets/./app/angular/components/shared/facetedSearchBar/facetedSearchTagCrumbs/index.js","webpack://UnataWidgets/./app/angular/components/shared/facetedSearchBar/index.js","webpack://UnataWidgets/./app/angular/components/shared/facetedSearchCategories/facetedSearchCategories.js","webpack://UnataWidgets/./app/angular/components/shared/facetedSearchCategories/index.js","webpack://UnataWidgets/./app/angular/components/shared/facetedSideFilters/facetedSideFilters.js","webpack://UnataWidgets/./app/angular/components/shared/facetedSideFilters/facetedSideFiltersCheckbox/index.js","webpack://UnataWidgets/./app/angular/components/shared/facetedSideFilters/index.js","webpack://UnataWidgets/./app/angular/components/shared/filterModal/filterModal.js","webpack://UnataWidgets/./app/angular/components/shared/filterModal/index.js","webpack://UnataWidgets/./app/angular/components/shared/filters/filters.js","webpack://UnataWidgets/./app/angular/components/shared/filters/filtersBarResizeHide.js","webpack://UnataWidgets/./app/angular/components/shared/filters/index.js","webpack://UnataWidgets/./app/angular/components/shared/giftCardModal/util/validation.js","webpack://UnataWidgets/./app/angular/components/shared/giftCardModal/giftCardModalController.js","webpack://UnataWidgets/./app/angular/components/shared/giftCardModal/index.js","webpack://UnataWidgets/./app/angular/components/shared/imageCell/imageCell.js","webpack://UnataWidgets/./app/angular/components/shared/imageCell/index.js","webpack://UnataWidgets/./app/angular/components/shared/invalidCartItemsDisplay/invalidCartItemsDisplay.component.js","webpack://UnataWidgets/./app/angular/components/shared/invalidCartItemsDisplay/index.js","webpack://UnataWidgets/./app/angular/components/shared/lightBox/lightBox.js","webpack://UnataWidgets/./app/angular/components/shared/lightBox/index.js","webpack://UnataWidgets/./app/angular/components/shared/loadingDots/loadingDots.js","webpack://UnataWidgets/./app/angular/components/shared/loadingDots/index.js","webpack://UnataWidgets/./app/angular/components/shared/loyaltyCard/loyaltyCard.js","webpack://UnataWidgets/./app/angular/components/shared/loyaltyCard/index.js","webpack://UnataWidgets/./app/angular/components/shared/loyaltyInfo/loyaltyInfoService.js","webpack://UnataWidgets/./app/angular/components/shared/loyaltyInfo/loyaltyInfoController.js","webpack://UnataWidgets/./app/angular/components/shared/loyaltyInfo/index.js","webpack://UnataWidgets/./app/angular/components/shared/loyaltyOptInPlacement/loyaltyOptInPlacement.component.js","webpack://UnataWidgets/./app/angular/components/shared/loyaltyOptInPlacement/index.js","webpack://UnataWidgets/./app/angular/components/shared/loyaltyPlacement/loyaltyPlacement.js","webpack://UnataWidgets/./app/angular/components/shared/loyaltyPlacement/index.js","webpack://UnataWidgets/./app/angular/components/shared/mobileAppPromotionBanner/mobileAppPromotionBanner.js","webpack://UnataWidgets/./app/angular/components/shared/mobileAppPromotionBanner/index.js","webpack://UnataWidgets/./app/angular/components/shared/modifyQuantity/modifyQuantity.js","webpack://UnataWidgets/./app/angular/components/shared/modifyQuantity/index.js","webpack://UnataWidgets/./app/angular/components/shared/notificationSettings/notificationSettingsTable.js","webpack://UnataWidgets/./app/angular/components/shared/notificationSettings/index.js","webpack://UnataWidgets/./app/angular/components/shared/nutritionTable/nutritionTable.js","webpack://UnataWidgets/./app/angular/components/shared/nutritionTable/index.js","webpack://UnataWidgets/./app/angular/components/shared/offerCell/offerCell.js","webpack://UnataWidgets/./app/angular/components/shared/offerCell/index.js","webpack://UnataWidgets/./app/angular/components/shared/offerDetailsModal/offerDetailsModalController.js","webpack://UnataWidgets/./app/angular/components/shared/offerDetailsModal/offerDetailsModalService.js","webpack://UnataWidgets/./app/angular/components/shared/offerDetailsModal/index.js","webpack://UnataWidgets/./app/angular/components/shared/offers/continuityProgress.js","webpack://UnataWidgets/./app/angular/components/shared/offers/offerIcon.js","webpack://UnataWidgets/./app/angular/constants/offers.js","webpack://UnataWidgets/./app/angular/components/shared/offers/offerProgress.js","webpack://UnataWidgets/./app/angular/components/shared/offers/offerTile.js","webpack://UnataWidgets/./app/angular/components/shared/offers/index.js","webpack://UnataWidgets/./app/angular/components/shared/orderDeliveryInstructionsForm/orderDeliveryInstructionsForm.js","webpack://UnataWidgets/./app/angular/components/shared/orderDeliveryInstructionsForm/index.js","webpack://UnataWidgets/./app/angular/components/shared/overlay/overlayDirective.js","webpack://UnataWidgets/./app/angular/components/shared/overlay/index.js","webpack://UnataWidgets/./app/angular/components/shared/pageHeader/pageHeaderDirective.js","webpack://UnataWidgets/./app/angular/components/shared/pageHeader/index.js","webpack://UnataWidgets/./app/angular/components/shared/paymentForm/paymentForm.js","webpack://UnataWidgets/./app/angular/components/shared/paymentForm/index.js","webpack://UnataWidgets/./app/angular/components/shared/phoneInput/phoneInput.js","webpack://UnataWidgets/./app/angular/components/shared/phoneInput/index.js","webpack://UnataWidgets/./app/angular/components/shared/pickupForm/pickupForm.js","webpack://UnataWidgets/./app/angular/components/shared/pickupForm/index.js","webpack://UnataWidgets/./app/angular/components/shared/preferredPhoneNumberSelect/preferredPhoneNumberSelect.js","webpack://UnataWidgets/./app/angular/components/shared/preferredPhoneNumberSelect/index.js","webpack://UnataWidgets/./app/angular/components/shared/preventAllScrolling/preventAllScrolling.js","webpack://UnataWidgets/./app/angular/components/shared/preventAllScrolling/index.js","webpack://UnataWidgets/./app/angular/components/shared/priceAlertButton/priceAlertButton.js","webpack://UnataWidgets/./app/angular/components/shared/priceAlertButton/index.js","webpack://UnataWidgets/./app/angular/components/shared/productCell/cellOverlay.js","webpack://UnataWidgets/./app/angular/components/shared/productCell/productCell.js","webpack://UnataWidgets/./app/angular/components/shared/productCell/ProductCellController.ng.js","webpack://UnataWidgets/./app/angular/components/shared/productCell/ProductCellController.react.js","webpack://UnataWidgets/./app/angular/components/shared/productCell/index.js","webpack://UnataWidgets/./app/angular/components/shared/productComments/productComments.js","webpack://UnataWidgets/./app/angular/components/shared/productComments/index.js","webpack://UnataWidgets/./app/angular/components/shared/productCommentsV2/productCommentsV2.js","webpack://UnataWidgets/./app/angular/components/shared/productCommentsV2/index.js","webpack://UnataWidgets/./app/angular/components/shared/productDetailsModal/productDetailsModalController.js","webpack://UnataWidgets/./app/angular/components/shared/productDetailsModal/productDetailsModalService.js","webpack://UnataWidgets/./app/angular/components/shared/productDetailsModal/index.js","webpack://UnataWidgets/./app/angular/components/shared/productPoints/productPoints.js","webpack://UnataWidgets/./app/angular/components/shared/productPoints/index.js","webpack://UnataWidgets/./app/angular/components/shared/productPrices/productPrices.js","webpack://UnataWidgets/./app/angular/components/shared/productPrices/index.js","webpack://UnataWidgets/./app/angular/components/shared/progressIndicator/progressIndicator.component.js","webpack://UnataWidgets/./app/angular/components/shared/progressIndicator/index.js","webpack://UnataWidgets/./app/angular/components/shared/promoCodeModal/promoCodeModalController.js","webpack://UnataWidgets/./app/angular/components/shared/promoCodeModal/index.js","webpack://UnataWidgets/./app/angular/components/shared/promoCollectionCell/promoCollectionCell.js","webpack://UnataWidgets/./app/angular/components/shared/promoCollectionCell/index.js","webpack://UnataWidgets/./app/angular/components/shared/provinceSelect/provinceSelect.js","webpack://UnataWidgets/./app/angular/components/shared/provinceSelect/index.js","webpack://UnataWidgets/./app/angular/components/shared/quickshop/quickshop.js","webpack://UnataWidgets/./app/angular/components/shared/quickshop/index.js","webpack://UnataWidgets/./app/angular/components/shared/rating/rating.js","webpack://UnataWidgets/./app/angular/components/shared/rating/index.js","webpack://UnataWidgets/./app/angular/components/shared/recaptcha/recaptchaCheckbox.component.js","webpack://UnataWidgets/./app/angular/components/shared/recaptcha/index.js","webpack://UnataWidgets/./app/angular/components/shared/recipeCell/recipeCell.js","webpack://UnataWidgets/./app/angular/components/shared/recipeCell/index.js","webpack://UnataWidgets/./app/angular/components/shared/relatedCoupon/relatedCoupon.js","webpack://UnataWidgets/./app/angular/components/shared/relatedCoupon/index.js","webpack://UnataWidgets/./app/angular/components/shared/relatedProduct/relatedProduct.js","webpack://UnataWidgets/./app/angular/components/shared/relatedProduct/index.js","webpack://UnataWidgets/./app/angular/components/shared/scheduleForm/scheduleForm.js","webpack://UnataWidgets/./app/angular/components/shared/scheduleForm/index.js","webpack://UnataWidgets/./app/angular/components/shared/sharedForgotPassword/sharedForgotPassword.js","webpack://UnataWidgets/./app/angular/components/shared/sharedForgotPassword/index.js","webpack://UnataWidgets/./app/react/mobile/plugins/sharePlugin.ts","webpack://UnataWidgets/./app/angular/components/shared/shareListButton/shareListButton.js","webpack://UnataWidgets/./app/angular/components/shared/shareListButton/index.js","webpack://UnataWidgets/./app/angular/components/shared/shopModalHeader/shopModalHeader.js","webpack://UnataWidgets/./app/angular/components/shared/shopModalHeader/index.js","webpack://UnataWidgets/./app/angular/components/shared/sideCartSortModal/sideCartSortModal.js","webpack://UnataWidgets/./app/angular/components/shared/sideCartSortModal/index.js","webpack://UnataWidgets/./app/angular/components/shared/simplifiedHeader/simplifiedHeader.js","webpack://UnataWidgets/./app/angular/components/shared/simplifiedHeader/index.js","webpack://UnataWidgets/./app/angular/components/shared/storeList/storeList.js","webpack://UnataWidgets/./app/angular/components/shared/storeList/index.js","webpack://UnataWidgets/./app/angular/components/shared/storesMap/storesMap.js","webpack://UnataWidgets/./app/angular/components/shared/storesMap/index.js","webpack://UnataWidgets/./app/angular/components/shared/subscriptionSelect/subscriptionSelect.js","webpack://UnataWidgets/./app/angular/components/shared/subscriptionSelect/index.js","webpack://UnataWidgets/./app/angular/components/shared/tagStyle/tagStyle.js","webpack://UnataWidgets/./app/angular/components/shared/tagStyle/index.js","webpack://UnataWidgets/./app/angular/components/shared/tipPicker/tipPicker.component.js","webpack://UnataWidgets/./app/angular/components/shared/tipPicker/index.js","webpack://UnataWidgets/./app/angular/components/shared/tipPickerModal/tipPickerModal.js","webpack://UnataWidgets/./app/angular/components/shared/tipPickerModal/index.js","webpack://UnataWidgets/./app/angular/components/shared/typeahead/typeaheadAccessibility.js","webpack://UnataWidgets/./app/angular/components/shared/typeahead/index.js","webpack://UnataWidgets/./app/angular/components/shared/updateCreditCard/updateCreditCard.js","webpack://UnataWidgets/./app/angular/components/shared/updateCreditCard/index.js","webpack://UnataWidgets/./app/angular/components/shared/util/bgImgFade.js","webpack://UnataWidgets/./app/angular/components/shared/util/bindHtmlCompile.js","webpack://UnataWidgets/./app/angular/components/shared/util/compile.js","webpack://UnataWidgets/./app/angular/components/shared/util/disable.js","webpack://UnataWidgets/./app/angular/components/shared/util/elementInView.js","webpack://UnataWidgets/./app/angular/components/shared/util/elementMatchesPolyfill.js","webpack://UnataWidgets/./app/angular/components/shared/util/fallbackSrc.js","webpack://UnataWidgets/./app/angular/components/shared/util/featuredHeader.component.js","webpack://UnataWidgets/./app/angular/components/shared/util/fileUploader.js","webpack://UnataWidgets/./app/angular/components/shared/util/filters.js","webpack://UnataWidgets/./app/angular/components/shared/util/fixedToBody.js","webpack://UnataWidgets/./app/angular/components/shared/util/focusFirstInput.js","webpack://UnataWidgets/./app/angular/components/shared/util/forgotPasswordButton.js","webpack://UnataWidgets/./app/angular/components/shared/util/formattedBirthday.js","webpack://UnataWidgets/./app/angular/components/shared/util/help.js","webpack://UnataWidgets/./app/angular/components/shared/util/includeIfExists.js","webpack://UnataWidgets/./app/angular/components/shared/util/includeReplace.js","webpack://UnataWidgets/./app/angular/components/shared/util/invalidFocus.js","webpack://UnataWidgets/./app/angular/components/shared/util/label.js","webpack://UnataWidgets/./app/angular/components/shared/util/modalTemplate.js","webpack://UnataWidgets/./app/angular/components/shared/util/noApplyClick.js","webpack://UnataWidgets/./app/angular/components/shared/util/noticeModal.js","webpack://UnataWidgets/./app/angular/components/shared/util/pageTitle.js","webpack://UnataWidgets/./app/angular/components/shared/util/placeholderImage.js","webpack://UnataWidgets/./app/angular/components/shared/util/reactStorefrontBuilder.js","webpack://UnataWidgets/./app/angular/components/shared/util/refocus.js","webpack://UnataWidgets/./app/angular/constants/elementSelectors.js","webpack://UnataWidgets/./app/angular/components/shared/util/requireRegisteredUser.js","webpack://UnataWidgets/./app/angular/components/shared/util/runOnEnter.js","webpack://UnataWidgets/./app/angular/components/shared/util/sanitizeUib.js","webpack://UnataWidgets/./app/angular/components/shared/util/scrollIntoView.js","webpack://UnataWidgets/./app/angular/components/shared/util/sideCartSubMenu.js","webpack://UnataWidgets/./app/angular/components/shared/util/sticky.js","webpack://UnataWidgets/./app/angular/components/shared/util/tabEnter.js","webpack://UnataWidgets/./app/angular/components/shared/util/tabsKeyboardControl.js","webpack://UnataWidgets/./app/angular/components/shared/util/trapFocus.js","webpack://UnataWidgets/./app/angular/components/shared/util/uibModalAriaLabel.js","webpack://UnataWidgets/./app/angular/components/shared/util/updateOnEnter.js","webpack://UnataWidgets/./app/angular/components/shared/util/index.js","webpack://UnataWidgets/./app/angular/components/shared/videoModal/videoModal.js","webpack://UnataWidgets/./app/angular/components/shared/videoModal/index.js","webpack://UnataWidgets/./app/angular/components/shared/index.js","webpack://UnataWidgets/./app/angular/components/shop/services/catalogCategoriesService.js","webpack://UnataWidgets/./app/angular/components/shop/services/collectionsCategoriesService.js","webpack://UnataWidgets/./app/angular/components/shop/services/couponsCategoriesService.js","webpack://UnataWidgets/./app/angular/components/shop/services/flyerCategoriesAndPdfs.service.js","webpack://UnataWidgets/./app/angular/components/shop/services/purchasesCategoriesService.js","webpack://UnataWidgets/./app/angular/components/shop/categoryFilterDirective.js","webpack://UnataWidgets/./app/angular/constants/analyticsValues.js","webpack://UnataWidgets/./app/angular/constants/tags.js","webpack://UnataWidgets/./app/angular/constants/coupons.js","webpack://UnataWidgets/./app/angular/components/shop/shopRoutes.js","webpack://UnataWidgets/./app/angular/components/shop/index.js","webpack://UnataWidgets/./app/angular/components/mobileAppInfo/mobileAppInfoRoutes.js","webpack://UnataWidgets/./app/angular/components/mobileAppInfo/index.js","webpack://UnataWidgets/./app/angular/components/shoppingSelector/cartListTransfer/cartListTransferState.controller.js","webpack://UnataWidgets/./app/angular/components/shoppingSelector/cartListTransfer/cartListTransfer.component.js","webpack://UnataWidgets/./app/angular/components/shoppingSelector/cartListTransfer/cartListTransferState.routes.js","webpack://UnataWidgets/./app/angular/components/shoppingSelector/confirmation/shoppingSelectorConfirmationController.js","webpack://UnataWidgets/./app/angular/components/shoppingSelector/contextSelector/shoppingContextItem.component.js","webpack://UnataWidgets/./app/utils/parseV2ContextParam.js","webpack://UnataWidgets/./app/angular/services/modules/userOverridesV2.service.js","webpack://UnataWidgets/./app/angular/components/shoppingSelector/contextSelector/contextSelectorController.js","webpack://UnataWidgets/./app/angular/components/shoppingSelector/timeslotSelector/timeslotSelectorController.js","webpack://UnataWidgets/./app/angular/components/shoppingSelector/shoppingSelectorService.js","webpack://UnataWidgets/./app/angular/components/shoppingSelector/shoppingSelectorRoutes.js","webpack://UnataWidgets/./app/angular/components/shoppingSelector/parentShoppingSelectorController.js","webpack://UnataWidgets/./app/angular/components/shoppingSelector/storeSelector/storeSelectorController.js","webpack://UnataWidgets/./app/angular/components/shoppingSelector/storeSelector/storeSelectorMapController.js","webpack://UnataWidgets/./app/angular/components/shoppingSelector/storeSelector/storeSelectorListController.js","webpack://UnataWidgets/./app/angular/components/shoppingSelector/storeSelector/helpers.js","webpack://UnataWidgets/./app/angular/components/shoppingSelector/shoppingSelectorModalHeader.js","webpack://UnataWidgets/./app/angular/components/shoppingSelector/storeSelector/multipleBannerTabs.component.js","webpack://UnataWidgets/./app/angular/components/shoppingSelector/bannerSelector.component.js","webpack://UnataWidgets/./app/angular/components/shoppingSelector/index.js","webpack://UnataWidgets/./app/angular/components/sideCart/sideCartController.js","webpack://UnataWidgets/./app/angular/components/sideCart/sideCartRoutes.js","webpack://UnataWidgets/./app/angular/components/sideCart/sideCartBottomButtonsComponent.js","webpack://UnataWidgets/./app/angular/services/modules/checkout.service.js","webpack://UnataWidgets/./app/services/cart/constants.ts","webpack://UnataWidgets/./app/services/cart/metrics.ts","webpack://UnataWidgets/./app/react/components/undoItemRemove/UndoItemRemove.tsx","webpack://UnataWidgets/./app/react/ids/enterprise/molecules/OutsideClickHandler/OutsideClickHandler.tsx","webpack://UnataWidgets/./app/angular/services/modules/undoRemove.js","webpack://UnataWidgets/./app/angular/components/sideCart/sideCart.js","webpack://UnataWidgets/./app/angular/components/sideCart/sideCartAutoFocus.js","webpack://UnataWidgets/./app/angular/components/sideCart/index.js","webpack://UnataWidgets/./app/angular/constants/ssoFields.js","webpack://UnataWidgets/./app/services/externalAuth/handleExternalAuth.ts","webpack://UnataWidgets/./app/react/mobile/plugins/applePlugin.ts","webpack://UnataWidgets/./app/angular/components/socialSignOn/socialSignOn.js","webpack://UnataWidgets/./app/angular/components/socialSignOn/index.js","webpack://UnataWidgets/./app/angular/components/subscriptionCheckout/subscriptionCheckoutRoutes.js","webpack://UnataWidgets/./app/angular/components/subscriptionCheckout/index.js","webpack://UnataWidgets/./app/angular/components/nav/registrationDropdown/profileMenu.js","webpack://UnataWidgets/./app/angular/components/wordpressMobileSideNavItems/wordpressMobileSideNavItems.js","webpack://UnataWidgets/./app/angular/components/wordpressMobileSideNavItems/index.js","webpack://UnataWidgets/./app/angular/components/index.js","webpack://UnataWidgets/./app/angular/services/modules/api.js","webpack://UnataWidgets/./app/angular/services/modules/addressList.js","webpack://UnataWidgets/./app/angular/services/modules/addressSearch.service.js","webpack://UnataWidgets/./app/angular/services/modules/addToCart.service.js","webpack://UnataWidgets/./app/angular/services/modules/alcoholValidation.service.js","webpack://UnataWidgets/./app/angular/services/modules/analytics/analytics.js","webpack://UnataWidgets/./app/angular/services/modules/anonymousId.service.js","webpack://UnataWidgets/./app/services/externalAuth/externalOAuth2.ts","webpack://UnataWidgets/./app/angular/services/modules/auth.js","webpack://UnataWidgets/./app/angular/services/modules/barcodeScanner.js","webpack://UnataWidgets/./app/angular/services/modules/canvas.js","webpack://UnataWidgets/./app/utils/rx/encryptorFactory.js","webpack://UnataWidgets/./app/services/rx/api.ts","webpack://UnataWidgets/./app/services/rx/utils.ts","webpack://UnataWidgets/./app/angular/components/shared/invalidCartItemsDisplay/invalidCartItemsDisplay.controller.js","webpack://UnataWidgets/./app/angular/components/policy/policyService.js","webpack://UnataWidgets/./app/angular/components/iwsRegulationAlertModal/iwsRegulationAlertModalService.js","webpack://UnataWidgets/./app/angular/services/modules/cart.js","webpack://UnataWidgets/./app/angular/services/modules/cartAnalytics.service.js","webpack://UnataWidgets/./app/angular/services/modules/cartListTransfer.service.js","webpack://UnataWidgets/./app/angular/services/modules/analytics/checkoutAnalytics.service.js","webpack://UnataWidgets/./app/angular/services/modules/codePush.js","webpack://UnataWidgets/./app/angular/services/modules/collections.service.js","webpack://UnataWidgets/./app/angular/services/modules/confirmationModal.js","webpack://UnataWidgets/./app/angular/services/modules/clientConfiguration.service.js","webpack://UnataWidgets/./app/angular/services/modules/debug.js","webpack://UnataWidgets/./app/angular/constants/paymentGateway.js","webpack://UnataWidgets/./app/angular/services/modules/ebtCard.js","webpack://UnataWidgets/./app/services/shoppingContext/actions.ts","webpack://UnataWidgets/./app/angular/services/modules/eComLight.service.js","webpack://UnataWidgets/./app/angular/services/modules/errorInterceptor.js","webpack://UnataWidgets/./app/angular/services/modules/placements.service.js","webpack://UnataWidgets/./app/angular/services/modules/express.js","webpack://UnataWidgets/./app/angular/services/modules/facetedFilterModal.js","webpack://UnataWidgets/./app/angular/services/modules/facetedSearchService.js","webpack://UnataWidgets/./app/angular/services/modules/flyerPreview.service.js","webpack://UnataWidgets/./app/angular/services/modules/giftCardModalService.js","webpack://UnataWidgets/./app/angular/services/modules/headerFooterSync.js","webpack://UnataWidgets/./app/angular/services/modules/imageURL.service.js","webpack://UnataWidgets/./app/angular/services/modules/instacart.js","webpack://UnataWidgets/./app/angular/services/modules/icExpressModalService.js","webpack://UnataWidgets/./app/angular/services/modules/lang.js","webpack://UnataWidgets/./app/angular/services/modules/legacy/modal.service.js","webpack://UnataWidgets/./app/angular/services/modules/list.js","webpack://UnataWidgets/./app/angular/services/modules/listPrint.service.js","webpack://UnataWidgets/./app/angular/services/modules/loyalty.js","webpack://UnataWidgets/./app/angular/services/modules/manualUpsell.js","webpack://UnataWidgets/./app/angular/services/modules/master.js","webpack://UnataWidgets/./app/angular/services/modules/masterCart.js","webpack://UnataWidgets/./app/angular/services/modules/mobileNativeHref.service.js","webpack://UnataWidgets/./app/angular/services/modules/mobileNav.service.js","webpack://UnataWidgets/./app/angular/services/modules/modalOptions.service.js","webpack://UnataWidgets/./app/angular/services/modules/nativeMobileBrightnessService.js","webpack://UnataWidgets/./app/angular/services/modules/navMenuCallbacks.js","webpack://UnataWidgets/./app/utils/promiseWrapper.js","webpack://UnataWidgets/./app/angular/services/modules/ngPromise.js","webpack://UnataWidgets/./app/angular/services/modules/offers.js","webpack://UnataWidgets/./app/angular/services/modules/analytics/offerAnalytics.service.js","webpack://UnataWidgets/./app/angular/services/modules/oneCart.js","webpack://UnataWidgets/./app/angular/services/modules/order.service.js","webpack://UnataWidgets/./app/angular/services/modules/priceAlerts.js","webpack://UnataWidgets/./app/angular/services/modules/products.js","webpack://UnataWidgets/./app/angular/services/modules/profile.service.js","webpack://UnataWidgets/./app/angular/services/modules/promoCode.service.js","webpack://UnataWidgets/./app/angular/services/modules/promoCodeValidationService.js","webpack://UnataWidgets/./app/angular/services/modules/qualitricsService.js","webpack://UnataWidgets/./app/react/mobile/plugins/appRatePlugin.ts","webpack://UnataWidgets/./app/angular/services/modules/rateApp.js","webpack://UnataWidgets/./app/angular/services/modules/reactRouterHistory.js","webpack://UnataWidgets/./app/angular/services/modules/recaptcha.service.js","webpack://UnataWidgets/./app/angular/services/modules/redirect.service.js","webpack://UnataWidgets/./app/angular/services/modules/reservation.js","webpack://UnataWidgets/./app/angular/services/modules/restangular.js","webpack://UnataWidgets/./app/angular/services/modules/routing/routes/checkoutRoutes.js","webpack://UnataWidgets/./app/angular/services/modules/routing/index.js","webpack://UnataWidgets/./app/angular/services/modules/runtimeRoutes.js","webpack://UnataWidgets/./app/angular/services/modules/shoppingContext.service.js","webpack://UnataWidgets/./app/angular/services/modules/shoppingListCache.js","webpack://UnataWidgets/./app/angular/services/modules/sideCart.service.js","webpack://UnataWidgets/./app/angular/services/modules/stores.js","webpack://UnataWidgets/./app/angular/services/modules/subscriptions.js","webpack://UnataWidgets/./app/angular/services/modules/subscriptionCheckout.service.js","webpack://UnataWidgets/./app/angular/services/modules/tags.js","webpack://UnataWidgets/./app/angular/services/modules/timeslot.service.js","webpack://UnataWidgets/./app/angular/services/modules/toggleEComLight.service.js","webpack://UnataWidgets/./app/angular/services/modules/unataCommService.js","webpack://UnataWidgets/./app/angular/services/modules/unataCommInterceptorService.js","webpack://UnataWidgets/./app/angular/services/modules/universalLinks.js","webpack://UnataWidgets/./app/angular/services/modules/update.js","webpack://UnataWidgets/./app/angular/services/modules/urbanairship.js","webpack://UnataWidgets/./app/angular/services/modules/analytics/userAnalytics.service.js","webpack://UnataWidgets/./app/angular/services/modules/userOverrides.service.js","webpack://UnataWidgets/./app/angular/services/modules/user.service.js","webpack://UnataWidgets/./app/angular/services/modules/util.js","webpack://UnataWidgets/./app/angular/services/modules/wordpressRestApi.js","webpack://UnataWidgets/./app/angular/services/modules/search.service.js","webpack://UnataWidgets/./app/angular/services/modules/localStorage.js","webpack://UnataWidgets/./app/angular/services/modules/cartListTransferModal.js","webpack://UnataWidgets/./app/angular/services/modules/orderFees.service.js","webpack://UnataWidgets/./app/angular/services/modules/contextSelectorButton.js","webpack://UnataWidgets/./app/angular/services/modules/rxUpSellService.js","webpack://UnataWidgets/./app/angular/services/modules/fulfillmentNotAvailableModal.js","webpack://UnataWidgets/./app/angular/services/index.js","webpack://UnataWidgets/./app/angular/optionalComponents/authorize.net/authorizeNetPaymentService.js","webpack://UnataWidgets/./app/angular/optionalComponents/authorize.net/authorizeNetIntegrationController.js","webpack://UnataWidgets/./app/angular/optionalComponents/authorize.net/index.js","webpack://UnataWidgets/./app/utils/promiseable.js","webpack://UnataWidgets/./app/angular/optionalComponents/braintree/braintreeIntegrationController.js","webpack://UnataWidgets/./app/angular/optionalComponents/braintree/braintreePaymentService.js","webpack://UnataWidgets/./app/angular/optionalComponents/braintree/index.js","webpack://UnataWidgets/./app/angular/optionalComponents/firstData/v1/payeezy.js","webpack://UnataWidgets/./app/angular/optionalComponents/firstData/v1/firstDataIntegrationController.js","webpack://UnataWidgets/./app/angular/optionalComponents/firstData/v1/firstDataPaymentService.js","webpack://UnataWidgets/./app/angular/optionalComponents/firstData/v1/index.js","webpack://UnataWidgets/./app/angular/constants/firstDatav2.js","webpack://UnataWidgets/./app/angular/optionalComponents/firstData/v2/firstDataIntegrationController.js","webpack://UnataWidgets/./app/angular/optionalComponents/firstData/v2/firstDataPaymentService.js","webpack://UnataWidgets/./app/angular/optionalComponents/firstData/v2/index.js","webpack://UnataWidgets/./app/angular/optionalComponents/gigya/gigya.js","webpack://UnataWidgets/./app/angular/optionalComponents/gigya/index.js","webpack://UnataWidgets/./app/angular/optionalComponents/stripe/stripePaymentForm.controller.js","webpack://UnataWidgets/./app/angular/optionalComponents/stripe/stripeIntegration.js","webpack://UnataWidgets/./app/angular/optionalComponents/stripe/index.js","webpack://UnataWidgets/./app/angular/optionalComponents/vantiv/vantivIntegrationController.js","webpack://UnataWidgets/./app/angular/optionalComponents/vantiv/vantivPaymentService.js","webpack://UnataWidgets/./app/angular/optionalComponents/vantiv/index.js","webpack://UnataWidgets/./app/angular/constants/wegpay.js","webpack://UnataWidgets/./app/angular/optionalComponents/wegpay/wegpayPaymentService.js","webpack://UnataWidgets/./app/angular/optionalComponents/wegpay/wegpayIntegrationController.js","webpack://UnataWidgets/./app/angular/optionalComponents/wegpay/index.js","webpack://UnataWidgets/./app/angular/optionalComponents/index.js","webpack://UnataWidgets/./app/angular/reactComponents/rxUpsellModal/index.js","webpack://UnataWidgets/./app/angular/reactComponents/lazyLoadingIndicator/LazyLoadingIndicator.tsx","webpack://UnataWidgets/./app/angular/reactComponents/ngIgnore.jsx","webpack://UnataWidgets/./app/angular/reactComponents/reactWrapper.tsx","webpack://UnataWidgets/./app/angular/reactComponents/index.js","webpack://UnataWidgets/./app/angular/reactComponents/productRating/index.js","webpack://UnataWidgets/./app/angular/reactComponents/checkbox/index.js","webpack://UnataWidgets/./app/angular/reactComponents/imageTile/index.js","webpack://UnataWidgets/./app/angular/reactComponents/addToCartButton/index.js","webpack://UnataWidgets/./app/angular/reactComponents/userReviews/index.js","webpack://UnataWidgets/./app/angular/reactComponents/nutrition/index.js","webpack://UnataWidgets/./app/angular/reactComponents/productPrice/index.js","webpack://UnataWidgets/./app/angular/reactComponents/cartLoyaltyBalance/index.js","webpack://UnataWidgets/./app/angular/reactComponents/cartCheckoutSubscriptionSelect/index.js","webpack://UnataWidgets/./app/angular/reactComponents/productCell/index.js","webpack://UnataWidgets/./app/angular/reactComponents/pricingDisclosure/index.ts","webpack://UnataWidgets/./app/angular/reactComponents/subscriptionPage/index.js","webpack://UnataWidgets/./app/angular/reactComponents/loyaltyBarcode/index.js","webpack://UnataWidgets/./app/angular/reactComponents/cartLoyaltyBalance/defaultProps.js","webpack://UnataWidgets/./app/angular/reactComponents/subscriptionCheckout/index.js","webpack://UnataWidgets/./app/angular/reactComponents/timeSlots/index.js","webpack://UnataWidgets/./app/angular/reactComponents/errorWindow/index.js","webpack://UnataWidgets/./app/angular/reactComponents/profilePage/index.js","webpack://UnataWidgets/./app/angular/reactComponents/accountImportModal/index.js","webpack://UnataWidgets/./app/angular/reactComponents/accountImportSuccessModal/index.js","webpack://UnataWidgets/./app/angular/reactComponents/accountImportErrorModal/index.js","webpack://UnataWidgets/./app/angular/reactComponents/userMenu/index.js","webpack://UnataWidgets/./app/angular/reactComponents/userMenuLinks/index.js","webpack://UnataWidgets/./app/angular/reactComponents/cartButton/index.js","webpack://UnataWidgets/./app/angular/reactComponents/cartIconButton/index.js","webpack://UnataWidgets/./app/angular/reactComponents/contextSelector/index.js","webpack://UnataWidgets/./app/angular/reactComponents/orderTrack/index.js","webpack://UnataWidgets/./app/angular/reactComponents/orderTotals/index.js","webpack://UnataWidgets/./app/angular/reactComponents/addressAutocomplete/index.js","webpack://UnataWidgets/./app/angular/reactComponents/icExpress/index.js","webpack://UnataWidgets/./app/angular/reactComponents/fullfillmentNotAvailableModal/index.js","webpack://UnataWidgets/./app/angular/reactComponents/policyModal/index.js","webpack://UnataWidgets/./app/angular/reactComponents/itemTile/index.ts","webpack://UnataWidgets/./app/angular/reactComponents/rxRedirectErrorModal/index.js","webpack://UnataWidgets/./app/angular/reactComponents/homepageBanners/index.js","webpack://UnataWidgets/./app/angular/reactComponents/productUnavailableDisclaimer/index.js","webpack://UnataWidgets/./app/angular/reactComponents/fulfillmentBanner/index.js","webpack://UnataWidgets/./app/angular/reactComponents/miniCartList/index.js","webpack://UnataWidgets/./app/angular/reactComponents/productCollection/index.js","webpack://UnataWidgets/./app/angular/reactComponents/iwsRegulationAlertModal/index.js","webpack://UnataWidgets/./app/angular/reactComponents/ProductImageCarousel/index.js","webpack://UnataWidgets/./app/angular/services/modules/lazyLoading.service.js","webpack://UnataWidgets/./app/angular/app.js","webpack://UnataWidgets/./app/react/AngularApp.tsx","webpack://UnataWidgets/./app/angular/components/shared/quickshop/quickshop.html","webpack://UnataWidgets/./app/angular/components/shoppingSelector/views/unableToChangeToPickupRx.html","webpack://UnataWidgets/./app/angular/components/checkout/views/checkoutCartTable.html","webpack://UnataWidgets/./app/angular/optionalComponents/vantiv/vantivIntegration.html","webpack://UnataWidgets/./app/vendors/restangular.js","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressCancellation/steps/firstStep.html","webpack://UnataWidgets/./app/angular/components/shared/lightBox/lightBox.html","webpack://UnataWidgets/./app/angular/components/compareCart/views/compareCartState.html","webpack://UnataWidgets/./app/angular/components/shared/addToCartButton/templates/addToCartTrigger.html","webpack://UnataWidgets/./app/angular/components/shared/pageHeader/pageHeader.html","webpack://UnataWidgets/./app/angular/components/shared/pageHeader/pageHeader.desktop.html","webpack://UnataWidgets/./app/angular/components/shared/deliveryZipCode/deliveryZipCode.html","webpack://UnataWidgets/./app/angular/components/externalPage/externalPage.html","webpack://UnataWidgets/./app/angular/components/reservation/views/reservation.html","webpack://UnataWidgets/./app/angular/components/shared/productCell/productCell.react.html","webpack://UnataWidgets/./app/angular/components/shoppingSelector/confirmation/shoppingSelectorConfirmation.html","webpack://UnataWidgets/./app/angular/components/recipes/recipeDetails.html","webpack://UnataWidgets/./app/angular/components/nav/views/nav.html","webpack://UnataWidgets/./app/angular/components/shoppingSelector/storeSelector/storeSelectorMapStores.mobile.html","webpack://UnataWidgets/./app/angular/components/shoppingSelector/storeSelector/storeSelector.html","webpack://UnataWidgets/./app/angular/components/shared/productCell/productCell.variant-01.html","webpack://UnataWidgets/./app/angular/constants/checkout.js","webpack://UnataWidgets/./app/utils/images/escapeImageUrl.ts","webpack://UnataWidgets/./app/angular/components/sideCart/sideCartBottomButtons.html","webpack://UnataWidgets/./app/angular/components/collections/productCollection.html","webpack://UnataWidgets/./app/angular/optionalComponents/stripe/stripeIntegration.html","webpack://UnataWidgets/./app/angular/components/shared/scheduleForm/scheduleForm.html","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressCheckout/icExpressCheckout.html","webpack://UnataWidgets/./app/angular/services/templates/confirmationModal/confirmationModal.html","webpack://UnataWidgets/./app/angular/components/nav/views/nav.desktop.html","webpack://UnataWidgets/./app/angular/components/shared/subscriptionSelect/subscriptionSelect.html","webpack://UnataWidgets/./app/angular/components/shared/pageHeader/pageHeader.search.desktop.html","webpack://UnataWidgets/./app/angular/components/recipes/savedRecipesCell.html","webpack://UnataWidgets/./app/angular/components/shop/views/collectionsHome.html","webpack://UnataWidgets/./app/utils/isMobileContainerUrl.ts","webpack://UnataWidgets/./app/angular/components/addressValidation/views/addressValidationModal.html","webpack://UnataWidgets/./app/angular/components/shared/productPoints/productPoints.html","webpack://UnataWidgets/./packages/enterprise-subscription-checkout/hooks.js","webpack://UnataWidgets/./packages/enterprise-subscription-checkout/constants.js","webpack://UnataWidgets/./packages/enterprise-subscription-checkout/Footer.js","webpack://UnataWidgets/./packages/enterprise-subscription-checkout/Checkout.js","webpack://UnataWidgets/./packages/enterprise-subscription-checkout/Header.js","webpack://UnataWidgets/./packages/enterprise-subscription-checkout/steps/SubscriptionMarketing.js","webpack://UnataWidgets/./packages/enterprise-subscription-checkout/steps/SubscriptionSelection.js","webpack://UnataWidgets/./packages/enterprise-payments/common/props.js","webpack://UnataWidgets/./packages/enterprise-payments/components/CreditCardList.js","webpack://UnataWidgets/./packages/enterprise-payments/components/PaymentIframe.js","webpack://UnataWidgets/./packages/enterprise-payments/containers/PaymentFormVantiv.js","webpack://UnataWidgets/./packages/enterprise-subscription-checkout/steps/SubscriptionPayment.js","webpack://UnataWidgets/./packages/enterprise-subscription-checkout/steps/SubscriptionSuccess.js","webpack://UnataWidgets/./packages/enterprise-subscription-checkout/SubscriptionCheckout.js","webpack://UnataWidgets/./packages/enterprise-subscription-checkout/CartCheckoutSubscriptionSelect.js","webpack://UnataWidgets/./packages/enterprise-subscription-checkout/CartCheckoutSubscriptionSelectSmart.js","webpack://UnataWidgets/./packages/enterprise-subscription-checkout/index.js","webpack://UnataWidgets/./app/angular/components/nav/categoriesMenu/categoriesMenu.html","webpack://UnataWidgets/./app/angular/components/shared/filters/filters.html","webpack://UnataWidgets/./app/angular/components/shop/views/shop.html","webpack://UnataWidgets/./app/angular/optionalComponents/authorize.net/authorizeNetIntegration.html","webpack://UnataWidgets/./app/angular/components/productDetails/configurableProduct/configurableProductDropdown.mobile.html","webpack://UnataWidgets/./app/angular/constants/user.js","webpack://UnataWidgets/./app/angular/components/checkout/paymentGateways/payPal/paypalCheckout.html","webpack://UnataWidgets/./app/angular/components/shoppingSelector/contextSelector/contextSelector.html","webpack://UnataWidgets/./app/angular/components/search/views/search.html","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressProfile/icExpressProfile.html","webpack://UnataWidgets/./app/angular/components/reservation/views/timeslotSelectors.html","webpack://UnataWidgets/./app/angular/components/loyaltyOnboarding/views/loyaltyOnboardingModal.html","webpack://UnataWidgets/./app/angular/components/shoppingSelector/storeSelector/storeSelectorList.html","webpack://UnataWidgets/./app/angular/components/shared/facetedSearchBar/facetedSearchCheckbox/facetedSearchCheckbox.html","webpack://UnataWidgets/./app/angular/components/shared/typeahead/typeahead-match-modified-uibootstrap.html","webpack://UnataWidgets/./app/angular/components/account/orderHistory/views/purchase.html","webpack://UnataWidgets/./app/angular/components/productDetails/productDetailsPrice.html","webpack://UnataWidgets/./app/angular/components/shared/offers/continuityProgress.html","webpack://UnataWidgets/./app/angular/components/orderAddOn/orderAddOn.html","webpack://UnataWidgets/./app/angular/components/shared/facetedSearchBar/facetedFiltersBar/facetedFiltersBar.html","webpack://UnataWidgets/./app/angular/components/shared/facetedSideFilters/facetedSideFiltersCheckbox/facetedSideFiltersCheckbox.html","webpack://UnataWidgets/./app/angular/components/shared/offerDetailsModal/offerDetailsModal.html","webpack://UnataWidgets/./app/angular/components/shoppingSelector/views/parentShoppingSelector.html","webpack://UnataWidgets/./app/angular/components/shared/promoCodeModal/promoCodeModal.html","webpack://UnataWidgets/./app/angular/components/home/home.mobile.html","webpack://UnataWidgets/./app/angular/components/account/loyalty/loyalty.html","webpack://UnataWidgets/./app/angular/components/checkoutSteps/checkoutSteps.html","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressPopover/icExpressPopover.html","webpack://UnataWidgets/./app/angular/components/shared/shareListButton/shareListButton.html","webpack://UnataWidgets/./app/angular/components/home/home.desktop.html","webpack://UnataWidgets/./app/angular/components/shared/creditCardLogos/creditCardLogos.html","webpack://UnataWidgets/./app/angular/components/shared/couponUnclippedModal/couponUnclippedModal.html","webpack://UnataWidgets/./app/angular/components/shared/emptyResultsContextSwitcher/emptyResultsContextSwitcher.html","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressForm/icExpressForm.html","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressCancellation/steps/secondStep.html","webpack://UnataWidgets/./app/angular/components/shared/offers/offerProgress.html","webpack://UnataWidgets/./app/angular/components/account/nav/accountNav.html","webpack://UnataWidgets/./app/vendors/circles/circles.js","webpack://UnataWidgets/./app/angular/components/shared/facetedFilterModal/facetedFilterModal.html","webpack://UnataWidgets/./app/angular/components/account/orderHistory/views/cancelOrderModal.html","webpack://UnataWidgets/./packages/enterprise-timeslots/timeslots-dropdown/components/InputGroup.js","webpack://UnataWidgets/./packages/enterprise-timeslots/timeslots-dropdown/components/TimeslotSelectLoading.js","webpack://UnataWidgets/./packages/enterprise-timeslots/timeslots-dropdown/components/TimeslotSelectContainer.js","webpack://UnataWidgets/./packages/enterprise-timeslots/timeslots-dropdown/components/TimeslotSelect.js","webpack://UnataWidgets/./packages/enterprise-timeslots/timeslots/TimeSlot.js","webpack://UnataWidgets/./packages/enterprise-timeslots/timeslots/Day.js","webpack://UnataWidgets/./packages/enterprise-timeslots/timeslots/TimeSlotsLoading.js","webpack://UnataWidgets/./packages/enterprise-timeslots/timeslots/TimeSlots.js","webpack://UnataWidgets/./packages/enterprise-timeslots/timeslots/index.js","webpack://UnataWidgets/./app/angular/components/shared/relatedCoupon/relatedCoupon.html","webpack://UnataWidgets/./app/angular/components/shop/views/collectionPreviews.html","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressPostCheckout/icExpressPostCheckout.html","webpack://UnataWidgets/./app/angular/components/search/views/searchPosts.html","webpack://UnataWidgets/./app/angular/components/shared/paymentForm/paymentForm.html","webpack://UnataWidgets/./app/services/userList/selectors.ts","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressEntry/icExpressEntry.html","webpack://UnataWidgets/./app/angular/components/icFulfillmentBanner/icFulfillmentBanner.html","webpack://UnataWidgets/./app/angular/components/account/priceAlerts/priceAlerts.html","webpack://UnataWidgets/./app/angular/components/shop/views/empty.html","webpack://UnataWidgets/./app/angular/components/footer/footer.html","webpack://UnataWidgets/./app/angular/constants/events.js","webpack://UnataWidgets/./app/static/images sync ^\\.\\/payment\\-.*$","webpack://UnataWidgets/./app/angular/components/shared/addToList/addToList.html","webpack://UnataWidgets/./app/angular/components/account/notifications/notifications.html","webpack://UnataWidgets/./app/angular/components/productDetails/productDetailsDescription.html","webpack://UnataWidgets/./app/angular/components/maintenance/maintenance.html","webpack://UnataWidgets/./app/utils/getHtml5Url.js","webpack://UnataWidgets/./app/angular/components/shop/views/shopContent.html","webpack://UnataWidgets/./app/angular/components/shared/util/sideCartSubMenu.html","webpack://UnataWidgets/./app/angular/components/shared/recipeCell/recipeCell.html","webpack://UnataWidgets/./app/angular/optionalComponents/firstData/v1/firstDataIntegration.html","webpack://UnataWidgets/./app/angular/components/account/snapEBT/views/snapEBT.html","webpack://UnataWidgets/./app/angular/components/shared/productDetailsModal/productDetailsModal.html","webpack://UnataWidgets/./app/angular/components/shared/loyaltyInfo/loyaltyInfo.html","webpack://UnataWidgets/./app/angular/components/productDetails/configurableProduct/configurableProductDropdown.html","webpack://UnataWidgets/./app/angular/components/shared/filterModal/filterModal.html","webpack://UnataWidgets/./app/angular/constants/ssoProviders.ts","webpack://UnataWidgets/./app/angular/components/recipes/recipeCategories.html","webpack://UnataWidgets/./app/angular/components/shared/invalidCartItemsDisplay/invalidCartItemsDisplay.html","webpack://UnataWidgets/./app/angular/components/shared/sideCartSortModal/sideCartSortModal.html","webpack://UnataWidgets/./app/react/components/miniCart/utils.ts","webpack://UnataWidgets/./app/angular/optionalComponents/firstData/v2/firstDataIntegration.html","webpack://UnataWidgets/./app/angular/constants/geo_locations.js","webpack://UnataWidgets/./app/angular/components/shared/addToCartButton/templates/addToCartModify.html","webpack://UnataWidgets/./app/angular/components/shared/modifyQuantity/modifyQuantity.html","webpack://UnataWidgets/./app/angular/components/compareCart/views/compareCartModal.html","webpack://UnataWidgets/./app/angular/components/checkout/views/checkoutCart.html","webpack://UnataWidgets/./app/angular/components/shared/imageCell/imageCell.html","webpack://UnataWidgets/./app/angular/components/shared/util/modalTemplate.html","webpack://UnataWidgets/./app/angular/components/shop/views/merchandisedLandingPage.html","webpack://UnataWidgets/./app/angular/components/shared/productCell/productCell.ng.html","webpack://UnataWidgets/./app/angular/components/checkout/totals/cartTotals.html","webpack://UnataWidgets/./app/angular/components/shared/util/printInStoreList.html","webpack://UnataWidgets/./app/angular/components/shared/mobileAppPromotionBanner/mobileAppPromotionBanner.html","webpack://UnataWidgets/./app/angular/components/checkout/views/checkoutManualUpsell.html","webpack://UnataWidgets/./app/angular/components/shared/loadingDots/loadingDots.html","webpack://UnataWidgets/./app/angular/components/registration/views/registration.html","webpack://UnataWidgets/./app/angular/components/icExpress/views/expressProfilePage.html","webpack://UnataWidgets/./app/angular/components/checkout/views/checkoutPage.desktop.html","webpack://UnataWidgets/./app/angular/components/search/views/searchProducts.html","webpack://UnataWidgets/./app/angular/components/shared/shopModalHeader/shopModalHeader.html","webpack://UnataWidgets/./app/angular/components/shared/productPrices/productPrices.html","webpack://UnataWidgets/./app/angular/components/checkout/paymentGateways/houseAccount/houseAccount.html","webpack://UnataWidgets/./app/angular/components/shared/categoryCard/categoryCard.html","webpack://UnataWidgets/./app/angular/components/rxUpsell/rxUpsellModal.html","webpack://UnataWidgets/./app/angular/components/shared/videoModal/videoModal.html","webpack://UnataWidgets/./app/angular/components/shoppingSelector/storeSelector/storeSelectorListStores.mobile.html","webpack://UnataWidgets/./app/angular/components/shared/bannerForm/bannerForm.html","webpack://UnataWidgets/./app/angular/components/account/credits/credits.html","webpack://UnataWidgets/./app/angular/components/shared/offers/offerTile.html","webpack://UnataWidgets/./app/angular/components/reservation/views/timeslotSelectorState.html","webpack://UnataWidgets/./app/angular/components/shared/simplifiedHeader/simplifiedHeader.html","webpack://UnataWidgets/./app/angular/components/shoppingSelector/timeslotSelector/timeslotSelector.html","webpack://UnataWidgets/./app/angular/components/shared/productCell/cellOverlay.html","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressTimeslot/icExpressTimeslot.html","webpack://UnataWidgets/./app/angular/components/reservation/views/fulfillmentAddress.html","webpack://UnataWidgets/./app/angular/components/payments/stripe/stripeForm/stripeForm.html","webpack://UnataWidgets/./app/angular/components/offline/offlineNav.html","webpack://UnataWidgets/./app/angular/components/account/orderHistory/views/orderHistory.html","webpack://UnataWidgets/./app/angular/components/shop/views/shopCells.html","webpack://UnataWidgets/./app/angular/components/account/rateProducts/rateProducts.html","webpack://UnataWidgets/./app/angular/components/recipes/recipeDetailsModal.html","webpack://UnataWidgets/./app/angular/services/templates/alcoholValidation/alcoholValidationErrorModal.html","webpack://UnataWidgets/./app/angular/components/payments/creditCardList/creditCardList.html","webpack://UnataWidgets/./app/angular/components/icExpress/views/addCreditCardModal.html","webpack://UnataWidgets/./app/angular/components/shared/pickupForm/pickupForm.html","webpack://UnataWidgets/./app/angular/components/recipes/shopThisRecipeModal.html","webpack://UnataWidgets/./app/angular/components/modifyOrderBanner/modifyOrderBanner.html","webpack://UnataWidgets/./app/angular/components/shoppingSelector/storeSelector/storeSelectorMap.html","webpack://UnataWidgets/./app/angular/components/shared/addToCartButton/templates/addToCartButton.react.html","webpack://UnataWidgets/./app/angular/components/shop/views/waysToShop.html","webpack://UnataWidgets/./app/angular/components/checkout/views/checkoutConfirmation.new.html","webpack://UnataWidgets/./app/utils/isModuleEnabled.ts","webpack://UnataWidgets/./app/utils/currency.ts","webpack://UnataWidgets/./app/angular/components/shared/billingInformationForm/billingInformationForm.html","webpack://UnataWidgets/./app/angular/components/checkout/fulfillmentList/fulfillmentList.desktop.html","webpack://UnataWidgets/./app/angular/components/account/profile/profile.react.html","webpack://UnataWidgets/./app/angular/components/account/lists/lists.html","webpack://UnataWidgets/./app/angular/services/templates/recaptcha/recaptchaModal.html","webpack://UnataWidgets/./app/angular/components/flyerPreview/flyerPreviewModal.html","webpack://UnataWidgets/./app/angular/components/icExpress/views/expressGiftCardRedeemModal.html","webpack://UnataWidgets/./app/angular/components/shared/deliveryForm/deliveryForm.html","webpack://UnataWidgets/./app/angular/components/shop/views/shopMenu.desktop.html","webpack://UnataWidgets/./app/angular/components/offers/offerCollections.html","webpack://UnataWidgets/./app/angular/components/shared/couponClipper/couponClipper.html","webpack://UnataWidgets/./app/angular/components/orderAddOn/orderAddOnConfirmModal.html","webpack://UnataWidgets/./app/angular/components/shared/typeahead/typeahead-popup-template.html","webpack://UnataWidgets/./app/angular/components/shared/scheduleForm/views/weightDriftModal.html","webpack://UnataWidgets/./app/angular/components/shared/pageHeader/pageHeader.mobile.html","webpack://UnataWidgets/./app/angular/components/recipes/recipeDetailsController.js","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressCancellation/steps/forthStep.html","webpack://UnataWidgets/./app/angular/components/shared/pagination/pagination-modified-uibootstrap-mobile.html","webpack://UnataWidgets/./app/utils/placements.js","webpack://UnataWidgets/./app/angular/components/shared/promoCollectionCell/promoCollectionCell.html","webpack://UnataWidgets/./app/angular/components/shared/addressListForm/addressListForm.html","webpack://UnataWidgets/./app/angular/components/icExpress/views/postCheckoutCreditCardPage.html","webpack://UnataWidgets/./app/angular/components/icExpress/views/expressSignupModal.html","webpack://UnataWidgets/./app/angular/components/nav/views/sideNav.html","webpack://UnataWidgets/./app/angular/components/shoppingSelector/views/shoppingSelectorModalHeader.html","webpack://UnataWidgets/./app/angular/components/shared/giftCardModal/giftCardModal.html","webpack://UnataWidgets/./app/angular/components/account/orderHistory/views/order.html","webpack://UnataWidgets/./app/angular/components/registration/views/changePassword.html","webpack://UnataWidgets/./app/angular/components/shared/collectionModal/collectionModal.html","webpack://UnataWidgets/./app/angular/components/instacartCustomerLink/views/instacartCustomerLinkModal.html","webpack://UnataWidgets/./app/angular/components/checkout/paymentGateways/payPal/paypal.html","webpack://UnataWidgets/./app/angular/constants/collections.js","webpack://UnataWidgets/./app/angular/components/compareCart/views/compareCart.component.html","webpack://UnataWidgets/./app/utils/jsonLd.js","webpack://UnataWidgets/./app/angular/components/productDetails/productDetails.html","webpack://UnataWidgets/./app/angular/services/templates/alcoholValidation/alcoholValidationModal.html","webpack://UnataWidgets/./app/angular/components/shared/nutritionTable/nutritionTable.html","webpack://UnataWidgets/./app/angular/components/offers/offerDetails.html","webpack://UnataWidgets/./app/angular/components/shop/views/shopSubcategories.html","webpack://UnataWidgets/./app/angular/constants/loginContexts.js","webpack://UnataWidgets/./app/angular/components/sideCart/sideCartList.html","webpack://UnataWidgets/./app/angular/components/importIcAccount/views/importIcAccountSuccessModal.html","webpack://UnataWidgets/./app/angular/components/alert/alert.html","webpack://UnataWidgets/./app/angular/components/importIcAccount/views/importIcAccountErrorModal.html","webpack://UnataWidgets/./app/angular/components/shared/cartCompareDialog/cartCompareDialog.html","webpack://UnataWidgets/./app/angular/components/policy/views/policy.html","webpack://UnataWidgets/./app/angular/components/shared/productComments/productComments.html","webpack://UnataWidgets/./app/angular/components/shoppingSelector/cartListTransfer/cartListTransferState.html","webpack://UnataWidgets/./app/angular/components/shared/updateCreditCard/updateCreditCard.html","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressCancellation/icExpressCancellation.html","webpack://UnataWidgets/./app/angular/components/shared/cellContainer/cellContainer.html","webpack://UnataWidgets/./app/angular/components/checkout/views/customUpsell.html","webpack://UnataWidgets/./app/angular/components/shared/cartForm/cartForm.html","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressCancellation/steps/thirdStep.html","webpack://UnataWidgets/./app/angular/components/checkout/fulfillmentList/fulfillmentList.mobile.html","webpack://UnataWidgets/./app/angular/components/icExpress/views/expressPromoPlanChangeModal.html","webpack://UnataWidgets/./app/angular/components/account/addressBook/addressBook.html","webpack://UnataWidgets/./app/angular/components/registration/views/socialSignOn.html","webpack://UnataWidgets/./app/angular/components/checkout/views/checkoutPage.mobile.html","webpack://UnataWidgets/./app/angular/components/socialSignOn/socialSignOnLinkModal.html","webpack://UnataWidgets/./app/angular/components/shared/preferredPhoneNumberSelect/preferredPhoneNumberSelect.html","webpack://UnataWidgets/./app/angular/components/shared/rating/rating.html","webpack://UnataWidgets/./frontend-config/the-garden/static/images sync ^\\.\\/.*$","webpack://UnataWidgets/./app/angular/components/nav/registrationDropdown/profileMenu.html","webpack://UnataWidgets/./app/angular/components/shared/loyaltyCard/loyaltyCard.html","webpack://UnataWidgets/./app/angular/components/shared/tipPickerModal/tipPickerModalTemplate.html","webpack://UnataWidgets/./app/angular/components/nav/views/bannerSwitchingTabTemplate.mobile.html","webpack://UnataWidgets/./app/angular/components/home/homepageOrders.html","webpack://UnataWidgets/./app/angular/components/shared/priceAlertButton/priceAlertButton.html","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressSideCart/icExpressSideCart.html","webpack://UnataWidgets/./app/angular/components/productDetails/productDetailsTabs.html","webpack://UnataWidgets/./app/angular/optionalComponents/vantiv/vantivReturn.html","webpack://UnataWidgets/./app/angular/components/account/substitutions/substitutions.html","webpack://UnataWidgets/./app/angular/components/checkout/views/checkoutPayment.html","webpack://UnataWidgets/./app/angular/components/shared/pageHeader/pageHeader.search.mobile.html","webpack://UnataWidgets/./app/angular/components/shared/productCommentsV2/productCommentsV2.html","webpack://UnataWidgets/./app/angular/optionalComponents/braintree/braintreeIntegration.html","webpack://UnataWidgets/./app/angular/components/shared/provinceSelect/provinceSelect.html","webpack://UnataWidgets/./app/angular/components/mobileOnboarding/mobileOnboardingModal.html","webpack://UnataWidgets/./app/angular/components/nav/views/shoppingSelectorNav.html","webpack://UnataWidgets/./app/angular/components/shared/facetedSearchBar/facetedSearchTagCrumbs/facetedSearchTagCrumbs.html","webpack://UnataWidgets/./app/angular/components/productDetails/configurableProduct/configurableProduct.directive.html","webpack://UnataWidgets/./app/angular/components/shoppingSelector/storeSelector/storeSelectorListStores.desktop.html","webpack://UnataWidgets/./app/angular/components/checkout/views/unableToOpenPDP.html","webpack://UnataWidgets/./app/angular/components/shared/relatedProduct/relatedProduct.html","webpack://UnataWidgets/./app/utils/images/productImages.ts","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressSignin/icExpressSignin.html","webpack://UnataWidgets/./app/angular/components/search/views/searchRecipes.html","webpack://UnataWidgets/./app/angular/components/shared/cartSummary/cartSummary.html","webpack://UnataWidgets/./app/angular/components/home/home.html","webpack://UnataWidgets/./app/angular/components/checkout/views/checkoutReservation.html","webpack://UnataWidgets/./app/angular/components/shared/recaptcha/views/recaptchaCheckbox.html","webpack://UnataWidgets/./app/angular/optionalComponents/gigya/profileGigya.html","webpack://UnataWidgets/./app/angular/components/offline/offline.html","webpack://UnataWidgets/./app/angular/components/nav/registrationDropdown/registrationDropdown.html","webpack://UnataWidgets/./app/angular/components/shared/contactForm/contactForm.html","webpack://UnataWidgets/./app/angular/components/shared/tipPickerModal/tipPickerModal.html","webpack://UnataWidgets/./app/angular/components/orderAddOn/orderAddOnNav.html","webpack://UnataWidgets/./app/angular/components/shared/cellSlider/cellSlider.html","webpack://UnataWidgets/./app/angular/components/account/lists/list.html","webpack://UnataWidgets/./app/angular/components/icExpress/views/expressPlansModalNew.html","webpack://UnataWidgets/./app/angular/components/checkout/views/checkoutPage.html","webpack://UnataWidgets/./app/angular/components/shared/offerCell/offerCell.html","webpack://UnataWidgets/./app/angular/components/shared/sharedForgotPassword/sharedForgotPassword.html","webpack://UnataWidgets/./app/angular/optionalComponents/stripe/stripePaymentForm.html","webpack://UnataWidgets/./app/angular/components/productDetails/configurableProduct/configurableProductDropdown.desktop.html","webpack://UnataWidgets/./app/angular/services/templates/cartListTransferModal/cartListTransferModal.html","webpack://UnataWidgets/./app/angular/components/shoppingSelector/storeSelector/storeSelectorMapStores.desktop.html","webpack://UnataWidgets/./app/angular/components/account/passwordChange/passwordChange.html","webpack://UnataWidgets/./app/angular/components/shared/barcodeScannerButton/barcodeNotFound.html","webpack://UnataWidgets/./app/angular/components/sideCart/sideCartListMultiContext.html","webpack://UnataWidgets/./app/angular/components/shop/views/shopMenu.mobile.html","webpack://UnataWidgets/./app/angular/optionalComponents/wegpay/wegpayIntegration.html","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressPlans/icExpressPlans.html","webpack://UnataWidgets/./app/angular/components/shared/addressList/addressList.html","webpack://UnataWidgets/./app/angular/components/account/subscription/subscription.ng.html","webpack://UnataWidgets/./app/angular/components/shared/facetedSideFilters/facetedSideFilters.html","webpack://UnataWidgets/./app/angular/components/icExpress/icExpressAd/icExpressAd.html","webpack://UnataWidgets/./app/angular/components/shared/orderDeliveryInstructionsForm/orderDeliveryInstructionsForm.html","webpack://UnataWidgets/./app/angular/components/shop/views/featuredDepartment.html","webpack://UnataWidgets/./app/angular/components/inStoreList/review/inStoreListReview.html","webpack://UnataWidgets/./app/angular/components/checkout/fulfillmentList/fulfillmentList.html","webpack://UnataWidgets/./app/angular/components/shoppingSelector/cartListTransfer/cartListTransfer.component.html","webpack://UnataWidgets/./app/angular/components/account/subscription/subscription.react.html","webpack://UnataWidgets/./app/angular/components/icExpress/views/expressProfilePageNew.html","webpack://UnataWidgets/./app/angular/components/importIcAccount/views/importIcAccountModal.html","webpack://UnataWidgets/./app/angular/components/fulfillmentNotAvailableModal/fulfillmentNotAvailableModal.html","webpack://UnataWidgets/./app/services/product/selectors.ts","webpack://UnataWidgets/./app/angular/components/shared/pagination/pagination-modified-uibootstrap-desktop.html","webpack://UnataWidgets/./app/angular/components/mobileAppInfo/mobileAppInfo.html","webpack://UnataWidgets/./app/angular/components/shoppingSelector/views/unsupportedPostalCodeErrorModalTemplate.html","webpack://UnataWidgets/./app/angular/components/sideCart/sideCart.html","webpack://UnataWidgets/./app/angular/components/shared/continuityOfferCell/continuityOfferCell.html","webpack://UnataWidgets/./app/angular/components/errorPages/errorPage.html","webpack://UnataWidgets/./app/utils/cart.js","webpack://UnataWidgets/./app/angular/components/shop/views/flyerFlipp.html","webpack://UnataWidgets/./app/angular/components/rxRedirectError/rxRedirectErrorModal.html","webpack://UnataWidgets/./app/angular/components/shared/addToCartButton/templates/addToCartButton.ng.html","webpack://UnataWidgets/./app/angular/components/shop/views/shopPagination.html","webpack://UnataWidgets/./app/angular/constants/recaptcha.js","webpack://UnataWidgets/./app/angular/components/account/orderHistory/views/orderEditItem.html","webpack://UnataWidgets/./app/angular/components/nav/views/nav.mobile.html","webpack://UnataWidgets/./app/utils/formatSecondsToISO8601.js","webpack://UnataWidgets/./app/utils/appendStructuredData.js"],"names":["module","exports","angular","sleep","delay","Promise","resolve","setTimeout","validFileTypes","isValidFileType","type","includes","getLinkType","path","fragments","split","ending","length","preloadCheckoutPage","async","bundleFile","enterpriseAuthService","api","auth","getOneCartCheckoutAppBundle","checkoutAssetFiles","bundle","assetPaths","Object","values","map","filter","fragment","document","createDocumentFragment","forEach","link","createElement","rel","href","as","appendChild","head","e","captureException","whitelistedCookies","HTTP_ERRORS","config","$stateProvider","val","state","url","views","template","require","controller","$location","$state","lang","mobileService","utilService","env","shortCode","test","$$url","go","this","image","isMobile","loadAssetImage","title","message","buttonUrl","errorPages","buttonHref","buttonSref","buttonText","isReactRoute","controllerAs","component","bindings","run","$rootScope","analytics","$on","event","toState","toParams","fromState","fromParams","error","errorData","data","status","logEvent","location","ErrorPages","name","langProvider","loadCtrl","$ocLazyLoad","then","mod","load","default","catch","err","Error","titleService","setTitle","addressBookTitle","breadcrumbs","label","accountDetails","section","credits","user","getAll","response","items","availableCredits","parent","saveForLaterLists","listDetails","list","$stateParams","getList","list_id","copy","payload","_","saveForLaterListDetails","configConstants","loyaltyVanityUrl","loyaltyOptIn","userService","loyalty","enableLoyaltyOptIn","loyaltyPage","fetchLoyaltyCards","loyaltyCards","loyaltyCard","AUTH_ACTIONS","service","$injector","eComLightService","oneCartService","policyService","getAccountMenuItems","menu","sref","profile","externalProfileURL","extLink","disableChangePassword","gigya","enabled","concat","passwordChange","externalPasswordChangeURL","serviceName","authService","getAuthService","onClick","init","CHANGE_PASSWORD","accountMenuOptions","disableAddressBook","enableMultipleDeliveryAddresses","push","disableNotificationPreferences","notificationPreferences","disableOrderHistory","orderHistory","icExpress","ngIf","ic_linked","disableSubstitutions","inEComLightMode","substitutionPreferences","disableSaveForLaterLists","enableSavedRecipes","disableRecipes","savedRecipes","disableAvailableCredits","disablePriceAlerts","disabledMobileAccountMenu","priceAlerts","ebt","store","ebt_enabled_in_state","EBTSNAP","hasLoyalty","disableLoyaltyLinks","customerLoyaltyOverride","disableLoyaltyWhenAccountless","disableLoyaltyWhenEmployeeIdless","ext_data","employee_id","splice","hasSubscriptions","subscription","disableRateProducts","rateProducts","policyModal","showPricingPolicyInHeader","isPricingPolicyEnabled","open","viewPricingPolicy","accountMenu","ii","position","index","generateAddIdToSrefLinkWithPrefix","AccountMenuServiceModule","abstract","requireRegistered","lazyLoadControllers","AccountNavController","POWERED_BY","ORDER_STATUS","NEW","SHIPPED","CANCELLED","ORDER_TYPES","CART_TYPES","GROCERY","CATERING","ALCOHOL","PAYMENT_TYPES","AUTH_TYPES","SOURCES","UNATA","INSTACART","PAYMENT_POLYTYPES","PAYMENT_CONTEXTS","PAYMENT_PROVIDERS","STRIPE","VANTIV","WEGPAY","FIRST_DATA","AUTHORIZE","BRAINTREE","isNewFirstData","paymentGateway","getByName","$filter","$q","$sce","$scope","$timeout","$uibModal","cartService","catalogCategoriesService","checkoutService","configurableProductService","errorModalService","imageURLService","instacartService","order","orderFeesService","orderService","payment","productDetailsModal","registrationService","setPageHeaderTitle","assign","CHECKOUT_STEP_IDS","SHOPPING_MODES","shoppingIntent","getContext","intent","selectedItems","selectedMap","isOrderAddedToCart","top","bottom","orderTotalsLines","isAppLoading","currentOrder","getOneCartOrderRedirect","ic_order_redirect_id","resp","redirectToPBI","auth_token","action","OneCartActions","orderId","ic_order_id","orderHistoryView","showOrderTracker","id","source","selectAllCheckbox","value","outOfStockWarningPopover","trustAsHtml","outOfStockDescription","isItemOOS","item","enterpriseProductService","utils","isProductAvailable","store_product","estimatedRewards","estimated_totals","keys","reward_discounts","rewardKey","rewards","Math","abs","parseFloat","getFeeLabel","fee","fulfillmentLabel","fulfillment_type","getItemLineNumber","line_number","lineNumber","order_items","additional_order_items","addReorderableTag","isReorderable","product_config","selectItem","itemIndex","selectedItemsItem","isConfigEqual","options","selectAll","removeOrder","cancellingOrder","enterpriseServiceOrder","orders","remove","params","current","reload","sync","promptLogin","loginToContinue","error_code","dismissLabel","orderTracker","orderStatus","viewOrderProgressButton","orderModificationTooLate","ok","onDismiss","goToOrderInstacartLink","closed","reloadState","loadList","loadListToCart","loadAll","tip","goToInstacartLink","instacart_order_url","modifyOrder","unavailableItems","goToOrderModFlow","useItemEditFlow","orderModItemsUnavailableWarning","toString","continue","cancel","cancelOrder","orderCancellationConfirmation","yes","no","cancelOrModifyOrder","isShowModifyButton","openCustom","cancelOrderModalTemplate","doModifyImmediately","secondaryButtonLabel","editItems","cancelOrderModal","productsWithAvailabilityStatus","categories","isUnavailable","getOrderedCategoriesAndProductsWithCategories","orderedCategories","categorizedProducts","hideCreditCardForm","hideUpdateCreditCardError","hideUpdateCreditCardSuccess","toggleCreditCardForm","updateCreditCard","auth_capture","loading","update","payment_type","finally","updateOrder","requestOrderAddOn","showNonOrderTrackInstacartSection","instacart","enableDelivery","isProductDetailsModalDisabled","source_cart_type","showOfferDiscount","showOfferDiscountAndCreditsApplied","parseInt","offer_total","showInstacartLogo","showOnMobile","mobile","shoppingSelector","delivery","fulfilledByInstacart","FULFILLMENT_TYPES","DELIVERY","showDeliveryInstructions","newCheckoutFlow","checkoutPage","stepsOrder","find","step","showCreditsApplied","credit_total","showTipAndRatingButton","isShowTipAndRatingButton","shouldShowAddSelectedItemButton","currentShoppingMode","getCurrentShoppingMode","orderType","timeslotLabelFn","timeslotUtils","getMainLabel","verboseLevel","format","apiDateFormat","showInlineExternalProgressButton","disableViewOrderProgress","showInlineExternalPickupButton","pickup_status_url","disableTipAndRating","INSTORE_LIST","can_modify","isOrderAddOnVisible","enableModifyOrderAddOn","can_add_items","isShowCancelButton","can_cancel","isShowOrderDetailButton","isShowPickupDetailButton","PICKUP","enableModifyButton","modifyingOrder","enableCancelButton","goToPickupInstacartLink","orderTrackResources","modifyButtonLang","undefined","poweredByInstacart","fulfillmentTypeLang","getOrderTotalsLines","setOrderTotalsLines","estimatedTotals","finalTotals","final_totals","fees","addOrderTotalLineValue","shouldAdd","additionalProps","subtotal","pre_discount_product_total","creditsApplied","offerDiscount","refundTotal","refund_total","reward","tip_total","subscriptionTotal","subscription_total","tax","tax_total","formattedFees","total","isUseItemEditFlow","isUseRescheduleOrderButton","useRescheduleOrderButton","jumpToCheckout","initialStep","enterModifyState","isUseModifyOrderPaymentButton","readOnlyPayment","useModifyOrderPaymentButton","isPaidWithCreditCard","payment_instruments","$templateCache","put","useMostRecentPagination","orderPaginationStack","filters","from_date","dayjs","startOf","subtract","to_date","endOf","thisYear","year","transactionStartYear","dayjsYear","getOrderListParams","limit","after","order_cursor","getPurchaseListParams","purchase_cursor","selectedRange","dateRange","String","filterTypes","showInStore","showOnline","orderHistoryOptions","inStoreOnline","inStore","online","selectedType","filterByType","resetFilterState","nextPageOrders","nextOrderCursor","nextPurchaseCursor","prevPageOrders","pop","getBanner","warehouseId","multipleBanners","banners","banner","bannerExtId","handleViewOrderClick","setFilter","orderQueryParams","purchaseQueryParams","one_cart_enabled","user_timezone","Intl","DateTimeFormat","resolvedOptions","timeZone","_meta","order_meta","purchases","purchase_meta","all","fulfillment_date","timestamp","warehouse_id","loadImg","fallback","UNIT_OF_MEASURE","EACH","LB","KG","Restangular","offersService","savedOrderItemStash","orderEditItemsFor","pickup","originalOrderItems","modifyOrderItems","comment","customer_comment","mobileShowNotesAndSubs","currencyFilter","getMinCartSpend","shoppingListService","commonUtils","getMinimumCartSpend","substitutions","allowAllSubstitutions","every","allow_substitutions","orderTotals","orderTotalLines","isCalculationRequestLoading","isCalculationRequestBuffered","isCalculationRequestDebounced","cloneDeep","modifyOfferProgress","offer_progress","clampedItemQuantity","quantity","min","max","ordering_parameters","Infinity","appendedItems","hasAppendedItems","newItem","existingItem","newQuantity","totalItemCount","uom","display_uom","toUpperCase","sub_total","base_price","actual_quantity","convertNewItemToEditItem","lastValidCalculateResponse","updateCategorizedItems","isTotalBelowMin","cartMinimum","product_total","setEstimatedOrderTotals","totals","itemTotal","updateModifyItem","valuesToUpdate","updateView","foundItem","modifyItem","updateItemComment","toggleAllowSubstitutions","isAllowSubstitutionsDisabled","toggleAllowAllSubstitutions","removeItem","foundItemIndex","findIndex","handleCalculateOrderTotals","removeItemIfMin","relativeQuantityChange","showDeleteConfirm","incrementItem","decrementItem","updateItemQuantity","cancelRemoveItem","generateUniqueItemId","generateConfigIdString","enableAllowSubstitutionsForConfigurableItems","isItemCurrentlyOutOfStock","setMobileShowNotesAndSubs","isShown","calculateOrderTotals","dateOfBirth","user_birthday","toISOString","one","post","debouncedCalculateOrderTotals","debounce","isCalculationLoading","saveOrderModifications","isModified","isEqual","orderItems","postOrder","orderModifiedSuccess","discardOrderModifications","addItemsToOrder","orderEditItemStash","itemHasOffer","getCartItemIdsFromOffers","localStorageService","queryParams","add_to_order","authFunction","indexOf","getCertifiedDeliveryRedirect","CERTIFIED_DELIVERY","isMobileApp","localStorage","setItem","deprecatedSet","LOGIN_CONTEXTS","REDIRECT_ONECART_ORDER_STATUS","purchase","noneSelected","OrderController","OrderHistoryController","OrderEditItemController","OrderIcRedirectController","PurchaseController","templateUrl","nextCursor","squash","onlineOrderHistory","deferred","defer","get","promise","customPageHeaderTitle","orderDetails","with_offer_progress","onExit","orderEditItems","onEnter","useItemEditAddFlow","vmExtras","PARENT_ROUTE","isCancellingOrderModification","removeItems","cart","cancelOrderModification","$lazyLoadControllers","OrderAddOnController","OrderAddItemsController","$getOrder","edit","addItems","isAddOnFullProductCell","isLoading","isOrderAddOnInline","productsPerPage","searchCategories","upsellResults","inStorePurchases","purchaseDetails","$ocLazyLoadProvider","changePassword","enableProfileEdit","showLoyaltyReadOnly","subscriptions","isProfilePageEnabled","redirect","$uibModalInstance","ebtCardService","ebtCardNumber","validEbtCardInput","showAddError","loadingRequest","validateCard","addCard","close","userAnalytics","deactivateEbtFailed","handleRemoveError","handleRemoveSuccess","logUserRemoveEbtCard","removeEbtCard","SnapEBTAddModalController","SnapEBTRemoveModalController","AddressBook","Credits","Lists","Loyalty","Nav","Notifications","Orderhistory","Passwordchange","Pricealerts","Profile","Rateproducts","Subscription","Substitutions","SnapEBT","compareCartService","isValid","originalAddress","recommendedAddresses","vm","field","selectedAddress","address","editAddress","$broadcast","itemId","initialAddress","dismiss","confirmSelectedAddress","selectedAddressPayload","address1","address2","address3","city","postal_code","province","updatedAddress","delivery_address","ADDRESS_FIELDS","ADDRESS_LINE_ONE","ADDRESS_LINE_TWO","ADDRESS_LINE_THREE","CITY","FIRST_NAME","INSTRUCTIONS","LAST_NAME","PHONE_NUMBER","POSTAL_CODE","PROVINCE","COUNTRIES","COUNTRY_DIAL_CODES","QUEBEC_POSTAL_DISTRICT_LETTERS","ngPromise","ADDRESS_KEYS","openModal","addressData","keyboard","backdrop","original","recommended","result","validateAddress","wrapper","userAddresses","validate","addressObject","areAddressesSame","firstAddress","secondAddress","key","createRecommendationsList","suggestions","currentAddress","suggestedAddress","addressDiffObject","stringDiff","addressValue","changed","Boolean","isAddressComplete","optionalFields","addressKey","AddressValidationModalController","AddressValidationService","ALERT_ICON_MAP","transclude","closeable","disableBorder","icon","noticeClass","onClose","rememberCloseStatusById","smallText","storageService","storage","$onInit","context","getItem","alreadyClosedArray","isClosed","isAlertVisible","isVisible","JSON","stringify","Alert","restrict","$element","$window","container","content","querySelector","parseScrollLeft","style","transform","replace","queryCells","querySelectorAll","queryFocusableElements","element","updateCells","direction","focusFirst","cells","minOffset","clientWidth","maxOffset","scrollLeft","firstCell","cell","cellOffset","offsetLeft","hidden","offsetWidth","getAttribute","setAttribute","visibility","partiallyHidden","dataset","tabIndex","Number","focus","updateButtons","$applyAsync","showPrevious","showNext","args","slideTimeout","slide","offset","reverse","translateX","mutationObserver","MutationObserver","mutations","some","addedNodes","nodeType","Node","ELEMENT_NODE","disconnect","observe","childList","ResizeObserver","onResize","throttle","addEventListener","removeEventListener","Carousel","getElementsByTagName","initWatson","loadWatsonAssistantChat","chatIntegration","parameters","instance","render","DATA_ATTR_REGEX","parametersToAttributes","el","loadScript","onLoadCallback","attributesCallback","scriptTag","src","scriptSrc","onload","insertBefore","firstChild","outerScriptTag","param","initBotCopy","start","chatIntegrationModule","paymentGatewayProvider","registerGateway","noSettingsRequired","checkoutAnalytics","loaded","ready","checkout","optionalData","postCheckoutRoute","logCheckoutStep","logCheckoutCompletion","logCriteoOrderConfirmation","placeOrderClick","success","logFBPurchase","initializeRecaptcha","recaptchaSetupCallbackOrObject","reject","paymentsEnabled","siteKey","googleRecaptcha","recaptchaException","setupObj","show","ACTIONS","CHECKOUT","onRecaptchaSuccess","token","onRecaptchaExpired","isRecaptchaError","optionalPromise","isRecaptchaAbort","templateCheckout","newCheckoutCssClass","addressList","paymentId","window","match","payerId","ordersParams","paypal","payment_id","payer_id","return_url","getAddressFromId","address_id","deprecatedGet","approval_url","defaultPayments","houseAccountPayment","reservationService","house_account","$watch","reservation","timeslot","digitLength","maxHouseAccountLength","inputPlaceHolder","shouldValidateHouseAccount","houseAccountDigits","paymentTypes","inputPattern","houseAccountRegexPattern","RegExp","REFLECTION","wrapOriginalFn","decoratorTarget","wrappingFn","_initializer","initializer","originalFn","apply","arguments","that","callOriginalFn","customThis","customArgs","originalThis","AUTO_SUCCESS","sources","Requirements","requirements","targetFn","pluralReqs","pluralRequirements","requirement","Plural","sourceItemKey","pluralPostixFn","destPluralPostixFn","sourcePluralKey","pluralArray","Array","isArray","destKeys","results","input","output","obj","outKeys","firstKey","getValue","createPayload","requiredInfo","reduce","out","factory","console","logAnalytics","eventName","analyticsPayload","analyticExtras","logSegmentEvent","warn","persistentStateFactory","localStoreId","getValueFn","setValueFn","refreshDelay","storeTimeout","isConfirmed","lastValue","getExpiringValueFromStore","isEnter","uuidv4","setExpiringValueToStore","availabilityViewEvent","timeSlots","timeSlotPayload","delivery_related","warehouse_location_id","slot","delivery_fee","shop_fee","available_ind","unavailable","delivery_option_name","within_hours","delivery_option_id","EVENTS","VIEW_AVAILABILITY","CART","VIEW","EDIT_QUANTITY","ADD_PROMO","MODIFY_NOTE","CHECKOUT_CLICK","CART_MERGE","ENTER_CHECKOUT","EXIT_CHECKOUT","ENTER_UPSELL","COMPLETE_UPSELL","ENTER_REVIEW","CART_COMPARE","CLICK_EDIT_CART","SELECT_FULFILLMENT","VIEW_FULFILLMENT","EDIT_FULFILLMENT","CONFIRM_FULFILLMENT","VIEW_TIMESLOTS","SELECT_TIMESLOT","VIEW_CONTACT","EDIT_CONTACT","VIEW_PAYMENT","EDIT_PAYMENT","ADD_CREDIT_CARD_OPEN","ADD_PAYMENT","VIEW_TIP","EDIT_TIP","CLICK_PLACE_ORDER","PLACE_ORDER_COMPLETE","STORE","ADD_OFFER","VIEW_OFFERS","USER","LINK_LOYALTY_CARD","LOGIN","LOGIN_ATTEMPT","LOGIN_START","LOGOUT","REGISTRATION_ATTEMPT","REGISTRATION_EXIT","REGISTRATION_START","UPDATE_PROFILE","LOYALTY_ONBOARDING_EXIT","LOYALTY_ONBOARDING_START","LOYALTY_ONBOARDING_FORGOT_PASSWORD","LOYALTY_ONBOARDING_SOCIAL_SIGN_ON","LOYALTY_ONBOARDING_THANKYOU_CTA_CLICK","LOYALTY_ONBOARDING_THANKYOU_START","EBT_ADD_CARD","EBT_REMOVE_CARD","EBT_CLIENT_TOKENIZE_FAILED","SSO_REDIRECT","FORCED_LOGOUT","CHECKOUT_STEPS","CART_ANALYTICS","cart_id","getCartId","getCartInfoAnalytics","item_details","getItemDetails","fulfillment","CHECKOUT_ANALYTICS","getContextDetails","getOrderDetails","getPaymentDetails","shop","getShopDetails","getTipDetails","upsell_products","getProductListAnalytics","FLOW_ANALYTICS","checkout_id","source_type","getSourceType","source_value","getSourceValue","OFFER_ANALYTICS","offer","getOfferDetails","offer_via_item","getItemDetail","TIMESLOT_ANALYTICS","getTimeslotDetails","ANALYTICS","FLOW","OFFER","RESERVATION","TIMESLOT","USER_PAYMENT_ACTION","ITEM_QUANTITY_IDENTIFIER","WEIGHTED_LB","WEIGHTED_KG","UNWEIGHTED","PAGE","SEGMENT_SPONSORED_SOURCE","brand_name","brand","tags","allow_alcohol","day_of_week","from_time","to_time","description","offerName","offer_type","offerType","completion_count","condition","offerCondition","offerReward","clipped","days","limit_basket","promo_code","terms","urlSlug","startsWith","gift_cards","amount","customer_first_order","option","customAmount","clonedContext","cart_instance_id","tokens","createTokens","getBuildConfig","theme","$anchorScroll","alcoholValidation","confirmationModal","couponUnclippedModalService","express","listPrintService","loyaltyService","manualUpsellService","mobileNativeHrefService","navService","promoCodeValidationService","reactCartLoyaltyBalanceDefaultProps","shoppingSelectorService","upsellProducts","setTotalRewards","getVisibleRewards","cart_totals","getCurrentCartType","IC_PLACEMENTS","showNotesSubs","hasCartItems","getCartTypeToItemsMap","product_type","isNewCheckout","cartReviewPage","showLoyaltyCartPagePlacement","showLoyaltyPlacement","cartPage","showLoyaltyCardBalance","isNaN","getLoyaltyCard","points_balance","showLoyaltyBalanceInCart","loyaltyReactProps","styles","color","primary","dark","initialCartItems","initialCartComment","fetch","handleDeleteConfirmCancelClick","itemID","removeButtonForItem","getElementById","handleExpressPlacementClick","acknowledgePlacement","SIDECART","emptyCartMessage","noItemsInCart","shoppingMode","getCartListReviewItems","shouldShowCartUpsell","cartUpsellCollection","upsellItems","isOpen","inCatering","handleSubistitutionNotesDiscard","currentEnterpriseService","actions","categorizeProducts","sortedProductsBy","orderedGroups","dataByCartType","getCategorizedProductsAndCategories","productsByCategory","category","createCartTypeToCategoryMapping","getDataByCartType","useMultiContextCart","productsSortedByAisle","sortProductsByAisle","aisle","getAllProductsByAisle","sort","a","b","localeCompare","updateItemAllowSubstitutions","setAllowAllSubstitutionsToggle","substitutionCommentUpdate","promo","promo_","addPromo","checkIfValidPromoCode","offer_id","getOfferData","promo_codes","promoCode","loadCartUpsell","plain","isSelected","disableAisles","isSubstitutionNotesOpen","goToProductDetailsModal","store_id","getStore","currentWarehouse","store_banner","productBanner","productWarehouse","strings","cantOpenPdpTitle","productType","cart_type","cantOpenPdpMessage","confirm","cantOpenPdpSwitchTo","cantOpenPdpStayIn","unableToOpenPDP","proceed","has_changed_store","setContext","storeNumber","retailer_slug","bannerSlug","fetchCategories","sendUserUpdatedStore","analyticsSourceKeys","proceedToNextCheckoutStep","enableCheckoutManualUpsell","manualUpsellProducts","upsellPage","shouldUseGigyaAddressEdit","openNativeInWebview","openNativeInWebviewOnlyiOS","isIOS","openCheckoutInInappBrowser","inherit","checkoutCartContinue","analyticsValue","proceedToCheckout","logBeginCheckout","logCheckoutCTAClick","cart_items_count","cart_total","pickup_fee","tip_percent","order_id","cart_products","i","getClickAnalyticsPayload","continueCallback","checkoutClick","isUnclippedCouponProgressComplete","isThereUnclippedCouponWithProgressComplete","scrollIntoView","alcoholCompliance","getHasAlcohol","leave_unattended","alcoholValidationErrorModalTemplate","isAlcoholError","cartEditQuantity","$originalQuantity","$onZeroFn","isZero","openPromoCodeModal","promoLink","getElementsByClassName","modifyNote","note","visible","syncing","canvas","modifiedProgressSegments","placementsService","rateApp","isPickup","postCheckoutPlacementEnabled","isPlacementConfigEnabled","POST_CHECKOUT","imageTransform","marker","isFromNewCheckout","isSubscribed","isSubscribing","mapTitle","orderObject","progressSegments","userCurrentSubscription","icExpressSavingAmount","expressOrderSuccessText","orderSuccessNewExpressDelivery","retailer","clientName","expressName","onClickIcExpress","handleSubscribe","getLastUsedPaymentInstrument","hasSubscription","getInstructions","orderInstructions","getCurrentSubscription","orderCartType","remainingCartType","getCartTypes","cartType","remainingCarts","mobileAppRate","callOnCheckout","promptAppReview","updateContextAndRedirectToCheckout","setIntent","getOrderConfirmationPlacement","firstPlacement","logImpression","orderConfirmationPlacement","handleImagePlacementClick","placement","getGeocodeAddress","features","locations","longitude","latitude","center","nextState","moreThanOneRow","innerWidth","filterCurrencyFn","currentEditStep","gatewayService","isPlaceOrderButtonEnabled","isPlacingOrder","termsAndConditionsMessage","termsAndConditionsMessageDeferredAuth","termsAndConditionsByIntent","full_auth_will_defer","customAuthAmount","getAuthorizationAmount","focusOnPage","containerToFocusOn","trapFocusOn","handleValidationChange","handleStepEditMode","stepID","handleExpressSubscribeError","subscriptionErrorMessage","shouldSubscribeToExpress","isIcExpressOptedIn","MEMBERSHIP_STATUSES","TRIAL_ELIGIBLE","MEMBERSHIP_ELIGIBLE","getMembershipStatus","shouldSubscribeToExpressPostCheckout","shouldCreateSubscriptionAtCheckout","placeOrder","membershipStatus","planId","getPlanIds","EXPRESS_SUBSCRIPTION_PLAN_TERMS","TRIAL","YEARLY","ext_id","ext_payer_id","payment_instrument","subscription_plan_id","subscribe","handleExpressSubscribe","handleBillingInformationCheckout","handleGenericError","setError","defaultErrorMessage","isDelivery","billing_address","enableBillingInformation","isBillingAddressSameAsDelivery","getSelectedDeliveryAddress","updateProfile","isBillingAddressValid","invalidBillingAddress","_handleCheckoutSuccess","firstOrder","placements","FIRST_ORDER_KEY","isCartValidated","additionalParams","checkoutErrorCallback","performCheckout","handlePaymentUpdate","getService","handleContactUpdate","contact","goBack","handleCheckoutExit","showTermsAndConditions","isRewardsEnabled","isCartBelowMin","desktopTemplate","mobileTemplate","subscriptionsService","giftCard","cartIsValidated","tipIsValid","form","modifiedOrder","existingPaymentInstrument","existingPaymentType","paymentContext","checkoutNewCreditCard","addPaymentOption","user_action","onShowCardForm","addCreditCardOpen","validateCart","validated","subscriptionLabel","product","currentSubscription","getSubscription","found","loadImage","paytype","addGiftCard","giftCardNumber","giftCardAmount","giftCardLength","giftCardsClone","card_number","removeGiftCard","lastUpdated","_newVal","_oldVal","giftCards","getPaymentTypes","payment_types","inAppBrowser","p","updatePaymentType","editPaymentOptions","paymentLabel","paymentTypeValid","selectedGateway","getTemplate","waitingForCheckout","addSubscription","addItem","paymentPageCompletion","submitBillingInformation","hasICAccountLinked","enableAccountLinking","hasFailedLoadingMultipleDeliveryAddresses","addressesLoaded","shouldShowPaymentWarning","paymentWarning","addressValidationService","storesService","stateParams","showMultipleDeliveryAddresses","showStoreMap","showMapWhenDelivery","addressValidationModalClosed","selectedDeliveryAddress","forms","forceContextIntentSet","postalCodePattern","initDeliveryAddressModel","sourceData","deliveryAddress","first_name","last_name","company_name","instructions","deliveryAddressPhoneNumberFields","primary_number_key","phone","defaultRequired","initialDeliveryAddress","contextAddress","getAddressFromContext","getInitDeliveryAddress","deliveryAddressChanged","goToNextStep","editFulfillmentOptions","saveDeliveryAddress","postalCodeChanged","deliveryPostalCode","addressChanged","street_address","checkDelivery","shoppingContextProcess","requireFullAddress","updateUser","updateUserPayload","deliveryAddressResponse","isDeliveryAddressComplete","enableExternalAddressValidation","checkAddressValidated","validateAddressAndSaveIfChanged","validateFulfillmentContactInfo","formIsDirty","deliveryAddressForm","$dirty","setPreferredPhoneNumber","numberType","showAddressChangedModal","deliveryMismatchedPostalCodes","addressUpdated","addressParams","getContextFromAddress","addressUrlParams","getUrlParamsFromAddress","delivery_postal_code","show_delivery","stores","noDeliveryToPostalCodeError","storeUnchanged","cartCompareCheck","compareCart","storeSuggestionError","showStoreChangedModal","$interval","inCheckout","showHomeStore","showDeliveryFees","handleProfileThroughGigya","isReservationExpired","fetchAddressPromise","gigyaService","handleAddressEdit","gigyaCheckoutAddress","reservationInterval","expiration","utc","diff","deleteReservation","expiryLabel","minutes","seconds","floor","handleDeliveryValidation","errorType","successCallback","postalCode","modalTitle","handleStoreNotInListError","DEFAULT_TIMESLOT_DATE_FORMAT","toPayment","setDeliveryAddress","validateDelivery","res","DefaultPaymentServiceModule","PaypalPaymentServiceModule","HouseAccountPaymentServiceModule","HouseAccountControllerModule","CheckoutCartControllerModule","CheckoutConfirmationController","CheckoutManualUpsellController","CheckoutPageController","ReservationController","FulfillmentAddressController","ReservationConfirmationController","CheckoutPaymentController","fulfillmentListTemplate","modalOptions","shoppingContextService","$ctrl","userStore","shoppingIntentTitle","getShoppingModeTitle","pleaseSelect","showContextChangeBtn","exists","showOrderOnlineButton","canOrderOnline","openShoppingSummary","orderNotesEditing","openZipCodeModal","showBackButton","openScheduleModal","showTimeslotSelectLaterLink","saveOrderNotes","toggleOrderNotes","handleChangeStoreClick","reset","setOptions","offers","cssClass","showFees","isOrder","getTaxTotal","getFinalTaxTotal","getEstimatedTotal","getCartFinalTotal","getTotalsNote","intentTotalsNote","isPickFeesVisible","additional_fees","isSubscriptionFeesVisible","isDeliveryFeesVisible","provider","gateways","gateway","$get","gateWayNotFound","ReferenceError","PaymentGateway","Checkout","Totals","FulfillmentList","CheckoutSteps","constructor","instacartCustomerLinkModalService","editStep","isAccountLinked","showLinkingAccountModal","modals","shouldShowModal","linkLater","forceSkippableState","onCheckoutExit","openNextSection","hasOpenSection","paymentService","hasSelectedCateringStore","brokenDownStepsOrder","_breakDownReservationStep","steps","initializeSteps","stepNames","paymentIsInitialStep","PAYMENT","initializePayment","existingGiftCards","paymentType","onPaymentUpdate","scheduleStep","SCHEDULE","isCurrentStepBeforeScheduleStep","currentStep","_isScheduleValid","initializeStores","initializeOrderDeliveryInstructions","setOrderDeliveryInstructions","getModifyOrderDeliveryInstruction","leaveUnattended","getOrderDeliveryInstruction","fetchInitialInformation","getProfile","fetchStores","getCartPayment","isModifyingOrder","shouldLinkAccount","hasAccountBeenCreated","linkAccount","setInitialAddress","fulfillmentType","handleInitialDeliveryAddress","phone_number","_showModals","fetchWithCart","_validateCartAndOpenNextSection","handleError","isReady","initializeCheckout","_isValid","onValidateChange","closeStateSettled","CLOSE_CHECKOUT_STEPS_SETTLED","RESET_CHECKOUT_STEPS","EDIT_CHECKOUT_STEP","openInitialStep","modifyingInstacartOrder","_isDeliveryAddressValid","stepsStatuses","valid","validateDeliveryPostalCode","deliveryStatus","handleDeliveryAddressError","_handleAddressAppliedSingleBanner","validateAndOpenNext","_handleAddressAppliedMultiBanner","BANNER","handleAddressApplied","fetchBanners","handleInvalidPostalCodeError","initializeContact","setContact","onContactUpdate","handleContactInfoSave","handleOrderDeliveryInstructionsSave","hasAlcohol","clearOrderDeliveryInstructions","INSTORE","show_ecommerce","show_catering","show_pickup","editMode","CONTACT","orderDeliveryInstructionsStep","ORDER_DELIVERY_INSTRUCTIONS","filteredSteps","disabled","resetSteps","onStepEditMode","onPaymentSave","hasBeenEdited","abortEdit","orderedSteps","validStepNames","deepCopySteps","hasStep","RESERVATION_BREAKDOWN","nextStep","cartSize","countItems","showCartUpdatedMessage","cartChangeSize","cartUpdated","cartUpdateMessage","addedTo","removedFrom","changeSize","changeType","itemText","body","updateMessage","logCheckoutErrorAnalytics","scrollTop","isUserInitiated","_isPaymentValid","_isPickupStoreValid","_isContactInformationValid","_isOrderDeliveryInstructionsValid","_updateDisabledStatus","disableNextSteps","getNextIncompleteStep","handlePickupApply","hasChanged","validateAndOpenNextSection","shouldRecalculateFees","handleCartCompareChange","sendAvailableStoreContexts","defaultStoreID","alwaysOpenStoreSelectorCatering","maxNameLength","orderDeliveryInstructions","during_blackout","isDeferredAuth","checkValidationPayloadForEmptyValues","cartValidationPayload","hasEmptyValue","hasEmptyDeliveryAddress","withFees","cartValidateInfo","getValidationPayload","with_fees","_handleValidateCartSuccess","_handleValidateCartError","handleScheduleFormSave","validateWithFees","TIMESLOT_UNAVAILABLE_ERROR","onCancelAddressEdit","onChangeBanner","checkoutSteps","collection","enablePlacements","fullWidth","layout","hideBorder","attributeAddToCartEvents","hideViewMore","mobileColumnLayout","enableReactCollection","react","enableProductCollection","isReactDemo","srefParams","collection_id","isFull","hasMore","item_count","enableFullTileOnMobile","enableFullTileOnMobileCollections","formattedPlacement","formatImagePlacementForAnalytics","ProductCollection","customCartCompareConfig","getAllStoreProductsInCart","cartCompareProductLists","cartComparelists","configurable_product_leadtime","configurableProductLeadtimeList","offersList","product_blackout","productBlackoutList","product_inventory","productInventoryList","product_pricing","productPricingList","changedProductLists","changedProductIds","flaggedProductsByCategory","uncategorizedCategory","getStoreProductCategory","products","filteredProducts","omitChanges","CART_COMPARE_TRIGGERS","PRICE","pricingChanges","Set","has","_filterProducts","productInventoryListIds","productId","hasProductInventoryChange","productInBlackoutList","hasProductBlackout","blackoutMessage","productInConfigLeadtimeList","hasConfigurableProductLeadtime","configurableProductLeadtimeMessage","productInPricingList","listObj","hasProductPricingChange","newPrice","new_price","oldPrice","old_price","hasFlaggedProductsByCategory","getOffer","flaggedOffers","hasFlaggedOffers","compareCartNotice","compareCartNoticeProductsAndOffers","compareCartNoticeProducts","compareCartNoticeOffers","cartCompare","defaultShoppingContext","customCartCompare","canProceed","_getCustomCartCompareConfig","changeIn","change","selectedFulfillmentType","CART_COMPARE_CHANGES","FULFILLMENT","customCompareConfig","c","from","additionalInfo","to","changes","x","triggeredBy","numCategorized","numCustom","countCustomItems","numTotal","betweenCartAndList","transferData","isFulfillmentTypeCatering","catering","eComLight","disableCompareCart","numTransferable","transferableProducts","cartOrList","addressItems","province_short","_getDeliveryAddressParams","lists","hasInStoreMarkup","unavailableCategorizedProductIds","numUnavailable","hasPriceChanged","hasOffersChanged","hasAvailabilityChanged","shouldShowCartCompare","STOCK","dismissHandler","dismissed","disableClose","modal","modalOpen","cartChanges","cartCompareTriggers","size","CompareCartComponent","CompareCartRoutes","CompareCartModalController","CompareCartService","ExternalPage","currentFlyer","flyerCategoriesAndPdfsService","flyerPreviewService","previewFlyers","previewToken","selectedPreviewToken","goToFlyer","toFlyerPreviewToken","getPreviewToken","setPreviewToken","clearFlyerCategories","FlyerPreviewModalControllerModule","flyerData","hasPreviewFlyers","previews","addDateRangeLabel","flyer","startDate","start_date","endDate","end_date","add","flyerPreviewOverlapDays","startDateFormat","dateRangeLabel","flyerBeingViewed","preview_token","FlyerPreview","headerFooterSyncService","footerPrimaryLinks","footerSyncError","currentYear","Date","getFullYear","afterFooterLoaded","useAngularFooter","enableFooter","disableFooterLinks","waysToShop","weeklyAd","loggedIn","customFooterPrimaryLinks","footerSecondaryLinks","dotComModule","enableHeaderFooterSync","fetchFooter","html","dotComFooter","FooterModule","appendMetaTagDescription","descriptionContent","$urlRouterProvider","home","metaTagDescription","waitForRetailerScript","allowPassingCollectionIDAsQueryParams","homepage","when","tileSize","hrefOpts","isRecipe","isMLP","hrefStateParams","category_id","recipe_category_id","mlp_id","mlp_slug","isIdsTile","enableIdsCategoryTile","reactProps","imagesObj","getRecipeCategoryImageURL","images","tile","width","height","alt","linkObj","titleObj","iconClass","text","CategoryCard","Home","mainPage","profilePage","urlName","subscriptionPageTitle","isMember","isTrial","isCoupon","cancelPageTitle","showNewProfilePage","ExpressCancelFirstStep","EXPIRATION_DATE_FORMAT","adList","getAdList","$apply","getSubtitle","trialSubtitle","membershipSubtitle","cancellation","firstStep","daysLeft","getMembershipRemainingDays","getRenewReminderText","membership","trial","plan","templateAsString","renewReminder","getBottomText","trialBottomText","membershipBottomText","getPlanType","useIcTheme","onContinueClick","onSendReminderClick","termsOfService","subTitle","bottomText","planLabel","getPlanPriceText","membershipButtonLabel","getMembershipButtonLabel","secondStep","buttonLabel","price","shortName","chargeDate","getMembershipEndDate","planPrice","plans","monthly","onUpdateMembershipClick","_getOptions","cancelMembership","onMembershipCancelClick","cancelOption","details","cancelText","getCancellationTitle","membershipCancellationTitle","trialCancellationTitle","thirdStep","getCancellattionText","membershipRefundText","membershipText","trialCancellationText","isRefundEligible","subscription_plan","_getPlanName","getCancelButtonLabel","cancelButtonLabel","cancellation_reasons","onExitClick","ExpressCancelForthStep","getTitle","membershipTitle","trialTitle","forthStep","getBody","refundEligibleText","refundIneligibleText","trialText","date","CANCEL_STEPS","FIRST_STEP","SECOND_STEP","THIRD_STEP","FORTH_STEP","IcExpressCancellation","enableRetailerTheme","_getTermsOfService","altLabel","termsAndConditions","HTML_TEMPLATES","TERMS","getNextPlan","MONTHLY","exit","turnOnReminders","subscriptionId","updateSubscription","subscription_id","send_reminder_email","setMessage","reminderUpdated","reminderTurnedOn","MESSAGE_PLACEMENTS","updateMembershipPlan","membershipUpdate","membershipPlanUpdate","onMembershipCancel","reason","additional_notes","_handleCancellationSuccess","trialCancelMessage","FirstStep","SecondStep","ThirdStep","ForthStep","icExpressModalService","creditCards","selectedCreditCard","PLANS","period","minimumOrder","minimumOrderAmount","recurrence","yearly","GENERIC_PLANS","MEMBERSHIP","membershipPlans","_getSubscriptionPlan","term_length","setMembershipPlans","polytype","subscriptionPlan","toggleReminder","showReminderMessage","getReminderDate","reminderDate","DATE_FORMAT","send_reminder_on","reminderTurnedOff","_safelyGetSubscription","getNextPlanDate","getNextSubscriptionPlan","next_subscription_plan","getTrialRemainingDays","duration","hideReminderMessage","getNextPaymentString","nextSubscriptionPlan","nextPaymentOn","membershipEndDate","getNextPlanString","instacartPlan","IC_MEMBERSHIP_PLANS","getReminderString","reminderSentToYou","isExpiredMembership","loadInitialData","fetchEligibleSubscriptionPlans","subscriptionPlans","loadCreditCards","service_type","paymentInstruments","setCreditCards","currentCreditCard","cc","ext_instrument_id","updatePaymentMethod","credit_card_id","openGiftCardRedeemModal","expressGiftCardRedeemModalTemplate","onCancel","onSuccess","openAddCreditCardModal","$parentscope","addCreditCardModalTemplate","handleCardSelection","card","documentElement","paymentMethodUpdated","_handlePaymentUpdate","isAutoRenew","autorenew","active","revertTrialCancellation","changePlanFromModal","planUpdate","promoPlanChange","promoPlanSubscribeMessage","SUBSCRIPTION_TYPES","trialPlanUpdate","membershipUpdated","openPlansModalNew","nonPromoPlans","nextPlan","expressPlansModalTemplateNew","plansToShow","unshift","onSave","selectedPlanId","newPlan","openPlansModal","expressPlansModalTemplate","selectPlan","currentPlan","updatePlan","openPromoPlanChangeModal","expressPromoPlanChangeModalTemplate","getPromoPlan","onPlanChange","nextPlanDescriptionText","templateString","nextPlanDescriptionTextPromo","interpolate","planName","activationDate","currencySymbol","fullPrice","full_price","termLength","showNextPlanSection","showChangePlanButton","isExpressApplicable","promoPlanId","shouldShowPromoPlanChange","showPaymentInfo","showCouponMessage","couponDurationText","IcExpressProfile","username","IcExpressSignin","subtitle","signin","small","IcExpressAd","parsedList","cancellationDate","savingsAmount","averageSavingsAmount","yearlyPrice","monthlyPrice","desc","showPlanSelector","enablePlanPurchaseSelection","userSubscriptionStatus","eligibleSubscriptionPlans","ctaButtonLabel","ctaLinkButtonShow","ctaLinkButtonLabel","ctaLinkButtonDescription","onCtaButtonClicked","onCtaLinkButtonClicked","onPlanSelectedCallback","planIdToSubscribeTo","IcExpressCheckout","placementConfig","checkboxLabel","cartTotal","subscriptionTitle","isTrialEligible","trialEligibleTitle","trialDays","userSubscription","optedIn","onChange","termsAndConditionsUrl","termsAndConditionsLabel","IcExpressEntry","socialSignOnService","parentThis","expressSignupModal","EXPRESS_SUBSCRIPTION_STEPS","AD","EXPRESS_SUBSCRIPTION_STEP_ORDER","giftCardOnlyRegistration","ad","valuePropositions","defaultTermLengthToPurchase","UNAUTHENTICATED","unauthenticated","tooltipDescription","icLinkButtonDescription","tooltipTitle","handleSubscriptionSuccess","previousStep","_getPreviousStep","_getNextStep","FORM","SUCCESS","ctaButtonClicked","INSTACART_EXPRESS","showGiftCardRedeemModal","enableModalSignupFlow","openSignupModal","ctaLinkButtonClicked","handleSocialSignOn","SSO_PROVIDERS","INSTACART_LINK","showGiftCardRedeemButton","showExpressRedeemByGiftcard","showAccountLinkButton","showExpressAccountLink","unauthenticatedTitle","giftCardOnlyRegistrationTitle","titleString","successTitle","planPeriod","getPlanPeriod","unauthenticatedSubTitle","trialSubTitle","membershipSubTitle","giftCardOnlyRegistrationSubTitle","unauthenticatedButtonLabel","trialButtonLabel","giftCardOnlyRegistrationButtonLabel","ctaButtonLabelVariants","getConfigByRule","expressUserConfigContext","icLinkButtonLabel","icLinkButtonLabelVariants","ic_imported","icLinkButtonEnabled","headerImageVariants","getDisclaimerText","minOrder","isMembershipEligible","recurrenceType","isGoToMainOnSuccess","onSuccessRedirect","IcExpressForm","additionalFormText","whyProvidePaymentsNow","subscriptionPlanId","handleSubscriptionError","onSubscriptionSuccess","defaultErrorMessageSuffix","tryAgainPolite","onCancelFormClick","IcExpressPopover","primaryButtonLabel","popover","primaryClick","onPrimaryButtonClicked","secondaryClick","onSecondaryButtonClicked","IcExpressPostCheckout","postCheckout","css","sub","deliveryFee","imageAlt","imageMobile","buttonLabels","IcExpressSideCart","sidecart","titleVariants","titleVariant","subtitleVariants","subtitleVariant","trialEligibleSubtitle","onClicked","onClosed","IcExpressTimeslot","expressConfig","optedInLabel","trialEligibleLabel","membershipEligibleLabel","trialSelectedLabel","membershipSelectedLabel","onPlanSelect","selectedPlan","getButtonLabel","keep","select","IcExpressPlans","goToOrderPage","icExpressCancellation","icExpressProfilePageController","icExpressProfile","icExpressSignin","icExpressAd","icExpressCheckout","icExpressEntry","icExpressForm","icExpressPopover","icExpressPostCheckout","icExpressSideCart","icExpressTimeslot","icExpressPlans","IcExpressPostCheckoutCreditCardPageController","logoText","IcFulfillmentBanner","redirectService","uibModalAriaLabelService","blockingStateTransition","loginContext","handleSocialSignOnSuccess","code","redirectResponse","ignorePostImportModal","linkSuccessful","redirect_response","icImportAccount","inProgress","pleaseWait","tryAgain","loadRedirectUrl","importIcAccountSuccessModal","$close","importIcAccountErrorModal","goToAccount","deprecatedRemove","shouldOpenModal","ic_user_id","ic_import_opt_out","icImportAccountModalBannedPopupRoutes","route","icImportAccountModalEnablePopup","updateUserIcOptOut","importIcAccountModal","skippedButtonClicked","ic_account_opt_out","importOptOut","modal_dismissed","onImportClick","ariaLabel","setLabel","_event","USER_ACTIONS","POST_USER_LOGGED_IN_STATE_RELOAD","POST_USER_LOGGED_IN_NO_STATE_RELOAD","POST_USER_EXTERNAL_LOGIN","_params","_previousState","_previousParams","ImportIcAccountService","closeModal","skippable","setStage","instacartCustomerLinkService","linkStatus","isLinking","linkingAccount","verifyLinkCode","resendCode","sendLinkCode","emailResent","startStage","stage","$dismiss","verificationCode","customPOST","retryLinking","InstacartCustomerLinkModalControllerModule","InstacartCustomerLinkServiceServiceModule","urlParser","absUrl","pathname","ModalTemplate","linked","handleCancelledModal","previousState","previousParams","handleNewLogin","requireICAccountLink","preventDefault","ic_link_start_stage","_action","showLinkLater","isSending","sendCode","checkLinkLater","InstacartCustomerLinkModalServiceModule","InstacartCustomerLinkConfirmModule","InstacartCustomerLinkHeaderModule","InstacartCustomerLinkInputModule","InstacartCustomerLinkNotifyModule","InstacartCustomerLinkRoutesModule","InstacartCustomerLinkServiceModule","InstacartCustomerLinkSubheaderModule","lastState","getLastState","lastStateName","oneCart","listReviewToCartRedirectUrl","open_sidecart","reviewList","InStoreComponent","LOYALTY_ONBOARDING_STEPS","INTRO","REGISTER","THANKYOU","FORGOT","errorMessage","hideRegistration","loyaltyOnboardingStep","socialSignOnData","currentState","logUserLoyaltyOnboardingStart","setLoyaltyOnboardingStep","hasOptionalAuthService","LOYALTY_ONBOARDING","logUserRegistrationStart","loyalty_onboarding","logUserLoginStart","logUserLoyaltyOnboardingForgotPassword","logUserLoyaltyOnboardingThankyouStart","register","login","forgotPassword","checkForUserContext","doCallToAction","uiState","logUserLoyaltyOnboardingThankyouCTAClick","action_type","goToSocialLinkFlow","onRegister","goToStore","platform","LoyaltyOnboardingModalControllerModule","importIcAccountService","hasSeenLoyalty","initOnboarding","singleView","welcome","logUserLoyaltyOnboardingExit","ON_REGISTRATION","LoyaltyOnboardingService","MAINTENANCE_VARIANTS","maintenance","siteDown","showMaintainencePage","variant","setActive","setVariant","hasMaintenanceHeader","addErrorInterceptor","json","headers","setErrorInterceptor","setInactive","MaintenanceComponentModule","finishedRender","isTemporaryModifyExpired","eventEmitter","on","EVENT_TYPES","AUTO_CANCEL_MODIFICATION","modifyOrderBanner","slides","mobileOnboarding","callToActionText","callToAction","MobileOnboardingModalControllerModule","setLocalStorage","shouldShowOnboarding","showOnboarding","effectiveDate","userLoggedIn","isMobileOnboardingEnabled","storedValue","isAfter","isBefore","MobileOnboardingService","$ngRedux","connect","featuredDepartments","featuredMenu","merchandisedLandingPages","categoryNavBarLinksSelector","webUrl","categoriesMenuAdditionalLinks","enableFeaturedDropdownMenu","isFeaturedMenuOpen","util","toggled","isActiveCategory","categoryId","currentCategoryId","currentParentCategoryId","isNonEComLightCategory","updateActiveCategories","categoryFromId","department","getCategoryParentId","$document","mobileNavService","setInPageChecks","inInstoreListPage","inCheckoutCartPage","inCheckoutConfirmationPage","inCheckoutSection","inNewCheckoutSection","CHECKOUT_ROUTE_PREFIXES","V2","inListOrCartPage","inDedicatedCheckoutFlow","showAltNavBar","inCheckoutOrList","searching","hideSearch","showSearchFromClick","useCustomSearchBar","useCustomMobileSearchBar","forceDefaultHeaderOnMobileApp","forceDefaultSearchBar","forceDefaultMobileSearchOnMobileApp","forceDefaultMobileSearchOnMobileWeb","forceDefaultHeaderOnMobileWeb","dotComHeaderSyncEnabled","headerSyncError","customHeaderIsLoading","dotComHeaderIsLoading","newValue","oldValue","getAllStoreProductsByCategory","stopPropagation","setSearchingTo","mobileNavSearchBarFunctionality","hideLoyaltyCard","focusSearch","focusSearchBar","mobileNavEle","isCloseButtonVisible","isMobileDotComHeaderPresent","showSearchBar","mobileNavHeaderClick","handleAngularElementScroll","autoHideMobileSearchBarOnScroll","sideCartService","isCartEmpty","getCartTotal","getCartTotalForCurrentType","isCartSyncing","labelId","fulfillmentNotAvailableModalService","loyaltyInfoService","loyaltyOnboardingService","toggleEComLightService","hideSlidingLogo","showHidingLogo","searchTerm","search_term","toggleEComLightMode","enableToggleEcomLightMode","eComLightModeToggleText","headerLinkFrom","headerLinkPickup","headerLinkTo","ecomLightModeToggleIcon","eComLightLinkIcon","afterHeaderLoaded","stickyNavLogo","stickyNavLogoPath","privateMode","isPrivateMode","privateModeMessage","customerName","reactHeaderEnabled","enableMobileHeader","enableHeader","useAngularHeader","openLoyalty","OPEN_LOYALTY_CONTEXT","off","showCheckoutButton","headerBanners","getHeaderBanners","headerBannersResponse","hasShowableBanners","enableHeaderBanner","media","acknowledgeHeaderBanner","shouldAcknowledge","acknowledgedHeaderBanners","updateBanners","acknowledged","bannerParams","logPlacementImpression","slice","target","logPromotedPlacement","bannerTarget","openIn","fetchHeader","dotComHeader","displayReservation","SEARCH_ROUTES","order_add_on","order_item_append","recipes","isSearching","focusInitially","liteMode","searchService","searchFieldType","typeaheadWaitTime","resultsVoiceOver","removeStrongTags","autocomplete","autocompleteResults","transitioningToSearchResult","oneUrl","redirectResults","redirects","productResults","product_autocompletes","convertedRedirectSuggestions","redirectSuggestion","redirect_name","isRedirect","isLastRedirect","redirectCategory","redirect_category","redirectIsExternal","is_external_url","redirectUrl","convertedProductSuggestions","productSuggestion","resultsAvailable","contextSuggestionLabel","contextSuggestionRecipes","contextSuggestionContent","contextSuggestions","isRecipesEnabled","isDotComEnabled","newProducts","injectContextResults","contextResults","productsClone","sendToSearch","page","isAutocomplete","destinationState","searchRoutes","getRoutes","search_is_autocomplete","eComLightCategory","brand_names","redirectHasProtocol","parsedRedirectUrl","currentHostname","host","hostname","search","processSearchSubmit","searchDestinationData","sendToSearchMethod","search_request_id","startNewSearchSession","search_source","is_autocomplete","search_value","snrid","is_search_redirect","search_redirect_data","search_redirect_name","search_redirect_category","search_redirect_is_external","search_redirect_url","activeElement","blur","autoCompleteContainer","contains","typeahead_popupOpen","click","$model","$label","firstDropdownResult","searchNavEnableFirstRedirectOnEnter","clearSearch","keepFocus","onBlur","blurEvent","searchContainer","blurTargetIsSearch","relatedTarget","isInFocus","onFocus","directive","scope","focusWhen","$attrs","searchInput","newVal","oldVal","unbind","contextSelectorButtonService","searchIconVisible","triageSelectorButtonClicks","openMobileContextSelector","multiShoppingContextsAvailable","multiShoppingContextsAvailableSelector","shoppingModeTitle","mobileShoppingModeTitleSelector","resultFunc","isDropdownDisabled","isCtxChangeDisabledSelector","ctxSubTitleSelector","generateReservationTimeslotContent","prependText","bodyText","returnLabel","previewTimeslot","timeslotAvailable","reservationTimeslotContent","disableContextSelector","accountMenuService","unataCommService","wordpressRestApiService","accountMenuItems","hideExpressLinkInSideNavAccountSection","showPlatformSideNav","showSideMenu","mobileNav","wordpressMenuItems","hasBannerImage","isExpressMenuVisible","showSocialLinks","showSocialIcons","footerSocialLinks","is","hideSlideOutMenu","$parent","gigyaChangePassword","logout","menuEl","resetMobileSearchingState","slideOutEl","contentEl","ham","Hammer","inputClass","TouchInput","drag_block_horizontal","drag_lock_min_distance","hold","release","swipe","tap","touch","contentHam","clearSideMenu","deltaX","$evalAsync","instoreContextDetail","contextPersonalization","instore","userName","loggedOut","closeMenu","listen","EventType","TOGGLEMOBILESIDENAV","showMobileSideNav","setSlideOutMenu","shouldShowTimeslot","hideTimeslotReservationFromTrialUsers","hideTimeslot","changeStoreLink","isChildOfUnifiedHeader","authUser","defaultSelectorService","desktopHomeContext","isTrialUser","getUserName","getFirstNameText","registrationDropdownFirstNameText","firstName","customIcon","userDropdown","showLogin","REGISTRATION_DROPDOWN","MODAL_OPEN_REGISTRATION_LOGIN","slideOutMenu","toggleNav","toggleSlideOutMenu","send","eventType","CategoriesMenu","MobileNavController","NavCart","NavCartController","NavController","SearchNav","ShoppingContextIcon","ShoppingSelectorNav","SideNavController","StoreidLabel","FirstNameLabel","RegistrationDropdown","NavToggleButton","MobileHeaderHomeButton","hideSideNav","NavLogoutButton","offerDetailsModalService","offerTypeString","isWaysToShopEnabled","offersAndCoupons","showOffersBreadcrumbs","offerId","isOffersDetailsPage","coupons","getConditionLabel","condition_index","numProductRewards","r","product_details","conditions","cdn_collection_title","offerProgressData","collection_title","additional_cdns","additional_rwds","cdn_products","rwd_products","collectionId","logOfferDetailsView","deregisterListener","unlockContinuityOfferReward","offerID","OfferDetailsControllerModule","customData","OffersComponent","ITEM_GROUPING","responseError","offline","isOfflineTriggered","isOffline","$http","offlineRetryDelay","$httpProvider","interceptors","shoppingListCache","goOnline","currentTimeout","putCacheToCart","goOffline","saveRedirectUrl","offlineBuffer","offlineService","addListeners","navigator","connection","_user","getLoyaltyCards","primaryCard","getPrimaryLoyaltyCard","getBase64Image","barcode_image","barcode64","nativeMobileBrightnessService","itemCount","count","enableFullBrightnessMode","resetBrightnessMode","getCache","defaultHeaderImage","getDefaultHeaderImage","trying","getMessage","offlineShoppingList","offlineMessageLoyaltyAndList","offlineMessageLoyalty","offlineMessage","sideCartSortModalService","eComExists","exist","eComLightEnabled","SORT_OPTIONS","getSortOptions","model","sortType","defaultShoppingListSort","setSortType","newCustomItem","defaultProductImage","getDefaultProductImage","getListItems","customItems","getCustomItems","nonCustomItems","getNonCustomItems","getCategorizedProducts","naturalSortFunc","_err","updateItem","removeCustomItem","itemName","customItem","cartItem","item_type","pseudo_product","emptyList","toggleAddCustom","showAddCustom","blurAndHideKeyboard","addCustomItem","dirty","customItemInput","addNewCustomItem","sortOptionNameByValue","triggerSortModal","showSortModal","sortOptions","notYetSupported","openShoppingSelectorModal","OfflineRetryInterceptorModule","nav","OfflineNavTemplate","OfflineTemplate","Offline","showOverflow","OrderAddOnNavController","orderAddOn","addOnRequest","validStateRedirect","OrderAddOnRoutes","StripeFormController","stripe","isSubmitting","cardStripeElLoaded","doNotSaveCard","opt_out_save_payment_info","elements","create","base","fontFamily","fontSmoothing","fontSize","invalid","iconColor","cardErrors","isStripeFormInitialized","authType","_generateStripeCustomer","_postPaymentInstrument","customPUT","isFormSubmitting","createToken","noSave","captureMessage","onAfterSave","clear","onSaveError","handleFormCancelClick","saveLabel","saveButtonSize","enableSolidBackground","showSaveCreditCardCheckbox","StripeForm","CreditCardList","handleLockedCreditCardClick","creditCardLocked","warning","showDeleteLink","creditCard","allowDeleteOfSelected","formatCardExpiry","expDate","sourceString","targetLength","padString","repeat","padStart","getCardInfoString","disableCardName","cardEnding","cardName","cardNumber","last_four_digits","getCardExpiryString","cardExpiring","month","exp_month","exp_year","onDeleteClick","onSelect","disableSelectButton","disableDelete","includeExpiryDate","concatProductTitle","showAvg","average_weight","averageWeight","avgWeight","unit","average_uom","getEnterpriseSaleEndDate","saleEndDate","hasICSaleEndDate","SHOPPING_SELECTOR_STAGES","BANNER_SELECTOR","CART_TO_LIST_MIGRATION","CONFIRMATION","SHOPPING_CONTEXT","STORE_SELECTOR","CLOSE","TRANSITIONS","orderAddOnIncrement","calculatePrice","orderAddOnDecrement","orderAddOnUpdate","calculateParams","product_id","priceResponse","unit_price","confirmOrderAddOn","addOnPayload","order_by_weight","uom_price","_addOnResponse","successMessage","EXCLUDED_EXT_DATA","OrderAddOnConfirmModalController","cartAnalytics","facetedSearchService","tagsService","enableFacets","enableFacetedSearchFilters","enableICSearch","productOffer","priceAlertId","maxInCart","currentCategory","inOrderAddOnMode","showEbtRibbon","usa_snap_eligible","productAtStore","totalConfigPrice","analyticScope","createNewAnalyticScope","goToRoute","isExternalRoutesDisabled","destroyAnalyticScope","picCfg","components","productImageCarousel","rootAriaLabel","aria","screenReaderInstructions","productImageCarouselInstructions","thumbnailAriaLabel","goToSlide","zoomEnabled","excludedExtData","sale_end_date","loyalty_end_date","addToCartStyles","buttonGroup","margin","hasExtData","formattedDescription","showMoreOpen","descriptionTruncated","getFormattedPrepTime","hours","lead_time","remainderMinutes","remainderHours","pluralize","join","priceAlert","price_alert","barcodeScannerStateNames","isProductDetailsModal","getAllFacets","getTagName","tag","byVal","showBackToScanner","loadProductDetails","promoted","sponsoredBy","max_in_cart","warnings","is_alcoholic","client","descriptionLimit","productDetailsDescription","mobileLimit","desktopLimit","isDescriptionLong","productOffers","getAllCartTypeOffers","logCriteoProductDetailsPage","sale_price","availability","availability_status","getProductInfoAnalytics","getFeaturedProductImpression","logProductDetailsView","tab","scrollToTabs","ingredients","nutrition","relatedLoading","require_storeproduct","enableUnavailableProductPDP","related","additional_images","large","altText","view","productTags","getTagsMatchingConfigTags","setProduct","activateTab","tabValue","newTab","children","productTitle","showPricingDisclaimerOnPdp","backToScanner","orderAddOnSubmit","OrderAddOnConfirmModalTemplate","hasLoyaltyCard","hasLoyaltyPrice","loyalty_price","enableLoyaltyPricing","hasSalePrice","showOfferRibbon","showOfferRibbonOnPdp","offer_title","openTermsOfUse","userReviews","termsOfUseUrl","openPDP","openLogin","PRODUCT_USER_REVIEW","isModal","openAndScrollToTab","showMoreDescription","reviewsUserData","getUserFullName","getAddressRegionString","getDefault","priceStyles","root","font","h3","ProductService","shopContextIntent","showPricingPromos","config_type","has_pricing","openStoreSelectorModal","configType","updateConfigTotalPrice","locationValue","elem","attrs","previousSelect","configsPrice","configBasePrice","allSelectedConfigurations","uploaded","file","selectSingleParamItem","mandatory","selected","consolidateSelectedOptions","multipleLimit","limitToMoreThanOne","optionLength","optionLimitByIndex","incrementOptions","incrementOptionsMultiple","extractSelectedConfigurations","validateSingle","option_name","totalPrice","selectMultiParamItem","productOptionIndex","optionItem","displayBaseSelectionTotalPrice","baseSelectionPrice","findDefault","optionItems","formatConfigForCart","inboundConfiguration","formattedConfiguration","selectedConfiguration","selectionType","sanitizeConfig","parse","toJson","parseOutNilProps","formatConfigForComparison","itemConfig","maximum_selection","max_length","validateAll","invalidOptionsString","configsString","allowHTML","configsArray","storeProdOptions","storeOptions","availableOption","selectedOption","multipleString","multipleItemArray","areProductConfigsAndOptionsEqual","y","smallerArray","largerArray","aItemIDs","bItemIDs","existingConfiguration","sanitizedExistingConfiguration","sanitizedInboundConfiguration","storeProductConfigData","selectedProductConfig","optionMetadata","$compile","existingConfig","aggregateQuantity","dropdownTemplate","timeout","isDropdownVisible","hidePopover","showPopover","elemPos","getBoundingClientRect","topOffset","append","popoverWidth","popoverHeight","offsetHeight","inlineStyles","popoverClass","offSetPostiion","rect","pageYOffset","left","pageXOffset","right","getElementOffset","innerHeight","addClass","hideDelay","toggle","togglePopover","linkToProductDetails","ProductDetailsControllerModule","ConfigurableProductDirectiveModule","ConfigurableProductServiceModule","ConfigurableProductDropdownModule","tree","ecomLightCategoryID","homeRedirect","isDedicatedCateringExperienceSupported","setMode","appendProductStruturedData","deleteJsonLd","ProductDetails","circle","backgroundColor","refresh","recipeTags","matchedTag","ctag","tag_name","tagFixes","tagHelper","buildTag","parents","getParents","getChildren","parentCategoryWithImage","parentCategory","rootCategories","parent_id","getCategoryFromId","serviceCategory","level","potentialParent","getSiblings","RecipeDetailsController","legacyModalService","recipeId","closeOpenModals","recipe","savedRecipesService","getSavedRecipes","savedRecipesList","setPageTitleAndBreadcrumbs","ingredientServings","prepInfo","isSaved","savedCount","toggleSaveRecipe","requireLogin","removeSavedRecipe","saveRecipe","showSavePrompt","productTypes","propName","recipeProductsFeaturedMealkitOptions","recipeProductsFeaturedFresh","recipeProductsFeaturedPantry","recipeProductsFeaturedOther","border","fixedContent","imageGutter","inverted","hasMultipleImages","header","savedRecipesIcon","RecipeCategoriesServiceModule","RecipeDetailsModalServiceModule","RecipeIngredientsModule","RecipeMetaModule","RecipeProductsModule","SavedRecipesCellModule","recipesTreeStates","recipesHome","appendRecipeStruturedData","recipesHomeState","SAVE_RECIPE","is_saved","recipe_details","getRecipeAnalytics","newSavedRecipeList","RecipeComponent","SavedRecipesService","subscriptionCode","enableLoyaltyOnboarding","registrationTemplate","loginOrRegister","logUserRegistrationExit","PROMPT_LOGIN","OPENLOGINREGISTERMODAL","targetScreen","refocusService","setView","showTab","redirected","setRefocusTrigger","RegistrationServiceModule","RegistrationControllerModule","resetToken","passwordResetToken","pwrt","gigyaInit","socialSignOn","isContextIntentInValidState","shopping_mode","norender","MAIN_LOGIN_STATE","RegistrationComponentModule","timeslots","lastDay","firstDay","selectedTimeslot","day","unix","dayOfWeek","dayOfMonth","daysSinceStart","daysByWeek","timeslotsByDay","currentWeek","selectDay","selectedDay","reserve","timeslotStartTime","makeReservation","SORTED_TIMESLOT_CONFIG","TIMESLOT_POLYTYPES","ASAP","dayOfTheWeekLabels","fullLabel","customLabels","today","tomorrow","isEntireRowClick","isCondensed","pagination","rootLevelCssClass","timeslotsAreSelectable","filterBlackouts","navigateToNextStep","navigateToNextStepFailed","onLoad","onReady","onError","onAfterCartCompareConfirm","analyticsHelper","isShortDayNames","isShortTime","hasRxItem","behaveAs","getShopContextIntent","deliveryConfig","willBeFulfilledByInstacart","showAvailableTimeslotsOnlyCheckbox","availabilityCheckboxThreshold","timeslotAvailabilityCheckboxThreshold","showDeliveryFee","loadingReservation","showPickFee","showAllTimeslots","radioBoxToggleOverride","showOnlyAvailable","onTimeSlotSelected","timeSlot","onGoToCart","selectedTimeSlotV2","reactTimeSlotsI18n","availabilityCheckboxLabel","availableTimeslotsOnly","goToCart","moreTimes","nextWeek","previousWeek","lastWeek","changeWeek","noTimeslotsAvailableMessage","noTimeslotsAvailableDelivery","noTimeslotsAvailablePickup","selectTimeslot","daySelection","hideDetail","hideDetails","showDetail","showDetails","deliveryFeeLabel","deliveryFees","shopFeeLabel","pickFees","free","noAlcohol","highDemand","timeslotsHighDemand","rxWarning","rx","timeslotWarning","onDaySelected","onWeekChanged","currentPage","newPage","toggleGetTimeslotComplete","getTimeslotsComplete","processTimeSlots","sortedTimeslots","asapTimeslot","asapDay","fastest","possible","monthShort","arr","dayObj","dayOrd","weekArr","week","dayObject","time","dateStr","minute","timeslotsByDayPaginated","reservationWeek","selectInitialDate","reservationDate","reservationTimeslot","dayInList","dayTimeslots","scrollableEl","dayEl","scroll","getTimeslots","filter_product_blackouts_timeslots","getTimeSlotsList","handleProcessReservationError","logReserveError","expiredTimeslotError","toggleUnavailableReason","showUnavailableReason","resetSelectedTimeslot","rowClick","$index","selectedIndex","isSkip","selectedTimeslotIndex","newTimeslot","processReserve","updateTimeslotFee","currentValue","TIMESLOT_FEES","DEFAULT","shopperFeeTextChange","is_free","isToggled","timeslotItem","getUnavailabilityReasonString","unavailability_reasons","toggleShowMore","getTimeslotArgs","above_threshold","timeslotService","redirectToPreviousState","goToRedirectUrl","areTimeslotsSelectableAtCheckoutOnly","FulfillmentAddressControllerModule","FulfillmentTypeControllerModule","ReservationConfirmationControllerModule","ReservationControllerModule","TimeslotControllerModule","TimeslotSelectorsModule","TimeslotSelectorStateControllerModule","TimeSlotComponent","activeTags","checkRegistrationRequired","allTags","failure","searchResults","fetchedRootCategories","onSaleOfferSources","offer_sources","hasCouponOfferSources","keyword","toggledFilterId","tag_display_name","v","recipeCategoriesFetched","recipeCategoriesService","recipeCategories","SearchComponent","inputAutoFocus","inputId","inputName","inputRequired","inputPlaceholder","inputChangedCallback","addressChosenCallback","hasError","showStreetAddress","setAutoCompleteOptionSelected","addressSearchService","inputText","autoCorrectResults","autocompleteListener","pacContainer","autocompleteResultId","instructionId","$postLink","addressInputField","handleArrowKeys","keyCode","mutationCallback","mutationsList","mutation","spanLabel","innerText","prepend","nodeID","removeAttribute","handleAddressSelected","sdkLoaded","addAutoCompleteWidget","interval","autocompleteContainers","containerIndex","parentNode","evt","stopImmediatePropagation","inputChanged","trackAriaActiveDescendant","focusedAutocompleteElement","clearActiveDescendant","$onDestroy","removeAutoCompleteWidget","AddressAutocompleteInput","selectableAddresses","selectAddressCallback","editAddressCallback","hideAddressFormOnLoad","showSaveMessages","showIdleMessage","textHeader","currentEditingId","currentEditingItem","editableAddresses","selectableButtons","selectableRadios","prefillNewAddress","addressWithoutId","initialIndex","editAddressItem","getAddressItems","getAddresses","addressItem","o","filteredAddresses","selectAddressFromCurrentAddress","onAddressSelected","_mergeProfileToAddress","_handleProfileFetch","_setProfile","resetSuccessMessage","editingAddress","cancelAddressEdit","selectedLoading","saveSelectedAddress","TypeError","onAddressSave","setSuccessMessage","deleteAddressItem","addressDeleteConfirmation","addressDelete","deleteAddress","AddressList","onDelete","useContinueCopy","saveToDb","handleErrorResponse","addressForm","$setValidity","$setTouched","missingFields","saveAddress","unMarkAddressValidated","normalizeData","validateAddressAndSave","$invalid","lastName","phoneNumber","markAddressValidated","isFieldRequired","AddressListForm","isDropdown","configuration","existingCartItems","isProductCell","isRelatedProduct","existingConfigSingular","reactStyles","useReact","buttonType","triggerCallback","removeCallback","addToCartService","collectionsService","orderWeightOptionsService","productsService","capitalizeFilter","isProductDetails","isConfigurableProduct","ariaLabelAddText","addToListButtonLabel","addToCartButtonLabel","enableAddToCart","selectedQuantity","idStringContext","toLowerCase","addButtonARIALabel","isDynamicCollection","hasReachedProductAddLimit","isProductInStock","enableOutOfStockAdd","enableOutOfStockAddToCartContexts","getCollection","dynamic","maxQuantityWarningPopover","limitPerOrder","accessibleItemRemoved","textContent","accessibleItemAdded","addItemIncrementElement","isInstoreContent","addToCartConfigProps","addToCart","registerAddToCartAnalytics","formatQuantity","updateWeight","appReviewCheck","newConfiguration","updatedConfiguration","addToCartContent","orderWeightOptions","generate","passToCtrl","addIcon","order_by_each","iconBefore","labelButtonProps","iconAfter","placeholder","onAdd","onDropDownSelect","currentTarget","onRemove","onTrigger","onAllItemsRemoved","tellParents","getCornerDistance","deregisterGroupWatcher","$watchGroup","deregisterCartServiceWatcher","method","deregisterConfigurableChangeWatcher","getAddToCartLabel","addToOrderButtonLabel","modifyTemplate","triggerTemplate","reactTemplate","includeZeroOption","display_name","increment","previous","toFixed","AddToCartButton","OrderWeightOptionsService","toggleStyle","isConfigurationInvalid","popoverButtonExtraClass","dropdownIsOpen","productsAreIn","someList","itemsInList","productsAreInOneList","itemsInOneList","addOrRemoveItemsFrom","targetList","list_name","createNewList","isCreatingNewList","newListName","AddToList","Airship","registerPlugin","getUrbanAirshipChannelId","cb","isCapacitor","UrbanAirshipPlugin","getChannel","channel","UAirship","getChannelID","channelID","DEVICE_TYPES","getMobileOs","apple","device","android","iosWebViewCheck","messageHandlers","webkit","setIsMobile","isMobileDevice","removeClass","tablet","mobileWeb","bind","splashscreen","hide","cordova","getAppVersion","getVersionNumber","version","appVersion","getVersionCode","buildNumber","getAppName","appName","urbanAirshipEnabled","UrbanAirshipChannelId","codePushBundleLabel","codePush","getCurrentPackage","pack","stopObserving","$observe","keepObserving","AutoFocus","BannerImage","BannerForm","bannerSlugsInZip","hasFetchedBanners","_handleFetchBanners","enterEditMode","selectBanner","updateDeliveryStore","contextParams","changeHomeStore","hideChevron","bannerKey","hasPickup","hasDelivery","bannerToDisplay","getBannerConfig","exclusiveContextText","pickupOnly","deliveryOnly","tagText","BannerTags","BillingInformationForm","condensed","onValidationChange","sameAsDeliveryAddress","billingAddress","billingInformationForm","barcodeScanner","isSupported","BarcodeScannerButtonModule","BarcodeScanner","CartCompareDialog","cartLengthDiff","$onChanges","isFirstChange","previousValue","onMessageDismiss","cartCompareDialog","DISPLAY_ITEMS","CartForm","cartSizes","newCartSize","onCartSizeChange","getDisplayItems","itemsSize","clickEditCart","getCartType","cartForm","CartSummary","checkoutPlacementEnabled","hasIcExpressOptedIn","_setRewards","syncAndValidate","validatePayload","getTipCopy","tipPickup","tipGoesToDriver","cartTotals","primaryInfo","pleaseSelectPickup","pleaseSelectTimeslot","pleaseFillContactInfo","pleaseSelectPaymentMethod","pleaseSelectDeliveryAddress","getCartTotals","hasClientSubscription","onTipApplied","showSubscriptionSelection","cartCheckout","isPurchasingEnabled","isPlaceOrderEnabled","totalLabelText","onPlaceOrder","cartSummary","elSum","group","sum","workingSpan","swapEl","toList","fromList","fromListAt","toListLast","inputArr","colMax","set","sortedSet","positionInSet","itemSpan","promoted_media","span","desktop","RangeError","sorted","log","getMaxCols","cellContainer","cellContainerWidth","visualizeInConsole","matrix","itemLength","visualized","getRandomNumber","random","CellServiceModule","promotedMedia","defaultImage","useImageTag","lazyLoadImage","fallbackImage","escapeImageUrl","promotedImage","image_url","alt_text","loadStaticImage","toggleClass","observableElement","imageElement","innerHTML","loadedImageElement","img","Image","backgroundImage","hasIntersectionObserver","IntersectionObserver","entries","self","entry","isIntersecting","unobserve","rootMargin","threshold","CellImage","_attrs","slider","getSlider","updatePosition","hasLess","scrollWidth","next","prev","CellSlider","endpoint","noticeAlert","oldPage","scrollElementToTop","loadItems","CollectionModalControllerModule","collections","CollectionModal","ContactForm","shouldUpdateProfile","disabledNameFields","hasErrors","localContact","hasRequiredInformation","viewContactOptions","handleSubmit","logEditContact","editContactOptions","$valid","handleBlur","ContinuityOfferCell","coupon","couponclass","isDisabled","offerAnalytics","toggleClippedState","disableCouponUnclipping","updateClippedState","logOfferClick","addOffer","openOfferAfterCouponClip","rateClip","couponsClipped","coupons_clipped","couponTrack","CouponClipper","windowClass","CouponUnclippedModal","isDirty","creditCardLogos","DeliveryForm","isEditingAddress","errors","addressAsString","contactInformationAsString","contactInfo","isValidPhoneNumber","isValidPostalCode","viewFulfillmentOptions","editingDeliveryAddress","storeCartCompare","initialStore","newStore","newAddress","newContext","saveAddressUserProfile","hasStoreChanged","onAddressApplied","zipCode","hasZipCode","handleClick","DeliveryZipCode","showPickupContextSwitch","showDeliveryContextSwitch","showCateringContextSwitch","cartListTransferModalService","cartListTransferService","currentContext","noItemsInContextHeader","term","noItemsInContextBody","switchShoppingMethodToDelivery","switchShoppingMethodToPickup","switchShoppingMethodToCatering","setSelectedFulfillmentType","initialContext","updatedContext","EmptyResultsContextSwitcher","okText","returnModal","meta","callbacks","handleClose","handleDismiss","customTemplate","props","modalInstance","$interpolate","isRendered","callAndShutModalFactory","fn","isDismiss","_wrappedShut","$custom","callAndCloseFactory","callAndDismissFactory","templateToString","isModalRendered","opened","ErrorModal","filterModalOptions","tagOption","selectedCheckboxObject","toggleOption","tagValue","fullTag","displayName","FacetedFilterModalControllerModule","FacetedFilterModalLineItemModule","selectedBrands","selectedFacets","coreFacets","tagOptions","secondaryFacets","categorizedFacetsObject","sideFilters","hideFacets","currentSort","defaultSort","showSort","baseNumberShown","facetShowMore","showOrHideMore","totalNumber","selectedBrandsCheckboxObject","brandNamesParamArray","brandName","selectedFacetsCheckboxObject","areTagsSameAsOriginal","originalSelectedTags","currentSelectedTags","isApplyButtonDisabled","updateApplyButton","originalSelectedFacets","originalSelectedBrands","toggleTag","currentID","toggleBrand","setTagCrumbs","keyboardToggleOption","areBrands","facet","FacetedFilterModalSection","FacetedFilterModal","getStickyHeaderHeight","stickyHeaderHeight","subset","selectedTags","showSmallDropdown","showFullDropdown","extraFiltersOpen","showIn","sortValue","authMode","filteredValue","sortChange","focusNodeWhenInDOM","categoriesFacetObject","stickyOffset","checked","selectValue","selectTag","createId","className","trim","onCheckboxChange","facetGroupDisplayName","setGroupDisplayName","group_display_name","tagGroupDisplayNameArray","selectTagFilter","brandNamesParam","selectedTagCrumbs","tagCrumbsArray","removeSelectedTagCrumb","removeTagCrumbByIndex","newQueryParams","generateTagCrumbsQueryParams","newQueryParamsObject","brandNames","previousIndex","focusWithinElement","focusWithin","resetSelectedTagCrumbs","resetTagCrumbs","getFacetDisplayName","FacetedFilterBar","FacetedSearchCheckbox","FacetedSearchTagCrumbs","searchContext","onCategoryClick","selectedCategory","ICSearchEnabled","categoryNameFromID","facetCountFromID","displayClassName","FacetedSearchCategories","facetedSideFilters","selectedFacetedSideFilters","selectedFacetedSideBrands","facetGroupIndex","indexToFocus","facetIndex","getFacetFocusOnGroupExpand","isBrandFilter","facetedSideBrands","selectBrandFilter","facetedSideTags","createLabelText","FacetedSideFilters","FacetedSideFiltersCheckbox","dismissModal","hideSort","tagStyles","brandOptions","defaultBrand","applyFilters","keyboardToggleTagOption","tagOptionId","hasOwnProperty","keyboardSelectBrandOption","brandOptionValue","newTags","oldTags","loginWasRequired","FilterModal","filterTags","brands","fixedTags","mappedBrands","allBrands","toggles","elWidth","calculateFilters","extraFilters","manipulate","mergedLabel","offsetTop","wrapperWidth","Filters","FiltersBarResizeHide","validateGiftCard","giftCardLengths","hasGiftCardLengths","isGiftCardLengthRange","idx","produceGiftCardFacts","invalidFields","langService","invalidLength","or","giftCardOptions","len","validateGiftCardConfigs","submitAddGiftCard","GiftCardModal","imageUrl","imageOnly","ImageCell","validateResponse","warningMessage","unavailableItemsIds","unavailable_item_ids","hasUnavailableItems","unavailableItemsByCategory","removeUnavailableItems","InvalidCartItemsDisplay","imageName","LightBox","LoadingDots","loyaltyPass","printable","useBarcodeNumberLabel","printableLoyaltyCard","cardImgUrl","windowLocation","origin","protocol","port","progress","pointsRemainder","isDefined","points_increment","pointsRedemptionDeficit","hasLoyaltyIncrement","Circles","radius","colors","openInWallet","addToWallet","updating","createLoyaltyPass","fetchLoyaltyPasses","loyaltyPasses","printCard","classList","cloneNode","execCommand","print","getCardExpiryDate","expiry_timestamp","LoyaltyCard","LoyaltyInfoService","LoyaltyInfoController","isInfoBox","shouldShow","proceedToAction","LOYALTY","LoyaltyOptInPlacement","LoyaltyPlacement","loyaltySavings","loyaltySubtitle","loyaltyJoinNow","ctaButtonAction","savings","storageKey","hasBannerBeenHidden","isBannerEnabled","bannerImageUrl","appStoreLink","parts","cookie","shift","getLegacyCookieValue","mobileOs","appStoreLinks","mobileAppPromotionBannerImageUrl","setAppStoreLink","closeBanner","MobileAppPromotionBanner","incrementFn","decrementFn","onUpdate","onZeroFn","includeZero","analyticsName","secondaryStyle","disableInput","maxItemsInCart","shouldDisableButton","onUpdateValue","originalQuantity","ModifyQuantity","showGroupTitles","atRegistration","notifications","notificationGroups","notificationLabels","notification","moreText","setSubToAllGroup","filteredNotificationGroups","filterGroupRegistrationOnly","showAtNotifications","subToAll","isResponsysUnavailable","filterRegistrationOnly","showAtRegistration","notificationGroup","checkDisableNotification","isResponsys","NotificationSettingsTable","nutrients","NutritionTable","OfferCell","$controller","OfferDetailsModalControllerModule","OfferDetailsModal","calculateContinuityOfferProgress","max_value","continuityStampProgress","continuity","cdn_count","continuityStampProgressRemaining","$watchCollection","continuityCartProgressMax","min_spend","continuityProgressBarWidth","offer_activated","startContinuityOffer","updateOfferImage","medium","offerImage","newOffer","oldOffer","offerIcon","offerIcons","CONDITION_TYPES","PRODUCT","BRAND","COLLECTION","CATEGORIES","NONE","OFFER_TYPES","DISCOUNT_AND_REWARD_TYPES","PRODUCT_CELL_OFFER_TYPES","AMOUNT_REWARD","BMSM","BUY_X","PERCENT_REWARD","ITEM_CONDITION_TYPES","openOfferDetailsModal","getTheDeal","itemConditionType","cartConditionType","rewardType","complete","offersContent","spendMoreToQualify","addItemsToQualify","addMoreToQualify","spendMoreToComplete","multipleItemsForReward","singleItemForReward","clipThisCoupon","offerCompleted","offerTimes","offerCount","conditionType","conditionCurrent","current_value","conditionMax","accumulator","cdn","conditionDifference","rewardDifference","offerConditionData","conditionMinWeight","min_weight","minWeightStr","itemTitle","completed","conditional","unclipped","offerData","offerOrigin","disableCouponClipping","openOfferModal","has_details","viewOffers","offerPageMeta","is_modal","ContinuityProgress","OfferIcon","OfferProgress","OfferTile","sectionOptions","isInitialized","isSaving","watcherDestroyFns","draft","synchronize","onAddressChange","destroyer","getComment","isUnattendedDelivery","autoSaveInitially","syncSelectedAddress","addressComment","isInitialAutoSave","isCommentSet","isUnattendedSet","initialUnattendedDelivery","enableUnattendedDeliveryCheckbox","messages","unattendedDelivery","alcoholNotice","warningWithUnattended","warningWithoutUnattended","commentDraft","leaveUnattendedDraft","hasChange","updateOrderDeliveryInstruction","updateAddressIfRequired","OrderDeliveryInstructionsForm","$root","isSideCartOpen","Overlay","background","button","previousPage","hideMobileAnimation","noBackgroundBorder","searchReformulationText","selectedFilters","showSearchTabs","initialSearchTerm","isSpellCorrected","searchSpellCorrectionDisabledSref","tabs","getTypes","enableBackground","enablePageHeaderBackground","tabHrefParamCategoryId","breadcrumb","hasFacetedSearchFilters","isSearchState","hasMultipleTypes","activeTab","getTypeBy","hasMultipleSearchTabs","getFacetDisplayNames","names","displayNames","currentBreadcrumb","currentBreadcrumbCategoryId","shouldShowMobileBackButton","mobileGoBack","breadcrumbParent","showNewTag","searchTabTag","PageHeader","PaymentForm","giftCardModalService","NOTHING_TO_SHOW_GATEWAY","gatewayInformation","services","doSave","toggleIsShowingAddCard","isNewCard","isSelectedPaymentValid","_isHouseAccountValid","houseAccountNumber","houseAccountLength","watchPaymentGroup","_updatePaymentOptions","_hasErrors","lastEditMode","isModifyAndPaymentReadOnly","getPaymentTypeString","isSingleOption","paymentMethods","paymentTypeStrings","viewPaymentOptions","newPayType","paymentCssClassName","paymentIntentTypes","getPaymentIntentTypes","isCatering","showAddGiftCard","updateBillingInformation","suppressInitialAutoClose","shouldShowSaveButton","hideSaveButton","shouldShowGiftCardsLink","hideGiftCardLink","showGiftCards","paymentOptions","isValidPaymentType","gatewayName","isBrainTree","isAllOtherSectionsValid","showDeferredPaymentNotice","inputValue","phoneInputModel","sanitizedValue","phoneInputLabel","phoneInputId","phoneInputErrorId","PHONE_REGEXP","ctrl","$validators","modelValue","formattedPhoneNumber","digit","PhoneInput","PickupForm","selectedStore","getInitialLocation","setCurrentLocation","filteredStores","_handleStoresChange","currentLocation","geolocation","getCurrentPosition","coords","searchAddress","handleAddressSearchSuccess","filterList","matchedStore","filterStores","allStores","storeID","scrollToStore","selectStore","handleMapStoreSelect","storeEl","parentEl","scrollTo","applyStore","onStoreApplied","onEditModeChange","preferredPhoneNumber","inputIdAttr","phoneNumberFields","labels","PreferredPhoneNumberSelect","PreventAllScrolling","priceAlertsService","togglePriceAlert","add_price_alert","remove_price_alert","price_alert_source","PriceAlertButton","showIf","angularTemplate","enableInstacartProductCell","ngTemplate01","ngTemplate","productDetailsModalLink","promotedProduct","enableNewItemTile","customBadge","productConfig","overlay","showAllOptions","showQuickAdd","enableCustomOfferBadges","enableIntegrationOfferBadges","enableCustomOfferInsideBMSMBadge","offerConditionAndReward","hasOffer","hasOneOffer","offerPoints","offerWithPoints","points","getProductOfferPoints","hasOfferPoints","showOfferBadge","hasLoyaltyPoints","enableOfferBadge","enableOfferBadgeTypes","offerBadgeAltText","offerBadge","productOffersWithBadges","badge_type","hiddenProductOffers","display_badge","isConditionTypeProducts","isRewardTypeProducts","isRewardTypeDiscount","resultReward","resultCondition","setOffer","badge","amt","max_quantity","rewardAmount","conditionAmount","unclippedCoupons","getUnclippedCoupons","hasUnclippedCoupon","showAisle","showLoyaltyRibbon","promo_tag","showSaleRibbon","showOfferPreviewRibbon","sponsoredByText","sponsored","showFeaturedLabel","showSponsoredLabel","sponsoredLabel","productCellBadge","enableCustomOfferInsideBadge","getProductCellBadgeClassName","priceLabel","getProductPriceLabel","caption","updateForConfigurations","cleared","aggregateQuantityCount","existingConfigurationCartItems","cellOnClick","onAddToCartBeacon","overlayTriggerChance","productCellCouponChance","productCellRecoChance","recoChance","getOverlayTriggerChance","disableProductTileProductReco","deregister","addedProduct","argument","featuredCoupon","recoProduct","cartCleared","storeImpressionIfFeatured","setFeaturedProductImpressionToStore","closeQuickAdd","forceClose","onQuickAddClick","offerBadgeAriaRole","offerBadgeAriaLabel","trackViewPort","offerBadgeSvg","cellProps","currentItem","isLoggedIn","noBorder","noShadow","thumbnailCaption","featured","thumbnail","getProductImageURL","productCount","backgroundSrc","loyaltyPricingEnabled","showUom","disablePriceAlertsOnProductCells","initialSelectedState","rating","product_rating","average_rating","salesTagEnabled","salesTag","ribbonContent","tooltipContent","showSaleEndDate","saveForLaterList","configTags","tagNames","configTag","getConfigProductTags","unitSize","size_string","cellProduct","updatedItem","CellOverlay","ProductCell","ProductCellReactController","ProductCellNgController","productCommentCallback","finishEditing","$emit","disableProductComments","item_comments","hideProductComments","ProductComments","productShowComment","tempComment","removeNote","onSaveNote","responseOrException","LINK_TO_PRODUCT_DETAIL","openAsModal","slugify","lower","LINK_TO_USERLIST_DETAIL","userList","targetOffer","getFormatedDate","targetDate","ProductPoints","unitPrice","showEbtLabel","loyaltyIcon","nonLoyaltySuffix","inline","salePriceOverride","shouldShowUOMSelector","i18n","loyaltyTooltip","loyaltyPricing","priceTooltip","loyaltyBaseSuffix","ProductPrices","segments","currentSegment","checkoutProgress","currentSegmentIndex","segment","screenread","incomplete","number","ProgressIndicator","promoCodeOptions","promoCodeValue","errMsg","promoForm","promoCodeSuccessMessage","disableOfferModal","isUserLoggedIn","promoCodeError","PromoCodeModal","promoCollection","collectionModal","openCollection","maxNumberOfCollectionItemsPerModal","PromoCollectionCell","provinceIsRequired","errorElementId","provinces","provinceOptions","defaultProvince","ProvinceSelect","quickshopTags","Quickshop","onRate","reco_rating","round","setRating","ratingItem","user_rating","Rating","onExpired","onRender","recaptchaService","renderIncrement","renderInterval","onRecaptchaCheckboxSuccess","onRecaptchaCheckboxExpired","onRecaptchaCheckboxError","renderCheckbox","checkbox","checkboxId","sitekey","callback","expiredCallback","errorCallback","ShadowRoot","assignedElements","replaceChildren","RecaptchaCheckbox","bindToController","openDetailsInModal","recipeDetailsModal","tagLimit","savedRecipe","linkToRecipeDetails","categoryIds","RecipeCell","RelatedCoupon","condensedLayout","horizontalLayout","shoppingContext","horizontalOos","inStockOrInStore","RelatedProduct","ScheduleForm","$uibModalStack","showTimeslotPlacement","showFulfillmentBanner","logViewEvent","onDoSave","editTimeslotOptions","loadedSuccess","onLoadDone","onLoadError","invalidItemIds","weight_drift_item_ids","invalidItems","getItems","weightDriftModal","expiredTokenErrorMessage","viewTimeslotOptions","onAfterCartCompare","getSelectedCheckoutAddress","forgotPasswordContext","identifier","email","inputFocusHelper","getFocusableElements","recaptcha","isEnabled","PASSWORD_RESET","recaptchaToken","passwordResetPayload","recaptchaError","resetting","logUserChangePassword","SharedForgotPassword","Share","listTitle","sortedProducts","sortedCategories","hideText","shareListToMobile","shareListTitle","formattedPrice","sale_quantity","base_quantity","getFormattedPrice","formattedQty","getFormattedQuantity","estimatedTotal","isCordova","plugins","socialsharing","share","SharePlugin","ShareListButton","shopModalHeader","SideCartSortModal","SimplifiedController","customUiSref","screenReaderTitle","simplifiedHeader","StoreList","currentStore","handleButtonClick","onStoreApply","handleRadioChange","onStoreSelect","createStoreAddressString","createFullStoreAddressString","applyButtonText","mapHasPickup","mapPinActive","MAP_INITIAL_POSITION","StoreMap","setupMapBox","initializeMap","centralize","clearMarkers","drawStores","flyTo","zoom","initialZoom","mapboxgl","accessToken","mapboxglAccessToken","Map","mapId","addControl","NavigationControl","createMarkerForStore","Marker","setLngLat","addTo","markerElement","StoresMap","onSubscriptionSelected","selectedSubscription","oldSubscription","removeSubscriptions","subscriptionSelect","tagLocation","tagObj","TagStyle","tipIsValidCallback","maxTipValue","MAX_TIP","isFocused","invalidTipErrorMsg","tipErrorMsg","validateTip","currentTipPercent","tipAmount","currentTipValue","tipChangedPercent","focusSelector","setTip","percentage","setTipPercent","editTipOptions","tipChangedValue","defaultStaticTip","tipDefault","TipPicker","TipPickerModal","modalAriaLabelService","customTipOption","CUSTOM_TIP_OPTION","animation","modalTemplate","getTipAmount","tip_options","_getProductTotal","_calculateTipAmount","productTotal","tipUsesPreDiscountProductTotal","applyTip","logEditTip","isCustomTipValid","handleSyncError","showTipOption","configTip","tipCalculationMinimum","getTipsFormDescriptions","tipsFormDescriptions","viewTipOptions","setInitialTip","tipDelivery","tips","tipPickerModal","$parse","attr","typeaheadIsOpenKey","typeaheadIsOpen","dropdownMenu","typeaheadIsOpenGetter","accessibilityFix","removeAttr","TypeaheadAccessibility","UpdateCreditCard","verifyPayment","bgImgFade","addClassOnLoad","afterCompileHandler","bindHtmlCompile","templateHtml","DOMParser","parseFromString","templateRoot","doc","renderTemplate","contents","windowManager","$eval","compile","disable","inView","checkIfInView","elementBounds","elementIsInViewport","clientHeight","ElementPrototype","Element","prototype","matches","matchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","webkitMatchesSelector","selector","node","nodes","fallbackSrc","$set","hideBack","showCollectionName","show_name_with_details","headerHasText","imageObj","imageSrc","imageAltText","removeUpload","fileReader","dragDropOnly","uploadedObjectData","dragOverOrEnter","dragEvent","dragLeaveOrEnd","isFileTypeValid","imageUploadRestrictions","types","isFileSizeValid","changeEvent","reader","FileReader","files","loadEvent","formData","FormData","upload","uploadedResp","invalidLang","readAsDataURL","clickEvent","$$html5","str","num","parseFormat","short","m","lowerCaseInput","word","charAt","selectedValue","selectedObj1","selectedObj2","storeHours","todaysHoursObj","startTime","endTime","end","toAppend","slug","substring","fullUrl","allOffers","itemList","inRewards","inConditions","shortenWords","toDateTime","allowSubMinuteTime","hoursPhrase","minutesPhrase","substr","fixedToBody","removeChild","inputs","setViewFn","modelCtrl","$parsers","birthday","newBirthday","$setViewValue","$commitViewValue","$render","descriptionId","help","which","includeIfExists","ngModel","replaceWith","directiveScope","invalidFocusFn","goToFocus","elementSelector","focusElement","_scope","labelElement","for","inputElement","validity","required","noApplyClick","$event","browserWarning","modalIsDismissed","dismissBrowserWarning","configTitle","titleTagDescription","titlePromise","$$state","resetTitle","getImagePath","nonImage","productCell","productDetails","removeOn","showMax","placeholderImageService","showMaxPlaceholders","placeholderSkeleton","placeholderImage","loadingInt","angularIsReactRoute","reactStorefrontBuilder","refocusElement","isSlideOutMenuItem","slideOutMenuIsVisible","showSlideOutMenu","triggerRefocus","priority","uiSref","ifRegistered","runOnEnter","sanitizeUib","dropdownCtrl","attribute","targetElement","scrollContainer","sortList","currentSortType","showNotesSubstitutions","uncheckAllItems","deleteCheckedItems","checkedItemsCount","mobileHeaderClickDeregister","isMenuOpen","menuOpenedBy","menuConfig","cartReview","inShoppingList","inShoppingListContext","toggleMenu","toggleShowNotesSubs","$$document","elTop","stuck","stickyCheckCallback","unstick","bodyClass","check","minWidth","docTop","newTop","shouldStick","tabEnter","tabEnterFn","tabExitFn","KEYS","keyPress","unselectedButton","previousElementSibling","nextElementSibling","trapFocusOff","topModalEl","resetLabel","BgImgFade","BindHtmlCompile","Compile","Disable","ElementInView","ElementMatchesPolyfill","FallbackSrc","FeaturedHeader","FileUploader","FixedToBody","FocusFirstInput","ForgotPasswordButton","FormattedBirthday","Help","IncludeIfExists","IncludeReplace","InvalidFocus","Label","NoApplyClick","NoticeModal","PageTitle","PlaceholderImage","ReactStorefrontBuilder","Refocus","RequireRegisteredUser","RunOnEnter","SanitizeUib","ScrollIntoView","SideCartSubMenu","Sticky","TabEnter","TabsKeyboardControl","TrapFocus","UibModalAriaLabel","UpdateOnEnter","videoSites","isVideoURL","trustAsResourceUrl","urlParts","query","URLSearchParams","lastPathSegment","lastIndexOf","convertToEmbedURL","videoModalService","srcElement","tagName","VideoModal","BarcodeScannerButton","Cell","CreditCardLogos","FacetedSearchBar","LoyaltyInfo","NotificationSettings","Offers","PickForm","ProductCommentsV2","ProductDetailsModal","Recaptcha","ShopModalHeader","SimplifiedHeader","SubscriptionSelect","Typeahead","Util","cachePromise","catalogSelectors","reduxStore","dispatch","thunks","eComLightCategoryObj","setEComLightCategories","featuredDepartmentPlacements","buildRoot","findRootCategories","rootFeatured","featured_department","findFeaturedDepartments","visibleRootCategories","child","siblings","sortedByStockLevelItems","stock_level","productCategories","rootCategory","productCategory","buildFeaturedDepartmentCollectionCategories","featuredDepartmentID","flyerCategories","clearPdfHrefs","pdfHrefs","fetchFlyerCategories","categoryParams","preview_timestamp","pageHeaderButton","onclick","fetchFlyerPdfHref","fetchFlyerPdfHrefs","previewFlyerData","previewTimestamp","pdfHrefPromises","_pdfHrefPromises","currentFlyerOrPreviewFlyers","flyerType","flyerPdfCallParams","previewFlyer","with_ecommerce","maxPreviousPurchases","purchase_id","categoryFilter","display","ANALYTICS_VALUES","COUPON_TAGS","COUPON_TYPES","COUPON_SOURCES","_offerAnalytics","_removeAuthListener","shopViews","shopContentViews","shopCollectionViews","shopDepartmentViews","shopMerchandisedLandingPageViews","shopFlyerFlippViews","loadShopContentViewsCtrl","importShopMenuController","importShopContentController","decorator","shopContentParents","weeklyAdPath","departments","importShopHomeController","previousPurchases","disableWeeklyAd","disableCollections","disableCoupons","waysToShopLinks","hasOfferOfferSources","merchandisedLandingPageCategories","endsWith","getMerchandisedLandingPages","mlp","filterBarTags","categoryLevelToShowProductTiles","categoryLeveltoShowProducts","isEComLightEnabled","isInEComLightMode","hasEComLightCategory","metaTagCategoryDefault","facetsEnabled","purchasesCategories","purchasesCategoriesService","shopCollections","flyerPreviewParams","setPreviewTimestamp","fetchFlyerData","show_first_preview","setFirstAvailablePreviewToken","flyerPdfHrefs","getFlyerData","getPreviewTimestamp","currentFlyerPdfHref","flyerPdfHref","flyerPreviewIndex","getPreviewFlyerIndexBeingViewed","isPreview","weeklyAdChildLinks","links","hideWhenPreviewing","hideWhenInEcomLight","currentLinkParams","pageHeaderLink","downloadPdf","weeklyAdParentName","treeToReturn","showFlyerPdfInSpecialsFlyerCollection","srcResult","instacartOnlineOnly","couponParams","showCouponsTogether","queries","couponsCategories","couponsCategoriesService","couponTags","offerTags","importCollectionsHomeController","collectionsCategories","collectionsCategoriesService","collectionsContent","collectionCategories","mappedCategories","inCateringContext","showCollections","convertToCollection","offersAndCollections","savedRecipesFetched","recipeCategory","categoryLevelToShowRecipeTiles","categoryLevelToShowRecipes","importFeaturedDepartmentController","featuredDepartment","merchandisingLandingPage","getURLPassedCollectionsList","getFeaturedDepartmentById","featuredDepartmentCollections","collectionList","collection_list","getCollectionsFromSet","featuredDepartmentCollectionCategories","categoryID","featuredDepartmentCollection","importMerchandisedLandingPageController","merchandisedLandingPage","collectionIdsFromURLParams","enableCollectionsURLParams","getMerchandisedLandingPage","mlpContentFromURL","mlp_content","merchandisedLandingPageCollectionCategories","merchandisedLandingPageCollection","cache","importFlyerFlippController","CatalogCategoriesService","CollectionsCategoriesService","CouponsCategoriesService","FlyerCategoriesAndPdfsService","PurchasesCategoriesService","CategoryFilterDirective","Shop","aboutThisApp","MobileAppInfoRoutes","cartListTransferLoaded","initializeTransfer","cancelContextSwitch","completeContextSwitch","transferStatus","hideButton","transferItems","shouldRedirectToDotCom","initialCartOrList","inStoreList","shoppingCart","updatedCartOrList","initialContextTitle","updatedContextTitle","shortTitle","stayInShoppingModeText","stayInShoppingMode","cartListTransferTitle","transferBetweenCartAndList","titleTransferUnavailable","unavailableText","messageTransferUnavailable","cartListTransferMsg","msg","cartListTransferFollowUp","remainingProducts","remainingProductsWithCustom","doNotTransferTxt","yesContinue","titleTransferAvailable","availableText","messageTransferAvailable","question","someMsg","allMsg","CartListTransferStateControllerModule","CartListTransferComponentModule","cartListTransfer","changeStoreOrZipcode","is_b2b","setShoppingSelectorStage","cartEmpty","changeTimeslot","changeBanner","morningStartTime","afternoonStartTime","eveningStartTime","unifiedWelcomeMessage","isBetween","startContinueShopping","processModalCloseClick","showChangeLink","bannerInfo","bannerName","classIcons","ctxName","isActive","showTransition","class","selectedSrText","paramsObject","ALLOWED_OVERRIDES","urlParamValue","jsonReadyValue","overrides","newOut","URL_OVERRIDES","MODE","DISMISS_INITIAL_MODALS","PARAMS","CONTEXT","CONTEXT_TRIAL","CONTEXT_AUTHED","capturedParams","PARAM_NAMES","preCaptureContextParamOverrides","paramObject","defaults","authed","onAuthReady","firstCall","callbackDebounced","destroyListenerCallback","hasDoneInitialCall","initializeContextParamOverrideSystem","onAuthCall","getTop","waitForAllModalsClosed","modalScope","selectOverrides","suppressAnimationOnNextOpen","initialOverrides","dismissAll","deleteOverride","isUserTrial","removeNonApplicableOverrides","userOverridesV2Service","checkOverrides","overrideMode","shoppingContextSubmit","modalTransition","initialContextIntent","shopContextIntents","displayOrder","switchDelivery","userStoreSupportsDelivery","switchPickup","switchInstoreList","switchCatering","visibleShopContextIntents","ctx","shouldHideStoreSelector","hideStoreSelector","shouldHideTimeslotSelector","_getPickupTransitionState","userHasStore","isTimeslotSelectorHidden","USER_STATUSES","userStoreSupportsPickup","transition","destination","allowSkippingStoreSelection","has_pickup","_getCateringTransitionState","has_catering","_getDeliveryTransitionState","isStoreSelectorHidden","_getInstoreListTransitionState","_handleCartCompareConfirmation","initialFulfillmentType","fulfillmentTypesShowTransferModal","transitionToNextStep","storeId","cateringConfig","redirectTo","redirectParams","proceedToNextShoppingSelectorStage","userCameFromTransfer","transitionStateMap","requiresRedirect","getIntentFromContext","determineShoppingContextTransition","shoppingContextSubmitNoChecks","TIMESLOT_SOURCES","IC","INTERNAL","unableToChangeToPickupRx","removeRxItems","context_switched","rx_item_removed","shopContextMode","processComplete","selectLater","onTimeslotError","shoppingContextText","isSelectLaterLinkVisible","isTimeslotSelectLaterLinkVisible","selectTimeSlotNoDate","selectTimePreviewTitle","getSubTitle","suppressAnimation","triggerOpenModal","shoppingSelectorTarget","showing","selectorTargets","allowDeliveryModalClose","enableMandatoryStoreSelection","parentShoppingSelectorTemplate","initialSelectorErrorMessage","userChangedContext","userChangedStore","userChangedContextOrStore","transitionTo","OPENCONTEXTSELECTOR","isShowing","isStateValid","resumeContextSwitch","onlyCateringEnabled","setContextForB2B","homeStateContextHandler","skipModal","forceSetDeliveryPostalCode","shouldForceStoreDeliveryPostalCode","storePostalCode","forceDeliveryPostalCode","showShoppingSelectorOnEnter","skipToShopSelectorIntents","showStoreSelectorOnEnter","ShoppingSelectorServiceModule","shoppingSelectorStage","hasPreviousShoppingSelectorStage","previousStoreSelectorShoppingState","newStage","oldStage","clearShoppingSelectorStageErrorMessage","currentShoppingStage","poweredByTitle","triggerInputShake","shoppingSelectorErrorMessageList","bannerSelector","cartToListMigration","storeSelector","confirmation","isThereAnError","getErrorMessage","setShoppingSelectorErrorMessage","reloadContextValues","hasDeliveryOrPickup","numOfEnabledContexts","onlyInstoreEnabled","hasSavedAddresses","hasAddressItems","showBackButtonInStoreSelector","showCloseButton","storeSelectorCloseHidden","errorTemplate","deliveryFullAddressRequired","deliveryPostalCodeRequired","pickupStoreRequired","handleBackButtonClickFrom","isBackButtonVisible","getBackButtonId","setAddress","storeBanners","setDeliveryBannersAndAddress","onShopAnotherWay","availableBannerSlugs","availableBannersCopy","availableBannerCountMessage","bannerCount","bannerSelectedFromBannerList","deliveryUnavailableAtAddress","updateHomeStore","shoppingModeConfig","handleCustomFulfillmentTypeFlow","proceedToTimeslot","isTimeslotSelectionDisabled","oldStore","storeid","getUpsellProducts","getFeaturedDepartments","mapPinGrey","distanceUnits","useKMForStoreSelectorUnits","distanceUnitsAbbreviation","isStoreSelectable","showMap","hideStoreSelectorMapOnInit","storeFilters","banner_slug","enableNonTabulatedView","onlyShowPickup","storeFilterFn","preciseLocation","locationLookupInProgress","mapAlreadyLoaded","markers","initStores","drawMarkers","storeLatitude","storeLongitude","selectStoreList","storeToMove","moveStore","selectStoreMarker","GEO_ERRORS","geolocate","geolocationFetched","useLastStoreForGeolocation","updateStoresAndUI","enableHighAccuracy","updateUIAfterUseMyLocation","timerID","clearTimeout","useMyLocation","initMap","initialLatitude","initialLongitude","resize","centerOnStore","removeAllMarkers","toggleMap","filterMarkers","geocodeAddress","bbox","fitBounds","maxZoom","MATCHED_STORE_TYPES","sharedProps","returnMatchedFor","SEARCH_BASED","LOCATION_BASED","loadingIndex","shopAnotherWay","updateBannerFilter","showInput","isUnsupportedPostalCode","autoCompleteOptionSelected","addressInputLabel","enter","addressInputChangedCallback","deliveryDefaultPrevented","addressListChosenCallback","openUnsupportedPostalCodeErrorModal","enableUnsupportedPostalCodeCheck","unsupportedPostalCodeErrorModalTemplate","handleDeliveryUnavailable","unsupportedPostalCodeErrorMsg","wereSorryPostalCode","searchedPostalCode","sanitize","paramsFromAddress","currentShopContext","associated_stores","deliveryStoreChangeIsInProgress","saveEnteredAddressToBook","fetchAddresses","deliveryAvailable","is_ic_retailer","fetchBannersThenStores","tabsConfig","tabSelected","tabClicked","tabTitle","tabBannerSlug","hideUnavailableBanners","filteredBanners","getFilterdBanners","isBannerAvailable","CartListTransfer","ContextSelector","TimeslotSelector","ShoppingSelectorConfirmation","ShoppingContextItem","ParentShoppingSelectorControllerModule","ShoppingSelectorService","ShoppingSelectorRoutes","StoreSelectorController","StoreSelectorMapController","StoreSelectorListController","ShoppingSelectorModalHeader","MultipleBannerTabsComponent","BannerSelectorComponent","undoRemove","sideCartMenu","sideCartPositionChange","onContinueShopping","closeSideCart","handleContinueShoppingClick","handleSideCartReView","handleSideCartSkip","defineProperty","sideCartTitleLabel","inStoreIntent","isShowCartMinimumAlert","userHasEbtCardAndEbtItems","userHasEbtCard","cartHasEbtItem","cartMinMsg","areAllItemsRx","cartLength","listItemsToReview","listItemsReviewed","checkItem","updateItemChecked","shouldShowSidecart","inExceptionRoute","exception","cartHasItems","isOneCartEnabled","inCateringMode","showingSideCart","isItemEbtEligible","overrideSalePrice","useSalePricingForOffersInSideCartCostcoOnly","getSalePrice","focusOnDeleteConfirmation","wasConfirmed","updateActions","showToast","updateQuantity","hasEligibleEbtCard","SideCartControllerModule","handleCheckoutClick","showCartMinimumAlert","mcoxCartData","EBT_NOTICE_ALERT_ID","noEBTMinimum","isEbtEnabled","isNotInstore","getMinCartAlertMessage","cartMinCount","getNumCartMinCount","getFirstCartMinMsgWithBanner","mcoxCartMinGenericText","miniCartAlertText","remainingAmount","getRemainingAmount","pre_reward_program_discount_product_total","getCheckoutButtonMessage","checkoutString","checkoutLinkWithSubtotal","checkoutLink","cartSubtotal","onBottomButtonActionClick","continueShoppingRedirect","promoCodeService","lastUsedPaymentInstrument","CHECKOUT_STEPS_STATUS","isCheckoutScreen","findAddress","existingAddress","addresses","setLastUsedPaymentInstrument","paymentInstrument","_getOrderParams","paymentObject","getDateOfBirth","contact_info","_getContactInfo","contactSource","k","checkoutComplete","onAfterCheckoutError","customErrorHandler","paymentDetails","showModalOnDefaultError","orderParams","clearDateOfBirth","clearSuccessMessage","orderComplete","resetToPreModCart","resetToPreModContext","alcoholValidationErrorModal","connectErrorOverrides","defaultErrorHandler","handleCheckoutError","request_id","DATADOG_CART_ACTIONS","sideCart","datadogRum","addAction","configService","selectors","getConfig","userContext","getUserContext","getUser","mode","oneCartEnabled","is_one_cart","owner","user_id","actionMetaData","useStyles","createStyles","marginLeft","alignItems","typography","bodyMedium2","UndoItemRemove","onUndo","useLang","undoItemRemoveToast","removed","undo","OutsideClickHandler","onOutsideClick","ref","useRef","useOnClickOutside","toastId","toast","timerId","toastOpts","ariaProps","sideCartDropdownOpen","areAllMultiContextCartsEmpty","firstKeyMultiCart","isCartFullyEmpty","cartMetrics","REDIRECT_ONECART_CHECKOUT","getOneCartCheckoutRedirect","redirectToCheckout","isRxProduct","bodyEl","showIcExpressSideCart","shouldShowDynamicPlacement","dismissIcExpressSideCart","acceptIcExpressSideCart","showLoyaltySideCartPlacement","openSideCart","cartFetchPromise","NAV_SIDE_CART_OPEN","headerTitleEl","hover","isHoverStateControlledManually","hasClass","cancelHover","$digest","attachHandlers","headerClick","observer","closest","subtree","clearCartModalVisible","undoRemoveToast","HTMLSelectElement","tabExit","wasSideCartOpen","sideCartAutoFocus","SideCartBottomButtonsComponent","SideCartDirective","SideCart","SideCartAutoFocusDirective","SSO_FIELDS","FACEBOOK","FOODLION_IDP","GOOGLE","INSTACART_IDP","INSTACART_LOGIN","TWITTER","WEGMANS_IDP","COSTCO_IDP","APPLE","EXTERNAL_OAUTH2_IDP","handleExternalAuth","promiseActions","getExternalAuthUrl","identifier_polytype","emit","SET_REGISTRATION_URL","disallowedInAppSSOProviders","openAuthUrl","identifier_url","closeOnHome","shouldResolve","Apple","rxUpSellService","rx_session","is_rx_session_valid","errorCode","error_description","errorDescription","ssoKeys","redirectResponseUrl","$$absUrl","rxRedirectErrorModal","fromRxSSO","identifier_data","ssoErrors","backToHome","anonymousIdService","genericSdkLogin","loginFn","errorKey","mobileSdkParams","includes_access_token","shouldUseNativeSdk","FacebookLogin","facebookConnectPlugin","googleplus","ApplePlugin","SignInWithApple","permissions","loginResult","formattedIdentifierData","authResponse","logUserLogin","loginExternal","socialSignOnFlows","icOrderId","icOrderQuery","registration","SocialSignOnLinkModalTemplate","SocialSignOnLinkModalController","handlePostLogin","social_accounts","account","linkFormModel","social_email","socialAccountProviderToLink","socialAccountToLink","socialAccount","linking","password","SOCIAL_SIGN_ON_LINK_MODAL","logUserLoginAttempt","resetLastCheckbox","SocialSignOn","canAccess","reactMethods","onBuySubscriptionClicked","onGiftSubscriptionClicked","onSelectionComplete","subscription_name","isPurchasable","onContinueClicked","assetLoadingFunction","onPurchaseComplete","gift","onStateChange","currentRoute","currentPath","leading","SUBSCRIPTION_STEPS","SubscriptionCheckoutRoutes","showLogout","showIcons","ProfileMenu","showProfileMenuIcons","sideNavProfileMenuShowIcons","getWordpressMenuItems","mobileSideNavItems","getMenuByAPI","targetMenu","appendProfileAfter","hideMobileSideNav","internalUrlToRelative","domainWithProtocol","WordpressMobileSideNavItems","Account","AddressValidation","ChatIntegration","Collections","CompareCart","Footer","MobileAppInfo","IcExpress","ImportICAccount","InstacartCustomerLink","InstoreList","LoyaltyOnboarding","Maintenance","ModifyOrderBanner","MobileOnboarding","OrderAddOn","Payments","Recipes","Registration","Reservation","Search","Shared","ShoppingSelector","SubscriptionCheckout","getCartPromoCodes","opts","getGeocodeURL","profileService","icAddressItems","updateAddress","createAddress","removeAddress","fetchAddressActions","USER_UPDATED","USER_LOGGED_IN","CONTEXT_ACTIONS","CONTEXT_UPDATED","fetchInstacartAddresses","fetchProfile","icImportAddresses","fetchInstacartAddressesPromise","batchImportInstacartAddresses","newAddresses","addressId","is_valid","modalResult","extend","addr","updateItemInList","addressResp","collectPhoneNumbersDuringRegistration","valueOf","hasIcAddressItems","googlePlacesAPIKey","sdkLoadedDefer","findFirstObject","google","maps","places","Autocomplete","componentRestrictions","country","setFields","addListener","place","getPlace","geometry","address_components","parseFieldsFromAutocomplete","autoComplete","autoCompleteListener","removeListener","clearInstanceListeners","findAnalyticScope","getCornerDistanceInScope","added","updatedQuantity","getBeacon","corner_distance","logFBAddToCart","logProductAddToCart","itemsAdded","itemsAddedtoCart","registerAddToCart","isDateOfBirthValid","isBirthDateAlcoholEligible","minAge","setDateOfBirth","isDismissable","alcoholValidationModalTemplate","handleDismissClick","universalLinksService","integrations","hotjarId","googleAnalyticsID","googleTagManagerID","googleTagManagerIDWeb","googleTagManagerIDNativeMobile","segmentID","appsFlyerSDK","sendAnalyticsOnStage","oneTrustSDK","featuredProductImpressions","placementImpressions","shouldFireAnalytics","analyticsServicesMap","googleAnalytics","googleTagManager","hotjar","analyticsServicesArray","previousStateName","ev","devKey","appleAppId","appsFlyer","appId","onInstallConversionDataListener","timeToWaitForAdvertiserID","appsFlyerLinkHandler","deeplinkData","deep_link_value","didLaunchAppFromLink","is_first_launch","initSdk","registerOnAppOpenAttribution","oneTrustSDKCategories","fromEntries","defaultCategory","filteredAnalyticsServicesArray","analyticsService","enterpriseAnalytics","lastTrackedPage","oneTrustSDKCategory","logPageView","referrer","segmentData","userInfo","getUserInfoAnalytics","unataAppVersion","unataMobileAppVersion","segmentArgs","getHtml5Url","newArgs","segmentName","LOG_SEGMENT_EVENT","logFeaturedProductImpression","segmentProduct","impressionData","impression_id","page_type","segmentPayload","sponsored_source","placement_type","getBannerSegmentPayload","placement_name","content_type","target_action","LOG_PLACEMENT_IMPRESSION","setActivePlacementImpressionToStore","activePlacementImpression","getActivePlacementImpression","logProductImpression","subject","logProductClick","extData","contextIntent","logLocation","appendListOrCartIfInFlyer","logProductRemoveFromCart","logOfferImpression","logCheckoutOption","orderPayload","logRecipeDetailsView","logSearch","identify","anonymousID","getId","identifiableID","criteoId","criteo","z","d","waitOneTrust","OneTrust","InsertScript","baseCriteoLogConstructor","criteo_q","retailerVisitorId","events","currency","logCriteoStoreProducts","filterParams","page_number","operator","prepCriteoAnalytics","elevaate","win","srcPath","getTime","encodeURIComponent","h","initElevaateAnalytics","fbConfig","facebookMobileSDK","ADD_TO_CART","COMPLETE_REGISTRATION","allowFBAppEvents","defaultFBFunction","logFBEvent","valueToSum","logPurchase","fb_currency","logFBUserRegistered","prepFacebookMobileSDK","anonymousId","buildObject","is_loyalty_user","is_instacart_member","user_status","usersession_id","getSessionId","retailer_code","store_zip","store_city","store_country","store_province","zip_code","user_city","user_province","trial_id","visit_token","expiryToken","getToken","cart_route","productList","product_results","productAnalytics","slim","getRecipeListAnalytics","recipeList","searchID","formattedEvents","_sanitizeAnalyticsText","getSalePricing","loyaltyPrice","salePrice","loyalty_quantity","getSponsoredSource","getProductSnrid","previous_purchase","slimPayload","ic_item_id","is_primary_result","isPrimaryResult","ic_product_id","sale_data","formattedProducts","sub_categories","saved_count","preparation_information","onLocationChangeSync","newUrl","oldUrl","previousUrl","anchor","sendAnalytics","analyticsClick","analyticsProductImpression","analyticsProductClick","analyticsOfferImpression","analyticsOfferClick","analyticsPlacementImpression","anonymousUser","currentAnonymousId","segment_trial_id","localAnonymousId","setId","buildId","clearId","updateBackendId","ExternalOAuth2","openUrl","initLogin","initLogout","externalOauthConfig","externalOAuth2","serviceParams","logoutUrl","clientId","queryParamRedirectUriKey","logoutRequestParams","postLogoutRedirectUriKey","queryParamRedirectUriValue","postLogoutRedirectUriValue","urlQuery","objectToQueryString","client_id","apiPrefix","getApiPrefix","unauthorizedErrors","getErrorsByProperty","tokenExpiryErrors","hasUserChanged","equals","USERPROFILE","getRegistrationService","fields","finalFields","updateUserLocal","updateUserContext","getParamsFromAddress","postalCodeKey","isDeliveryContextInvalid","iFns","createSession","userSession","createUserSession","binary","binary_version","is_retina","os_version","pixel_density","devicePixelRatio","toPrecision","push_token","screen_height","screen","screen_width","sessionToken","removeToken","createTrialUser","initializeUser","getUserOverridePayload","initializedUser","error2","sendLoggedInMessage","getUserProfile","isLoggingInDuringCheckout","trialUserStore","trialUserIntent","trialUserShoppingMode","updatedUser","initializeContext","fetchedContext","postLogoutReload","logoutFailed","singleSignOn","slsEndpoint","returnToHomeOnLogout","history","pushState","getOneCartSignoutLink","LOGGEDOUT","authenticated","nativeOneCartEnabled","isNativeBridgePluginAvailable","skipPostLogoutReload","responseOrError","updateUserProfile","reloadIfUserChanged","currentAuth","newAuth","AUTHENTICATEDUSER","SETCATERINGCONTEXT","GETAVAILABLESTORECONTEXTS","GETSHOPPINGCONTEXT","sendCurrentShoppingContext","GETUSERPROFILE","sendUserProfile","userId","primaryLoyaltyCard","simplifyStoreDetails","LOGGEDIN","has_delivery","AVAILABLESTORECONTEXTS","shopping_context","SHOPPINGCONTEXT","UPDATESTORE","mystores","USERUPDATEDSTORE","mobile_phone_number","isOneCartOrderLookup","UNREGISTERED_ROUTE_CHANGE","subscription_code","logUserForcedLogout","request","cfg","shouldUseToken","Authorization","backButtonListener","removeBackButtonEventListener","SCANNING_SUPPORTED","scan","errorback","pluginOptions","resultDisplayDuration","beep","cancelled","upc","errorTitle","errorBody","logInteraction","_links","interaction","impression","contentHref","unwatch","isExternalLink","isLinkInternal","parsedUrlParams","getPrependHashIfNeeded","openExternalLinksNewTab","contentAlt","convertUint8ArrayToBinaryString","u8Array","b_str","fromCharCode","convertBinaryStringToUint8Array","bStr","u8_array","Uint8Array","charCodeAt","encryptorFactory","keyPair","box","publicKeyBinaryString","publicKey","externalKey","btoa","setExternalKey","externalBase64BinaryStringPublicKey","externalBinaryStringPublicKey","atob","decrypt","formattedValidBase64Message","combinedMessageNonce","u8Nonce","u8Message","uint8Message","secretKey","naclUtil","encodeUTF8","encrypt","randomBytes","nonceLength","utf8","charcode","u8","charCode","toUTF8Array","u8EncryptedMessage","binaryNonce","binaryMessage","obfuscationHelper","messageEncryptor","EncryptorFactory","rx_item_id_mapping","rx_items","rx_item","prescription_id","rx_details","external_public_key","jsonMessage","parsedDetail","parseDetails","policyTemplate","MODAL_OPEN_POLICY","sessionStorage","InvalidCartItemsDisplayControllerModule","CatalogCategoriesServiceComponentModule","PolicyServiceModule","IwsRegulationAlertModalServiceModule","iwsRegulationAlertModalService","itemsGroupedByCartType","cartFinalTotal","finalTaxTotal","obfuscatedRxItems","cartTypeToCategoryMapping","isInstacartOrder","updatePreviewTimeslots","notifyOnError","cartId","updateTimeslotPreview","rxSSO","cartHasRxItem","fromSSO","getRxItemsList","rx_deliverable_context","oldEndpoint","enterpriseListService","enterpriseCartService","updateTimestamp","updateCart","newCart","sendUnataCommCartMessage","categorizedProductsAndCategories","setCache","showSelectorIfTrialCartIntentChanged","trialCartIntent","currentIntent","userCartIntent","logCartMergeAnalytics","trialCartInstance","helperPayload","ITEM_DETAILS","source_cart_id","target_cart_id","result_cart_items","isFetching","getShoppingList","setObfuscatedRxItems","getOfferProgress","offerProgress","cartIds","product_discounts","doNotSync","REMOVE_ITEM_FROM_CART","UPDATE_ITEM_QUANTITY","iwsRegulatedStates","getProductFulfillmentRetailer","hasShownModal","ADD_ITEM_TO_CART","addItemConfigurable","clearItems","removeShoppingList","removeCheckedItemsConfirmation","itemsToRemove","updateContext","isTemporaryModify","updateModifyOrderStatus","modifyCartAlert","postRoute","CANCEL_ORDER_MODIFICATION","preModifyCartItems","preModifyContext","invalidProducts","productMissingInformationAlertMessage","callOnReOrderFromHistory","isValidatingCart","resetValidationPromise","optError","_handleCartValidateErrors","InvalidCartItemsDisplayTemplate","_handleExternalFulfillmentProviderError","_handleExternalAuthError","_handleTimeslotExpirationError","_handleGenericErrors","_handleValidateSuccess","setCartFinalTotal","setFinalTaxTotal","updateShoppingList","remoteCart","itemsAtLastSync","itemsAtLastSyncForCartType","rxItems","requiresObfuscation","call","obfuscatedMap","getItemQuantity","getCheckedItemsCount","currentlyUnavailable","prescription","unknownAisleText","unataCommCartPayload","GETCART","getPlaceOrderButtonText","checkoutSubmitInCatering","checkoutSubmit","getCartSummaryTitleText","pickupInStoreCatering","pickupInstore","getUpSellProductsInCart","cartItemIds","ids","alcoholFromCartType","carts","has_alcohol","availableModes","modeName","firstProductInCategory","grocery","isCategoryForCurrentCartType","isTippingEnabled","absolute","isValidTipValue","isFinite","getItemDescription","getItemDisplayName","hideSizeStringSideCart","authBuffer","currentCartType","authorization_amount","getCartInstanceId","onAfterFetch","orderModificationModal","currentStateName","isCheckoutConfirmation","orderModifyUnavailable","viewOrderProgress","cancelButton","checkModifyOrderStatus","PRODUCT_CONFIG_TYPES","buffer","analyticScopes","hasAttribute","parentElement","atc","lastTop","row","col","_writeToBuffer","info","_timer","itemChange","_getAnalyticsPayload","prevCart","prevCartItem","extraData","delta","isOrderedByWeight","deltaSign","isPrepStyle","previousQuantity","_getCartQuantityDelta","default_uom","delta_weight","previous_weight","previous_quantity","cart_is_empty","placementImpression","featuredProductImpression","redirectToDotCom","redirectRoute","transferEndpoints","clearTransferredProducts","checkoutUUID","checkoutEntered","information","DEFAULTS","_createPayload","isInNewCheckoutFlow","cartView","CART_ID","INFO_ANALYTICS","INTENT","INSTANCE","SOURCE_TYPE","TIMESLOT_DETAILS","OFFER_DETAILS","enterCheckoutFlow","exitCheckoutFlow","sendImmediately","_logExitCheckoutEvent","SOURCE_VALUE","enterCheckoutUpsell","UPSELL_ITEMS","exitCheckoutUpsell","enterCheckoutReview","SHOP","confirmFulfillmentOptions","FULFILLMENT_DATE","TIP","ORDER","isDownloadingUpdate","downloadUpdate","checkForUpdate","remotePackage","download","localPackage","install","installMode","InstallMode","ON_NEXT_RESTART","cachedCollections","collectionIdentifier","collectionData","collectionsArray","promises","collectionID","COLLECTION_CONSTANTS","PRODUCT_LIMIT","templateOverride","finalTemplate","unfrozenCopy","storeConfig","updateConfig","newConfig","mergeConfigs","latestConfig","fetchConfig","unata","scopes","RootScope","$enterpriseConfigVersion","debug","__UNATA_DEBUG__","CLIENT","$delegate","locals","appConfig","AUTHORIZE_NET","FORM_ACTION_FN","isProd","isEdit","FIRSTDATA_V2","transactionSetupId","createValidatedPaymentUrl","VANTIV_CVV_SUCCESS_RESPONSES","VANTIV_AVS_SUCCESS_RESPONSES","lastFourEbtDigits","instrumentId","clearEbtCard","serializeEbtCardState","setEbtCard","USER_LOGGING_OUT","getEbtCard","getUserEbtCard","card_last_four","instrument_id","deactivateEbtCard","ebt_card_id","getEbtSessionToken","tokenResponse","ebt_session_id","sessionId","clientTokenizeCard","SessionId","CardNumber","Expiration","tokenizedResponse","ErrorMessage","logUserEbtClientTokenizeFailed","ErrorCode","createCardToken","createCardResponse","logUserAddEbtCard","setFulfillmentType","createAction","Constants","setShoppingMode","setShoppingContext","modeAndContext","ShoppingMode","Catering","InStore","enableEComLight","fetchAllChildrenCategoryIds","childrenIds","childCategory","eComLightCategoryIds","nonEComLightStates","isForbiddenState","isNonEComLightState","initializeInEComLightMode","connectionModal","requestId","whiteListRoutes","enableErrorRequestID","process","LOG_PROMOTED_PLACEMENT","openInternalUrl","LOG_IMAGE_PLACEMENT","getHeroContent","getBannerContent","getHomePageCollections","getCatalogBanners","catalog_banners","getCatalogCollections","catalog_collections","featuredDepartmentId","queryStringCollectionList","fetchedFeaturedDepartment","featured_departments","expressSelectors","getEligibleSubscriptionPlansThunk","getCurrentSubscriptionThunk","createSubscriptionThunk","updateSubscriptionThunk","subscriptionPlanIdToPlanId","hasLoaded","planUpdateMessage","topMessage","paymentMessage","membershipMessage","optionalComponents","FIRST_ORDER","FIRST_LOGIN","STICKER_HEADER","stickyHeader","bannerInsertionIndex","headerBanner","getStickyHeaderBanner","placementConfigEnabled","trialOpt","eligiblePlan","reloadUserCurrentSubscriptionPlan","previousResult","forceRefresh","ignorePromoPlans","collapsePromoAndNonPromoPlans","fetchCurrentSubscriptionPlan","isAllowedPaymentProvider","EXPRESS_PAYMENT_PROVIDER","modalInitialState","finish","trialPlan","isEligibleForTrial","eligible_for_trial","was_express_member","isInEcomLightMode","userConfigContext","userStatus","getLocalStorageKey","getExpressLocalStorageKey","getMembershipRemainingString","humanize","dismissMessage","TOP","clearMessages","MESSAGE_TYPES","_generateMessage","EXPRESS_APPLICABLE_STATUSES","COUPON","isYearlyMember","planID","isMonthlyMember","refund_eligible","valuePropositionsVariants","valuePropositionsVariant","getTermsAndConditions","minOrderAmount","next_subscription_plan_id","selectedTagGroupDisplayName","selectedGroupDisplayNameIndex","tagType","selectedTagCrumb","selectedTagCrumbIndex","cloneArray","tagCrumb","categorizeFacets","facetsArray","filteredFacetsArray","facets","excludeSideFiltersByGroupDisplayName","group_priority","allowedBrands","category_ids","facetedParams","sortedFacets","priorityA","priorityB","getObjects","tagTag","facetTag","emptyFlyerData","currentStoreId","preview","showPreviewFlyerAsDefault","getPreviewTimestampDate","searchUrlParams","testHeaderFile","testFooterFile","$templateRequest","headerSyncUrl","defaultFileName","mobileApp","getHeaderSyncUrl","now","footerSyncUrl","HEADERLOADED","FOOTERLOADED","storeProduct","getProductImageURLFromArray","getDefaultRecipeImageURL","shape","getRecipeImageURL","recipeImageURL","recipeCategoryImageURL","getSearchImageUrl","langAria","errorMessages","langErrorMessages","$sanitize","safe","curr","keyPlural","expStr","exp","userListSelectors","userListThunks","fetchUserLists","listId","requirePricing","fetchUserList","formatListItem","wrapped","wrappedList","createUserList","errorMsg","removeUserList","updateUserList","itemInList","shouldReturnIndex","itemIndexInList","sanitizedSelectedItemConfiguration","itemProductId","listItem","hasSameProductId","sanitizedListItemConfiguration","findIndexOfItemInList","findItemInList","findItemsInList","findItemsInSomeList","updateList","currentList","updatedList","isSyncing","listItemsToAdd","hasItemsToRemove","itemToRemove","itemToRemoveIndexInList","require_pricing","printList","configString","categorizedItems","templateScope","$new","templateEl","printWindow","$destroy","outerHTML","linkedStyles","write","rewardLang","secondaryInfo","rewardBase","sourceReward","forceReload","slaveWindows","messageListeners","addMessageListener","postMessage","targetWindow","slaveWindow","master","unataComm","UnataComm","waitForBrowserClose","urlPath","openPlatformPath","closeOnReload","NAVIGATETOURL","$$phase","RELOADUSER","OPENSIDECART","old_url","new_url","LOCATIONCHANGE","removeTrapFocus","searchActions","handleEscKeyDown","TOGGLE_SLIDEOUT_MENU","navigation","itemParams","langKey","DEFAULT_OPTIONS","newOptions","brightnessPlugin","savedBrightness","brightnessIsPaused","pauseFullBrightnessMode","setBrightness","resumeFullBrightnessMode","setBrightnessToMax","backupCurrentBrightness","fail","getBrightness","brightness","getCallbacks","setCallbacks","q","promiseWrapper","buy","buyLang","oneLang","allLang","any","anyLang","getOffEach","getEachFor","getFor","freeLang","offLang","cachePromiseById","cachedOffers","localScope","updatingOfferStatePromise","addLoyaltyCard","updateOffer","fetchContinuityOffers","enableContinuityOffers","include_inactionable","fetchPersonalizedOffers","offerInCart","offerToUpdate","offerUpdateType","updateOfferProgress","offerProgressCondition","offerConditionType","offerProgressDifference","remaining","endSentence","all_products","offerRewardType","discount","progressReward","continuityOffers","qualifyingProducts","rwd_collection_title","labelOffer","use_cart_offer","cartOffer","offerModel","sendContinuityOffersMessage","CONTINUTIYOFFERS","GETCONTINUTIYOFFERS","sendOffersMessage","OFFERS","GETOFFERS","sendPersonalizedOffersMessage","personalizedOffers","PERSONALIZEDOFFERS","GETPERSONALIZEDOFFERS","OFFER_ORIGIN","onpageshow","persisted","labelMap","pickupFee","isFulfillmentFee","isIcFulfilled","order_reference","deletePriceAlert","removePriceAlertById","addPriceAlert","createPriceAlertById","getAllPriceAlerts","getPriceAlerts","beacon","onClickBeacon","pxViewportObserver","viewportObserver","sideCartPeekWidth","getComputedStyle","getPropertyValue","rightMargin","viewPortBeaconTimeouts","getObserver","getBeaconURL","on1pxViewportBeacon","onViewportBeacon","fetchProfilePromise","qualitricsId","qualitricsScript","initQualitrics","addRootElemntToDom","g","f","setTime","toGMTString","t","readyState","attachEvent","AppRate","rateAppLocalStorage","remindagain","rated","mobileRateAppAvailable","checkRemindAgain","remindAgain","addDays","preferences","displayAppName","usesUntilPrompt","promptAgainForEachNewVersion","inAppReview","simpleMode","storeAppURL","ios","androidPackageName","customLocale","laterButtonLabel","rateButtonLabel","yesButtonLabel","noButtonLabel","appRatePromptTitle","feedbackPromptTitle","handleNegativeFeedback","onRateDialogShow","_callback","onButtonClicked","buttonIndex","AppRatePlugin","promptForRating","callRateDialogImmediately","getAppHistory","skipAngularLocationUpdate","shouldLogPageview","removeLocationListener","removeHistoryListener","hash","targetPath","recaptchaSdkLoaded","Cypress","isPaymentsEnabled","getClientSignature","grecaptcha","enterprise","s","client_signature","recaptchaLoadError","callbackBody","createClientSignature","recaptchaOnLoad","openRecaptchaInModal","reCaptchaSetup","recaptchaModal","closeRecaptchaInModal","isRedirectUrlValid","enable","isDotComHostname","defaultState","isMobileContainerUrl","openExtLink","hasValidRedirectUrl","currentUserStoreId","currentDeliveryPostalCode","reservationSelectors","oldContext","oldUserStoreId","oldDeliveryPostalCode","timeslotSelectionAtCheckoutOnly","getPreviewTimeslot","setDefaultReservation","querystring","fetchReservation","userIntent","createReservation","shouldShowLeadTimeAlert","formattedReservationFromTime","leadTimeEndTime","showLeadTimeAlert","toLocaleString","enableExpiredTimeslotErrorModal","expiredTimeslotReservationCompleteError","expiredReservationError","RestangularProvider","setBaseUrl","addResponseInterceptor","operation","addFullRequestInterceptor","_what","httpConfig","trace","headerObj","StoreId","FulfillmentType","DeliveryPostalCode","headerObjJsonStrB64","includeRequestSource","withCredentials","newCheckoutExitTimer","oneCartCheckoutRedirectFunc","isDeepLinking","runtimeRoutes","newCheckoutConfig","CHECKOUT_ROUTES","CHECKOUT_ROUTES_FACTORY","addState","showCartTotals","oneCartCheckoutRedirect","reviewCart","manualUpsell","clearGlobalCachedListeners","V1","_viewCartAnalytics","UPSELL","upsellTitle","upsellProductsInCart","schedule","userProfile","pay","CHECKOUT_REVIEW","postCheckoutPage","CheckoutRoutes","checkoutRoutes","shoppingContextSelectors","shoppingContextActions","SHOPPING_LIST_CACHE_KEYS","DEFAULT_PRODUCT_IMAGE","DEFAULT_HEADER_IMAGE","cachePayloadList","cachedShoppingList","newCache","updatedCache","noImage64","noHeaderImage64","getCachedCartModifiedPromise","lastModifiedOffline","userlistEndpoint","getOnlineCartModifiedPromise","modifiedOffline","onlineCart","modified","setCart","setCategories","getProductIndex","itemB","itemA","isConfigurableProductEqual","isCustomProductEqual","updateItems","updateItemInObject","productIndex","discount_total","awarded","isCartMode","storeDistanceReferenceMap","preferredFulfillmentType","showEcommerce","userStoreId","storesPayload","GETSTORES","STORES","GETSTORE","createPoint","coordinates","getStoresWithinRange","range","storesInRange","distance","pointA","pointB","units","distanceBetween","closestStore","storeSearchRange","matchBySearch","last_purchased","strStoreID","activeStoreIdx","prioritizeActiveStore","getAddressCoordinates","setData","newData","getData","getStoreSubscriptions","hasOverrideIndex","filteredTags","rejectValue","sortTags","requireRegisteredTags","activeFilters","allFilters","filterTag","isObject","isString","tagsRequiringRegistration","removeRequiredTags","indexOfTag","TAG_LOGIN","isFunction","getSelectedFilters","nonFacetedRoutes","useFacetedFilters","hideFilters","getTagsForLocation","adjustTags","getTags","adjustTag","cleanTag","clonedTag","tagVal","tagKeys","tagKey","filterDynamicTags","areTimeslotsSelectable","cantLoadTimeslots","immediate_timeslots","eComLightFulfillmentType","switchContextAndRedirectIfNecessary","TOGGLE_CATERING_MODE","comm","sendAdditionalContextDetails","storeName","detailString","full_datetime","detail_string","ADDITIONALCONTEXTDETAILS","detail","atStore","handleDebugEvents","debugMode","initialize","bindEvents","onDeviceReady","universalLinks","eventData","cleanURL","handleDeepLink","getDeepLink","decodedLink","decodeURIComponent","initializeUAirship","updateChannelID","deviceType","channel_id","device_type","resetBadge","logUserSegmentEvent","metaData","logUserLinkLoyaltyCard","logUserLogout","logUserRegistrationAttempt","logUserUpdateProfile","logUserLoyaltyOnboardingSocialSignOn","logUserSSORedirect","userOverridesService","listOfOverrideParams","overrideData","getIntent","parseOverrideParams","userOverrideStateParams","hideCartCompareBeforeOverride","hide_cart_compare_on_arrival","confirmContext","confirm_context","CONFIRMCONTEXT","enterLocation","enter_location","newExternalStoreId","forcedStoreId","forceStoreId","newStoreId","b2b_store","newZip","delivery_zip","determineOverridePayloadAndShoppingSelectorStep","currentUser","payloadAndSelectorStep","currentZip","destinationContext","destinationStoreId","destinationZip","successfulOverridePayload","overridePayload","addContextToPayload","addStoreIdToPayload","addZipToPayload","generateSuccessfulOverridePayload","shoppingSelectorStep","storesRequestPayload","supportedStores","overridePayloadToReturn","_determineOverridePayloadAndShoppingSelectorStep_","userOverridePayload","ext_store_id","openToStoreSelectorStep","openShoppingSelectorAfterOverride","handleContextModalDeepLinks","updateExistingUserWithOverrides","cartComparePayload","updateUserWithOverrides","getCards","loyaltyCardsPromise","loyalty_cards","loyaltyPointsMultiplier","updateCards","updateAll","updateLoyaltyCards","cards","getPasses","loyaltyPassesPromise","getLoyaltyPasses","createPass","primary_card","getNonPrimaryLoyaltyCard","internalStateObj","parentFn","isUat","isDev","wrapArray","normalizeName","LoadScriptError","stack","categoryNameFromId","scrollToPosition","scrollToTop","loadInternalExternalAssets","getLogoFromBannerSlug","logoImageUrl","containerSelector","containerElement","urlHost","isLinkCurrentPageByUrl","windowContext","scriptLoaded","script","onreadystatechange","onerror","STRIP_OUT_LEADING_ZEROS_REGEXP","semVerDifference","segmentsA","segmentsB","l","repaint","els","maxTries","waitFocus","isBlurOfIframe","focusable","onblur","onfocus","escapeParentheses","escaped","encodeURI","stateIs","stateName","compareStateName","compareParams","withoutPage","cleanShopParams","previousStates","wentBack","crossOrigin","drawImage","dataURL","toDataURL","getArrayOfSpecificLength","objects","parseQueryParams","queryString","kvs","pair","getStateFromPath","exec","getStateFromUrl","generateUrlQuery","prefix","numberOfDays","getMonth","getDate","getHours","getMinutes","getSeconds","removeSearchParametersGoToState","paramsToRemove","goOptions","newVersion","enterPromoCode","notify","isIE","MSInputMethodContext","documentMode","inputStrings","expectedStrings","expectedString","stringA","toLocaleLowerCase","IntersectionObserverEntry","chunkify","tz","j","n","aa","bb","storeKey","maxAge","isNonZero","dotComConfig","isMobileNative","initialFocus","initialFocusableElements","0","firstFocusElement","handleTabNavigation","focusableElements","focusableElementsArray","firstElement","lastElement","shiftKey","previousAriaHiddenValues","excludedElements","elementQueue","currentElement","isFixedLayout","$current","getInternationalPhoneNumber","moduleFnsMap","controllerName","moduleFn","isController","modules","newWin","oldWin","modalDomEl","topWindowZIndexStr","zIndex","modalBackdrop","loggedInStatus","getMobileMenuItem","menuSlug","wordpress","fetchWpMenu","getCategories","searchPages","mobileSideNavItemsPromiseArray","memoGetWordpressMenuItems","filteredWordpressMenuItems","showNative","showWeb","secureWordpressMenus","arrayOfPromisesOfMenuApiCalls","menuItems","amenities","TAB_PRODUCTS","searchTabs","TAB_RECIPES","TAB_CONTENT","searchSession","startNewSession","createSnridFromDotcomCookie","Cookies","getSnrid","enableSearch","enableSearchNativeMobile","enableRecipeSearch","search_result","result_set","legacyStorageService","legacyStorage","deprecatedClear","deprecatedKeys","feeConfigs","additionalFees","sourceKeys","feesWithValues","isSubfee","shouldShowFee","feeValue","originalFeeValue","subFees","getSubfees","subFee","getLabel","descriptionReference","tooltip","tooltipReference","showFreeIfZero","subItems","serverFees","flatMap","reduceRight","reduceServerFees","feeSource","isComposed","subfees","subfee","subkey","originalFeeKey","disablePickFees","parentFee","labelFn","labelReference","labelReferenceOverrides","labelRef","isFree","whenZero","doesSubscriptionWaiveFee","waiving_fee_types","removeAllListeners","CONTEXT_SELECTOR_BUTTON_CLICK","desktopHomeIcon","desktopHomeDelivery","desktopHomeStore","desktopHomeReservation","handleReserveTimeslotClick","shoppingSelectorRoute","openTimeslotSelector","getBannerNameTitle","bannerSwitchingTabTemplate","storeSupportsContext","updateStore","selectAssociatedStore","alcoholExclusive","mobileNavTopBar","MOBILE_CONTEXT_SELECTOR","removeRxItemsFromCart","cartServiceFetch","rxDeliverableContext","is_rx_sso","upsell_modal_enabled","enableRxUpsellModal","rxUpsellModal","sso","fullfillmentNotAvailableModal","OPEN_FULFILLMENT_NOT_AVAILABLE_MODAL","AddressSearch","AddToCart","AlcoholValidation","Analytics","AnalyticsHelper","AnonymousIdService","Api","Auth","Canvas","Cart","CartAnalytics","CartListTransferModal","CheckoutAnalytics","CheckoutService","ContextSelectorButtonService","CodePush","ConfirmationModal","ConfigService","Debug","EbtCard","EcomLight","ErrorInterceptor","Express","FacetedSearchService","FulfillmentNotAvailableModal","GiftCardModalService","HeaderFooterSync","ImageURL","Instacart","IcExpressModalService","Lang","LegacyModal","List","ListPrintServices","LoyaltyService","ManualUpsell","Master","MasterCart","Mobile","MobileNativeHref","MobileNav","ModalOptionsService","NativeMobileBrightnessService","NavMenuCallbacks","NgPromise","OfferAnalytics","OneCart","OrderService","Placements","PriceAlerts","Products","PromoCodeValidationService","QualitricsService","RateApp","ReactRouterHistory","Redirect","Routing","RxUpSellService","RuntimeRoutes","ShoppingContext","ShoppingListCache","SideCartService","Stores","Subscriptions","SubscriptionCheckoutService","Tags","TimeSlot","ToggleEcomLight","UnataCommService","UnataCommInterceptorService","UndoRemove","UniversalLinks","Update","UrbanAirship","UserAnalytics","UserOverrides","UserOverridesV2","UserService","WordpressRestApi","LocalStorage","OrderFees","authorizeNetPayment","setCreditCard","iframe","authCaptureEvent","formAuthorizeNet","PaymentProfileId","paymentProfileId","submit","isIframeVisible","getPaymentInstruments","instruments","firstInstrument","newCard","previousList","instrument","paymentInstrumentId","getAuthToken","payer_token","authTokenTimeout","authCaptureAddCard","authCaptureEditCard","AuthorizeNetService","AuthorizeNetController","_result","resetAndReject","resetPromiseable","braintreePayment","getDependencies","promiseable","braintree","hasCard","brainTreeIsReady","has_cards","paymentMethodReceived","nonce","verifiedPayment","setup","onPaymentMethodReceived","payment_nonce","paymentMethodNonceReceived","formBrainTree","createEvent","initEvent","dispatchEvent","BrainTreeController","BrainTreeService","configurablePayeezy","visa","mastercard","diners","discover","jcb","u","apikey","js_security_key","ta_token","firstData","clean","setApiKey","setJs_Security_Key","setTa_token","setAuth","cleaned","firstDataPayment","Payeezy","expiryMonth","expiryYear","resetForm","showFirstDataForm","hideAddCardButton","clearCardData","cardType","ccNumber","cardDescription","zipPostalCode","logo","showAddCardForm","initCall","selectedCard","existing","apiKey","jsSecurityKey","taToken","tokenValue","cardholderName","cardholder_name","exp_date","customerToken","expiry_date","holder_name","cancelAddCard","deleteCard","deleteCardMessage","identifiedType","FirstDataController","FirstDataService","FIRST_DATA_CSS_CLASSES","FIRST_DATA_SELECTORS","FIRST_DATA_ERROR_TYPES","firstDataV2Payment","payeezyCallback","firstdata","firstDataFormReady","clientToken","publicKeyBase64","_getDescriptionField","_getZipField","langStrings","cardHolderName","cvvCode","expiryDateSingleField","formConfig","classes","empty","cvv","preFlowHook","providerFn","preValidateFn","paymentForm","validationError","FIRST_DATA_ERROR_TYPE","isPreValid","authenticate","_onSubmit","createPaymentForm","initiateFirstData","creditCardFields","isNewOrUpdate","initialCall","oldLength","newLength","latest","validateDescriptionAndZip","paymentListRefresh","tooManyRetriesError","firstDataV2","errorServiceModalPromise","descriptionInput","zipInput","FIRST_DATA_INFORMATION","FirstDataV2Controller","FirstDataV2Service","APIKey","handleGigyaSubmit","gigyaResponse","userPromise","isLoginScreen","isRegistrationScreen","validLoginRegisterResponse","UID","UIDSignature","signatureTimestamp","_gigyaResponse","handleCheckoutAddressUpdate","accounts","hideScreenSet","screenSet","screenSets","ProfileUpdate","enableRegistrationLogsIn","submitAction","loginPayload","uid","uid_signature","signature_timestamp","rootScope","loginResponse","handleGigyaHide","hideResponse","gigyaLogin","gigyaClient","showPlugin","registrationLogin","onAfterSubmit","showScreenSet","onHide","gigyaRegister","registrationParams","startScreen","sendRefererOnRegistration","regSource","gigyaResetPassword","profileUpdate","gigyaForgotPassword","gigyaProfile","containerID","syncLogout","getAccountInfo","handleAccountInfoResponse","statusReason","gigyaUser","accountInfoPayload","sendRequest","syncLogin","authenticateGigyaUser","handleAccountInfoSuccess","logoutPayload","Event","GigyaService","additionalFormInfo","addCardLabel","enableGiftCards","showCreditCardSelectButton","hideTitle","styleAddCardAsLink","createCreditCardLabel","enableCancelFormButton","enableCreditCardListBackground","enableCreditCardSelectButton","onCreditCardSelect","fullWidthButtons","squaredButtons","enableFormBackground","enableCreditCardSelectAfterAdd","requestUserPaymentOnFirstFetch","stripePayment","checkoutSave","handleDeleteClick","deleteCreditCardMessage","digits","pi","showStripeForm","shouldShowStripeForm","openGiftCardsModal","hideStripeForm","hasSelectedCard","handleCancelClick","handleCreditCardAdd","handleCreditCardAddError","firstFetch","paymentExtIdOfCurrentAuthType","paymentExtIdOfExternalAuthType","paymentExtId","existingExtId","stripeProvider","setAPIKey","Stripe","destroy","mount","StripeController","StripeService","vantivPayment","getIframe","existingPaymentInstruments","showAddInstrument","showAddInstrumentLoader","baseUrl","$$protocol","$$host","$$port","web_url","transaction_setup_id","clearVantivIframe","loadVantivIframe","toggleAddInstrumentLoader","isShow","selectExtId","sanitizedExistingPaymentInstruments","isNew","shouldSave","addPaymentInstrument","loadInitial","addVantivHandlerAndWait","vantivReturnHandler","HostedPaymentStatus","CVVResponseCode","AVSResponseCode","isCvvResponseOk","isAvsResponseOk","TransactionID","prevTransactionId","LastFour","PaymentAccountID","CardLogo","transaction_id","isRetry","isRecaptchaReady","UI_isRetry","reloadPaymentInfo","recaptchaResponse","backToCardView","timedout","addCardFailed","onRecaptchaReady","isLastEditMode","onDeleteCard","extId","findCard","onUpdateCard","saveInProfile","onPaymentIframeRendered","renderedIframe","onSelectCard","getSelectedCard","idOrExtId","VantiveController","VantiveService","WEGPAY_ERROR_TYPES","WEGPAY_RETURN_CODES","870","871","872","873","874","875","876","881","882","883","884","885","889","826","827","828","877","878","879","WEGPAY_MASKS","cardHolder","WEGPAY_CARD_TYPE_CODES","AX","DI","MC","VI","shortUUid","constants","flickrBase58","wegpayPaymentForm","WegpayPayment","wegpay","wegpayConfig","wegpayCallback","cardZip","cardShouldSave","notifyNewCreditCardFunction","notifyNewCreditCard","notifyIsShowingAddCard","iFrameJavaScript","iFrameJSsrc","minJQueryVersion","jQuerySrc","hasJquery","jQuery","hasWegpay","EprotectIframeClient","jquery","importWegpayDependencies","loadCards","hasInstruments","showCardLoader","lastInstrument","_sortPaymentListById","lastExtId","stillExists","_processPaymentInstruments","isError","clearWegpayIframe","putCreditCardType","iframePromise","targetDomId","transactionId","autoAdjustHeight","submitFnGetter","eProtectIframeClient","promiseFns","isDoSubmit","iframeOpts","pciNonSensitive","getPaypageRegistrationId","div","paypageId","payPageId","reportGroup","payPageReportGroup","showCvv","iFrameStyleSheet","htmlTimeout","numYears","accountNumber","expMonth","expYear","paypageRegistrationId","showWegpayIframe","wegPayResponse","paymentInfo","zip","saveOnFile","bin","firstSix","invokeMerchantCallback","lastFour","responseTime","targetServer","vantivTxnId","save_on_file","uiGenerated","wegpayBin","newCreditCardPayload","newCreditCard","postNewCreditCard","returnCodeLangMap","NAME_OR_ZIP","cardIdx","lastSelected","deletedIsLast","paymentList","WegpayController","WegpayService","OPTIONAL_COMPONENTS","Authorize","Braintree","FirstData","FirstDataV2","Gigya","Vantiv","Wegpay","FEATURE_SUPPORT","buildConfig","exportableModules","foundPaymentFeatureMaps","_grabAttentionInConsole","featureMap","justifyContent","minHeight","opacity","LazyLoadingIndicator","dotColor","ngIgnore","BaseComponent","HOC","React","Component","filteredProps","newProps","acc","newKey","reactWrapper","indicatorProps","rest","AppProvider","aria-hidden","ProductRating","lazy","RatingWithCount","ImageTile","UserReviews","App","Nutrition","ProductPrice","CartLoyaltyBalance","CartRewardsTile","CartCheckoutSubscriptionSelect","SubscriptionPage","LoyaltyBarcode","LoyaltyTransactions","TimeSlots","ErrorWindow","ProfilePage","AccountImportModal","AccountImportSuccessModal","AccountImportErrorModal","UserMenu","UserMenuLinks","MobileListNav","OrderTrack","OrderTotals","AddressAutocomplete","ExpressPlanModal","ExpressPlans","ExpressSignupModal","ExpressGiftCardRedeemModal","ExpressPoweredBy","ExpressFooter","ExpressCountDown","ExpressPromoPlanChange","ExpressPromoPlanChangeModal","MobileMenuWithExpressPopover","RxRedirectErrorModal","RxUpsellModal","ItemTile","ItemTileContainer","PolicyModal","HeroBanner","HomepageBanners","PricingDisclosure","ProductUnavailableDisclaimer","FulfillmentBanner","IwsRegulationAlertModal","MiniCartList","QuickLinks","ProductImageCarousel","dependencies","react2angular","Checkbox","loyaltyCartTitle","loyaltyCartMessage","loyaltyPointsDisplayFormat","loyaltyPoints","CartButton","CartIconButton","lazyLoadables","importModule","angularModule","$compileProvider","lazyLoadedNames","childElementCount","getName","attributes","indicator","_invokeQueue","func","alert","testCookie","printWarning","memoryStorage","isStale","jest","fixCapacitorCookies","clientConfigModule","StatesAndProvinces","constant","getRuntimeConfig","AngularApp","angularRootEl","useIsReactRoute","setIsReady","angularJSDependencies","isBarebone","useContext","AngularAppContext","useEffect","AngularIntegration","moduleName","ngAria","ngRedux","ngTouch","uiMask","restangular","uiRouter","ngSanitize","ocLazyLoad","dropdown","typeahead","Services","Components","LazyLoadingService","OptionalComponents","ReactComponents","AdditionalComponents","$ariaProvider","$locationProvider","$ngReduxProvider","$sceDelegateProvider","hashPrefix","hashTypeValue","html5Mode","shouldUseHashHistory","resourceUrlWhitelist","headerFooterLocation","debugInfoEnabled","preAssignBindingsEnabled","imgSrcSanitizationWhitelist","aHrefSanitizationWhitelist","tabindex","bindRoleForClick","provideStore","reactRouterHistory","RELOAD_ANGULAR_STATE","hasOverrideParamsInURL","goToStateCallback","redirectTrialUser","CustomEvent","$uibTooltipProvider","loadOrder","mobileOnboardingService","unataLoaded","skipModalPaths","$$path","footer","otherwise","qualitricsService","routingService","hasThirdPartyAuth","hasNoRenderParam","previousStateParams","watchScope","needsNativeIosStyleFix","performInternalRedirect","urlOverwrite","stateGoOptions","externalStates","internalRedirects","fromStateName","toStateName","scripts","unataCommInterceptorService","GETADDITIONALCONTEXTDETAILS","UNATADEBUGMODE","setupAngularApp","bootstrap","ng-class","react-storefront-builder","ui-view","ng-if","data-test","define","Configurer","object","safeMethods","isSafe","absolutePattern","isAbsoluteUrl","string","isUndefined","absoluteUrl","setSelfLinkAbsoluteUrl","newBaseUrl","extraFields","setExtraFields","newExtraFields","defaultHttpFields","setDefaultHttpFields","plainByDefault","setPlainByDefault","withHttpValues","httpLocalConfig","encodeIds","setEncodeIds","encode","defaultRequestParams","common","setDefaultRequestParams","param1","param2","methods","requestParams","defaultHeaders","setDefaultHeaders","methodOverriders","setMethodOverriders","overriders","isOverridenMethod","jsonp","setJsonp","urlCreator","setUrlCreator","urlCreatorFactory","restangularFields","parentResource","restangularCollection","cannonicalId","etag","selfLink","patch","getRestangularUrl","getRequestedUrl","putElement","addRestangularMethod","getParentList","clone","reqParams","several","allUrl","customPATCH","customDELETE","customGET","customGETLIST","customOperation","doPUT","doPATCH","doPOST","doDELETE","doGET","doGETLIST","fromServer","withConfig","withHttpConfig","singleOne","save","restangularized","setRestangularFields","resFields","isRestangularized","setFieldToElem","properties","idValue","prop","idKey","getFieldFromElem","setIdToElem","getIdFromElem","isValidId","elemId","setUrlToElem","getUrlFromElem","useCannonicalId","setUseCannonicalId","getCannonicalIdFromElem","responseInterceptors","defaultResponseInterceptor","responseExtractor","what","theData","interceptor","extractor","errorInterceptors","setResponseInterceptor","setResponseExtractor","requestInterceptors","defaultInterceptor","fullRequestInterceptor","defaultRequest","addRequestInterceptor","setRequestInterceptor","setFullRequestInterceptor","onBeforeElemRestangularized","setOnBeforeElemRestangularized","setRestangularizePromiseInterceptor","restangularizePromiseInterceptor","onElemRestangularized","setOnElemRestangularized","shouldSaveParent","setParentless","isBoolean","suffix","setRequestSuffix","newSuffix","transformers","matchTransformers","addElementTransformer","secondArg","thirdArg","isCollection","transformer","transformerFn","coll","regexp","extendCollection","extendModel","transformElem","force","transformLocalElements","changedElem","typeTransformers","setTransformOnlyServerElements","fullResponse","setFullResponse","full","BaseCreator","setConfig","parentsArray","resource","localHttpConfig","callHeaders","callParams","configurer","RestangularResource","Path","normalizeUrl","__this","acum","elemUrl","elemSelfLink","fetchUrl","fetchRequestedUrl","encodeUriQuery","pctEncodeSpaces","iterator","sortedKeys","forEachSorted","globalConfiguration","createServiceForConfiguration","urlHandler","restangularizeBase","addRestangularMethodFunction","copyRestangularizedElement","stripRestangular","parentId","parentUrl","pickedFields","pickedValues","restangularFieldsForParent","merge","isNumber","restangularizeElem","restangularizeCollection","restangularizePromise","valueToFill","promiseCall","promiseGet","$object","callArgs","filledValue","resolvePromise","array","newElem","addCustomOperation","customFunction","requestMethods","delete","requestFunc","callOperation","alias","fetchFunction","copiedElement","localElem","getFunction","putFunction","postFunction","deleteFunction","headFunction","traceFunction","optionsFunction","patchFunction","putElementFunction","getById","elemToPut","filledArray","serverElem","newArray","parseResponse","resData","whatFetched","okCallback","fullParams","processedData","elemFunction","resParams","callObj","filledObject","isOverrideOperation","defaultParams","defaultElem","bindedFunction","createdFunction","knownCollectionMethods","serv","restangularizeElement","CHECKOUT_VERSIONS","routeName","useForceUpdate","setTick","useState","useCallback","tick","useLoading","forceUpdate","useSubscriptions","SUBSCRIPTION_PATHS","BUYING","GIFTING","borderTop","toPx","regular","forwardRef","imgAltText","defaultProps","propTypes","PropTypes","isRequired","memo","paths","restProps","currentParams","setCurrentParams","getNextStep","nextStepIndex","onStepComplete","stepIndex","renderedSteps","Step","arrayOf","textAlign","h2","mediaQuery","breakpoint","h1","maxWidth","defaultLang","Header","paddingLeft","spacing","paddingRight","valueProposition","xSmall","xxxSmall","padding","marginBottom","xxLarge","buttonStyles","flexWrap","disclaimer","secondary","family","SubscriptionMarketing","marketing","isGiftable","alignContent","justify","align","buyingSubscriptionButtonLabel","giftingSubscriptionButtonLabel","dangerouslySetInnerHTML","__html","bool","relativeTime","horizontalCenterAlign","subscriptionsContainer","borderRadius","neutral","grey1","marginTop","radioContainer","textTransform","none","inputLabel","xxSmall","formLabel","currentDate","formatDays","expiryDate","nextTenYears","fill","listOfMonths","selectSubscription","emailLabel","emailPlaceholder","dateLabel","customMessageLabel","customMessageCharacters","dateSelect","SubscriptionSelection","maxMessageLength","showDateSelection","setFormData","selectedYear","selectedMonth","customMessage","daysForSelectedMonth","setDaysForSelectedMonth","newDaysList","daysInMonth","getErrors","updatedFormData","selectedDate","foundError","handleStateChange","newState","onSubmit","subs","bold","inputSize","FormLabelProps","helpText","FormHelpTextProps","multiline","isRequred","boolean","created","oneOf","CARD_PROPS","is_new","fontWeight","weight","whiteSpace","cardSelected","cardRow","radio","flex","radioButton","cursor","overflow","textOverflow","labelSelected","deleteContainer","deleteLink","float","deleteLinkHidden","shouldSaveContainer","grey4","fontStyle","submitButton","choosePayment","submitCard","selectedCardExtId","showSaveCardToggle","onSubmitCard","radioBoxName","htmlFor","iframeActive","iframeTitle","PaymentIframe","showIframe","iframeRef","createRef","scrolling","frameBorder","PaymentFormVantiv","PureComponent","isAddNewCard","isIframeLoading","vantivUrl","onAddNewCard","containerLoading","withStyles","isAddNewCardRoot","criticalErrorMessage","SubscriptionPayment","loadingService","BUY_SUBSCRIPTION","GIFT_SUBSCRIPTION","setErrorMessage","showLoading","errorLang","buySubscription","giftSubscription","advancedFormat","xLarge","buttonContainer","secondMessage","buyingMessage","continueButton","buying","message1","message2","gifting","SubscriptionSuccess","htmlVars","white","originalStyles","isGiftingEnabled","i18nWithDefaultHeaderInSteps","newI18n","selectOption","subscribedTitle","subscribedSubtitle","ariaLabels","toggleSubscriptions","cartItems","radioLabel","verticalAlign","radioLabelText","paddingTop","subscribedIcon","marginRight","subscriptionInCart","getSubscriptionFromCart","passOldSubscription","newSubscription","listItems","defaultChecked","aria-label","subscriptionName","formatCurrency","isNotSubscribed","wrap","CartCheckoutSubscriptionSelectSmart","isLoaded","GET_STORE_SUBSCRIPTIONS","COMPLETE","requestAnimFrame","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","elId","_el","_radius","_duration","_value","_maxValue","maxValue","_text","htmlifyNumber","_strokeWidth","_colors","_svg","_movingPath","_wrapContainer","_textContainer","_wrpClass","wrpClass","_textClass","textClass","_valClass","valueStrokeClass","_maxValClass","maxValueStrokeClass","_styleWrapper","styleWrapper","_styleText","styleText","endAngleRad","PI","_start","_startPrecise","_precise","_circ","_generate","VERSION","_svgSize","_radiusAdjusted","_generateSvg","_generateText","_generateWrapper","_setPercentage","_calculatePath","_getText","getValueFromPercent","lineHeight","createElementNS","_generatePath","pathClass","endPrecise","_arc","endAdjusted","longArc","cos","sin","integerPartClass","decimalPartClass","updateRadius","updateWidth","updateColors","getPercent","getMaxValue","newPercentage","isGreater","stepDuration","oldPercentage","animate","lastFrame","deltaTime","InputGroup","TimeslotSelectLoading","timeslotsError","TimeslotsContainer","getTimeslotOptions","dateFormat","TimeslotSelect","setSelectedDate","setSelectedTimeslot","useTimeslotsQuery","memoizedTimeslotOptions","native","utilsService","groceryQuery","cateringQuery","oneOfType","isHideTimeslotFee","showTimeslotPickupFeeAsFree","withinHours","blackoutUnavailableReason","light","borderBottom","buttonSelected","timeRangeText","selectButton","pointerEvents","readOnly","timeLabel","ui","unavailableReason","showDetailButtonOverrides","onSelected","isAttemptingToSelect","useMemo","slotIsUnavailable","handleSelection","showUnavailableDetail","setShowUnavailableDetail","useMediaQuery","hideFreeText","shoppingModeFee","freeText","formatFeePrice","unavailabilityReasons","onKeyDown","showDate","aria-current","buttonUnavailable","buttonNotSelected","borderColor","fastestPossible","NAVIGATION_KEYS","Day","dayTabLabel","formatDayOfTheMonth","tabProps","role","formatDayOfTheWeek","loadingUseStyles","margins","nowrap","TimeSlotsLoading","alwaysShowAvailabilityCheckbox","loadingStyles","titleRow","titleRowWithoutCheckbox","dayPager","noWrap","fadeIn","keyframes","NAVIGATION_KEY_STEPS_MAP","ArrowUp","ArrowLeft","ArrowDown","ArrowRight","Enter","Spacebar","paddingBottom","moreTimesButton","availabilityCheckbox","noTimeslotsHeader","timeslotListItem","timeslotsList","listStyle","noTimeslotsDayMessage","goToCartButton","noTimeslotAvailable","noTimeslotsForDayError","selectedTimeSlot","isSmallBreakpoint","firstTimeSlotAfterMoreTimes","timeslotsContainer","dayTabs","setPage","onlyShowAvailableTimes","setOnlyShowAvailableTimes","showAllTimeSlots","setShowAllTimeSlots","setSelectedDay","attemptingToSelectTimeSlotId","setAttemptingToSelectTimeSlotId","isTimeslotAvailable","unavailabilities","unavailableCountByDay","dayUnavailability","maxUnavailableCountByDay","dayKey","isAvailable","unavailableCount","currentDayUnavailability","getFirstAvailableDay","daysForPage","availableDay","isTimeSlotBetween","attemptingToSelectTimeSlot","getTimeSlotFromUniqId","isEqualTimeSlot","invalid_params","timeSlotsDay","isEqualDay","handleTimeSlotSelected","getUniqIdFromTimeSlot","showAvailabilityCheckbox","filteredTimeslotsForDay","showTimeslotFeeAsFree","useConfig","pageCount","ceil","onPageClick","showPageCount","previousLinkLabel","nextLinkLabel","showAllDays","visibleDays","selectedDayIndex","aria-controls","createDaysItems","aria-labelledby","showAll","timeSlotProps","getTimeSlotId","createTimeSlotItems","iconSize","userListsSelector","userLists","webpackContext","req","webpackContextResolve","__webpack_require__","categorizeItemsByDepartment","translate","itemsArray","stringKey","singleCart","storeBanner","cartMinMsgWithBanner","states","isModuleEnabled","enableModuleByBannerKey","getCurrentBannerConfig","formattedAmount","recipeFullTags","initSaveStatus","isSaveButtonInView","filteredCategories","mobileActiveTab","openCookingModeModal","cookingModeModalTemplate","directions","totalSteps","stepsChecked","directionsPreviousStep","directionsNextStep","cookingMode","recipeHasProducts","fresh","mealkitOptions","pantry","other","openShopThisRecipeModal","shopThisRecipeModalTemplate","closeSavePrompt","userClosedSavePrompt","RECIPE_USER_REVIEW","productPlacementsFromProducts","insertPlacementsInProducts","positionedPlacements","unpositionedProductPlacements","areUnpositionedProductPlacementsFirst","unpositionedNonProductPlacements","sortedPositionedPlacements","unpositionedProductPlacementsIndex","BIA_COLLECTION_ID","HOMEPAGE_FP_COLLECTION_ID","getCurrentJsonLd","setJsonLdInHead","scriptEl","structuredData","stringifiedStructuredData","overwriteJsonLdInHead","addJsonLdToHead","PASSWORD_CHANGE","VIEW_ORDER_HISTORY","isShoppingListItem","imageTile","formatPrice","priceWithNumberTemplate","priceString","qty","productSelector","_state","shoppingCartItemSelector","hasLoyaltyCardSelector","promoDiscountSelector","createSelector","configSelector","langSelector","isMobileSelector","isLoyalty","tooltipText","tagTooltip","promoOfferSelector","thereAreSupportedOffers","offerInside","promotionsSelector","whitelist","displayPriceUnitOfMeasurementAllowlist","pricePerUnitStringSelector","regularPriceSelector","regularPriceStringSelector","priceWithQuantity","loyaltyPriceSelector","loyaltyPriceStringSelector","salePriceSelector","salePriceStringSelector","currentPriceStringSelector","regularPrice","hasPromoPriceSelector","sale","discountedPriceIsConfirmedSelector","isAvailableSelector","enableOutOfStockUIBehaviour","StockLevels","OUT_OF_STOCK","isCustomizableSelector","allowOutOfStockAddSelector","getUserIntent","showPriceAlertSelector","authSelectors","showSaveForLaterSelector","quantityInCartSelector","shoppingCartItem","maxQuantitySelector","minQuantitySelector","incrementQuantitySelector","defaultAddToCartQty","qtyInCart","orderByUnitSelector","ratingSelector","numberOfRatingsSelector","user_count","sizeSelector","sizeWithPricePerUnitSelector","pricePerUnit","subscribedForPriceAlertSelector","allowAddToCartSelector","_arg0","addToCartQty","defaultQtyToAdd","allowOOS","currentQty","qtyToAdd","allowDecrementCartQuantitySelector","decrementCartQuantityType","titleSelector","aisleSelector","addToCartLabelSelector","featuredLabelSelector","isFeatured","sponsoredLabelSelector","previouslyPurchasedSelector","previouslyPurchasedLabelSelector","showLabel","buyItAgain","labelSelector","previouslyPurchased","labelTypeSelector","LabelTypes","Featured","Sponsored","Purchased","itemTileLangSelector","langAriaSelector","accessibleLabel","customizable","decrementQuantity","incrementQuantity","removePriceAlert","reviews","saveForLaterLangSelector","ariaAddedToList","addedToList","ariaCloseButton","modalClose","ariaCreateList","createList","ariaEditList","editList","ariaLoading","ariaPopoverDisclosure","ariaPopoverLabel","saveItemForLater","closeModalActionLabel","createListInputLabel","createANewList","createListInputPlaceholderText","enterNewListName","editListActionLabel","popoverTitle","saveForLater","itemTileImageSizeSelector","itemTileImageSelector","imageSize","saveForLaterListsSelector","formatSecondsToISO8601","sku","aggregateRating","ratingValue","reviewCount","caloriesQuantity","author","prepTime","preparation_time","recipeYield","serving_size","recipeIngredient","recipeInstructions","recipe_rating","ratingCount","calories","cook_time","cookTime","total_time","totalTime","appendItemListStructuredData","itemListElement"],"mappings":"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AAO9gN,QAAQ,EAAEqwB,EAAKvvB,MACnC,GAAIA,GAAOA,EAAIsE,OAAStE,EAAIsE,MAAMtG,OAAS,EAAG,CAE5CgC,EAAI61N,iBAAmB+/D,EAA4B51R,EAAIsE,OAEvD,MAAM2xR,EAAc53Q,EAAQpH,KACzBqH,GAAmBte,EAAIsE,OAASga,EAAOC,cAAgBve,EAAIsE,MAAM,GAAGmb,cAGvEzf,EAAIse,OAAS23Q,EAEbj2R,EAAI0rL,WAAagC,EACfn9K,WAAWvQ,aAAD,EAACA,EAAKkuL,2CAChBluL,EAAIsE,OAGNtE,EAAIk2R,qBAAuBxoG,EACzBn9K,WAAWvQ,aAAD,EAACA,EAAKkuL,2CAChBluL,EAAIsE,MACJtE,EAAIse,OAAOtb,kBAINg9M,EAAMzwL,KAIVywL,I,qCCrHTjjN,EAAOC,QAAU,ogG,oDCAjB,kCAAO,MAAMm4C,EAAY,CACvB04G,UAAW,CACT,CACE7qJ,KAAM,UACNqM,MAAO,MAET,CACErM,KAAM,SACNqM,MAAO,MAET,CACErM,KAAM,mBACNqM,MAAO,MAET,CACErM,KAAM,UACNqM,MAAO,MAET,CACErM,KAAM,WACNqM,MAAO,MAET,CACErM,KAAM,eACNqM,MAAO,MAET,CACErM,KAAM,cACNqM,MAAO,MAET,CACErM,KAAM,gBACNqM,MAAO,MAET,CACErM,KAAM,4BACNqM,MAAO,MAET,CACErM,KAAM,uBACNqM,MAAO,MAET,CACErM,KAAM,wBACNqM,MAAO,MAET,CACErM,KAAM,QACNqM,MAAO,MAET,CACErM,KAAM,UACNqM,MAAO,OAIX8mR,OAAQ,CACN,CACEnzR,KAAM,UACNqM,MAAO,MAET,CACErM,KAAM,SACNqM,MAAO,MAET,CACErM,KAAM,UACNqM,MAAO,MAET,CACErM,KAAM,WACNqM,MAAO,MAET,CACErM,KAAM,aACNqM,MAAO,MAET,CACErM,KAAM,WACNqM,MAAO,MAET,CACErM,KAAM,cACNqM,MAAO,MAET,CACErM,KAAM,WACNqM,MAAO,MAET,CACErM,KAAM,uBACNqM,MAAO,MAET,CACErM,KAAM,UACNqM,MAAO,MAET,CACErM,KAAM,UACNqM,MAAO,MAET,CACErM,KAAM,SACNqM,MAAO,MAET,CACErM,KAAM,QACNqM,MAAO,MAET,CACErM,KAAM,WACNqM,MAAO,MAET,CACErM,KAAM,UACNqM,MAAO,MAET,CACErM,KAAM,OACNqM,MAAO,MAET,CACErM,KAAM,SACNqM,MAAO,MAET,CACErM,KAAM,WACNqM,MAAO,MAET,CACErM,KAAM,YACNqM,MAAO,MAET,CACErM,KAAM,QACNqM,MAAO,MAET,CACErM,KAAM,WACNqM,MAAO,MAET,CACErM,KAAM,gBACNqM,MAAO,MAET,CACErM,KAAM,WACNqM,MAAO,MAET,CACErM,KAAM,YACNqM,MAAO,MAET,CACErM,KAAM,cACNqM,MAAO,MAET,CACErM,KAAM,WACNqM,MAAO,MAET,CACErM,KAAM,UACNqM,MAAO,MAET,CACErM,KAAM,WACNqM,MAAO,MAET,CACErM,KAAM,SACNqM,MAAO,MAET,CACErM,KAAM,gBACNqM,MAAO,MAET,CACErM,KAAM,aACNqM,MAAO,MAET,CACErM,KAAM,aACNqM,MAAO,MAET,CACErM,KAAM,WACNqM,MAAO,MAET,CACErM,KAAM,iBACNqM,MAAO,MAET,CACErM,KAAM,eACNqM,MAAO,MAET,CACErM,KAAM,OACNqM,MAAO,MAET,CACErM,KAAM,WACNqM,MAAO,MAET,CACErM,KAAM,SACNqM,MAAO,MAET,CACErM,KAAM,eACNqM,MAAO,MAET,CACErM,KAAM,eACNqM,MAAO,MAET,CACErM,KAAM,iBACNqM,MAAO,MAET,CACErM,KAAM,eACNqM,MAAO,MAET,CACErM,KAAM,YACNqM,MAAO,MAET,CACErM,KAAM,QACNqM,MAAO,MAET,CACErM,KAAM,OACNqM,MAAO,MAET,CACErM,KAAM,UACNqM,MAAO,MAET,CACErM,KAAM,WACNqM,MAAO,MAET,CACErM,KAAM,aACNqM,MAAO,MAET,CACErM,KAAM,gBACNqM,MAAO,MAET,CACErM,KAAM,YACNqM,MAAO,MAET,CACErM,KAAM,UACNqM,MAAO,S,qCCnQbtS,EA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","file":"51.js","sourcesContent":["module.exports = \"<div class=\\\"cooking-mode cooking-mode-modal modal-container\\\" data-test=recipe-cooking-mode-modal> <div ng-if=::mobile.isMobile class=\\\"modal-header two-line-header\\\"> <button class=close ng-click=$dismiss() aria-label={{::lang.aria.close}}> <span class=icon-delete aria-hidden=true></span> </button> <h1 class=modal-header-title> <div class=top-line>{{::lang.values.cookingMode}}</div> <div class=bottom-line>{{::cookingModeModal.recipe.name}}</div> </h1> </div> <div class=modal-content> <div class=wrapper> <div ng-if=::mobile.isMobile class=cooking-mode-modal-mobile-tabs> <div class=tabs role=tablist> <button class=tab role=tab id=tab-ingredients aria-controls=panel-ingredients aria-selected=\\\"{{cookingModeModal.mobileActiveTab === 'ingredients'}}\\\" ng-click=\\\"cookingModeModal.mobileActiveTab = 'ingredients'\\\" ng-class=\\\"{active: cookingModeModal.mobileActiveTab === 'ingredients'}\\\">{{::lang.values.ingredients}}</button> <button class=tab role=tab id=tab-directions aria-controls=panel-directions aria-selected=\\\"{{cookingModeModal.mobileActiveTab === 'directions'}}\\\" ng-click=\\\"cookingModeModal.mobileActiveTab = 'directions'\\\" ng-class=\\\"{active: cookingModeModal.mobileActiveTab === 'directions'}\\\">{{::lang.values.recipeDirections}}</button> </div> <div ng-if=\\\"cookingModeModal.mobileActiveTab === 'ingredients'\\\" class=tab-content role=tabpanel id=panel-ingredients aria-labelledby=tab-ingredients> <recipe-ingredients ingredients=::cookingModeModal.recipe.ingredients ingredient-servings=::cookingModeModal.recipe.preparation_information.serving_size></recipe-ingredients> </div> <div ng-if=\\\"cookingModeModal.mobileActiveTab === 'directions'\\\" class=tab-content role=tabpanel id=panel-directions aria-labelledby=tab-directions> <h2 tabindex=-1 id=step-counter-heading class=step-counter> Step {{cookingModeModal.directions.currentStep}}/{{::cookingModeModal.directions.totalSteps}} </h2> <p>{{cookingModeModal.recipe.directions[cookingModeModal.directions.currentStep - 1]}}</p> <div class=cooking-mode-modal-step-buttons> <button class=\\\"button left icon-chevron-left\\\" ng-if=\\\"cookingModeModal.directions.currentStep > 1\\\" ng-click=cookingModeModal.directionsPreviousStep()> Prev </button> <button class=\\\"button right icon-after-chevron-right\\\" ng-if=\\\"cookingModeModal.directions.currentStep < cookingModeModal.directions.totalSteps\\\" ng-click=cookingModeModal.directionsNextStep()> Next </button> </div> </div> </div> <div ng-if=::!mobile.isMobile> <h1 class=cooking-mode-modal-header-recipe-name>{{::cookingModeModal.recipe.name}}</h1> <button class=\\\"cooking-mode-modal-exit-button button hollow\\\" ng-click=$dismiss()> {{::lang.values.exitCookingMode}} </button> <div class=cooking-mode-modal-flex-wrapper> <div class=cooking-mode-modal-left> <recipe-ingredients ingredients=::cookingModeModal.recipe.ingredients></recipe-ingredients> </div> <div class=cooking-mode-modal-right> <fieldset> <legend class=cooking-modal-directions-title role=heading aria-level=2>Directions</legend> <ul class=cooking-modal-directions-list> <li ng-repeat=\\\"direction in ::cookingModeModal.recipe.directions track by $index\\\"> <input id=direction-checkoff-{{::$index}} class=checkbox type=checkbox ng-model=::cookingModeModal.directions.stepsChecked[$index]> <label for=direction-checkoff-{{::$index}} ng-class=\\\"['direction-text', {'direction-complete': cookingModeModal.directions.stepsChecked[$index]}]\\\">{{::direction}}</label> </li> </ul> </fieldset> </div> </div> </div> </div> </div> </div> \";","module.exports = \"<label for=card-holder-name class=wegpay-like-label> {{::lang.values.creditCardFields.cardHolderName}} </label> <input class=wegpay-like-input id=card-holder-name type=text ng-model=$ctrl.cardName placeholder={{::lang.values.creditCardFields.cardHolderName}} aria-label={{::lang.values.creditCardFields.cardHolderName}} data-test=wegpay-form-holder-name /> <label for=card-holder-zip class=wegpay-like-label> {{::lang.values.creditCardFields.zipCode}} </label> <input class=\\\"wegpay-like-input wegpay-zipcode-input\\\" id=card-holder-zip type=text ng-model=$ctrl.cardZip placeholder={{::lang.values.creditCardFields.zipCode}} aria-label={{::lang.values.creditCardFields.zipCode}} data-test=wegpay-form-zipcode /> <div id=divWegpay class=wegpay-iframe ng-mouseup=$ctrl.autoAdjustIframeFn()> </div> <span class=wegpay-after> <input class=\\\"checkbox wegpay-like-input\\\" ng-model=$ctrl.cardShouldSave id=wegmans-save-payment-instrument-checkbox type=checkbox analytics-click=\\\"['save payment instrument checkbox', 'click']\\\" aria-label={{::lang.values.saveInProfile}} /> <label class=wegpay-like-label-after for=wegmans-save-payment-instrument-checkbox analytics-click=\\\"['save payment instrument checkbox', 'click']\\\" aria-label={{::lang.values.saveInProfile}}> {{::lang.values.saveInProfile}} </label> </span> <div class=wegpay-buttons> <button id=wegpay-do-add-card class=\\\"button action unata-payment-action\\\" ng-click=$ctrl.submit() data-test=wegpay-form-save-button> {{::lang.values.addNewCard}} </button> <button id=wegpay-do-cancel class=\\\"button light\\\" ng-click=$ctrl.cancel()> {{::lang.values.cancel}} </button> </div> \";","module.exports = \"<div class=mobile-header ng-if=::mobile.isMobile> <div role=button ng-click=\\\"shoppingSelectorService.open('shoppingContext')\\\" id=reservation-confirmation-shopping-selector-service-open-shopping-context class=change ng-hide=\\\"!auth.userStoreSupportsDelivery() || !auth.userStoreSupportsPickup()\\\">{{::lang.values.change}}</div> <div class=\\\"section-divider-small section-divider-small--align-left\\\" ng-if=\\\"shoppingIntent == 'pickup'\\\"> {{::lang.values.pickupAtStore}} </div> <div class=\\\"section-divider-small section-divider-small--align-left\\\" ng-if=\\\"shoppingIntent == 'delivery'\\\"> {{::lang.values.delivery}} </div> </div> <div class=\\\"reservation-content reservation-confirmation\\\"> <h2 class=\\\"section-divider-small section-divider-small--align-left\\\"> <span class=title>{{::lang.values.pleaseVerifyInformationCorrect}}:</span> </h2> <div class=row> <div class=col> <h3 ng-if=\\\"shoppingIntent == 'delivery'\\\">{{::lang.values.deliveryAddress}}</h3> <h3 ng-if=\\\"shoppingIntent == 'pickup'\\\">{{::lang.values.contactInformation}}</h3> <div class=name>{{deliveryAddress.first_name}} {{deliveryAddress.last_name}}</div> <div class=company>{{deliveryAddress.company_name}}</div> <div>{{deliveryAddress.address1}}</div> <div>{{deliveryAddress.address2}}</div> <div>{{deliveryAddress.city}}<span ng-if=deliveryAddress.city>,</span> {{deliveryAddress.province}} {{deliveryAddress.postal_code}}</div> <div ng-repeat=\\\"field in ::config.deliveryAddressPhoneNumberFields\\\" ng-if=\\\"!showMultipleDeliveryAddresses && auth.user[field.key]\\\">{{::field.label}}: {{auth.user[field.key]}}</div> <div ng-if=showMultipleDeliveryAddresses>{{::lang.values.phone}}: {{deliveryAddress.phone_number}}</div> <a id=reservation-address-shopping-intent-{{field.key}} class=\\\"button small\\\" ng-if=\\\":: !handleProfileThroughGigya\\\" ui-sref=\\\"^.address({type: shoppingIntent})\\\" analytics-click=\\\"['fulfillment confirmation edit address button', 'click']\\\">{{::lang.values.edit}}</a> <a id=reservation-address-shopping-intent-{{field.key}} class=\\\"button small\\\" ng-if=\\\":: handleProfileThroughGigya\\\" ng-click=handleAddressEdit() analytics-click=\\\"['fulfillment confirmation edit address button', 'click']\\\">{{::lang.values.edit}}</a> </div> <div class=col ng-if=!showHomeStore>&nbsp;</div> <div class=col ng-if=showHomeStore> <div class=store> <h3 ng-if=\\\"shoppingIntent == 'delivery'\\\">{{::lang.values.homeStore}}</h3> <h3 ng-if=\\\"shoppingIntent == 'pickup'\\\" class=label>{{::lang.values.pickupAt}}</h3> <div class=clearfix> <div class=address> <div class=store-name>{{auth.user.store.name}}</div> <div ng-if=auth.user.store.address.address1>{{auth.user.store.address.address1}}</div> <div ng-if=auth.user.store.address.address2>{{auth.user.store.address.address2}}</div> <div ng-if=auth.user.store.address.address3>{{auth.user.store.address.address3}}</div> <div>{{auth.user.store.address.city}}, {{auth.user.store.address.province}} {{auth.user.store.address.postal_code}}</div> <div>{{auth.user.store.phone_number}}</div> </div> </div> </div> </div> <div class=col> <h3 ng-if=\\\"shoppingIntent == 'delivery'\\\">{{::lang.values.pickupDelivery}}</h3> <h3 ng-if=\\\"shoppingIntent == 'pickup'\\\">{{::lang.values.pickupTime}}</h3> <div class=\\\"pickup time\\\">{{timeslotLabelFn()}}</div> <div class=expire ng-if=!$root.modifyingOrder>{{expiryLabel()}}</div> <div role=button id=reservation-shopping-selector-service-open-timeslot class=\\\"button small top-margin\\\" ng-click=\\\"shoppingSelectorService.open('timeslot')\\\" analytics-click=\\\"['fulfillment confirmation change timeslot button', 'click']\\\">{{::(reservationService.reservation.fulfillment_date && reservationService.reservation.timeslot.from_time && reservationService.reservation.timeslot.to_time ? lang.values.modifyYourTimeslot : lang.values.changeTimeslot)}}</div> </div> </div> <div class=delivery-fees ng-if=showDeliveryFees> <h2 class=\\\"section-divider-small section-divider-small--align-left\\\"> <span class=title>{{::lang.values.deliveryFees}}:</span> </h2> <div class=clearfix> <div class=\\\"fee left\\\">{{cartService.cart.delivery_fee | currency}}</div> <div ng-if=::config.displayDeliveryLogo class=\\\"delivery-logo right\\\"></div> </div> </div> <div class=form-footer> <a ng-if=\\\"!inCheckout && !mobile.isMobile\\\" ui-sref=main.shop id=reservation-main-shop class=\\\"button button-checkout icon-go-back\\\" analytics-click=\\\"['pre-reservation confirmation bottom continue button', 'click']\\\">{{::lang.values.continueShopping}}</a> <a ng-if=\\\"!inCheckout && mobile.isMobile\\\" fixed-to-body ui-sref=main.shop.categories id=reservation-main-categories class=\\\"button button-checkout icon-after-go mobile-bottom\\\" analytics-click=\\\"['pre-reservation confirmation bottom continue button', 'click']\\\">{{::lang.values.continueShopping}}</a> <a ng-if=!inCheckout fixed-to-body ui-sref=main.checkout.cart id=reservation-main-checkout-cart class=\\\"button button-checkout icon-after-go mobile-bottom\\\" analytics-click=\\\"['pre-reservation confirmation bottom checkout button', 'click']\\\">{{$root.lang.values.checkout}}</a> <button fixed-to-body ng-if=inCheckout ng-click=toPayment() id=reservation-to-payment data-test=reservation-confirmation-button ng-disabled=isReservationExpired class=\\\"button button-checkout icon-after-go mobile-bottom mobile-fixed\\\" analytics-click=\\\"['reservation confirmation bottom continue button', 'click']\\\"> <b ng-if=\\\"mobile.isMobile && showCartTotals\\\"> {{cartService.getCartTotalForCurrentType() | currency}} - </b> {{$root.lang.values.continue}} </button> </div> </div> \";","module.exports = \"<div class=unata-store-list> <div id=unata-store-list-ct-{{store.id}} ng-repeat=\\\"store in $ctrl.stores track by store.id\\\" ng-class=\\\"{'unata-store-list__selected': store.id === ($ctrl.selectedStore && $ctrl.selectedStore.id)}\\\"> <div id=unata-store-list-item-{{store.id}} ng-if=::$ctrl.config.multipleBanners.enabled class=unata-store-list__item-flex> <div ng-if=!$ctrl.$rootScope.mobile.isMobile class=unata-store-list__item-flex-desktop> <banner-image banner-slug=store.store_banner.key></banner-image> <div class=address> <div class=unata-store-list__item-title>{{::store.name}}</div> <div>{{::$ctrl.createFullStoreAddressString(store)}}</div> <a href=\\\"tel:{{:: $ctrl.utilService.getInternationalPhoneNumber(store.phone_number) }}\\\">{{::store.phone_number | telephone}}</a> </div> <button class=\\\"button small hollow\\\" ng-click=$ctrl.handleButtonClick(store)> {{::$ctrl.config.lang.select}} </button> </div> <div ng-if=$ctrl.$rootScope.mobile.isMobile class=unata-store-list__item-flex-mobile> <banner-image class=align-top banner-slug=store.store_banner.key></banner-image> <div class=address> <div class=unata-store-list__item-title>{{::store.name}}</div> <div>{{::$ctrl.createFullStoreAddressString(store)}}</div> <a href=\\\"tel:{{:: $ctrl.utilService.getInternationalPhoneNumber(store.phone_number) }}\\\">{{::store.phone_number | telephone}}</a> </div> <button class=\\\"button small hollow\\\" ng-click=$ctrl.handleButtonClick(store)> {{::$ctrl.config.lang.select}} </button> </div> </div> <div ng-if=::!$ctrl.config.multipleBanners.enabled class=unata-store-list__item> <div class=unata-store-list__item-content> <div class=unata-store-list__item-title> <input type=radio value={{store.id}} id=unata-store-list-item-{{store.id}} name=storeListItem ng-checked=\\\"store.id === $ctrl.selectedStore.id\\\" class=radio ng-change=$ctrl.handleRadioChange(store) ng-model=$ctrl.currentStore /> <label for=unata-store-list-item-{{store.id}}> {{::(store.name || $ctrl.createStoreAddressString(store))}} </label> </div> <div class=unata-store-list__item-details> <div class=unata-store-list__item-address> {{::$ctrl.createStoreAddressString(store)}} </div> <a ng-if=\\\"store.id === ($ctrl.selectedStore && $ctrl.selectedStore.id) && store.phone_number\\\" class=unata-store-list__item-contact href=\\\"tel:{{:: $ctrl.utilService.getInternationalPhoneNumber(store.phone_number) }}\\\"> {{::store.phone_number | telephone}} </a> </div> <button class=\\\"button dark unata-store-list__select-store-button\\\" ng-if=\\\"store.id === ($ctrl.selectedStore && $ctrl.selectedStore.id)\\\" data-test=pickup-save-button ng-click=$ctrl.handleButtonClick(store)> {{::$ctrl.applyButtonText}} </button> </div> </div> </div> </div>\";","module.exports = \"<div class=\\\"ic-express-plans-modal modal-container\\\"> <div class=modal-header> {{:: $ctrl.lang.values.changeMyPlan }} <button id=ic-express-membership-modal-close-button class=close ng-click=$dismiss() auto-focus=true> <span class=icon-delete aria-hidden=true></span> </button> </div> <div class=modal-content> <p class=ic-express-plans-modal__subtitle> {{:: $ctrl.lang.values.icExpress.toSwitchPlans }} </p> <ic-express-plans plans=$ctrl.plans() selected-plan=$ctrl.currentPlan on-plan-select=$ctrl.updatePlan(plan) use-ic-theme=!$ctrl.config.icExpress.enableRetailerTheme></ic-express-plans> <div class=ic-express-plans-modal__footer> {{:: $ctrl.termsAndConditions }} </div> </div> </div> \";","module.exports = \"<div role=region aria-label={{::$ctrl.lang.aria.mapAlt}} id={{$ctrl.mapId}} class=stores-map></div>\";","module.exports = \"<div class=loyalty-placement> <div class=loyalty-placement__title> <span class=\\\"loyalty-placement__icon icon-loyalty-badge loyalty-icon\\\"></span> {{$ctrl.formattedTitle}} </div> <div class=loyalty-placement__bottom> <div class=loyalty-placement__subtitle> {{::$ctrl.subtitle}} </div> <button class=\\\"loyalty-placement__button button small\\\" ng-click=$ctrl.ctaButtonAction()> {{::$ctrl.ctaButtonLabel}} </button> </div> </div>\";","module.exports = \"<table ng-if=\\\"filteredNotificationGroups.length > 0\\\"> <tbody ng-repeat=\\\"(parentKey, group) in filteredNotificationGroups\\\" ng-if=\\\"group.notifications.length > 0\\\"> <tr ng-if=showGroupTitles> <td colspan=2> <h2 class=section-divider-small> <span class=title>{{group.name}}</span> </h2> </td> </tr> <tr ng-if=\\\"!atRegistration && group.notifications.length > 1 && group.layout !== 'checkboxes' && !group.hideToggleAllButton\\\"> <td> <div class=notification-label>{{::lang.template(config.lang.toggleAllNotifications, group)}}</div> </td> <td> <input class=checkbox type=checkbox ng-model=group.all ng-change=subToAll(group) id=notification-{{group.name}} aria-label=\\\"{{::lang.template(config.lang.toggleAllNotifications, group)}}\\\" name=notification-{{group.name}}> <label class=checkbox-switch for=notification-{{group.name}}><span></span></label> </td> </tr> <tr ng-if=\\\"group.layout !== 'checkboxes'\\\" ng-repeat=\\\"(key, notification) in group.notifications | filter:filterRegistrationOnly\\\"> <td> <div class=notification-label> {{notification.label}} <span ng-if=notification.moreLabel uib-popover-html=notification.moreText popover-trigger=\\\"mouseenter focus\\\" tabindex=0> {{notification.moreLabel}} </span> </div> </td> <td> <input class=checkbox ng-disabled=checkDisableNotification(notification) type=checkbox ng-model=payload[notification.key] ng-change=setSubToAllGroup(group) id=notification-{{parentKey}}-{{key}} aria-label={{notification.label}} name=notification-{{parentKey}}-{{key}}> <label class=checkbox-switch for=notification-{{parentKey}}-{{key}}><span></span></label> </td> </tr> <tr ng-if=\\\"group.layout === 'checkboxes'\\\"> <td> <div ng-repeat=\\\"(key, notification) in group.notifications | filter:filterRegistrationOnly\\\" class=notifications-checkbox-container> <input class=checkbox type=checkbox ng-disabled=checkDisableNotification(notification) ng-model=payload[notification.key] ng-change=\\\"\\\" id=notification-{{parentKey}}-{{key}} aria-label={{notification.label}} name=notification-{{parentKey}}-{{key}}> <label class=\\\"\\\" for=notification-{{parentKey}}-{{key}}><span>{{notification.label}}</span></label> </div> </td> </tr> <tr ng-if=group.subNote> <td class=notification-subnote colspan=2> <p ng-bind-html=group.subNote></p> </td> </tr> </tbody> </table> \";","module.exports = \"<div class=\\\"clearfix product\\\" ng-if=product> <input type=hidden name=productId id=productId value={{product.id}} /> <react-product-image-carousel images=productImageCarousel.images is-mobile=productImageCarousel.isMobile lang=productImageCarousel.lang zoom-enabled=productImageCarousel.zoomEnabled></react-product-image-carousel> <div class=product-info> <h1 ng-if=!isModal ng-class=\\\"{'no-bottom-margin': product.size_string}\\\" class=product-title ng-bind-html=productTitle() data-test=product-title></h1> <span ng-if=isModal ng-class=\\\"{'no-bottom-margin': product.size_string}\\\" class=product-title ng-bind-html=productTitle() data-test=product-title></span> <div class=product-extra-details> <span ng-if=\\\"product.ext_data && product.ext_data.retailer_reference_code && config.showRetailerReferenceCodeOnPdp\\\" class=product-rrc> {{::lang.values.retailerReferenceCode}} {{product.ext_data.retailer_reference_code}} </span> <span class=product-size ng-if=product.size_string data-test=product-size> {{product.size_string}} </span> </div> <div ng-if=\\\"mobile.isMobile && productAtStore && product.product_config && product.product_config.config_type === 'custom' && product.product_config.has_pricing\\\" class=config-total-price-mobile-top> <span class=config-total-text>{{::lang.values.total}}</span> <span class=price-amount> {{totalConfigPrice.price | currency}}</span> </div> <div class=\\\"product-attributes meta\\\"> <div class=product-rating data-test=product-rating> <div ng-if=\\\"::!config.userReviews.enabled && !config.disableUserRating\\\" rating-directive product=product></div> <div id=product-details-review role=button class=rating-review ng-if=::config.userReviews.enabled ng-click=\\\"openAndScrollToTab('reviews')\\\"> <react-rating enable-active=true rating=product.product_rating.average_rating rating-count=product.product_rating.user_count label-styles=config.userReviews.styles.pdp.label icon-size=config.userReviews.styles.pdp.icons.iconSize clickable=true /> </div> </div> <div ng-if=productAtStore ng-include src=\\\"'productDetailsPrice.html'\\\"></div> <react-product-unavailable-disclaimer ng-if=!productAtStore on-click-c-t-a=openStoreSelectorModal> </react-product-unavailable-disclaimer> <div ng-if=\\\"product.aisle && !config.disableAisles\\\" class=\\\"product-details__section product-details__border--bottom\\\"> <div class=\\\"product-aisle-text icon-solidpin\\\" ng-bind-html=product.aisle.trim() data-test=product-aisle-text></div> </div> <react-fulfillment-banner store-product=product with-border=true justify-content=\\\"::mobile.isMobile ? 'center' : 'left'\\\"> </react-fulfillment-banner> <div ng-include src=\\\"'productDetailsDescription.html'\\\" class=\\\"product-details__section product-details__border--bottom\\\" ng-if=\\\"productTags.length || !!product.description\\\"></div> <div class=\\\"product-action-buttons product-details__section secondary-actions no-border\\\" ng-if=\\\"(!product.product_config || (product.product_config && product.product_config.options.length === 0)) && auth.user.status !== 'trial'\\\"> <div price-alert product=product source=pdp></div> <add-to-list ng-if=::!config.disableSaveForLaterLists products=[product] is-external-routes-disabled=placement.isExternalRoutesDisabled></add-to-list> </div> </div> <div class=product-configurations ng-if=\\\"product.product_config && product.product_config.options.length > 0\\\" ng-class=\\\"{'has-pricing': product.product_config && product.product_config.has_pricing}\\\"> <div ng-if=\\\"reservationService.shouldShowLeadTimeAlert(product) && auth.getContext().intent !== 'instore'\\\" class=configurable-product-lead-time> <div ng-if=\\\"product.product_config.lead_time && product.product_config.lead_time > 0\\\" class=\\\"message info\\\"> <span class=icon-warning aria-hidden=true></span> <span class=unavailable-text>{{::lang.values.unavailableWithYourTimeslot}}</span><br/> {{::lang.values.prepTime}}: {{getFormattedPrepTime()}} <br/> {{::lang.values.prepTimeUnavailableTimeslotMessage}} </div> </div> <div configurable-product product=product config-type={{product.product_config.config_type}} update-config-total-price=totalConfigPrice.price location={{location}} location-value=locationValue></div> </div> <div product-points product=product></div> </div> </div> <div ng-if=\\\"(productAtStore && productOffers && productOffers.length) && !inOrderAddOnMode && config.showRelatedOffersOnPdp \\\"> <div class=offers-header> <h2> <div class=offer-tag></div> {{::lang.values.relatedOffers}} </h2> </div> <ul class=offers> <li offer-tile ng-repeat=\\\"productOffer in productOffers\\\" offer-data=productOffer offer-origin=product location=\\\"Product Details Offers\\\"></li> </ul> </div> <div ng-include src=\\\"'productDetailsTabs.html'\\\"></div> \";","module.exports = \"<div class=error-modal> <react-error-window error-title=\\\"title || lang.values.error\\\" body=message primary-button-content=okText secondary-button-content=cancelText on-click-primary-button=(handleClose) on-click-secondary-button=(handleDismiss) request-id=meta.requestId button-alignment=config.errorModal.buttonAlignment button-direction=config.errorModal.buttonDirection /> </div> \";","module.exports = \" <div ng-if=!isOneCartEnabled() id=item-remove-alert-{{item.id}}-{{$index}} tabindex=-1 ng-init=\\\"showDeleteConfirm = false\\\" ng-class=\\\"{shown: $parent.showDeleteConfirm}\\\" class=delete-confirm> <span class=label>{{::lang.values.wantToRemove}}</span> <button tabindex=\\\"{{ $parent.showDeleteConfirm ? '0' : '-1'}}\\\" ng-click=\\\"item.quantity = item.quantity || 1; $parent.showDeleteConfirm = false\\\" class=\\\"button smaller dark\\\" analytics-click=\\\"['side cart product delete confirmation cancel button', 'click']\\\"> {{::lang.values.cancel}} </button> <button tabindex=\\\"{{ $parent.showDeleteConfirm ? '0' : '-1'}}\\\" ng-click=\\\"$parent.showDeleteConfirm = false; removeItem(item, item.quantity, $index, true)\\\" class=\\\"button smaller highlight\\\" analytics-click=\\\"['side cart product delete confirmation remove button', 'click']\\\" data-test=remove-item-confirm-button> {{::lang.values.remove}} </button> </div> <div class=item ng-class=\\\"{disable: showDeleteConfirm}\\\"> <button ng-click=\\\"showDeleteConfirm = true\\\" class=\\\"button delete round\\\" ng-if=editMode aria-label={{::lang.aria.delete}}></button> <div class=completed ng-if=\\\"!editMode && auth.getContext().intent === 'instore' && mobile.isMobile\\\"> <input id=checkoff{{item.store_product.id}} class=checkbox ng-model=item.checked ng-change=$ctrl.checkItem(item) type=checkbox /> <label for=checkoff{{item.store_product.id}}></label> </div> <div role=button ng-click=goToProductDetailsModal(item) ng-style=\\\"!!item.product_config && { 'pointer-events': 'none' }\\\"> <div class=\\\"image internal-link\\\" ng-attr-style=\\\"background-image: url('{{imageURLService.getProductImageURL(item, 'small')}}')\\\" data-test=mini-cart-item-link></div> <div class=name ng-bind-html=cartService.getItemDescription(item)></div> </div> <div class=meta> <div data-test=cart-item-total class=total>{{item.subtotal | currency}}</div> <div class=configurable-values-container ng-if=item.product_config.options.length> <p class=configurable-values compile=\\\"configurableProductService.configsString(item, true)\\\"></p> </div> <div class=\\\"row prices-quantity\\\" ng-init=\\\"showProductComment = false\\\"> <div product-prices product=item.store_product unit-price=item.unit_price class=price show-ebt-label=isItemEbtEligible(item) sale-price-override=overrideSalePrice(item)></div> <div ng-if=\\\"isOneCartEnabled() && !isRxProduct(item)\\\" class=item-comment aria-label={{::lang.aria.itemNotes}} ng-show=\\\"item.comment.length && !showProductComment\\\"> {{item.comment}} </div> <div ng-class=\\\"{ 'product-util': isOneCartEnabled() }\\\" ng-show=!showProductComment> <button ng-if=::isOneCartEnabled() id=side-cart-show-delete-confirm-{{::sideCartReference}}-{{::$index}}-one-cart class=\\\"remove-one-cart icon-delete\\\" ng-click=\\\"removeItem(item, item.quantity, $index)\\\" data-test=remove-item-button analytics-click=\\\"['side cart product remove button', 'click']\\\" aria-label=\\\"{{:: lang.templateAsString( lang.aria.removeItemFromCart, { item:\\n                    item.store_product.name } ) }}\\\"> {{::lang.values.remove}} </button> <span class=offer-tag ng-if=\\\"cartService.itemHasOffer(item) && !overrideSalePrice(item)\\\" aria-hidden=true></span> <button ng-if=\\\"isOneCartEnabled() && !isRxProduct(item)\\\" id=side-cart-show-edit-item-{{::sideCartReference}}-{{::$index}} class=\\\"edit-item-one-cart icon-edit-list\\\" data-test=item-add-comment-button ng-click=\\\"$parent.showProductComment = true\\\" aria-label=\\\"{{::lang.templateAsString(lang.aria.addNoteTo, { item: item.store_product.name })}}\\\"> {{ item.comment.length ? lang.values.editNote : lang.values.addNote }} </button> <div ng-if=\\\"!isItemCurrentlyOutOfStock(item) && !isRxProduct(item)\\\" class=quantity> <div ng-if=isOneCartEnabled() modify-quantity item=item increment-fn=\\\"addItem(item, 1, $index)\\\" decrement-fn=\\\"removeItem(item, 1, $index)\\\" on-update=\\\"updateQuantity(item, $originalQuantity, $onZeroFn)\\\" on-zero-fn=\\\"removeItem(item, item.quantity, $index)\\\" include-zero=true analytics-name=\\\"side cart product\\\"></div> <div ng-if=!isOneCartEnabled() ng-class=\\\"{ 'right': !isOneCartEnabled() }\\\" modify-quantity item=item increment-fn=\\\"addItem(item, 1, $index)\\\" decrement-fn=\\\"item.quantity > 1 ? (removeItem(item, 1, $index)) : ($parent.$parent.showDeleteConfirm = true)\\\" on-update=\\\"updateQuantity(item, $originalQuantity, $onZeroFn)\\\" on-zero-fn=\\\"$parent.$parent.showDeleteConfirm = true\\\" include-zero=true analytics-name=\\\"side cart product\\\"></div> </div> </div> </div> <button ng-if=\\\"::!mobile.isMobile && !isOneCartEnabled()\\\" id=side-cart-show-delete-confirm-{{::sideCartReference}}-{{::$index}} class=remove ng-click=\\\"$parent.showDeleteConfirm = true; focusOnDeleteConfirmation(item, $index)\\\" data-test=remove-item-button> {{::lang.values.remove}} </button> <div ng-if=\\\"!isItemCurrentlyOutOfStock(item) && !isOneCartEnabled() && !isRxProduct(item)\\\" product-comments item=item product-comment-callback=updateItemComment(item)></div> <div ng-if=\\\"!isItemCurrentlyOutOfStock(item) && showProductComment && isOneCartEnabled() && !isRxProduct(item)\\\" product-comments-v2 item=item product-comment-callback=updateItemComment(item) product-show-comment=$parent.showProductComment></div> <div ng-if=isItemCurrentlyOutOfStock(item) class=out-of-stock-text-offset> <span class=out-of-stock-text uib-popover-html=outOfStockWarningPopover popover-trigger=\\\"mouseenter focus\\\" tabindex=0> {{::lang.values.outOfStock}} <i class=\\\"icon icon-info-i\\\" aria-hidden=true></i> </span> </div> </div> </div> \";","module.exports = \"<div class=confirmation ng-if=!isFromNewCheckout> <div class=\\\"page-header full-width no-breadcrumbs\\\"> <div class=background></div> </div> <div class=confirmation-wrapper> <progress-indicator segments=progressSegments current-segment=checkout-confirmation></progress-indicator> <h1 class=title> {{::lang.values.orderSubmitted}} <a ui-sref=\\\"{{::(mobile.isMobile ? 'main.shop.categories' : 'main.shop')}}\\\" class=\\\"button button-checkout icon-after-go right mobile-bottom mobile-fixed safe-area-bottom\\\" fixed-to-body id=checkout-confirmation-continue-shopping analytics-click=\\\"['checkout confirmation top continue button', 'click']\\\">{{::lang.values.continueShopping}}</a> </h1> <div class=content-wrapper> <div class=content> <div class=thank-you> <em>{{::lang.values.thankYouForShopping}}</em> <p ng-if=order.global_order_message ng-bind-html=\\\"order.global_order_message | linebreaks\\\"></p> <p ng-if=order.store_order_message ng-bind-html=\\\"order.store_order_message | linebreaks\\\"></p> </div> <h2 class=header>{{::lang.values.orderSummary}}</h2> <div class=details> <table> <tbody> <tr> <td class=address ng-class=\\\"{ 'icon-delivery': order.fulfillment_type == 'delivery', 'icon-pickup': order.fulfillment_type == 'pickup' }\\\"> <div ng-if=\\\"order.fulfillment_type == 'pickup'\\\"> <b>{{::lang.values.pickupAt}}</b> <div>{{order.store.name}}</div> <div>{{order.store.address.address1}}</div> <div>{{order.store.address.address2}}</div> <div>{{order.store.address.address3}}</div> <div>{{order.store.address.city}}, {{order.store.address.province}}</div> <div>{{order.store.address.postal_code}}</div> <div>{{::lang.values.phone}}: {{order.store.phone_number}}</div> </div> <div ng-if=\\\"order.fulfillment_type == 'delivery'\\\"> <b>{{::lang.values.deliveryAddress}}</b> <div>{{order.delivery_address.first_name}} {{order.delivery_address.last_name}}</div> <div>{{order.delivery_address.address1}}</div> <div>{{order.delivery_address.address2}}</div> <div>{{order.delivery_address.address3}}</div> <div><span ng-if=order.delivery_address.city>{{order.delivery_address.city}}, </span><span ng-if=order.delivery_address.province>{{order.delivery_address.province}}</span></div> <div>{{order.delivery_address.postal_code}}</div> <div ng-if=order.delivery_address[order.delivery_address.primary_number_key]>{{::lang.values.phone}}: {{order.delivery_address[order.delivery_address.primary_number_key]}}</div> </div> </td> <td class=date> <b ng-if=\\\"order.fulfillment_type == 'delivery'\\\">{{::lang.values.expectedDelivery}}</b> <b ng-if=\\\"order.fulfillment_type == 'pickup'\\\">{{::lang.values.pickupTime}}</b> <div>{{::timeslotLabelFn()}}</div> </td> <td class=link> <b>{{::lang.values.orderDetails}}</b> <div>{{::lang.template(lang.values.orderNumber, {orderId: order.id})}}</div> <a ui-sref=\\\"main.account.orderHistory.order({id: order.id})\\\" class=view-order id=checkout-confirmation-order-details analytics-click=\\\"['checkout confirmation order link', 'click']\\\">{{::lang.values.orderDetails}}</a> </td> </tr> </tbody> </table> </div> </div> <cart-totals css-class=totals cart-totals=order.estimated_totals show-fees=true is-order=true></cart-totals> </div> </div> </div> <div ng-if=isFromNewCheckout ng-include=\\\"'checkoutConfirmation.new.html'\\\"></div> <ic-express-post-checkout ng-if=\\\"postCheckoutPlacementEnabled && !isSubscribed\\\" user-subscription=userCurrentSubscription is-subscribing=isSubscribing delivery-fee=icExpressSavingAmount on-click=onClickIcExpress()></ic-express-post-checkout> \";","import angular from 'angular'\n\nexport default angular.module('unata.client.component.additional', [])\n","const sleep = (delay: number): Promise<undefined> =>\n  new Promise(resolve => setTimeout(resolve, delay))\n\nexport default sleep\n","import { auth as enterpriseAuthService } from '@instacart/enterprise-services'\nimport { captureException } from '@sentry/browser'\nimport sleep from './sleep'\n\nconst validFileTypes = ['script', 'style']\n\nexport const isValidFileType = ({ type }: { type: string }): boolean =>\n  validFileTypes.includes(type)\n\nexport const getLinkType = (path: string): string => {\n  const fragments = path.split('.')\n  const ending = fragments[fragments.length - 1]\n\n  if (ending === 'js') {\n    return 'script'\n  }\n\n  if (ending === 'css') {\n    return 'style'\n  }\n\n  return ''\n}\n\nexport const getFilesFromBundle = (bundle: string[]): { type: string; path: string }[] =>\n  Object.values(bundle)\n    .map(path => ({\n      path,\n      type: getLinkType(path),\n    }))\n    .filter(isValidFileType)\n\nasync function preloadCheckoutPage(): Promise<void> {\n  // Sleep is to allow the page to calm down before injecting all the asset bundle files\n  // This is because there isn't a good hook to use to determine when the app is in a calm state\n  await sleep(2000)\n\n  try {\n    const bundleFile = await enterpriseAuthService.api.auth.getOneCartCheckoutAppBundle()\n\n    const checkoutAssetFiles = getFilesFromBundle(bundleFile.assetPaths)\n\n    const fragment = document.createDocumentFragment()\n\n    checkoutAssetFiles.forEach(({ path, type }) => {\n      const link = document.createElement('link')\n      link.rel = 'preload'\n      link.href = path\n      link.as = type\n\n      fragment.appendChild(link)\n    })\n\n    document.head.appendChild(fragment)\n  } catch (e) {\n    captureException(e)\n  }\n}\n\nexport default preloadCheckoutPage\n","/*\nPurpose of this function is to add support for specific cookies which are critical for partners due to 3rd party integration\nThe way how this works is it allows persisting cookies in localStorage when cookies are not supported\nThis is an issue on iOS Capacitor, when you serve files from localhost (in-app browser works just fine) https://github.com/ionic-team/capacitor/issues/1373\nPlease make sure to check TODO comments, there is a lot to do still if we need full cookies support. On Nov 18, 21 we only focus on addressing Adobe Target issues for Wegmans\nNote, that we hope to migrate to live WebView in near future and because of that we hope we don't need to maintain this for long\n*/\nimport isCapacitor from '@app/utils/isCapacitor'\nimport isMobile from 'ismobilejs'\n\n// Leave empty to keep all cookies, note that this was not tested and will likely not work out of the box for you. Keep in mind comment about domain check below\nexport const whitelistedCookies = [\n  'at_check',\n  'mbox',\n  's_vi',\n  's_cc',\n  's_ips',\n  's_loginSuccess',\n  's_ppv',\n  's_tp',\n  's_sq',\n  'AMCVS_68B620B35350F1650A490D45%40AdobeOrg',\n  'AMCV_68B620B35350F1650A490D45%40AdobeOrg',\n]\n\nexport function fixCapacitorCookies() {\n  if (!isCapacitor() || !isMobile.apple.device) {\n    return\n  }\n\n  /* TODO:\n   - note, if any changes to the structure are done, consider if you want to copy cookies from existing storage to migrate them\n   - need to handle session expiration\n   - path match\n   - session cookies -> sessionStorage? likely no because reading, & sync becomes harder\n    - Maybe some identifier can be stored in sessionStorage and if it is gone, all keys prefixed with the value should be removed\n    */\n  const testCookie = 'some_random__and__unique_cookie=1'\n  document.cookie = testCookie\n  const cookieSeparator = '; '\n  // TODO provide a way to clear all cookies so state is all in sync, as currently due to memory optimizations you need to clear storage, then refresh the page\n  const isCookieSupported = !!document.cookie.split(cookieSeparator).find(x => x === testCookie)\n  if (isCookieSupported) {\n    document.cookie = `${testCookie}=; expires=Fri, 27 Jul 2001 02:47:11 UTC`\n    printWarning('cookies are now supported, this code may be not necessary anymore')\n  } else {\n    printWarning('cookies are not supported, creating a fallback for Adobe Target')\n    const storageKey = '_local-cookies_'\n    const memoryStorage = JSON.parse(localStorage.getItem(storageKey) || '{}')\n    // reduce number of times we need to produce a document.cookie string\n    let isStale = true\n    let cache = ''\n\n    Object.defineProperty(document, 'cookie', {\n      get() {\n        if (isStale) {\n          cache = Object.entries(memoryStorage)\n            .map(([key, value]) => `${key}=${value}`)\n            .join(cookieSeparator)\n          isStale = false\n        }\n        return cache\n      },\n      set(x) {\n        const parts = `${x}`.split(cookieSeparator)\n        // const domain = parts.find(x => x.startsWith('domain='))\n        const entry = parts[0]\n        const [key, value] = entry.split('=')\n\n        if (\n          typeof x !== 'string' ||\n          // TODO some domains are restricted and should not support setting on root level (ex: glitch.me, github.io, ...)\n          //  also instead of direct domain check we may check for top level?\n          // for now commented out since we limited check to whitelisted cookies\n          // (domain && domain !== `domain=${location.hostname}`) ||\n          !key ||\n          (whitelistedCookies.length && !whitelistedCookies.includes(key))\n        ) {\n          return 'not=successful'\n        }\n\n        if (value === '') {\n          delete memoryStorage[key]\n        } else {\n          memoryStorage[key] = value\n        }\n        isStale = true\n        localStorage.setItem(storageKey, JSON.stringify(memoryStorage))\n        return entry\n      },\n    })\n  }\n\n  function printWarning(msg: string) {\n    if (typeof jest === 'undefined') {\n      console.warn(msg)\n    }\n  }\n}\n","export const HTTP_ERRORS = {\n  // API return status (non-preferable)\n  UNAUTHORIZED: 401,\n  FORBIDDEN: 403,\n  NOT_FOUND: 404,\n  TOO_MANY_REQUESTS: 429,\n  SERVICE_UNAVAILABLE: 503,\n\n  // Error codes (preferable)\n  SESSION_EXPIRED_ERROR: 40102,\n  REFRESH_TOKEN_ERROR: 40103,\n  CONNECT_ERROR: 40300, // This error code is unfortunately used for multiple Connect errors <_<\n  EXT_FULFILLMENT_PROVIDER_ERROR: 40301,\n  PII_UNAUTHORIZED: 40304,\n  EXTERNAL_AUTH_ERROR: 40306,\n  ALCOHOL_FULFILLMENT_ERROR: 40307,\n  TIMESLOT_EXPIRATION_ERROR: 40308,\n  MISSING_CART: 40402, // Can occur if user was logged out\n}\n","import angular from 'angular'\nimport { isReactRoute } from '@app/react/routes'\nimport { HTTP_ERRORS } from '../../constants/httpErrors'\n\nexport default angular\n  .module('ErrorPage', [])\n  .config($stateProvider => {\n    const ERROR_CODES = [\n      HTTP_ERRORS.NOT_FOUND,\n      HTTP_ERRORS.FORBIDDEN,\n      HTTP_ERRORS.SERVICE_UNAVAILABLE,\n    ]\n    ERROR_CODES.forEach(val => {\n      $stateProvider.state(`main.${val}`, {\n        url: `/${val}`,\n        views: {\n          'content@': {\n            template: require('./errorPage.html'),\n            controller($location, $state, config, lang, mobileService, utilService) {\n              // TODO: Remove this logic after CUS cutover is complete\n              if (config.env.shortCode === 'cus') {\n                const cus_pbi_endpoints_regex = /^\\/store\\/(orders.*|account.*|items.*|costco.*)/\n                if (cus_pbi_endpoints_regex.test($location.$$url)) {\n                  $state.go('main.home')\n                }\n              }\n\n              this.image = mobileService.isMobile\n                ? ''\n                : utilService.loadAssetImage(`images/${val}.png`)\n              this.title = lang.values[`http${val}Title`]\n              this.message = lang.values[`http${val}Message`]\n              // $state.href will prepend the `#` if html5 mode is not enabled.\n              this.buttonUrl =\n                config.errorPages.buttonHref || $state.href(...config.errorPages.buttonSref)\n              this.buttonText = config.errorPages.buttonText\n\n              // Render an empty view when on a react route because we don't want an error page rendered in angular when the app is on a valid react route. Also avoids seeing the error page when navigating from react to angular route.\n              this.isReactRoute = isReactRoute($location.path())\n            },\n            controllerAs: '$ctrl',\n          },\n        },\n      })\n    })\n  })\n\n  // TODO: Create and use a React Component.\n  .component('errorPageComponent', {\n    bindings: {\n      buttonText: '<',\n      buttonUrl: '<',\n      image: '<',\n      message: '<',\n      title: '<',\n    },\n    template: `\n      <img ng-if=\"::$ctrl.image\" ng-src=\"{{::$ctrl.image}}\" alt=\"{{::$ctrl.title}}\" />\n      <h1>{{::$ctrl.title}}</h1>\n      <p>{{::$ctrl.message}}</p>\n      <div class=\"unata-button-container\" >\n        <a class=\"button\" ng-href=\"{{::$ctrl.buttonUrl}}\" >{{::$ctrl.buttonText}}</a>\n      </div>\n    `,\n  })\n\n  .run(($rootScope, $state, analytics) => {\n    $rootScope.$on(\n      '$stateChangeError',\n      (event, toState, toParams, fromState, fromParams, error = {}) => {\n        const errorData = error.data || error\n        if (error.status === HTTP_ERRORS.NOT_FOUND) {\n          analytics.logEvent('not found', 'backend error', '404')\n          $state.go('main.404')\n        }\n        // Service Unavailable, do not change the location in the url so refreshing is easy.\n        else if (error.status === HTTP_ERRORS.SERVICE_UNAVAILABLE) {\n          analytics.logEvent('not found', 'backend error', '503')\n          $state.go('main.503', {}, { location: false })\n        }\n        // Do not intercept the PII errors, do not change the location in the url so refreshing is easy.\n        else if (\n          error.status === HTTP_ERRORS.FORBIDDEN &&\n          errorData.error !== HTTP_ERRORS.PII_UNAUTHORIZED\n        ) {\n          analytics.logEvent('not found', 'backend error', '403')\n          $state.go('main.403', {}, { location: false })\n        }\n      }\n    )\n  })\n","import angular from 'angular'\nimport ErrorPages from './errorPages.js'\n\nexport default angular.module('app.component.errorPagesModule', [ErrorPages.name])\n","import angular from 'angular'\n\nexport default angular\n  .module('AddressBookComponentModule', [])\n\n  .config(($stateProvider, langProvider) => {\n    $stateProvider.state('main.account.addressBook', {\n      url: '/delivery-address',\n      views: {\n        'content@main.account': {\n          template: require('./addressBook.html'),\n          controller: 'AddressBookController',\n        },\n      },\n      resolve: {\n        loadCtrl: $ocLazyLoad => {\n          return import(\n            /* webpackChunkName: \"addressBookController\", webpackPrefetch: true */ './addressBookController'\n          )\n            .then(mod => $ocLazyLoad.load(mod.default))\n            .catch(err => {\n              throw new Error(`Ooops, something went wrong, ${err}`)\n            })\n        },\n        title(titleService) {\n          return titleService.setTitle(langProvider.values.addressBookTitle)\n        },\n      },\n      data: {\n        breadcrumbs: [\n          {\n            label: langProvider.values.accountDetails,\n          },\n          {\n            label: langProvider.values.addressBookTitle,\n          },\n        ],\n        section: 'addressBook',\n      },\n    })\n  })\n","import angular from 'angular'\nimport { user } from '@instacart/enterprise-services'\n\nexport default angular\n  .module('CreditComponentModule', [])\n  .config(($stateProvider, langProvider) => {\n    $stateProvider.state('main.account.credits', {\n      url: '/credits',\n      views: {\n        'content@main.account': {\n          template: require('./credits.html'),\n          controller: 'CreditsController',\n          resolve: {\n            credits() {\n              return user.api.credits.getAll().then(response => response?.items)\n            },\n          },\n        },\n      },\n      resolve: {\n        loadCtrl: $ocLazyLoad => {\n          return import(\n            /* webpackChunkName: \"creditsController\", webpackPrefetch: true */ './creditsController'\n          )\n            .then(mod => $ocLazyLoad.load(mod.default))\n            .catch(err => {\n              throw new Error(`Ooops, something went wrong, ${err}`)\n            })\n        },\n        title(titleService) {\n          return titleService.setTitle(langProvider.values.availableCredits)\n        },\n      },\n      data: {\n        breadcrumbs: [\n          {\n            label: langProvider.values.accountDetails,\n          },\n          {\n            label: langProvider.values.availableCredits,\n          },\n        ],\n      },\n    })\n  })\n","import angular from 'angular'\n\nexport default angular.module('ListsComponentModule', []).config(($stateProvider, langProvider) => {\n  $stateProvider\n    .state('lists', {\n      parent: 'main.account',\n      url: '/lists',\n      views: {\n        'content@main.account': {\n          template: require('./lists.html'),\n          controller: 'ListsController',\n        },\n      },\n      resolve: {\n        loadCtrl: $ocLazyLoad => {\n          return import(\n            /* webpackChunkName: \"listsController\", webpackPrefetch: true */ './listsController'\n          )\n            .then(mod => $ocLazyLoad.load(mod.default))\n            .catch(err => {\n              throw new Error(`Ooops, something went wrong, ${err}`)\n            })\n        },\n        title(titleService) {\n          return titleService.setTitle(langProvider.values.saveForLaterLists)\n        },\n      },\n      data: {\n        breadcrumbs: [\n          {\n            label: langProvider.values.accountDetails,\n          },\n          {\n            label: langProvider.values.saveForLaterLists,\n          },\n        ],\n      },\n    })\n\n    .state('list', {\n      parent: 'lists',\n      url: '/:list_id',\n      views: {\n        'content@main.account': {\n          template: require('./list.html'),\n          controller: 'ListController',\n        },\n      },\n      resolve: {\n        loadCtrl: $ocLazyLoad => {\n          return import(\n            /* webpackChunkName: \"listController\", webpackPrefetch: true */ './listController'\n          )\n            .then(mod => $ocLazyLoad.load(mod.default))\n            .catch(err => {\n              throw new Error(`Ooops, something went wrong, ${err}`)\n            })\n        },\n        listDetails(list, $stateParams) {\n          return list\n            .getList($stateParams.list_id, false)\n            .then(response => angular.copy(response.payload))\n            .catch(_ => {\n              // Getting the list details involves an HTTP request whose errors are caught by\n              // Restangular.setErrorInterceptor(...), which shows an error modal. And, if we return\n              // a rejected promise with a payload containing a `500 - Internal Server Error` error,\n              // the $stateChangeError listener in auth.js will also show an error modal.\n              //\n              // To work around this, we ignore the error from getList and return a custom error\n              // instead.\n              //\n              // ENT-35746\n              throw new Error(\n                `Unexpected error retrieving list details for list ${$stateParams.list_id}`\n              )\n            })\n        },\n        title(titleService) {\n          return titleService.setTitle(langProvider.values.saveForLaterListDetails)\n        },\n      },\n      data: {\n        breadcrumbs: [\n          {\n            label: langProvider.values.accountDetails,\n          },\n          {\n            state: 'lists',\n            label: langProvider.values.saveForLaterLists,\n          },\n          {\n            label: langProvider.values.saveForLaterListDetails,\n          },\n        ],\n      },\n    })\n})\n","import angular from 'angular'\n\nexport default angular\n  .module('LoyaltyComponentModule', [])\n\n  .config(($stateProvider, configConstants, langProvider) => {\n    $stateProvider.state('main.account.loyalty', {\n      // The ?enterPromoCode is here to handle opening the PromoCode modal.\n      url: `${configConstants.loyaltyVanityUrl || '/loyalty'}?enterPromoCode`,\n      views: {\n        'content@main.account': {\n          // The controller is included in the template\n          template: require('./loyalty.html'),\n          controllerAs: '$ctrl',\n          controller(loyaltyOptIn) {\n            // onEnter doesn't re-trigger on state reload.\n            this.loyaltyOptIn = loyaltyOptIn\n          },\n        },\n      },\n      resolve: {\n        loadCtrl: $ocLazyLoad => {\n          return import(\n            /* webpackChunkName: \"loyaltyController\", webpackPrefetch: true */ './loyaltyController'\n          )\n            .then(mod => $ocLazyLoad.load(mod.default))\n            .catch(err => {\n              throw new Error(`Ooops, something went wrong, ${err}`)\n            })\n        },\n        loyaltyOptIn(config, userService) {\n          return (\n            config.loyalty.enableLoyaltyOptIn.loyaltyPage &&\n            userService.fetchLoyaltyCards().then(() => userService.loyaltyCards.length === 0)\n          )\n        },\n        title(titleService) {\n          return titleService.setTitle(langProvider.values.loyaltyCard)\n        },\n      },\n      data: {\n        breadcrumbs: [\n          {\n            label: langProvider.values.accountDetails,\n          },\n          {\n            label: langProvider.values.loyaltyCard,\n          },\n        ],\n        section: 'loyalty',\n      },\n    })\n  })\n","export enum AUTH_ACTIONS {\n  CHANGE_PASSWORD = 'changePassword',\n  LOGIN = 'login',\n  LOGOUT = 'logout',\n  LOYALTY = 'loyalty',\n}\n","import _ from 'lodash'\nimport angular from 'angular'\nimport { AUTH_ACTIONS } from '@app/angular/constants/authActions'\n\nexport default angular\n  .module('AccountNavMenuServiceModule', [])\n  .service(\n    'accountMenuService',\n    function accountMenuService(\n      $injector,\n      auth,\n      config,\n      eComLightService,\n      lang,\n      mobileService,\n      oneCartService,\n      policyService,\n      userService,\n      utilService\n    ) {\n      const service = this\n\n      // eslint-disable-next-line complexity\n      service.getAccountMenuItems = () => {\n        let menu = [\n          {\n            sref: 'main.account.profile',\n            label: lang.values.profile,\n          },\n        ]\n\n        // Added externalProfileURL to for CRM integrations where Unata will not allow profile details updates.\n        // This will take the customers to the external page where the updates can be made.\n        if (config.externalProfileURL) {\n          menu = [\n            {\n              extLink: config.externalProfileURL,\n              label: lang.values.profile,\n            },\n          ]\n        }\n\n        // Add external password change link for clients where we don't support password change in our application.\n        // Makes a check for special cases if the retailer is using Gigya IDP. If enabled, use Gigya Screen-set\n        // If disabled, use `main.account.passwordChange`\n\n        if (!config.disableChangePassword) {\n          if (config.gigya && config.gigya.enabled) {\n            menu = menu.concat([\n              {\n                extLink: 'gigya',\n                label: lang.values.passwordChange,\n              },\n            ])\n          } else if (config.externalPasswordChangeURL) {\n            menu = menu.concat([\n              {\n                extLink: config.externalPasswordChangeURL,\n                label: lang.values.passwordChange,\n              },\n            ])\n          } else if (config.auth?.serviceName) {\n            // Use the change password flow of the custom auth service\n            const authService = auth.getAuthService()\n            menu = menu.concat([\n              {\n                onClick: () => authService.init(AUTH_ACTIONS.CHANGE_PASSWORD),\n                label: lang.values.passwordChange,\n              },\n            ])\n          } else {\n            menu = menu.concat([\n              {\n                sref: 'main.account.passwordChange',\n                label: lang.values.passwordChange,\n              },\n            ])\n          }\n        }\n\n        // Don't insert address book link if disabled\n        if (\n          !config.accountMenuOptions.disableAddressBook &&\n          config.enableMultipleDeliveryAddresses\n        ) {\n          menu.push({\n            sref: 'main.account.addressBook',\n            label: lang.values.addressBookTitle,\n          })\n        }\n\n        // Don't insert notification preferences link if disabled\n        if (!config.disableNotificationPreferences) {\n          menu = menu.concat([\n            {\n              sref: 'main.account.notifications',\n              label: lang.values.notificationPreferences,\n            },\n          ])\n        }\n\n        // TODO: These should be made configurable\n\n        if (!config.accountMenuOptions.disableOrderHistory) {\n          menu = menu.concat([\n            {\n              sref: 'main.account.orderHistory',\n              label: lang.values.orderHistory,\n            },\n          ])\n        }\n\n        if (config.icExpress.enabled) {\n          menu.push({\n            sref: 'main.account.icExpress',\n            label: config.icExpress.name,\n            ngIf: () => auth.user.ic_linked,\n          })\n        }\n\n        if (!config.accountMenuOptions.disableSubstitutions && !eComLightService.inEComLightMode) {\n          menu = menu.concat([\n            {\n              sref: 'main.account.substitutions',\n              label: lang.values.substitutionPreferences,\n            },\n          ])\n        }\n\n        if (\n          !(config.accountMenuOptions.disableSaveForLaterLists || config.disableSaveForLaterLists)\n        ) {\n          menu = menu.concat([\n            {\n              sref: 'lists',\n              label: lang.values.saveForLaterLists,\n            },\n          ])\n        }\n\n        // Insert saved recipes link\n\n        if (config.enableSavedRecipes && !config.disableRecipes) {\n          menu = menu.concat([\n            {\n              sref: 'main.shop.recipes.saved',\n              label: lang.values.savedRecipes.savedRecipes,\n            },\n          ])\n        }\n\n        if (!config.accountMenuOptions.disableAvailableCredits) {\n          menu = menu.concat([\n            {\n              sref: 'main.account.credits',\n              label: lang.values.availableCredits,\n            },\n          ])\n        }\n\n        // Insert if in price alerts are not disabled\n\n        if (\n          !config.disablePriceAlerts &&\n          !(config.disabledMobileAccountMenu.priceAlerts && mobileService.isMobile)\n        ) {\n          menu = menu.concat([\n            {\n              sref: 'main.account.priceAlerts',\n              label: lang.values.priceAlerts,\n            },\n          ])\n        }\n\n        if (\n          oneCartService.enabled() &&\n          config.ebt?.enabled &&\n          auth.user.store?.ebt_enabled_in_state\n        ) {\n          menu = menu.concat([\n            {\n              sref: 'main.account.snapEBT',\n              label: lang.values.ebt.EBTSNAP,\n            },\n          ])\n        }\n\n        // Insert loyalty item if needed\n\n        // console.log('Config - has loyalty: ', config.hasLoyalty)\n        // console.log('Config - !disable loyalty links: ', !config.disableLoyaltyLinks)\n        // console.log('1: ', (config.customerLoyaltyOverride && userService.loyaltyCards.length))\n\n        if (\n          config.hasLoyalty &&\n          !config.disableLoyaltyLinks &&\n          ((config.customerLoyaltyOverride && userService.loyaltyCards.length) || // 1\n            ((!config.disableLoyaltyWhenAccountless || userService.loyaltyCards.length) &&\n              (!config.disableLoyaltyWhenEmployeeIdless ||\n                (auth.user.ext_data && auth.user.ext_data.employee_id)))) &&\n          !(config.disabledMobileAccountMenu.loyaltyCard && mobileService.isMobile)\n        ) {\n          menu.splice(1, 0, {\n            sref: 'main.account.loyalty',\n            label: lang.values.loyaltyCard,\n          })\n        }\n\n        // Insert subscription item if needed\n\n        if (\n          config.hasSubscriptions &&\n          !(config.disabledMobileAccountMenu.subscription && mobileService.isMobile)\n        ) {\n          menu.splice(6, 0, {\n            sref: 'main.account.subscription',\n            label: lang.values.subscription,\n          })\n        }\n\n        // Insert rate products item if needed\n\n        if (\n          !config.disableRateProducts &&\n          !(config.disabledMobileAccountMenu.rateProducts && mobileService.isMobile)\n        ) {\n          menu.push({\n            sref: 'main.account.rateProducts',\n            label: lang.values.rateProducts,\n          })\n        }\n\n        // Insert pricing policy if needed\n        if (\n          config.policyModal.showPricingPolicyInHeader &&\n          config.policyModal.isPricingPolicyEnabled\n        ) {\n          menu.push({\n            onClick: () => policyService.open('pricing'),\n            label: lang.values.viewPricingPolicy,\n          })\n        }\n\n        // Insert any custom links\n\n        if (config.accountMenu && config.accountMenu.length) {\n          // eslint-disable-next-line no-plusplus\n          for (let ii = 0; ii < config.accountMenu.length; ii++) {\n            menu.splice(\n              config.accountMenu[ii].position || config.accountMenu[ii].index,\n              0,\n              config.accountMenu[ii]\n            )\n          }\n        }\n\n        // Add `id` tag labels to account menu links that have an `sref`\n        menu = _.map(menu, utilService.generateAddIdToSrefLinkWithPrefix('account-menu'))\n\n        return menu\n      }\n\n      return service\n    }\n  )\n","import angular from 'angular'\nimport AccountMenuServiceModule from './accountMenuService'\n\nexport default angular\n  .module('AccountNavComponentModule', [AccountMenuServiceModule.name])\n  .config($stateProvider => {\n    $stateProvider.state('main.account', {\n      url: '/account',\n      abstract: false,\n      data: {\n        requireRegistered: true,\n      },\n      views: {\n        'content@': {\n          template: require('./accountNav.html'),\n          controller: 'AccountNavController',\n        },\n      },\n      resolve: {\n        loadCtrl: utilService => {\n          return utilService.lazyLoadControllers({\n            AccountNavController: () =>\n              import(\n                /* webpackChunkName: \"accountNavController\", webpackPrefetch: true */ './accountNavController'\n              ),\n          })\n        },\n      },\n    })\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('NotificationComponentModule', [])\n  .config(($stateProvider, langProvider) => {\n    $stateProvider.state('main.account.notifications', {\n      url: '/notifications',\n      views: {\n        'content@main.account': {\n          template: require('./notifications.html'),\n          controller: 'NotificationsController',\n        },\n      },\n      resolve: {\n        loadCtrl: $ocLazyLoad => {\n          return import(\n            /* webpackChunkName: \"notificationsController\", webpackPrefetch: true */ './notificationsController'\n          )\n            .then(mod => $ocLazyLoad.load(mod.default))\n            .catch(err => {\n              throw new Error(`Ooops, something went wrong, ${err}`)\n            })\n        },\n        title(titleService) {\n          return titleService.setTitle(langProvider.values.notificationPreferences)\n        },\n      },\n      data: {\n        breadcrumbs: [\n          {\n            label: langProvider.values.accountDetails,\n          },\n          {\n            label: langProvider.values.notificationPreferences,\n          },\n        ],\n      },\n    })\n  })\n","export const POWERED_BY = {\n  LOGO: 'images/ic-express/instacart-logo-30px.png',\n  CSS_CLASS: 'ic-express',\n}\n","export const ORDER_STATUS = {\n  NEW: 'new',\n  SHIPPED: 'shipped',\n  CANCELLED: 'cancelled',\n}\n\nexport const ORDER_TYPES = {\n  ONLINE: 'order',\n  INSTORE: 'purchase',\n}\n","export const CART_TYPES = {\n  GROCERY: 'grocery',\n  CATERING: 'catering',\n  ALCOHOL: 'alcohol',\n}\n","export const PAYMENT_TYPES = {\n  CASH: 'cash',\n  CREDIT: 'credit',\n  DEBIT: 'debit',\n  HOUSE_ACCOUNT: 'house_account',\n  PAYPAL: 'paypal',\n  AUTH_CAPTURE: 'auth_capture',\n  EXTERNAL_AUTH: 'external_auth',\n}\n\nexport const AUTH_TYPES = {\n  CAPTURE: 'auth_capture',\n  EXTERNAL: 'external_auth',\n}\n\nexport const SOURCES = {\n  UNATA: 'unata',\n  INSTACART: 'instacart',\n}\n\nexport const PAYMENT_POLYTYPES = {\n  CREDIT_CARD: 'creditcard',\n}\n\nexport const PAYMENT_CONTEXTS = {\n  CHECKOUT: 'checkout',\n  EXPRESS: 'express',\n}\n\nexport const PAYMENT_PROVIDERS = {\n  STRIPE: 'Stripe',\n  VANTIV: 'Vantiv',\n  WEGPAY: 'Wegpay',\n  FIRST_DATA: 'FirstDataV2',\n  AUTHORIZE: 'Authorize',\n  BRAINTREE: 'Braintree',\n}\n","/* eslint-disable max-lines */\n\nimport _ from 'lodash'\nimport angular from 'angular'\nimport { POWERED_BY } from '@app/angular/constants/instacart'\nimport {\n  auth as authService,\n  order as enterpriseServiceOrder,\n  product as enterpriseProductService,\n} from '@instacart/enterprise-services'\nimport { utils as timeslotUtils } from '@instacart/enterprise-timeslots'\nimport { CHECKOUT_STEP_IDS, FULFILLMENT_TYPES } from '@app/angular/constants/checkout'\nimport { ORDER_STATUS } from '@app/angular/constants/orders'\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\nimport { CART_TYPES } from '@app/angular/constants/cart.js'\nimport { AUTH_TYPES, PAYMENT_TYPES } from '@app/angular/constants/payments'\nimport { HTTP_ERRORS } from '@app/angular/constants/httpErrors'\nimport { OneCartActions } from '@app/services/oneCart/types'\nimport cancelOrderModalTemplate from './views/cancelOrderModal.html'\n\nconst isNewFirstData = paymentGateway => paymentGateway.getByName('FirstDataV2')\n\nexport default angular\n  .module('OrderControllerModule', [])\n  .controller(\n    'OrderController',\n    function (\n      $filter,\n      $q,\n      $rootScope,\n      $sce,\n      $scope,\n      $state,\n      $stateParams,\n      $timeout,\n      $uibModal,\n      auth,\n      cartService,\n      catalogCategoriesService,\n      checkoutService,\n      config,\n      configurableProductService,\n      eComLightService,\n      errorModalService,\n      imageURLService,\n      instacartService,\n      lang,\n      list,\n      mobileService,\n      oneCartService,\n      order,\n      orderFeesService,\n      orderService,\n      payment,\n      paymentGateway,\n      productDetailsModal,\n      registrationService,\n      setPageHeaderTitle,\n      utilService\n    ) {\n      const { message, error } = $stateParams\n\n      Object.assign($scope, {\n        $rootScope,\n        CHECKOUT_STEP_IDS,\n        ORDER_STATUS,\n        SHOPPING_MODES,\n        CART_TYPES,\n        catalogCategoriesService,\n        configurableProductService,\n        error,\n        imageURLService,\n        instacartService,\n        lang,\n        message,\n        mobileService,\n        oneCartService,\n        order,\n        payment,\n        productDetailsModal,\n        utilService,\n        shoppingIntent: auth.getContext().intent,\n        selectedItems: [],\n        selectedMap: {},\n        isOrderAddedToCart: { top: false, bottom: false },\n        orderTotalsLines: [],\n      })\n\n      // order.items is a list of a single order object containing ic_order_redirect_id.\n      if (oneCartService.enabled() && order.items && order.items.length > 0) {\n        $rootScope.isAppLoading = true\n        const currentOrder = order.items[0]\n        authService.api.auth\n          .getOneCartOrderRedirect(currentOrder.ic_order_redirect_id)\n          .then(resp => {\n            oneCartService.redirectToPBI(resp.location, resp.auth_token, {\n              action: OneCartActions.ORDER_STATUS,\n              orderId: currentOrder.ic_order_id,\n            })\n          })\n          .catch(() => ($rootScope.isAppLoading = false))\n        return\n      }\n\n      if (config.orderHistoryView.showOrderTracker && !mobileService.isMobile) {\n        setPageHeaderTitle(`${lang.values.order} ${order.id}`)\n      }\n\n      const getRewardDiscounts = source =>\n        Object.keys(source?.reward_discounts || []).map(rewardKey => ({\n          label: lang.values.rewards?.[rewardKey]?.label || rewardKey,\n          value: -Math.abs(parseFloat(source.reward_discounts?.[rewardKey])),\n        }))\n\n      $scope.selectAllCheckbox = {\n        value: false,\n      }\n\n      $scope.outOfStockWarningPopover = $sce.trustAsHtml(\n        `<span class=\"icon-warning add-to-cart__warning\" aria-hidden=\"true\"></span> ${lang.values.outOfStockDescription}`\n      )\n\n      $scope.isItemOOS = item =>\n        !enterpriseProductService.utils.isProductAvailable(item.store_product)\n\n      $scope.estimatedRewards = getRewardDiscounts(order.estimated_totals)\n\n      $scope.getFeeLabel = fee => {\n        return orderService.fulfillmentLabel(fee, order.fulfillment_type)\n      }\n\n      // lineNumber was deprecated in favor of line_number for API key naming consistency.\n      // This check can be removed once endpoints return line_number.\n      $scope.getItemLineNumber = item => item.line_number || item.lineNumber\n\n      _.each($scope.order.order_items, item => {\n        $scope.selectedMap[`${item.store_product.id}-${$scope.getItemLineNumber(item)}`] = false\n      })\n      _.each($scope.order.additional_order_items, item => {\n        $scope.selectedMap[`${item.store_product.id}-${$scope.getItemLineNumber(item)}`] = false\n      })\n\n      const addReorderableTag = items =>\n        _.map(items, item => {\n          const isReorderable =\n            _.isNil(item.product_config) ||\n            _.isNil(item.store_product.product_config) ||\n            _.isNil(item.store_product.product_config.status) ||\n            item.store_product.product_config.status\n          return { ...item, isReorderable }\n        })\n\n      $scope.order.order_items = addReorderableTag($scope.order.order_items)\n      $scope.order.additional_order_items = addReorderableTag($scope.order.additional_order_items)\n\n      $scope.isNewFirstData = () => isNewFirstData(paymentGateway)\n\n      $scope.selectItem = function (item) {\n        const itemIndex = _.findIndex($scope.selectedItems, selectedItemsItem => {\n          if (item.product_config && selectedItemsItem.product_config) {\n            return configurableProductService.isConfigEqual(\n              selectedItemsItem.product_config.options,\n              item.product_config.options\n            )\n          }\n          return selectedItemsItem.store_product.id === item.store_product.id\n        })\n\n        if (itemIndex !== -1 && item.status !== 'add_on') {\n          $scope.selectedItems.splice(itemIndex, 1)\n          $scope.selectAllCheckbox.value = false\n        } else {\n          $scope.selectedItems.push(item)\n        }\n      }\n\n      $scope.selectAll = function () {\n        if ($scope.selectAllCheckbox.value) {\n          _.each($scope.order.order_items, item => {\n            const itemIndex = _.findIndex($scope.selectedItems, selectedItemsItem => {\n              if (item.product_config && selectedItemsItem.product_config) {\n                return configurableProductService.isConfigEqual(\n                  item.product_config.options,\n                  selectedItemsItem.product_config.options\n                )\n              }\n              // eslint-disable-next-line eqeqeq\n              return selectedItemsItem.store_product.id == item.store_product.id\n            })\n\n            if (\n              itemIndex === -1 &&\n              item.store_product.status &&\n              item.isReorderable &&\n              !$scope.isItemOOS(item)\n            ) {\n              $scope.selectedItems.push(item)\n              $scope.selectedMap[\n                `${item.store_product.id}-${$scope.getItemLineNumber(item)}`\n              ] = true\n            }\n          })\n\n          _.each($scope.order.additional_order_items, item => {\n            const itemIndex = _.findIndex($scope.selectedItems, selectedItemsItem => {\n              // eslint-disable-next-line eqeqeq\n              return selectedItemsItem.store_product.id == item.store_product.id\n            })\n\n            if (\n              itemIndex === -1 &&\n              item.store_product.status &&\n              item.isReorderable &&\n              !$scope.isItemOOS(item)\n            ) {\n              $scope.selectedItems.push(item)\n              $scope.selectedMap[\n                `${item.store_product.id}-${$scope.getItemLineNumber(item)}`\n              ] = true\n            }\n          })\n        } else {\n          $scope.selectedItems.length = 0\n          _.each($scope.order.order_items, item => {\n            $scope.selectedMap[`${item.store_product.id}-${$scope.getItemLineNumber(item)}`] = false\n          })\n          _.each($scope.order.additional_order_items, item => {\n            $scope.selectedMap[`${item.store_product.id}-${$scope.getItemLineNumber(item)}`] = false\n          })\n        }\n      }\n\n      $scope.selectAllCheckbox.value = true\n      $scope.selectAll() // Select all items by default\n\n      const deselectAll = () => {\n        $scope.selectAllCheckbox.value = false\n        $scope.selectAll()\n      }\n\n      $scope.loadList = (selectedItems, location = 'top') => {\n        $scope.isOrderAddedToCart = {\n          top: false,\n          bottom: false,\n        }\n        list.loadListToCart(selectedItems).then(() => {\n          $scope.isOrderAddedToCart[location] = true\n          deselectAll()\n        })\n      }\n\n      $scope.loadAll = function () {\n        list.loadListToCart($scope.order.order_items)\n      }\n\n      $scope.tip = () => instacartService.goToInstacartLink(order.ext_data.instacart_order_url)\n\n      $scope.modifyOrder = function () {\n        const unavailableItems = $scope.order.order_items.filter(item => {\n          return !item.store_product.status\n        })\n        const formatString = items => {\n          return items.map(item => item.store_product.name).toString()\n        }\n        const goToOrderModFlow = () =>\n          config.orderHistoryView.useItemEditFlow\n            ? // Using edit items flow\n              $state.go('main.account.orderHistory.order.edit', { id: $scope.order.id })\n            : // Classical modify\n              cartService.modifyOrder($scope.order)\n\n        if (unavailableItems.length > 0) {\n          errorModalService\n            .open(\n              `${lang.values.orderModItemsUnavailableWarning} ${formatString(unavailableItems)}`,\n              lang.values.continue,\n              lang.values.cancel\n            )\n            .then(goToOrderModFlow)\n        } else {\n          goToOrderModFlow()\n        }\n      }\n\n      /**\n       * Performs removal of order\n       *\n       * @returns {Promise<T>}\n       */\n      function removeOrder() {\n        $scope.cancellingOrder = true\n\n        return enterpriseServiceOrder.api.orders\n          .remove(order.id, order)\n          .then(() => {\n            const params = { ...$state.params, message: null }\n            $state.go($state.current.name, params, { reload: true })\n            cartService.sync()\n            $scope.cancellingOrder = false\n          })\n          .catch(response => {\n            if (response && response.error === HTTP_ERRORS.PII_UNAUTHORIZED) {\n              // If PII has timed out\n              registrationService.promptLogin(\n                $state.current.name,\n                $state.params,\n                '',\n                '',\n                lang.values.loginToContinue\n              )\n              $scope.cancellingOrder = false\n            } else {\n              if (response.message === 'Connect::TooLateError' || response?.error_code === 40301) {\n                const dismissLabel =\n                  config.orderHistoryView.showOrderTracker && $scope.shoppingIntent !== 'instore'\n                    ? lang.values.orderTracker.orderStatus.viewOrderProgressButton\n                    : null\n                errorModalService.open(\n                  lang.values.orderModificationTooLate,\n                  lang.values.ok,\n                  dismissLabel,\n                  lang.values.error,\n                  false,\n                  {},\n                  {\n                    onDismiss: () => {\n                      if (\n                        config.orderHistoryView.showOrderTracker &&\n                        $scope.shoppingIntent !== 'instore'\n                      ) {\n                        $scope.goToOrderInstacartLink()\n                      }\n                    },\n                  }\n                )\n              } else {\n                const errorModalInstance = errorModalService.open(\n                  response.message,\n                  lang.values.ok,\n                  null,\n                  null,\n                  true\n                )\n\n                errorModalInstance.closed.then(() => {\n                  // Force reload to get the order's latest state\n                  $rootScope.reloadState()\n                })\n              }\n              $scope.cancellingOrder = false\n            }\n          })\n      }\n\n      $scope.cancelOrder = function () {\n        errorModalService\n          .open(\n            lang.values.orderCancellationConfirmation,\n            lang.values.yes,\n            lang.values.no,\n            lang.values.cancelOrder\n          )\n          .then(removeOrder)\n      }\n\n      const updateOrder = ({ auth_capture }) => {\n        $scope.loading = true\n\n        $q.resolve()\n          .then(() =>\n            enterpriseServiceOrder.api.orders.update(order.id, {\n              payment_type: AUTH_TYPES.CAPTURE,\n              auth_capture,\n            })\n          )\n          .then(() => {\n            $scope.hideUpdateCreditCardSuccess = false\n          })\n          .catch(() => {\n            $scope.hideUpdateCreditCardError = false\n          })\n          .finally(() => {\n            $scope.loading = false\n          })\n      }\n\n      $scope.cancelOrModifyOrder = () => {\n        if ($scope.isShowModifyButton()) {\n          errorModalService.openCustom(cancelOrderModalTemplate, {\n            doModifyImmediately: () => $scope.modifyOrder(),\n            removeOrder,\n            secondaryButtonLabel: config.orderHistoryView.useItemEditFlow\n              ? lang.values.orderHistoryView.editItems\n              : lang.values.cancelOrderModal.modifyOrder,\n          })\n        } else {\n          $scope.cancelOrder()\n        }\n      }\n\n      // Sort products by category\n\n      const productsWithAvailabilityStatus = $scope.order.order_items\n        .filter(item => item.store_product && item.store_product.categories)\n        .map(item => {\n          // We want to only grey-out/cross-out substituted products if they are unavailable or completely removed from the order\n          // (whether the item has simply been removed or if the entire quantity has been fully substituted)\n          const isUnavailable =\n            !item.store_product.status || item.status === 'removed' || $scope.isItemOOS(item)\n          return { ...item, isUnavailable }\n        })\n\n      catalogCategoriesService\n        .getOrderedCategoriesAndProductsWithCategories(productsWithAvailabilityStatus)\n        .then(({ orderedCategories, categorizedProducts }) => {\n          $scope.orderedCategories = orderedCategories\n          $scope.categorizedProducts = categorizedProducts\n        })\n\n      $scope.hideCreditCardForm = true\n      $scope.hideUpdateCreditCardError = true\n      $scope.hideUpdateCreditCardSuccess = true\n      $scope.toggleCreditCardForm = () => {\n        $scope.hideCreditCardForm = !$scope.hideCreditCardForm\n        $scope.hideUpdateCreditCardError = true\n        $scope.hideUpdateCreditCardSuccess = true\n      }\n      $scope.updateCreditCard = function (payment, error) {\n        $scope.toggleCreditCardForm()\n        if (error) {\n          return ($scope.hideUpdateCreditCardError = false)\n        }\n\n        updateOrder(payment)\n      }\n\n      $scope.requestOrderAddOn = () => {\n        $state.go('orderAddOn', { order: $scope.order })\n      }\n\n      $scope.showNonOrderTrackInstacartSection = () => {\n        return (\n          config.instacart.enableDelivery &&\n          !config.orderHistoryView.showOrderTracker &&\n          order.status !== ORDER_STATUS.SHIPPED &&\n          order.ext_data.instacart_order_url\n        )\n      }\n\n      $scope.isProductDetailsModalDisabled = item => {\n        return (\n          item.isUnavailable ||\n          !item.isReorderable ||\n          (!eComLightService.inEComLightMode &&\n            $scope.order.ext_data?.source_cart_type === CART_TYPES.CATERING) ||\n          (eComLightService.inEComLightMode &&\n            $scope.order.ext_data?.source_cart_type !== CART_TYPES.CATERING)\n        )\n      }\n\n      /**\n       * Returns true if the offer discount should be shown.\n       *\n       * @returns { boolean }\n       */\n      $scope.showOfferDiscount = () => {\n        return (\n          config.showOfferDiscountAndCreditsApplied ||\n          parseInt(order.estimated_totals?.offer_total, 10) !== 0\n        )\n      }\n\n      $scope.showInstacartLogo = showOnMobile => {\n        return (\n          $scope.mobile.isMobile === showOnMobile &&\n          config.shoppingSelector.delivery.fulfilledByInstacart &&\n          order?.fulfillment_type === FULFILLMENT_TYPES.DELIVERY\n        )\n      }\n\n      $scope.showDeliveryInstructions = () => {\n        return (\n          order.fulfillment_type === 'delivery' &&\n          config.newCheckoutFlow.checkoutPage.stepsOrder.find(\n            step => step.name === 'orderDeliveryInstructions'\n          )\n        )\n      }\n\n      /**\n       * Returns true if the credit applied should be shown.\n       *\n       * @returns { boolean }\n       */\n      $scope.showCreditsApplied = () => {\n        return (\n          config.showOfferDiscountAndCreditsApplied ||\n          parseInt(order.estimated_totals?.credit_total, 10) !== 0\n        )\n      }\n\n      $scope.showTipAndRatingButton = () => {\n        return $scope.isShowTipAndRatingButton() && order.status === ORDER_STATUS.SHIPPED\n      }\n\n      $scope.shouldShowAddSelectedItemButton = () => {\n        if (order.status === ORDER_STATUS.NEW) return false\n\n        const currentShoppingMode = auth.getCurrentShoppingMode()\n        const orderType = order.ext_data?.source_cart_type || order.fulfillment_type\n\n        return currentShoppingMode === SHOPPING_MODES.CATERING\n          ? orderType === CART_TYPES.CATERING\n          : orderType !== CART_TYPES.CATERING\n      }\n\n      $scope.timeslotLabelFn = () =>\n        timeslotUtils.getMainLabel($scope.order, { verboseLevel: 1, format: config.apiDateFormat })\n\n      $scope.showInlineExternalProgressButton = () => {\n        return (\n          order.ext_data.instacart_order_url &&\n          order.status === 'new' &&\n          !config.orderHistoryView.disableViewOrderProgress\n        )\n      }\n\n      $scope.showInlineExternalPickupButton = () => {\n        return order.ext_data.pickup_status_url && order.status === 'new'\n      }\n\n      $scope.isShowTipAndRatingButton = () => {\n        const { shoppingIntent } = $scope\n        return (\n          config.instacart.enableDelivery &&\n          !config.orderHistoryView.disableTipAndRating &&\n          shoppingIntent !== SHOPPING_MODES.INSTORE_LIST &&\n          order.ext_data?.instacart_order_url\n        )\n      }\n\n      $scope.isShowModifyButton = () => {\n        return order.can_modify && !$scope.isOrderAddOnVisible()\n      }\n\n      $scope.isOrderAddOnVisible = () =>\n        config.enableModifyOrderAddOn &&\n        (order.can_add_items || order.additional_order_items.length > 0)\n\n      $scope.isShowCancelButton = () => {\n        return order.can_cancel\n      }\n\n      $scope.isShowOrderDetailButton = () => {\n        return (\n          order.ext_data.instacart_order_url && !config.orderHistoryView.disableViewOrderProgress\n        )\n      }\n\n      $scope.isShowPickupDetailButton = () => {\n        return (\n          order.ext_data.pickup_status_url &&\n          [FULFILLMENT_TYPES.PICKUP, FULFILLMENT_TYPES.CATERING].includes(order?.fulfillment_type)\n        )\n      }\n\n      $scope.enableModifyButton = () =>\n        order.ext_data.source_cart_type !== CART_TYPES.CATERING && !$rootScope.modifyingOrder\n\n      $scope.enableCancelButton = () =>\n        !$scope.cancellingOrder && order.ext_data.source_cart_type !== CART_TYPES.CATERING\n\n      $scope.goToOrderInstacartLink = () => {\n        instacartService.goToInstacartLink(order.ext_data.instacart_order_url)\n      }\n\n      $scope.goToPickupInstacartLink = () => {\n        instacartService.goToInstacartLink(order.ext_data.pickup_status_url)\n      }\n\n      const { useItemEditFlow } = config.orderHistoryView\n      $scope.orderTrackResources = {\n        modifyButtonLang: useItemEditFlow ? lang.values.orderHistoryView.editItems : undefined,\n        poweredByInstacart: utilService.loadAssetImage(POWERED_BY.LOGO),\n        fulfillmentTypeLang:\n          order.fulfillment_type === SHOPPING_MODES.PICKUP\n            ? SHOPPING_MODES.PICKUP\n            : SHOPPING_MODES.DELIVERY,\n      }\n\n      $scope.getOrderTotalsLines = () => {\n        // Add appropriate order totals lines\n        let setOrderTotalsLines = []\n\n        const estimatedTotals = order.estimated_totals\n        const finalTotals = order.final_totals\n\n        const fees = [\n          () => finalTotals?.fees,\n          () => estimatedTotals?.fees,\n          () => finalTotals,\n          () => estimatedTotals,\n        ]\n\n        const addOrderTotalLineValue = (label, value, shouldAdd = true, additionalProps = {}) => {\n          if (value && shouldAdd) {\n            setOrderTotalsLines.push({ type: 'value', label, value, ...additionalProps })\n          }\n        }\n\n        if (!finalTotals) {\n          addOrderTotalLineValue(lang.values.subtotal, estimatedTotals.pre_discount_product_total)\n          addOrderTotalLineValue(\n            lang.values.creditsApplied,\n            -estimatedTotals.credit_total,\n            $scope.showCreditsApplied() && estimatedTotals.credit_total\n          )\n          addOrderTotalLineValue(\n            lang.values.offerDiscount,\n            -estimatedTotals.offer_total,\n            $scope.showOfferDiscount() && estimatedTotals.offer_total\n          )\n\n          if ($scope.estimatedRewards.length) {\n            $scope.estimatedRewards.forEach(reward => {\n              setOrderTotalsLines.push({\n                type: 'value',\n                label: reward.label,\n                value: reward.value,\n              })\n            })\n          }\n\n          addOrderTotalLineValue(lang.values.tip, estimatedTotals.tip_total)\n          addOrderTotalLineValue(lang.values.subscriptionTotal, estimatedTotals.subscription_total)\n          addOrderTotalLineValue(lang.values.tax, estimatedTotals.tax_total)\n\n          setOrderTotalsLines = setOrderTotalsLines.concat(\n            orderFeesService.formattedFees(fees, order.fulfillment_type)\n          )\n\n          addOrderTotalLineValue(lang.values.total, estimatedTotals.total)\n        } else if (finalTotals) {\n          addOrderTotalLineValue(lang.values.subtotal, finalTotals.pre_discount_product_total)\n          addOrderTotalLineValue(\n            lang.values.creditsApplied,\n            -finalTotals.credit_total,\n            finalTotals.credit_total\n          )\n          addOrderTotalLineValue(\n            lang.values.offerDiscount,\n            -finalTotals.offer_total,\n            finalTotals.offer_total\n          )\n          addOrderTotalLineValue(\n            lang.values.refundTotal,\n            finalTotals.refund_total,\n            finalTotals.refund_total && finalTotals.refund_total > 0\n          )\n\n          if ($scope.estimatedRewards.length) {\n            $scope.estimatedRewards.forEach(reward => {\n              setOrderTotalsLines.push({\n                type: 'value',\n                label: reward.label,\n                value: reward.value,\n              })\n            })\n          }\n\n          addOrderTotalLineValue(lang.values.tip, finalTotals.tip_total)\n          addOrderTotalLineValue(lang.values.subscriptionTotal, finalTotals.subscription_total)\n          addOrderTotalLineValue(lang.values.tax, finalTotals.tax_total)\n\n          setOrderTotalsLines = setOrderTotalsLines.concat(\n            orderFeesService.formattedFees(fees, order.fulfillment_type)\n          )\n\n          addOrderTotalLineValue(lang.values.total, finalTotals.total)\n        }\n\n        // Ensures that a digset cycle is only triggered if the lines have changed.\n        if (!_.isEqual(setOrderTotalsLines, $scope.orderTotalsLines)) {\n          $scope.orderTotalsLines = setOrderTotalsLines\n        }\n\n        return $scope.orderTotalsLines\n      }\n\n      $scope.isUseItemEditFlow = () =>\n        $scope.isShowModifyButton() && config.orderHistoryView.useItemEditFlow\n\n      $scope.isUseRescheduleOrderButton = () =>\n        $scope.isShowModifyButton() &&\n        !$rootScope.modifyingOrder &&\n        config.orderHistoryView.useRescheduleOrderButton\n\n      $scope.jumpToCheckout = initialStep => {\n        cartService\n          .enterModifyState($scope.order, false, 'main.checkout.checkoutPage')\n          .then(() => ($rootScope.isAppLoading = true))\n          .then(() => $state.go('main.checkout.checkoutPage', { initialStep }))\n      }\n\n      $scope.isUseModifyOrderPaymentButton = () =>\n        $scope.isShowModifyButton() &&\n        !$rootScope.modifyingOrder &&\n        !config.modifyOrder.readOnlyPayment &&\n        config.orderHistoryView.useModifyOrderPaymentButton\n\n      /**\n       * Returns whether a given *order* was paid using a credit card online\n       *\n       * @param {object} order\n       * @returns boolean\n       */\n      $scope.isPaidWithCreditCard = order =>\n        order.payment_type === PAYMENT_TYPES.AUTH_CAPTURE &&\n        order.payment_instruments &&\n        order.payment_instruments.length > 0\n    }\n  )\n  .run(($templateCache, paymentGateway) => {\n    $templateCache.put('orderHistory.html', require('./views/orderHistory.html'))\n    $templateCache.put('order.html', require('./views/order.html'))\n    $templateCache.put('purchase.html', require('./views/purchase.html'))\n\n    if (isNewFirstData(paymentGateway)) {\n      $templateCache.put(\n        'firstDataIntegrationv2.html',\n        require('../../../optionalComponents/firstData/v2/firstDataIntegration.html')\n      )\n    } else {\n      $templateCache.put(\n        'firstDataIntegration.html',\n        require('../../../optionalComponents/firstData/v1/firstDataIntegration.html')\n      )\n    }\n  })\n","import _ from 'lodash'\nimport fp from 'lodash/fp'\nimport angular from 'angular'\nimport dayjs from 'dayjs'\n\nimport { order } from '@instacart/enterprise-services'\nimport loadAssetImage from '@app/utils/loadAssetImage'\n\nconst PAGE_LIMIT = 20\n\nexport default angular\n  .module('OrderHistoryControllerModule', [])\n  .controller(\n    'OrderHistoryController',\n    function (\n      $q,\n      $scope,\n      $state,\n      $stateParams,\n      checkoutService,\n      config,\n      lang,\n      oneCartService,\n      orderService\n    ) {\n      $scope.config = config\n      $scope.useMostRecentPagination = oneCartService.enabled()\n      $scope.orderPaginationStack = checkoutService.orderPaginationStack\n\n      $scope.filters = [\n        {\n          id: '30-days',\n          name: 'Past 30 Days',\n          value: {\n            from_date: dayjs().startOf('day').subtract(30, 'days').format(config.apiDateFormat),\n            to_date: dayjs().endOf('day').format(config.apiDateFormat),\n          },\n        },\n        {\n          id: '6-months',\n          name: 'Past 6 Months',\n          value: {\n            from_date: dayjs().startOf('day').subtract(6, 'months').format(config.apiDateFormat),\n            to_date: dayjs().endOf('day').format(config.apiDateFormat),\n          },\n        },\n      ]\n\n      let thisYear = dayjs().year()\n      while (thisYear >= config.transactionStartYear) {\n        const dayjsYear = dayjs().year(thisYear)\n        $scope.filters.push({\n          id: thisYear,\n          name: thisYear,\n          value: {\n            from_date: dayjsYear.startOf('year').format(config.apiDateFormat),\n            to_date: dayjsYear.endOf('year').format(config.apiDateFormat),\n          },\n        })\n        // eslint-disable-next-line no-plusplus\n        thisYear--\n      }\n\n      $scope.getOrderListParams = function () {\n        return {\n          limit: PAGE_LIMIT,\n          after: $stateParams.order_cursor,\n        }\n      }\n\n      $scope.getPurchaseListParams = function () {\n        return {\n          limit: PAGE_LIMIT,\n          after: $stateParams.purchase_cursor,\n        }\n      }\n\n      $scope.selectedRange = _.find($scope.filters, dateRange => {\n        return String(dateRange.id) === $stateParams.selectedRange\n      })\n\n      $scope.filterTypes = []\n\n      if (config.orderHistory.showInStore && config.orderHistory.showOnline) {\n        $scope.filterTypes.push({\n          id: config.orderHistoryOptions.inStoreOnline.id,\n          type: config.orderHistoryOptions.inStoreOnline.type,\n          label: config.orderHistoryOptions.inStoreOnline.label,\n        })\n      }\n\n      if (config.orderHistory.showInStore) {\n        $scope.filterTypes.push({\n          id: config.orderHistoryOptions.inStore.id,\n          type: config.orderHistoryOptions.inStore.type,\n          label: config.orderHistoryOptions.inStore.label,\n        })\n      }\n\n      if (config.orderHistory.showOnline) {\n        $scope.filterTypes.push({\n          id: config.orderHistoryOptions.online.id,\n          type: config.orderHistoryOptions.online.type,\n          label: config.orderHistoryOptions.online.label,\n        })\n      }\n\n      $scope.selectedType = _.find($scope.filterTypes, { id: $stateParams.selectedType })\n\n      // $stateParams.selectedType could be null or set to an invalid state\n      if (!$scope.selectedType) {\n        $scope.selectedType = $scope.filterTypes[0]\n      }\n      $scope.filterByType = { type: $scope.selectedType.type }\n\n      $scope.resetFilterState = function (selectedRange, selectedType) {\n        $state.go('.', {\n          selectedRange: selectedRange.id,\n          selectedType: selectedType.id,\n        })\n      }\n\n      $scope.nextPageOrders = function (nextOrderCursor, nextPurchaseCursor) {\n        checkoutService.orderPaginationStack.push([\n          $stateParams.order_cursor,\n          $stateParams.purchase_cursor,\n        ])\n        $state.go('.', {\n          order_cursor: nextOrderCursor,\n          purchase_cursor: nextPurchaseCursor,\n        })\n      }\n      $scope.prevPageOrders = function () {\n        const [order_cursor, purchase_cursor] = checkoutService.orderPaginationStack.pop()\n        $state.go('.', {\n          order_cursor,\n          purchase_cursor,\n        })\n      }\n\n      $scope.getBanner = warehouseId =>\n        config.multipleBanners.banners.find(banner => banner.bannerExtId === warehouseId)\n\n      $scope.handleViewOrderClick = order => orderService.handleViewOrderClick(order)\n\n      $scope.setFilter = function () {\n        let orderQueryParams = $scope.selectedRange.value\n        let purchaseQueryParams = $scope.selectedRange.value\n        if ($scope.useMostRecentPagination) {\n          orderQueryParams = $scope.getOrderListParams()\n          purchaseQueryParams = $scope.getPurchaseListParams()\n        }\n\n        // add oneCart.enabled config to queryString\n        orderQueryParams.one_cart_enabled = oneCartService.enabled()\n\n        // add user timezone to queryString\n        orderQueryParams.user_timezone = Intl.DateTimeFormat().resolvedOptions().timeZone\n\n        const orders = order.api.orders.getAll(orderQueryParams).then(response => {\n          if (response?._meta) {\n            $scope.order_meta = response._meta\n          }\n          const { items } = response\n          return _.each(items, item => {\n            item.type = 'order'\n            item.location = 'Online'\n          })\n        })\n\n        const purchases = order.api.purchases.getAll(purchaseQueryParams).then(response => {\n          if (response?._meta) {\n            $scope.purchase_meta = response._meta\n          }\n          const { items } = response\n          return _.each(items, item => {\n            item.type = 'purchase'\n\n            let location\n            switch (item.source) {\n              case 'online':\n                location = 'Online'\n                break\n              default:\n                location = 'In-store'\n            }\n            item.location = location\n          })\n        })\n\n        $q.all([orders, purchases]).then(items => {\n          $scope.orderHistory = fp.flow(\n            fp.sortBy(item => {\n              return item.fulfillment_date || item.timestamp\n            }),\n            fp.reverse,\n            fp.map(item => {\n              return { ...item, banner: $scope.getBanner(item.warehouse_id) }\n            })\n          )(items[0].concat(items[1]))\n        })\n      }\n\n      $scope.loadImg = (image, fallback) => loadAssetImage(image, fallback)\n\n      $scope.setFilter()\n    }\n  )\n","export const UNIT_OF_MEASURE = {\n  EACH: 'ea',\n  LB: 'lb',\n  KG: 'kg',\n}\n","import angular from 'angular'\nimport {\n  product as enterpriseProductService,\n  shoppingList as shoppingListService,\n} from '@instacart/enterprise-services'\nimport { FULFILLMENT_TYPES } from '@app/angular/constants/checkout'\nimport { UNIT_OF_MEASURE } from '@app/angular/constants/uom'\nimport { utils as timeslotUtils } from '@instacart/enterprise-timeslots'\nimport debounce from 'lodash/debounce'\nimport cloneDeep from 'lodash/cloneDeep'\nimport isEqual from 'lodash/isEqual'\nimport dayjs from 'dayjs'\n\nimport { DATE_OF_BIRTH_FORMAT } from '@app/angular/constants/alcoholValidation'\n\nexport default angular\n  .module('OrderEditItemControllerModule', [])\n  .controller(\n    'OrderEditItemController',\n    function (\n      $filter,\n      $rootScope,\n      $scope,\n      $state,\n      Restangular,\n      cartService,\n      catalogCategoriesService,\n      config,\n      configurableProductService,\n      errorModalService,\n      imageURLService,\n      lang,\n      offersService,\n      order,\n      orderFeesService,\n      savedOrderItemStash,\n      setPageHeaderTitle\n    ) {\n      setPageHeaderTitle(\n        `${lang.values.orderEditItemsFor} ${\n          order.fulfillment_type === FULFILLMENT_TYPES.DELIVERY\n            ? lang.values.delivery\n            : lang.values.pickup\n        }`\n      )\n      // We need to keep the original list to ensure that the order has actually been modified\n      const originalOrderItems =\n        savedOrderItemStash?.modifyOrderItems ||\n        order.order_items.map(item => ({ ...item, comment: item.customer_comment }))\n\n      /*\n       * Initialize scope with info\n       */\n      Object.assign($scope, {\n        catalogCategoriesService,\n        config,\n        configurableProductService,\n        imageURLService,\n        lang,\n        order,\n        mobileShowNotesAndSubs: false,\n        currencyFilter: $filter('currency'),\n        getMinCartSpend: shoppingListService.commonUtils.getMinimumCartSpend,\n        substitutions: {\n          allowAllSubstitutions: order.order_items.every(item => item.allow_substitutions),\n        },\n        orderTotals: {\n          ...order.estimated_totals,\n        },\n        orderTotalLines: [],\n        isCalculationRequestLoading: false,\n        isCalculationRequestBuffered: false,\n        isCalculationRequestDebounced: false,\n        // Create a copy of order.order_items for modification\n        modifyOrderItems: cloneDeep(originalOrderItems),\n        modifyOfferProgress: order.offer_progress || [],\n      })\n\n      /**\n       * Returns a quantity within the max and min paramaters of an item's quantity config.\n       *\n       * @param {object} item Item object\n       * @param {number} quantity Quantity of item to clamp\n       */\n      $scope.clampedItemQuantity = (item, quantity) =>\n        Math.min(\n          Math.max(quantity, item.store_product?.ordering_parameters?.min || -Infinity),\n          item.store_product?.ordering_parameters?.max || Infinity\n        )\n\n      /*\n       * Merge appendedItems if provided by the Add Items page\n       */\n      if (savedOrderItemStash?.appendedItems?.length > 0) {\n        $scope.hasAppendedItems = true\n\n        savedOrderItemStash.appendedItems.forEach(newItem => {\n          const existingItem = $scope.modifyOrderItems.find(\n            existingItem => existingItem.store_product.id === newItem.store_product.id\n          )\n\n          if (existingItem) {\n            const newQuantity = existingItem.quantity + newItem.quantity\n            existingItem.quantity = $scope.clampedItemQuantity(newItem, newQuantity)\n          } else {\n            $scope.modifyOrderItems.push(\n              convertNewItemToEditItem(newItem, $scope.modifyOrderItems.length)\n            )\n          }\n        })\n\n        savedOrderItemStash.appendedItems = null\n      }\n\n      /*\n       * Begin main Edit Items page\n       */\n      let lastValidCalculateResponse = { order_items: [...$scope.modifyOrderItems] }\n\n      $scope.updateCategorizedItems = () => {\n        const productsWithAvailabilityStatus = $scope.modifyOrderItems\n          .filter(item => item.store_product?.categories)\n          .map(item => {\n            // We want to only grey-out/cross-out substituted products if they are unavailable or completely removed from the order\n            // (whether the item has simply been removed or if the entire quantity has been fully substituted)\n            const isUnavailable = !item.store_product.status || item.status === 'removed'\n            return { ...item, isUnavailable }\n          })\n\n        return catalogCategoriesService\n          .getOrderedCategoriesAndProductsWithCategories(productsWithAvailabilityStatus)\n          .then(({ orderedCategories, categorizedProducts }) => {\n            $scope.orderedCategories = orderedCategories\n            $scope.categorizedProducts = categorizedProducts\n          })\n      }\n\n      /**\n       * Returns true if the offer discount should be shown.\n       *\n       * @returns { boolean }\n       */\n      $scope.showOfferDiscount = () => {\n        return (\n          config.showOfferDiscountAndCreditsApplied ||\n          parseInt($scope.orderTotals.offer_total, 10) !== 0\n        )\n      }\n\n      /**\n       * Returns true if the credit applied should be shown.\n       *\n       * @returns { boolean }\n       */\n      $scope.showCreditsApplied = () => {\n        return (\n          config.showOfferDiscountAndCreditsApplied ||\n          parseInt($scope.orderTotals.credit_total, 10) !== 0\n        )\n      }\n\n      /**\n       * Returns whether estimated total is below minimum.\n       *\n       * @returns { boolean }\n       */\n      $scope.isTotalBelowMin = () => {\n        const cartMinimum = shoppingListService.commonUtils.getMinimumCartSpend()\n        return cartMinimum && $scope.orderTotals.product_total < cartMinimum\n      }\n\n      /**\n       * Sets totals and total lines for display.\n       *\n       * @param {object} totals Totals for the order\n       */\n      $scope.setEstimatedOrderTotals = totals => {\n        $scope.orderTotals = totals\n        let setOrderTotalsLines = []\n\n        const fees = [() => totals?.fees, () => totals]\n\n        const addOrderTotalLineValue = (label, value, shouldAdd = true, additionalProps = {}) => {\n          if (value && shouldAdd) {\n            setOrderTotalsLines.push({ type: 'value', label, value, ...additionalProps })\n          }\n        }\n\n        addOrderTotalLineValue(lang.values.itemTotal, totals.product_total)\n\n        if (!$scope.isTotalBelowMin()) {\n          addOrderTotalLineValue(\n            lang.values.creditsApplied,\n            totals.credit_total,\n            $scope.showCreditsApplied()\n          )\n\n          addOrderTotalLineValue(\n            lang.values.offerDiscount,\n            -totals.offer_total,\n            $scope.showOfferDiscount()\n          )\n\n          addOrderTotalLineValue(lang.values.tip, totals.tip_total)\n          addOrderTotalLineValue(lang.values.tax, totals.tax_total)\n\n          const formattedFees = orderFeesService.formattedFees(fees, order.fulfillment_type)\n\n          if (formattedFees.length > 0) {\n            setOrderTotalsLines.push({\n              type: 'divider',\n            })\n\n            setOrderTotalsLines = setOrderTotalsLines.concat(formattedFees)\n\n            setOrderTotalsLines.push({\n              type: 'divider',\n            })\n          }\n\n          addOrderTotalLineValue(lang.values.total, totals.total)\n        }\n\n        $scope.orderTotalLines = setOrderTotalsLines\n      }\n\n      $scope.setEstimatedOrderTotals(order.estimated_totals)\n\n      /**\n       * Gets line number of an item (with support for previous key name).\n       *\n       * @param {object} item Item to get line number from\n       */\n      $scope.getItemLineNumber = item => item.line_number || item.lineNumber\n\n      /**\n       * Updates an item and optionally redraws the view.\n       *\n       * @param {number} lineNumber Line number of item to update\n       * @param {object} valuesToUpdate Values to update on the item\n       * @param {boolean} [updateView=true] Whether to redraw the view\n       */\n      $scope.updateModifyItem = (lineNumber, valuesToUpdate, updateView = true) => {\n        const foundItem = $scope.modifyOrderItems.find(\n          modifyItem => $scope.getItemLineNumber(modifyItem) === lineNumber\n        )\n\n        if (foundItem) Object.assign(foundItem, valuesToUpdate)\n\n        if (updateView) $scope.updateCategorizedItems()\n      }\n\n      /**\n       * Updates the commnt of an item.\n       *\n       * @param {object} item Item object with updated comment\n       */\n      $scope.updateItemComment = item => {\n        $scope.updateModifyItem($scope.getItemLineNumber(item), {\n          customer_comment: item.comment,\n\n          // For display purposes.\n          comment: item.comment,\n        })\n      }\n\n      /**\n       * Toggles whether substitutions are allowed. If substitutions are disabled in a config for a the item,\n       * the value will not change. Also updates the \"Allow All Substitutions\" toggle to match.\n       *\n       * @param {object} item Item object to toggle\n       */\n      $scope.toggleAllowSubstitutions = item => {\n        if ($scope.isAllowSubstitutionsDisabled(item)) return\n\n        $scope.updateModifyItem($scope.getItemLineNumber(item), {\n          allow_substitutions: item.allow_substitutions,\n        })\n\n        $scope.substitutions.allowAllSubstitutions = $scope.modifyOrderItems.every(\n          item => item.allow_substitutions || $scope.isAllowSubstitutionsDisabled(item)\n        )\n      }\n\n      /**\n       * Toggles the \"Allow All Substitutions\" checkbox and changes each item to match (unless substitutions\n       * are disabled in a config for a the item).\n       */\n      $scope.toggleAllowAllSubstitutions = () => {\n        $scope.modifyOrderItems.forEach(item => {\n          if (!$scope.isAllowSubstitutionsDisabled(item)) {\n            item.allow_substitutions = $scope.substitutions.allowAllSubstitutions\n          }\n        })\n\n        $scope.updateCategorizedItems()\n      }\n\n      /**\n       * Removes an item from the list.\n       *\n       * @param {object} item Item object to remove\n       */\n      $scope.removeItem = item => {\n        const foundItemIndex = $scope.modifyOrderItems.findIndex(\n          modifyItem => $scope.getItemLineNumber(modifyItem) === $scope.getItemLineNumber(item)\n        )\n\n        $scope.modifyOrderItems.splice(foundItemIndex, 1)\n\n        $scope.updateCategorizedItems()\n        $scope.handleCalculateOrderTotals()\n      }\n\n      /**\n       * Shows confirm delete action for the item if quantity is below minimum\n       *\n       * @param {object} item - The product item being updated\n       * @param {object} [relativeQuantityChange=0] - Relative quantity difference from current item quantity\n       *\n       * @returns {boolean} Whether the delete confirmation was shown\n       */\n      $scope.removeItemIfMin = (item, relativeQuantityChange = 0) => {\n        if (\n          item.quantity + relativeQuantityChange <\n          (item.store_product?.ordering_parameters?.min || 0)\n        ) {\n          item.showDeleteConfirm = true\n          return true\n        }\n\n        return false\n      }\n\n      /**\n       * Increments the quantity of an object.\n       *\n       * @param {object} item Item object to increment\n       */\n      $scope.incrementItem = item => {\n        if ($scope.removeItemIfMin(item, 1)) return\n        $scope.updateModifyItem($scope.getItemLineNumber(item), {\n          quantity: $scope.clampedItemQuantity(item, item.quantity + 1),\n        })\n\n        $scope.handleCalculateOrderTotals()\n      }\n\n      /**\n       * Decrements the quantity of an object, showing the \"remove\" prompt if the quantity is lower\n       * than the min quantity.\n       *\n       * @param {object} item Item object to increment\n       */\n      $scope.decrementItem = item => {\n        if ($scope.removeItemIfMin(item, -1)) return\n        $scope.updateModifyItem($scope.getItemLineNumber(item), {\n          quantity: $scope.clampedItemQuantity(item, item.quantity - 1),\n        })\n\n        $scope.handleCalculateOrderTotals()\n      }\n\n      /**\n       * Triggered when the quantity is updated\n       *\n       * @param {object} item - The product item being updated\n       */\n      $scope.updateItemQuantity = item => {\n        if ($scope.removeItemIfMin(item)) return\n        $scope.updateModifyItem($scope.getItemLineNumber(item), {\n          quantity: $scope.clampedItemQuantity(item, item.quantity),\n        })\n\n        $scope.handleCalculateOrderTotals()\n      }\n\n      /**\n       * Hides the delete confirmation prompt for an item.\n       *\n       * @param {object} item Item object\n       */\n      $scope.cancelRemoveItem = item => {\n        // Redraw the item. showDeleteConfirm is falsey by default, so this will hide the confirmation.\n        $scope.updateModifyItem($scope.getItemLineNumber(item))\n      }\n\n      // Used to ensure ng-repeat's `track by` works with one-time binding\n      $scope.generateUniqueItemId = item =>\n        `${item.store_product.id}-${configurableProductService.generateConfigIdString(item)}`\n\n      $scope.timeslotLabelFn = () =>\n        timeslotUtils.getMainLabel($scope.order, {\n          verboseLevel: 1,\n          format: $scope.config.apiDateFormat,\n        })\n\n      /**\n       * Returns whether an item's substitutions are disabled based on config.\n       *\n       * @param {object} item Item object\n       */\n      $scope.isAllowSubstitutionsDisabled = item => {\n        return !$scope.config.enableAllowSubstitutionsForConfigurableItems && item.product_config\n      }\n\n      /**\n       * Returns whether an item is currently out of stock.\n       *\n       * @param {object} item Item object\n       */\n      $scope.isItemCurrentlyOutOfStock = item => {\n        return !enterpriseProductService.utils.isProductAvailable(item.store_product)\n      }\n\n      /**\n       * Sets whether the UI for editing notes and substitions is enabled on mobile.\n       *\n       * @param {boolean} isShown Whether to show the UI for the edit notes and subs mode.\n       */\n      $scope.setMobileShowNotesAndSubs = isShown => {\n        $scope.mobileShowNotesAndSubs = isShown\n      }\n\n      /**\n       * Calculate totals and update order item sub totals\n       */\n      $scope.calculateOrderTotals = () => {\n        // Buffer the request to ensure that multiple calculate calls aren't made simultaneously\n        if ($scope.isCalculationRequestLoading) {\n          $scope.isCalculationRequestBuffered = true\n          return\n        }\n\n        $scope.isCalculationRequestDebounced = false\n        $scope.isCalculationRequestLoading = true\n\n        const payload = { order_items: $scope.modifyOrderItems }\n\n        if (cartService.dateOfBirth) {\n          payload.user_birthday = dayjs(cartService.dateOfBirth, DATE_OF_BIRTH_FORMAT)\n            .startOf('day')\n            .toISOString()\n        }\n\n        Restangular.one('orders', $scope.order.id)\n          .post('calculate_totals', payload)\n          .then(response => {\n            $scope.setEstimatedOrderTotals(response.estimated_totals)\n\n            lastValidCalculateResponse = response\n\n            $scope.modifyOfferProgress = response.offer_progress\n\n            response.order_items.forEach(item => {\n              if (!$scope.getItemLineNumber(item)) return\n              $scope.updateModifyItem($scope.getItemLineNumber(item), { sub_total: item.sub_total })\n            })\n\n            if ($scope.isCalculationRequestBuffered) {\n              $scope.handleCalculateOrderTotals()\n              $scope.isCalculationRequestBuffered = false\n            }\n          })\n          .catch(error => {\n            if (error?.data?.message) errorModalService.open(error.data.message, lang.values.ok)\n\n            $scope.modifyOrderItems = cloneDeep(lastValidCalculateResponse.order_items)\n            $scope.updateCategorizedItems()\n          })\n          .finally(() => {\n            $scope.isCalculationRequestLoading = false\n          })\n      }\n\n      $scope.debouncedCalculateOrderTotals = debounce($scope.calculateOrderTotals, 500)\n\n      /**\n       * Calculate totals and update order item sub totals,\n       * with loading and debouncing.\n       */\n      $scope.handleCalculateOrderTotals = () => {\n        $scope.isCalculationRequestDebounced = true\n        $scope.debouncedCalculateOrderTotals()\n      }\n\n      // When Offer service updates the coupon clipping state,\n      // then recalculate totals to get the latest value after the coupon discount is applied\n      $rootScope.$on('couponOfferClippedStateUpdated', () => {\n        $scope.handleCalculateOrderTotals()\n      })\n\n      /**\n       * Uses calculation request debounced status as well as total calculation requests to determine loading state.\n       *\n       * @returns {boolean} Loading state\n       */\n      $scope.isCalculationLoading = () =>\n        $scope.isCalculationRequestDebounced || $scope.isCalculationRequestLoading\n\n      const postOrder = (orderId, orderItems) => {\n        const payload = { order_items: orderItems }\n\n        if (cartService.dateOfBirth) {\n          payload.user_birthday = dayjs(cartService.dateOfBirth, DATE_OF_BIRTH_FORMAT)\n            .startOf('day')\n            .toISOString()\n        }\n\n        return Restangular.one('orders', orderId).post('modify', payload)\n      }\n\n      /**\n       * Save changes and redirect back to the order.\n       */\n      $scope.saveOrderModifications = () => {\n        $rootScope.isAppLoading = true\n        const isModified = !isEqual($scope.modifyOrderItems, originalOrderItems)\n\n        Promise.resolve()\n          .then(() => isModified && postOrder($scope.order.id, $scope.modifyOrderItems))\n          .then(() =>\n            $state.go(\n              'main.account.orderHistory.order',\n              {\n                id: $scope.order.id,\n                message: isModified ? lang.values.orderModifiedSuccess : null,\n              },\n              { reload: true }\n            )\n          )\n          .catch(error => {\n            errorModalService.open(error.data?.message, lang.values.ok)\n          })\n          .finally(() => {\n            $rootScope.isAppLoading = false\n          })\n      }\n\n      /**\n       * Redirect back to the order without saving changes.\n       */\n      $scope.discardOrderModifications = () => {\n        $state.go('main.account.orderHistory.order', {\n          id: $scope.order.id,\n        })\n      }\n\n      /**\n       * Go to view to add items\n       */\n      $scope.addItemsToOrder = () => {\n        const { order, modifyOrderItems } = $scope\n        $rootScope.orderEditItemStash = { order, modifyOrderItems }\n        $state.go('main.account.orderHistory.order.edit.append', { id: order.id })\n      }\n\n      /**\n       * Checks whether an offer exists for a given item.\n       *\n       * @param {object} item - Cart item to check for offer\n       */\n      $scope.itemHasOffer = item =>\n        cartService.getCartItemIdsFromOffers($scope.modifyOfferProgress).includes(item.id)\n\n      /*\n       * INITIALIZE STATE\n       */\n      $scope.updateCategorizedItems().then($scope.handleCalculateOrderTotals)\n    }\n  )\n  .run($templateCache => {\n    $templateCache.put('orderEditItem.html', require('./views/orderEditItem.html'))\n  })\n\n/**\n * Converts a new item into a semi-edit item for processing by the calculate_totals API\n * @param {object} newItem\n * @param {number} totalItemCount\n * @returns {object}\n */\nfunction convertNewItemToEditItem(newItem, totalItemCount) {\n  return {\n    ...newItem,\n    ext_data: {}, // TODO HOW DO WE GET DATA HERE\n    line_number: `${totalItemCount + 1}`,\n    status: 'original',\n    allow_substitutions: true,\n    comment: null,\n    customer_comment: null,\n    uom: (newItem.store_product.display_uom || UNIT_OF_MEASURE.EACH).toUpperCase(),\n    sub_total: newItem.store_product.base_price * newItem.quantity,\n    actual_quantity: newItem.quantity,\n  }\n}\n","export const DATE_OF_BIRTH_FORMAT = 'MMDDYYYY'\n","import angular from 'angular'\nimport { auth as authService } from '@instacart/enterprise-services'\nimport { captureException } from '@sentry/browser'\nimport { HTTP_ERRORS } from '@app/angular/constants/httpErrors'\nimport { LOGIN_CONTEXTS } from '@app/angular/constants/loginContexts'\nimport { OneCartActions } from '@app/services/oneCart/types'\nimport isMobileApp from '@app/utils/isMobileApp'\n\nexport default angular\n  .module('OrderIcRedirectControllerModule', [])\n  .controller(\n    'OrderIcRedirectController',\n    function (\n      $location,\n      $rootScope,\n      $scope,\n      $state,\n      $stateParams,\n      auth,\n      config,\n      lang,\n      localStorageService,\n      oneCartService,\n      registrationService\n    ) {\n      const queryParams = {}\n      if ($stateParams.add_to_order) {\n        queryParams.add_to_order = ''\n      }\n      $rootScope.isAppLoading = true\n\n      let authFunction = authService.api.auth.getOneCartOrderRedirect\n      let action = OneCartActions.ORDER_STATUS\n\n      // this means its a certified delivery link not a order status link\n      if ($stateParams.id.indexOf('cd') === 0) {\n        authFunction = authService.api.auth.getCertifiedDeliveryRedirect\n        action = OneCartActions.CERTIFIED_DELIVERY\n      }\n\n      // $stateParams.id is the IC order id(including the date) for example 03163808646437130581\n      authFunction($stateParams.id, queryParams)\n        .then(resp => {\n          return oneCartService\n            .redirectToPBI(resp.location, resp.auth_token, { action })\n            .then(() => {\n              // This redirect is required for mobile so users don't see the empty view of this controller\n              if (isMobileApp()) {\n                $state.go('main.account.orderHistory')\n              }\n            })\n        })\n        .catch(e => {\n          if (e.error === HTTP_ERRORS.PII_UNAUTHORIZED) {\n            // If PII has timed out\n            localStorage.setItem('icOrderId', $stateParams.id)\n            localStorageService.deprecatedSet('icOrderQuery', queryParams)\n\n            registrationService.promptLogin(\n              $state.current.name,\n              $state.params,\n              '',\n              '',\n              lang.values.loginToContinue,\n              LOGIN_CONTEXTS.REDIRECT_ONECART_ORDER_STATUS\n            )\n            return\n          }\n\n          captureException(e)\n          $rootScope.isAppLoading = false\n          $location.url('/account/order-history')\n        })\n    }\n  )\n","import _ from 'lodash'\nimport angular from 'angular'\n\nimport { CART_TYPES } from '@app/angular/constants/cart.js'\nimport { product as enterpriseProductService } from '@instacart/enterprise-services'\n\nexport default angular\n  .module('PurchaseControllerModule', [])\n  .controller(\n    'PurchaseController',\n    function (\n      $scope,\n      config,\n      eComLightService,\n      imageURLService,\n      list,\n      productDetailsModal,\n      purchase\n    ) {\n      $scope.config = config\n      $scope.purchase = purchase\n      $scope.productDetailsModal = productDetailsModal\n      $scope.imageURLService = imageURLService\n\n      $scope.selectedItems = []\n      $scope.selectedMap = {}\n\n      _.each($scope.purchase.items, item => {\n        $scope.selectedMap[item.store_product.id] = false\n      })\n\n      $scope.isProductDetailsModalDisabled = item => {\n        const isItemOOS = item =>\n          !enterpriseProductService.utils.isProductAvailable(item.store_product)\n        const isUnavailable =\n          !item.store_product.status || item.status === 'removed' || isItemOOS(item)\n        const isReorderable =\n          _.isNil(item.product_config) ||\n          _.isNil(item.store_product.product_config) ||\n          _.isNil(item.store_product.product_config.status) ||\n          item.store_product.product_config.status\n        return (\n          isUnavailable ||\n          !isReorderable ||\n          (!eComLightService.inEComLightMode &&\n            $scope.purchase?.ext_data?.source_cart_type === CART_TYPES.CATERING) ||\n          (eComLightService.inEComLightMode &&\n            $scope.purchase?.ext_data?.source_cart_type !== CART_TYPES.CATERING)\n        )\n      }\n\n      $scope.selectItem = function (item) {\n        const itemIndex = _.findIndex($scope.selectedItems, selectedItemsItem => {\n          // eslint-disable-next-line eqeqeq\n          return selectedItemsItem.store_product.id == item.store_product.id\n        })\n\n        // eslint-disable-next-line eqeqeq\n        if (itemIndex != -1) {\n          $scope.selectedItems.splice(itemIndex, 1)\n          $scope.noneSelected = false\n        } else {\n          $scope.selectedItems.push(item)\n        }\n      }\n\n      $scope.selectAll = function () {\n        if ($scope.noneSelected) {\n          _.each($scope.purchase.items, item => {\n            const itemIndex = _.findIndex($scope.selectedItems, selectedItemsItem => {\n              // eslint-disable-next-line eqeqeq\n              return selectedItemsItem.store_product.id == item.store_product.id\n            })\n\n            // eslint-disable-next-line eqeqeq\n            if (itemIndex == -1 && item.store_product.status) {\n              $scope.selectedItems.push(item)\n              $scope.selectedMap[item.store_product.id] = true\n            }\n          })\n        } else {\n          $scope.selectedItems.length = 0\n          _.each($scope.purchase.items, item => {\n            $scope.selectedMap[item.store_product.id] = false\n          })\n        }\n      }\n\n      $scope.loadList = list.loadListToCart\n\n      $scope.loadAll = function () {\n        list.loadListToCart($scope.purchase.items)\n      }\n\n      $scope.categorizedProducts = _.groupBy($scope.purchase.items, item => {\n        return item.store_product.categories[0]\n          ? item.store_product.categories[0].name\n          : 'Uncategorized'\n      })\n    }\n  )\n","import angular from 'angular'\nimport { order } from '@instacart/enterprise-services'\n\n// cannot lazyload controllers because of nested views that relies on them\nimport OrderController from './orderController'\nimport OrderHistoryController from './orderHistoryController'\nimport OrderEditItemController from './orderEditItemController'\nimport OrderIcRedirectController from './orderIcRedirectController'\nimport PurchaseController from './purchaseController'\n\nexport default angular\n  .module('OrderHistoryComponentModule', [\n    OrderController.name,\n    OrderHistoryController.name,\n    OrderEditItemController.name,\n    OrderIcRedirectController.name,\n    PurchaseController.name,\n  ])\n  .config(($stateProvider, langProvider) => {\n    // ORDER LIST VIEW\n    $stateProvider.state('main.account.orderHistory', {\n      url: '/order-history?{selectedRange}&{selectedType}',\n      views: {\n        'content@main.account': {\n          templateUrl: 'orderHistory.html',\n          controller: 'OrderHistoryController',\n        },\n      },\n      params: {\n        order_cursor: {\n          value: '',\n        },\n        purchase_cursor: {\n          value: '',\n        },\n        nextCursor: {\n          value: '',\n        },\n        selectedRange: {\n          value: '30-days',\n          squash: true,\n        },\n        selectedType: null,\n      },\n      resolve: {\n        title(titleService) {\n          return titleService.setTitle(langProvider.values.onlineOrderHistory)\n        },\n      },\n      data: {\n        breadcrumbs: [\n          {\n            label: langProvider.values.accountDetails,\n          },\n          {\n            label: langProvider.values.orderHistory,\n          },\n        ],\n      },\n    })\n    // OneCart order history redirect view\n    $stateProvider.state('main.account.orderic', {\n      url: '/order/ic/{id}?{add_to_order}',\n      views: {\n        'content@main.account': {\n          template: '',\n          controller: 'OrderIcRedirectController',\n        },\n      },\n      data: {\n        breadcrumbs: [\n          {\n            label: langProvider.values.accountDetails,\n          },\n          {\n            label: langProvider.values.orderHistory,\n          },\n        ],\n      },\n    })\n    // ORDER DETAILS VIEW\n    $stateProvider.state('main.account.orderHistory.order', {\n      url: '/order/{id}',\n      views: {\n        'content@main.account': {\n          templateUrl: 'order.html',\n          controller: 'OrderController',\n          resolve: {\n            payment($q, Restangular) {\n              const deferred = $q.defer()\n              Restangular.one('cart/payment')\n                .get()\n                .then(\n                  payment => {\n                    deferred.resolve(payment)\n                  },\n                  () => {\n                    deferred.resolve({}) // Handle 404 when no payment present\n                  }\n                )\n              return deferred.promise\n            },\n          },\n        },\n      },\n      resolve: {\n        title(titleService) {\n          return titleService.setTitle(langProvider.values.orderHistory)\n        },\n        setPageHeaderTitle() {\n          return title => (this.data.customPageHeaderTitle = title)\n        },\n        order(Restangular, $stateParams, oneCartService) {\n          return order.api.orders.get($stateParams.id, {\n            one_cart_enabled: oneCartService.enabled(),\n            user_timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,\n          })\n        },\n      },\n      params: {\n        message: null,\n        error: null,\n      },\n      data: {\n        breadcrumbs: [\n          {\n            label: langProvider.values.accountDetails,\n          },\n          {\n            state: 'main.account.orderHistory',\n            label: langProvider.values.orderHistory,\n          },\n          {\n            label: langProvider.values.orderDetails,\n          },\n        ],\n        customPageHeaderTitle: null,\n      },\n    })\n\n    // ORDER EDIT ITEMS\n    $stateProvider.state('main.account.orderHistory.order.edit', {\n      url: '/edit',\n      views: {\n        'content@main.account': {\n          templateUrl: 'orderEditItem.html',\n          controller: 'OrderEditItemController',\n          resolve: {\n            order($rootScope, $stateParams, oneCartService) {\n              // If coming back from the Add page or fetch a new order\n              return (\n                $rootScope.orderEditItemStash?.order ||\n                order.api.orders.get($stateParams.id, {\n                  with_offer_progress: true,\n                  one_cart_enabled: oneCartService.enabled(),\n                  user_timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,\n                })\n              )\n            },\n            savedOrderItemStash($rootScope) {\n              return $rootScope.orderEditItemStash\n            },\n          },\n        },\n      },\n      onExit($rootScope) {\n        // When leaving main.account.orderHistory.order.edit remove any info stashed\n        // Info gets stashed when going to main.account.orderHistory.order.edit.append route\n        // Exit occurs when leaving main.account.orderHistory.order.edit (even leaving .append)\n        $rootScope.orderEditItemStash = null\n      },\n      resolve: {\n        title(titleService) {\n          return titleService.setTitle(langProvider.values.orderHistory)\n        },\n        setPageHeaderTitle() {\n          return title => (this.data.customPageHeaderTitle = title)\n        },\n      },\n      data: {\n        breadcrumbs: [\n          {\n            label: langProvider.values.accountDetails,\n          },\n          {\n            state: 'main.account.orderHistory',\n            label: langProvider.values.orderHistory,\n          },\n          {\n            state: 'main.account.orderHistory.order',\n            label: langProvider.values.orderDetails,\n          },\n          {\n            label: langProvider.values.orderEditItems,\n          },\n        ],\n        customPageHeaderTitle: null,\n      },\n    })\n\n    /**\n     * This works by showing fixed content over the UI and silently entering modify mode.\n     * The product cells are heavily integrated into the cart, so this was an easy way of getting\n     * them to work.\n     *\n     * - enableAddItemFlow             = Enable this flow\n     *\n     * Future work:\n     * - includeCurrentItemsInAddFlow  = Clear items in modify mode to make it seem only adding\n     */\n    $stateProvider.state('main.account.orderHistory.order.edit.append', {\n      url: '/append?search_term&page',\n      views: {\n        'fixed-content@': {\n          templateUrl: 'orderAddItems.html',\n          controller: 'OrderAddItemsController',\n          controllerAs: '$ctrl',\n        },\n      },\n      onEnter($rootScope, $state, config) {\n        // Get out of here if not coming from the edit page (i.e. no refresh allowed)\n        // Get out of here if not enabled\n        if (!$rootScope.orderEditItemStash || !config.orderHistoryView.useItemEditAddFlow) {\n          $state.go(this.data.vmExtras.PARENT_ROUTE)\n        }\n      },\n      onExit($rootScope, $state, $timeout, cartService) {\n        // Cancel modify when exiting irregularly - $timeout ensures $state is the next route\n        $timeout(() => {\n          if (\n            $state.current.name !== this.name && // Has changed route\n            !cartService.isCancellingOrderModification && // Not currently in progress of cancelling\n            $rootScope.modifyingOrder // Is modifying order still\n          ) {\n            // We clear items first because there's some kind of cart sync bug when exiting modify\n            // from a fixed view where edited items stick around, and we don't want them carrying over!\n            // (Probably related to controllers that get unloaded)\n            $rootScope.isAppLoading = true\n            cartService\n              .removeItems(cartService.cart.items)\n              .then(() => cartService.cancelOrderModification(this.data.vmExtras.PARENT_ROUTE))\n              .finally(() => ($rootScope.isAppLoading = false))\n          }\n        })\n      },\n      resolve: {\n        /* Load dependencies */\n        $lazyLoadControllers(utilService) {\n          return utilService.lazyLoadControllers({\n            OrderAddOnController: () =>\n              import(\n                /* webpackChunkName: \"orderAddOnController\", webpackPrefetch: true */ '../../orderAddOn/orderAddOnController'\n              ),\n            OrderAddItemsController: () =>\n              import(\n                /* webpackChunkName: \"orderAddItemsController\", webpackPrefetch: true */ './orderAddItemsController'\n              ),\n          })\n        },\n        $getOrder($rootScope) {\n          return (this.data.vmExtras.order = $rootScope.orderEditItemStash?.order)\n        },\n      },\n      data: {\n        /* Data captured by the account controller */\n        breadcrumbs: [\n          {\n            label: langProvider.values.accountDetails,\n          },\n          {\n            state: 'main.account.orderHistory',\n            label: langProvider.values.orderHistory,\n          },\n          {\n            state: 'main.account.orderHistory.order',\n            label: langProvider.values.orderDetails,\n          },\n          {\n            state: 'main.account.orderHistory.order.edit',\n            label: langProvider.values.edit,\n          },\n          {\n            label: langProvider.values.addItems,\n          },\n        ],\n        customPageHeaderTitle: null,\n\n        /* Data to merge into controller vm for orderAddItemsController and orderAddOnController */\n        vmExtras: {\n          isAddOnFullProductCell: true,\n          isLoading: false,\n          isOrderAddOnInline: true,\n          order: null,\n          productsPerPage: 12,\n          searchCategories: null,\n          upsellResults: [],\n          PARENT_ROUTE: 'main.account.orderHistory.order.edit',\n        },\n      },\n    })\n\n    // ORDER PURCHASE VIEW ???\n    $stateProvider.state('main.account.orderHistory.purchase', {\n      url: '/purchase/{id}',\n      views: {\n        'content@main.account': {\n          templateUrl: 'purchase.html',\n          controller: 'PurchaseController',\n          resolve: {\n            purchase(Restangular, $stateParams) {\n              return order.api.purchases.get($stateParams.id)\n            },\n          },\n        },\n      },\n      resolve: {\n        title(titleService) {\n          return titleService.setTitle(langProvider.values.inStorePurchases)\n        },\n      },\n      data: {\n        breadcrumbs: [\n          {\n            label: langProvider.values.accountDetails,\n          },\n          {\n            state: 'main.account.orderHistory',\n            label: langProvider.values.orderHistory,\n          },\n          {\n            label: langProvider.values.purchaseDetails,\n          },\n        ],\n      },\n    })\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('PasswordChangeComponentModule', [])\n\n  .config(($ocLazyLoadProvider, $stateProvider, langProvider) => {\n    $stateProvider.state('main.account.passwordChange', {\n      url: '/password',\n      views: {\n        'content@main.account': {\n          template: require('./passwordChange.html'),\n          controller: 'PasswordChangeController',\n        },\n      },\n      resolve: {\n        loadCtrl: $ocLazyLoad => {\n          return import(\n            /* webpackChunkName: \"passwordChangeController\", webpackPrefetch: true */ './passwordChangeController'\n          )\n            .then(mod => $ocLazyLoad.load(mod.default))\n            .catch(err => {\n              throw new Error(`Ooops, something went wrong, ${err}`)\n            })\n        },\n        title(titleService) {\n          return titleService.setTitle(langProvider.values.changePassword)\n        },\n      },\n      data: {\n        breadcrumbs: [\n          {\n            label: langProvider.values.accountDetails,\n          },\n          {\n            label: langProvider.values.changePassword,\n          },\n        ],\n      },\n    })\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('PriceAlertComponentModule', [])\n  .config(($stateProvider, langProvider) => {\n    $stateProvider.state('main.account.priceAlerts', {\n      url: '/price-alerts',\n      views: {\n        'content@main.account': {\n          template: require('./priceAlerts.html'),\n          controller: 'PriceAlertsController',\n        },\n      },\n      resolve: {\n        loadCtrl: $ocLazyLoad => {\n          return import(\n            /* webpackChunkName: \"priceAlertsController\", webpackPrefetch: true */ './priceAlertsController'\n          )\n            .then(mod => $ocLazyLoad.load(mod.default))\n            .catch(err => {\n              throw new Error(`Ooops, something went wrong, ${err}`)\n            })\n        },\n        title(titleService) {\n          return titleService.setTitle(langProvider.values.priceAlerts)\n        },\n      },\n      data: {\n        breadcrumbs: [\n          {\n            label: langProvider.values.accountDetails,\n          },\n          {\n            label: langProvider.values.priceAlerts,\n          },\n        ],\n      },\n    })\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('ProfileComponentModule', [])\n  .config(($stateProvider, configConstants, langProvider) => {\n    $stateProvider.state('main.account.profile', {\n      url: '/profile',\n      views: {\n        'content@main.account': configConstants.gigya.enableProfileEdit\n          ? {\n              template: require('@app/angular/optionalComponents/gigya/profileGigya.html'),\n              controller: 'ProfileGigyaController',\n            }\n          : {\n              template: require('./profile.react.html'),\n              controller: 'ProfileReactController',\n            },\n      },\n      resolve: {\n        loadCtrl: $ocLazyLoad => {\n          if (configConstants.gigya.enableProfileEdit) {\n            return import(\n              /* webpackChunkName: \"profileGigyaController\", webpackPrefetch: true */ '@app/angular/optionalComponents/gigya/profileGigyaController'\n            )\n              .then(mod => $ocLazyLoad.load(mod.default))\n              .catch(err => {\n                throw new Error(`Ooops, something went wrong, ${err}`)\n              })\n          }\n\n          return import(\n            /* webpackChunkName: \"profileReactController\", webpackPrefetch: true */ './profileController.react'\n          )\n            .then(mod => $ocLazyLoad.load(mod.default))\n            .catch(err => {\n              throw new Error(`Ooops, something went wrong, ${err}`)\n            })\n        },\n        title(titleService) {\n          return titleService.setTitle(langProvider.values.profile)\n        },\n        loyaltyCard(config, userService) {\n          if (config.profile.showLoyaltyReadOnly && !userService.loyaltyCards.length) {\n            return userService.fetchLoyaltyCards()\n          }\n        },\n      },\n      data: {\n        breadcrumbs: [\n          {\n            label: langProvider.values.accountDetails,\n          },\n          {\n            label: langProvider.values.profile,\n          },\n        ],\n      },\n    })\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('RateProductsComponentModule', [])\n  .config(($stateProvider, langProvider) => {\n    $stateProvider.state('main.account.rateProducts', {\n      url: '/rate-products',\n      views: {\n        'content@main.account': {\n          template: require('./rateProducts.html'),\n          controller: 'RateProductsController',\n        },\n      },\n      resolve: {\n        loadCtrl: $ocLazyLoad => {\n          return import(\n            /* webpackChunkName: \"rateProductsController\", webpackPrefetch: true */ './rateProductsController'\n          )\n            .then(mod => $ocLazyLoad.load(mod.default))\n            .catch(err => {\n              throw new Error(`Ooops, something went wrong, ${err}`)\n            })\n        },\n        title(titleService) {\n          return titleService.setTitle(langProvider.values.rateProducts)\n        },\n      },\n      data: {\n        breadcrumbs: [\n          {\n            label: langProvider.values.profile,\n          },\n          {\n            label: langProvider.values.rateProducts,\n          },\n        ],\n      },\n    })\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('SubscriptionComponentModule', [])\n  .config(($stateProvider, configConstants, langProvider) => {\n    $stateProvider.state('main.account.subscription', {\n      url: '/subscription?subscription_code',\n      views: {\n        'content@main.account':\n          configConstants.subscriptions?.enabled &&\n          configConstants.subscriptions?.isProfilePageEnabled\n            ? // Subscriptions V2 (React)\n              {\n                template: require('./subscription.react.html'),\n                controller: 'SubscriptionReactController',\n              }\n            : // Subscriptions V1 (Ng)\n              {\n                template: require('./subscription.ng.html'),\n                controller: 'SubscriptionNgController',\n              },\n      },\n      resolve: {\n        loadCtrl: $ocLazyLoad => {\n          if (\n            configConstants.subscriptions?.enabled &&\n            configConstants.subscriptions?.isProfilePageEnabled\n          ) {\n            return import(\n              /* webpackChunkName: \"subscriptionReactController\", webpackPrefetch: true */ './subscriptionController.react'\n            )\n              .then(mod => $ocLazyLoad.load(mod.default))\n              .catch(err => {\n                throw new Error(`Oops, something went wrong, ${err}`)\n              })\n          }\n\n          return import(\n            /* webpackChunkName: \"subscriptionController\", webpackPrefetch: true */ './subscriptionController.ng'\n          )\n            .then(mod => $ocLazyLoad.load(mod.default))\n            .catch(err => {\n              throw new Error(`Oops, something went wrong, ${err}`)\n            })\n        },\n        title(titleService) {\n          return titleService.setTitle(langProvider.values.subscription)\n        },\n      },\n      data: {\n        breadcrumbs: [\n          {\n            label: langProvider.values.accountDetails,\n          },\n          {\n            label: langProvider.values.subscription,\n          },\n        ],\n      },\n    })\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('SubstitutionsComponentModule', [])\n  .config(($stateProvider, langProvider) => {\n    $stateProvider.state('main.account.substitutions', {\n      url: '/substitutions',\n      views: {\n        'content@main.account': {\n          template: require('./substitutions.html'),\n          controller: 'SubstitutionsController',\n        },\n      },\n      resolve: {\n        loadCtrl: $ocLazyLoad => {\n          return import(\n            /* webpackChunkName: \"substitutionsController\", webpackPrefetch: true */ './substitutionsController'\n          )\n            .then(mod => $ocLazyLoad.load(mod.default))\n            .catch(err => {\n              throw new Error(`Ooops, something went wrong, ${err}`)\n            })\n        },\n        redirect($state, $timeout, eComLightService) {\n          if (eComLightService.inEComLightMode) {\n            return $timeout(() => {\n              $state.go('main.home')\n            })\n          }\n        },\n        title(titleService) {\n          return titleService.setTitle(langProvider.values.substitutionPreferences)\n        },\n      },\n      data: {\n        breadcrumbs: [\n          {\n            label: langProvider.values.accountDetails,\n          },\n          {\n            label: langProvider.values.substitutionPreferences,\n          },\n        ],\n      },\n    })\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('SnapEBTAddModalControllerModule', [])\n  .controller(\n    'SnapEBTAddModalController',\n    function ($rootScope, $scope, $uibModalInstance, config, ebtCardService, lang, mobileService) {\n      Object.assign($scope, { lang, mobileService })\n      $scope.ebtCardNumber = ''\n      $scope.validEbtCardInput = false\n      $scope.showAddError = false\n      $scope.loadingRequest = false\n\n      $scope.validateCard = () => {\n        $scope.validEbtCardInput = $scope.ebtCardNumber?.length >= 16\n      }\n\n      $scope.addCard = function () {\n        $scope.loadingRequest = true\n        $scope.showAddError = false\n\n        ebtCardService\n          .addCard($scope.ebtCardNumber)\n          .then(() => {\n            $uibModalInstance.close()\n          })\n          .catch(() => {\n            $scope.showAddError = true\n          })\n          .finally(() => {\n            $scope.loadingRequest = false\n          })\n      }\n    }\n  )\n","import angular from 'angular'\n\nexport default angular\n  .module('SnapEBTRemoveModalControllerModule', [])\n  .controller(\n    'SnapEBTRemoveModalController',\n    function (\n      $rootScope,\n      $scope,\n      $uibModalInstance,\n      config,\n      ebtCardService,\n      lang,\n      mobileService,\n      userAnalytics\n    ) {\n      $scope.deactivateEbtFailed = false\n\n      Object.assign($scope, { config, lang, mobileService })\n\n      const handleRemoveError = () => {\n        $scope.deactivateEbtFailed = true\n      }\n\n      const handleRemoveSuccess = () => {\n        userAnalytics.logUserRemoveEbtCard()\n        $scope.deactivateEbtFailed = false\n        $uibModalInstance.close()\n      }\n\n      $scope.removeEbtCard = () => {\n        return ebtCardService.removeEbtCard().then(handleRemoveSuccess).catch(handleRemoveError)\n      }\n    }\n  )\n","import angular from 'angular'\nimport SnapEBTAddModalController from './snapEBTAddModalController'\nimport SnapEBTRemoveModalController from './snapEbtRemoveModalController'\n\nexport default angular\n  .module('SnapEBTComponentModule', [\n    SnapEBTAddModalController.name,\n    SnapEBTRemoveModalController.name,\n  ])\n  .config(($stateProvider, langProvider) => {\n    $stateProvider.state('main.account.snapEBT', {\n      url: '/snap-ebt',\n      views: {\n        'content@main.account': {\n          template: require('./views/snapEBT.html'),\n          controller: 'SnapEBTController',\n        },\n      },\n      resolve: {\n        loadCtrl: $ocLazyLoad => {\n          return import(\n            /* webpackChunkName: \"snapEBTController\", webpackPrefetch: true */ './snapEBTController'\n          )\n            .then(mod => $ocLazyLoad.load(mod.default))\n            .catch(err => {\n              throw new Error(`Ooops, something went wrong, ${err}`)\n            })\n        },\n        title(titleService) {\n          return titleService.setTitle(langProvider.values.ebt.EBTSNAP)\n        },\n      },\n      data: {\n        breadcrumbs: [\n          {\n            label: langProvider.values.accountDetails,\n          },\n          {\n            label: langProvider.values.ebt.EBTSNAP,\n          },\n        ],\n      },\n    })\n  })\n","import angular from 'angular'\n\nimport AddressBook from './addressBook/addressBookRoutes'\nimport Credits from './credits/creditsRoutes'\nimport Lists from './lists/listRoutes'\nimport Loyalty from './loyalty/loyaltyRoutes'\nimport Nav from './nav/accountRoutes'\nimport Notifications from './notifications/notificationsRoutes'\nimport Orderhistory from './orderHistory/orderHistoryRoutes'\nimport Passwordchange from './passwordChange/passwordChangeRoutes'\nimport Pricealerts from './priceAlerts/priceAlertsRoutes'\nimport Profile from './profile/profileRoutes'\nimport Rateproducts from './rateProducts/rateProductsRoutes'\nimport Subscription from './subscription/subscriptionsRoutes'\nimport Substitutions from './substitutions/substitutionsRoutes'\nimport SnapEBT from './snapEBT/snapEBTRoutes'\n\nexport default angular.module('app.component.accountModule', [\n  AddressBook.name,\n  Credits.name,\n  Lists.name,\n  Loyalty.name,\n  Nav.name,\n  Notifications.name,\n  Orderhistory.name,\n  Passwordchange.name,\n  Pricealerts.name,\n  Profile.name,\n  Rateproducts.name,\n  Subscription.name,\n  Substitutions.name,\n  SnapEBT.name,\n])\n","import _ from 'lodash'\nimport angular from 'angular'\n\nexport default angular\n  .module('AddressValidationModalControllerModule', [])\n  .controller(\n    'AddressValidationModalController',\n    function AddressValidationModalController(\n      $rootScope,\n      $state,\n      $uibModalInstance,\n      auth,\n      compareCartService,\n      errorModalService,\n      isValid,\n      lang,\n      originalAddress,\n      recommendedAddresses\n    ) {\n      const vm = this\n      vm.lang = lang\n\n      vm.isValid = isValid\n      vm.recommendedAddresses = recommendedAddresses\n      vm.originalAddress = _.mapValues(originalAddress, field => {\n        return {\n          value: field,\n        }\n      })\n\n      // Init selectedAddress model for use in radio checkbox\n      vm.selectedAddress = {\n        address:\n          vm.isValid && vm.recommendedAddresses.length > 0\n            ? vm.recommendedAddresses[0]\n            : vm.originalAddress,\n      }\n\n      vm.editAddress = () => {\n        if (originalAddress) {\n          $rootScope.$broadcast('editAddressItem', {\n            itemId: originalAddress.id,\n            initialAddress: originalAddress,\n          })\n        }\n        $uibModalInstance.dismiss()\n      }\n\n      vm.confirmSelectedAddress = () => {\n        // map selectedAddress vm object to usable payload for update user endpoint\n        // if value is not present, set to undefined for JSON.stringify compare\n        const selectedAddressPayload = {\n          address1: vm.selectedAddress.address.address1\n            ? vm.selectedAddress.address.address1.value\n            : undefined,\n          address2: vm.selectedAddress.address.address2\n            ? vm.selectedAddress.address.address2.value\n            : undefined,\n          address3: vm.selectedAddress.address.address3\n            ? vm.selectedAddress.address.address3.value\n            : undefined,\n          city: vm.selectedAddress.address.city ? vm.selectedAddress.address.city.value : undefined,\n          postal_code: vm.selectedAddress.address.postal_code\n            ? vm.selectedAddress.address.postal_code.value\n            : undefined,\n          province: vm.selectedAddress.address.province\n            ? vm.selectedAddress.address.province.value\n            : undefined,\n        }\n\n        const updatedAddress = {\n          delivery_address: _.assign(angular.copy(originalAddress), selectedAddressPayload),\n        }\n\n        $uibModalInstance.close(updatedAddress)\n      }\n    }\n  )\n","export const ADDRESS_FIELDS = {\n  ADDRESS_LINE_ONE: 'address1',\n  ADDRESS_LINE_TWO: 'address2',\n  ADDRESS_LINE_THREE: 'address3',\n  CITY: 'city',\n  FIRST_NAME: 'first_name',\n  INSTRUCTIONS: 'instructions',\n  LAST_NAME: 'last_name',\n  PHONE_NUMBER: 'phone_number',\n  POSTAL_CODE: 'postal_code',\n  PROVINCE: 'province',\n}\n\nexport const COUNTRIES = {\n  USA: 'USA',\n  CAN: 'CAN',\n}\n\nexport const COUNTRY_DIAL_CODES = {\n  [COUNTRIES.USA]: '+1',\n  [COUNTRIES.CAN]: '+1',\n}\n\nexport const QUEBEC_POSTAL_DISTRICT_LETTERS = ['G', 'H', 'J']\n","import _ from 'lodash'\nimport angular from 'angular'\nimport { user } from '@instacart/enterprise-services'\nimport { ADDRESS_FIELDS } from '@app/angular/constants/address'\n\nimport template from './views/addressValidationModal.html'\n\nexport default angular\n  .module('AddressValidationServiceModule', [])\n  .service(\n    'addressValidationService',\n    function addressValidationService($uibModal, ngPromise, utilService) {\n      const service = this\n      const ADDRESS_KEYS = [\n        ADDRESS_FIELDS.PROVINCE,\n        ADDRESS_FIELDS.POSTAL_CODE,\n        ADDRESS_FIELDS.CITY,\n        ADDRESS_FIELDS.ADDRESS_LINE_ONE,\n        ADDRESS_FIELDS.ADDRESS_LINE_TWO,\n      ]\n\n      service.openModal = addressData => {\n        return $uibModal.open({\n          template,\n          controller: 'AddressValidationModalController',\n          keyboard: true,\n          backdrop: true,\n          controllerAs: '$ctrl',\n          resolve: {\n            originalAddress: () => addressData.original,\n            recommendedAddresses: () => addressData.recommended,\n            isValid: () => addressData.isValid,\n          },\n        }).result\n      }\n\n      //  validateAddress - Accepts a JSON object that contains the customers address and returns\n      //  a flag to identify if it is valid, and an array of suggested addresses\n      //  example input addressObject\n      //  {\n      //  \"address1\": \"101 S, W Compton Blvd\",\n      //  \"address2\": \"123\",\n      //  \"city\": \"comptonnne\",\n      //  \"province\": \"CAliforn-i-eh\",\n      //  \"postal_code\": \"90220\"\n      //  }\n      //\n      //  returns:\n      //  { \"is_valid\": true,\n      //    \"suggestions\": [{\"address1\": \"# 123\",\n      //                    \"address2\": \"101 W COMPTON BLVD\",\n      //                    \"city\": \"COMPTON\",\n      //                    \"postal_code\": \"90220\",\n      //                    \"province\": \"CA\"}]\n      // }\n      const validateAddress = ngPromise.wrapper(user.api.userAddresses.validate)\n      service.validateAddress = addressObject => validateAddress(addressObject)\n\n      service.areAddressesSame = (firstAddress, secondAddress) => {\n        return _.every(ADDRESS_KEYS, key => firstAddress[key] === secondAddress[key])\n      }\n\n      service.createRecommendationsList = (suggestions, currentAddress) => {\n        return _.map(suggestions, suggestedAddress => {\n          const addressDiffObject = utilService.stringDiff(currentAddress, suggestedAddress)\n          const noDiffs = _.every(addressDiffObject, addressValue => {\n            return !addressValue.changed\n          })\n\n          if (!noDiffs) {\n            return addressDiffObject\n          }\n        }).filter(Boolean)\n      }\n\n      /**\n       * Validates if a given *address* is complete when\n       * compared agains a list of *optionalFields*\n       * @param {object} - address\n       * @param {string[]} - optionalFields\n       *\n       * @returns {boolean}\n       */\n      service.isAddressComplete = (address = {}, optionalFields = []) => {\n        const REQUIRED_FIELDS = [\n          ADDRESS_FIELDS.ADDRESS_LINE_ONE,\n          ADDRESS_FIELDS.CITY,\n          ADDRESS_FIELDS.FIRST_NAME,\n          ADDRESS_FIELDS.LAST_NAME,\n          ADDRESS_FIELDS.PHONE_NUMBER,\n          ADDRESS_FIELDS.POSTAL_CODE,\n          ADDRESS_FIELDS.PROVINCE,\n        ]\n\n        const filteredRequiredFields = REQUIRED_FIELDS.filter(\n          field => !optionalFields.includes(field)\n        )\n\n        return filteredRequiredFields.filter(addressKey => !address[addressKey]).length === 0\n      }\n    }\n  )\n","import angular from 'angular'\n\nimport AddressValidationModalController from './addressValidationModalController.js'\nimport AddressValidationService from './addressValidationService.js'\n\nexport default angular.module('app.component.addressValidationModule', [\n  AddressValidationModalController.name,\n  AddressValidationService.name,\n])\n","import angular from 'angular'\nimport * as storage from '@app/utils/storage'\nimport template from './alert.html'\n\nconst ALERT_CLOSE_STORE_KEY = 'alert_closes'\n\nconst ALERT_ICON_MAP = {\n  'warn-light': 'icon-warning',\n  'info-positive': 'icon-info-i',\n}\n\nexport default angular.module('AlertComponentModule', []).component('alert', {\n  transclude: true,\n  bindings: {\n    /** { string } - The type as defined by ALERT_ICON_MAP above */\n    type: '@',\n\n    /** [{ boolean }] - Enables this notice to be closed */\n    closeable: '@?',\n    /** [{ boolean }] - Set to true to disable the border */\n    disableBorder: '@?',\n    /** [{ string }] - Custom icon to use */\n    icon: '@?',\n    /** [{ string }] - Custom css class to add on */\n    noticeClass: '@',\n    /** [{ function }] - Callback when the alert is closed */\n    onClose: '&?',\n    /** [{ string }] - Keeps the closed status in localStorage via this ID */\n    rememberCloseStatusById: '@?',\n    /** [{ boolean }] - Set to true for small text */\n    smallText: '@?',\n  },\n  template,\n  controller($q) {\n    const storageService = storage.getInstance()\n\n    this.$onInit = () => {\n      this.icon = ALERT_ICON_MAP[this.type] || this.icon\n\n      isAlertVisible(this).then(isVisible => (this.isVisible = isVisible))\n    }\n\n    this.close = () => {\n      this.isVisible = false\n      if (this.onClose) this.onClose()\n\n      if (this.rememberCloseStatusById) {\n        storageService.setItem(\n          ALERT_CLOSE_STORE_KEY,\n          JSON.stringify([this.rememberCloseStatusById, ...this.alreadyClosedArray])\n        )\n      }\n    }\n\n    function isAlertVisible(context) {\n      if (context.rememberCloseStatusById) {\n        return storageService\n          .getItem(ALERT_CLOSE_STORE_KEY)\n          .then(value => {\n            context.alreadyClosedArray = value || []\n            const isClosed = context.alreadyClosedArray.includes(context.rememberCloseStatusById)\n            if (isClosed && context.onClose) {\n              context.onClose()\n            }\n            return !isClosed\n          })\n          .catch(() => true)\n      }\n\n      return $q.resolve(true)\n    }\n  },\n})\n","import angular from 'angular'\nimport Alert from './alert.js'\n\nexport default angular.module('app.component.alert', [Alert.name])\n","import angular from 'angular'\nimport throttle from 'lodash/throttle'\nimport ResizeObserver from 'resize-observer-polyfill'\n\nexport default angular.module('UnataCarouselModule', []).component('unataCarousel', {\n  restrict: 'E',\n  transclude: true,\n  bindings: {\n    name: '<',\n  },\n\n  controller($element, $scope, $timeout, $window, lang, mobileService) {\n    this.lang = lang\n\n    const container = $element[0]\n    const content = container.querySelector('ng-transclude')\n\n    const parseScrollLeft = () =>\n      -parseInt(content.style.transform.replace(/^translateX\\((.+)\\)/, '$1'), 10) || 0\n\n    const queryCells = () => [...content.querySelectorAll('.cell-wrapper')]\n\n    const queryFocusableElements = element =>\n      element.querySelectorAll(\n        'a, button, input, textarea, select, details, [tabindex]:not([tabindex=\"-1\"])'\n      )\n\n    const updateCells = (direction, focusFirst) => {\n      const cells = queryCells()\n      if (!cells.length) {\n        return\n      }\n\n      const minOffset = direction !== undefined && direction < 0 ? -container.clientWidth : 0\n      const maxOffset = (direction !== undefined && direction > 0 ? 2 : 1) * container.clientWidth\n      const scrollLeft = parseScrollLeft()\n      let firstCell\n      cells.forEach(cell => {\n        const cellOffset = cell.offsetLeft - scrollLeft\n        const hidden = cellOffset + cell.offsetWidth < minOffset || cellOffset > maxOffset\n        const wasHidden = cell.getAttribute('aria-hidden') === 'true'\n\n        // Hide cells outside of the carousel viewport for a11y.\n        if (hidden !== wasHidden) {\n          cell.setAttribute('aria-hidden', hidden)\n          cell.style.visibility = hidden ? 'hidden' : ''\n        }\n\n        if (direction !== undefined) {\n          return\n        }\n\n        const partiallyHidden =\n          (cellOffset < minOffset || cellOffset + cell.offsetWidth > maxOffset) && !hidden\n        if (partiallyHidden || cell.dataset.partiallyHidden === 'true') {\n          if (partiallyHidden) {\n            cell.dataset.partiallyHidden = true\n          } else {\n            delete cell.dataset.partiallyHidden\n          }\n\n          // Make partially visible cells unfocusable for a11y.\n          const elements = queryFocusableElements(cell)\n          ;[...elements].forEach(element => {\n            if (partiallyHidden) {\n              element.dataset.tabIndex = element.tabIndex\n              element.tabIndex = -1\n            } else {\n              element.tabIndex = Number(element.dataset.tabIndex)\n              delete element.dataset.tabIndex\n            }\n          })\n        }\n\n        if (!hidden && !partiallyHidden) {\n          firstCell ??= cell\n        }\n      })\n\n      if (focusFirst && firstCell) {\n        // Focus the first visible cell after scrolling for a11y.\n        const elements = queryFocusableElements(firstCell)\n        elements[0]?.focus()\n      }\n    }\n\n    const updateButtons = () => {\n      const scrollLeft = parseScrollLeft()\n      $scope.$applyAsync(() => {\n        this.showPrevious = scrollLeft > 0\n        this.showNext = scrollLeft < content.offsetWidth - container.clientWidth\n      })\n    }\n\n    const update = (...args) => {\n      updateCells(...args)\n      updateButtons()\n    }\n\n    let slideTimeout\n    this.slide = direction => {\n      const cells = queryCells()\n\n      const scrollLeft = parseScrollLeft()\n      let offset\n      if (cells.length) {\n        if (direction < 0) {\n          cells.reverse()\n        }\n        let cellOffset\n        cells.forEach(cell => {\n          if (offset !== undefined) {\n            return\n          }\n          cellOffset = (cell.offsetLeft - scrollLeft) * direction\n          if (cellOffset + cell.offsetWidth > container.clientWidth) {\n            offset = cellOffset\n          }\n        })\n        offset ??= cellOffset\n      } else {\n        offset = container.clientWidth\n      }\n\n      updateCells(direction)\n\n      slideTimeout = $timeout(() => {\n        $timeout.cancel(slideTimeout)\n\n        update(undefined, direction > 0)\n      }, 300)\n\n      let translateX = scrollLeft + offset * direction\n      translateX = Math.max(translateX, 0)\n      translateX = Math.min(translateX, content.offsetWidth - container.clientWidth)\n      content.style.transform = `translateX(${-translateX}px)`\n    }\n\n    if (!mobileService.isMobile) {\n      const mutationObserver = new MutationObserver(mutations => {\n        if (\n          !mutations.some(({ addedNodes }) =>\n            [...addedNodes].some(({ nodeType }) => nodeType === Node.ELEMENT_NODE)\n          )\n        ) {\n          return\n        }\n\n        mutationObserver.disconnect()\n        update()\n      })\n      mutationObserver.observe(content, { childList: true })\n\n      const resizeObserver = new ResizeObserver(() => {\n        update()\n      })\n      resizeObserver.observe(content)\n\n      const onResize = throttle(() => {\n        update()\n      }, 1000)\n      $window.addEventListener('resize', onResize)\n      $scope.$on('$destroy', () => {\n        $window.removeEventListener('resize', onResize)\n      })\n    }\n  },\n\n  template: `\n    <section aria-label=\"{{::$ctrl.name}} {{::$ctrl.lang.aria.carousel}}\">\n      <p class=\"screen-reader-text\">{{::$ctrl.lang.aria.carouselInstructions}}</p>\n      <button\n        class=\"carousel-button carousel-button-previous icon-chevron-left\"\n        ng-class=\"{'carousel-hidden': !$ctrl.showPrevious}\"\n        arial-label=\"{{::$ctrl.lang.aria.previous}}\"\n        title=\"{{::$ctrl.lang.aria.previous}}\"\n        ng-click=\"$ctrl.slide(-1)\"\n      ></button>\n      </span>\n      <ng-transclude></ng-transclude>\n      <span\n        class=\"carousel-overlay\"\n        ng-class=\"{'carousel-hidden': !$ctrl.showNext}\"\n      ></span>\n      <button\n        class=\"carousel-button carousel-button-next icon-chevron-right\"\n        ng-class=\"{'carousel-hidden': !$ctrl.showNext}\"\n        arial-label=\"{{::$ctrl.lang.values.next}}\"\n        title=\"{{::$ctrl.lang.values.next}}\"\n        ng-click=\"$ctrl.slide(1)\"\n      ></button>\n    </section>\n  `,\n})\n","import angular from 'angular'\nimport Carousel from './carousel.js'\n\nexport default angular.module('app.component.carouselModule', [Carousel.name])\n","import angular from 'angular'\n\nexport default angular.module('chatIntegration', []).run(function ($window, config) {\n  const head = document.head || document.getElementsByTagName('head')\n\n  // Custom Watson code\n  const initWatson = () => {\n    $window.loadWatsonAssistantChat(config.chatIntegration.parameters).then(function (instance) {\n      instance.render()\n    })\n  }\n\n  // Custom bot copy code\n  const initBotCopy = onLoadCallback => {\n    const outerScriptTag = document.createElement('script')\n\n    // Set parameters on the outerscript tag\n    if (config.chatIntegration.parameters) {\n      Object.keys(config.chatIntegration.parameters).forEach(param => {\n        outerScriptTag.setAttribute(param, config.chatIntegration.parameters[param])\n      })\n    }\n\n    outerScriptTag.onload = onLoadCallback\n    head.insertBefore(outerScriptTag, head.firstChild)\n\n    // Load second script tag inside outer tag pointing to src.\n    const scriptTag = document.createElement('script')\n    scriptTag.src = config.chatIntegration.scriptSrc\n    scriptTag.type = 'text/javascript'\n    scriptTag.async = true\n    outerScriptTag.appendChild(scriptTag)\n  }\n\n  // Injects parameters from chatIntegration.parameters to attributes on the\n  // script element; possibly unsafe\n  const DATA_ATTR_REGEX = /^data-(.*)$/\n\n  const parametersToAttributes = el => {\n    if (!config.chatIntegration.parameters) {\n      return\n    }\n\n    Object.keys(config.chatIntegration.parameters).forEach(key => {\n      if (key === 'id' || DATA_ATTR_REGEX.test(key)) {\n        el.setAttribute(key, config.chatIntegration.parameters[key])\n      }\n    })\n  }\n\n  // Generic script load function\n  const loadScript = ({ onLoadCallback, attributesCallback }) => {\n    const scriptTag = document.createElement('script')\n    scriptTag.src = config.chatIntegration.scriptSrc\n\n    if (onLoadCallback) {\n      scriptTag.onload = onLoadCallback\n    }\n\n    if (attributesCallback) {\n      attributesCallback(scriptTag)\n    }\n\n    head.insertBefore(scriptTag, head.firstChild)\n  }\n\n  const start = () => {\n    switch (config.chatIntegration.type) {\n      case 'botcopy':\n        initBotCopy()\n        break\n      case 'watson':\n        loadScript({ onLoadCallback: initWatson })\n        break\n      case 'rasa':\n        loadScript({ attributesCallback: parametersToAttributes })\n        break\n    }\n  }\n\n  if (config.chatIntegration?.enabled) start()\n})\n","import angular from 'angular'\nimport chatIntegrationModule from './chatIntegration.js'\n\nexport default angular.module('app.component.chatIntegration', [chatIntegrationModule.name])\n","import angular from 'angular'\nimport { ACTIONS } from '@app/angular/constants/recaptcha'\n\nexport default angular\n  .module('DefaultPaymentServiceModule', [])\n  .config(paymentGatewayProvider => {\n    paymentGatewayProvider.registerGateway({\n      name: 'Cash',\n      key: 'cash',\n      serviceName: 'defaultPayments',\n      noSettingsRequired: true,\n    })\n\n    paymentGatewayProvider.registerGateway({\n      name: 'Credit Card',\n      key: 'credit',\n      serviceName: 'defaultPayments',\n      noSettingsRequired: true,\n    })\n\n    paymentGatewayProvider.registerGateway({\n      name: 'Debit',\n      key: 'debit',\n      serviceName: 'defaultPayments',\n      noSettingsRequired: true,\n    })\n  })\n\n  .service(\n    'defaultPayments',\n    function defaultPayments(\n      $q,\n      $rootScope,\n      $state,\n      $timeout,\n      Restangular,\n      analytics,\n      checkoutAnalytics,\n      config\n    ) {\n      const service = this\n\n      service.status = { loaded: false, ready: true }\n\n      service.checkout = function (payment, optionalData = {}) {\n        return Restangular.one('orders')\n          .post(null, payment)\n          .then(order => {\n            const { postCheckoutRoute } = optionalData\n            // don't call analytics on a modified order\n            if (!$rootScope.modifyingOrder) {\n              analytics.logCheckoutStep(5, payment.payment_type, order.order_items)\n              analytics.logCheckoutCompletion(order)\n              analytics.logCriteoOrderConfirmation({ id: order.id, orderItems: order.order_items })\n              checkoutAnalytics.placeOrderClick({ order, success: true })\n              analytics.logFBPurchase(order)\n            }\n\n            $state.go(postCheckoutRoute || 'main.checkout.confirmation', { orderId: order.id })\n\n            return order\n          })\n          .catch(err => {\n            checkoutAnalytics.placeOrderClick({ order: null, success: false })\n            throw err\n          })\n      }\n\n      /**\n       * Shared logic for initializing recaptcha\n       *\n       * @param {function | object} recaptchaSetupCallbackOrObject\n       *        - Function that accepts a setup object with attribs values for <recaptcha-checkbox>.\n       *        - Or an object that will have that setup object merged into it.\n       *        - It will not be called or updated if recaptcha is off for payments.\n       *\n       * @returns {Promise<null | object>}\n       *          - Returns a promise that resolves with the recaptcha info, or null if not enabled\n       */\n      service.initializeRecaptcha = function (recaptchaSetupCallbackOrObject) {\n        return $q((resolve, reject) => {\n          const { paymentsEnabled, siteKey } = config.googleRecaptcha || {}\n          if (paymentsEnabled) {\n            const recaptchaException = new Error('Recaptcha error - payments') // For potential errors\n\n            // Setup object with angular attribs for the recaptcha component\n            const setupObj = {\n              show: true,\n              action: ACTIONS.CHECKOUT,\n              onRecaptchaSuccess: token => resolve({ token, siteKey }),\n              onRecaptchaExpired: () => {\n                recaptchaException.isRecaptchaError = true\n                reject(recaptchaException)\n              },\n            }\n\n            // If recaptchaSetupCallbackOrObject is a function, call it, and IF it returns a promise\n            // listen for reject, pass on that reject. This is useful for modal dismissal.\n            if (typeof recaptchaSetupCallbackOrObject === 'function') {\n              const optionalPromise = recaptchaSetupCallbackOrObject(setupObj)\n              if (typeof optionalPromise?.catch === 'function') {\n                optionalPromise.catch(() => {\n                  recaptchaException.isRecaptchaAbort = true\n                  reject(recaptchaException)\n                })\n              }\n            } else {\n              Object.assign(recaptchaSetupCallbackOrObject, setupObj)\n            }\n          } else {\n            resolve(null)\n          }\n        })\n      }\n    }\n  )\n","import angular from 'angular'\nimport template from './paypal.html'\nimport templateCheckout from './paypalCheckout.html'\n\nconst REDIRECT_KEY = 'paypalErrorRedirect'\n\nexport default angular\n  .module('PayPalGatewayComponentModule', [])\n  .config(($stateProvider, paymentGatewayProvider) => {\n    paymentGatewayProvider.registerGateway({\n      name: 'PayPal',\n      key: 'paypal',\n      template: templateCheckout,\n      serviceName: 'paypalPayment',\n      noSettingsRequired: true,\n      newCheckoutCssClass: 'provider-generic_styling',\n    })\n\n    $stateProvider.state('main.checkout.paypal', {\n      url: '/paypal?session-token&paymentId&PayerID&token',\n      views: {\n        checkout: {\n          template,\n        },\n      },\n      onEnter(\n        $rootScope,\n        $state,\n        $timeout,\n        $window,\n        addressList,\n        analytics,\n        auth,\n        checkoutAnalytics,\n        config,\n        errorModalService,\n        localStorageService,\n        Restangular\n      ) {\n        $timeout(() => {\n          // Utility function to handle any of the various errors that can occur in this process\n\n          const handleError = function (response) {\n            errorModalService\n              .open(response.data ? response.data.message : response.message, 'OK')\n              .finally(() => {\n                const state = localStorageService.deprecatedGet(REDIRECT_KEY)\n                $state.go(state || 'main.checkout.payment')\n              })\n\n            checkoutAnalytics.placeOrderClick({ order: null, success: false })\n          }\n\n          let paymentId = window.location.href.match(/paymentId=([\\w-]+)/)\n          if (paymentId) {\n            paymentId = paymentId[1]\n          }\n\n          let payerId = window.location.href.match(/PayerID=([\\w]+)/)\n          if (payerId) {\n            payerId = payerId[1]\n          }\n\n          const ordersParams = {\n            payment_type: 'paypal',\n            paypal: {\n              payment_id: paymentId,\n              payer_id: payerId,\n              return_url: $window.location.href,\n            },\n          }\n          if (config.enableMultipleDeliveryAddresses) {\n            const context = auth.getContext()\n            if (context.intent === 'delivery') {\n              ordersParams.delivery_address = addressList.getAddressFromId(context.address_id)\n            }\n          }\n          Restangular.one('orders')\n            .post(null, ordersParams)\n            .then(order => {\n              // don't call analytics on a modified order\n              if (!$rootScope.modifyingOrder) {\n                analytics.logCheckoutStep(5, 'paypal', order.order_items)\n                analytics.logCheckoutCompletion(order)\n                analytics.logCriteoOrderConfirmation({\n                  id: order.id,\n                  orderItems: order.order_items,\n                })\n\n                checkoutAnalytics.placeOrderClick({ order, success: true })\n                analytics.logFBPurchase(order)\n              }\n              $state.go('main.checkout.confirmation', { orderId: order.id }, { reload: true })\n            }, handleError) // If checkout is unsuccessful, show an error\n        })\n      },\n    })\n  })\n\n  .service('paypalPayment', function paypalPayment($q, $state, $window, localStorageService) {\n    const service = this\n\n    service.status = { loaded: true, ready: true }\n\n    service.checkout = function (payment, response) {\n      const deferred = $q.defer()\n\n      localStorageService.deprecatedSet(REDIRECT_KEY, $state.current.name)\n      // In checkout v2 the paypal object is on response.response\n      payment.paypal = response.paypal || response.response.paypal // Update paypal URL\n      $window.location = payment.paypal.approval_url\n\n      return deferred.promise\n    }\n  })\n","import angular from 'angular'\nimport template from './houseAccount.html'\n\nexport default angular\n  .module('HouseAccountPaymentServiceModule', [])\n  .config(paymentGatewayProvider => {\n    paymentGatewayProvider.registerGateway({\n      name: 'House Account',\n      key: 'house_account',\n      template,\n      serviceName: 'houseAccountPayment',\n      newCheckoutCssClass: 'provider-generic_styling',\n    })\n  })\n\n  .service('houseAccountPayment', function houseAccountPayment($q, defaultPayments) {\n    const service = this\n\n    service.status = { loaded: true }\n\n    service.checkout = defaultPayments.checkout\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('HouseAccountControllerModule', [])\n  .controller(\n    'HouseAccountController',\n    function ($scope, config, houseAccountPayment, lang, reservationService) {\n      $scope.config = config\n\n      if (!$scope.payment.house_account) {\n        $scope.payment.house_account = {}\n      }\n\n      $scope.$watch('payment.house_account.id', () => {\n        houseAccountPayment.status.ready =\n          !!$scope.payment.house_account && !!$scope.payment.house_account.id\n      })\n\n      const fulfillment_type = reservationService.reservation?.timeslot?.fulfillment_type\n      const digitLength = config.maxHouseAccountLength\n\n      $scope.inputPlaceHolder = config.shouldValidateHouseAccount\n        ? lang.template(lang.values.houseAccountDigits, { digitLength })\n        : lang.values.paymentTypes.house_account[fulfillment_type]\n\n      $scope.inputPattern = config.houseAccountRegexPattern\n        ? new RegExp(config.houseAccountRegexPattern)\n        : ''\n    }\n  )\n","// decoratorTarget.initializer is a special function used to construct an instance of the decorated function.\n// Think of it as a \"meta function\"\n\nexport const REFLECTION = {\n  DECORATORS: {\n    /**\n     * Accepts a decorator target if the target is a function, and wraps the original function in your own function\n     * You can access the original function inside your wrapped function like so: `this.originalFn`\n     * For example: `return this.originalFn.apply(this, arguments);` to do a normal call!\n     *\n     * @param decoratorTarget {object}    - The target function field definition as is passed by the decorator mechanism\n     * @param wrappingFn      {function}  - The function that will wrap the original function\n     *\n     * @example\n      export const MyDecorator = (...decoratorArgs) => {\n        return (targetFn) => {\n          REFLECTION.DECORATORS.wrapOriginalFn(targetFn, function myWrapper(...expectArgs) {\n            // Do something custom\n\n            // Call the original function (if wanted)\n            return this.originalFn.apply(this, arguments);\n          });\n        };\n      };\n     *\n     *\n     */\n    wrapOriginalFn: (decoratorTarget, wrappingFn) => {\n      const _initializer = decoratorTarget?.initializer\n\n      if (!_initializer) {\n        throw new Error('Unexpected decorator definition: Missing target or initializer!')\n      }\n\n      decoratorTarget.initializer = function () {\n        const originalFn = _initializer.apply(this, arguments)\n\n        if (!originalFn || typeof originalFn !== 'function') {\n          throw new Error(\n            'Unexpected decorator definition: Was expecting a function to be decorated!'\n          )\n        }\n\n        return (...args) => {\n          const that = {\n            callOriginalFn: (customThis = this, customArgs = args) =>\n              originalFn.apply(customThis, customArgs),\n            originalThis: this,\n          }\n          return wrappingFn.apply(that, args)\n        }\n      }\n    },\n  },\n}\n","import angular from 'angular'\nimport { v4 as uuidv4 } from 'uuid'\nimport { REFLECTION } from '@app/angular/services/reflect'\n// TODO: Fix me\n// eslint-disable-next-line import/no-cycle\nimport { EVENTS } from '@app/angular/services/modules/analytics/analyticsConstants'\n\nexport const REFRESH_MS = 500\nexport const STORE_TIMEOUT_MS = 1000 * 60 * 5\n\n/**\n * A useful \"SUCCESS\" analytic that can be included with your analytics constants - automatically optional!\n */\nconst SUCCESS = 'success'\nconst AUTO_SUCCESS = sources => (SUCCESS in sources ? { success: sources[SUCCESS] } : {})\n\n/**\n * \"@Requirements\"\n * A decorator to check the requirements of analytic methods are present\n * This wraps the original function in a parent function that detects if the requirements are there before proceeding\n *\n * @param {[string]} requirements[<string>]    - A list of source requirements\n *\n * @example\n   class CART_ANALYTICS {\n     @Requirements(SOURCES.CART)\n     INFO_ANALYTICS = (sources) => ({ cart: etc(sources[SOURCES.CART]) });\n     ...\n *\n */\nexport const Requirements = (...requirements) => {\n  return targetFn => {\n    const pluralReqs = targetFn.initializer.pluralRequirements || {}\n\n    REFLECTION.DECORATORS.wrapOriginalFn(targetFn, function (source = {}) {\n      requirements.forEach(requirement => {\n        if (!(requirement in source) && !(pluralReqs[requirement] in source)) {\n          throw new Error(`\\nMissing source for checkout analytics! Expected: \"${requirement}\"`)\n        }\n      })\n\n      return this.callOriginalFn()\n    })\n\n    targetFn.initializer.pluralRequirements = null\n  }\n}\n\n/**\n * \"@Plural\"\n * A decorator to allow analytical functions to process plural versions of the source input\n * This wraps the original function in a parent function that detects if a plural source key word is present\n * If it detects a plural source key word, it then triggers the original function multiple times, flattens the result\n * and outputs it in a plural analytics keyword (captures the key used and adds the pluralPostix etc)\n *\n * @param {string} sourceItemKey              - The key used for a single source item as normal\n * @param {function} [pluralPostixFn = s]     - The postfix to add to the keys for plural keys, defaults to 's'\n * @param {function} [destPluralPostixFn]     - [optional] If you want a separate plural key for payloads\n *\n * NOTE: Most plurals in EN are simply \"+s\", in which case do not specify the last two parameters (see examples below)\n *\n * @example 1 - **Basic example**\n   class OFFER_ANALYTICS {\n     // OFFER_DETAILS will now support SOURCES.OFFER + \"s\" array input, and output array \"offers\"\n     // \"offers\" --> [\"offer\"] ~~~PROCESSING~~~> [\"offer\"] --> \"offers\"\n     @Plural(SOURCES.OFFER)\n     @Requirements(SOURCES.OFFER)\n      OFFER_DETAILS = (sources) => ({ offer         : getOfferDetails(sources[SOURCES.OFFER]) })\n   }\n *\n * @example 2 - **Complex example (using custom keys)**\n   class OFFER_ANALYTICS {\n     // OFFER_DETAILS will now support SOURCES.OFFER + \"ies\" array input, and output array \"offeres\"\n     // \"offeries\" --> [\"offer\"] ~~~PROCESSING~~~> [\"offer\"] --> \"offeres\"\n     // If you prefer, you can use the second parameter for both in and out keys, as the last parameter is optional\n     @Plural(SOURCES.OFFER, (key) => `${key}ies`, (key) => `${key}es`)\n     @Requirements(SOURCES.OFFER)\n      OFFER_DETAILS = (sources) => ({ offer         : getOfferDetails(sources[SOURCES.OFFER]) })\n   }\n *\n */\nexport const Plural = (\n  sourceItemKey,\n  pluralPostixFn = key => `${key}s`,\n  destPluralPostixFn = null\n) => {\n  const sourcePluralKey = pluralPostixFn(sourceItemKey)\n\n  return targetFn => {\n    if (targetFn.initializer.pluralRequirements === null) {\n      throw new Error('@Plural must come after @Requirements')\n    }\n\n    REFLECTION.DECORATORS.wrapOriginalFn(targetFn, function (sources = {}) {\n      const pluralArray = sources[sourcePluralKey] // Get plural from the sources\n\n      if (Array.isArray(pluralArray)) {\n        // Map the plural array source to flattened prune analytical payloads\n        const destKeys = []\n        const results = pluralArray\n          .map(input => this.callOriginalFn(undefined, [{ ...sources, [sourceItemKey]: input }]))\n          .map(output => getValue(output, destKeys))\n          .filter(item => !!item)\n\n        const destPluralKey = destPluralPostixFn\n          ? destPluralPostixFn(destKeys[0])\n          : pluralPostixFn(destKeys[0])\n        return { [destPluralKey]: results }\n      }\n\n      return this.callOriginalFn()\n    })\n\n    // To be used by @Requirements as an alternative to sourceItemKey\n    targetFn.initializer.pluralRequirements = { [sourceItemKey]: sourcePluralKey }\n  }\n}\n\n/*\n * Gets a value from an object that has only one key and adds it to the output array\n * Since only one key is allowed it throws an error if there is more than one key, either immediately or overall\n */\nfunction getValue(obj, outKeys) {\n  const keys = Object.keys(obj)\n  const firstKey = keys[0]\n\n  if (!outKeys.includes(firstKey)) {\n    outKeys.push(firstKey)\n  }\n\n  if (keys > 1 || outKeys.length > 1) {\n    throw new Error('@Plural cannot be used with output containing more than 1 key ever')\n  }\n\n  return obj[firstKey]\n}\n\n/**\n * An Angular helper service for using in your main analytics service\n */\nexport default angular\n  .module('AnalyticsHelperModule', [])\n  .service('analyticsHelper', function ($timeout, analytics, localStorageService, utilService) {\n    const service = this\n\n    Object.assign(service, {\n      $timeout,\n      analytics,\n      localStorageService,\n      utilService,\n    })\n\n    /**\n     * Helper method to get analytic payloads\n     *\n     * @param {object} source - Object of data to be used to generate analytic payloads\n     * @param {array}  requiredInfo - Array of constants defined in the ANALYTICS constant\n     *\n     * @returns {object|null}\n     *\n     * @example\n          const analyticsPayload = analyticsHelper.createPayload({ ...this.DEFAULTS }, [ ANALYTICS.FLOW.INSTANCE ]);\n     *\n     */\n    service.createPayload = function (source = {}, requiredInfo = []) {\n      try {\n        requiredInfo.push(AUTO_SUCCESS)\n\n        // Get the payload based on the passed requiredInfo, automatically include success if present\n        return requiredInfo.reduce((out, factory) => Object.assign(out, factory(source)), {})\n      } catch (e) {\n        console.error(e, source, requiredInfo)\n        return null\n      }\n    }\n\n    /**\n     * Private: Helper method to post analytic payloads\n     *\n     * @param {string} eventName         - The event name to be used\n     * @param {object} analyticsPayload  - The generated analyticsPayload\n     * @param {object} analyticExtras    - Manual extras to be added to the payload\n     *\n     * @returns {undefined}\n     */\n    service.logAnalytics = function (eventName, analyticsPayload, analyticExtras = {}) {\n      try {\n        if (analyticsPayload) {\n          service.analytics.logSegmentEvent(eventName, {\n            ...analyticsPayload,\n            ...analyticExtras,\n          })\n        } else {\n          console.warn(`Empty analytics payload passed for ${eventName}`)\n        }\n      } catch (e) {\n        // Errors are caught because we don't want errors caused by logging to disrupt normal developer flow\n        console.error(e)\n      }\n    }\n\n    /**\n     * Provides a mechanism to track a true|false source value and when, and only when, that value changes, to respond by\n     * calling a setter to set a variable elsewhere.\n     *\n     * This method should be called in a constructor and returns to you a function that you call with true or false\n     * as you enter and exit parts of the UI (e.g. \"Am I in the cart? true or false\").\n     *\n     * The setter is passed a UUID, for you to use as you wish, setting into a variable.\n     * A corresponding getter is used to query that variable (really only cares if it is set or null)\n     * The same UUID is stored to local storage, so when you refresh the setter is automatically passed the last UUID\n     * if there was one. After a delay, it will check to see if you have confirmed that a value should be set (by\n     * a call of the returned function from this factory). If a confirmation is not received, it assumes the user did\n     * not merely refresh the page, but left and navigated away: In this case the setter will be called again with null.\n     *\n     * Note: Values stored in the store are given an expiry time after which the stored UUID will be forgotten.\n     *\n     *\n     * @param {string}                               localStoreId - The string ID to use for the local store\n     * @param {function<*|null>}                     getValueFn   - The function to get the variable contents (either something or null)\n     * @param {function(string<uuid>|null, boolean)} setValueFn   - The function that is called when there is a change in the isEnter value\n     *                                                              1ST ARG: A UUID if entering, or null if exiting; 2ND ARG: Rehydrating initial set (true|false)\n     * @param {int}                                  [refreshDelay] - Optional: Amount of time to wait before confirming the rehydrated UUID upon refresh/later visit\n     * @param {int}                                  [storeTimeout] - Optional: The maximum time to store a value in the localstore before it expires\n     *\n     * @returns {function(boolean)}         - A function you can call with has entered (true) or exited (false) area of interest for tracking\n     *\n     * @example\n           constructor(\n             analyticsHelper,\n             ) {\n              ....\n              ....\n\n              const getCheckoutUUID = () => this.checkoutUUID;\n              const setCheckoutUUIDAndFireEvents = (newChange, isInitial) => {\n                this.checkoutUUID = newChange;\n                if (!isInitial) {\n                  $timeout(() => newChange ? this.enterCheckoutFlow(this.DEFAULTS) : this.exitCheckoutFlow(this.DEFAULTS));\n                }\n              };\n\n              // Creates a function we can use to track entering/exiting the checkout area\n              this.isInNewCheckoutFlowFn = analyticsHelper.persistentStateFactory(\n                CHECKOUT_UUID_STORE,\n                getCheckoutUUID,\n                setCheckoutUUIDAndFireEvents\n              );\n            }\n     *\n     */\n    service.persistentStateFactory = function (\n      localStoreId,\n      getValueFn,\n      setValueFn,\n      refreshDelay = REFRESH_MS,\n      storeTimeout = STORE_TIMEOUT_MS\n    ) {\n      const { $timeout, utilService } = service\n      let isConfirmed = false\n\n      // Set the initial value from the store\n      const lastValue = utilService.getExpiringValueFromStore(localStoreId) || null\n      setValueFn(lastValue, true)\n\n      // If the user refreshes the page and a getValueFn() is set, but the router never confirmed there was a value.\n      // Then we need to set value to null because the user didn't refresh, they navigated away.\n      $timeout(() => {\n        if (getValueFn() !== null && !isConfirmed) {\n          setValueFn(null, false)\n        }\n      }, refreshDelay)\n\n      // Returns a function that only calls setValueFn if there is a change in `isEnter` value\n      // It always updates the loca storage so that the time stamp is updated\n      // This value will persist between\n      return isEnter => {\n        if (getValueFn() === null && isEnter) {\n          setValueFn(uuidv4(), false)\n        }\n\n        if (getValueFn() && !isEnter) {\n          setValueFn(null, false)\n        }\n\n        utilService.setExpiringValueToStore(localStoreId, getValueFn(), storeTimeout)\n        isConfirmed = isEnter\n      }\n    }\n\n    /**\n     * This function fires an Availability.view event when the timeSlots are fetched\n     *\n     *  @param {Array}                               timeSlots - Array containing loaded timeslots\n     */\n    service.availabilityViewEvent = function (timeSlots) {\n      const timeSlotPayload = { delivery_related: [] }\n      const { warehouse_location_id, warehouse_id } = timeSlots\n      timeSlots.forEach(slot => {\n        timeSlotPayload.delivery_related.push({\n          delivery_fee: slot.timeslot.shop_fee,\n          available_ind: !slot.timeslot.unavailable,\n          delivery_option_name: slot.timeslot.within_hours,\n          delivery_option_id: slot.timeslot.id,\n        })\n      })\n      const payload = { ...timeSlotPayload, warehouse_location_id, warehouse_id }\n      this.logAnalytics(EVENTS.CHECKOUT.VIEW_AVAILABILITY, payload)\n    }\n  })\n","/* eslint-disable max-classes-per-file */\n\n// TODO: Fix me\n// eslint-disable-next-line import/no-cycle\nimport {\n  Plural,\n  Requirements,\n} from '@app/angular/services/modules/analytics/analyticsHelper.service'\nimport { UNIT_OF_MEASURE } from '@app/angular/constants/uom'\n\n/*\n * Defines the event names used in analytics\n */\nexport const EVENTS = {\n  CART: {\n    VIEW: 'cart.view',\n    EDIT_QUANTITY: 'cart.edit_quantity',\n    ADD_PROMO: 'cart.add_promo',\n    MODIFY_NOTE: 'cart.modify_note',\n    CHECKOUT_CLICK: 'cart.checkout_click',\n    CART_MERGE: 'cart.merge',\n  },\n  CHECKOUT: {\n    ENTER_CHECKOUT: 'checkout.start',\n    EXIT_CHECKOUT: 'checkout.exit',\n    ENTER_UPSELL: 'checkout.view_upsell',\n    COMPLETE_UPSELL: 'checkout.upsell_completion',\n    ENTER_REVIEW: 'checkout.view_review',\n    CART_COMPARE: 'availability.cart_compare',\n    CLICK_EDIT_CART: 'checkout.edit_cart',\n    SELECT_FULFILLMENT: 'availability.select_fulfillment',\n    VIEW_AVAILABILITY: 'availability.view',\n    VIEW_FULFILLMENT: 'checkout.view_fulfillment',\n    EDIT_FULFILLMENT: 'checkout.edit_fulfillment',\n    // TODO: CONFIRM_FULFILLMENT event was added to handle the reservation confirmation event for GTM in the old checkout,\n    // this can be removed once old checkout is obselete\n    CONFIRM_FULFILLMENT: 'checkout.confirm_fulfillment',\n    VIEW_TIMESLOTS: 'checkout.view_timeslot',\n    SELECT_TIMESLOT: 'checkout.edit_timeslot',\n    VIEW_CONTACT: 'checkout.view_contact',\n    EDIT_CONTACT: 'checkout.edit_contact',\n    VIEW_PAYMENT: 'checkout.view_payment',\n    EDIT_PAYMENT: 'checkout.edit_payment',\n    ADD_CREDIT_CARD_OPEN: 'checkout.add_credit_card_open',\n    ADD_PAYMENT: 'checkout.add_payment',\n    VIEW_TIP: 'checkout.view_tip',\n    EDIT_TIP: 'checkout.edit_tip',\n    CLICK_PLACE_ORDER: 'checkout.placed_order_click',\n    PLACE_ORDER_COMPLETE: 'checkout.placed_order',\n  },\n  STORE: {\n    ADD_OFFER: 'store.add_offer',\n    VIEW_OFFERS: 'store.view_offers',\n  },\n  USER: {\n    CHANGE_PASSWORD: 'user.change_password',\n    LINK_LOYALTY_CARD: 'user.link_loyalty_card',\n    LOGIN: 'user.login',\n    LOGIN_ATTEMPT: 'user.login_attempt',\n    LOGIN_START: 'user.login_start',\n    LOGOUT: 'user.logout',\n    REGISTRATION_ATTEMPT: 'user.registration_attempt',\n    REGISTRATION_EXIT: 'user.registration_exit',\n    REGISTRATION_START: 'user.registration_start',\n    UPDATE_PROFILE: 'user.update_profile',\n    LOYALTY_ONBOARDING_EXIT: 'user.loyalty_onboarding_exit',\n    LOYALTY_ONBOARDING_START: 'user.loyalty_onboarding_start',\n    LOYALTY_ONBOARDING_FORGOT_PASSWORD: 'user.loyalty_onboarding_forgot_password',\n    LOYALTY_ONBOARDING_SOCIAL_SIGN_ON: 'user.loyalty_onboarding_social_sign_on',\n    LOYALTY_ONBOARDING_THANKYOU_CTA_CLICK: 'user.loyalty_onboarding_thankyou_cta_click',\n    LOYALTY_ONBOARDING_THANKYOU_START: 'user.loyalty_onboarding_thankyou_start',\n    EBT_ADD_CARD: 'user.ebt_add_card',\n    EBT_REMOVE_CARD: 'user.ebt_remove_card',\n    EBT_CLIENT_TOKENIZE_FAILED: 'user.client_tokenized_failed',\n    SSO_REDIRECT: 'user.sso_redirect',\n    FORCED_LOGOUT: 'user.forced_user_logout',\n  },\n}\n\n// These are the checkout steps for the old checkout flow and the new checkout flow\n// old checkout flow: EVENTS.CART.VIEW -> EVENTS.CHECKOUT.ENTER_UPSELL -> EVENTS.CHECKOUT.VIEW_FULFILLMENT\n// -> EVENTS.CHECKOUT.CONFIRM_FULFILLMENT -> EVENTS.CHECKOUT.VIEW_PAYMENT\n// new checkout flow: EVENTS.CART.VIEW -> EVENTS.CHECKOUT.ENTER_UPSELL -> EVENTS.CHECKOUT.ENTER_REVIEW\nexport const CHECKOUT_STEPS = {\n  [EVENTS.CART.VIEW]: 1,\n  [EVENTS.CHECKOUT.ENTER_UPSELL]: 2,\n  [EVENTS.CHECKOUT.ENTER_REVIEW]: 3,\n  [EVENTS.CHECKOUT.VIEW_FULFILLMENT]: 3,\n  [EVENTS.CHECKOUT.CONFIRM_FULFILLMENT]: 4,\n  [EVENTS.CHECKOUT.VIEW_PAYMENT]: 5,\n}\n\n/*\n * Defines the keys of sources that wil be passed to ANALYTICS\n */\nexport const SOURCES = {\n  ANALYTICS_SERVICE: 'analyticsService',\n  CART: 'cart',\n  CONTACT: 'contact',\n  CHECKOUT_ID: 'checkoutUUID',\n  OFFER: 'offer',\n  OFFER_ORIGIN: 'offerOrigin',\n  ORDER: 'order',\n  PAYMENT: 'payment',\n  RESERVATION: 'reservation',\n  SUCCESS: 'success',\n  TIMESLOT: 'timeslot',\n  TIP: 'tip',\n  UPSELL_ITEMS: 'upsellProducts',\n  URL_SLUG: 'urlSlug',\n  USER: 'user',\n}\n\n/*\n * A map of constants that can be used in the analytics functions for checkoutAnalytics\n * They take in sources object and pass out an object from the input\n * @Requirements(req1, req2, ...) is used for verification\n */\nclass CART_ANALYTICS {\n  @Requirements(SOURCES.ANALYTICS_SERVICE, SOURCES.CART)\n  CART_ID = sources => ({ cart_id: getCartId(sources[SOURCES.CART]) })\n\n  @Requirements(SOURCES.ANALYTICS_SERVICE, SOURCES.CART)\n  INFO_ANALYTICS = sources => ({\n    cart: sources[SOURCES.ANALYTICS_SERVICE].getCartInfoAnalytics(sources[SOURCES.CART]),\n  })\n\n  @Requirements(SOURCES.CART)\n  ITEM_DETAILS = sources => ({ item_details: getItemDetails(sources[SOURCES.CART]) })\n\n  @Requirements(SOURCES.USER)\n  INTENT = sources => ({ fulfillment: sources[SOURCES.USER]?.context?.intent })\n}\n\nclass CHECKOUT_ANALYTICS {\n  @Requirements(SOURCES.USER)\n  CONTEXT = sources => ({ context: getContextDetails(sources[SOURCES.USER]) })\n\n  @Requirements(SOURCES.ANALYTICS_SERVICE, SOURCES.ORDER)\n  ORDER = sources => ({\n    order: getOrderDetails(sources[SOURCES.ANALYTICS_SERVICE], sources[SOURCES.ORDER]),\n  })\n\n  @Requirements(SOURCES.PAYMENT)\n  PAYMENT = sources => ({ payment: getPaymentDetails(sources[SOURCES.PAYMENT]) })\n\n  @Requirements(SOURCES.USER)\n  SHOP = sources => ({ shop: getShopDetails(sources[SOURCES.USER]) })\n\n  @Requirements(SOURCES.TIP)\n  TIP = sources => ({ tip: getTipDetails(sources[SOURCES.TIP]) })\n\n  @Requirements(SOURCES.ANALYTICS_SERVICE, SOURCES.UPSELL_ITEMS)\n  UPSELL_ITEMS = sources => ({\n    upsell_products: sources[SOURCES.ANALYTICS_SERVICE].getProductListAnalytics(\n      sources[SOURCES.UPSELL_ITEMS]\n    ),\n  })\n}\n\nclass FLOW_ANALYTICS {\n  @Requirements(SOURCES.CHECKOUT_ID)\n  INSTANCE = sources =>\n    sources[SOURCES.CHECKOUT_ID] !== false ? { checkout_id: sources[SOURCES.CHECKOUT_ID] } : {}\n\n  @Requirements(SOURCES.URL_SLUG)\n  SOURCE_TYPE = sources => ({ source_type: getSourceType(sources[SOURCES.URL_SLUG]) })\n\n  @Requirements(SOURCES.URL_SLUG)\n  SOURCE_VALUE = sources => ({ source_value: getSourceValue(sources[SOURCES.URL_SLUG]) })\n}\n\nclass OFFER_ANALYTICS {\n  @Requirements(SOURCES.OFFER)\n  @Plural(SOURCES.OFFER) // \"offers [SOURCES.OFFER, ...]\" --> \"offers: [getOfferDetails, ...]\"\n  OFFER_DETAILS = sources => ({ offer: getOfferDetails(sources[SOURCES.OFFER]) })\n\n  @Requirements(SOURCES.OFFER_ORIGIN)\n  OFFER_ORIGIN = sources => ({ offer_via_item: getItemDetail(sources[SOURCES.OFFER_ORIGIN]) })\n}\n\nclass RESERVATION_ANALYTICS {\n  FULFILLMENT_DATE = sources => ({\n    fulfillment_date: getFulfillmentDate(sources[SOURCES.RESERVATION]),\n  })\n}\n\nclass TIMESLOT_ANALYTICS {\n  @Requirements(SOURCES.TIMESLOT)\n  TIMESLOT_DETAILS = sources => ({ timeslot: getTimeslotDetails(sources[SOURCES.TIMESLOT]) })\n}\n\nexport const ANALYTICS = {\n  CART: new CART_ANALYTICS(),\n  CHECKOUT: new CHECKOUT_ANALYTICS(),\n  FLOW: new FLOW_ANALYTICS(),\n  OFFER: new OFFER_ANALYTICS(),\n  RESERVATION: new RESERVATION_ANALYTICS(),\n  TIMESLOT: new TIMESLOT_ANALYTICS(),\n}\n\n/*\n * Constants that can be used for the \"user_action\" source and output\n */\nexport const USER_PAYMENT_ACTION = {\n  GIFT_CARD_CHANGE: 'GIFT_CARD_CHANGE',\n  PAYMENT_CHANGE: 'PAYMENT_CHANGE',\n}\n\nexport const ITEM_QUANTITY_IDENTIFIER = {\n  WEIGHTED_LB: UNIT_OF_MEASURE.LB.toUpperCase(),\n  WEIGHTED_KG: UNIT_OF_MEASURE.KG.toUpperCase(),\n  UNWEIGHTED: UNIT_OF_MEASURE.EACH.toUpperCase(),\n}\n\n/*\n * Page slug constants for detection\n */\nconst PAGE = {\n  CART_PAGE_URL: '/checkout/',\n  CHECKOUT_FLOW_URL: '/checkout/cart',\n  CART_TYPE: 'CART',\n  CHECKOUT_TYPE: 'CHECKOUT',\n}\n\n/*\n * Sponsored source constants for Segment\n */\nexport const SEGMENT_SPONSORED_SOURCE = {\n  INSTACART: 'instacart',\n  DASHBOARD: 'dashboard',\n  THIRD_PARTY: 'third party',\n}\n\n/**\n * Returns cart items analytics data\n *\n * @param {object} cart\n */\nfunction getItemDetails(cart) {\n  if (!cart) return\n\n  return cart.items?.map(item => getItemDetail(item))\n}\n\n/**\n * Returns an item analytics data\n *\n * @param {object} item\n */\nfunction getItemDetail(item) {\n  if (!item) return\n\n  const { allow_substitutions, id, type, quantity } = item\n\n  const { brand_name: brand, categories, name, tags } = item?.store_product || {}\n\n  return {\n    allow_substitutions,\n    brand,\n    categories,\n    id,\n    name,\n    quantity,\n    tags,\n    type,\n  }\n}\n\n/**\n * Returns analytics data from a timeslot object\n *\n * @param {object} timeslot\n */\nfunction getTimeslotDetails(timeslot) {\n  if (!timeslot) return\n\n  const {\n    allow_alcohol,\n    day_of_week,\n    from_time,\n    id,\n    shop_fee,\n    source,\n    to_time,\n    unavailable,\n    within_hours,\n  } = timeslot\n\n  return {\n    allow_alcohol,\n    day_of_week,\n    from_time,\n    id,\n    shop_fee,\n    source,\n    to_time,\n    unavailable,\n    within_hours,\n  }\n}\n\n/**\n * Returns analytics data from an offer object\n *\n * @param {object} offer\n */\nfunction getOfferDetails(offer) {\n  if (!offer) return\n\n  // ALL OFFER RELATED\n  const { id, reward } = offer\n\n  // CART OFFER RELATED\n  const {\n    description,\n    name: offerName,\n    offer_type: offerType,\n    offer_progress: { completion_count, condition: offerCondition, reward: offerReward } = {},\n  } = offer\n\n  // PROMO OFFER RELATED\n  const { condition, offer: { name, offer_type: type } = {} } = offer\n\n  // CLIPPABLE OFFER RELATED\n  const { clipped, days, limit_basket, promo_code, source, terms } = offer\n\n  return {\n    clipped,\n    completion_count,\n    condition: condition || offerCondition,\n    description,\n    days,\n    id,\n    limit_basket,\n    name: name || offerName,\n    offerReward,\n    promo_code,\n    reward: offerReward ? { ...reward, ...offerReward } : reward,\n    source,\n    terms,\n    type: type || offerType,\n  }\n}\n\n/**\n * Returns analytics data for page type based on url\n *\n * @param {string} urlSlug - The path section of the current url\n */\nfunction getSourceType(urlSlug) {\n  if (!urlSlug) return\n\n  if (urlSlug.startsWith(PAGE.CHECKOUT_FLOW_URL)) {\n    return urlSlug.includes(PAGE.CART_PAGE_URL) ? PAGE.CART_TYPE : PAGE.CHECKOUT_TYPE\n  }\n}\n\n/**\n * Returns analytics data for page url based on source type\n *\n * @param {string} urlSlug - The path section of the current url\n */\nfunction getSourceValue(urlSlug) {\n  if (getSourceType(urlSlug) === PAGE.CHECKOUT_TYPE) {\n    return urlSlug\n  }\n}\n\n/**\n * Returns analytics data from a payment object\n *\n * @param {object} payment\n */\nfunction getPaymentDetails(payment) {\n  if (!payment) return\n\n  // TODO We need to decide what kind of payment information we want to log and what we don't\n  // TODO BrainTree reveals nothing much too - another reason to upgrade\n  const { gift_cards = null, payment_type = null } = payment\n\n  const giftCards = gift_cards && gift_cards?.map(({ amount }) => ({ amount }))\n  return { gift_cards: giftCards, payment_type }\n}\n\n/**\n * Returns analytics data from an order object\n *\n * @param {AnalyticsServicesModule} analytics\n * @param {object} order\n */\nfunction getOrderDetails(analytics, order) {\n  if (!order) return\n\n  const {\n    customer_comment,\n    customer_first_order,\n    estimated_totals,\n    fulfillment_date,\n    fulfillment_type,\n    id,\n    order_items,\n    payment_type,\n    status,\n    store,\n    timeslot,\n  } = order\n\n  return {\n    customer_comment,\n    customer_first_order,\n    estimated_totals,\n    fulfillment_date,\n    fulfillment_type,\n    id,\n    order_items: analytics.getProductListAnalytics(order_items),\n    payment_type,\n    status,\n    store,\n    timeslot,\n  }\n}\n\n/**\n * Returns analytics shop data from a user object\n *\n * @param {object} user\n */\nfunction getShopDetails(user) {\n  if (!user) return\n\n  return user?.store\n}\n\n/**\n * Returns analytics tip data from a tip object\n *\n * @param {object} tip\n */\nfunction getTipDetails(tip) {\n  if (!tip) return\n\n  const { option, customAmount } = tip\n  return { option, customAmount }\n}\n\n/**\n * Returns analytics context data from a user object\n *\n * @param {object} user\n */\nfunction getContextDetails(user) {\n  if (!user) return\n\n  const clonedContext = { ...(user?.context || {}) }\n  delete clonedContext.intent\n  return clonedContext\n}\n\n/**\n * Returns cart id from the cart object\n *\n * @param {object} cart\n */\nfunction getCartId(cart) {\n  if (!cart) return\n\n  return cart.cart_instance_id\n}\n\n/**\n * Returns the fulfillment date from the reservation object\n *\n * @param {object} reservation\n */\nfunction getFulfillmentDate(reservation) {\n  return reservation.fulfillment_date\n}\n","import { createTokens } from '@instacart/cocktail'\nimport { getBuildConfig } from '../../../rootConfig'\n\nconst tokens = createTokens(getBuildConfig().theme)\n\nexport default tokens\n","import _ from 'lodash'\nimport angular from 'angular'\nimport { CART_TYPES } from '@app/angular/constants/cart'\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\nimport { IC_PLACEMENTS } from '@app/angular/constants/express'\nimport {\n  product as enterpriseProductService,\n  shoppingList as shoppingListService,\n} from '@instacart/enterprise-services'\nimport { EVENTS } from '@app/angular/services/modules/analytics/analyticsConstants'\nimport tokens from '@app/angular/services/modules/tokens'\nimport { getDataByCartType } from '@app/react/components/miniCart/utils'\nimport alcoholValidationErrorModalTemplate from '../../services/templates/alcoholValidation/alcoholValidationErrorModal.html'\nimport unableToOpenPDP from './views/unableToOpenPDP.html'\n\nexport default angular\n  .module('CheckoutCartControllerModule', [])\n  .controller(\n    'CheckoutCartController',\n    function (\n      $anchorScroll,\n      $filter,\n      $q,\n      $rootScope,\n      $sce,\n      $scope,\n      $state,\n      Restangular,\n      alcoholValidation,\n      analytics,\n      api,\n      auth,\n      cartService,\n      catalogCategoriesService,\n      checkoutAnalytics,\n      config,\n      configurableProductService,\n      confirmationModal,\n      couponUnclippedModalService,\n      eComLightService,\n      errorModalService,\n      express,\n      imageURLService,\n      lang,\n      listPrintService,\n      loyaltyService,\n      manualUpsellService,\n      mobileNativeHrefService,\n      mobileService,\n      navService,\n      offersService,\n      productDetailsModal,\n      promoCodeValidationService,\n      reactCartLoyaltyBalanceDefaultProps,\n      reservationService,\n      shoppingSelectorService,\n      upsellProducts,\n      userService,\n      utilService\n    ) {\n      const { inEComLightMode } = eComLightService\n      const setTotalRewards = () => {\n        $scope.rewards = loyaltyService.getVisibleRewards(\n          cartService.cart?.cart_totals?.[cartService.getCurrentCartType()]?.reward_discounts\n        )\n      }\n\n      Object.assign(\n        $scope,\n        {\n          $state,\n          auth,\n          cartService,\n          configurableProductService,\n          currencyFilter: $filter('currency'),\n          express,\n          EVENTS,\n          IC_PLACEMENTS,\n          imageURLService,\n          inEComLightMode,\n          listPrintService,\n          reservationService,\n          shoppingSelectorService,\n        },\n        {\n          getMinCartSpend: shoppingListService.commonUtils.getMinimumCartSpend,\n          shoppingIntent: auth.getContext().intent,\n          showNotesSubs: false,\n          hasCartItems: () =>\n            cartService\n              .getCartTypeToItemsMap()\n              [cartService.getCurrentCartType()]?.filter(\n                item => item?.store_product?.product_type === 'product'\n              )?.length > 0,\n          isNewCheckout: config.newCheckoutFlow.cartReviewPage.enabled,\n          showLoyaltyCartPagePlacement: () =>\n            loyaltyService.showLoyaltyPlacement() && config.loyalty.enableLoyaltyOptIn.cartPage,\n          showLoyaltyCardBalance: () =>\n            userService.loyaltyCards.length > 0 &&\n            // eslint-disable-next-line no-restricted-globals\n            !isNaN(userService.getLoyaltyCard().points_balance) &&\n            config.newCheckoutFlow.cartReviewPage.enabled &&\n            mobileService.isMobile &&\n            config.showLoyaltyBalanceInCart &&\n            config.hasLoyalty,\n          loyaltyReactProps: {\n            ...reactCartLoyaltyBalanceDefaultProps,\n            styles: { value: { color: tokens.color.brand.primary.dark } },\n          },\n        }\n      )\n\n      let initialCartItems = []\n      let initialCartComment = ''\n\n      const copyCart = cart => {\n        initialCartItems = angular.copy(cart.items)\n        initialCartComment = cart.comment\n      }\n\n      if (!$scope.cartService.cart) {\n        cartService.fetch()\n      }\n\n      $scope.outOfStockWarningPopover = $sce.trustAsHtml(\n        `<span class=\"icon-warning add-to-cart__warning\" aria-hidden=\"true\"></span> ${lang.values.outOfStockDescription}`\n      )\n\n      $scope.handleDeleteConfirmCancelClick = item => {\n        item.quantity = item.quantity || 1\n        item.showDeleteConfirm = false\n        // a11y fix to refocus on remove element after cancelling\n        const itemID = `checkout-cart-item-${item.store_product.id}-remove`\n        const removeButtonForItem = document.getElementById(itemID)\n        if (removeButtonForItem) {\n          setTimeout(() => {\n            removeButtonForItem.focus()\n          }, 0)\n        }\n      }\n\n      $scope.handleExpressPlacementClick = () => {\n        express.acknowledgePlacement(IC_PLACEMENTS.SIDECART)\n        $state.go('main.icExpress')\n      }\n\n      $scope.emptyCartMessage = lang.template(lang.values.noItemsInCart, {\n        shoppingMode: auth.getCurrentShoppingMode(),\n      })\n\n      $scope.breadcrumbs = navService.getCartListReviewItems()\n\n      $scope.shouldShowCartUpsell = () =>\n        !$scope.inEComLightMode &&\n        cartService.cart &&\n        cartService.cart.items.length > 0 &&\n        config.cartUpsellCollection &&\n        $scope.upsellItems &&\n        $scope.upsellItems.length &&\n        !$scope.loading\n\n      $scope.$watch('cartService.isSubstitutionNotesOpen', isOpen => {\n        $scope.showNotesSubs = isOpen\n\n        if (isOpen) {\n          copyCart($scope.cartService.cart)\n        }\n      })\n\n      $scope.inCatering = auth.getCurrentShoppingMode() === SHOPPING_MODES.CATERING\n\n      const handleSubistitutionNotesDiscard = () => {\n        const { cart } = $scope.cartService\n\n        cart.items = initialCartItems.map(item => {\n          cartService.currentEnterpriseService.actions.updateItemComment(item, item.comment)\n          return item\n        })\n\n        cart.comment = initialCartComment\n\n        $scope.cartService.sync().then($scope.categorizeProducts)\n      }\n\n      if (mobileService.isMobile) {\n        $scope.$on('mobileDiscardSubsNotes', handleSubistitutionNotesDiscard)\n      }\n\n      // Refresh cart on each view load\n      $scope.loading = true\n\n      // Prepare the cart\n      const initProducts = function () {\n        if ($scope.cartService.cart && $scope.cartService.cart.items.length) {\n          _.each($scope.cartService.cart.items, item => {\n            if (item.store_product) {\n              item.isSelected = false\n            }\n          })\n\n          // Initialize substitution toggles\n\n          $scope.setAllowAllSubstitutionsToggle()\n\n          // Generate initial list of categorized products and\n          // update when cart changes\n\n          $scope.categorizeProducts()\n          if (!config.disableAisles && $scope.shoppingIntent === 'instore') {\n            $scope.sortProductsByAisle()\n          }\n        }\n\n        $scope.$watch('cartService.lastUpdated', () => {\n          $scope.categorizeProducts()\n\n          if (!config.disableAisles && $scope.shoppingIntent === 'instore') {\n            $scope.sortProductsByAisle()\n          }\n        })\n\n        // Stop loading\n        $scope.loading = false\n      }\n\n      // Store sorted products by sortType\n      $scope.sortedProductsBy = {}\n\n      // Store sorted sortTypes (categories, aisles, etc.)\n      $scope.orderedGroups = {}\n\n      // Cart items grouped by their store\n      $scope.dataByCartType = {}\n\n      // Sort products by category\n      $scope.categorizedProducts = {}\n\n      $scope.categorizeProducts = function () {\n        cartService\n          .getCategorizedProductsAndCategories()\n          .then(({ productsByCategory, orderedCategories }) => {\n            $scope.categorizedProducts = productsByCategory\n            $scope.orderedCategories = orderedCategories\n            $scope.sortedProductsBy.category = $scope.categorizedProducts\n            $scope.orderedGroups.category = $scope.orderedCategories\n            cartService.createCartTypeToCategoryMapping()\n\n            // This is for multi context side carts\n            $scope.dataByCartType = $scope.getDataByCartType(cartService.cart)\n          })\n      }\n\n      $scope.getDataByCartType = cart =>\n        $scope.useMultiContextCart &&\n        getDataByCartType(cart?.items, cart?.cart_totals, config.multipleBanners.banners)\n\n      // Sort products by Aisle\n\n      $scope.productsSortedByAisle = {}\n\n      $scope.sortProductsByAisle = function () {\n        $scope.sortedProductsBy.aisle = $scope.cartService.getAllProductsByAisle()\n        $scope.orderedGroups.aisle = _.keys($scope.sortedProductsBy.aisle).sort((a, b) =>\n          a.localeCompare(b)\n        )\n      }\n\n      // Substitution toggling logic\n      $scope.toggleAllowSubstitutions = item => {\n        cartService.currentEnterpriseService.actions.updateItemAllowSubstitutions(\n          item,\n          item.allow_substitutions\n        )\n        $scope.cartService.sync(false)\n        $scope.setAllowAllSubstitutionsToggle()\n      }\n\n      $scope.toggleAllowAllSubstitutions = function (status) {\n        $scope.allowAllSubstitutions = !$scope.allowAllSubstitutions\n        if ($scope.cartService.cart) {\n          _.each($scope.cartService.cart.items, item => {\n            if (!$scope.isAllowSubstitutionsDisabled(item)) {\n              cartService.currentEnterpriseService.actions.updateItemAllowSubstitutions(\n                item,\n                status || $scope.allowAllSubstitutions\n              )\n            }\n          })\n\n          $scope.cartService.sync()\n        }\n      }\n\n      $scope.setAllowAllSubstitutionsToggle = function () {\n        $scope.allowAllSubstitutions = _.every($scope.cartService.cart.items, {\n          allow_substitutions: true,\n        })\n      }\n\n      $scope.isAllowSubstitutionsDisabled = function (item) {\n        return !$scope.config.enableAllowSubstitutionsForConfigurableItems && item.product_config\n      }\n\n      $scope.substitutionCommentUpdate = item => {\n        cartService.currentEnterpriseService.actions.updateItemComment(item, item.comment)\n        cartService.sync()\n      }\n\n      // Handle promo codes\n\n      $scope.promo = {}\n      $scope.promo_ = {}\n      $scope.addPromo = function (promo) {\n        if (promo.promo_code && promo.promo_code.length) {\n          promoCodeValidationService\n            .checkIfValidPromoCode(promo)\n            .then(result => {\n              if (result.offer_id) {\n                offersService.getOfferData(result.offer_id).then(offer => {\n                  cartService.cart.promo_codes.push(promo.promo_code)\n                  checkoutAnalytics.addPromo({ promoCode: promo.promo_code, offer, success: true })\n                  delete promo.promo_code\n                  cartService.sync()\n                })\n              }\n            })\n            .catch(err => {\n              checkoutAnalytics.addPromo({ promoCode: promo.promo_code, success: false })\n              errorModalService.open(err.data?.message || err.message, 'OK')\n            })\n        }\n      }\n\n      // Cart Upsell\n      if (config.cartUpsellCollection && $scope.loadCartUpsell) {\n        Restangular.all(config.cartUpsellCollection)\n          .getList({ limit: 4 })\n          .then(response => ($scope.upsellItems = response.plain()))\n      }\n\n      // Prepare the cart\n      initProducts()\n\n      $scope.$on('finishedEditingNotes', () => {\n        $scope.showNotesSubs = !$scope.showNotesSubs\n        cartService.isSubstitutionNotesOpen = $scope.showNotesSubs\n      })\n\n      $scope.updateItemComment = item => {\n        cartService.currentEnterpriseService.actions.updateItemComment(item, item.comment)\n        cartService.sync()\n      }\n\n      $scope.getBanner = warehouseId =>\n        config.multipleBanners.banners.find(banner => banner.bannerExtId === warehouseId)\n\n      $scope.goToProductDetailsModal = item => {\n        // do not pop modal for config product ever\n        if (item.product_config) return\n\n        if (item?.store_id !== parseInt(auth.getStore(), 10)) {\n          const currentWarehouse = $scope.auth.user.store.store_banner.name\n          const productBanner = $scope.getBanner(item.warehouse_id)\n          const productWarehouse = productBanner?.name\n          const strings = {\n            title: lang.template(lang.values.cantOpenPdpTitle, {\n              productType: _.upperFirst(item.cart_type),\n              currentWarehouse,\n            }),\n            message: lang.template(lang.values.cantOpenPdpMessage, { productWarehouse }),\n            confirm: lang.template(lang.values.cantOpenPdpSwitchTo, { productWarehouse }),\n            cancel: lang.template(lang.values.cantOpenPdpStayIn, { currentWarehouse }),\n          }\n          confirmationModal.open(strings, unableToOpenPDP).then(proceed => {\n            if (proceed) {\n              auth.update({ store_id: item.store_id, has_changed_store: true }).then(() =>\n                auth\n                  .setContext({\n                    intent: auth.getContext().intent,\n                    storeNumber: item.store_id,\n                    retailer_slug: productBanner?.bannerSlug,\n                  })\n                  .then(() =>\n                    // Available categories may change, so refresh them.\n                    catalogCategoriesService.fetchCategories(true).then(() => {\n                      $state.go('main.product', { id: item.store_product.id })\n                    })\n                  )\n                  .then(() => auth.sendUserUpdatedStore(auth.user))\n              )\n            }\n          })\n        } else if (!item.product_config) {\n          productDetailsModal.open(item.store_product.id, {\n            location: config.analyticsSourceKeys.checkout,\n          })\n        }\n      }\n\n      // We have to use the upsell products from the service as it is the truth\n      const showManualUpsell = () =>\n        ((config.enableCheckoutManualUpsell && manualUpsellService?.manualUpsellProducts?.length) ||\n          0) > 0\n\n      const getUpsellRoute = () => {\n        return config.newCheckoutFlow.upsellPage.enabled\n          ? 'main.checkout.customUpsell'\n          : 'main.checkout.manualUpsell'\n      }\n\n      const getCheckoutRoute = () => {\n        if (config.newCheckoutFlow.checkoutPage.enabled) {\n          return 'main.checkout.checkoutPage'\n        }\n        if (auth.shouldUseGigyaAddressEdit()) {\n          return 'main.checkout.reservation.confirmation'\n        }\n\n        return 'main.checkout.reservation.address'\n      }\n\n      const proceedToNextCheckoutStep = () => {\n        const url =\n          showManualUpsell() && cartService.getCurrentCartType() !== CART_TYPES.CATERING\n            ? getUpsellRoute()\n            : getCheckoutRoute()\n\n        // TODO: this is a workaround so a clients android app does not use the mobileNativeHrefService which is broken\n        // This only seems to be an issue on Android for one client on checkout v1\n        if (\n          mobileService.isMobileApp() &&\n          config.checkout.openNativeInWebview &&\n          config.checkout.openNativeInWebviewOnlyiOS &&\n          !mobileService.isIOS()\n        ) {\n          $state.go(url)\n          return\n        }\n\n        if (mobileService.isMobileApp() && config.checkout.openNativeInWebview) {\n          mobileNativeHrefService.openCheckoutInInappBrowser(\n            $state.href(url, {}, { inherit: false })\n          )\n          return\n        }\n\n        $state.go(url)\n      }\n\n      const getClickAnalyticsPayload = cart => {\n        if (!cart) return {}\n\n        return {\n          cart: {\n            cart_items_count: cart.items.length,\n            cart_total: cart.total,\n            credit_total: cart.credit_total,\n            delivery_fee: cart.delivery_fee,\n            offer_total: cart.offer_total,\n            pickup_fee: cart.pickup_fee,\n            pre_discount_product_total: cart.pre_discount_product_total,\n            product_total: cart.product_total,\n            subscription_total: cart.subscription_total,\n            tax_total: cart.tax_total,\n            tip_percent: cart.tip_percent,\n            tip_total: cart.tip_total,\n            order_id: cart?.order?.id,\n          },\n          cart_products: cart.items?.map(i => i?.id),\n        }\n      }\n\n      /**\n       * Method that gets executed after the user clicks in the checkout button\n       *\n       * @param {string} - analyticsValue\n       * @returns {undefined | boolean}\n       */\n      $scope.checkoutCartContinue = analyticsValue => {\n        const proceedToCheckout = () => {\n          const cart = cartService.cart\n\n          analytics.logBeginCheckout(cart)\n          analytics.logCheckoutCTAClick(analyticsValue, getClickAnalyticsPayload(cart))\n          proceedToNextCheckoutStep()\n        }\n\n        const continueCallback = () => {\n          checkoutAnalytics.checkoutClick()\n\n          // Check if there is a coupon that needs to be clipped before proceeding to the next step.\n          if (isThereUnclippedCouponWithProgressComplete()) {\n            couponUnclippedModalService\n              .open()\n              // Ok Button action => Go to offers part of the page.\n              .then(() => utilService.scrollIntoView(document.querySelector('#cart-offers')))\n              // Cancel Button action\n              .catch(() => proceedToCheckout())\n          } else {\n            // No unclipped coupon\n            proceedToCheckout()\n          }\n        }\n\n        if (config.alcoholCompliance.enabled && cartService.getHasAlcohol()) {\n          if (\n            $rootScope.modifyingOrder &&\n            cartService.cart.order?.leave_unattended &&\n            auth.getContext().intent === SHOPPING_MODES.DELIVERY\n          ) {\n            errorModalService.openCustom(alcoholValidationErrorModalTemplate, {\n              lang,\n              isAlcoholError: true,\n            })\n            return false\n          }\n\n          alcoholValidation.open().then(continueCallback)\n          return false\n        }\n\n        continueCallback()\n      }\n\n      // Check to see if there exists at least one coupon that is unclipped with complete progress.\n\n      function isThereUnclippedCouponWithProgressComplete() {\n        let isUnclippedCouponProgressComplete = false\n        _.forEach(cartService.cart.offer_progress, offer => {\n          if (offer.offer.clipped === false && offer.completion_count > 0) {\n            isUnclippedCouponProgressComplete = true\n            // TODO What does this return do?\n          }\n        })\n\n        return isUnclippedCouponProgressComplete\n      }\n\n      // Used to ensure ng-repeat's `track by` works with one-time binding\n      $scope.generateUniqueItemId = item =>\n        `${item.store_product.id}-${configurableProductService.generateConfigIdString(item)}`\n\n      /**\n       * Handles the increment item button click\n       * @param {object} item\n       *\n       * @returns {undefined}\n       */\n      $scope.incrementItem = item => {\n        cartService.incrementItem(item.store_product, 1, item.product_config)\n        checkoutAnalytics.cartEditQuantity({ success: true })\n      }\n\n      /**\n       * Handles the decrement item button click\n       * @param {object} item\n       *\n       * @returns {undefined}\n       */\n      $scope.decrementItem = item => {\n        if (item.quantity > 1) {\n          cartService.decrementItem(item.store_product, 1, item.product_config)\n        } else {\n          item.showDeleteConfirm = true\n        }\n\n        checkoutAnalytics.cartEditQuantity({ success: true })\n      }\n\n      /**\n       * Triggered when the weight is updated\n       *\n       * @param {object} item                - The product item being updated\n       * @param {number} $originalQuantity   - [Provided] The original quantity before the change\n       * @param {function} $onZeroFn         - [Provided] Callback to trigger if the new quantity is zero\n       *\n       * @returns {undefined}\n       */\n      $scope.updateItemQuantity = (item, $originalQuantity, $onZeroFn) => {\n        const isZero = item.quantity === 0\n        if ($onZeroFn && isZero) {\n          $onZeroFn()\n          item.quantity = $originalQuantity\n          return\n        }\n\n        const { store_product, quantity, product_config } = item\n        cartService.updateItemQuantity(store_product, quantity, product_config?.options)\n      }\n\n      /**\n       * Opens the add promo code modal\n       *\n       * @returns {undefined}\n       */\n      $scope.openPromoCodeModal = () => {\n        const onClose = () => {\n          cartService.sync()\n          const promoLink = document.getElementsByClassName('mobile-promo-codes__link')\n          if (promoLink.length > 0) {\n            promoLink[0].focus()\n          }\n        }\n        utilService.openPromoCodeModal(onClose, mobileService.isMobile)\n      }\n\n      $scope.modifyNote = () => {\n        analytics.logEvent('cart save comment update', 'update')\n        const note = cartService.cart?.comment\n        cartService\n          .sync()\n          .then(() => checkoutAnalytics.modifyNote({ success: true, note }))\n          .catch(() => checkoutAnalytics.modifyNote({ success: false, note }))\n      }\n\n      $scope.isItemCurrentlyOutOfStock = item => {\n        return !enterpriseProductService.utils.isProductAvailable(item.store_product)\n      }\n\n      if (config.rewards.visible.length) {\n        $scope.$watch(() => cartService.syncing, setTotalRewards)\n        setTotalRewards()\n      }\n    }\n  )\n  .run($templateCache => {\n    $templateCache.put('checkoutCartTable.html', require('./views/checkoutCartTable.html'))\n    $templateCache.put('reservation.html', require('../reservation/views/reservation.html'))\n  })\n","import angular from 'angular'\nimport { CART_TYPES } from '@app/angular/constants/cart'\nimport { IC_PLACEMENTS } from '@app/angular/constants/express'\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\nimport { imageTransform } from '@instacart/enterprise-services'\n\nimport { utils as timeslotUtils } from '@instacart/enterprise-timeslots'\n\nexport default angular\n  .module('CheckoutConfirmationControllerModule', [])\n  .controller(\n    'CheckoutConfirmationController',\n    function (\n      $rootScope,\n      $scope,\n      $state,\n      api,\n      auth,\n      canvas,\n      cartService,\n      checkoutService,\n      config,\n      eComLightService,\n      express,\n      lang,\n      mobileService,\n      modifiedProgressSegments,\n      order,\n      placementsService,\n      rateApp,\n      reservationService,\n      utilService\n    ) {\n      const { isMobile } = mobileService\n      const isPickup = order.fulfillment_type === 'pickup'\n      const postCheckoutPlacementEnabled = express.isPlacementConfigEnabled(\n        IC_PLACEMENTS.POST_CHECKOUT\n      )\n      $scope.imageTransform = imageTransform\n\n      Object.assign(\n        $scope,\n        {\n          config,\n          isMobile,\n          isPickup,\n          order,\n          postCheckoutPlacementEnabled,\n          utilService,\n          cartService,\n        },\n        {\n          delivery: { location: {}, marker: {} },\n          isFromNewCheckout: config.newCheckoutFlow.checkoutPage.enabled,\n          isSubscribed: false,\n          isSubscribing: false,\n          mapTitle: isPickup ? order.store.name : order.delivery_address.address1,\n          orderObject: isPickup ? order.store.address : order.delivery_address,\n          progressSegments: modifiedProgressSegments,\n          userCurrentSubscription: null,\n          icExpressSavingAmount: isPickup\n            ? order.estimated_totals.pickup_fee\n            : order.estimated_totals.delivery_fee,\n\n          expressOrderSuccessText: lang.template(lang.values.orderSuccessNewExpressDelivery, {\n            retailer: lang.values.clientName,\n            expressName: config.icExpress.name,\n          }),\n\n          onClickIcExpress: () => {\n            $scope.isSubscribing = true\n            express.handleSubscribe(\n              checkoutService.getLastUsedPaymentInstrument(),\n              order.id,\n              subscription => {\n                $scope.isSubscribing = false\n                $scope.isSubscribed = express.hasSubscription()\n                $scope.userCurrentSubscription = subscription\n              }\n            )\n          },\n        }\n      )\n\n      $scope.getInstructions = () => {\n        const shoppingMode = eComLightService.inEComLightMode\n          ? SHOPPING_MODES.CATERING\n          : auth.getContext().intent\n\n        const orderInstructions = config.orderInstructions[shoppingMode]\n\n        if (!orderInstructions?.enabled) return\n\n        return orderInstructions\n      }\n\n      // Fetches user current express subscription if necessary, and passes it down to components\n      if (postCheckoutPlacementEnabled) {\n        express\n          .getCurrentSubscription()\n          .then(subscription => ($scope.userCurrentSubscription = subscription))\n      }\n\n      // On init of this controller, we assume an order has been successfully placed,\n      //  we must therefore fetch the newly empty cart, and the cleared reservation\n      cartService.fetch().then(() => {\n        const orderCartType = order.ext_data.source_cart_type\n        $scope.remainingCartType = cartService\n          .getCartTypes()\n          .filter(cartType => cartType !== orderCartType)[0]\n        $scope.remainingCarts = cartService.getCartTypeToItemsMap()\n      })\n      reservationService.fetch()\n\n      if (config.mobileAppRate.callOnCheckout) {\n        // Call mobile service to prompt an app review if criteria are met\n        rateApp.promptAppReview()\n      }\n      // Broadcast for use in custom js tags.\n      $rootScope.$broadcast('orderConfirmation', $scope.order.plain())\n\n      $scope.updateContextAndRedirectToCheckout = () => {\n        const shoppingMode =\n          $scope.remainingCartType === CART_TYPES.CATERING\n            ? SHOPPING_MODES.CATERING\n            : SHOPPING_MODES.PICKUP\n\n        auth.setIntent(shoppingMode).finally(() => $state.go('main.checkout.checkoutPage'))\n      }\n\n      placementsService.getOrderConfirmationPlacement(isMobile).then(response => {\n        if (response && response[0]) {\n          const firstPlacement = response[0]\n\n          canvas.logImpression(firstPlacement)\n          $scope.orderConfirmationPlacement = firstPlacement\n        }\n      })\n\n      $scope.handleImagePlacementClick = placement =>\n        placementsService.handleImagePlacementClick(placement, 'order confirmation')\n\n      $scope.timeslotLabelFn = () => {\n        return timeslotUtils.getMainLabel($scope.order, {\n          verboseLevel: 2,\n          format: config.apiDateFormat,\n        })\n      }\n\n      // If the new checkout is enabled and is delivery we have to\n      // fetch the delivery address location in order to draw a\n      // marker on the delivery map\n      if ($scope.isFromNewCheckout && !$scope.isPickup) {\n        const address = `${$scope.orderObject.address1} ${$scope.orderObject.province}`\n\n        api.getGeocodeAddress(address).then(response => {\n          const {\n            data: { features: locations },\n          } = response\n          const [longitude, latitude] = locations?.[0]?.center\n          const location = { longitude, latitude }\n\n          if (longitude && latitude) {\n            $scope.delivery.marker.id = 'delivery-map-address'\n            $scope.delivery.marker.location = location\n            $scope.delivery.location = location\n          }\n        })\n      }\n    }\n  )\n  .run($templateCache => {\n    $templateCache.put(\n      'checkoutConfirmation.new.html',\n      require('./views/checkoutConfirmation.new.html')\n    )\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('CheckoutManualUpsellControllerModule', [])\n  .controller(\n    'CheckoutManualUpsellController',\n    function (\n      $scope,\n      $state,\n      $window,\n      analytics,\n      auth,\n      cartService,\n      config,\n      mobileService,\n      reservationService,\n      upsellProducts\n    ) {\n      Object.assign($scope, {\n        cartService,\n        config,\n        mobileService,\n        reservationService,\n        $state,\n        upsellProducts,\n      })\n\n      if (config.newCheckoutFlow.checkoutPage.enabled) {\n        $scope.nextState = 'main.checkout.checkoutPage'\n      } else if (auth.shouldUseGigyaAddressEdit()) {\n        $scope.nextState = 'main.checkout.reservation.confirmation'\n      } else {\n        $scope.nextState = 'main.checkout.reservation.address'\n      }\n\n      $scope.moreThanOneRow = () =>\n        upsellProducts.length > 4 ||\n        (upsellProducts.length === 3 && $window.innerWidth < 680) ||\n        (upsellProducts.length === 4 && $window.innerWidth < 912)\n    }\n  )\n","import angular from 'angular'\nimport { FULFILLMENT_TYPES } from '@app/angular/constants/checkout'\nimport {\n  FIRST_ORDER_KEY,\n  MEMBERSHIP_STATUSES,\n  EXPRESS_SUBSCRIPTION_PLAN_TERMS,\n} from '@app/angular/constants/express'\nimport { CART_TYPES } from '@app/angular/constants/cart'\nimport desktopTemplate from './views/checkoutPage.desktop.html'\nimport mobileTemplate from './views/checkoutPage.mobile.html'\n\nexport default angular\n  .module('CheckoutPageControllerModule', [])\n  .controller(\n    'CheckoutPageController',\n    function (\n      $element,\n      $filter,\n      $q,\n      $rootScope,\n      $scope,\n      $state,\n      Restangular,\n      addressList,\n      analytics,\n      auth,\n      cartService,\n      checkoutAnalytics,\n      checkoutService,\n      config,\n      errorModalService,\n      express,\n      lang,\n      localStorageService,\n      mobileService,\n      paymentGateway,\n      reservationService,\n      upsellProducts,\n      utilService\n    ) {\n      const { intent } = auth\n      const filterCurrencyFn = $filter('currency')\n\n      Object.assign($scope, {\n        CART_TYPES,\n        cartService,\n        checkoutAnalytics,\n        config,\n        /**\n         * Needed for making the checkout-summary component aware of the\n         * step that is currenly on edit mode\n         */\n        currentEditStep: null,\n        gatewayService: null,\n        intent,\n        isPlaceOrderButtonEnabled: false,\n        isPlacingOrder: false,\n        lang,\n        mobileService,\n        payment: null,\n        express,\n        cartType: cartService.getCurrentCartType(),\n\n        termsAndConditionsMessage: () => {\n          const shoppingMode = auth.getCurrentShoppingMode()\n\n          const {\n            termsAndConditionsMessage,\n            termsAndConditionsMessageDeferredAuth,\n            termsAndConditionsByIntent,\n          } = lang.values\n\n          const message = reservationService?.reservation?.full_auth_will_defer\n            ? termsAndConditionsMessageDeferredAuth\n            : termsAndConditionsMessage\n\n          return lang.template(termsAndConditionsByIntent?.[shoppingMode] || message, {\n            customAuthAmount: filterCurrencyFn(cartService.getAuthorizationAmount()),\n          })\n        },\n      })\n\n      const focusOnPage = () => {\n        const containerToFocusOn =\n          document.getElementById('checkout-page-desktop-container') || $element[0]\n        if (containerToFocusOn) {\n          utilService.trapFocusOn(containerToFocusOn)\n          containerToFocusOn.focus()\n        }\n      }\n\n      const onInit = () => {\n        focusOnPage()\n      }\n      onInit()\n\n      /**\n       * This method executes everytime the checkout-steps\n       * component changes its validation status\n       *\n       * @returns { undefined }\n       */\n      $scope.handleValidationChange = isValid => {\n        $scope.isPlaceOrderButtonEnabled = isValid\n      }\n\n      /**\n       * Executes when a step changes to edit mode.\n       *\n       * @returns { undefined }\n       */\n      $scope.handleStepEditMode = stepID => {\n        $scope.currentEditStep = stepID\n      }\n\n      const handleExpressSubscribeError = () => {\n        const { subscriptionErrorMessage, name } = config.icExpress\n\n        errorModalService\n          .open(lang.template(subscriptionErrorMessage, { name }).toString(), lang.values.ok)\n          .finally(focusOnPage())\n        return $q.reject()\n      }\n\n      const handleExpressSubscribe = async () => {\n        const membershipStatus = express.getMembershipStatus()\n\n        if ($scope.shouldSubscribeToExpress() && !$scope.shouldSubscribeToExpressPostCheckout()) {\n          const planId =\n            membershipStatus === MEMBERSHIP_STATUSES.TRIAL_ELIGIBLE\n              ? await express.getPlanIds(EXPRESS_SUBSCRIPTION_PLAN_TERMS.TRIAL)\n              : await express.getPlanIds(EXPRESS_SUBSCRIPTION_PLAN_TERMS.YEARLY)\n\n          const { ext_id, ext_payer_id } = $scope.payment?.auth_capture?.payment_instrument || {}\n\n          const payload = {\n            ext_id,\n            ext_payer_id,\n            subscription_plan_id: planId,\n          }\n\n          return express.subscribe(payload).then($q.resolve).catch(handleExpressSubscribeError)\n        }\n\n        return $q.resolve()\n      }\n\n      $scope.shouldSubscribeToExpress = () => {\n        return (\n          config.icExpress.enabled &&\n          express.isIcExpressOptedIn &&\n          [MEMBERSHIP_STATUSES.TRIAL_ELIGIBLE, MEMBERSHIP_STATUSES.MEMBERSHIP_ELIGIBLE].includes(\n            express.getMembershipStatus()\n          )\n        )\n      }\n\n      $scope.shouldSubscribeToExpressPostCheckout = () =>\n        $scope.shouldSubscribeToExpress() && !express.shouldCreateSubscriptionAtCheckout()\n\n      /**\n       * Places an order\n       *\n       * @returns { Promise }\n       */\n      $scope.placeOrder = () => {\n        $scope.isPlacingOrder = true\n\n        return handleExpressSubscribe()\n          .then($scope.handleBillingInformationCheckout)\n          .then($scope.checkout)\n          .finally(() => ($rootScope.isAppLoading = false))\n      }\n\n      const handleGenericError = () => {\n        checkoutService.setError({ message: lang.values.defaultErrorMessage })\n      }\n\n      const handleBillingInformationError = () => {\n        checkoutService.setError({ message: lang.values.invalidBillingAddress })\n      }\n\n      $scope.handleBillingInformationCheckout = () => {\n        const isDelivery = auth.getContext().intent === FULFILLMENT_TYPES.DELIVERY\n        const { billing_address } = auth.user\n\n        if (!config.enableBillingInformation || $scope.payment.payment_type !== 'auth_capture') {\n          return $q.resolve()\n        }\n\n        if (isDelivery && checkoutService.isBillingAddressSameAsDelivery) {\n          return checkoutService\n            .getSelectedDeliveryAddress(true)\n            .then(({ address1, city, province, postal_code }) => {\n              auth\n                .updateProfile({\n                  billing_address: {\n                    address1,\n                    city,\n                    province,\n                    postal_code,\n                  },\n                })\n                .catch(handleGenericError)\n            })\n            .catch(handleGenericError)\n        }\n        if (!checkoutService.isBillingAddressValid(billing_address)) {\n          handleBillingInformationError()\n          return $q.reject()\n        }\n        return $q.resolve()\n      }\n\n      const _handleCheckoutSuccess = () => {\n        const { icExpress } = config\n        const { firstOrder } = icExpress.placements\n        const shoppingIntent = auth.getContext().intent\n\n        if (icExpress.enabled && firstOrder[shoppingIntent] && firstOrder[shoppingIntent].enabled) {\n          localStorageService.deprecatedSet(FIRST_ORDER_KEY, true)\n        }\n        localStorageService.removeItem('firstIWSAlcoholicProductAdded')\n        checkoutService.isCartValidated = false\n      }\n\n      /**\n       * Handles checkout\n       *\n       * @returns {Promise}\n       */\n      $scope.checkout = () => {\n        $rootScope.isAppLoading = true\n\n        const additionalParams = {\n          cart_id: cartService.getCartId(cartService.getCurrentCartType()),\n          checkoutErrorCallback: focusOnPage,\n        }\n\n        if ($scope.shouldSubscribeToExpressPostCheckout()) {\n          additionalParams.postCheckoutRoute = 'main.checkout.icExpressOrderConfirmation'\n        }\n\n        return checkoutService\n          .performCheckout($scope.payment, $scope.gatewayService, additionalParams)\n          .then(_handleCheckoutSuccess)\n          .catch(() => {\n            $scope.isPlacingOrder = false\n            $rootScope.isAppLoading = false\n          })\n      }\n\n      /**\n       * Executes every time the payment method inside the checkout steps component\n       * gets updated\n       *\n       * @returns {undefined}\n       */\n      $scope.handlePaymentUpdate = payment => {\n        $scope.payment = payment\n        if (payment?.payment_type) {\n          $scope.gatewayService = paymentGateway.getService(payment.payment_type)\n        }\n      }\n\n      /**\n       * Executes every time the contact info inside the checkout steps component\n       * gets updated\n       *\n       * @returns {undefined}\n       */\n      $scope.handleContactUpdate = contact => {\n        $scope.contact = contact\n      }\n\n      const getUpsellRoute = () => {\n        return config.newCheckoutFlow.upsellPage.enabled\n          ? 'main.checkout.customUpsell'\n          : 'main.checkout.manualUpsell'\n      }\n      /**\n       * Handles going back from the checkout page\n       *\n       * @returns {undefined}\n       */\n      $scope.goBack = () => {\n        $state.go(upsellProducts.length > 0 ? getUpsellRoute() : 'main.checkout.cart')\n      }\n\n      /**\n       * Handles the checkout exit event by redirecting users to the cart review page\n       *\n       * @returns {undefined}\n       */\n      $scope.handleCheckoutExit = () => {\n        $state.go('main.checkout.cart', { cart_type: $state.params.cart_type })\n      }\n\n      $scope.showTermsAndConditions = () => {\n        const { rewards } = config\n        const isRewardsEnabled = rewards.visible.length > 0\n        const showTermsAndConditions =\n          !cartService.isCartBelowMin() &&\n          config.showTermsAndConditions[auth.getCurrentShoppingMode()]\n\n        if (!isRewardsEnabled) return showTermsAndConditions\n\n        return checkoutService.isCartValidated && showTermsAndConditions\n      }\n    }\n  )\n  .run($templateCache => {\n    $templateCache.put('checkoutPage.desktop.html', desktopTemplate)\n    $templateCache.put('checkoutPage.mobile.html', mobileTemplate)\n  })\n","import _ from 'lodash'\nimport angular from 'angular'\nimport { USER_PAYMENT_ACTION } from '@app/angular/services/modules/analytics/analyticsConstants'\nimport { PAYMENT_CONTEXTS, PAYMENT_TYPES } from '@app/angular/constants/payments'\n\nconst EVENT_TRIGGER_DELAY = 250\n\nexport default angular\n  .module('CheckoutPaymentControllerModule', [])\n  .controller(\n    'CheckoutPaymentController',\n    function (\n      $filter,\n      $q,\n      $rootScope,\n      $scope,\n      $state,\n      $timeout,\n      $window,\n      Restangular,\n      addressList,\n      analytics,\n      auth,\n      cartService,\n      checkoutAnalytics,\n      checkoutService,\n      config,\n      errorModalService,\n      lang,\n      mobileService,\n      payment,\n      paymentGateway,\n      reservationService,\n      subscriptionsService\n    ) {\n      Object.assign(\n        $scope,\n        { auth, cartService, config, payment, reservationService, addressList },\n        {\n          giftCard: {},\n          cartIsValidated: false,\n          tipIsValid: true,\n          form: {},\n        }\n      )\n\n      // In this case of modify order, set the previous payment instrument into payment\n      const modifiedOrder = cartService.cart?.order\n      const existingPaymentInstrument = modifiedOrder?.payment_instruments?.[0]\n      const existingPaymentType = modifiedOrder?.payment_type\n\n      $scope.paymentContext = PAYMENT_CONTEXTS.CHECKOUT\n\n      if (existingPaymentType && payment) {\n        payment.payment_type = existingPaymentType\n        payment[existingPaymentType] = existingPaymentInstrument\n      }\n\n      // Extend the payment object if needed\n      if (!$scope.payment.gift_cards) {\n        $scope.payment.gift_cards = []\n      }\n\n      /**\n       * This method executes everytime a new card is added\n       *\n       * @returns { undefined }\n       */\n      $scope.checkoutNewCreditCard = success => {\n        $timeout(() => {\n          const { payment } = $scope\n\n          checkoutAnalytics.addPaymentOption({\n            payment,\n            success,\n            user_action: USER_PAYMENT_ACTION.PAYMENT_CHANGE,\n          })\n        }, EVENT_TRIGGER_DELAY)\n      }\n\n      $scope.onShowCardForm = () => {\n        checkoutAnalytics.addCreditCardOpen()\n      }\n\n      cartService\n        .fetch()\n        .then(() => $scope.validateCart())\n        .then(validated => ($scope.cartIsValidated = validated || $scope.cartIsValidated))\n\n      $scope.validateCart = () =>\n        cartService.validateCart({\n          cart_id: cartService.getCartId(cartService.getCurrentCartType()),\n        })\n\n      // Fetch Subscriptions\n\n      subscriptionsService.fetch().then(subscriptions => {\n        $scope.subscriptions = subscriptions\n\n        // Generate a label for subscriptions which includes the price\n\n        $scope.subscriptionLabel = function (product) {\n          const currentSubscription = product || $scope.subscription\n          if (currentSubscription) {\n            return `${currentSubscription.name} For ${$filter('currency')(\n              currentSubscription.base_price\n            )}`\n          }\n        }\n\n        // Check whether user has one of the subscription products in their cart\n        $scope.getSubscription = function () {\n          let found = null\n          _.each($scope.subscriptions, subscription => {\n            const item = cartService.getItem(subscription)\n            if (item) {\n              found = item\n            }\n          })\n          return found ? found.store_product : null\n        }\n\n        // Select a subscription by default\n\n        $scope.subscription = $scope.getSubscription() || subscriptions[0]\n      })\n\n      $scope.loadImage = function (paytype) {\n        return require(`static/images/payment-${paytype}`)\n      }\n\n      // Add a gift card\n\n      $scope.addGiftCard = function () {\n        if (!$scope.giftCard.giftCardNumber || !$scope.giftCard.giftCardAmount) {\n          errorModalService.open('You must enter a gift card and an amount', 'OK')\n          return\n        }\n\n        if (\n          config.giftCardLength &&\n          $scope.giftCard.giftCardNumber.length !== config.giftCardLength\n        ) {\n          errorModalService.open(`Gift card must be ${config.giftCardLength} characters.`, 'OK')\n          return\n        }\n\n        // Make a clone so we can add the card temporarily in order to sync\n        // and then remove from the frontend pending being returned again be the\n        // backend after being validated\n\n        const giftCardsClone = angular.copy($scope.payment.gift_cards)\n\n        $scope.payment.gift_cards.push({\n          amount: $scope.giftCard.giftCardAmount,\n          card_number: $scope.giftCard.giftCardNumber,\n        })\n\n        // Push the new gift card to the backend\n\n        $scope.payment.put().then(\n          response => {\n            $scope.payment.gift_cards = response.gift_cards // Replace the local cards list with the reponse version\n\n            delete $scope.giftCard.giftCardAmount\n            delete $scope.giftCard.giftCardNumber\n\n            checkoutAnalytics.addPaymentOption({\n              payment: $scope.payment || {},\n              success: true,\n              user_action: USER_PAYMENT_ACTION.GIFT_CARD_CHANGE,\n            })\n          },\n          response => {\n            errorModalService.open(response.data ? response.data.message : response.message, 'OK')\n            checkoutAnalytics.addPaymentOption({\n              payment: $scope.payment || {},\n              success: false,\n              user_action: USER_PAYMENT_ACTION.GIFT_CARD_CHANGE,\n            })\n          }\n        )\n\n        // Revert to the cloned card list\n\n        $scope.payment.gift_cards = giftCardsClone\n      }\n\n      // Remove a gift card\n\n      $scope.removeGiftCard = function (index) {\n        $scope.payment.gift_cards.splice(index, 1)\n        $scope.payment.put()\n      }\n\n      // If this is a reorder with a previous gift card, ensure that it is applied.\n      $scope.$watch(\n        () => cartService.lastUpdated,\n        (_newVal, _oldVal) => {\n          if (cartService.cart && cartService.cart.order && cartService.cart.order.gift_cards) {\n            const giftCards = cartService.cart.order.gift_cards\n            let promise = $q.all([])\n            _.forEach(giftCards, giftCard => {\n              // $timeout is needed to pass a potential array of unique gift cards through the input\n              promise = promise.then(() => {\n                return $timeout(() => {\n                  $scope.giftCard.giftCardAmount = giftCard.amount.toString()\n                  $scope.giftCard.giftCardNumber = giftCard.card_number.toString()\n                  $scope.addGiftCard()\n                }, 2000)\n              })\n            })\n          }\n        }\n      )\n\n      $scope.getPaymentTypes = () => {\n        const paymentTypes =\n          auth.user.store.payment_types[reservationService.reservation?.timeslot.fulfillment_type]\n\n        if (mobileService.isMobileApp() || window.inAppBrowser) {\n          return paymentTypes.filter(p => p !== PAYMENT_TYPES.PAYPAL)\n        }\n\n        return paymentTypes\n      }\n\n      //\n      //  Payment Functions\n      //\n\n      let gatewayService\n\n      /**\n       * Updates the payment type\n       * @param   { boolean }  logAnalytics:     Optional: True if logging the edit_payment event\n       * @returns { undefined }\n       */\n\n      $scope.updatePaymentType = function (logAnalytics = false) {\n        gatewayService = paymentGateway.getService($scope.payment.payment_type)\n        if (logAnalytics) {\n          try {\n            checkoutAnalytics.editPaymentOptions({\n              payment: $scope.payment,\n              paymentLabel:\n                lang.values.paymentTypes[$scope.payment.payment_type][\n                  reservationService.reservation.timeslot.fulfillment_type\n                ],\n              success: true,\n              user_action: USER_PAYMENT_ACTION.PAYMENT_CHANGE,\n            })\n          } catch (e) {}\n        }\n\n        $scope.paymentTypeValid = gatewayService.status // gatewayService.update is an object -> {ready: T/F} so that we can get that inheritance magic\n        $scope.selectedGateway = paymentGateway.getTemplate($scope.payment.payment_type)\n      }\n\n      // Set `$scope.payment.payment_type` if there is only one possible type.\n      const paymentTypes = auth.user.store.payment_types[auth.getContext().intent]\n      if (paymentTypes && paymentTypes.length === 1) {\n        $scope.payment.payment_type = paymentTypes[0]\n      }\n\n      if ($scope.payment.payment_type) {\n        $scope.updatePaymentType()\n      }\n\n      // Post and validate checkout\n      $scope.checkout = function () {\n        $scope.waitingForCheckout = true\n        $rootScope.isAppLoading = true\n\n        return checkoutService\n          .performCheckout($scope.payment, gatewayService, {\n            cart_id: cartService.getCartId(cartService.getCurrentCartType()),\n          })\n          .catch(() => {\n            $scope.waitingForCheckout = false\n            $rootScope.isAppLoading = false\n          })\n      }\n\n      $scope.addSubscription = subscription => {\n        cartService.addItem(subscription).then(cartService.validateCart)\n        $scope.subscription = subscription\n      }\n\n      $scope.paymentPageCompletion = function () {\n        $scope.waitingForCheckout = true // Lock the Order button, this is currently the first function it hits.\n        if (config.enableBillingInformation && $scope.payment.payment_type === 'auth_capture') {\n          $scope.submitBillingInformation()\n        } else {\n          $scope.checkout()\n        }\n      }\n\n      // if the context is delivery ensure the customers account has been linked to instacart\n      $scope.hasICAccountLinked = () => {\n        if (\n          auth.user &&\n          auth.user.status !== 'trial' &&\n          auth.getContext().intent === 'delivery' &&\n          config.instacart.enableAccountLinking\n        ) {\n          return auth.user.ic_linked\n        }\n        return true\n      }\n\n      $scope.hasFailedLoadingMultipleDeliveryAddresses = () => {\n        return (\n          config.enableMultipleDeliveryAddresses &&\n          auth.user.context.intent === 'delivery' &&\n          !addressList.addressesLoaded\n        )\n      }\n\n      $rootScope.$on('reservationExpired', () =>\n        $state.go('main.checkout.reservation.confirmation')\n      )\n\n      $scope.shouldShowPaymentWarning = () =>\n        Boolean(lang.values?.paymentWarning && lang.values?.paymentWarning !== '')\n    }\n  )\n","import angular from 'angular'\n\nexport default angular\n  .module('ReservationControllerModule', [])\n  .controller(\n    'ReservationController',\n    function ($scope, $state, Restangular, auth, cartService, config, reservationService) {\n      $scope.auth = auth\n      $scope.cartService = cartService\n      $scope.reservationService = reservationService\n      $scope.state = $state\n      $scope.shoppingIntent = auth.user.context.intent\n    }\n  )\n","import _ from 'lodash'\nimport angular from 'angular'\n\nexport default angular\n  .module('FulfillmentAddressControllerModule', [])\n  .controller(\n    'FulfillmentAddressController',\n    function (\n      $q,\n      $rootScope,\n      $scope,\n      $state,\n      $stateParams,\n      Restangular,\n      addressList,\n      addressValidationService,\n      analytics,\n      auth,\n      cartService,\n      checkoutAnalytics,\n      compareCartService,\n      config,\n      errorModalService,\n      lang,\n      registrationService,\n      reservationService,\n      shoppingSelectorService,\n      storesService\n    ) {\n      $scope.auth = auth\n      $scope.cartService = cartService\n      $scope.config = config\n      $scope.reservationService = reservationService\n      $scope.state = $state\n      $scope.stateParams = $stateParams\n      $scope.shoppingSelectorService = shoppingSelectorService\n      $scope.shoppingIntent = auth.user.context.intent\n      $scope.showMultipleDeliveryAddresses =\n        $scope.shoppingIntent === 'delivery' && config.enableMultipleDeliveryAddresses\n      $scope.showStoreMap =\n        $scope.shoppingIntent === 'pickup' || config.checkout.showMapWhenDelivery\n      $scope.addressValidationModalClosed = true\n      $scope.selectedDeliveryAddress = {}\n      // Form is added in a child scope.\n      $scope.forms = {}\n\n      // New users can occasionally hit the checkout with a missing context. If this\n      // happens let's just hard set it to the defaultShoppingContext.\n      // TODO: Try to find the source of this bug, it seems to be HEB specific &\n      // only occurs about 10% of the time on new user registrations...\n      if (!auth.user.context.intent) {\n        shoppingSelectorService.forceContextIntentSet()\n        $rootScope.reloadState()\n      }\n\n      // Construct regex object for validating postal codes\n\n      $scope.postalCodePattern = new RegExp(config.postalCodePattern, 'i')\n\n      // Copy attributes from the user object on init or from updated API response\n\n      const initDeliveryAddressModel = sourceData => {\n        $scope.deliveryAddress = {\n          delivery_address: {\n            first_name: sourceData.delivery_address.first_name,\n            last_name: sourceData.delivery_address.last_name,\n            company_name: sourceData.delivery_address.company_name,\n            address1: sourceData.delivery_address.address1,\n            address2: sourceData.delivery_address.address2,\n            city: sourceData.delivery_address.city,\n            province: sourceData.delivery_address.province,\n            postal_code: sourceData.delivery_address.postal_code,\n            instructions: sourceData.delivery_address.instructions,\n          },\n        }\n\n        _.each(config.deliveryAddressPhoneNumberFields, field => {\n          $scope.deliveryAddress[field.key] = sourceData[field.key]\n        })\n\n        if (sourceData.primary_number_key) {\n          $scope.deliveryAddress.primary_number_key = sourceData.primary_number_key\n        } else {\n          $scope.deliveryAddress.primary_number_key = config.phone.defaultRequired\n        }\n      }\n\n      initDeliveryAddressModel($scope.auth.user)\n\n      if (!$scope.showMultipleDeliveryAddresses) {\n        $scope.selectedDeliveryAddress = $scope.deliveryAddress.delivery_address\n      }\n\n      const getInitDeliveryAddress = () => {\n        const contextAddress = auth.getAddressFromContext()\n\n        return contextAddress.id ? addressList.getAddressFromId(contextAddress.id) : contextAddress\n      }\n\n      $scope.initialDeliveryAddress = getInitDeliveryAddress()\n\n      $scope.deliveryAddressChanged = address => {\n        $scope.selectedDeliveryAddress = address\n      }\n\n      // Validate and save delivery address / contact information\n\n      const getDeliveryAddress = () =>\n        $scope.showMultipleDeliveryAddresses\n          ? $scope.selectedDeliveryAddress\n          : $scope.deliveryAddress.delivery_address\n      const goToNextStep = () => {\n        checkoutAnalytics.editFulfillmentOptions({ success: true })\n        return $state.go('main.checkout.reservation.confirmation')\n      }\n\n      $scope.saveDeliveryAddress = function () {\n        const isAddressDifferentFromContext = (address, context) => {\n          // Postal code has changed or\n          // requireFullAddress and address1/street_address changed.\n          return (\n            address.postal_code !== context.deliveryPostalCode ||\n            (config.shoppingContextProcess.delivery.requireFullAddress &&\n              address.address1 !== context.street_address)\n          )\n        }\n\n        // If delivery, confirm address/postal_code hasn't changed and context address is still valid.\n        // If pickup, continue to confirmation.\n        const proceed = function () {\n          // Multiple delivery addresses is enabled && delivery\n          if ($scope.showMultipleDeliveryAddresses) {\n            const postalCodeChanged =\n              $scope.selectedDeliveryAddress.postal_code !==\n              $scope.auth.user.context.deliveryPostalCode\n            const addressChanged =\n              $scope.selectedDeliveryAddress.postal_code !==\n                $scope.auth.user.context.deliveryPostalCode ||\n              $scope.selectedDeliveryAddress.id !== $scope.auth.user.context.address_id ||\n              $scope.selectedDeliveryAddress.address1 !== $scope.auth.user.context.street_address\n            $scope.checkDelivery(addressChanged, postalCodeChanged)\n          } else if ($scope.shoppingIntent === 'delivery') {\n            const addressChanged = isAddressDifferentFromContext(\n              $scope.deliveryAddress.delivery_address,\n              $scope.auth.user.context\n            )\n            $scope.checkDelivery(addressChanged, addressChanged)\n          } else {\n            // Pickup mode\n            goToNextStep()\n          }\n        }\n\n        // Save user and continue.\n        const updateUser = updateUserPayload => {\n          auth.updateProfile(updateUserPayload).then(\n            deliveryAddressResponse => {\n              initDeliveryAddressModel(deliveryAddressResponse)\n              proceed()\n            },\n            response => {\n              if (response.error === 40304) {\n                registrationService.promptLogin(\n                  'main.checkout.reservation.address',\n                  '',\n                  '',\n                  '',\n                  lang.values.loginToContinue\n                )\n              } else {\n                errorModalService.open(\n                  response.data ? response.data.message : response.message,\n                  'OK'\n                )\n              }\n            }\n          )\n        }\n\n        // Multiple delivery addresses enabled and in delivery mode.\n        if ($scope.showMultipleDeliveryAddresses) {\n          if (addressList.isDeliveryAddressComplete($scope.selectedDeliveryAddress)) {\n            // Validate if validation is enabled, else proceed.\n            if (\n              config.enableExternalAddressValidation &&\n              !addressList.checkAddressValidated($scope.selectedDeliveryAddress.id)\n            ) {\n              addressList\n                .validateAddressAndSaveIfChanged($scope.selectedDeliveryAddress)\n                .then(proceed)\n            } else {\n              proceed()\n            }\n          } else {\n            errorModalService.open('Please fill out all required fields in the address', 'OK')\n          }\n        } else if (\n          auth.validateFulfillmentContactInfo($scope.shoppingIntent, $scope.deliveryAddress)\n        ) {\n          const formIsDirty =\n            $scope.forms.deliveryAddressForm && $scope.forms.deliveryAddressForm.$dirty\n          // Validate address only if validation is enabled and delivery mode\n          if (config.enableExternalAddressValidation && $scope.shoppingIntent === 'delivery') {\n            const originalAddress = angular.copy($scope.deliveryAddress.delivery_address)\n            addressList.validateAddress($scope.deliveryAddress.delivery_address).then(address => {\n              if (\n                addressValidationService.areAddressesSame(originalAddress, address) &&\n                !formIsDirty\n              ) {\n                proceed()\n              } else {\n                updateUser($scope.deliveryAddress)\n              }\n            })\n            // If address validation is disabled and the form is $dirty, updateUser\n          } else if (formIsDirty) {\n            updateUser($scope.deliveryAddress)\n          } else {\n            proceed()\n          }\n        } else {\n          errorModalService.open('Please fill out all required fields', 'OK')\n        }\n      }\n\n      // Check if a preferred phone number has been set, if it hasn't, use the number type of the input box that is calling this function.\n      // Only do this if they haven't already selected their preferred phone number\n\n      $scope.setPreferredPhoneNumber = function (numberType) {\n        if ($scope.deliveryAddress.primary_number_key === null) {\n          $scope.deliveryAddress.primary_number_key = numberType\n        }\n      }\n\n      const showAddressChangedModal = address => {\n        const { address1, city, province, postal_code } = address\n        const { deliveryMismatchedPostalCodes, yes, no } = lang.values\n        const message = `${deliveryMismatchedPostalCodes}<br /><br />${address1}<br />${city}, ${province} ${postal_code}`\n        return errorModalService.open(message, yes, no)\n      }\n\n      const showStoreChangedModal = store => {\n        const { storeSuggestionError, yes, no } = lang.values\n        const message = `${storeSuggestionError}<br /><br />${store.name}`\n        return errorModalService.open(message, yes, no)\n      }\n\n      // Check if there is an available store to deliver to this postal code\n      $scope.checkDelivery = (addressUpdated, postalCodeChanged) => {\n        const deliveryAddress = getDeliveryAddress()\n        const addressParams = auth.getContextFromAddress(deliveryAddress)\n        const addressUrlParams = auth.getUrlParamsFromAddress(deliveryAddress)\n        // Get stores.\n        return storesService\n          .fetch({\n            delivery_postal_code: addressUrlParams.delivery_postal_code,\n            show_delivery: true,\n          })\n          .then(\n            stores => {\n              // Check if there is a store that can deliver to that postal code\n              if (stores.length === 0) {\n                return errorModalService.open(lang.values.noDeliveryToPostalCodeError, 'OK')\n              }\n              // There are stores, check if user store is in the list\n              const storeUnchanged = !!_.find(stores, { id: auth.user.store.id })\n\n              // Address AND store are the same.\n              if (storeUnchanged && !addressUpdated) {\n                return goToNextStep()\n              }\n              if (storeUnchanged) {\n                const cartCompareCheck = () =>\n                  compareCartService\n                    .compareCart(true, 'address', addressUrlParams)\n                    .then(() => auth.setContext(addressParams))\n                    .then(goToNextStep)\n                if (postalCodeChanged) {\n                  return showAddressChangedModal(deliveryAddress).then(cartCompareCheck)\n                }\n                return cartCompareCheck()\n              }\n              return (\n                showAddressChangedModal(deliveryAddress)\n                  .then(() => showStoreChangedModal(stores[0]))\n                  // cartCompare store should be enough if the address and store have changed.\n                  .then(() =>\n                    compareCartService.compareCart(true, 'store', {\n                      ...addressUrlParams,\n                      store_id: stores[0].id,\n                    })\n                  )\n                  // Make these two requests at the same time possibly causes a race condition.\n                  .then(() => auth.setContext(addressParams))\n                  .then(() => auth.update({ store_id: stores[0].id }))\n                  .then(goToNextStep)\n              )\n            },\n            response => {\n              // Checking available stores for postal code failed.\n              errorModalService.open(response.data ? response.data.message : response.message, 'OK')\n              checkoutAnalytics.editFulfillmentOptions({ success: false })\n            }\n          )\n      }\n    }\n  )\n","import angular from 'angular'\nimport dayjs from 'dayjs'\nimport { DEFAULT_TIMESLOT_DATE_FORMAT } from '@app/angular/constants/timeslots'\nimport { utils as timeslotUtils } from '@instacart/enterprise-timeslots'\n\nexport default angular\n  .module('ReservationConfirmationControllerModule', [])\n  .controller(\n    'ReservationConfirmationController',\n    function (\n      $injector,\n      $interval,\n      $q,\n      $rootScope,\n      $scope,\n      $state,\n      $timeout,\n      addressList,\n      auth,\n      cartService,\n      checkoutService,\n      compareCartService,\n      config,\n      errorModalService,\n      reservationService,\n      shoppingSelectorService,\n      storesService\n    ) {\n      $scope.config = config\n      $scope.inCheckout = $state.includes('main.checkout')\n      $scope.shoppingSelectorService = shoppingSelectorService\n      $scope.shoppingIntent = auth.getContext().intent\n      $scope.compareCartService = compareCartService\n      $scope.showMultipleDeliveryAddresses =\n        $scope.shoppingIntent === 'delivery' && config.enableMultipleDeliveryAddresses\n\n      $scope.showHomeStore = $scope.shoppingIntent !== 'delivery'\n      $scope.showDeliveryFees =\n        $scope.shoppingIntent === 'delivery' &&\n        !config.shoppingSelector.delivery.fulfilledByInstacart\n      $scope.handleProfileThroughGigya = auth.shouldUseGigyaAddressEdit()\n      $scope.deliveryAddress = {}\n      $scope.isReservationExpired = false\n\n      if ($scope.showMultipleDeliveryAddresses) {\n        addressList.fetchAddressPromise.then(() => {\n          $scope.deliveryAddress = addressList.getAddressFromId(auth.getContext().address_id)\n        })\n      } else {\n        $scope.deliveryAddress = auth.user.delivery_address\n      }\n\n      const gigyaService = $scope.handleProfileThroughGigya ? $injector.get('gigyaService') : null\n\n      $scope.handleAddressEdit = () => {\n        gigyaService.gigyaCheckoutAddress()\n      }\n\n      // If the user arrives without a reservation, open the timeslot selection modal by default\n      if (!reservationService.reservation) {\n        shoppingSelectorService.open('timeslot')\n      }\n\n      const reservationInterval = $interval(() => {\n        if (!reservationService.reservation) {\n          $scope.isReservationExpired = true\n          return\n        }\n\n        const expirationInSeconds = dayjs(reservationService.reservation.expiration)\n          .utc()\n          .diff(dayjs().utc(), 'seconds')\n\n        if (expirationInSeconds >= 0 || cartService.cart.order) {\n          $scope.isReservationExpired = false\n          return\n        }\n\n        reservationService.deleteReservation().then(() => {\n          $timeout(() => shoppingSelectorService.open('timeslot'), 1000)\n        })\n        $scope.isReservationExpired = true\n      }, 1000)\n\n      // Format the expiration time based\n\n      $scope.expiryLabel = function () {\n        if (!reservationService.reservation) {\n          return ''\n        }\n\n        const minutes = dayjs(reservationService.reservation.expiration)\n          .utc()\n          .diff(dayjs().utc(), 'minutes')\n        const seconds = dayjs(reservationService.reservation.expiration)\n          .utc()\n          .diff(dayjs().utc(), 'seconds')\n\n        if (minutes > 60) {\n          return `${Math.floor(minutes / 60)} hours ${minutes % 60} minutes`\n        }\n\n        if (seconds <= 0) {\n          return 'Your time slot is expired'\n        }\n        return `Your time slot will expire in ${minutes} minutes and ${seconds % 60} seconds`\n      }\n\n      const handleStoreNotInListError = (store, postalCode) => {\n        const modalTitle = `\n        ${config.lang.storeSuggestionError}\n        <br /><br />\n        ${store.name}\n      `\n\n        errorModalService.open(modalTitle, 'Yes', 'No').then(() => {\n          compareCartService\n            .compareCart(true, 'store', { store_id: store.id, delivery_postal_code: postalCode })\n            .then(() => {\n              // Update context to new store and then proceed to reservation confirmation\n              $q.all([\n                auth.update({ store_id: store.id }),\n                auth.setContext({ deliveryPostalCode: postalCode }),\n              ])\n                .then($rootScope.reloadState) // store has changed update cart, reservation, etc.\n                .then(() => {\n                  $state.go('main.checkout.reservation.confirmation')\n                })\n            })\n        })\n      }\n\n      const handleDeliveryValidation = ({ isValid, errorType }, successCallback) => {\n        if (isValid) {\n          return successCallback()\n        }\n\n        switch (errorType) {\n          case 'NO_STORES_FOUND':\n            errorModalService.open(config.lang.noDeliveryToPostalCodeError, 'OK')\n            break\n          case 'STORE_NOT_IN_THE_LIST': {\n            const suggestedStore = storesService.stores[0]\n            const postalCode = auth.user.delivery_address.postal_code\n            handleStoreNotInListError(suggestedStore, postalCode)\n            break\n          }\n          default:\n            // eslint-disable-next-line no-throw-literal\n            throw `Error: unknown validateDelivery error type: ${errorType}`\n        }\n      }\n\n      $scope.timeslotLabelFn = () =>\n        timeslotUtils.getMainLabel($scope.reservationService.reservation, {\n          verboseLevel: 1,\n          format: $scope.reservationService.reservation\n            ? config.apiDateFormat\n            : DEFAULT_TIMESLOT_DATE_FORMAT,\n        })\n\n      $scope.toPayment = function () {\n        const successCallback = () => {\n          if (\n            ($scope.showMultipleDeliveryAddresses &&\n              addressList.isDeliveryAddressComplete($scope.deliveryAddress)) ||\n            (!$scope.showMultipleDeliveryAddresses &&\n              auth.validateFulfillmentContactInfo(\n                reservationService.reservation.timeslot.fulfillment_type,\n                auth.user\n              ))\n          ) {\n            $scope.compareCartService.compareCart(true, 'reservation').then(() => {\n              $state.go('main.checkout.payment')\n              checkoutService.setDeliveryAddress($scope.deliveryAddress)\n            })\n          } else {\n            errorModalService.open('Please complete your contact information.', 'OK')\n          }\n        }\n\n        // If Gigya is enabled and the context is \"delivery\" we do address validation here\n        if (config.gigya && config.gigya.enabled && auth.user.context.intent === 'delivery') {\n          storesService\n            .validateDelivery($scope.deliveryAddress.postal_code, auth.user.store.id)\n            .then(res => {\n              handleDeliveryValidation(res, successCallback)\n            })\n        } else {\n          successCallback()\n        }\n      }\n\n      $rootScope.$on('$stateChangeStart', (event, toState, toParams, fromState) => {\n        if (fromState.name === 'main.checkout.reservation.confirmation') {\n          $interval.cancel(reservationInterval)\n        }\n      })\n    }\n  )\n","import angular from 'angular'\n\nimport DefaultPaymentServiceModule from './paymentGateways/default/defaultPaymentsService'\nimport PaypalPaymentServiceModule from './paymentGateways/payPal/paypalPaymentService'\nimport HouseAccountPaymentServiceModule from './paymentGateways/houseAccount/houseAccountPaymentService'\n\n// Cannot lazyload these as they are needed in nested views\nimport HouseAccountControllerModule from './paymentGateways/houseAccount/houseAccountController'\nimport CheckoutCartControllerModule from './checkoutCartController' // cannot lazy import as sidecart extends it\nimport CheckoutConfirmationController from './checkoutConfirmationController'\nimport CheckoutManualUpsellController from './checkoutManualUpsellController'\nimport CheckoutPageController from './checkoutPageController'\nimport CheckoutPaymentController from './checkoutPaymentController'\nimport ReservationController from '../reservation/reservationController'\nimport FulfillmentAddressController from '../reservation/fulfillmentAddressController'\nimport ReservationConfirmationController from '../reservation/reservationConfirmationController'\n\nexport default angular.module('CheckoutComponentModule', [\n  DefaultPaymentServiceModule.name,\n  PaypalPaymentServiceModule.name,\n  HouseAccountPaymentServiceModule.name,\n  HouseAccountControllerModule.name,\n  CheckoutCartControllerModule.name,\n  CheckoutConfirmationController.name,\n  CheckoutManualUpsellController.name,\n  CheckoutPageController.name,\n  ReservationController.name,\n  FulfillmentAddressController.name,\n  ReservationConfirmationController.name,\n  CheckoutPaymentController.name,\n])\n","import angular from 'angular'\nimport tokens from '@app/angular/services/modules/tokens'\nimport { shoppingList as shoppingListService } from '@instacart/enterprise-services'\nimport { utils as timeslotUtils } from '@instacart/enterprise-timeslots'\nimport { DEFAULT_TIMESLOT_DATE_FORMAT } from '@app/angular/constants/timeslots'\nimport fulfillmentListTemplate from './fulfillmentList.html'\nimport desktopTemplate from './fulfillmentList.desktop.html'\nimport mobileTemplate from './fulfillmentList.mobile.html'\n\nexport default angular\n  .module('FulfillmentListComponentModule', [])\n  .component('fulfillmentList', {\n    transclude: true,\n    bindings: {\n      checkoutCartContinue: '&',\n    },\n    template: fulfillmentListTemplate,\n    controller(\n      $filter,\n      $scope,\n      $state,\n      analytics,\n      auth,\n      cartService,\n      checkoutService,\n      checkoutAnalytics,\n      config,\n      express,\n      lang,\n      loyaltyService,\n      mobileService,\n      modalOptions,\n      reactCartLoyaltyBalanceDefaultProps,\n      reservationService,\n      shoppingContextService,\n      shoppingSelectorService,\n      userService,\n      utilService\n    ) {\n      const {\n        intent,\n        user: { context, store },\n      } = auth\n      const { shoppingSelector } = config\n      const { delivery, pickup } = shoppingSelector\n      const { cart } = cartService\n      const { checkoutCartContinue } = $scope.$ctrl\n      const scheduleModalConfigFactory = () => ({\n        showBackButton: false,\n        showTimeslotSelectLaterLink: false,\n      })\n      const setTotalRewards = () => {\n        $scope.rewards = loyaltyService.getVisibleRewards(\n          cartService.cart?.cart_totals?.[cartService.getCurrentCartType()]?.reward_discounts\n        )\n      }\n\n      Object.assign(\n        $scope,\n        {\n          auth,\n          cartService,\n          checkoutCartContinue,\n          config,\n          reservationService,\n          intent,\n          lang,\n          loyaltyService,\n        },\n        {\n          mobile: mobileService,\n          userStore: store || {},\n          currencyFilter: $filter('currency'),\n          getMinCartSpend: shoppingListService.commonUtils.getMinimumCartSpend,\n          deliveryAddress: { postal_code: context.deliveryPostalCode },\n          shoppingIntentTitle:\n            shoppingContextService.getShoppingModeTitle() || lang.values.pleaseSelect,\n          showContextChangeBtn: delivery.exists || pickup.exists,\n          showOrderOnlineButton: cartService.canOrderOnline(),\n          openShoppingSummary: shoppingSelectorService.open,\n          orderNotesEditing: false,\n          loyaltyReactProps: {\n            ...reactCartLoyaltyBalanceDefaultProps,\n            styles: { value: { color: tokens.color.brand.primary.dark } },\n          },\n          hasCartItems: () => cart.items.length > 0,\n          openPromoCodeModal: () =>\n            utilService.openPromoCodeModal(cartService.sync, undefined, true),\n          openZipCodeModal: () =>\n            $scope.openShoppingSummary('storeSelector', null, {\n              showBackButton: false,\n            }),\n          openScheduleModal: () =>\n            $scope.openShoppingSummary('timeslot', null, scheduleModalConfigFactory()),\n\n          saveOrderNotes: () => {\n            let success = true\n            try {\n              cartService.sync()\n              analytics.logEvent('cart save comment update', 'update')\n            } catch {\n              success = false\n            }\n\n            checkoutAnalytics.modifyNote({ success, note: cartService.cart?.comment })\n          },\n          toggleOrderNotes: () => {\n            if (!$scope.orderNotesEditing) {\n              $scope.orderNotesEditing = true\n            } else {\n              $scope.saveOrderNotes()\n              $scope.orderNotesEditing = false\n            }\n          },\n          handleChangeStoreClick: () => {\n            modalOptions.reset()\n            modalOptions.setOptions({ showBackButton: false })\n            $scope.openShoppingSummary('storeSelector')\n          },\n          showLoyaltyCartPagePlacement: () =>\n            loyaltyService.showLoyaltyPlacement() && config.loyalty.enableLoyaltyOptIn.cartPage,\n          showLoyaltyCardBalance: () =>\n            userService.loyaltyCards.length > 0 &&\n            // eslint-disable-next-line no-restricted-globals\n            !isNaN(userService.getLoyaltyCard().points_balance) &&\n            config.hasLoyalty &&\n            config.showLoyaltyBalanceInCart,\n        }\n      )\n\n      checkoutService.getSelectedDeliveryAddress(false).then(address => {\n        $scope.deliveryAddress = address || $scope.deliveryAddress\n      })\n\n      if (config.rewards.visible.length) {\n        $scope.$watch(() => cartService.syncing, setTotalRewards)\n        setTotalRewards()\n      }\n    },\n  })\n  .filter('offersToPromoCodes', function () {\n    return offers =>\n      offers &&\n      offers.filter(\n        offer => offer.offer.promo_code !== null && offer.offer.promo_code !== undefined\n      )\n  })\n  .filter('reservationScheduleToString', (config, reservationService) => {\n    return reservation => {\n      return timeslotUtils.getMainLabel(reservation, {\n        format: reservationService.reservation\n          ? config.apiDateFormat\n          : DEFAULT_TIMESLOT_DATE_FORMAT,\n      })\n    }\n  })\n  .run($templateCache => {\n    $templateCache.put('fulfillmentList.desktop.html', desktopTemplate)\n    $templateCache.put('fulfillmentList.mobile.html', mobileTemplate)\n  })\n","import { isEmpty } from 'lodash'\nimport angular from 'angular'\n\nexport default angular.module('CartTotalsComponentModule', []).component('cartTotals', {\n  bindings: {\n    cssClass: '@',\n    totals: '=cartTotals',\n    showFees: '=',\n    isOrder: '<',\n  },\n  controller($scope, cartService, config, lang, auth) {\n    const vm = this\n\n    vm.$onInit = () => {\n      vm.isOrder = typeof vm.isOrder !== 'boolean' ? false : vm.isOrder\n    }\n\n    vm.getTaxTotal = () => {\n      if (vm.isOrder) return vm.totals.tax_total\n\n      return cartService.getFinalTaxTotal()\n    }\n\n    vm.getEstimatedTotal = () => {\n      if (vm.isOrder) return vm.totals.total\n\n      return cartService.getCartFinalTotal()\n    }\n\n    Object.assign(vm, { cartService, config, lang })\n\n    vm.getTotalsNote = () => lang.values.intentTotalsNote[auth.getContext().intent]\n\n    vm.isPickFeesVisible = () =>\n      vm.showFees &&\n      vm.totals.pickup_fee &&\n      vm.totals.pickup_fee !== '0' &&\n      isEmpty(vm.totals.additional_fees)\n\n    vm.isSubscriptionFeesVisible = () =>\n      vm.config.hasSubscriptions && isEmpty(vm.totals.additional_fees)\n\n    vm.isDeliveryFeesVisible = () =>\n      vm.showFees &&\n      vm.totals.delivery_fee &&\n      vm.totals.delivery_fee !== '0' &&\n      isEmpty(vm.totals.additional_fees)\n  },\n  template: require('./cartTotals.html'),\n})\n","import angular from 'angular'\nimport _ from 'lodash'\n\nexport default angular\n  .module('PaymentGatewayServiceModule', [])\n  .provider('paymentGateway', function paymentGateway() {\n    const provider = this\n    const gateways = []\n\n    /**\n     * Registers a gateway based on the options provided\n     * @param {Object} gateway\n     *         name: '<name>',                              // General name of the payment method\n     *         key: '<payment type as returned by server>', // Key as returned by server, e.g. auth_capture\n     *         serviceName: '<service name>',               // The service name, angularjs injectable\n     *         newCheckoutCssClass: '<string>',             // Simplified checkout parent class (default: provider-generic_styling)\n     *         hideSaveButton: <true|false>,                // Don't show the payment form save button (default: false)\n     *         hideGiftCardLink: <true|false>,              // Don't show the gift card link under this payment method (default: false)\n     *         noSettingsRequired: <true|false>,            // Indicates this payment can be auto saved, without allowing to edit (default: false)\n     */\n    provider.registerGateway = function (gateway) {\n      gateways.push(gateway)\n    }\n\n    provider.$get = [\n      '$injector',\n      function ($injector) {\n        const service = this\n\n        service.getByName = function (name) {\n          return gateways.find(gateway => gateway.name === name)\n        }\n\n        service.get = function (key) {\n          return _.find(gateways, { key })\n        }\n\n        service.all = function () {\n          return angular.copy(gateways)\n        }\n\n        service.getTemplate = function (key) {\n          const gateway = service.get(key)\n\n          if (gateway) {\n            return gateway.template || ''\n          }\n          gateWayNotFound(key)\n        }\n\n        service.getService = function (key) {\n          const gateway = service.get(key)\n          if (gateway) {\n            return $injector.get(gateway.serviceName)\n          }\n          gateWayNotFound(key)\n        }\n\n        return service\n      },\n    ]\n  })\n\nfunction gateWayNotFound(key) {\n  throw new ReferenceError(`Could not find payment gateway, as specified by the key \"${key}\"`)\n}\n","import angular from 'angular'\n\nimport Checkout from './checkout'\nimport FulfillmentList from './fulfillmentList/fulfillmentList'\nimport Totals from './totals/cartTotals'\nimport PaymentGateway from './paymentGateways/paymentGatewayService'\n\nexport default angular.module('app.component.checkoutModule', [\n  PaymentGateway.name,\n  Checkout.name,\n  Totals.name,\n  FulfillmentList.name,\n])\n","/* eslint-disable max-lines */\n\nimport _ from 'lodash'\nimport debounce from 'lodash/debounce'\nimport angular from 'angular'\nimport { CART_TYPES } from '@app/angular/constants/cart'\nimport {\n  CHECKOUT_STEP_IDS,\n  FULFILLMENT_TYPES,\n  RESERVATION_BREAKDOWN,\n  RESET_CHECKOUT_STEPS,\n  EDIT_CHECKOUT_STEP,\n  CLOSE_CHECKOUT_STEPS_SETTLED,\n} from '@app/angular/constants/checkout'\nimport { MEMBERSHIP_STATUSES } from '@app/angular/constants/express'\nimport { SHOPPING_MODES } from '@instacart/enterprise-services/shopping-list/cart/constants'\nimport template from './checkoutSteps.html'\n\nclass CheckoutSteps {\n  constructor(\n    $filter,\n    $q,\n    $rootScope,\n    $scope,\n    $timeout,\n    addressList,\n    addressValidationService,\n    api,\n    alcoholValidation,\n    auth,\n    cartService,\n    checkoutAnalytics,\n    checkoutService,\n    compareCartService,\n    config,\n    express,\n    instacartCustomerLinkModalService,\n    lang,\n    mobileService,\n    paymentGateway,\n    reservationService,\n    storesService\n  ) {\n    Object.assign(this, {\n      $filter,\n      $q,\n      $rootScope,\n      $scope,\n      $timeout,\n      addressList,\n      addressValidationService,\n      alcoholValidation,\n      api,\n      auth,\n      cartService,\n      checkoutAnalytics,\n      checkoutService,\n      compareCartService,\n      config,\n      express,\n      hasOpenSection: false,\n      lang,\n      mobileService,\n      paymentGateway,\n      paymentService: null,\n      reservationService,\n      storesService,\n      stores: [],\n      instacartCustomerLinkModalService,\n      hasSelectedCateringStore: false,\n    })\n    this.brokenDownStepsOrder = this._breakDownReservationStep()\n    this.steps = this.initializeSteps()\n    this.stepNames = Object.keys(this.steps)\n    this.paymentIsInitialStep = this.initialStep === CHECKOUT_STEP_IDS.PAYMENT\n  }\n\n  $onInit() {\n    const { $q, $scope, api, initialStep } = this\n\n    const initializePayment = payment => {\n      this.payment = payment\n\n      // In this case of modify order, set the previous payment instrument into payment\n      const existingPaymentInstrument = this.cart.order?.payment_instruments?.[0]\n      const existingPaymentType = this.cart.order?.payment_type\n      const existingGiftCards = this.cart.order?.gift_cards\n\n      if (existingPaymentType && this.payment) {\n        this.payment.payment_type = existingPaymentType\n        this.payment[existingPaymentType] = existingPaymentInstrument\n      }\n\n      if (existingGiftCards && this.payment) {\n        this.payment.gift_cards = existingGiftCards\n      }\n\n      $scope.$watch(\n        () => this.payment.payment_type,\n        () => {\n          const { payment_type: paymentType } = this.payment\n          if (paymentType) {\n            this.paymentService = this.paymentGateway.getService(paymentType)\n          }\n          this.onPaymentUpdate({ payment })\n        }\n      )\n\n      $scope.$watch(\n        () => this.paymentService?.status?.ready,\n        () => this.validate()\n      )\n\n      $scope.$watch(\n        () => this.reservationService.reservation,\n        () => {\n          this.validate()\n\n          const scheduleStep = this.steps[CHECKOUT_STEP_IDS.SCHEDULE]\n          const isCurrentStepBeforeScheduleStep =\n            this.currentStep && this.currentStep.order < scheduleStep.order\n          if (!this._isScheduleValid() && !isCurrentStepBeforeScheduleStep) {\n            this.editStep(CHECKOUT_STEP_IDS.SCHEDULE)\n          }\n        }\n      )\n    }\n\n    const initializeStores = stores => {\n      this.stores = stores\n    }\n\n    const initializeOrderDeliveryInstructions = () => {\n      this.checkoutService.setOrderDeliveryInstructions(\n        this.$rootScope.modifyingOrder\n          ? this.cartService.getModifyOrderDeliveryInstruction().leaveUnattended\n          : this.cartService.getOrderDeliveryInstruction().leaveUnattended\n      )\n    }\n\n    this.$rootScope.isAppLoading = true\n\n    const linkAccount = () => {\n      const shouldLinkAccount =\n        this.config.instacart.enableAccountLinking && !this.auth.user.ic_linked\n\n      if (shouldLinkAccount) {\n        return this.instacartCustomerLinkModalService\n          .hasAccountBeenCreated()\n          .then(() => Promise.resolve(true))\n          .catch(() => Promise.resolve(false))\n      }\n\n      return Promise.resolve(shouldLinkAccount)\n    }\n\n    // Fetching the initial data the new checkout page needs\n    const fetchInitialInformation = [\n      this.getProfile(),\n      this.fetchStores(),\n      api.getCartPayment({ cart_id: this.getCartId() }),\n      this.checkoutService.getSelectedDeliveryAddress(!this.isModifyingOrder()),\n      linkAccount(),\n    ]\n\n    const setInitialAddress = address => {\n      if (this.fulfillmentType === FULFILLMENT_TYPES.DELIVERY) {\n        if (!this.isModifyingOrder()) {\n          return this.handleInitialDeliveryAddress(address || this.auth.getAddressFromContext())\n        }\n\n        const deliveryAddress = {\n          ...this.cartService.cart.order?.delivery_address,\n          phone_number: this.cartService.cart.order?.ext_data?.phone_number || address.phone_number,\n        }\n\n        return this.handleInitialDeliveryAddress(deliveryAddress)\n      }\n    }\n\n    const initializeCheckout = () => {\n      return $q\n        .all(fetchInitialInformation)\n        .then(([, , payment, address, isAccountLinked]) => {\n          initializeOrderDeliveryInstructions()\n          initializePayment(payment)\n          initializeStores(this.storesService.stores)\n\n          return { address, isAccountLinked }\n        })\n        .then(({ address, isAccountLinked }) => {\n          setInitialAddress(address)\n          return isAccountLinked\n        })\n        .then(isAccountLinked => this._showModals(isAccountLinked))\n        .then(this.reservationService.fetchWithCart(this.getCartId()))\n        .then(() => this._validateCartAndOpenNextSection())\n        .catch(err => this.handleError(err))\n        .finally(() => {\n          if (!initialStep) {\n            this.$rootScope.isAppLoading = false\n          } else {\n            // Sometimes the delivery section will force itself open and then timeslots is disabled\n            // This ensures a loading mask doesn't get stuck forever over the checkout\n            this.$timeout(() => {\n              if (this.$rootScope.isAppLoading) {\n                this.$rootScope.isAppLoading = false\n              }\n            }, 5000)\n          }\n\n          this.isReady = true\n        })\n    }\n\n    initializeCheckout()\n\n    /**\n     * Whenever the *_isValid* getter value changes calls the\n     * *onValidateChange* prop function with the new validation\n     * status so the parent can decide what to do\n     */\n    $scope.$watch(\n      () => this._isValid,\n      () => this.onValidateChange({ isValid: this._isValid })\n    )\n\n    /**\n     * Once all checkout sections have closed and none are forced open, broadcast an event\n     * This can be used to perform actions once the checkout is in a stable state\n     */\n    const closeStateSettled = debounce(isOpen => {\n      if (!isOpen && this.isReady) {\n        this.$scope.$broadcast(CLOSE_CHECKOUT_STEPS_SETTLED)\n      }\n    }, 1000)\n\n    this.$scope.$on(RESET_CHECKOUT_STEPS, () => closeStateSettled(false))\n    this.$scope.$on(EDIT_CHECKOUT_STEP, () => closeStateSettled(true))\n\n    /*  Open initial section once checkout has settled */\n    this.$scope.$on(CLOSE_CHECKOUT_STEPS_SETTLED, this.openInitialStep)\n  }\n\n  isModifyingOrder() {\n    return this.$rootScope.modifyingOrder || this.$rootScope.modifyingInstacartOrder\n  }\n\n  openInitialStep = () => {\n    const { initialStep } = this\n\n    // If having an initial step, open the section after a delay (ensure all other sections close)\n    if (initialStep) {\n      this.editStep(initialStep)\n      this.$rootScope.isAppLoading = false\n      this.initialStep = null\n    }\n  }\n\n  _showModals = isAccountLinked => {\n    const showLinkingAccountModal =\n      !isAccountLinked && this.config.instacart.enableAccountLinking && !this.auth.user.ic_linked\n\n    const modals = [\n      this.alcoholValidation.shouldShowModal() && this.alcoholValidation.open(),\n      showLinkingAccountModal &&\n        this.instacartCustomerLinkModalService.openModal({\n          linkLater: false,\n          forceSkippableState: true,\n        }),\n    ]\n\n    return this.$q.all(modals).catch(() => this.onCheckoutExit())\n  }\n\n  _validateCartAndOpenNextSection = () => {\n    this.validateCart(true)\n    this.validate(false)\n    this.openNextSection()\n  }\n\n  /**\n   * Handles the initial delivery address fetching by\n   * setting the delivery address object and validating\n   * its postal code\n   *\n   * @param {object} address\n   * @returns {undefined}\n   */\n  handleInitialDeliveryAddress(address) {\n    this.checkoutService.setDeliveryAddress(address)\n\n    if (!this._isDeliveryAddressValid(address)) {\n      this.checkoutService.stepsStatuses[CHECKOUT_STEP_IDS.DELIVERY].valid = false\n      this.validateCart(true)\n      this.validate()\n      this.openNextSection()\n      return\n    }\n\n    this.validateDeliveryPostalCode(address.postal_code)\n      .then(isValid => {\n        const deliveryStatus = this.checkoutService.stepsStatuses[CHECKOUT_STEP_IDS.DELIVERY]\n\n        this.validate()\n        if (!isValid) {\n          deliveryStatus.valid = isValid\n          return\n        }\n\n        deliveryStatus.valid = true\n        this.validateCart(true)\n      })\n      .catch(() => (this.checkoutService.stepsStatuses[CHECKOUT_STEP_IDS.DELIVERY].valid = false))\n      .finally(() => this.openNextSection())\n  }\n\n  /**\n   * Handles errors from the delivery-form component by\n   * setting the *valid* status of the delivery step to false\n   */\n  handleDeliveryAddressError() {\n    this.checkoutService.stepsStatuses[CHECKOUT_STEP_IDS.DELIVERY].valid = false\n    this.openNextSection()\n  }\n\n  _handleAddressAppliedSingleBanner() {\n    const validateAndOpenNext = () => {\n      this.checkoutService.stepsStatuses[CHECKOUT_STEP_IDS.DELIVERY].valid = true\n      this.validate()\n      this.openNextSection()\n      this.validateCart()\n    }\n\n    if (!this.reservationService.reservation) {\n      validateAndOpenNext()\n      return\n    }\n\n    this.reservationService\n      .deleteReservation({ cart_id: this.getCartId() })\n      .finally(() => validateAndOpenNext())\n  }\n\n  _handleAddressAppliedMultiBanner() {\n    this.checkoutService.stepsStatuses[CHECKOUT_STEP_IDS.DELIVERY].valid = true\n    this.checkoutService.stepsStatuses[CHECKOUT_STEP_IDS.BANNER].valid = false\n    this.validate()\n    this.openNextSection()\n    this.validateCart()\n  }\n\n  /**\n   * Executes when a valid address is selected in delivery-form\n   * component. It sets the delivery step status to true, validates\n   * the checkout form as a whole and open the next invalid/empty step\n   */\n  handleAddressApplied(address) {\n    this.checkoutService.setDeliveryAddress(address)\n\n    if (this.config.multipleBanners.enabled) {\n      // Need to check if multiple banners deliver to this address\n      this.storesService\n        .fetchBanners({ delivery_postal_code: address.postal_code })\n        .then(banners => {\n          if (banners.items.length === 1) {\n            this._handleAddressAppliedSingleBanner()\n          } else if (banners.items.length > 1) {\n            this._handleAddressAppliedMultiBanner()\n          }\n        })\n    } else {\n      this._handleAddressAppliedSingleBanner()\n    }\n  }\n\n  /**\n   * Validates a postal code for delivery\n   *\n   * @param {object} postalCode\n   * @returns {Promise}\n   */\n  validateDeliveryPostalCode(postalCode) {\n    return this.storesService\n      .fetch({\n        delivery_postal_code: postalCode,\n        show_delivery: true,\n        retailer_slug: this.auth.user.context.retailer_slug,\n      })\n      .then(stores => {\n        return stores !== undefined && stores.length > 0\n      })\n      .catch(() => this.handleInvalidPostalCodeError())\n  }\n\n  /**\n   * Fetches the user profile\n   *\n   * @returns { Promise }\n   */\n  getProfile() {\n    const initializeContact = () => {\n      const {\n        primary_number_key,\n        delivery_address: { first_name, last_name, address1, postal_code },\n      } = this.auth.user\n      const phone_number = this.auth.user[primary_number_key]\n\n      this.checkoutService.setContact({\n        primary_number_key,\n        phone_number,\n        first_name,\n        last_name,\n        address1,\n        postal_code,\n      })\n\n      this.onContactUpdate(this.checkoutService.contact)\n    }\n\n    return this.auth.getProfile().then(() => initializeContact())\n  }\n\n  /**\n   * Excecutes after the contact information\n   * is successfully saved.\n   *\n   * It updates the auth object, validates the checkout form and\n   * open the next invalid/empty section\n   *\n   * @param { boolean } fetch - Defines if fetching the profile is necessary\n   *\n   * @returns { Promise }\n   */\n  handleContactInfoSave(fetch, contact) {\n    // Clear out any contact save errors\n    this.checkoutService.setError(null)\n\n    const sync = fetch ? this.getProfile() : this.$q.resolve()\n\n    return sync.then(() => {\n      this.checkoutService.setContact(contact)\n      this.validate()\n      this.validateCart()\n      this.openNextSection()\n    })\n  }\n\n  /**\n   * Passes on the order delivery information\n   * @param { boolean | undefined } leaveUnattended - Whether product should be left at door or not\n   *        (If not provided, it will clear instructions, to force re-open the instructions section)\n   *\n   * @returns { Promise }\n   */\n  handleOrderDeliveryInstructionsSave(leaveUnattended) {\n    const hasAlcohol = this.cartService.getHasAlcohol()\n    this.checkoutService.setError(null)\n\n    if (typeof leaveUnattended === 'boolean') {\n      this.checkoutService.setOrderDeliveryInstructions(leaveUnattended && !hasAlcohol)\n    } else {\n      this.checkoutService.clearOrderDeliveryInstructions()\n    }\n\n    this.validate()\n    this.validateCart()\n    this.openNextSection()\n  }\n\n  /**\n   * Fetches the stores based fulfillment type\n   *\n   * @returns { Promise }\n   */\n  fetchStores() {\n    const params = {}\n    if (this.fulfillmentType !== FULFILLMENT_TYPES.INSTORE) {\n      params.show_ecommerce = true\n    }\n\n    if (this.cartService.getCurrentCartType() === CART_TYPES.CATERING) {\n      params.show_catering = true\n    } else if (this.fulfillmentType === FULFILLMENT_TYPES.PICKUP) {\n      params.show_pickup = true\n    }\n\n    return this.storesService.fetch(params)\n  }\n\n  /**\n   * Getter for the validation status of the checkoutSteps\n   * based on the current user context\n   *\n   * @returns { Boolean }\n   */\n  get _isValid() {\n    const { isCartValidated, stepsStatuses } = this.checkoutService\n    const isEditing = !!Object.values(this.steps).find(step => step.editMode)\n    if (isEditing) return false\n\n    if (this.fulfillmentType === FULFILLMENT_TYPES.PICKUP) {\n      return (\n        isCartValidated &&\n        stepsStatuses[CHECKOUT_STEP_IDS.CONTACT].valid &&\n        stepsStatuses[CHECKOUT_STEP_IDS.PICKUP].valid &&\n        stepsStatuses[CHECKOUT_STEP_IDS.SCHEDULE].valid &&\n        stepsStatuses[CHECKOUT_STEP_IDS.PAYMENT].valid\n      )\n    }\n\n    return (\n      isCartValidated &&\n      stepsStatuses[CHECKOUT_STEP_IDS.DELIVERY].valid &&\n      stepsStatuses[CHECKOUT_STEP_IDS.SCHEDULE].valid &&\n      stepsStatuses[CHECKOUT_STEP_IDS.PAYMENT].valid &&\n      (!this.orderDeliveryInstructionsStep ||\n        stepsStatuses[CHECKOUT_STEP_IDS.ORDER_DELIVERY_INSTRUCTIONS].valid)\n    )\n  }\n\n  /**\n   * Returns an array of steps with the correct editMode state\n   *\n   * @returns { object[] }\n   */\n  initializeSteps() {\n    const steps = {}\n\n    this.filteredSteps.forEach(step => {\n      steps[step.name] = step\n      steps[step.name].editMode = false\n      steps[step.name].disabled = false\n    })\n\n    this.orderDeliveryInstructionsStep = steps[CHECKOUT_STEP_IDS.ORDER_DELIVERY_INSTRUCTIONS]\n\n    return steps\n  }\n\n  /**\n   * Resets all steps *editMode* to false and\n   * Sets the given step to edit mode\n   *\n   * @param { string } stepID\n   *\n   * @returns { undefined }\n   */\n  editStep(stepID) {\n    this.resetSteps()\n    this.steps[stepID].editMode = true\n    this.onStepEditMode({ stepID })\n    this.$scope.$broadcast(EDIT_CHECKOUT_STEP)\n  }\n\n  onPaymentSave(isValid, hasBeenEdited) {\n    this.validate(hasBeenEdited)\n    this.openNextSection()\n  }\n\n  /**\n   * Allows a step to abort its edit\n   *\n   * @returns { undefined }\n   */\n  abortEdit() {\n    this.resetSteps()\n  }\n\n  /**\n   * Returns an array of checkout steps filtered by the current\n   * fulfillment type and in the same order as defined in the config file\n   *\n   * @returns { object[] }\n   */\n  get filteredSteps() {\n    const fulfillmentType = this.auth.getContext().intent\n\n    return this.orderedSteps.filter(step => {\n      switch (step.name) {\n        case CHECKOUT_STEP_IDS.PICKUP:\n        case CHECKOUT_STEP_IDS.CONTACT:\n          return fulfillmentType === FULFILLMENT_TYPES.PICKUP\n        case CHECKOUT_STEP_IDS.BANNER:\n          return (\n            fulfillmentType === FULFILLMENT_TYPES.DELIVERY && this.config.multipleBanners.enabled\n          )\n        case CHECKOUT_STEP_IDS.DELIVERY:\n        case CHECKOUT_STEP_IDS.ORDER_DELIVERY_INSTRUCTIONS:\n          return fulfillmentType === FULFILLMENT_TYPES.DELIVERY\n        default:\n          return step\n      }\n    })\n  }\n\n  /**\n   * Takes an array of steps with the reservation config object and converts\n   * it into the steps defined in 'RESERVATION_BREAKDOWN'\n   *\n   * @param { array } steps\n   *\n   * @returns { array } steps\n   */\n  _breakDownReservationStep() {\n    const steps = this.config.newCheckoutFlow.checkoutPage.stepsOrder\n    const validStepNames = Object.values(CHECKOUT_STEP_IDS)\n    const deepCopySteps = _.cloneDeep(\n      steps.filter(step => {\n        const hasStep = validStepNames.includes(step.name)\n        if (!hasStep) console.warn(`Unknown checkout step from config: ${step.name}`)\n        return hasStep\n      })\n    )\n    const reservation = deepCopySteps.find(step => step.name === CHECKOUT_STEP_IDS.RESERVATION)\n    // If there is no config object for reservation just return the steps\n    if (!reservation) return deepCopySteps\n    // Go through the steps and increment the order of all the steps\n    // that come after the reservation\n    deepCopySteps.forEach(\n      step => (step.order += step.order > reservation.order ? RESERVATION_BREAKDOWN.length - 1 : 0)\n    )\n    // Add the steps that a reservation consists of\n    RESERVATION_BREAKDOWN.forEach((item, i) =>\n      deepCopySteps.push({ ...item, order: reservation.order + i })\n    )\n    // Remove the reservation object from the steps and return it\n    return deepCopySteps.filter(item => item !== reservation)\n  }\n\n  /**\n   * Returns an array of ordered steps as defined in the client config\n   *\n   * @returns { object[] }\n   */\n  get orderedSteps() {\n    return this.brokenDownStepsOrder.sort(\n      (currentStep, nextStep) => currentStep.order - nextStep.order\n    )\n  }\n\n  /**\n   * Returns the title for the cart section component\n   *\n   * @returns { string }\n   */\n  get cartTitle() {\n    const cartSize = this.cartService.countItems()\n    const { item } = this.lang.values\n\n    return `${cartSize} ${this.$filter('pluralize')(item, cartSize)}`\n  }\n\n  /**\n   * Returns an array of ordered steps as defined in the client config\n   *\n   * @returns { object }\n   */\n  get currentStep() {\n    return Object.values(this.steps).find(step => step.editMode)\n  }\n\n  /**\n   *  Sets a cart update message object in the cartService\n   *\n   * @param {number} cartChangeSize\n   */\n  showCartUpdatedMessage(cartChangeSize) {\n    const { cartUpdated, cartUpdateMessage, item, addedTo, removedFrom } = this.lang.values\n    const changeSize = Math.abs(cartChangeSize)\n    const changeType = cartChangeSize > 0 ? addedTo : removedFrom\n    const itemText = this.$filter('pluralize')(item, changeSize)\n    const body = this.lang.template(cartUpdateMessage, {\n      changeSize,\n      changeType,\n      item: itemText,\n    })\n\n    this.cartService.updateMessage = {\n      title: cartUpdated,\n      body,\n    }\n  }\n\n  /**\n   * Handles errors by displaying the error message at the top of the page\n   *\n   * @param { object } error\n   */\n  handleError(error) {\n    this.checkoutService.setError(error)\n    this.checkoutService.logCheckoutErrorAnalytics(error)\n\n    document.querySelector('.checkout-page').scrollTop = 0\n  }\n\n  /**\n   * Resets all the steps editMode to false\n   */\n  resetSteps() {\n    this.filteredSteps.forEach(step => (step.editMode = false))\n    this.$scope.$broadcast(RESET_CHECKOUT_STEPS)\n  }\n\n  /**\n   * Validates the data of each checkout step depending on the user current fulfillment type sections\n   *\n   * @param { Boolean } isUserInitiated:      Optional: True if user initiated the validate action\n   * @returns { Boolean }\n   */\n  validate(isUserInitiated = true) {\n    const {\n      SCHEDULE,\n      PAYMENT,\n      PICKUP,\n      CONTACT,\n      DELIVERY,\n      ORDER_DELIVERY_INSTRUCTIONS,\n    } = CHECKOUT_STEP_IDS\n\n    this.checkoutService.stepsStatuses[SCHEDULE].valid = this._isScheduleValid()\n    this.checkoutService.stepsStatuses[PAYMENT].valid = this._isPaymentValid()\n\n    if (this.fulfillmentType === FULFILLMENT_TYPES.PICKUP) {\n      this.checkoutService.stepsStatuses[PICKUP].valid = this._isPickupStoreValid(isUserInitiated)\n      this.checkoutService.stepsStatuses[CONTACT].valid = this._isContactInformationValid()\n    }\n\n    if (this.fulfillmentType === FULFILLMENT_TYPES.DELIVERY) {\n      this.checkoutService.stepsStatuses[DELIVERY].valid = this._isDeliveryAddressValid(\n        this.checkoutService.deliveryAddress\n      )\n\n      this.checkoutService.stepsStatuses[\n        ORDER_DELIVERY_INSTRUCTIONS\n      ].valid = this._isOrderDeliveryInstructionsValid()\n    }\n\n    this._updateDisabledStatus()\n\n    return this._isValid\n  }\n\n  /**\n   * Validates a given *address* object\n   *\n   * @param {object} address\n   * @returns {boolean}\n   */\n  _isDeliveryAddressValid(address) {\n    return this.addressValidationService.isAddressComplete(address)\n  }\n\n  /**\n   * Updates the disabled status of each checkout step\n   * If a step is invalid/incomplete all the following steps will be\n   * disabled\n   *\n   * @returns {undefined}\n   */\n  _updateDisabledStatus() {\n    let disableNextSteps = false\n    const { stepsStatuses } = this.checkoutService\n\n    Object.keys(this.steps).forEach(step => {\n      this.steps[step].disabled = disableNextSteps\n\n      if (!stepsStatuses[step].valid) {\n        disableNextSteps = true\n      }\n    })\n  }\n\n  /**\n   * Set the next invalid or empty section to edit mode\n   *\n   * @returns { undefined }\n   */\n  openNextSection() {\n    const nextStep = this.getNextIncompleteStep()\n    this.resetSteps()\n    this._updateDisabledStatus()\n\n    if (\n      !nextStep ||\n      (nextStep.name === this.currentStep?.name && nextStep?.name === CHECKOUT_STEP_IDS.PAYMENT)\n    ) {\n      return\n    }\n\n    this.editStep(nextStep.name)\n  }\n\n  /**\n   * Returns the next incomplete step\n   *\n   * @returns { object }\n   */\n  getNextIncompleteStep() {\n    const { stepsStatuses } = this.checkoutService\n\n    return this.filteredSteps.find(({ name }) => stepsStatuses[name].valid === false)\n  }\n\n  /**\n   * Executes after the user selects a store a\n   * *hasChanged* and *store* params are passed from the pickup-form child component\n   * so this method can decide when to do a cart compare, cart validate etc\n   *\n   * @param { boolean } hasChanged\n   * @param { object } store - selected store\n   *\n   * @returns { undefined }\n   */\n  handlePickupApply(hasChanged, store) {\n    const validateAndOpenNextSection = () => {\n      this.validate()\n      this.openNextSection()\n    }\n    this.hasSelectedCateringStore = true\n\n    if (hasChanged) {\n      return this.compareCartService\n        .compareCart(true, 'store', { store_id: store.id })\n        .then(({ shouldRecalculateFees }) => {\n          this.checkoutService.isCartValidated = false\n          this.checkoutService.handleCartCompareChange(shouldRecalculateFees)\n\n          this.auth\n            .update({ store_id: store.id, has_changed_store: true })\n            .then(this.cartService.fetch)\n            .then(() => this.auth.sendUserUpdatedStore(this.auth.user))\n            .then(() => this.auth.sendAvailableStoreContexts(this.auth.user))\n            .then(() => this.checkoutAnalytics.editFulfillmentOptions({ success: true }))\n            .then(() => this.reservationService.deleteReservation({ cart_id: this.getCartId() }))\n            .then(validateAndOpenNextSection)\n            .catch(error => {\n              this.checkoutAnalytics.editFulfillmentOptions({ success: false })\n              this.checkoutService.logCheckoutErrorAnalytics(error)\n            })\n        })\n        .catch(validateAndOpenNextSection)\n    }\n    validateAndOpenNextSection()\n  }\n\n  // Step validators\n\n  /**\n   * Validates the pickup store section data\n   * @param { Boolean } isUserInitiated:      Optional: True if user initiated the validate action\n   *\n   * @returns { Boolean }\n   */\n  _isPickupStoreValid(isUserInitiated = true) {\n    const {\n      user: { store },\n    } = this.auth\n    if (\n      (!this.auth.user.has_changed_store &&\n        parseInt(store?.id, 10) === parseInt(this.config.defaultStoreID, 10)) ||\n      (this.cartService.getCurrentCartType() === CART_TYPES.CATERING &&\n        !this.hasSelectedCateringStore &&\n        this.config.alwaysOpenStoreSelectorCatering)\n    ) {\n      return false\n    }\n    if (isUserInitiated) {\n      return !!store?.id\n    }\n    return !!store?.id && parseInt(store?.id, 10) !== parseInt(this.config.defaultStoreID, 10)\n  }\n\n  /**\n   * Validates the contact information data\n   *\n   * @returns { Boolean }\n   */\n  _isContactInformationValid() {\n    const { first_name, last_name, phone_number } = this.checkoutService.contact\n\n    if (!first_name || !last_name || !phone_number) return false\n\n    return (\n      first_name.length > 0 &&\n      first_name.length <= this.config.maxNameLength &&\n      last_name.length > 0 &&\n      last_name.length <= this.config.maxNameLength &&\n      phone_number.length > 0\n    )\n  }\n\n  /**\n   * Validates the delivery instruction data\n   *\n   * @returns { Boolean }\n   */\n  _isOrderDeliveryInstructionsValid() {\n    const { orderDeliveryInstructions } = this.checkoutService\n    return (\n      !this.orderDeliveryInstructionsStep ||\n      typeof orderDeliveryInstructions?.leaveUnattended === 'boolean'\n    )\n  }\n\n  /**\n   * Validates the timeslot data\n   *\n   * @returns { Boolean }\n   */\n  _isScheduleValid() {\n    return (\n      this.reservationService?.reservation?.id !== undefined &&\n      !this.reservationService?.reservation?.timeslot?.during_blackout &&\n      !this.reservationService?.reservation?.timeslot?.unavailable\n    )\n  }\n\n  /**\n   * Validates the payment data\n   *\n   * @returns { Boolean }\n   */\n  _isPaymentValid() {\n    const { payment_type: paymentType } = this.payment || {}\n\n    if (!paymentType) return false\n\n    const gatewayService = this.paymentGateway.getService(paymentType)\n\n    return gatewayService.status?.ready || false\n  }\n\n  /**\n   * Returns if auth is deferred (eg. for >7 day payments)\n   *\n   * @returns { Boolean }\n   */\n  isDeferredAuth() {\n    return this.reservationService?.reservation?.full_auth_will_defer\n  }\n\n  /**\n   * Checks the cart validate payload for values that are missing before the\n   * cart can be validated though the cart service.\n   *\n   * @returns { Boolean }\n   */\n  checkValidationPayloadForEmptyValues(cartValidationPayload) {\n    const hasEmptyValue = Object.values(cartValidationPayload).some(\n      value => typeof value === 'undefined' || value === null\n    )\n\n    const { delivery_address } = cartValidationPayload\n    // If the delivery address exists, check if the required fields are set.\n    const hasEmptyDeliveryAddress =\n      delivery_address && !(delivery_address.address1 && delivery_address.postal_code)\n\n    return hasEmptyValue || hasEmptyDeliveryAddress\n  }\n\n  /**\n   * Calls the cart validate endpoint whenever the following information is updated\n   *   *delivery*: delivery address or timeslot\n   *   *pickup*: store or pickup\n   *\n   * The endpoint should only be called when all the information is filled\n   *\n   * @returns {undefined}\n   */\n  validateCart(withFees = false) {\n    const cartValidateInfo = this.checkoutService.getValidationPayload(this.fulfillmentType)\n    const hasEmptyValue = this.checkValidationPayloadForEmptyValues(cartValidateInfo)\n    const { ic_linked } = this.auth.user\n    const { enableAccountLinking } = this.config.instacart\n\n    if (!hasEmptyValue && (!enableAccountLinking || ic_linked)) {\n      const payload = { with_fees: withFees, ...cartValidateInfo }\n\n      if (this.orderDeliveryInstructionsStep) {\n        const { orderDeliveryInstructions } = this.checkoutService\n        payload.leave_unattended = Boolean(\n          // this.cart.order?.leave_unattended is defined only for modify case, otherwise...\n          this.cartService.cart.order?.leave_unattended ??\n            (orderDeliveryInstructions?.leaveUnattended && !this.cartService.getHasAlcohol())\n        )\n      }\n\n      this.cartService\n        .validateCart(payload)\n        .then(() => this._handleValidateCartSuccess())\n        .catch(err => this._handleValidateCartError(err))\n    }\n  }\n\n  /**\n   * Handles timeslot selection\n   */\n  handleScheduleFormSave() {\n    this.validate()\n    this.openNextSection()\n    const { first_name, last_name, phone_number } = this.checkoutService.contact\n\n    if (\n      this.fulfillmentType === SHOPPING_MODES.PICKUP &&\n      (!first_name || !last_name || !phone_number)\n    ) {\n      return\n    }\n\n    this.checkoutService.isCartValidated = false\n    this.validateCart(this.checkoutService.validateWithFees)\n  }\n\n  /**\n   * Handles successful validate cart calls\n   */\n  _handleValidateCartSuccess() {\n    this.checkoutService.validateWithFees = false\n    this.checkoutService.isCartValidated = true\n  }\n\n  /**\n   * Handles error validate cart calls\n   */\n  _handleValidateCartError(error) {\n    this.checkoutService.logCheckoutErrorAnalytics(error)\n    this.checkoutService.isCartValidated = false\n\n    /**\n     * If the express feature is enabled and the user is currently on Express Trial, on cart validation errors,\n     * we fetch the user current subscription status because their trial might have been canceled.\n     * In the future, we need to discuss with Connect the possibility of using a specific error code for this scenario\n     */\n    if (\n      this.config.icExpress.enabled &&\n      this.express.getMembershipStatus() === MEMBERSHIP_STATUSES.TRIAL\n    ) {\n      this.express.getCurrentSubscription(true)\n      this.editStep(CHECKOUT_STEP_IDS.SCHEDULE)\n    }\n\n    if (error === this.cartService.TIMESLOT_UNAVAILABLE_ERROR) {\n      this.editStep(CHECKOUT_STEP_IDS.SCHEDULE)\n    }\n  }\n\n  getCartId() {\n    return this.cartService.getCartId(this.cartService.getCurrentCartType())\n  }\n\n  getCartItemsByType = type => this.cartService.getCartTypeToItemsMap()[type]\n\n  /**\n   * Callback method that is invoked when the user cancel the address form\n   * edit. It validates the checkout steps and opens the next invalid/empty\n   * section\n   *\n   * @returns { undefined }\n   */\n  onCancelAddressEdit() {\n    this.validate()\n    this.openNextSection()\n  }\n\n  onChangeBanner() {\n    this.checkoutService.stepsStatuses[CHECKOUT_STEP_IDS.BANNER].valid = true\n    this.openNextSection()\n  }\n}\n\nexport default angular.module('CheckoutStepsModule', []).component('checkoutSteps', {\n  bindings: {\n    cart: '<',\n    fulfillmentType: '<',\n    initialStep: '<',\n    onValidateChange: '&', // prop method that gets called whenever the *isValid* attribute changes\n    onStepEditMode: '&',\n    onPaymentUpdate: '&',\n    onContactUpdate: '&',\n    onCheckoutExit: '&',\n    cartType: '<',\n  },\n  template,\n  controller: CheckoutSteps,\n})\n","import angular from 'angular'\n\nimport checkoutSteps from './checkoutSteps'\n\nexport default angular.module('app.component.checkoutStepsModule', [checkoutSteps.name])\n","import angular from 'angular'\nimport { isReactDemo } from '@app/utils/isReactDemo'\nimport { formatImagePlacementForAnalytics } from '@app/utils/placements'\n\nexport default angular\n  .module('UnataProductCollectionModule', [])\n  .component('unataProductCollection', {\n    bindings: {\n      collection: '<',\n      enablePlacements: '<',\n      fullWidth: '<',\n      location: '@',\n      layout: '<',\n      hideBorder: '<',\n      attributeAddToCartEvents: '<',\n      hideViewMore: '<',\n    },\n    controller(config, lang, mobileService, placementsService) {\n      this.mobileColumnLayout = false\n      this.config = config\n      this.enableReactCollection = this.config.react.enableProductCollection || isReactDemo()\n\n      // Specific configurations for existing layouts\n      // This is a way to move towards generic props (similar to React)\n      if (this.layout) {\n        if (this.layout === 'mobile-column') {\n          this.mobileColumnLayout = true\n        }\n\n        if (this.layout === 'mobile-row') {\n          this.hideBorder = true\n          this.fullWidth = true\n        }\n      }\n\n      if (!this.location) this.location = 'Homepage Collection'\n      this.srefParams = {\n        collection_id: this.collection.id,\n        ...(this.attributeAddToCartEvents && {\n          source: this.location,\n        }),\n      }\n\n      this.isMobile = mobileService.isMobile\n      this.lang = lang\n      this.isFull = Boolean(this.fullWidth)\n      this.hasMore = this.collection.items.length < this.collection.item_count\n      this.hideViewMore = Boolean(this.hideViewMore)\n      this.enableFullTileOnMobile = config.enableFullTileOnMobileCollections\n\n      this.handleImagePlacementClick = (placement, index) => {\n        const formattedPlacement = formatImagePlacementForAnalytics(placement, 'collection_banner')\n        placementsService.handleImagePlacementClick(\n          formattedPlacement,\n          'collection carousel',\n          index\n        )\n      }\n    },\n    template: require('./productCollection.html'),\n  })\n","import angular from 'angular'\nimport ProductCollection from './productCollection.js'\n\nexport default angular.module('app.component.productCollectionModule', [ProductCollection.name])\n","import _ from 'lodash'\nimport fp from 'lodash/fp'\nimport angular from 'angular'\nimport { CART_COMPARE_TRIGGERS } from '@app/angular/constants/context'\nimport { UNIT_OF_MEASURE } from '@app/angular/constants/uom'\n\nimport template from './views/compareCart.component.html'\n\nexport default angular.module('CartCompareModule', []).component('cartCompare', {\n  template,\n  bindings: {\n    customCartCompareConfig: '<?',\n  },\n  controller($q, cartService, compareCartService, lang, offersService, imageURLService) {\n    this.lang = lang\n    this.imageURLService = imageURLService\n    this.UNIT_OF_MEASURE = UNIT_OF_MEASURE\n\n    const categorizedProducts = cartService.getAllStoreProductsInCart()\n\n    const cartCompareProductLists = compareCartService.cartComparelists\n\n    // Destructure and rename cart compare lists\n\n    const {\n      configurable_product_leadtime: configurableProductLeadtimeList,\n      offers: offersList,\n      product_blackout: productBlackoutList,\n      product_inventory: productInventoryList,\n      product_pricing: productPricingList,\n    } = cartCompareProductLists\n\n    const changedProductLists = _.omit(cartCompareProductLists, 'offers')\n    const changedProductIds = fp.flow(\n      fp.flatMap(items => items),\n      fp.filter(item => typeof item === 'object' && item !== null),\n      fp.map(item => item.id),\n      fp.uniq,\n      fp.compact\n    )(changedProductLists)\n\n    const _filterProducts = products => {\n      let filteredProducts = [...products]\n      const { omitChanges = [] } = this.customCartCompareConfig || {}\n      const shouldOmitPriceChanges = omitChanges.includes(CART_COMPARE_TRIGGERS.PRICE)\n\n      if (shouldOmitPriceChanges) {\n        const pricingChanges = new Set(changedProductLists.product_pricing.map(p => p.id))\n\n        filteredProducts = filteredProducts.filter(product => !pricingChanges.has(product.id))\n      }\n\n      return filteredProducts\n    }\n\n    const getStoreProductCategory = item => {\n      return item.store_product?.categories?.[0]?.name || lang.values.uncategorizedCategory\n    }\n\n    // this.flaggedProductsByCategory is an object of the user's cart products that cart compare flagged, grouped by category\n    this.flaggedProductsByCategory = fp.flow(\n      fp.filter(item => _.includes(changedProductIds, item.store_product.id)),\n      fp.groupBy(item => getStoreProductCategory(item))\n    )(_filterProducts(categorizedProducts))\n\n    const productInventoryListIds = _.map(productInventoryList, 'id')\n\n    // Loop through each changed product identified by cart compare and flag them and add message when necessary\n\n    _.forEach(this.flaggedProductsByCategory, products => {\n      _.forEach(products, product => {\n        const productId = product.store_product.id\n\n        // Flag product when it has either an inventory change, price change or product blackout.\n\n        product.hasProductInventoryChange = _.includes(productInventoryListIds, productId)\n\n        const productInBlackoutList = _.find(productBlackoutList, { id: productId })\n        if (productInBlackoutList) {\n          product.hasProductBlackout = true\n\n          // Get the product blackout message from the product blackout list\n          product.blackoutMessage = productInBlackoutList.message\n        }\n\n        const productInConfigLeadtimeList = _.find(configurableProductLeadtimeList, {\n          id: productId,\n        })\n        if (productInConfigLeadtimeList) {\n          product.hasConfigurableProductLeadtime = true\n\n          // Get the configurable product lead time message from the associated list\n          product.configurableProductLeadtimeMessage = productInConfigLeadtimeList.message\n        }\n\n        const productInPricingList = _.find(productPricingList, listObj => listObj.id === productId)\n        if (productInPricingList) {\n          product.hasProductPricingChange = true\n\n          // Set new price and old price from the productPricingList\n          product.newPrice = productInPricingList.new_price\n          product.oldPrice = productInPricingList.old_price\n        }\n      })\n    })\n\n    this.hasFlaggedProductsByCategory = _.keys(this.flaggedProductsByCategory).length > 0\n\n    // Get the offers associated with the offer id's that come from the compare cart offers list\n\n    if (offersList && offersList.length > 0) {\n      $q.all(offersList.map(offer => offersService.getOffer(offer.id)))\n        .then(data => {\n          this.flaggedOffers = data\n\n          this.hasFlaggedOffers = this.flaggedOffers && this.flaggedOffers.length > 0\n\n          // Figure out what compare cart notice to use if there are flagged offers\n          if (this.hasFlaggedProductsByCategory) {\n            if (this.hasFlaggedOffers) {\n              this.compareCartNotice = lang.values.compareCartNoticeProductsAndOffers\n            } else {\n              this.compareCartNotice = lang.values.compareCartNoticeProducts\n            }\n          } else if (this.hasFlaggedOffers) {\n            this.compareCartNotice = lang.values.compareCartNoticeOffers\n          }\n        })\n        .catch(_ => {\n          this.hasFlaggedOffers = false\n\n          // Figure out what compare cart notice to use if there are no flagged offers\n          if (this.hasFlaggedProductsByCategory) {\n            this.compareCartNotice = lang.values.compareCartNoticeProducts\n          }\n        })\n    } else {\n      this.hasFlaggedOffers = false\n\n      // Figure out what compare cart notice to use if there are no flagged offers\n      if (this.hasFlaggedProductsByCategory) {\n        this.compareCartNotice = lang.values.compareCartNoticeProducts\n      }\n    }\n  },\n})\n","import angular from 'angular'\n\nexport default angular\n  .module('CompareCartComponentModule', [])\n  .config(($ocLazyLoadProvider, $stateProvider, langProvider) => {\n    $stateProvider.state('cartCompare', {\n      url: '/cart_compare?initialStoreId&updatedStoreId&session-token&redirect',\n      views: {\n        'content@': {\n          template: require('./views/compareCartState.html'),\n          controller: 'CompareCartStateController',\n        },\n      },\n      resolve: {\n        loadCtrl: $ocLazyLoad => {\n          return import(\n            /* webpackChunkName: \"compareCartStateController\", webpackPrefetch: true */ './compareCartState.controller'\n          )\n            .then(mod => $ocLazyLoad.load(mod.default))\n            .catch(err => {\n              throw new Error(`Ooops, something went wrong, ${err}`)\n            })\n        },\n        title(titleService) {\n          return titleService.setTitle(langProvider.values.cartCompare)\n        },\n      },\n      onEnter: (auth, config) => {\n        if (!auth.user.context || !auth.user.context.intent) {\n          auth.setContext({ intent: config.defaultShoppingContext })\n        }\n      },\n    })\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('CompareCartModalControllerModule', [])\n  .controller(\n    'CompareCartModalController',\n    function ($scope, compareCartService, customCartCompare, lang, mobileService) {\n      Object.assign($scope, {\n        canProceed: compareCartService.canProceed,\n        mobile: mobileService,\n        customCartCompare,\n      })\n    }\n  )\n","import _ from 'lodash'\nimport fp from 'lodash/fp'\nimport angular from 'angular'\nimport {\n  SHOPPING_MODES,\n  CART_COMPARE_CHANGES,\n  CART_COMPARE_TRIGGERS,\n} from '@app/angular/constants/context'\nimport template from './views/compareCartModal.html'\n\nexport default angular\n  .module('CompareCartServiceModule', [])\n  .service(\n    'compareCartService',\n    function compareCartService(\n      $q,\n      $state,\n      $timeout,\n      $uibModal,\n      Restangular,\n      addressList,\n      auth,\n      cartService,\n      config,\n      eComLightService,\n      shoppingContextService\n    ) {\n      const service = this\n\n      const modalOpen = function ({ disableClose, customCartCompare }) {\n        const modal = $uibModal.open({\n          template,\n          controller: 'CompareCartModalController',\n          keyboard: !disableClose,\n          backdrop: disableClose ? 'static' : true,\n          resolve: {\n            customCartCompare,\n          },\n        }).result\n\n        // This focus needs to be set manually because it opens on top of the\n        // shopping context modal. The $timeout exists to ensure that the focus\n        // will be set only after the digest cycle completes\n        $timeout(() => {\n          // eslint-disable-next-line no-unused-expressions\n          document.querySelector('.compare-cart-modal .compare-cart-content')?.focus()\n        })\n\n        return modal\n      }\n\n      const _getCustomCartCompareConfig = (changeIn, options) => {\n        const change =\n          shoppingContextService.selectedFulfillmentType !== auth.getContext().intent\n            ? CART_COMPARE_CHANGES.FULFILLMENT\n            : changeIn\n        const customCompareConfig =\n          config.customCartCompare &&\n          config.customCartCompare.changeIn &&\n          config.customCartCompare.changeIn[change]\n\n        if (customCompareConfig && change === CART_COMPARE_CHANGES.FULFILLMENT) {\n          const entry =\n            customCompareConfig.find(\n              c =>\n                c.from.includes(options.additionalInfo.from) &&\n                c.to.includes(options.additionalInfo.to) &&\n                options.additionalInfo.changes.filter(x => c.triggeredBy.includes(x)).length\n            ) || {}\n\n          return {\n            ...entry,\n            change,\n          }\n        }\n      }\n\n      const _getDeliveryAddressParams = params => {\n        const context = auth.getContext()\n\n        return (\n          params.delivery_address ||\n          addressList.addressItems.find(address => address.id === auth.user.context.address_id) || {\n            city: context.city || '',\n            address_id: context.address_id || '',\n            address1: context.street_address || '',\n            province: context.province_short || '',\n            postal_code: context.deliveryPostalCode || '',\n          }\n        )\n      }\n\n      // Call compareCart API, check if there has been a change in inventory, product price or product blackout.\n      // The canProceed parameter is a flag, determining if we alow the user to continue in the application flow through the modal,\n      //  or if they get stopped when they respond to the modal.\n      // The changeIn parameter is a string that defines whether the compare is evaluating a change in 'fulfillment', store', 'timeslot', 'reservation', or 'address'\n      // In params, 'store_id' parameter is needed if the changeIn is type 'store',\n      //  'timeslot' and 'fulfillment_date' are needed if changeIn is of type 'timeslot',\n      //  'delivery_postal_code' is needed if changeIn is of type 'address',\n      //  'fulfillment_type' (representing the \"to\" fulfillment type) is needed if changeIn is of type 'fulfillment', and\n      //  no params are sent if changeIn is of type 'reservation'.\n\n      service.compareCart = function (canProceed, changeIn, params = {}) {\n        // Current number of categorized products in user's list/cart (this will exclude custom and uncategorized products)\n        const categorizedProducts = cartService.getAllStoreProductsInCart()\n        const numCategorized = categorizedProducts.length\n        const numCustom = cartService.countCustomItems()\n        const numTotal = numCategorized + numCustom\n\n        // (The following assumes compareCart never gets called if the new selected context is the same as the previous one, or else this this won't be accurate)\n        const betweenCartAndList =\n          changeIn === CART_COMPARE_CHANGES.FULFILLMENT ||\n          auth.user.context.intent === SHOPPING_MODES.INSTORE_LIST ||\n          params.fulfillment_type === SHOPPING_MODES.INSTORE_LIST\n\n        // The following gets passed to cart/list migration to ensure we show an accurate message for the user\n        const transferData = {\n          numCustom,\n          numTotal,\n          // numTransferable (defined below)\n          // transferableProducts (defined below)\n        }\n\n        if (\n          changeIn === CART_COMPARE_CHANGES.FULFILLMENT ||\n          auth.getContext().intent !== shoppingContextService.selectedFulfillmentType\n        ) {\n          transferData.additionalInfo = {\n            to: params.fulfillment_type,\n            from: auth.user.context.intent,\n          }\n        }\n\n        // Check to see if the catering shopping selector exists, otherwise fallback to eComLight.fulfillmentType\n        const isFulfillmentTypeCatering =\n          params.fulfillment_type ===\n          (config.shoppingSelector?.catering?.exists\n            ? SHOPPING_MODES.CATERING\n            : config.eComLight?.fulfillmentType)\n\n        // Note: Cart compare is ignored in catering mode, while switching stores or switching contexts.\n        // This can be revisited when mixed-bag use case is considered.\n        const shouldIgnoreCartCompare =\n          numCategorized === 0 ||\n          (config.disableCompareCart && !betweenCartAndList) ||\n          (config.eComLight.enabled &&\n            (eComLightService.inEComLightMode ||\n              isFulfillmentTypeCatering ||\n              transferData?.additionalInfo?.to === SHOPPING_MODES.CATERING ||\n              transferData?.additionalInfo?.from === SHOPPING_MODES.CATERING))\n\n        if (shouldIgnoreCartCompare) {\n          // Retailers with disabled compare cart only require a backend call when there are categorized products in the cart and the user\n          //  is going between list and cart, because we need to show the user an accurate message for the list/cart migration\n          transferData.numTransferable = 0\n          transferData.transferableProducts = []\n          return $q.resolve(transferData)\n        }\n\n        const cartOrList =\n          auth.user.context.intent === SHOPPING_MODES.INSTORE_LIST ? 'user_lists/default' : 'cart'\n\n        params.delivery_address = _getDeliveryAddressParams(params)\n\n        // Final endpoint is based on whether or not cart or list needs to be compared (cartOrList),\n        //  and what change prompted the cart compare (changeIn)\n        return Restangular.all(cartOrList)\n          .all('compare')\n          .all(changeIn)\n          .post(params)\n          .then(lists => {\n            const hasInStoreMarkup = config.hasInStoreMarkup && betweenCartAndList\n\n            // The lists parameter is the different lists that get received from the compare cart API.\n            const unavailableCategorizedProductIds = fp.flow(\n              fp.union(lists.configurable_product_leadtime),\n              fp.union(lists.product_inventory),\n              fp.uniqBy(item => item.id),\n              fp.map(item => item.id)\n            )(lists.product_blackout)\n            const numUnavailable = unavailableCategorizedProductIds.length\n\n            const hasPriceChanged = lists.product_pricing?.length > 0 || hasInStoreMarkup\n            const hasOffersChanged = lists.offers?.length > 0\n            const hasAvailabilityChanged = numUnavailable > 0\n\n            const shouldShowCartCompare =\n              hasAvailabilityChanged || hasPriceChanged || hasOffersChanged\n            const shouldRecalculateFees = hasPriceChanged || hasAvailabilityChanged\n\n            const changes = [\n              hasPriceChanged && CART_COMPARE_TRIGGERS.PRICE,\n              hasAvailabilityChanged && CART_COMPARE_TRIGGERS.STOCK,\n              hasOffersChanged && CART_COMPARE_TRIGGERS.OFFER,\n            ]\n\n            transferData.additionalInfo = {\n              ...transferData.additionalInfo,\n              changes: changes.filter(c => c),\n            }\n\n            if (config.customCartCompare.enabled) {\n              transferData.customCartCompare = _getCustomCartCompareConfig(changeIn, transferData)\n            }\n\n            transferData.shouldRecalculateFees = shouldRecalculateFees\n            transferData.numTransferable = numCategorized - numUnavailable\n            transferData.transferableProducts = categorizedProducts.filter(\n              product => !_.includes(unavailableCategorizedProductIds, product.id)\n            )\n\n            // Allowing the cart compare list, and canProceed to be accessible outside of the service\n\n            service.cartComparelists = lists\n            service.canProceed = canProceed\n\n            const modalOptions = config.customCartCompare.enabled\n              ? {\n                  customCartCompare: _getCustomCartCompareConfig(changeIn, transferData),\n                }\n              : {}\n\n            if (\n              shouldShowCartCompare &&\n              !config.disableCompareCart &&\n              (config.customCartCompare.enabled || !betweenCartAndList) &&\n              $state.current.name !== 'cartCompare'\n            ) {\n              const dismissHandler = () => ({ ...transferData, dismissed: true })\n              const openModal = () => {\n                return modalOpen({\n                  ...modalOptions,\n                  disableClose: true,\n                }).then(() => transferData, dismissHandler)\n              }\n\n              if (!modalOptions.customCartCompare) {\n                return openModal()\n              }\n\n              // Checking if the cart/list has changes that are not handled by the active\n              // customCartCompare rule, if there's any, we open the modal, otherwise, we proceed\n              // by resolving the cart *transferData*\n              const cartChanges = transferData.additionalInfo.changes\n              const cartCompareTriggers = new Set(modalOptions.customCartCompare.triggeredBy)\n              const changesDiff = new Set(\n                [...cartChanges].filter(change => !cartCompareTriggers.has(change))\n              )\n\n              return changesDiff.size === 0 ? $q.resolve(transferData) : openModal()\n            }\n            return $q.resolve(transferData)\n          })\n          .catch(e => console.error(e))\n      }\n    }\n  )\n","import angular from 'angular'\n\nimport CompareCartComponent from './compareCart.component.js'\nimport CompareCartRoutes from './compareCart.routes.js'\nimport CompareCartModalController from './compareCartModal.controller.js'\nimport CompareCartService from './compareCartService.js'\n\nexport default angular.module('app.component.compareCartModule', [\n  CompareCartComponent.name,\n  CompareCartRoutes.name,\n  CompareCartModalController.name,\n  CompareCartService.name,\n])\n","import angular from 'angular'\n\nexport default angular\n  .module('ExternalPageComponentModule', [])\n  .config(($ocLazyLoadProvider, $stateProvider) => {\n    $stateProvider.state('main.externalPage', {\n      url: '/external/{id}',\n      views: {\n        'content@': {\n          template: require('./externalPage.html'),\n          controller: 'ExternalPageController',\n        },\n      },\n      resolve: {\n        loadCtrl: $ocLazyLoad => {\n          return import(\n            /* webpackChunkName: \"externalPageController\", webpackPrefetch: true */ './externalPageController'\n          )\n            .then(mod => $ocLazyLoad.load(mod.default))\n            .catch(err => {\n              throw new Error(`Ooops, something went wrong, ${err}`)\n            })\n        },\n      },\n    })\n  })\n","import angular from 'angular'\nimport ExternalPage from './externalPageRoutes.js'\n\nexport default angular.module('app.component.externalPageModule', [ExternalPage.name])\n","import angular from 'angular'\n\nexport default angular\n  .module('FlyerPreviewModalControllerModule', [])\n  .controller(\n    'FlyerPreviewModalController',\n    function FlyerPreviewModalController(\n      $state,\n      $uibModalInstance,\n      currentFlyer,\n      flyerCategoriesAndPdfsService,\n      flyerPreviewService,\n      lang,\n      mobileService,\n      previewFlyers,\n      previewToken\n    ) {\n      this.isMobile = mobileService.isMobile\n      this.lang = lang\n\n      this.currentFlyer = currentFlyer\n      this.previewFlyers = previewFlyers\n\n      // Initialize flyer radio to show the current flyer being viewed as selected\n      this.selectedPreviewToken = previewToken || 'current'\n\n      this.goToFlyer = toFlyerPreviewToken => {\n        toFlyerPreviewToken = toFlyerPreviewToken === 'current' ? null : toFlyerPreviewToken\n        const currentFlyerPreviewToken = flyerPreviewService.getPreviewToken()\n\n        // eslint-disable-next-line eqeqeq\n        if (toFlyerPreviewToken == currentFlyerPreviewToken) {\n          // Dismiss modal if they select the flyer currently being viewed\n          $uibModalInstance.dismiss()\n        } else {\n          // Else, set the new previewToken and navigate to the selected flyer\n          flyerPreviewService.setPreviewToken(toFlyerPreviewToken)\n\n          // Clear the flyer categories to cause a refetch\n          flyerCategoriesAndPdfsService.clearFlyerCategories()\n          $state.go('main.shop.flyer', null, { reload: true })\n        }\n      }\n    }\n  )\n","import _ from 'lodash'\nimport angular from 'angular'\nimport dayjs from 'dayjs'\n\nimport template from './flyerPreviewModal.html'\nimport FlyerPreviewModalControllerModule from './flyerPreviewModal.controller'\n\nexport default angular\n  .module('FlyerPreviewComponentModule', [FlyerPreviewModalControllerModule.name])\n  .component('flyerPreview', {\n    bindings: {\n      flyerData: '<?',\n      previewToken: '@?',\n    },\n    controller($uibModal, config, flyerPreviewService) {\n      this.hasPreviewFlyers = flyerPreviewService.hasPreviewFlyers(this.flyerData)\n\n      if (this.hasPreviewFlyers) {\n        this.currentFlyer = this.flyerData.current\n        this.previewFlyers = this.flyerData.previews\n\n        // Add date range labels\n\n        const addDateRangeLabel = flyer => {\n          const startDate = dayjs(flyer.start_date)\n          const endDate = dayjs(flyer.end_date).add(config.flyerPreviewOverlapDays, 'days')\n\n          // Hide the start date year for the flyer being viewed unless they span over 2 years\n          const startDateFormat = startDate.year() === endDate.year() ? 'MMM D' : 'MMM D, YYYY'\n\n          flyer.dateRangeLabel = `${startDate.format(startDateFormat)} - ${endDate.format(\n            'MMM D, YYYY'\n          )}`\n        }\n\n        addDateRangeLabel(this.currentFlyer)\n        _.each(this.previewFlyers, addDateRangeLabel)\n\n        this.flyerBeingViewed = this.previewToken\n          ? _.find(this.previewFlyers, { preview_token: this.previewToken })\n          : this.currentFlyer\n\n        this.openModal = () => {\n          $uibModal.open({\n            template,\n            controller: 'FlyerPreviewModalController',\n            controllerAs: '$ctrl',\n            resolve: {\n              currentFlyer: () => this.currentFlyer,\n              previewFlyers: () => this.previewFlyers,\n              previewToken: () => this.previewToken,\n            },\n          })\n        }\n      }\n    },\n    template: `\n      <span ng-if=\":: $ctrl.hasPreviewFlyers\" class=\"flyer-preview-info icon-calendar\">\n        Deals Between\n        <button ng-click=\"$ctrl.openModal()\" class=\"flyer-preview-modal-trigger\" id=\"flyer-preview-modal-trigger\">\n          {{:: $ctrl.flyerBeingViewed.dateRangeLabel}}\n        </span>\n      </span>\n    `,\n  })\n","import angular from 'angular'\nimport FlyerPreview from './flyerPreview.component.js'\n\nexport default angular.module('app.component.flyerPreviewModule', [FlyerPreview.name])\n","import _ from 'lodash'\nimport angular from 'angular'\n\nexport default angular\n  .module('FooterControllerModule', [])\n  .controller(\n    'FooterController',\n    function (\n      $rootScope,\n      $scope,\n      $state,\n      auth,\n      config,\n      eComLightService,\n      headerFooterSyncService,\n      lang,\n      utilService\n    ) {\n      $scope.config = config\n      $scope.utilService = utilService\n      $scope.state = $state\n      $scope.auth = auth\n      $scope.headerFooterSyncService = headerFooterSyncService\n      $scope.footerPrimaryLinks = []\n      $scope.footerSyncError = false\n      $scope.currentYear = new Date().getFullYear()\n      $scope.afterFooterLoaded = headerFooterSyncService.afterFooterLoaded\n      $scope.useAngularFooter = !config.react?.enableFooter && !$rootScope.isReactDemo()\n\n      if (!config.disableFooterLinks.waysToShop && !eComLightService.inEComLightMode) {\n        $scope.footerPrimaryLinks = $scope.footerPrimaryLinks.concat({\n          label: lang.values.waysToShop,\n          sref: 'main.shop',\n        })\n      }\n      if (!config.disableFooterLinks.weeklyAd && !eComLightService.inEComLightMode) {\n        $scope.footerPrimaryLinks = $scope.footerPrimaryLinks.concat({\n          label: lang.values.weeklyAd,\n          sref: 'main.shop.flyer',\n        })\n      }\n      if (!config.disableFooterLinks.orderHistory) {\n        $scope.footerPrimaryLinks = $scope.footerPrimaryLinks.concat({\n          sref: 'main.account.orderHistory',\n          label: lang.values.orderHistory,\n          loggedIn: true,\n        })\n      }\n      if (!(config.disableFooterLinks.saveForLaterLists || config.disableSaveForLaterLists)) {\n        $scope.footerPrimaryLinks = $scope.footerPrimaryLinks.concat({\n          sref: 'lists',\n          label: lang.values.saveForLaterLists,\n          loggedIn: true,\n        })\n      }\n\n      // Insert custom items\n      _.each(config.customFooterPrimaryLinks, link => {\n        $scope.footerPrimaryLinks.splice(link.index, 0, link)\n      })\n\n      // Add `id` tag labels to primary and secondary footer links that have an `sref`\n      $scope.footerPrimaryLinks = _.map(\n        $scope.footerPrimaryLinks,\n        utilService.generateAddIdToSrefLinkWithPrefix('footer-primary')\n      )\n      $scope.footerSecondaryLinks = _.map(\n        config.footerSecondaryLinks,\n        utilService.generateAddIdToSrefLinkWithPrefix('footer-secondary')\n      )\n\n      // Call template for footer sync and when using angular header instead of react\n      if (config.dotComModule.enableHeaderFooterSync && $scope.useAngularFooter) {\n        $scope.headerFooterSyncService\n          .fetchFooter()\n          .then(html => {\n            $scope.dotComFooter = html\n            $scope.footerSyncError = false\n          })\n          .catch(() => {\n            $scope.footerSyncError = true\n          })\n      }\n    }\n  )\n","import angular from 'angular'\nimport FooterModule from './footerController.js'\n\nexport default angular.module('app.component.footerModule', [FooterModule.name])\n","/**\n * Add meta tag with name=\"description\" and content=\"`${descriptionContent}`\"\n *\n * descriptionContent: `A description string for my product`\n * returns: Append to head `<meta name=\"description\" content=\"A description string for my product\"> `\n */\n\nconst appendMetaTagDescription = descriptionContent => {\n  if (process.env.UNATA_WIDGETS) {\n    return\n  }\n\n  const descriptionTags = document\n    .getElementsByTagName('head')[0]\n    .querySelectorAll('meta[name=\"description\"]')\n  if (descriptionTags.length > 0) {\n    descriptionTags[0].content = descriptionContent\n  } else {\n    const meta = document.createElement('meta')\n    meta.setAttribute('name', 'description')\n    meta.setAttribute('content', descriptionContent)\n    document.getElementsByTagName('head')[0].appendChild(meta)\n  }\n}\n\nexport default appendMetaTagDescription\n","import angular from 'angular'\n\nimport appendMetaTagDescription from '@app/utils/appendMetaTagDescription'\nimport { SCRIPT_TIMEOUT } from '@app/angular/constants/personalizationLoading'\n\nexport default angular\n  .module('HomeComponentModule', [])\n  .config(\n    ($ocLazyLoadProvider, $stateProvider, $urlRouterProvider, configConstants, langProvider) => {\n      $stateProvider\n        .state('main.home', {\n          url: '/?collections',\n          views: {\n            'content@': {\n              controller: 'HomeController',\n              template: require('./home.html'),\n            },\n          },\n          resolve: {\n            loadCtrl: $ocLazyLoad => {\n              return import(\n                /* webpackChunkName: \"homeController\", webpackPrefetch: true */ './homeController'\n              )\n                .then(mod => $ocLazyLoad.load(mod.default))\n                .catch(err => {\n                  throw new Error(`Ooops, something went wrong, ${err}`)\n                })\n            },\n            title(titleService) {\n              return titleService.setTitle(langProvider.values.home)\n            },\n          },\n          onEnter: lang => {\n            appendMetaTagDescription(lang.values.metaTagDescription)\n          },\n        })\n        // 'Pseudo route' to allow retailers to load their GTM loaded personalization script which will run, send an xhr request\n        // to their personalization provider (Adobe), and wait for a list of collection id's to be returned. Once this is returned\n        // they can route the user to the homepage, with this format i.e. '/?collections=$retailerCollectionArray'.\n\n        // We put in a timeout in case the clients personalization script fails, in which case we route them to the default MLP\n        .state('main.home.loading', {\n          url: 'script-loading',\n          resolve: {\n            waitForRetailerScript($state, $timeout) {\n              $timeout(\n                () => {\n                  $state.go('main.home')\n                },\n                configConstants.allowPassingCollectionIDAsQueryParams?.homepage ? SCRIPT_TIMEOUT : 0\n              )\n              return new Promise(() => {})\n            },\n          },\n        })\n      $urlRouterProvider.when('', '/')\n    }\n  )\n  .run($templateCache => {\n    $templateCache.put('home.desktop.html', require('./home.desktop.html'))\n    $templateCache.put('home.mobile.html', require('./home.mobile.html'))\n    $templateCache.put('homepageOrders.html', require('./homepageOrders.html'))\n  })\n","export const SCRIPT_TIMEOUT = 2000\n","import angular from 'angular'\nimport { imageTransform } from '@instacart/enterprise-services'\nimport template from './categoryCard.html'\n\nexport default angular\n  .module('CategoryCardComponentControllerModule', [])\n  .component('categoryCard', {\n    template,\n    bindings: {\n      category: '<',\n      tileSize: '<',\n      href: '<',\n      type: '<',\n      hrefOpts: '<',\n    },\n    controller($filter, $scope, $state, imageURLService, mobileService, config) {\n      const { category, hrefOpts, tileSize = 'small', href, type } = this\n      const isRecipe = type === 'recipe'\n\n      // this comes from `shopRoutes.js` in the `main.shop.categories` definition. We have to manually set this type\n      // to ensure that we pass the correct $stateParams as we transition from MLPv1 to MLPv2\n      const isMLP = category?.type === 'mlp_v2'\n\n      let hrefStateParams = { category_id: category.id }\n      if (isRecipe) {\n        hrefStateParams = { recipe_category_id: category.id }\n      } else if (isMLP) {\n        hrefStateParams = { mlp_id: category.id, mlp_slug: $filter('slugify')(category.name) }\n      }\n\n      const isIdsTile = config.react?.enableIdsCategoryTile\n\n      $scope.reactProps = {\n        imagesObj: [\n          {\n            src: imageTransform(\n              isRecipe\n                ? imageURLService.getRecipeCategoryImageURL(category)\n                : category.images.tile[tileSize],\n              { width: isIdsTile && !mobileService.isMobile ? 350 : 300, height: 230 }\n            ),\n            // image dimensions for lazy loading\n            height: 190,\n            width: isIdsTile && !mobileService.isMobile ? 290 : 249,\n            alt: '',\n          },\n        ],\n        linkObj: {\n          href: $state.href(href, hrefStateParams, hrefOpts),\n        },\n        titleObj: {\n          iconClass: 'icon-go',\n          text: category.name,\n        },\n      }\n    },\n  })\n","import angular from 'angular'\nimport CategoryCard from './categoryCard'\n\nexport default angular.module('app.shared.categoryCardComponent', [CategoryCard.name])\n","import angular from 'angular'\nimport Home from './homeRoutes.js'\nimport CategoryCard from '../shared/categoryCard'\n\nexport default angular.module('app.component.homeModule', [CategoryCard.name, Home.name])\n","import angular from 'angular'\n\nexport default angular\n  .module('IcExpressComponentModule', [])\n  .config(($stateProvider, configConstants, langProvider) => {\n    const { icExpress } = configConstants\n    const { mainPage, profilePage } = icExpress\n\n    if (icExpress.enabled) {\n      $stateProvider\n        .state('main.icExpress', {\n          url: `/${mainPage.urlName}`,\n          views: {\n            'content@': {\n              template: `\n                  <div class=\"ic-express-main\">\n                    <ic-express-entry\n                      is-go-to-main-on-success=\"true\"\n                    ></ic-express-entry>\n                  </div>\n                `,\n            },\n          },\n          onEnter($rootScope, $state, $timeout, auth, express, titleService) {\n            $timeout(() => {\n              titleService.setTitle(langProvider.values.icExpress.subscriptionPageTitle)\n\n              // If the user is not logged in, the call to get subscriptions will fail.\n              // Instead, navigate directly to the page\n              if (!auth.user.ic_linked) {\n                return\n              }\n\n              if (!icExpress.enabled) {\n                $state.go('main.404')\n                return\n              }\n              $rootScope.isAppLoading = true\n              express\n                .getCurrentSubscription(true)\n                .then(() => {\n                  // The subscription route is not available for express trial and membership users\n                  if (express.isMember() || express.isTrial() || express.isCoupon()) {\n                    $state.go('main.account.icExpress')\n                  }\n                })\n                .catch(() => $state.go('main.404'))\n                .finally(() => ($rootScope.isAppLoading = false))\n            })\n          },\n        })\n\n        .state('main.icExpressCancel', {\n          url: `/${mainPage.urlName}/cancel`,\n          views: {\n            'content@': {\n              template: `\n                <ic-express-cancellation\n                  ng-if=\"!isLoading\"\n                ></ic-express-cancellation>\n              `,\n              controller($rootScope, $scope, $state, express) {\n                $scope.isLoading = true\n                $rootScope.isAppLoading = true\n\n                express\n                  .getCurrentSubscription(true)\n                  .catch(() => $state.go('main.404'))\n                  .finally(() => {\n                    $scope.isLoading = false\n                    $rootScope.isAppLoading = false\n                  })\n              },\n            },\n          },\n          onEnter($state, $timeout, auth, titleService) {\n            $timeout(() => {\n              titleService.setTitle(langProvider.values.icExpress.cancelPageTitle)\n\n              if (!auth.user.ic_linked || !icExpress.enabled) {\n                $state.go('main.404')\n              }\n            })\n          },\n        })\n\n        .state('main.account.icExpress', {\n          url: `/${profilePage.urlName}`,\n          views: {\n            'content@main.account': {\n              controller: 'IcExpressProfilePageController',\n              controllerAs: '$ctrl',\n              template: icExpress.profilePage.showNewProfilePage\n                ? require('./views/expressProfilePageNew.html')\n                : require('./views/expressProfilePage.html'),\n            },\n          },\n          data: {\n            breadcrumbs: [\n              {\n                label: langProvider.values.accountDetails,\n              },\n              {\n                label: icExpress.name,\n              },\n            ],\n          },\n          onEnter($rootScope, $state, $timeout, auth, express) {\n            $timeout(() => {\n              if (!auth.user.ic_linked || !icExpress.enabled) {\n                $state.go('main.404')\n                return\n              }\n\n              express\n                .getCurrentSubscription(true)\n                .then(({ subscription }) => {\n                  if (!subscription || !subscription.id) {\n                    $state.go('main.icExpress', null, { location: 'replace' })\n                  }\n                })\n                .catch(() => $state.go('main.404'))\n            })\n          },\n        })\n    }\n  })\n","import angular from 'angular'\nimport { EXPIRATION_DATE_FORMAT } from '@app/angular/constants/express'\nimport template from './firstStep.html'\n\nclass ExpressCancelFirstStep {\n  constructor($scope, auth, config, express, lang) {\n    Object.assign(this, {\n      $scope,\n      auth,\n      config,\n      express,\n      lang,\n      EXPIRATION_DATE_FORMAT,\n      adList: [],\n    })\n  }\n\n  $onInit() {\n    this.express\n      .getAdList()\n      .then(list => (this.adList = list))\n      .then(() => this.$scope.$apply())\n  }\n\n  getSubtitle() {\n    const { trialSubtitle, membershipSubtitle } = this.config.icExpress.cancellation.firstStep\n\n    return this.lang.template(this.express.isTrial() ? trialSubtitle : membershipSubtitle, {\n      daysLeft: this.express.getMembershipRemainingDays(),\n      expressName: this.config.icExpress.name,\n    })\n  }\n\n  getRenewReminderText() {\n    const { membership, trial } = this.lang.values.icExpress\n    const plan = this.express.isTrial() ? trial : membership\n\n    return this.lang.templateAsString(this.config.icExpress.cancellation.renewReminder, {\n      plan,\n    })\n  }\n\n  getBottomText() {\n    const { trialBottomText, membershipBottomText } = this.config.icExpress.cancellation.firstStep\n    const text = !this.express.isTrial() ? trialBottomText : membershipBottomText\n\n    return this.lang.templateAsString(text, {\n      plan: this.express.getPlanType(),\n      expressName: this.config.icExpress.name,\n    })\n  }\n}\n\nexport default angular\n  .module('IcExpressCancelFirstStepComponentModule', [])\n  .component('expressCancelFirstStep', {\n    template,\n    bindings: {\n      useIcTheme: '<',\n      onContinueClick: '&',\n      onSendReminderClick: '&',\n      termsOfService: '<',\n    },\n    controller: ExpressCancelFirstStep,\n  })\n","import angular from 'angular'\nimport { EXPIRATION_DATE_FORMAT } from '@app/angular/constants/express'\nimport template from './secondStep.html'\n\nclass ExpressCancelFirstStep {\n  constructor($filter, config, express, lang) {\n    Object.assign(this, {\n      $filter,\n      config,\n      express,\n      lang,\n    })\n  }\n\n  $onInit() {\n    this.subTitle = this.getSubtitle()\n    this.bottomText = this.getBottomText()\n    this.planLabel = this.getPlanPriceText()\n    this.membershipButtonLabel = this.getMembershipButtonLabel()\n  }\n\n  getMembershipButtonLabel() {\n    const { icExpress } = this.config\n\n    return this.lang.template(icExpress.cancellation.secondStep.buttonLabel, {\n      price: this.getPlanPriceText(),\n      express: icExpress.shortName,\n    })\n  }\n\n  getSubtitle() {\n    return this.lang.template(this.config.icExpress.cancellation.secondStep.subTitle, {\n      expressName: this.config.icExpress.name,\n      chargeDate: this.express.getMembershipEndDate().format(EXPIRATION_DATE_FORMAT),\n    })\n  }\n\n  getRenewReminderText() {\n    const { membership, trial } = this.lang.values.icExpress\n    const plan = this.express.isTrial() ? trial : membership\n\n    return this.lang.templateAsString(this.config.icExpress.cancellation.renewReminder, {\n      plan,\n    })\n  }\n\n  getBottomText() {\n    const buttonLabel = this.lang.templateAsString(\n      this.config.icExpress.cancellation.secondStep.buttonLabel,\n      {\n        price: this.getPlanPriceText(),\n      }\n    )\n\n    return this.lang.templateAsString(this.config.icExpress.cancellation.secondStep.bottomText, {\n      buttonLabel,\n      chargeDate: this.express.getMembershipEndDate().format(EXPIRATION_DATE_FORMAT),\n      planPrice: this.getPlanPriceText(),\n    })\n  }\n\n  getPlanPriceText() {\n    return this.$filter('currency')(this.config.icExpress.plans.monthly.price)\n  }\n}\n\nexport default angular\n  .module('IcExpressCancelSecondStepComponentModule', [])\n  .component('expressCancelSecondStep', {\n    template,\n    bindings: {\n      useIcTheme: '<',\n      onContinueClick: '&',\n      onSendReminderClick: '&',\n      onUpdateMembershipClick: '&',\n      termsOfService: '<',\n    },\n    controller: ExpressCancelFirstStep,\n  })\n","import angular from 'angular'\nimport { EXPIRATION_DATE_FORMAT } from '@app/angular/constants/express'\nimport template from './thirdStep.html'\n\nclass ExpressCancelFirstStep {\n  constructor($filter, config, express, lang) {\n    Object.assign(this, {\n      config,\n      express,\n      lang,\n      currencyFilter: $filter('currency'),\n    })\n  }\n\n  $onInit() {\n    const { trial, membership } = this.lang.values.icExpress\n\n    this.options = this._getOptions()\n    this.plan = this.express.isTrial() ? trial : membership\n  }\n\n  cancelMembership() {\n    this.onMembershipCancelClick({\n      data: {\n        option: this.cancelOption,\n        details: this.cancelText,\n      },\n    })\n  }\n\n  getCancellationTitle() {\n    const {\n      membershipCancellationTitle,\n      trialCancellationTitle,\n    } = this.config.icExpress.cancellation.thirdStep\n\n    const title = this.express.isTrial() ? trialCancellationTitle : membershipCancellationTitle\n\n    return this.lang.template(title, {\n      chargeDate: this.express.getMembershipEndDate().format(EXPIRATION_DATE_FORMAT),\n    })\n  }\n\n  getCancellattionText() {\n    const {\n      membershipRefundText,\n      membershipText,\n      trialCancellationText,\n    } = this.config.icExpress.cancellation.thirdStep\n\n    return this.lang.templateAsString(\n      this.express.isTrial()\n        ? trialCancellationText\n        : this.express.isRefundEligible()\n        ? membershipRefundText\n        : membershipText,\n      {\n        express: this.config.icExpress.shortName,\n        amount: this.currencyFilter(\n          this.express.userCurrentSubscription.subscription.subscription_plan.price\n        ),\n      }\n    )\n  }\n\n  getRenewReminderText() {\n    return this.lang.templateAsString(this.config.icExpress.cancellation.renewReminder, {\n      plan: this._getPlanName(),\n    })\n  }\n\n  getCancelButtonLabel() {\n    return this.lang.templateAsString(\n      this.config.icExpress.cancellation.thirdStep.cancelButtonLabel,\n      { plan: this._getPlanName() }\n    )\n  }\n\n  _getPlanName() {\n    const { membership, trial } = this.lang.values.icExpress\n\n    return this.express.isTrial() ? trial : membership\n  }\n\n  _getOptions() {\n    const options =\n      (this.express.userCurrentSubscription &&\n        this.express.userCurrentSubscription.subscription &&\n        this.express.userCurrentSubscription.subscription.subscription_plan &&\n        this.express.userCurrentSubscription.subscription.subscription_plan.cancellation_reasons) ||\n      {}\n\n    return Object.keys(options).map(option => {\n      return {\n        id: option,\n        label: options[option],\n      }\n    })\n  }\n}\n\nexport default angular\n  .module('IcExpressCancelThirdStepComponentModule', [])\n  .component('expressCancelThirdStep', {\n    template,\n    bindings: {\n      useIcTheme: '<',\n      onExitClick: '&',\n      onSendReminderClick: '&',\n      onMembershipCancelClick: '&',\n    },\n    controller: ExpressCancelFirstStep,\n  })\n","import angular from 'angular'\nimport { EXPIRATION_DATE_FORMAT } from '@app/angular/constants/express'\n\nimport template from './forthStep.html'\n\nclass ExpressCancelForthStep {\n  constructor(config, express, lang) {\n    Object.assign(this, {\n      config,\n      express,\n      lang,\n    })\n  }\n\n  getTitle() {\n    const { membershipTitle, trialTitle } = this.config.icExpress.cancellation.forthStep\n\n    return this.lang.templateAsString(this.express.isTrial() ? trialTitle : membershipTitle, {\n      express: this.config.icExpress.shortName,\n    })\n  }\n\n  getBody() {\n    const {\n      refundEligibleText,\n      refundIneligibleText,\n      trialText,\n    } = this.config.icExpress.cancellation.forthStep\n\n    if (this.express.isTrial()) {\n      return this.lang.templateAsString(trialText, {\n        date: this.express.getMembershipEndDate().format(EXPIRATION_DATE_FORMAT),\n      })\n    }\n\n    return this.lang.templateAsString(\n      this.express.isRefundEligible() ? refundEligibleText : refundIneligibleText,\n      { express: this.config.icExpress.shortName }\n    )\n  }\n}\n\nexport default angular\n  .module('IcExpressCancelForthStepComponentModule', [])\n  .component('expressCancelForthStep', {\n    template,\n    controller: ExpressCancelForthStep,\n  })\n","import angular from 'angular'\nimport {\n  MESSAGE_PLACEMENTS,\n  EXPRESS_SUBSCRIPTION_PLAN_TERMS,\n  HTML_TEMPLATES,\n} from '@app/angular/constants/express'\nimport template from './icExpressCancellation.html'\n\nconst CANCEL_STEPS = {\n  FIRST_STEP: 1,\n  SECOND_STEP: 2,\n  THIRD_STEP: 3,\n  FORTH_STEP: 4,\n}\n\nclass IcExpressCancellation {\n  constructor($scope, $state, config, express, lang) {\n    Object.assign(this, {\n      $scope,\n      $state,\n      config,\n      express,\n      lang,\n      currentStep: CANCEL_STEPS.FIRST_STEP,\n      useIcTheme: !config.icExpress.enableRetailerTheme,\n      CANCEL_STEPS,\n    })\n  }\n\n  $onInit() {\n    this.termsOfService = this._getTermsOfService()\n  }\n\n  _getTermsOfService() {\n    const { icExpress } = this.config\n    const { url, altLabel } = icExpress.termsAndConditions\n\n    return HTML_TEMPLATES.TERMS(url, altLabel)\n  }\n\n  async nextStep() {\n    // If the user is already enrolled in a monthly plan, we show the form step\n    if (\n      this.currentStep === CANCEL_STEPS.FIRST_STEP &&\n      this.express.isTrial() &&\n      this.express.getNextPlan().id ===\n        (await this.express.getPlanIds(EXPRESS_SUBSCRIPTION_PLAN_TERMS.MONTHLY))\n    ) {\n      this.currentStep = CANCEL_STEPS.THIRD_STEP\n      return\n    }\n\n    this.currentStep += 1\n    this.$scope.$apply()\n  }\n\n  exit() {\n    this.$state.go('main.account.icExpress')\n  }\n\n  turnOnReminders() {\n    const subscriptionId = this.express.userCurrentSubscription?.subscription?.id\n\n    this.express\n      .updateSubscription({\n        subscription_id: subscriptionId,\n        send_reminder_email: true,\n      })\n      .then(() => {\n        this.express.setMessage(\n          this.lang.values.reminderUpdated,\n          this.lang.values.reminderTurnedOn,\n          null,\n          MESSAGE_PLACEMENTS.PAYMENT\n        )\n        this.exit()\n      })\n  }\n\n  async updateMembership() {\n    return this.express\n      .getPlanIds(EXPRESS_SUBSCRIPTION_PLAN_TERMS.MONTHLY)\n      .then(planId => this.express.updateMembershipPlan(planId))\n      .then(() => {\n        this.express.setMessage(\n          this.config.icExpress.membershipUpdate,\n          this.lang.values.icExpress.membershipPlanUpdate\n        )\n        this.exit()\n        this.$scope.$apply()\n      })\n  }\n\n  onMembershipCancel({ option, details }) {\n    const subscriptionId = this.express.userCurrentSubscription?.subscription?.id\n\n    return this.express\n      .updateSubscription({\n        subscription_id: subscriptionId,\n        cancel: true,\n        reason: option,\n        additional_notes: details,\n      })\n      .then(() => this._handleCancellationSuccess())\n  }\n\n  _handleCancellationSuccess() {\n    const { showNewProfilePage } = this.config.icExpress.profilePage\n    !showNewProfilePage &&\n      this.express.setMessage(\n        this.config.icExpress.membershipUpdate,\n        this.config.icExpress.cancellation.trialCancelMessage\n      )\n    this.nextStep()\n  }\n}\n\nexport default angular\n  .module('IcExpressCancellationComponentModule', [])\n  .component('icExpressCancellation', {\n    template,\n    controller: IcExpressCancellation,\n    controllerAs: '$ctrl',\n  })\n","import angular from 'angular'\nimport FirstStep from './steps/firstStep'\nimport SecondStep from './steps/secondStep'\nimport ThirdStep from './steps/thirdStep'\nimport ForthStep from './steps/forthStep'\nimport IcExpressCancellation from './icExpressCancellation'\n\nexport default angular.module('app.component.icExpressCancellation', [\n  FirstStep.name,\n  SecondStep.name,\n  ThirdStep.name,\n  ForthStep.name,\n  IcExpressCancellation.name,\n])\n","import angular from 'angular'\nimport dayjs from 'dayjs'\nimport {\n  EXPRESS_SUBSCRIPTION_PLAN_TERMS,\n  IC_PLACEMENTS,\n  IC_MEMBERSHIP_PLANS,\n  MESSAGE_PLACEMENTS,\n  MEMBERSHIP_STATUSES,\n  EXPIRATION_DATE_FORMAT as DATE_FORMAT,\n  SUBSCRIPTION_TYPES,\n} from '@app/angular/constants/express'\nimport { PAYMENT_CONTEXTS } from '@app/angular/constants/payments'\nimport interpolate from '@instacart/enterprise-services/lang/interpolate'\nimport addCreditCardModalTemplate from './views/addCreditCardModal.html'\nimport expressPlansModalTemplate from './views/expressPlansModal.html'\nimport expressPlansModalTemplateNew from './views/expressPlansModalNew.html'\nimport expressGiftCardRedeemModalTemplate from './views/expressGiftCardRedeemModal.html'\nimport expressPromoPlanChangeModalTemplate from './views/expressPromoPlanChangeModal.html'\n\nconst CREDIT_CARD_AUTH_TYPE = 'auth_capture'\n\nexport default angular\n  .module('ICExpressProfilePageControllerModule', [])\n  .controller(\n    'IcExpressProfilePageController',\n    function (\n      $filter,\n      $rootScope,\n      $scope,\n      $state,\n      $uibModal,\n      Restangular,\n      auth,\n      config,\n      express,\n      icExpressModalService,\n      lang,\n      mobileService\n    ) {\n      Object.assign($scope, {\n        auth,\n        lang,\n        config,\n        express,\n        icExpressModalService,\n        creditCards: [],\n        MESSAGE_PLACEMENTS,\n        selectedCreditCard: null,\n        IC_PLACEMENTS,\n        mobileService,\n        MEMBERSHIP_STATUSES,\n        isLoading: true,\n        paymentContext: PAYMENT_CONTEXTS.EXPRESS,\n      })\n\n      const { icExpress } = config\n\n      const PLANS = {\n        [EXPRESS_SUBSCRIPTION_PLAN_TERMS.TRIAL]: {\n          id: EXPRESS_SUBSCRIPTION_PLAN_TERMS.TRIAL,\n          name: icExpress.plans.trial.name,\n          description: icExpress.plans.trial.description,\n          period: icExpress.plans.trial.period,\n          minimumOrder: icExpress.minimumOrderAmount,\n          recurrence: icExpress.plans.trial.recurrence,\n        },\n        [EXPRESS_SUBSCRIPTION_PLAN_TERMS.YEARLY]: {\n          id: EXPRESS_SUBSCRIPTION_PLAN_TERMS.YEARLY,\n          name: icExpress.plans.yearly.name,\n          description: icExpress.plans.yearly.description,\n          period: icExpress.plans.yearly.period,\n          minimumOrder: icExpress.minimumOrderAmount,\n          recurrence: icExpress.plans.yearly.recurrence,\n        },\n        [EXPRESS_SUBSCRIPTION_PLAN_TERMS.MONTHLY]: {\n          id: EXPRESS_SUBSCRIPTION_PLAN_TERMS.MONTHLY,\n          name: icExpress.plans.monthly.name,\n          description: icExpress.plans.monthly.description,\n          period: icExpress.plans.monthly.period,\n          minimumOrder: icExpress.minimumOrderAmount,\n          recurrence: icExpress.plans.monthly.recurrence,\n        },\n      }\n\n      /**\n       * This const exists to represent plans that are not mapped in the Unata platform\n       */\n      const GENERIC_PLANS = {\n        TRIAL: {\n          name: `${icExpress.name} ${lang.values.icExpress.trial}`,\n        },\n        MEMBERSHIP: {\n          name: `${icExpress.name} ${lang.values.icExpress.membership}`,\n        },\n      }\n\n      $scope.membershipPlans = []\n\n      const _getSubscriptionPlan = plan => {\n        if (plan?.term_length) {\n          return { ...PLANS[plan.term_length], ...plan }\n        }\n        return { ...PLANS[EXPRESS_SUBSCRIPTION_PLAN_TERMS.TRIAL], ...plan }\n      }\n\n      /**\n       * Sets the membership plans the user can subscribe to\n       * @param { Array } membershipPlans\n       * @returns { undefined }\n       */\n      $scope.setMembershipPlans = async membershipPlans => {\n        $scope.membershipPlans = membershipPlans\n          .filter(plan => plan.polytype !== EXPRESS_SUBSCRIPTION_PLAN_TERMS.TRIAL)\n          .map(subscriptionPlan => _getSubscriptionPlan(subscriptionPlan))\n      }\n\n      /**\n       * Toggles the Express reminder\n       *\n       * @returns {Promise}\n       */\n      $scope.toggleReminder = () => {\n        return express\n          .toggleReminder()\n          .then(express.getCurrentSubscription)\n          .then(membership => {\n            $scope.showReminderMessage = !express.getReminderDate()._isValid\n            $scope.reminderDate = express.getReminderDate().format(DATE_FORMAT)\n\n            express.setMessage(\n              lang.values.reminderUpdated,\n              membership.subscription?.send_reminder_on\n                ? lang.values.reminderTurnedOn\n                : lang.values.reminderTurnedOff,\n              null,\n              MESSAGE_PLACEMENTS.PAYMENT\n            )\n          })\n      }\n\n      const _safelyGetSubscription = () => {\n        return express.userCurrentSubscription?.subscription || {}\n      }\n\n      $scope.getCurrentSubscription = () => {\n        const subscription = _safelyGetSubscription()\n        const subscriptionPlan = _getSubscriptionPlan(subscription.subscription_plan)\n\n        if (!subscriptionPlan) {\n          const customPlan = express.isTrial() ? GENERIC_PLANS.TRIAL : GENERIC_PLANS.MEMBERSHIP\n\n          return { ...customPlan, description: subscription?.subscription_plan?.description }\n        }\n\n        return subscriptionPlan\n      }\n\n      $scope.getNextPlanDate = () => {\n        const subscription = _safelyGetSubscription()\n\n        return dayjs(subscription.end_date)\n      }\n\n      $scope.getNextSubscriptionPlan = () => {\n        const subscription = _safelyGetSubscription()\n        return _getSubscriptionPlan(subscription?.next_subscription_plan) || {}\n      }\n\n      $scope.isTrial = express.isTrial\n      $scope.isCoupon = express.isCoupon\n\n      $scope.getTrialRemainingDays = () => {\n        const duration = dayjs($scope.getNextPlanDate()).diff(dayjs(), 'days')\n        return Math.floor(duration)\n      }\n\n      $scope.hideReminderMessage = () => {\n        $scope.showReminderMessage = false\n      }\n\n      $scope.getNextPaymentString = () => {\n        const nextSubscriptionPlan =\n          express.userCurrentSubscription?.subscription?.next_subscription_plan\n\n        if (!nextSubscriptionPlan) return\n\n        const { price, term_length } = nextSubscriptionPlan\n\n        return lang.templateAsString(lang.values.nextPaymentOn, {\n          date: $scope.membershipEndDate(),\n          amount: $filter('currency')(price),\n          duration: term_length,\n        })\n      }\n\n      $scope.membershipEndDate = () => express.getMembershipEndDate().format(DATE_FORMAT)\n\n      $scope.getNextPlanString = () => {\n        const nextSubscriptionPlan =\n          express.userCurrentSubscription?.subscription?.next_subscription_plan\n\n        if (!nextSubscriptionPlan) return\n\n        return lang.template(lang.values.instacartPlan, {\n          duration: lang.values[IC_MEMBERSHIP_PLANS[nextSubscriptionPlan.term_length]] || '',\n        })\n      }\n\n      $scope.getReminderString = () => {\n        if (express.userCurrentSubscription?.subscription?.id) {\n          return lang.template(lang.values.reminderSentToYou, {\n            date: express.getReminderDate().format(DATE_FORMAT),\n          })\n        }\n      }\n\n      express.isExpiredMembership().then(resp => {\n        if (resp) {\n          $scope.icExpressModalService.open()\n        }\n      })\n\n      const vm = this\n\n      /**\n       * Loads initial data required for rendering the Express profile page\n       */\n      this.loadInitialData = () => {\n        express\n          .getCurrentSubscription()\n          .then(() => {\n            $scope.reminderDate = express.getReminderDate().format(DATE_FORMAT)\n          })\n          .finally(() => {\n            $scope.isLoading = false\n          })\n\n        express\n          .fetchEligibleSubscriptionPlans(true)\n          .then(subscriptionPlans => $scope.setMembershipPlans(subscriptionPlans))\n\n        this.loadCreditCards()\n      }\n\n      /**\n       * Fetch and set credit cards\n       * @returns { Promise }\n       */\n      vm.loadCreditCards = () => {\n        return Restangular.one('user')\n          .post('payer', {\n            payment_type: CREDIT_CARD_AUTH_TYPE,\n            service_type: PAYMENT_CONTEXTS.EXPRESS,\n            auth_capture: {},\n          })\n          .then(() => {\n            return Restangular.one('user')\n              .one('payment')\n              .get({ payment_type: CREDIT_CARD_AUTH_TYPE, service_type: PAYMENT_CONTEXTS.EXPRESS })\n          })\n          .then(paymentInstruments => this.setCreditCards(paymentInstruments))\n      }\n\n      this.setCreditCards = paymentInstruments => {\n        $scope.creditCards = paymentInstruments[CREDIT_CARD_AUTH_TYPE].payment_instruments\n      }\n\n      $scope.currentCreditCard = () => {\n        return (\n          $scope.creditCards.find(\n            cc => cc.ext_id === express.userCurrentSubscription?.subscription?.ext_instrument_id\n          ) || {}\n        )\n      }\n\n      /**\n       * Updates the Express payment method\n       * @return { Promise }\n       */\n      $scope.updatePaymentMethod = payment => {\n        const subscriptionId = express.userCurrentSubscription?.subscription?.id\n        const { id, ext_id, ext_payer_id } = payment\n\n        return express.updateSubscription({\n          ext_id,\n          ext_payer_id,\n          credit_card_id: id,\n          subscription_id: subscriptionId,\n        })\n      }\n\n      $scope.openGiftCardRedeemModal = () => {\n        return $uibModal.open({\n          template: expressGiftCardRedeemModalTemplate,\n          controller($uibModalInstance) {\n            this.onCancel = () => {\n              $uibModalInstance.close()\n            }\n\n            this.onSuccess = () => {\n              $uibModalInstance.close()\n            }\n          },\n          controllerAs: '$ctrl',\n          keyboard: false,\n          backdrop: 'static',\n        }).result\n      }\n\n      /**\n       * Opens the Stripe credit card modal form\n       * @returns { undefined }\n       */\n      $scope.openAddCreditCardModal = () => {\n        const $parentscope = $scope\n\n        $uibModal.open({\n          template: addCreditCardModalTemplate,\n          controller($scope, $uibModalInstance, config, lang) {\n            this.lang = lang\n            this.config = config\n            $scope.paymentContext = PAYMENT_CONTEXTS.EXPRESS\n\n            const _handlePaymentUpdate = card => {\n              express.setMessage(\n                lang.values.paymentMethodUpdated,\n                null,\n                null,\n                MESSAGE_PLACEMENTS.PAYMENT\n              )\n              $parentscope.creditCards = [...$parentscope.creditCards, card]\n            }\n\n            this.handleCardSelection = card => {\n              if (card.ext_id === $parentscope.currentCreditCard().ext_id) {\n                $uibModalInstance.dismiss()\n                return\n              }\n\n              $parentscope.isLoading = true\n              $uibModalInstance.dismiss()\n              document.documentElement.scrollTop = 0\n\n              $parentscope\n                .updatePaymentMethod(card)\n                .then(() => _handlePaymentUpdate(card))\n                .finally(() => ($parentscope.isLoading = false))\n            }\n          },\n          controllerAs: '$ctrl',\n        })\n      }\n\n      $scope.isAutoRenew = () => express.userCurrentSubscription?.subscription?.autorenew\n\n      /**\n       * Returns an object with the status of the user current membership\n       * @returns { object }\n       */\n      $scope.membershipStatus = () => {\n        const status = express.getMembershipStatus()\n        const autorenew = $scope.isAutoRenew()\n\n        return {\n          active: autorenew || express.isCoupon(),\n          status,\n        }\n      }\n\n      /**\n       * Reverts the trial cancellation\n       * @returns {Promise}\n       */\n      $scope.revertTrialCancellation = () => {\n        const subscription_id = express.userCurrentSubscription?.subscription?.id\n\n        return express\n          .updateSubscription({\n            cancel: false,\n            autorenew: true,\n            subscription_id,\n          })\n          .then(express.getCurrentSubscription)\n      }\n\n      $scope.changePlanFromModal = plan => {\n        if (\n          !plan ||\n          express.userCurrentSubscription?.subscription.next_subscription_plan.id === plan.id\n        ) {\n          return\n        }\n        $scope.isLoading = true\n        document.documentElement.scrollTop = 0\n        express\n          .updateMembershipPlan(plan.id)\n          .then(async () => {\n            let message = lang.values.planUpdate\n            if (express.userCurrentSubscription?.subscription?.next_subscription_plan?.promo)\n              message = config.lang.icExpress.profilePage.promoPlanChange.promoPlanSubscribeMessage\n            else if (\n              express.userCurrentSubscription?.subscription?.subscription_plan?.polytype ===\n              SUBSCRIPTION_TYPES.TRIAL\n            )\n              message = lang.values.trialPlanUpdate\n\n            express.setMessage(\n              lang.values.membershipUpdated,\n              lang.templateAsString(message, { plan: _getSubscriptionPlan(plan).name }),\n              null,\n              MESSAGE_PLACEMENTS.MEMBERSHIP\n            )\n\n            $scope.setMembershipPlans([])\n            express\n              .fetchEligibleSubscriptionPlans(true)\n              .then(subscriptionPlans => $scope.setMembershipPlans(subscriptionPlans))\n          })\n          .finally(() => {\n            $scope.isLoading = false\n          })\n      }\n\n      /**\n       * Opens the New Express plans modal\n       */\n      $scope.openPlansModalNew = async () => {\n        const nonPromoPlans = await express.fetchEligibleSubscriptionPlans(false, true)\n        const currentSubscription = (await express.getCurrentSubscription())?.subscription\n        const nextPlan = currentSubscription?.next_subscription_plan\n        $uibModal.open({\n          template: expressPlansModalTemplateNew,\n          controller($uibModalInstance) {\n            this.plans = () => {\n              const plansToShow = nonPromoPlans\n              if (!plansToShow.find(plan => plan.id === nextPlan.id)) plansToShow.unshift(nextPlan)\n              return plansToShow\n            }\n\n            this.currentSubscription = () => {\n              return currentSubscription\n            }\n\n            this.onSave = selectedPlanId => {\n              $uibModalInstance.dismiss()\n              const newPlan = this.plans().find(plan => plan.id === selectedPlanId)\n              $scope.changePlanFromModal(newPlan)\n            }\n          },\n          controllerAs: '$ctrl',\n          keyboard: false,\n          backdrop: 'static',\n          resolve: {},\n        })\n      }\n\n      /**\n       * Opens the Express plans modal\n       */\n      $scope.openPlansModal = async () => {\n        $uibModal.open({\n          template: expressPlansModalTemplate,\n          controller($uibModalInstance, config, lang, selectPlan) {\n            Object.assign(this, {\n              config,\n              lang,\n              selectPlan,\n            })\n\n            this.plans = () => {\n              return $scope.membershipPlans\n            }\n\n            const currentSubscription = express.userCurrentSubscription?.subscription\n\n            this.currentPlan =\n              currentSubscription?.subscription_plan?.polytype === SUBSCRIPTION_TYPES.TRIAL\n                ? currentSubscription?.next_subscription_plan\n                : currentSubscription?.subscription_plan\n\n            this.updatePlan = plan => {\n              $uibModalInstance.dismiss()\n              $scope.changePlanFromModal(plan)\n            }\n          },\n          controllerAs: '$ctrl',\n          keyboard: false,\n          backdrop: 'static',\n          resolve: {\n            config() {\n              return $scope.config\n            },\n            selectPlan() {\n              return express.updateMembershipPlan\n            },\n          },\n        })\n      }\n\n      /**\n       * Opens the promo plan change modal\n       */\n      $scope.openPromoPlanChangeModal = async () => {\n        $uibModal.open({\n          template: expressPromoPlanChangeModalTemplate,\n          controller($uibModalInstance) {\n            this.plan = () => {\n              return $scope.getPromoPlan()\n            }\n\n            this.onPlanChange = () => {\n              $uibModalInstance.dismiss()\n              $scope.changePlanFromModal(this.plan())\n            }\n          },\n          controllerAs: '$ctrl',\n          keyboard: false,\n          backdrop: 'static',\n          resolve: {},\n        })\n      }\n\n      $scope.nextPlanDescriptionText = () => {\n        const nextPlan = $scope.getNextSubscriptionPlan()\n        const templateString = nextPlan.promo\n          ? config.lang.icExpress.profilePage.nextPlanDescriptionTextPromo\n          : config.lang.icExpress.profilePage.nextPlanDescriptionText\n        const text = interpolate(templateString, {\n          planName: nextPlan.name,\n          activationDate: $scope.getNextPlanDate().format('MMMM D, YYYY'),\n          price: `${$scope.config.currencySymbol}${nextPlan.price}`,\n          fullPrice: `${$scope.config.currencySymbol}${nextPlan.full_price}`,\n          termLength: nextPlan.term_length,\n        })\n        return text\n      }\n\n      $scope.showNextPlanSection = () => {\n        if (!$scope.isAutoRenew()) {\n          return false\n        }\n        return $scope.getNextSubscriptionPlan().name !== $scope.getCurrentSubscription().name\n      }\n\n      $scope.showChangePlanButton = () => {\n        return (\n          $scope.isAutoRenew() &&\n          express.isExpressApplicable() &&\n          $scope.currentCreditCard().ext_id &&\n          $scope.membershipPlans.length > 0\n        )\n      }\n\n      $scope.getPromoPlan = () => {\n        const promoPlanId = $scope.config.icExpress.profilePage?.promoPlanChange?.promoPlanId\n        return $scope.membershipPlans.find(plan => plan.id === promoPlanId)\n      }\n\n      $scope.shouldShowPromoPlanChange = () => {\n        const isComponentEnabled = $scope.config.icExpress.profilePage.promoPlanChange?.enabled\n        return (\n          isComponentEnabled &&\n          $scope.isAutoRenew() &&\n          !$scope.isCoupon() &&\n          $scope.getPromoPlan() &&\n          $scope.getNextSubscriptionPlan()?.id !== $scope.getPromoPlan()?.id\n        )\n      }\n\n      $scope.showPaymentInfo = () => {\n        return $scope.isAutoRenew()\n      }\n\n      $scope.showCouponMessage = () => {\n        return $scope.isCoupon() && lang.values.icExpress.couponDurationText\n      }\n\n      this.loadInitialData()\n    }\n  )\n","import angular from 'angular'\nimport { MEMBERSHIP_STATUSES } from '@app/angular/constants/express'\nimport template from './icExpressProfile.html'\n\nclass IcExpressProfile {\n  constructor(config, lang, utilService) {\n    Object.assign(this, { config, lang, utilService })\n  }\n\n  get imageURL() {\n    const { profile } = this.config.icExpress.placements\n\n    return this.utilService.loadAssetImage(profile.image)\n  }\n\n  get text() {\n    const { icExpress } = this.config\n    const { trialText, membershipText } = icExpress.placements.profile\n\n    return this.lang.template(\n      this.membershipStatus === MEMBERSHIP_STATUSES.TRIAL ? trialText : membershipText,\n      {\n        user: this.username,\n        name: icExpress.name,\n      }\n    )\n  }\n}\n\nexport default angular.module('IcExpressProfileModule', []).component('icExpressProfile', {\n  template,\n  bindings: {\n    username: '@',\n    useIcTheme: '<',\n    membershipStatus: '<',\n  },\n  controller: IcExpressProfile,\n  controllerAs: '$ctrl',\n})\n","import angular from 'angular'\nimport IcExpressProfile from './icExpressProfile'\n\nexport default angular.module('app.components.icExpressProfile', [IcExpressProfile.name])\n","import angular from 'angular'\nimport template from './icExpressSignin.html'\n\nclass IcExpressSignin {\n  constructor(config, lang, utilService) {\n    Object.assign(this, {\n      config,\n      lang,\n      utilService,\n    })\n  }\n\n  $onInit() {\n    const { title, subtitle } = this.config.icExpress.placements.signin\n    this.title = this.title || title\n    this.subtitle = this.subtitle || subtitle\n  }\n}\n\nexport default angular.module('IcExpressSigninComponentModule', []).component('icExpressSignin', {\n  bindings: {\n    title: '@',\n    small: '<',\n    subTitle: '@',\n    enableRetailerTheme: '<',\n  },\n  template,\n  controller: IcExpressSignin,\n})\n","import angular from 'angular'\nimport IcExpressSignin from './icExpressSignin.js'\n\nexport default angular.module('app.component.icExpressSignin', [IcExpressSignin.name])\n","import { MEMBERSHIP_STATUSES } from '@app/angular/constants/express'\nimport angular from 'angular'\nimport template from './icExpressAd.html'\n\nclass IcExpressAd {\n  constructor($filter, config, lang, mobileService, utilService) {\n    Object.assign(this, {\n      config,\n      lang,\n      mobileService,\n      utilService,\n      currencyFilter: $filter('currency'),\n      parsedList: [],\n    })\n  }\n\n  $onInit() {\n    const { monthly, yearly } = this.config.icExpress.plans\n\n    this.parsedList = this.list.map(item => {\n      return {\n        ...item,\n        name: this.lang.template(item.name, {\n          date: this.cancellationDate,\n          amount: this.currencyFilter(\n            this.config.icExpress.minimumOrderAmount,\n            this.config.currencySymbol,\n            0\n          ),\n          savingsAmount: this.currencyFilter(\n            this.config.icExpress.averageSavingsAmount,\n            this.config.currencySymbol,\n            0\n          ),\n          yearlyPrice: this.currencyFilter(yearly.price, this.config.currencySymbol, 0),\n          monthlyPrice: this.currencyFilter(monthly.price, this.config.currencySymbol),\n        }),\n        desc: this.lang.template(item.desc, {\n          date: this.cancellationDate,\n          amount: this.currencyFilter(\n            this.config.icExpress.minimumOrderAmount,\n            this.config.currencySymbol,\n            0\n          ),\n          savingsAmount: this.currencyFilter(\n            this.config.icExpress.averageSavingsAmount,\n            this.config.currencySymbol,\n            0\n          ),\n          yearlyPrice: this.currencyFilter(yearly.price, this.config.currencySymbol, 0),\n          monthlyPrice: this.currencyFilter(monthly.price, this.config.currencySymbol),\n        }),\n      }\n    })\n  }\n\n  /**\n   * Takes the title that is passed and capitailzes it\n   *\n   * @returns { string }\n   */\n  get capitalizedTitle() {\n    return this.title.toUpperCase()\n  }\n\n  showPlanSelector() {\n    return (\n      this.config.icExpress.enablePlanPurchaseSelection &&\n      this.userSubscriptionStatus === MEMBERSHIP_STATUSES.MEMBERSHIP_ELIGIBLE &&\n      this.eligibleSubscriptionPlans\n    )\n  }\n}\n\nexport default angular.module('IcExpressAdComponentModule', []).component('icExpressAd', {\n  bindings: {\n    title: '@',\n    subTitle: '@',\n    ctaButtonLabel: '@',\n    ctaLinkButtonShow: '<',\n    ctaLinkButtonLabel: '@',\n    ctaLinkButtonDescription: '@',\n    list: '<',\n    onCtaButtonClicked: '&',\n    onCtaLinkButtonClicked: '&',\n    enableRetailerTheme: '<',\n    cancellationDate: '@',\n    userSubscriptionStatus: '<',\n    eligibleSubscriptionPlans: '<',\n    onPlanSelectedCallback: '<',\n    planIdToSubscribeTo: '<',\n  },\n  template,\n  controller: IcExpressAd,\n})\n","import angular from 'angular'\nimport IcExpressAd from './icExpressAd.js'\n\nexport default angular.module('app.component.icExpressAd', [IcExpressAd.name])\n","import angular from 'angular'\nimport { MEMBERSHIP_STATUSES } from '@app/angular/constants/express'\n\nimport template from './icExpressCheckout.html'\n\nclass IcExpressCheckout {\n  constructor($filter, config, express, lang) {\n    const { icExpress } = config\n    const { checkout } = icExpress.placements\n\n    Object.assign(this, {\n      lang,\n      config,\n      express,\n      placementConfig: checkout,\n      currencyFilter: $filter('currency'),\n    })\n  }\n\n  $onInit() {\n    this.enableRetailerTheme = this.enableRetailerTheme || this.config.icExpress.enableRetailerTheme\n    this.title = this.title || this.placementConfig.title\n    this.buttonLabel = this.buttonLabel || this.placementConfig.buttonLabel\n    this.checkboxLabel =\n      this.checkboxLabel ||\n      this.lang.template(this.placementConfig.checkboxLabel, { plan: this.config.icExpress.name })\n  }\n\n  get amountForFreeDelivery() {\n    const cartTotal = parseFloat(this.cartTotal)\n    const freeDelivery = this.config.icExpress.minimumOrderAmount\n\n    return freeDelivery - cartTotal\n  }\n\n  get placementTitle() {\n    if (this.hasSubscription) {\n      return this.lang.template(this.config.icExpress.placements.checkout.subscriptionTitle, {\n        plan: this.config.icExpress.name,\n      })\n    }\n\n    if (this.isTrialEligible) {\n      return this.lang.template(this.config.icExpress.placements.checkout.trialEligibleTitle, {\n        plan: this.config.icExpress.name,\n        days: this.config.icExpress.trialDays,\n      })\n    }\n\n    return this.title\n  }\n\n  /**\n   * Returns whether the user has a subscription, or null if the subscription has not been acquired yet\n   *\n   * @returns { null | boolean }\n   */\n  get hasSubscription() {\n    const subscription = this.userSubscription?.subscription\n    if (!subscription) return null\n    return !!subscription.id\n  }\n\n  /**\n   * Returns whether the user is eligible for a trial\n   *\n   * @returns { boolean }\n   */\n  get isTrialEligible() {\n    return this.express.getMembershipStatus() === MEMBERSHIP_STATUSES.TRIAL_ELIGIBLE\n  }\n}\n\nexport default angular\n  .module('IcExpressCheckoutComponentModule', [])\n  .component('icExpressCheckout', {\n    template,\n    bindings: {\n      // MANDATORY\n      optedIn: '=',\n      onChange: '&',\n      cartTotal: '<',\n      userSubscription: '<',\n\n      // OPTIONAL\n      title: '@?',\n      buttonLabel: '@?',\n      checkboxLabel: '@?',\n      enableRetailerTheme: '<?',\n      termsAndConditionsUrl: '@?',\n      termsAndConditionsLabel: '@?',\n    },\n    controller: IcExpressCheckout,\n  })\n","import angular from 'angular'\nimport IcExpressCheckout from './icExpressCheckout.js'\n\nexport default angular.module('app.component.icExpressCheckout', [IcExpressCheckout.name])\n","import angular from 'angular'\nimport {\n  EXPRESS_SUBSCRIPTION_STEPS,\n  EXPRESS_SUBSCRIPTION_STEP_ORDER,\n  MEMBERSHIP_STATUSES,\n  EXPIRATION_DATE_FORMAT,\n  EXPRESS_SUBSCRIPTION_PLAN_TERMS,\n} from '@app/angular/constants/express'\nimport { SSO_PROVIDERS } from '@app/angular/constants/ssoProviders'\nimport { LOGIN_CONTEXTS } from '@app/angular/constants/loginContexts'\nimport { getConfigByRule } from '@app/services/express/utils'\nimport template from './icExpressEntry.html'\nimport expressSignupModal from '../views/expressSignupModal.html'\nimport expressGiftCardRedeemModalTemplate from '../views/expressGiftCardRedeemModal.html'\n\nclass IcExpressEntry {\n  constructor(\n    $filter,\n    $sce,\n    $scope,\n    $state,\n    $uibModal,\n    config,\n    auth,\n    express,\n    registrationService,\n    socialSignOnService,\n    lang,\n    mobileService,\n    utilService\n  ) {\n    Object.assign(this, {\n      $sce,\n      $state,\n      $uibModal,\n      config,\n      auth,\n      express,\n      registrationService,\n      socialSignOnService,\n      lang,\n      mobileService,\n      currencyFilter: $filter('currency'),\n      userCurrentSubscription: express.userCurrentSubscription,\n      userSubscriptionStatus: null,\n      adList: [],\n      currentStep: EXPRESS_SUBSCRIPTION_STEPS.AD,\n      useIcTheme: !config.icExpress.enableRetailerTheme,\n      EXPRESS_SUBSCRIPTION_STEPS,\n      isLoading: true,\n      EXPIRATION_DATE_FORMAT,\n      eligibleSubscriptionPlans: undefined,\n      planIdToSubscribeTo: undefined,\n      utilService,\n    })\n  }\n\n  $onInit() {\n    if (EXPRESS_SUBSCRIPTION_STEP_ORDER.includes(this.initialStep)) {\n      this.currentStep = this.initialStep\n    }\n    // If the user is not logged in or we are only allowing gift card registration, populate with default values. Otherwise get their subscription information.\n    if (!this.auth.user.ic_linked) {\n      this.userSubscriptionStatus = MEMBERSHIP_STATUSES.UNAUTHENTICATED\n      this.userCurrentSubscription = null\n      this.adList = this.config.icExpress.ad.valuePropositions.unauthenticated\n      this.isLoading = false\n    } else if (this.config.icExpress.giftCardOnlyRegistration) {\n      this.userSubscriptionStatus = null\n      this.userCurrentSubscription = null\n      this.adList = this.config.icExpress.ad.valuePropositions.giftCardOnlyRegistration\n      this.isLoading = false\n    } else {\n      Promise.all([\n        this.express.getCurrentSubscription(true),\n        this.express.fetchEligibleSubscriptionPlans(),\n      ])\n        .then(results => {\n          this.userSubscriptionStatus = this.express.getMembershipStatus()\n          this.userCurrentSubscription = this.express.userCurrentSubscription\n          this.eligibleSubscriptionPlans = results[1]\n\n          // Filter out trial plans if we're not trial eligible. We can occasionally get a promo trial plan returned in the response even if we're not trial eligible\n          if (!this.express.isTrialEligible()) {\n            this.eligibleSubscriptionPlans = this.eligibleSubscriptionPlans.filter(\n              plan => plan.polytype !== EXPRESS_SUBSCRIPTION_PLAN_TERMS.TRIAL\n            )\n          }\n\n          // Set the default subscription plan\n          this.planIdToSubscribeTo = this.eligibleSubscriptionPlans[0].id\n          if (this.express.isTrialEligible()) {\n            // If we're trial eligible, the default plan is always trial\n            this.express.getPlanIds(EXPRESS_SUBSCRIPTION_PLAN_TERMS.TRIAL).then(planId => {\n              if (planId) this.planIdToSubscribeTo = planId\n            })\n          } else if (this.config.icExpress.defaultTermLengthToPurchase) {\n            // Otherwise, we try and look up the id based on the value in the config\n            this.express\n              .getPlanIds(this.config.icExpress.defaultTermLengthToPurchase)\n              .then(planId => {\n                if (planId) this.planIdToSubscribeTo = planId\n              })\n          }\n\n          this.express.getAdList().then(adList => {\n            this.adList = adList\n          })\n        })\n        .finally(() => (this.isLoading = false))\n    }\n\n    // build Instacart Link Button tooltip description\n    const tooltipDescription = this.lang.templateAsString(\n      this.config.icExpress.ad.icLinkButtonDescription,\n      {\n        retailer: this.lang.values.clientName,\n      }\n    )\n    const tooltipTitle = this.mobileService.isMobile ? '' : this.ctaLinkButtonLabel\n\n    this.ctaLinkButtonDescription = this.$sce.trustAsHtml(`\n      <div class=\"ic-express-link-account-description\">\n        <div class=\"ic-express-link-account-description__title\">${tooltipTitle}</div>\n        <div>${tooltipDescription}</div>\n      </div>\n    `)\n  }\n\n  /**\n   * Handles IC Express subscription success by updating\n   * the user current subscription and showing a success page\n   *\n   * @return { undefined }\n   */\n  handleSubscriptionSuccess() {\n    this.express.getCurrentSubscription(true)\n    this.nextStep()\n  }\n\n  /**\n   * Takes the user to the previous Express step\n   *\n   * @returns { undefined }\n   */\n  previousStep() {\n    this.currentStep = this._getPreviousStep(this.currentStep)\n  }\n\n  /**\n   * Takes the user to the next Express step\n   *\n   * @returns { undefined }\n   */\n  nextStep() {\n    this.currentStep = this._getNextStep(this.currentStep)\n  }\n\n  /**\n   *\n   * @param { string } currentStep\n   * @returns { string } A string that represents the previous step\n   */\n  _getPreviousStep(currentStep) {\n    const { AD, FORM, SUCCESS } = EXPRESS_SUBSCRIPTION_STEPS\n\n    switch (currentStep) {\n      case SUCCESS:\n        return FORM\n      case FORM:\n        return AD\n      default:\n        console.error(`There's no previous step for the ${currentStep} step`)\n        return ''\n    }\n  }\n\n  /**\n   *\n   * @param { string } currentStep\n   * @returns { string } A string that represents the next step\n   */\n  _getNextStep(currentStep) {\n    const { AD, FORM, SUCCESS } = EXPRESS_SUBSCRIPTION_STEPS\n\n    switch (currentStep) {\n      case AD:\n        return FORM\n      case FORM:\n        return SUCCESS\n      default:\n        console.error(`There's no next step for the ${currentStep} step`)\n        return ''\n    }\n  }\n\n  // This needs to be an arrow function in order to keep a correct reference to this when used in sub components\n  planSelected = planId => {\n    this.planIdToSubscribeTo = planId\n  }\n\n  /**\n   * Called when the cta button is clicekd. If we are not logged\n   * it will display the login dialog. Otherwise, it will go to the\n   * next step\n   *\n   * @returns { undefined }\n   */\n  ctaButtonClicked() {\n    if (this.userSubscriptionStatus === MEMBERSHIP_STATUSES.UNAUTHENTICATED) {\n      this.registrationService\n        .open('login', null, null, null, null, null, LOGIN_CONTEXTS.INSTACART_EXPRESS)\n        .then(this.$state.reload)\n    } else if (this.config.icExpress.giftCardOnlyRegistration) {\n      this.showGiftCardRedeemModal()\n    } else if (this.config.icExpress.enableModalSignupFlow) {\n      this.openSignupModal()\n    } else {\n      this.nextStep()\n    }\n  }\n\n  ctaLinkButtonClicked() {\n    this.socialSignOnService.handleSocialSignOn(SSO_PROVIDERS.INSTACART_LINK)\n  }\n\n  showGiftCardRedeemButton() {\n    return (\n      this.userSubscriptionStatus !== MEMBERSHIP_STATUSES.UNAUTHENTICATED &&\n      this.config.icExpress.showExpressRedeemByGiftcard\n    )\n  }\n\n  showAccountLinkButton() {\n    return (\n      this.userSubscriptionStatus !== MEMBERSHIP_STATUSES.UNAUTHENTICATED &&\n      this.config.icExpress.showExpressAccountLink &&\n      this.ctaLinkButtonLabel != null\n    )\n  }\n\n  showGiftCardRedeemModal = () => {\n    const parentThis = this\n    return this.$uibModal.open({\n      template: expressGiftCardRedeemModalTemplate,\n      controller: [\n        '$uibModalInstance',\n        function ($uibModalInstance) {\n          this.onCancel = () => {\n            $uibModalInstance.close()\n          }\n\n          this.onSuccess = () => {\n            $uibModalInstance.close()\n            parentThis.$state.go('main.home', null, {\n              reload: parentThis.$state.current.name === 'main.home',\n            })\n          }\n        },\n      ],\n      controllerAs: '$ctrl',\n      keyboard: false,\n      backdrop: 'static',\n    }).result\n  }\n\n  get title() {\n    const {\n      title,\n      trialTitle,\n      unauthenticatedTitle,\n      giftCardOnlyRegistrationTitle,\n    } = this.config.icExpress.ad\n\n    let titleString = title\n    if (this.currentStep === EXPRESS_SUBSCRIPTION_STEPS.SUCCESS) {\n      titleString = this.config.icExpress.ad.successTitle\n    } else if (this.userSubscriptionStatus === MEMBERSHIP_STATUSES.UNAUTHENTICATED) {\n      titleString = unauthenticatedTitle\n    } else if (this.config.icExpress.giftCardOnlyRegistration) {\n      titleString = giftCardOnlyRegistrationTitle\n    } else if (this.userSubscriptionStatus === MEMBERSHIP_STATUSES.TRIAL_ELIGIBLE)\n      titleString = trialTitle\n\n    return this.lang.templateAsString(titleString, {\n      planPeriod: this.getPlanPeriod(),\n    })\n  }\n\n  get subTitle() {\n    const {\n      unauthenticatedSubTitle,\n      trialSubTitle,\n      membershipSubTitle,\n      giftCardOnlyRegistrationSubTitle,\n    } = this.config.icExpress.ad\n\n    let subTitle = membershipSubTitle\n    if (this.userSubscriptionStatus === MEMBERSHIP_STATUSES.UNAUTHENTICATED) {\n      subTitle = unauthenticatedSubTitle\n    } else if (this.config.icExpress.giftCardOnlyRegistration) {\n      subTitle = giftCardOnlyRegistrationSubTitle\n    } else if (this.userSubscriptionStatus === MEMBERSHIP_STATUSES.TRIAL_ELIGIBLE)\n      subTitle = trialSubTitle\n\n    return this.lang.templateAsString(subTitle, { name: this.config.icExpress.name })\n  }\n\n  get ctaButtonLabel() {\n    const { trialDays, name, ad } = this.config.icExpress\n    const {\n      unauthenticatedButtonLabel,\n      trialButtonLabel,\n      membershipButtonLabel,\n      giftCardOnlyRegistrationButtonLabel,\n      ctaButtonLabelVariants,\n    } = ad\n\n    let label = getConfigByRule(this.express.expressUserConfigContext, ctaButtonLabelVariants)\n\n    if (!label) {\n      label = membershipButtonLabel\n      if (this.userSubscriptionStatus === MEMBERSHIP_STATUSES.UNAUTHENTICATED) {\n        label = unauthenticatedButtonLabel\n      } else if (this.config.icExpress.giftCardOnlyRegistration) {\n        label = giftCardOnlyRegistrationButtonLabel\n      } else if (this.userSubscriptionStatus === MEMBERSHIP_STATUSES.TRIAL_ELIGIBLE)\n        label = trialButtonLabel\n    }\n\n    return this.lang.templateAsString(label, {\n      days: trialDays,\n      name,\n    })\n  }\n\n  get ctaLinkButtonLabel() {\n    const { ad } = this.config.icExpress\n    const { icLinkButtonLabel, icLinkButtonLabelVariants } = ad\n    // this.auth.user.ic_linked: True when user registers an account and user is created on carrot side\n    // this.auth.user.ic_imported: True when user actually does the linking with own Instacart account\n\n    if (!this.auth.user.ic_linked || this.auth.user.ic_imported) {\n      return null\n    }\n\n    const labelVariant = getConfigByRule(\n      this.express.expressUserConfigContext,\n      icLinkButtonLabelVariants\n    )\n\n    return labelVariant || icLinkButtonLabel\n  }\n\n  get ctaLinkButtonShow() {\n    return this.config.icExpress.ad.icLinkButtonEnabled && this.ctaLinkButtonLabel != null\n  }\n\n  get headerImage() {\n    const image = getConfigByRule(\n      { ...this.express.expressUserConfigContext, isMobile: this.mobileService.isMobile },\n      this.config.icExpress.ad.headerImageVariants\n    )\n    return image ? this.utilService.loadAssetImage(image) : undefined\n  }\n\n  getDisclaimerText() {\n    const { name, minimumOrderAmount, termsAndConditions } = this.config.icExpress\n    const { trialText, membershipText } = termsAndConditions\n\n    return this.lang.templateAsString(this.express.isTrialEligible() ? trialText : membershipText, {\n      express: name,\n      minOrder: this.currencyFilter(minimumOrderAmount, this.config.currencySymbol, 0),\n      link: termsAndConditions.url,\n      planPeriod: this.getPlanPeriod(),\n    })\n  }\n\n  getPlanPeriod() {\n    const { isTrialEligible, isMembershipEligible } = this.express\n    const { price, recurrenceType } = this.config.icExpress.plans.yearly\n\n    if (isTrialEligible() || isMembershipEligible()) {\n      const amount = this.currencyFilter(price, this.config.currencySymbol, 0)\n\n      return `${amount}/${recurrenceType}`\n    }\n  }\n\n  /**\n   * Called when the button on the final step is clicked\n   *\n   * @returns { undefined }\n   */\n  onClose() {\n    const { $state } = this\n\n    if (this.isGoToMainOnSuccess) {\n      $state.go('main.home')\n    } else {\n      this.onSuccessRedirect()\n    }\n  }\n\n  openSignupModal = () => {\n    const planId = this.planIdToSubscribeTo\n    const state = this.$state\n    this.$uibModal.open({\n      template: expressSignupModal,\n      controller() {\n        this.planId = planId\n        this.onSuccess = () => {\n          state.go('main.home', {}, { reload: true })\n        }\n        this.onCancel = () => {\n          state.go('main.home', {}, { reload: true })\n        }\n      },\n      controllerAs: '$ctrl',\n      keyboard: false,\n      backdrop: 'static',\n      resolve: {},\n    })\n  }\n}\n\nexport default angular.module('IcExpressEntryComponentModule', []).component('icExpressEntry', {\n  bindings: {\n    initialStep: '<?',\n    onSuccessRedirect: '&?',\n    isGoToMainOnSuccess: '<?',\n  },\n  template,\n  controller: IcExpressEntry,\n})\n","import angular from 'angular'\nimport IcExpressEntry from './icExpressEntry.js'\n\nexport default angular.module('app.component.icExpressEntry', [IcExpressEntry.name])\n","import angular from 'angular'\nimport { PAYMENT_CONTEXTS } from '@app/angular/constants/payments'\nimport {\n  MEMBERSHIP_STATUSES,\n  EXPRESS_SUBSCRIPTION_PLAN_TERMS,\n} from '@app/angular/constants/express'\nimport template from './icExpressForm.html'\n\nclass IcExpressForm {\n  constructor($rootScope, $scope, errorModalService, express, lang) {\n    Object.assign(this, {\n      $rootScope,\n      $scope,\n      additionalFormText: '',\n      errorModalService,\n      express,\n      isSubscribing: false,\n      lang,\n    })\n\n    $scope.payment = {\n      auth_capture: null,\n    }\n\n    $scope.paymentContext = PAYMENT_CONTEXTS.EXPRESS\n  }\n\n  $onInit() {\n    const { whyProvidePaymentsNow } = this.lang.values\n\n    this.additionalFormText =\n      this.userSubscriptionStatus === MEMBERSHIP_STATUSES.TRIAL_ELIGIBLE\n        ? `${whyProvidePaymentsNow} <i class=\"icon-info\"></i>`\n        : ''\n  }\n\n  /**\n   * Subscribes the user to an Express membership\n   *\n   * @returns { Promise }\n   */\n  async subscribe() {\n    this.isSubscribing = true\n    const { ext_id, ext_payer_id } = this.$scope.payment.auth_capture.payment_instrument\n\n    let subscriptionPlanId = this.planIdToSubscribeTo\n    if (!subscriptionPlanId) {\n      subscriptionPlanId =\n        this.userSubscriptionStatus === MEMBERSHIP_STATUSES.TRIAL_ELIGIBLE\n          ? await this.express.getPlanIds(EXPRESS_SUBSCRIPTION_PLAN_TERMS.TRIAL)\n          : await this.express.getPlanIds(EXPRESS_SUBSCRIPTION_PLAN_TERMS.YEARLY)\n    }\n\n    const payload = {\n      ext_id,\n      ext_payer_id,\n      subscription_plan_id: subscriptionPlanId,\n    }\n\n    if (this.orderId) {\n      payload.order_id = this.orderId\n    }\n\n    const result = await this.express.subscribe(payload)\n    if (result.error) {\n      this.handleSubscriptionError(result.error)\n    } else {\n      this.onSubscriptionSuccess()\n    }\n  }\n\n  handleSubscriptionError(error) {\n    const { errorModalService, lang } = this\n\n    errorModalService.open(\n      error?.data?.message ||\n        lang.templateAsString(lang.values.defaultErrorMessageSuffix, {\n          error: lang.values.tryAgainPolite,\n        }),\n      lang.values.ok\n    )\n  }\n}\n\nexport default angular.module('IcExpressFormComponentModule', []).component('icExpressForm', {\n  bindings: {\n    enableRetailerTheme: '<',\n    onSubscriptionSuccess: '&',\n    onCancelFormClick: '&',\n    planIdToSubscribeTo: '<',\n    userSubscriptionStatus: '<',\n    orderId: '<?',\n  },\n  template,\n  controller: IcExpressForm,\n  controllerAs: '$ctrl',\n})\n","import angular from 'angular'\nimport IcExpressForm from './icExpressForm'\n\nexport default angular.module('app.component.icExpressForm', [IcExpressForm.name])\n","import angular from 'angular'\nimport template from './icExpressPopover.html'\n\nclass IcExpressPopover {\n  constructor(config, lang, utilService) {\n    Object.assign(this, {\n      config,\n      lang,\n      utilService,\n    })\n  }\n\n  $onInit() {\n    const {\n      image,\n      membershipTitle,\n      subtitle,\n      primaryButtonLabel,\n      secondaryButtonLabel,\n    } = this.config.icExpress.placements.popover\n\n    this.image = this.image || image\n    this.title = this.title || membershipTitle\n    this.subtitle = this.subtitle || subtitle\n    this.primaryButtonLabel = this.primaryButtonLabel || primaryButtonLabel\n    this.secondaryButtonLabel = this.secondaryButtonLabel || secondaryButtonLabel\n\n    const el = document.querySelector('.ic-express-popover')\n\n    if (el) {\n      this.utilService.trapFocusOn(el)\n      el.focus()\n    }\n  }\n\n  primaryClick() {\n    this.onPrimaryButtonClicked()\n  }\n\n  secondaryClick() {\n    this.onSecondaryButtonClicked()\n  }\n}\n\nexport default angular.module('IcExpressPopoverComponentModule', []).component('icExpressPopover', {\n  bindings: {\n    image: '@',\n    title: '<',\n    subtitle: '@',\n    primaryButtonLabel: '@',\n    secondaryButtonLabel: '@',\n    onPrimaryButtonClicked: '&',\n    onSecondaryButtonClicked: '&',\n    enableRetailerTheme: '<',\n  },\n  template,\n  controller: IcExpressPopover,\n})\n","import angular from 'angular'\nimport IcExpressPopover from './icExpressPopover.js'\n\nexport default angular.module('app.component.icExpressPopover', [IcExpressPopover.name])\n","import angular from 'angular'\nimport { MEMBERSHIP_STATUSES } from '@app/angular/constants/express'\nimport template from './icExpressPostCheckout.html'\n\nconst CSS_CLASS = 'ic-express-post-checkout'\n\nclass IcExpressPostCheckout {\n  constructor($filter, config, express, lang, mobileService, utilService) {\n    const { icExpress } = config\n    const { postCheckout } = icExpress.placements\n\n    Object.assign(this, {\n      $filter,\n      config,\n      express,\n      lang,\n      mobileService,\n      placementConfig: postCheckout,\n      utilService,\n      css: sub => CSS_CLASS + (sub ? `__${sub}` : ''),\n    })\n  }\n\n  $onInit() {\n    this.enableRetailerTheme = this.enableRetailerTheme || this.config.icExpress.enableRetailerTheme\n    this.title =\n      this.title ||\n      this.lang.template(this.placementConfig.title, {\n        deliveryFee: this.$filter('currency')(this.deliveryFee || 0),\n      })\n    this.image = this.image || this.placementConfig.image\n    this.imageAlt = this.imageAlt || this.placementConfig.imageAlt\n    this.imageMobile = this.imageMobile || this.placementConfig.imageMobile\n    this.subtitle = this.subtitle || this.placementConfig.subtitle\n    this.buttonLabels = this.buttonLabels || this.placementConfig.buttonLabels\n    this.list = this.list || this.placementConfig.list\n  }\n\n  /**\n   * Returns whether the user has a subscription, or null if the subscription has not been acquired yet\n   *\n   * @returns { null | boolean }\n   */\n  get hasSubscription() {\n    const subscription = this.userSubscription?.subscription\n    if (!subscription) return null\n    return !!subscription.id\n  }\n\n  /**\n   * Returns whether the user is eligible for a trial\n   *\n   * @returns { boolean }\n   */\n  get isTrialEligible() {\n    return this.express.getMembershipStatus() === MEMBERSHIP_STATUSES.TRIAL_ELIGIBLE\n  }\n}\n\nexport default angular\n  .module('IcExpressPostCheckoutComponentModule', [])\n  .component('icExpressPostCheckout', {\n    template,\n    bindings: {\n      // MANDATORY\n      onClick: '&', // Function to call when user clicks sign up\n      deliveryFee: '<', // The delivery fee. This will be hidden if it is 0\n      isSubscribing: '<', // true if a subscription api request is currently in progress (shows loader)\n      userSubscription: '<', // The current user subscription, or null if still loading!\n\n      // OPTIONAL\n      list: '<?',\n      title: '@?',\n      image: '@?',\n      imageAlt: '@?',\n      subtitle: '@?',\n      imageMobile: '@?',\n      buttonLabels: '<?',\n      enableRetailerTheme: '<?',\n    },\n    controller: IcExpressPostCheckout,\n  })\n","import angular from 'angular'\nimport IcExpressPostCheckout from './icExpressPostCheckout.js'\n\nexport default angular.module('app.component.icExpressPostCheckout', [IcExpressPostCheckout.name])\n","import angular from 'angular'\nimport { getConfigByRule } from '@app/services/express/utils'\nimport template from './icExpressSideCart.html'\n\nclass IcExpressSideCart {\n  constructor(config, lang, express, $scope, utilService) {\n    Object.assign(this, {\n      config,\n      lang,\n      express,\n      utilService,\n    })\n  }\n\n  $onInit() {\n    this.icon = this.config.icExpress.placements.sidecart.icon\n  }\n\n  getTitle() {\n    const { title, titleVariants } = this.config.icExpress.placements.sidecart\n    const titleVariant = getConfigByRule(this.express.expressUserConfigContext, titleVariants)\n    return this.title || titleVariant || title\n  }\n\n  getSubtitle() {\n    const {\n      membershipSubtitle,\n      subtitleVariants,\n      trialSubtitle,\n    } = this.config.icExpress.placements.sidecart\n    const subtitleVariant = getConfigByRule(this.express.expressUserConfigContext, subtitleVariants)\n    const trialEligibleSubtitle =\n      this.express.userCurrentSubscription && this.express.isTrialEligible() && trialSubtitle\n\n    return this.subtitle || subtitleVariant || trialEligibleSubtitle || membershipSubtitle\n  }\n}\n\nexport default angular\n  .module('IcExpressSideCartComponentModule', [])\n  .component('icExpressSideCart', {\n    bindings: {\n      title: '@',\n      subtitle: '<',\n      enableRetailerTheme: '<',\n      onClicked: '&',\n      onClosed: '&',\n    },\n    template,\n    controller: IcExpressSideCart,\n  })\n","import angular from 'angular'\nimport IcExpressSideCart from './icExpressSideCart.js'\n\nexport default angular.module('app.component.icExpressSideCart', [IcExpressSideCart.name])\n","import angular from 'angular'\nimport { MEMBERSHIP_STATUSES } from '@app/angular/constants/express'\nimport template from './icExpressTimeslot.html'\n\nclass IcExpressTimeslot {\n  constructor($filter, config, express, lang) {\n    Object.assign(this, {\n      express,\n      lang,\n      $filter,\n      expressConfig: config.icExpress,\n    })\n  }\n\n  get remainingAmount() {\n    return this.expressConfig.minimumOrderAmount - parseFloat(this.cartTotal)\n  }\n\n  get checkboxLabel() {\n    const label = this.optedIn ? this.optedInLabel : this.label\n\n    return this.lang.template(label, { name: this.expressConfig.name })\n  }\n\n  get label() {\n    const { trialEligibleLabel, membershipEligibleLabel } = this.expressConfig.placements.timeslot\n\n    return this.express.isTrialEligible() ? trialEligibleLabel : membershipEligibleLabel\n  }\n\n  get optedInLabel() {\n    const { trialSelectedLabel, membershipSelectedLabel } = this.expressConfig.placements.timeslot\n\n    return this.express.isTrialEligible() ? trialSelectedLabel : membershipSelectedLabel\n  }\n\n  /**\n   * Returns if the user has an active TRIAL plan or MEMBERSHIP\n   * @returns { boolean }\n   */\n  get isEnrolled() {\n    return [MEMBERSHIP_STATUSES.TRIAL, MEMBERSHIP_STATUSES.MEMBERSHIP].includes(\n      this.membershipStatus\n    )\n  }\n\n  get isExpressEligible() {\n    return this.express.isTrialEligible() || this.express.isMembershipEligible()\n  }\n}\n\nexport default angular\n  .module('icExpressTimeslotComponentModule', [])\n  .component('icExpressTimeslot', {\n    template,\n    bindings: {\n      onChange: '&',\n      cartTotal: '<',\n      useIcTheme: '<',\n      membershipStatus: '<',\n      optedIn: '=',\n    },\n    controller: IcExpressTimeslot,\n  })\n","import angular from 'angular'\nimport IcExpressTimeslot from './icExpressTimeslot'\n\nexport default angular.module('app.component.icExpressTimeslot', [IcExpressTimeslot.name])\n","import angular from 'angular'\nimport template from './icExpressPlans.html'\n\nexport default angular.module('IcExpressPlansComponentModule', []).component('icExpressPlans', {\n  template,\n  bindings: {\n    plans: '<',\n    useIcTheme: '<',\n    onPlanSelect: '&',\n    selectedPlan: '<',\n  },\n  controller(config, lang) {\n    this.$onInit = () => {\n      this.expressConfig = config.icExpress\n      this.lang = lang\n    }\n\n    this.getButtonLabel = plan => {\n      const { keep, select } = this.lang.values\n      const action = plan.id === this.selectedPlan.id ? keep : select\n\n      return this.lang.templateAsString(this.lang.values.icExpress.planLabel, {\n        action,\n        plan: plan.name,\n      })\n    }\n  },\n  controllerAs: '$ctrl',\n})\n","import angular from 'angular'\nimport IcExpressPlans from './icExpressPlans'\n\nexport default angular.module('app.component.icExpressPlans', [IcExpressPlans.name])\n","import angular from 'angular'\n\nexport default angular\n  .module('ICExpressPostCheckoutCreditCardPageControllerModule', [])\n  .controller(\n    'IcExpressPostCheckoutCreditCardPageController',\n    function ($filter, $scope, $state, config, express, lang, mobileService, order) {\n      Object.assign($scope, {\n        lang,\n        order,\n        config,\n        $filter,\n        express,\n        mobileService,\n        goToOrderPage: () => $state.go('main.checkout.confirmation', { orderId: order.id }),\n      })\n    }\n  )\n","import angular from 'angular'\n\nimport icExpress from './icExpressRoutes'\nimport icExpressCancellation from './icExpressCancellation'\nimport icExpressProfilePageController from './icExpressProfilePageController'\nimport icExpressProfile from './icExpressProfile'\nimport icExpressSignin from './icExpressSignin'\nimport icExpressAd from './icExpressAd'\nimport icExpressCheckout from './icExpressCheckout'\nimport icExpressEntry from './icExpressEntry'\nimport icExpressForm from './icExpressForm'\nimport icExpressPopover from './icExpressPopover'\nimport icExpressPostCheckout from './icExpressPostCheckout'\nimport icExpressSideCart from './icExpressSideCart'\nimport icExpressTimeslot from './icExpressTimeslot'\nimport icExpressPlans from './icExpressPlans'\nimport IcExpressPostCheckoutCreditCardPageController from './IcExpressPostCheckoutCreditCardPageController'\n\nexport default angular.module('app.component.icExpressModule', [\n  icExpress.name,\n  icExpressCancellation.name,\n  icExpressProfilePageController.name,\n  icExpressProfile.name,\n  icExpressSignin.name,\n  icExpressAd.name,\n  icExpressCheckout.name,\n  icExpressEntry.name,\n  icExpressForm.name,\n  icExpressPopover.name,\n  icExpressPostCheckout.name,\n  icExpressSideCart.name,\n  icExpressTimeslot.name,\n  icExpressPlans.name,\n  IcExpressPostCheckoutCreditCardPageController.name,\n])\n","import angular from 'angular'\nimport template from './icFulfillmentBanner.html'\n\nexport default angular\n  .module('IcFulfillmentBannerComponentModule', [])\n  .component('icFullfillmentBanner', {\n    template,\n    bindings: {\n      logoText: '@',\n      useIcTheme: '<',\n    },\n  })\n","import angular from 'angular'\nimport IcFulfillmentBanner from './icFulfillmentBanner'\n\nexport default angular.module('app.component.icFullfillmentBanner', [IcFulfillmentBanner.name])\n","import angular from 'angular'\nimport { auth as authService } from '@instacart/enterprise-services'\nimport { SSO_PROVIDERS } from '@app/angular/constants/ssoProviders'\nimport { USER_ACTIONS } from '@app/angular/constants/events'\n\nimport importIcAccountModal from './views/importIcAccountModal.html'\nimport importIcAccountSuccessModal from './views/importIcAccountSuccessModal.html'\nimport importIcAccountErrorModal from './views/importIcAccountErrorModal.html'\n\nexport default angular\n  .module('ImportIcAccountServiceModule', [])\n  // Service for performing a one-time import of your IC delivery addresses, payment information, retailer specific order history, and express membership\n  .service(\n    'importIcAccountService',\n    function importIcAccountService(\n      $rootScope,\n      $state,\n      $uibModal,\n      analytics,\n      auth,\n      config,\n      lang,\n      localStorageService,\n      redirectService,\n      uibModalAriaLabelService\n    ) {\n      const service = this\n\n      service.blockingStateTransition = ''\n      service.loginContext = ''\n\n      service.handleSocialSignOnSuccess = ({ code, redirectResponse }) => {\n        const ignorePostImportModal = localStorageService.deprecatedGet('ignorePostImportModal')\n        let linkSuccessful = false\n\n        return authService.api.auth\n          .linkAccount({ code, redirect_response: redirectResponse })\n          .then(() => {\n            if (ignorePostImportModal) {\n              localStorageService.deprecatedSet(\n                'postImportMessage',\n                `${lang.values.icImportAccount.success.inProgress} ${lang.values.icImportAccount.success.pleaseWait}`\n              )\n            }\n            linkSuccessful = true\n            analytics.logSegmentEvent('user.ic_account_import_result', {\n              success: true,\n            })\n          })\n          .catch(() => {\n            if (ignorePostImportModal) {\n              localStorageService.deprecatedSet(\n                'postImportError',\n                lang.values.icImportAccount.error.tryAgain\n              )\n            }\n            analytics.logSegmentEvent('user.ic_account_import_result', {\n              success: false,\n            })\n          })\n          .then(() => {\n            if (!auth.user.context || !auth.user.context.intent) {\n              auth.setContext({ intent: config.defaultShoppingContext })\n            }\n            return redirectService.loadRedirectUrl({ state: 'main.home' })\n          })\n          .then(() => {\n            if (ignorePostImportModal) {\n              localStorageService.deprecatedRemove('ignorePostImportModal')\n            } else if (linkSuccessful) {\n              return $uibModal.open({\n                template: importIcAccountSuccessModal,\n                controller: [\n                  '$scope',\n                  $scope => {\n                    $scope.close = () => {\n                      $scope.$close()\n                    }\n                  },\n                ],\n                backdrop: 'static',\n                keyboard: true,\n              }).closed\n            } else {\n              return $uibModal.open({\n                template: importIcAccountErrorModal,\n                controller: [\n                  '$scope',\n                  '$state',\n                  ($scope, $state) => {\n                    $scope.goToAccount = () => {\n                      $state.go('main.account.profile')\n                    }\n\n                    $scope.close = () => {\n                      $scope.$close()\n                    }\n                  },\n                ],\n                backdrop: 'static',\n                keyboard: true,\n              }).closed\n            }\n          })\n      }\n\n      service.shouldOpenModal = loginContext => {\n        // Check if Instacart Import Account is enabled\n        if (!config.icImportAccount) {\n          return false\n        }\n\n        // Check if they have an IC User ID (they are isolated)\n        if (!auth.user.ic_user_id) {\n          return false\n        }\n\n        // Check if the user is a trial user or if they have opted out\n        if (auth.user.status === 'trial' || auth.user.ic_import_opt_out) {\n          return false\n        }\n\n        // Check to see if we are in a state which we do not want to\n        // pop-up the modal\n        if (config.icImportAccountModalBannedPopupRoutes?.some(route => $state.includes(route))) {\n          return false\n        }\n\n        // Check if the sites config allow the popup, if it doesn't exist\n        // in the config the return value will be falsey\n        return config.icImportAccountModalEnablePopup[loginContext]\n      }\n\n      service.updateUserIcOptOut = () => {\n        auth.updateProfile({ ic_import_opt_out: true })\n      }\n\n      // Modal service works uses promise chains, therefore if we should not\n      // open the modal, we no-op by just returning a resolved promise\n      service.openModal = loginContext =>\n        service.shouldOpenModal(loginContext) ? service.open() : Promise.resolve()\n\n      service.open = () =>\n        $uibModal.open({\n          template: importIcAccountModal,\n          controller: [\n            '$scope',\n            'socialSignOnService',\n            ($scope, socialSignOnService) => {\n              $scope.cancel = params => {\n                if (params.skippedButtonClicked) {\n                  analytics.logSegmentEvent('user.skip_ic_account_import', {\n                    ic_account_opt_out: params.importOptOut,\n                    modal_dismissed: false,\n                  })\n                  if (params.importOptOut) {\n                    service.updateUserIcOptOut()\n                  }\n                } else {\n                  analytics.logSegmentEvent('user.skip_ic_account_import', {\n                    modal_dismissed: true,\n                  })\n                }\n                $scope.$close()\n              }\n\n              $scope.onImportClick = params => {\n                if (params.importOptOut) {\n                  service.updateUserIcOptOut()\n                }\n                analytics.logSegmentEvent('user.trigger_ic_account_import', {\n                  source: 'post-registration',\n                  ic_account_opt_out: params.importOptOut,\n                })\n                socialSignOnService.handleSocialSignOn(SSO_PROVIDERS.INSTACART_LINK)\n              }\n            },\n          ],\n          backdrop: 'static',\n          keyboard: true,\n          resolve: {\n            ariaLabel: () => {\n              uibModalAriaLabelService.setLabel(lang.values.icImportAccount.title)\n            },\n          },\n        }).result\n\n      $rootScope.$on('auth', (_event, action, loginContext) => {\n        switch (action) {\n          case USER_ACTIONS.POST_USER_LOGGED_IN_STATE_RELOAD:\n            return service.openModal(loginContext)\n          case USER_ACTIONS.POST_USER_LOGGED_IN_NO_STATE_RELOAD:\n            return $state.includes('main.checkout') && service.openModal(loginContext)\n          case USER_ACTIONS.POST_USER_EXTERNAL_LOGIN:\n            if ($state.includes('main.checkout.cartV2') && auth.getContext().intent === 'instore') {\n              service.blockingStateTransition = 'main.inStoreList.review'\n              service.loginContext = loginContext\n            } else {\n              return service.openModal(loginContext)\n            }\n        }\n      })\n\n      $rootScope.$on(\n        '$stateChangeSuccess',\n        (_event, state, _params, _previousState, _previousParams) => {\n          if (service.blockingStateTransition !== '') {\n            // eslint-disable-next-line eqeqeq\n            if (state.name == service.blockingStateTransition) {\n              service.blockingStateTransition = ''\n              service.openModal(service.loginContext)\n              service.loginContext = ''\n            }\n          }\n        }\n      )\n    }\n  )\n","import angular from 'angular'\nimport ImportIcAccountService from './importIcAccountService'\n\nexport default angular.module('app.component.importIcAccountModule', [ImportIcAccountService.name])\n","import angular from 'angular'\n\nexport default angular\n  .module('InstacartCustomerLinkConfirmModule', [])\n  .component('instacartCustomerLinkConfirm', {\n    bindings: {\n      closeModal: '<',\n    },\n    controller(lang) {\n      const vm = this\n      vm.lang = lang\n    },\n    template: `\n        <div class=\"subheader\">{{::$ctrl.lang.values.youreAllSet}}</div>\n        <div class=\"instructions\">\n            <div class=\"message success\">\n              <span class=\"icon-checkmark-circle\" aria-hidden=\"true\"></span>\n              {{::$ctrl.lang.values.yourEmailConfirmed}}\n            </div>\n            <div ng-if=\"$ctrl.error\" class=\"message error\">\n              <span class=\"icon-error\" aria-hidden=\"true\"></span>\n              {{$ctrl.error}}\n            </div>\n            <div ng-if=\"$ctrl.message\" class=\"message success\">\n              <span class=\"icon-checkmark-circle\" aria-hidden=\"true\"></span>\n              {{$ctrl.message}}\n            </div>\n        </div>\n        <div class=\"flexcontainer flexcoloumn\">\n            <button class=\"button\" ng-click=\"$ctrl.closeModal()\">{{::$ctrl.lang.values.continueShopping}}</button>\n        </div>\n    `,\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('InstacartCustomerLinkHeaderModule', [])\n  .component('instacartCustomerLinkHeader', {\n    bindings: {\n      onDismiss: '<',\n      skippable: '<',\n    },\n    controller() {},\n    template: `\n      <div class=\"modal-header modal-header-collapse-desktop modal-mobile-header-brand\">\n        <button ng-if=\"$ctrl.skippable\"\n          ng-click=\"$ctrl.onDismiss()\"\n          class=\"close\"\n          aria-label=\"{{::lang.aria.modalClose}}\"\n        >\n          <span class=\"icon-delete\" aria-hidden=\"true\"></span>\n        </button>\n\n        <img src=\"assets/images/footer-logo.svg\" alt=\"Brand Logo\" class=\"modal-mobile-header-brand-logo\" />\n      </div>\n    `,\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('InstacartCustomerLinkInputModule', [])\n  .component('instacartCustomerLinkInput', {\n    bindings: {\n      setStage: '<',\n    },\n    controller(analytics, auth, instacartCustomerLinkService, lang, localStorageService) {\n      const vm = this\n      vm.lang = lang\n      vm.auth = auth\n      vm.linkStatus = lang.values.linkAccount\n      vm.isLinking = false\n\n      vm.linkAccount = () => {\n        if (!vm.code) {\n          return\n        }\n        vm.isLinking = true\n        if (vm.isLinking) {\n          vm.linkStatus = lang.values.linkingAccount\n\n          instacartCustomerLinkService\n            .verifyLinkCode(vm.code)\n            .then(\n              user => {\n                auth.updateUser(user)\n                // remove the linklater localstoreage entry\n                localStorageService.deprecatedRemove('ic_linklater')\n                analytics.logEvent('instacart account linked', 'linked')\n                vm.setStage('confirm')\n              },\n              response => {\n                vm.error = response.data ? response.data.message : response.message\n              }\n            )\n            .finally(() => {\n              vm.isLinking = false\n              vm.linkStatus = lang.values.linkAccount\n            })\n        }\n      }\n      vm.resendCode = () => {\n        instacartCustomerLinkService.sendLinkCode().then(\n          () => {\n            vm.message = lang.values.emailResent\n          },\n          response => {\n            vm.error = response.data ? response.data.message : response.message\n          }\n        )\n      }\n    },\n    template: `\n        <div class=\"subheader\">{{$ctrl.lang.values.linkAccount}}</div>\n        <div class=\"instructions\">\n            <div>{{::$ctrl.lang.template($ctrl.lang.values.codeHasBeenSent, {emailAddress: $ctrl.auth.user.email})}}</div>\n            <input type=\"tel\" class=\"input\" ng-pattern=\"/^[0-9]*$/\" name=\"ic_code\" ng-model=\"$ctrl.code\"  required placeholder=\"{{::$ctrl.lang.values.enterCode}}\" />\n            <div ng-if=\"$ctrl.error\" class=\"message error\">\n              <span class=\"icon-error\" aria-hidden=\"true\"></span>\n              {{$ctrl.error}}\n            </div>\n            <div ng-if=\"$ctrl.message\" class=\"message success\">\n              <span class=\"icon-checkmark-circle\" aria-hidden=\"true\"></span>\n              {{$ctrl.message}}\n            </div>\n        </div>\n        <div class=\"flexcontainer flexcoloumn\">\n            <button class=\"button\" ng-class=\"{disabled:($ctrl.code.toString().length !== 6 || $ctrl.isLinking)}\" ng-click=\"$ctrl.linkAccount()\"><loading-dots show=\"$ctrl.isLinking\"></loading-dots>{{$ctrl.linkStatus}}</button>\n            <button class=\"link\" ng-click=\"$ctrl.resendCode()\">{{::$ctrl.lang.values.didntGetEmail}}</button>\n        </div>\n    `,\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('InstacartCustomerLinkModalControllerModule', [])\n  .controller(\n    'instacartCustomerLinkModalController',\n    function ($scope, skippable, startStage, linkLater) {\n      $scope.skippable = skippable\n      $scope.stage = startStage || ''\n      $scope.linkLater = linkLater\n\n      $scope.setStage = stage => {\n        $scope.stage = stage\n      }\n\n      $scope.onDismiss = () => {\n        $scope.$dismiss()\n      }\n\n      $scope.onClose = () => {\n        $scope.$close()\n      }\n    }\n  )\n","import angular from 'angular'\n\nexport default angular\n  .module('InstacartCustomerLinkServiceServiceModule', [])\n  .service('instacartCustomerLinkService', function instacartCustomerLinkService(Restangular) {\n    const service = this\n\n    service.sendLinkCode = () => {\n      // POST /users/verify\n      return Restangular.one('users/verify').post()\n    }\n\n    service.verifyLinkCode = verificationCode => {\n      // POST users/verify/confirm\n      return Restangular.one('users/verify/confirm').customPOST({ code: verificationCode })\n    }\n\n    service.retryLinking = () => {\n      return Restangular.one('users/services').post()\n    }\n  })\n","import angular from 'angular'\nimport { USER_ACTIONS } from '@app/angular/constants/events'\nimport urlParser from '@app/utils/urlParser'\nimport InstacartCustomerLinkModalControllerModule from './instacartCustomerLinkModalController'\nimport InstacartCustomerLinkServiceServiceModule from './instacartCustomerLinkService'\n\nimport ModalTemplate from './views/instacartCustomerLinkModal.html'\n\nexport default angular\n  .module('InstacartCustomerLinkModalServiceModule', [\n    InstacartCustomerLinkModalControllerModule.name,\n    InstacartCustomerLinkServiceServiceModule.name,\n  ])\n  .service(\n    'instacartCustomerLinkModalService',\n    function instacartCustomerLinkModalService(\n      $location,\n      $q,\n      $rootScope,\n      $state,\n      $uibModal,\n      auth,\n      config,\n      errorModalService,\n      instacartCustomerLinkService,\n      lang,\n      localStorageService\n    ) {\n      const service = this\n\n      const skippable = () => {\n        // if it's in checkout, it isn't skippable\n        const urlParts = urlParser($location.absUrl())\n        // check the pathname as well in case the application is loaded from url\n        return !(urlParts.pathname.includes('checkout') || $state.includes('main.checkout'))\n      }\n\n      service.openModal = function ({\n        startStage,\n        linkLater = true,\n        forceSkippableState = false,\n      } = {}) {\n        return $uibModal.open({\n          template: ModalTemplate,\n          controller: 'instacartCustomerLinkModalController',\n          keyboard: true,\n          backdrop: 'static',\n          resolve: {\n            startStage() {\n              return startStage\n            },\n            skippable() {\n              if (forceSkippableState) {\n                return true\n              }\n\n              return skippable()\n            },\n            linkLater() {\n              return linkLater\n            },\n          },\n        }).result\n      }\n\n      service.shouldShowModal = () => {\n        const deferred = $q.defer()\n        // reject if the user is not logged in, not in delivery, or the feature is not enabled.\n        if (\n          auth.user.status === 'trial' ||\n          (auth.getContext() && auth.getContext().intent !== 'delivery') ||\n          !config.instacart.enableAccountLinking\n        ) {\n          deferred.reject()\n        } else {\n          let linked = auth.user.ic_linked\n\n          if (!linked) {\n            // if not linked, call the user/services endpoint to try to link again in case there was an issue the first time the link was attempted\n            service\n              .hasAccountBeenCreated()\n              .then(() => {\n                linked = true\n              })\n              .finally(() => {\n                if (!skippable()) {\n                  linked ? deferred.reject() : deferred.resolve()\n                } else {\n                  !localStorageService.deprecatedGet('ic_linklater') && !linked\n                    ? deferred.resolve()\n                    : deferred.reject()\n                }\n              })\n          } else if (!skippable()) {\n            linked ? deferred.reject() : deferred.resolve()\n          } else {\n            !localStorageService.deprecatedGet('ic_linklater') && !linked\n              ? deferred.resolve()\n              : deferred.reject()\n          }\n        }\n        return deferred.promise\n      }\n\n      service.hasAccountBeenCreated = () => {\n        // POST /user/services\n        const deferred = $q.defer()\n        instacartCustomerLinkService\n          .retryLinking()\n          .then(\n            user => {\n              auth.updateUser(user)\n              // account linked, don't show modal\n              user.ic_linked ? deferred.resolve() : deferred.reject()\n            },\n            response => {\n              if (response && response.status && response.status === 400) {\n                // invalid email. dont stop because of this.\n                deferred.resolve()\n              } else {\n                errorModalService.open(\n                  response.data ? response.data.message : response.message,\n                  lang.values.ok\n                )\n                deferred.reject()\n              }\n            }\n          )\n          .catch(() => {\n            deferred.reject()\n          })\n        return deferred.promise\n      }\n\n      service.handleCancelledModal = (previousState, previousParams) => {\n        if (previousState.name) {\n          $state.go(previousState.name, previousParams)\n        } else {\n          $state.go('main.home')\n        }\n      }\n\n      service.handleNewLogin = (state, params) => {\n        // Redirect trial users that login to the review cart page, as their cart may have changed.\n        if ($state.includes('main.checkout')) {\n          $state.go('main.checkout.cart')\n        } else {\n          // Successully logged in / registered, continue to requested state\n          $state.go(state.name, params)\n        }\n      }\n    }\n  )\n  .run(($rootScope, $state, auth, config, instacartCustomerLinkModalService) => {\n    $rootScope.$on('$stateChangeStart', (event, state, params, previousState, previousParams) => {\n      // show the modal if the user is logged in and goes to a route that requires instacart account linked\n      if (\n        auth.user &&\n        auth.user.status !== 'trial' &&\n        state.data &&\n        state.data.requireICAccountLink &&\n        auth.getContext().intent === 'delivery'\n      ) {\n        instacartCustomerLinkModalService.shouldShowModal(event).then(() => {\n          event.preventDefault()\n          const startStage = state.data.ic_link_start_stage || ''\n          instacartCustomerLinkModalService\n            .openModal(startStage)\n            .then(() => {\n              $state.go(state.name, params)\n            })\n            .catch(() => {\n              instacartCustomerLinkModalService.handleCancelledModal(previousState, previousParams)\n            })\n            .finally(() => {\n              $rootScope.isAppLoading = false\n            })\n        })\n      }\n    })\n\n    $rootScope.$on('contextSelectionComplete', (_event, _action) => {\n      instacartCustomerLinkModalService.shouldShowModal().then(() => {\n        instacartCustomerLinkModalService.openModal()\n      })\n    })\n\n    $rootScope.$on('auth', (event, action, state, params, previousState, previousParams) => {\n      // after the user logged in through gated routes\n      if (action === 'requiredLink' && state.data.requireICAccountLink) {\n        instacartCustomerLinkModalService\n          .shouldShowModal()\n          .then(\n            () => {\n              const startStage = state.data.ic_link_start_stage || ''\n              instacartCustomerLinkModalService\n                .openModal(startStage)\n                .then(() => {\n                  instacartCustomerLinkModalService.handleNewLogin(state, params)\n                })\n                .catch(() => {\n                  instacartCustomerLinkModalService.handleCancelledModal(\n                    previousState,\n                    previousParams\n                  )\n                })\n                .finally(() => {\n                  $rootScope.isAppLoading = false\n                })\n            },\n            () => {\n              instacartCustomerLinkModalService.handleNewLogin(state, params)\n            }\n          )\n          .catch(() => {\n            instacartCustomerLinkModalService.handleNewLogin(state, params)\n          })\n      }\n      // this is to capture the gigya login.\n      if (action === 'userLoggedIn' && config.gigya && config.gigya.enabled) {\n        instacartCustomerLinkModalService.shouldShowModal().then(() => {\n          instacartCustomerLinkModalService.openModal()\n        })\n      }\n      // after user does a 'regular' log in\n      if (action === USER_ACTIONS.POST_USER_LOGGED_IN_STATE_RELOAD) {\n        instacartCustomerLinkModalService.shouldShowModal().then(() => {\n          instacartCustomerLinkModalService.openModal()\n        })\n      }\n    })\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('InstacartCustomerLinkNotifyModule', [])\n  .component('instacartCustomerLinkNotify', {\n    bindings: {\n      setStage: '<',\n      closeModal: '<',\n      skippable: '<',\n      showLinkLater: '<',\n    },\n    controller(auth, instacartCustomerLinkService, lang, localStorageService) {\n      const vm = this\n      vm.auth = auth\n      vm.lang = lang\n      vm.isSending = false\n\n      vm.sendCode = () => {\n        vm.isSending = true\n        instacartCustomerLinkService\n          .sendLinkCode()\n          .then(\n            () => {\n              vm.setStage('link')\n            },\n            response => {\n              vm.error = response.data ? response.data.message : response.message\n            }\n          )\n          .finally(() => {\n            vm.isSending = false\n          })\n      }\n\n      vm.checkLinkLater = () => {\n        return vm.showLinkLater\n      }\n\n      vm.linkLater = () => {\n        if (vm.skippable) {\n          localStorageService.deprecatedSet('ic_linklater', true)\n          vm.closeModal()\n        }\n      }\n    },\n    template: `\n        <div class=\"subheader\">{{::$ctrl.lang.values.instacart.deliveryByInstacart}}</div>\n        <div class=\"instructions\">\n        <div class=\"subtitle\">{{::$ctrl.lang.values.instacart.linkExistingInstacartAccount}}</div>\n        <div>{{::$ctrl.lang.template($ctrl.lang.values.instacart.linkExistingInstacartAccountInstructions, {retailer: $ctrl.lang.values.clientName, emailAddress: $ctrl.auth.user.email})}}</div>\n        <div ng-if=\"$ctrl.error\" class=\"message error\">\n          <span class=\"icon-error\" aria-hidden=\"true\"></span>\n          {{$ctrl.error}}\n        </div>\n        <div ng-if=\"$ctrl.message\" class=\"message success\">\n          <span class=\"icon-checkmark-circle\" aria-hidden=\"true\"></span>\n          {{$ctrl.message}}\n        </div>\n        </div>\n        <div class=\"flexcontainer flexcoloumn\">\n            <button class=\"button\" ng-click=\"$ctrl.sendCode()\" ng-class=\"{disabled:($ctrl.isSending)}\"><loading-dots show=\"$ctrl.isSending\"></loading-dots>{{::$ctrl.lang.values.sendCodeNow}}</button>\n            <button class=\"link\" ng-if=\"$ctrl.checkLinkLater()\" ng-click=\"$ctrl.linkLater()\">{{::$ctrl.lang.values.linkAccountLater}}</button>\n        </div>\n    `,\n  })\n","import angular from 'angular'\n\nimport InstacartCustomerLinkModalServiceModule from './instacartCustomerLinkModalService'\n\nexport default angular\n  .module('InstaCartCustomerLinkComponentModule', [InstacartCustomerLinkModalServiceModule.name])\n  .config($stateProvider => {\n    $stateProvider.state('main.linkaccount', {\n      url: '/link-account',\n      onEnter: ($state, instacartCustomerLinkModalService) => {\n        $state.go('main.home').then(() => {\n          instacartCustomerLinkModalService.openModal({ startStage: 'link' })\n        })\n      },\n      data: {\n        requireRegistered: true,\n      },\n    })\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('InstacartCustomerLinkSubheaderModule', [])\n  .component('instacartCustomerLinkSubheader', {\n    controller(lang, utilService) {\n      const vm = this\n      vm.lang = lang\n      vm.utilService = utilService\n    },\n    template: `\n        <div class=\"flexcontainer flexrow imagecontainer\">\n            <div class=\"logocontainer partner\"><img ng-src=\"{{::$ctrl.utilService.loadAssetImage('images/header-logo.svg')}}\" alt=\"{{::$ctrl.lang.values.clientName}}\"></div>\n            <div class=\"v-separator\"></div>\n            <div class=\"logocontainer ic-logo\"><img ng-src=\"{{::$ctrl.utilService.loadStaticImage('instacart-logo-wordmark.svg')}}\" alt=\"{{::$ctrl.lang.values.instacart.instacart}}\"></div>\n        </div>\n    `,\n  })\n","import angular from 'angular'\n\nimport InstacartCustomerLinkConfirmModule from './instacartCustomerLinkConfirm'\nimport InstacartCustomerLinkHeaderModule from './instacartCustomerLinkHeader'\nimport InstacartCustomerLinkInputModule from './instacartCustomerLinkInput'\nimport InstacartCustomerLinkModalControllerModule from './instacartCustomerLinkModalController'\nimport InstacartCustomerLinkModalServiceModule from './instacartCustomerLinkModalService'\nimport InstacartCustomerLinkNotifyModule from './instacartCustomerLinkNotify'\nimport InstacartCustomerLinkRoutesModule from './instacartCustomerLinkRoutes'\nimport InstacartCustomerLinkServiceModule from './instacartCustomerLinkService'\nimport InstacartCustomerLinkSubheaderModule from './instacartCustomerLinkSubheader'\n\nexport default angular.module('app.component.instacartCustomerLinkModule', [\n  InstacartCustomerLinkConfirmModule.name,\n  InstacartCustomerLinkHeaderModule.name,\n  InstacartCustomerLinkInputModule.name,\n  InstacartCustomerLinkModalControllerModule.name,\n  InstacartCustomerLinkNotifyModule.name,\n  InstacartCustomerLinkRoutesModule.name,\n  InstacartCustomerLinkServiceModule.name,\n  InstacartCustomerLinkModalServiceModule.name,\n  InstacartCustomerLinkSubheaderModule.name,\n])\n","import angular from 'angular'\n\nexport default angular\n  .module('InStoreComponentModule', [])\n  .config(($ocLazyLoadProvider, $stateProvider) => {\n    $stateProvider\n\n      .state('main.inStoreList', {\n        abstract: true,\n        url: '/list',\n        onEnter($state, auth, config, oneCartService, utilService) {\n          // If a user goes into an inStoreList state in a non-instore mode, send them to cart review.\n          if (auth.getContext().intent !== 'instore') {\n            // Using a hard refresh here to reload the homepage as we need a reload to properly reset the context intent and to not trigger another $stateChangeStart event.\n            const lastState = utilService.getLastState()\n            const lastStateName = lastState && lastState.name\n            if (oneCartService.enabled() && config.oneCart.listReviewToCartRedirectUrl) {\n              $state.go(config.oneCart.listReviewToCartRedirectUrl, { open_sidecart: true })\n            } else {\n              $state.go(\n                !lastStateName || !lastStateName.match('main.checkout')\n                  ? 'main.checkout.cart'\n                  : 'main.home'\n              )\n            }\n          }\n        },\n      })\n\n      .state('main.inStoreList.review', {\n        url: '/review',\n\n        views: {\n          'content@': {\n            template: require('./review/inStoreListReview.html'),\n            controller: 'InStoreListReviewController',\n            controllerAs: '$ctrl',\n          },\n        },\n        resolve: {\n          loadCtrl: $ocLazyLoad => {\n            return import(\n              /* webpackChunkName: \"inStoreListReviewController\", webpackPrefetch: true */ './review/inStoreListReview.controller'\n            )\n              .then(mod => $ocLazyLoad.load(mod.default))\n              .catch(err => {\n                throw new Error(`Ooops, something went wrong, ${err}`)\n              })\n          },\n          title(lang, titleService) {\n            return titleService.setTitle(lang.values.reviewList)\n          },\n        },\n      })\n  })\n","import angular from 'angular'\nimport InStoreComponent from './inStoreListRoutes.js'\n\nexport default angular.module('app.component.inStoreListModule', [InStoreComponent.name])\n","export const LOYALTY_ONBOARDING_STEPS = {\n  INTRO: 'intro',\n  REGISTER: 'register',\n  THANKYOU: 'thankyou',\n  LOGIN: 'login',\n  FORGOT: 'forgot',\n}\n","import angular from 'angular'\n\nimport { IC_PLACEMENTS } from '@app/angular/constants/express'\nimport { LOYALTY_ONBOARDING_STEPS } from '@app/angular/constants/loyaltyOnboarding'\nimport { LOGIN_CONTEXTS } from '@app/angular/constants/loginContexts'\n\nexport default angular\n  .module('LoyaltyOnboardingModalControllerModule', [])\n  .controller(\n    'LoyaltyOnboardingModalController',\n    function (\n      $scope,\n      $state,\n      $window,\n      auth,\n      config,\n      context,\n      errorMessage,\n      express,\n      hideRegistration,\n      lang,\n      loyaltyOnboardingStep,\n      mobileService,\n      registrationService,\n      socialSignOnData,\n      socialSignOnService,\n      uibModalAriaLabelService,\n      userAnalytics,\n      utilService\n    ) {\n      $scope.config = config\n      $scope.context = context\n      $scope.mobile = mobileService\n      $scope.LOYALTY_ONBOARDING_STEPS = LOYALTY_ONBOARDING_STEPS\n      $scope.loyaltyOnboardingStep = loyaltyOnboardingStep\n      $scope.socialSignOnData = socialSignOnData\n      $scope.currentState = $state.current.name\n      $scope.utilService = utilService\n\n      if (loyaltyOnboardingStep === 'intro') {\n        userAnalytics.logUserLoyaltyOnboardingStart()\n      }\n\n      $scope.setLoyaltyOnboardingStep = function (step) {\n        if (registrationService.hasOptionalAuthService()) {\n          return registrationService.open(step)\n        }\n        // Only track events when modal is opened for loyalty onboarding and not from home page login dropdown\n        if (context === LOGIN_CONTEXTS.LOYALTY_ONBOARDING) {\n          switch (step) {\n            case LOYALTY_ONBOARDING_STEPS.REGISTER:\n              userAnalytics.logUserRegistrationStart({\n                loyalty_onboarding: true,\n                source: $scope.loyaltyOnboardingStep,\n              })\n              break\n            case LOYALTY_ONBOARDING_STEPS.LOGIN:\n              userAnalytics.logUserLoginStart({\n                loyalty_onboarding: true,\n                source: $scope.loyaltyOnboardingStep,\n              })\n              break\n            case LOYALTY_ONBOARDING_STEPS.FORGOT:\n              userAnalytics.logUserLoyaltyOnboardingForgotPassword()\n              break\n            case LOYALTY_ONBOARDING_STEPS.THANKYOU:\n              userAnalytics.logUserLoyaltyOnboardingThankyouStart()\n              break\n            default:\n              break\n          }\n        }\n\n        switch (step) {\n          case LOYALTY_ONBOARDING_STEPS.REGISTER:\n            uibModalAriaLabelService.setLabel(lang.values.register)\n            break\n          case LOYALTY_ONBOARDING_STEPS.LOGIN:\n            uibModalAriaLabelService.setLabel(lang.values.login)\n            break\n          case LOYALTY_ONBOARDING_STEPS.FORGOT:\n            uibModalAriaLabelService.setLabel(lang.values.forgotPassword)\n            break\n          default:\n            break\n        }\n\n        $scope.loyaltyOnboardingStep = step\n      }\n\n      const checkForUserContext = () => {\n        if (!auth.user.context || !auth.user.context.intent) {\n          auth.setContext({ intent: config.defaultShoppingContext })\n        }\n      }\n\n      $scope.doCallToAction = function ({ uiState, text }) {\n        userAnalytics.logUserLoyaltyOnboardingThankyouCTAClick({ action_type: text })\n\n        if ($state.current.name === uiState) {\n          checkForUserContext()\n          $scope.$close($scope.loyaltyOnboardingStep)\n        } else {\n          checkForUserContext()\n          $state.go(uiState, null, { reload: true })\n        }\n      }\n\n      $scope.goToSocialLinkFlow = () => socialSignOnService.goToSocialLinkFlow(socialSignOnData)\n\n      $scope.onRegister = () => {\n        $scope.setLoyaltyOnboardingStep(LOYALTY_ONBOARDING_STEPS.THANKYOU)\n      }\n\n      $scope.goToStore = function (url, platform) {\n        userAnalytics.logUserLoyaltyOnboardingThankyouCTAClick({\n          action_type: `${platform} download`,\n        })\n        $window.location.href = url\n      }\n\n      // If we prompt the user to login to continue to a page (see `registrationService.promptLogin`)...\n      $scope.hideRegistration = hideRegistration // Hide links to the registration\n      $scope.errorMessage = errorMessage // Show them a message to login to continue\n\n      $scope.express = express\n      $scope.IC_PLACEMENTS = IC_PLACEMENTS\n    }\n  )\n","import angular from 'angular'\n\nimport { LOYALTY_ONBOARDING_STEPS } from '@app/angular/constants/loyaltyOnboarding'\nimport { LOGIN_CONTEXTS } from '@app/angular/constants/loginContexts'\nimport template from './views/loyaltyOnboardingModal.html'\nimport LoyaltyOnboardingModalControllerModule from './controllers/loyaltyOnboardingModalController'\n\nexport default angular\n  .module('LoyaltyOnboardingServiceModule', [LoyaltyOnboardingModalControllerModule.name])\n  // Service to power the loyalty onboarding flow.\n  .service(\n    'loyaltyOnboardingService',\n    function loyaltyOnboardingService(\n      $q,\n      $rootScope,\n      $uibModal,\n      auth,\n      config,\n      importIcAccountService,\n      lang,\n      uibModalAriaLabelService,\n      userAnalytics\n    ) {\n      const service = this\n\n      service.hasSeenLoyalty = false\n\n      service.initOnboarding = function (\n        step,\n        singleView,\n        errorMessage,\n        socialSignOnData,\n        context\n      ) {\n        service.hasSeenLoyalty = true\n        // When registrationService.open() is called on the /account/profile page (logged out),\n        // the loading state is never reset. This leaves an empty loading div in the code\n        // Not an issue visually, but this is causing cypress tests to fail because the element exists.\n        $rootScope.isAppLoading = false\n\n        return (\n          $uibModal\n            .open({\n              template,\n              controller: 'LoyaltyOnboardingModalController',\n              keyboard: true,\n              backdrop: 'static',\n              resolve: {\n                ariaLabel: () => {\n                  uibModalAriaLabelService.setLabel(lang.values.welcome)\n                },\n                loyaltyOnboardingStep: () => step,\n                hideRegistration: () => singleView === LOYALTY_ONBOARDING_STEPS.LOGIN,\n                errorMessage: () => errorMessage,\n                socialSignOnData: () => socialSignOnData,\n                context: () => context,\n              },\n            })\n            /**\n             * This modal can be dismissed at the 'registration' step (abandonment)\n             * or at the 'thankyou' step (successfully registered). Dismissal does not\n             * mean we do not show account import modal\n             */\n            .result.catch(step => {\n              // Add analytics for dismissing loyalty onboarding modal\n              if (context === LOGIN_CONTEXTS.LOYALTY_ONBOARDING) {\n                userAnalytics.logUserLoyaltyOnboardingExit({ source: step })\n              }\n\n              return { step, dismissed: true }\n            })\n            .then(({ step, dismissed }) => {\n              // Need to check if the user has successfully registered\n              if (step === LOYALTY_ONBOARDING_STEPS.THANKYOU) {\n                return importIcAccountService.openModal(LOGIN_CONTEXTS.ON_REGISTRATION)\n              }\n\n              // Pass along reject promise so it can be handled by caller for dismiss events\n              if (dismissed) {\n                return Promise.reject(step)\n              }\n            })\n        )\n      }\n    }\n  )\n","import angular from 'angular'\nimport LoyaltyOnboardingService from './loyaltyOnboardingService.js'\n\nexport default angular.module('app.component.loyaltyOnboardingModule', [\n  LoyaltyOnboardingService.name,\n])\n","import angular from 'angular'\nimport { addErrorInterceptor } from '@app/utils/request'\n\nconst MAINTENANCE_MODE_HEADER = 'x-maintenance-mode'\nconst MAINTENANCE_VARIANTS = {\n  maintenance: 'mantenance',\n  siteDown: 'siteDown',\n}\n\nexport default angular\n  .module('MaintenanceComponentModule', [])\n\n  // Route for maintenance view\n\n  .config($stateProvider => {\n    $stateProvider.state('maintenance', {\n      url: '/maintenance',\n      views: {\n        'content@': {\n          template: require('./maintenance.html'),\n        },\n      },\n    })\n  })\n\n  // Intercept errors and redirect to maintenance view\n\n  .run(($rootScope, $state, Restangular, maintenance) => {\n    const showMaintainencePage = variant => {\n      maintenance.setActive()\n      maintenance.setVariant(variant)\n      $rootScope.isAppLoading = false\n      $state.go('maintenance', null, { location: false })\n    }\n\n    const handleError = (status, error, hasMaintenanceHeader) => {\n      // Maintenance mode is active\n      if (hasMaintenanceHeader) {\n        return showMaintainencePage()\n      }\n\n      // User session has been throttled\n      if (status === 503 && error === 50301) {\n        return showMaintainencePage(MAINTENANCE_VARIANTS.siteDown)\n      }\n    }\n\n    // Setup error handler in enterprise-services\n    addErrorInterceptor(response => {\n      response\n        .json()\n        .then(res => {\n          handleError(res.status, res.error, response.headers.has(MAINTENANCE_MODE_HEADER))\n        })\n        .catch(() => {\n          handleError(undefined, undefined, response.headers.has(MAINTENANCE_MODE_HEADER))\n        })\n    })\n\n    // Setup legacy Angular error handler\n    Restangular.setErrorInterceptor(response => {\n      handleError(\n        response.status,\n        response.error,\n        Boolean(response.headers()[MAINTENANCE_MODE_HEADER])\n      )\n    })\n  })\n\n  // Service to keep track of whether we're in maintenance mode or not\n\n  .service('maintenance', function maintenance() {\n    const service = this\n\n    service.active = false\n    service.variant = MAINTENANCE_VARIANTS.maintenance\n\n    service.setActive = () => {\n      service.active = true\n    }\n\n    service.setInactive = () => {\n      service.active = false\n    }\n\n    service.setVariant = variant => {\n      if (variant && MAINTENANCE_VARIANTS[variant]) {\n        service.variant = variant\n      } else {\n        service.variant = MAINTENANCE_VARIANTS.maintenance\n      }\n    }\n  })\n\n  // Controller for the maintenance view\n  .controller('MaintenanceController', function ($scope, maintenance) {\n    $scope.reload = function () {\n      window.location.reload()\n    }\n\n    $scope.variant = maintenance.variant\n  })\n","import angular from 'angular'\nimport MaintenanceComponentModule from './maintenance.js'\n\nexport default angular.module('app.component.maintenanceModule', [MaintenanceComponentModule.name])\n","import angular from 'angular'\nimport debounce from 'lodash/debounce'\nimport { eventEmitter, EVENT_TYPES } from '@app/utils/eventEmitter'\nimport template from './modifyOrderBanner.html'\n\nexport default angular.module('ModifyOrderBannerModule', []).component('modifyOrderBanner', {\n  bindings: {},\n  template,\n  controller(\n    $filter,\n    $q,\n    $rootScope,\n    $scope,\n    $timeout,\n    cartService,\n    reservationService,\n    lang,\n    shoppingContextService,\n    mobileService\n  ) {\n    Object.assign(this, {\n      $filter,\n      $q,\n      $rootScope,\n      $scope,\n      $timeout,\n      cartService,\n      reservationService,\n      lang,\n      mobileService,\n      shoppingContextService,\n    })\n\n    const setShoppingIntentTitle = () => {\n      this.shoppingIntentTitle = shoppingContextService.getShoppingModeTitle()\n    }\n\n    $scope.$watch(() => shoppingContextService.getShoppingModeTitle(), setShoppingIntentTitle)\n\n    // This method gets fired upon each render. Once the renders have settled down (i.e. the UI\n    // has mounted), and if the isTemporaryModifyExpired is set, we cancel the modification\n    this.finishedRender = debounce(() => {\n      if ($rootScope.isTemporaryModifyExpired) {\n        $rootScope.isTemporaryModifyExpired = false // Ensure not called twice\n        cartService.cancelOrderModification()\n      }\n      // This needs to be 1000 ms as values are not initiated within 100 ms and the `cancelOrderModification` is called always preventing us from reaching checkout\n    }, 1000)\n\n    eventEmitter.on(EVENT_TYPES.AUTO_CANCEL_MODIFICATION, () => {\n      this.finishedRender()\n    })\n  },\n})\n","import angular from 'angular'\n\nimport modifyOrderBanner from './modifyOrderBanner'\n\nexport default angular.module('app.component.modifyOrderBannerModule', [modifyOrderBanner.name])\n","import angular from 'angular'\nimport carousel from 'angular-carousel'\n\nexport default angular\n  .module('MobileOnboardingModalControllerModule', ['angular-carousel'])\n  .controller(\n    'MobileOnboardingModalController',\n    function ($scope, $timeout, config, lang, shoppingSelectorService, utilService) {\n      $scope.lang = lang\n      $scope.slides = config.mobileOnboarding.slides\n      $scope.callToActionText = config.mobileOnboarding.callToActionText\n      $scope.modalOpen = true\n      $scope.utilService = utilService\n\n      $scope.callToAction = function () {\n        $scope.modalOpen = false\n\n        $timeout(() => {\n          $scope.$close()\n        }, 150)\n      }\n    }\n  )\n","import angular from 'angular'\nimport dayjs from 'dayjs'\nimport * as storage from '@app/utils/storage'\nimport template from './mobileOnboardingModal.html'\nimport MobileOnboardingModalControllerModule from './mobileOnboardingModalController'\n\nexport default angular\n  .module('MobileOnboardingServiceComponentModule', [MobileOnboardingModalControllerModule.name])\n  // Service to show app onboarding carousel\n\n  .service(\n    'mobileOnboardingService',\n    function mobileOnboardingService(\n      $uibModal,\n      analytics,\n      auth,\n      config,\n      lang,\n      mobileService,\n      uibModalAriaLabelService\n    ) {\n      const service = this\n\n      const storageService = storage.getInstance()\n\n      function setLocalStorage() {\n        // set localstorage to dismiss onboarding\n        service.shouldShowOnboarding().then(showOnboarding => {\n          if (showOnboarding) {\n            storageService.setItem('dismissMobileOnboarding', config.mobileOnboarding.effectiveDate)\n          }\n        })\n      }\n\n      service.openModal = function () {\n        return $uibModal\n          .open({\n            template,\n            controller: 'MobileOnboardingModalController',\n            keyboard: true,\n            backdrop: 'static',\n            resolve: {\n              ariaLabel: () => {\n                uibModalAriaLabelService.setLabel(lang.values.welcome)\n              },\n            },\n          })\n          .result.then(\n            () => {\n              setLocalStorage()\n              analytics.logSegmentEvent('mobile.view_onboarding', {\n                success: true,\n              })\n            },\n            () => {\n              setLocalStorage()\n            }\n          )\n      }\n\n      const userLoggedIn = auth.user && auth.user.status !== 'trial'\n      const isMobileApp = mobileService.isMobileApp() // We only ever show mobile onboarding in the app, not web mobile\n      const isMobileOnboardingEnabled =\n        config.mobileOnboarding && config.mobileOnboarding.slides.length > 0\n      // Checks if onboarding has been set for the retailer,\n      // has not yet been dismissed in Local Storage and if current date is before onboarding expiry.\n      // Also checks that user is not logged in as a fail safe (ENT-29421) as onboarding is for fresh installs only.\n      service.shouldShowOnboarding = async function () {\n        return storageService.getItem('dismissMobileOnboarding').then(storedValue => {\n          if (isMobileApp && !userLoggedIn && isMobileOnboardingEnabled) {\n            if (!storedValue) {\n              const pastEffectiveDate = dayjs().isAfter(config.mobileOnboarding.effectiveDate)\n              return pastEffectiveDate\n            }\n            const shouldViewNewOnboarding = dayjs(storedValue).isBefore(\n              config.mobileOnboarding.effectiveDate\n            )\n            return shouldViewNewOnboarding\n          }\n          return false\n        })\n      }\n    }\n  )\n","import angular from 'angular'\nimport MobileOnboardingService from './mobileOnboardingService.js'\n\nexport default angular.module('app.component.mobileOnboardingModule', [\n  MobileOnboardingService.name,\n])\n","import angular from 'angular'\nimport { categoryNavBarLinksSelector } from '@app/react/components/headerDesktop/bottomRow/selectors'\nimport template from './categoriesMenu.html'\n\nexport default angular.module('UnataCategoriesMenuModule', []).component('unataCategoriesMenu', {\n  template,\n  controller(\n    $ngRedux,\n    $scope,\n    $state,\n    $window,\n    lang,\n    catalogCategoriesService,\n    config,\n    eComLightService,\n    placementsService,\n    utilService\n  ) {\n    const mapStateToService = state => {\n      const {\n        featuredDepartments: featuredMenu = [],\n        merchandisedLandingPages = [],\n        categories,\n      } = categoryNavBarLinksSelector(state)\n      return {\n        featuredMenu,\n        merchandisedLandingPages,\n        categories,\n      }\n    }\n\n    $ngRedux.connect(mapStateToService)(this)\n\n    $scope.webUrl = config.env.webUrl\n    $scope.categoriesMenuAdditionalLinks = config.categoriesMenuAdditionalLinks\n    $scope.enableFeaturedDropdownMenu = config.enableFeaturedDropdownMenu\n    $scope.isFeaturedMenuOpen = false\n    $scope.lang = lang\n    this.util = utilService\n    this.window = $window\n    $scope.toggled = isOpen => {\n      $scope.isFeaturedMenuOpen = isOpen\n    }\n\n    this.isActiveCategory = categoryId =>\n      // eslint-disable-next-line eqeqeq\n      // eslint-disable-next-line eqeqeq\n      categoryId == this.currentCategoryId || categoryId == this.currentParentCategoryId\n\n    this.isNonEComLightCategory = category => {\n      return config.eComLight.enabled ? eComLightService?.isNonEComLightCategory(category) : true\n    }\n\n    const getCategoryParentId = categoryId => {\n      const category = catalogCategoriesService.categoryFromId(categoryId)\n      return category && category.department && category.department.id\n    }\n\n    const updateActiveCategories = () => {\n      if ($state.includes('main.shop.categories')) {\n        this.currentCategoryId = $state.params.category_id\n        this.currentParentCategoryId = getCategoryParentId(this.currentCategoryId)\n      } else {\n        this.currentCategoryId = null\n        this.currentParentCategoryId = null\n      }\n    }\n\n    // TODO: Get rid of this in favour of something like a resolve on the main route and a param supplied to this component\n    // Wait for state changes and recalculate parent so we can apply classname to\n    // parent menu item of current category if needed\n    $scope.$on('$stateChangeSuccess', () => {\n      updateActiveCategories()\n    })\n\n    updateActiveCategories() // On controller init: set active categories\n  },\n})\n","import _ from 'lodash'\nimport angular from 'angular'\nimport { MOBILE_HEADER_CLICKED } from '@app/angular/constants/navigation'\nimport { CHECKOUT_ROUTE_PREFIXES } from '@app/angular/constants/checkout'\n\nexport default angular\n  .module('MobileNavControllerModule', [])\n  .controller(\n    'MobileNavController',\n    function (\n      $document,\n      $rootScope,\n      $scope,\n      $state,\n      auth,\n      cartService,\n      config,\n      mobileNavService,\n      mobileService,\n      utilService\n    ) {\n      $scope.searching = false\n      $scope.cartService = cartService\n      $scope.utilService = utilService\n      $scope.config = config\n      $scope.hideSearch = false\n      $scope.auth = auth\n      $scope.mobileNavService = mobileNavService\n      $scope.mobileService = mobileService\n      $scope.showSearchFromClick = false\n      $scope.useCustomSearchBar =\n        $scope.config.dotComModule.useCustomMobileSearchBar &&\n        !($scope.mobileService.isMobileApp() && $scope.config.forceDefaultHeaderOnMobileApp)\n      $scope.forceDefaultSearchBar =\n        ($scope.mobileService.isMobileApp() && config.forceDefaultMobileSearchOnMobileApp) ||\n        (!$scope.mobileService.isMobileApp() && config.forceDefaultMobileSearchOnMobileWeb)\n      $scope.forceDefaultHeaderOnMobileWeb =\n        !$scope.mobileService.isMobileApp() &&\n        $scope.mobileService.isMobile &&\n        config.forceDefaultHeaderOnMobileWeb\n      $scope.dotComHeaderSyncEnabled =\n        $scope.config.dotComModule.enableHeaderFooterSync && !$scope.headerSyncError\n      $scope.customHeaderIsLoading =\n        ($scope.dotComHeaderSyncEnabled || $scope.dotComHeaderIsLoading) &&\n        $scope.useCustomSearchBar\n\n      if (!$scope.cartService.cart) {\n        cartService.fetch()\n      }\n\n      $scope.$watch('cartService.lastUpdated', (newValue, oldValue) => {\n        if (newValue !== oldValue) {\n          $scope.categorizedProducts = cartService.getAllStoreProductsByCategory()\n        }\n      })\n      $scope.categorizedProducts = cartService.getAllStoreProductsByCategory()\n\n      $scope.goBack = event => {\n        event.preventDefault()\n        event.stopPropagation()\n        if (cartService.isSubstitutionNotesOpen) {\n          cartService.isSubstitutionNotesOpen = false\n          $rootScope.$broadcast('mobileDiscardSubsNotes')\n          // Needed to make the back button follow the checkout flow\n          // and not the browser history\n        } else if ($state.current.url === '/v2/cart') {\n          $state.go('main.home')\n        } else {\n          utilService.goBack()\n        }\n      }\n\n      function setInPageChecks() {\n        $scope.inInstoreListPage = $state.current.name === 'main.inStoreList.review'\n        $scope.inCheckoutCartPage = ['main.checkout.cart', 'main.checkout.cartV2'].includes(\n          $state.current.name\n        )\n        $scope.inCheckoutConfirmationPage = $state.current.name === 'main.checkout.confirmation'\n        $scope.inCheckoutSection = $state.current.name.includes('main.checkout')\n        $scope.inNewCheckoutSection = $state.current.url.includes(CHECKOUT_ROUTE_PREFIXES.V2)\n        $scope.inListOrCartPage = $scope.inInstoreListPage || $scope.inCheckoutCartPage\n        $scope.inDedicatedCheckoutFlow = $scope.inCheckoutSection && !$scope.inCheckoutCartPage\n        $scope.showAltNavBar = $scope.inInstoreListPage || $scope.inCheckoutSection\n        // For all practical purposes this is used to show the search bar\n        // and since the order confirmation page should show the search bar it should not be included here\n        $scope.inCheckoutOrList =\n          ($scope.inListOrCartPage || $scope.inCheckoutSection) &&\n          !$scope.inCheckoutConfirmationPage\n      }\n      $scope.$on('$stateChangeSuccess', () => {\n        setInPageChecks()\n        $scope.hideSearch = $scope.inCheckoutOrList\n        $scope.showSearchFromClick = false\n      })\n      setInPageChecks()\n\n      $scope.$on('$stateChangeStart', () => {\n        $scope.setSearchingTo(false)\n        $scope.hideSearch = false\n      })\n\n      $scope.$watch('hideSearch', () => $scope.$broadcast('hideSearch', $scope.hideSearch))\n\n      // TODO: MOVE THIS STUFF TO A MOBILE NAV DIRECTIVE\n      // Hide search on scroll\n      const mobileNavSearchBarFunctionality = _.throttle(() => {\n        $scope.$apply(() => {\n          const el = document.querySelector('[ui-view=\"content\"]')\n          if (el.scrollTop >= 60 && !$scope.searching) {\n            $scope.hideSearch = true\n            if (!$scope.inListOrCartPage) {\n              $scope.hideLoyaltyCard = true\n            }\n          } else if ($scope.searching && !$scope.inListOrCartPage) {\n            $scope.hideLoyaltyCard = true\n          } else {\n            $scope.hideSearch = false\n            $scope.hideLoyaltyCard = false\n          }\n        })\n      }, 100)\n\n      $scope.setSearchingTo = newValue => {\n        $scope.searching = newValue\n      }\n\n      $scope.focusSearch = function () {\n        if (!$scope.searching) {\n          const mobileNavEle = document.getElementsByClassName('mobile-nav')[0]\n          if (mobileNavEle) {\n            utilService.trapFocusOn(mobileNavEle)\n          }\n          $scope.focusSearchBar = true\n          $scope.searching = true\n          $scope.hideSearch = false\n          if ($scope.inListOrCartPage) {\n            $scope.showSearchFromClick = true\n          }\n        } else {\n          $scope.hideSearch = $scope.inCheckoutOrList\n          $scope.showSearchFromClick = false\n          $scope.searching = false\n          $scope.focusSearchBar = false\n        }\n      }\n\n      $scope.isCloseButtonVisible = () => {\n        return $scope.inCheckoutConfirmationPage && !utilService.isMobileDotComHeaderPresent()\n      }\n\n      $scope.showSearchBar = () => {\n        return (\n          (!$scope.inCheckoutOrList || $scope.showSearchFromClick) &&\n          ($scope.forceDefaultSearchBar || !$scope.customHeaderIsLoading)\n        )\n      }\n\n      $scope.mobileNavHeaderClick = () => {\n        $rootScope.$broadcast(MOBILE_HEADER_CLICKED)\n      }\n\n      const handleAngularElementScroll = () => {\n        angular\n          .element(document.querySelector('[ui-view=\"content\"]'))\n          .on('scroll', mobileNavSearchBarFunctionality)\n      }\n\n      $rootScope.$on('searchProcessingComplete', () => {\n        if (config.autoHideMobileSearchBarOnScroll) {\n          handleAngularElementScroll()\n        }\n      })\n\n      // Set event listeners to show hide/nav search on scroll\n      if (config.autoHideMobileSearchBarOnScroll) {\n        $document.on('touchmove', mobileNavSearchBarFunctionality)\n        $document.on('wheel', mobileNavSearchBarFunctionality)\n        handleAngularElementScroll()\n        $rootScope.$on('scrollPositionChanged', mobileNavSearchBarFunctionality)\n      }\n    }\n  )\n","export const MOBILE_HEADER_CLICKED = 'MOBILE_HEADER_CLICKED'\n","import angular from 'angular'\n\nexport default angular\n  .module('UnataNavCartModule', [])\n  .component('unataNavCart', {\n    controller($rootScope, $scope, $state, auth, mobileService, cartService, sideCartService) {\n      this.isMobile = mobileService.isMobile\n      this.goToNextStep = sideCartService.goToNextStep\n    },\n    template: `\n      <react-cart-button\n        ng-if=\":: !$ctrl.isMobile\"\n        analytics-click=\"['nav cart checkout button', 'click']\"\n        on-click=\"$ctrl.goToNextStep\"\n      >\n      </react-cart-button>\n\n      <react-cart-icon-button\n        ng-if=\":: $ctrl.isMobile\"\n        on-click=\"$ctrl.goToNextStep\"\n      ></react-cart-icon-button>\n    `,\n  })\n  .component('unataCartTotalLabel', {\n    controller(cartService) {\n      this.isCartEmpty = () => !cartService.cart\n      this.getCartTotal = () =>\n        !this.isCartEmpty() ? cartService.getCartTotalForCurrentType() : null\n      this.isCartSyncing = () => cartService.syncing\n    },\n    bindings: {\n      labelId: '@',\n    },\n    template: `\n      <span id=\"{{::$ctrl.labelId || 'cart-button-total-amount'}}\" class=\"total\" ng-if=\"!$ctrl.isCartSyncing()\">{{$ctrl.getCartTotal() | currency}}</span>\n      <loading-dots show=\"$ctrl.isCartSyncing() || $ctrl.isCartEmpty()\"></loading-dots>`,\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('NavCartControllerModule', [])\n  .controller(\n    'NavCartController',\n    function ($document, $element, $scope, $state, auth, cartService, config, reservationService) {\n      $scope.auth = auth\n      $scope.cartService = cartService\n      $scope.config = config\n      $scope.reservationService = reservationService\n    }\n  )\n","import angular from 'angular'\nimport { DEFAULT_TIMESLOT_DATE_FORMAT } from '@app/angular/constants/timeslots'\nimport { imageTransform, utils } from '@instacart/enterprise-services'\nimport { utils as timeslotUtils } from '@instacart/enterprise-timeslots'\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\nimport { eventEmitter, EVENT_TYPES } from '@app/utils/eventEmitter'\n\nconst ACKNOWLEDGED_HEADER_BANNERS = 'acknowledgedHeaderBanners'\n\nexport default angular\n  .module('NavControllerModule', [])\n  .controller(\n    'NavController',\n    function (\n      $rootScope,\n      $scope,\n      $state,\n      $timeout,\n      $window,\n      analytics,\n      auth,\n      cartService,\n      config,\n      eComLightService,\n      fulfillmentNotAvailableModalService,\n      headerFooterSyncService,\n      lang,\n      localStorageService,\n      loyaltyInfoService,\n      loyaltyOnboardingService,\n      mobileService,\n      placementsService,\n      registrationService,\n      reservationService,\n      shoppingContextService,\n      shoppingSelectorService,\n      toggleEComLightService,\n      userService,\n      utilService\n    ) {\n      $scope.utilService = utilService\n      $scope.auth = auth\n      $scope.cartService = cartService\n      $scope.shoppingContextService = shoppingContextService\n      $scope.config = config\n      $scope.registrationService = registrationService\n      $scope.shoppingSelectorService = shoppingSelectorService\n      $scope.headerFooterSyncService = headerFooterSyncService\n      $scope.state = $state\n      $scope.reservationService = reservationService\n      $scope.imageTransform = imageTransform\n      $scope.hideSlidingLogo = false\n      $scope.showHidingLogo = false\n      $scope.searchTerm =\n        $state.params && $state.params.search_term ? $state.params.search_term : ''\n\n      $scope.inEComLightMode = eComLightService.inEComLightMode\n      $scope.toggleEComLightMode = toggleEComLightService.toggleEComLightMode\n\n      $scope.enableToggleEcomLightMode =\n        config.shoppingSelector[SHOPPING_MODES.CATERING].exists &&\n        (config.shoppingSelector[SHOPPING_MODES.INSTORE_LIST].exists ||\n          config.shoppingSelector[SHOPPING_MODES.PICKUP].exists)\n\n      $scope.eComLightModeToggleText =\n        $scope.inEComLightMode && config.shoppingSelector[SHOPPING_MODES.INSTORE_LIST].exists\n          ? config.eComLight.headerLinkFrom\n          : $scope.inEComLightMode && config.shoppingSelector[SHOPPING_MODES.PICKUP].exists\n          ? config.eComLight.headerLinkPickup\n          : config.eComLight.headerLinkTo\n\n      $scope.ecomLightModeToggleIcon = eComLightService.eComLightLinkIcon\n      $scope.afterHeaderLoaded = headerFooterSyncService.afterHeaderLoaded\n      $scope.stickyNavLogo = utilService.loadAssetImage(config.stickyNavLogoPath)\n      $scope.privateMode = utils.isPrivateMode()\n      $scope.privateModeMessage = lang.template(lang.values.privateModeMessage, {\n        customerName: auth.user.first_name,\n      })\n\n      const reactHeaderEnabled = mobileService.isMobile\n        ? config.react?.enableMobileHeader\n        : config.react?.enableHeader\n      $scope.useAngularHeader = !(reactHeaderEnabled || $rootScope.isReactDemo())\n\n      $scope.openLoyalty = function () {\n        if (process.env.UNATA_WIDGETS) {\n          $window.open(`${config.env.webUrl}/account/loyalty`, '_blank')\n          return\n        }\n        if (userService.loyaltyCards.length >= 1) {\n          $state.go('main.account.loyalty')\n        } else if (config.enableLoyaltyOnboarding) {\n          loyaltyOnboardingService.initOnboarding('intro')\n        } else {\n          loyaltyInfoService.open()\n        }\n      }\n\n      eventEmitter.on(EVENT_TYPES.OPEN_LOYALTY_CONTEXT, $scope.openLoyalty)\n\n      $scope.$on('$destroy', () => {\n        eventEmitter.off(EVENT_TYPES.OPEN_LOYALTY_CONTEXT, $scope.openLoyalty)\n      })\n\n      $scope.showCheckoutButton = () => {\n        return !['main.checkout.cart', 'main.checkout.cartV2', 'main.inStoreList.review'].includes(\n          $state.current.name\n        )\n      }\n\n      //\n      // Header Banner\n      //\n      let headerBanners = []\n      placementsService.getHeaderBanners().then(headerBannersResponse => {\n        // Add a UI URL to collection targets\n        headerBannersResponse.forEach(banner => {\n          if (banner.target?.type === 'collection') {\n            banner.target.url = $state.href('main.shop.collection', {\n              collection_id: banner.target.collection.id,\n            })\n          }\n        })\n\n        $scope.logPromotedPlacement = placementsService.logPromotedPlacement\n\n        function hasShowableBanners() {\n          if (config.react.enableHeaderBanner) {\n            return false\n          }\n\n          return headerBanners.filter(banner => banner.media.text || banner.media.image).length > 0\n        }\n\n        function acknowledgeHeaderBanner(banner, shouldAcknowledge = true) {\n          if (shouldAcknowledge) {\n            const acknowledgedHeaderBanners =\n              localStorageService.deprecatedGet(ACKNOWLEDGED_HEADER_BANNERS) || []\n            acknowledgedHeaderBanners.push(banner.id)\n            localStorageService.deprecatedSet(\n              ACKNOWLEDGED_HEADER_BANNERS,\n              acknowledgedHeaderBanners\n            )\n            updateBanners()\n          }\n        }\n\n        function updateBanners() {\n          const acknowledged = localStorageService.deprecatedGet(ACKNOWLEDGED_HEADER_BANNERS) || []\n          headerBanners = headerBannersResponse.filter(banner => !acknowledged.includes(banner.id))\n\n          // FIXME: This is a brutal hack for header banner positioning, we really need to add a root container\n          // div to the index page so that all of these ui-view containers & heights can follow the natural DOM\n          // flow rather than the siblings under a <body> tag relationship they have right now.\n          const bannerParams = { headerBanners, hasShowableBanners, acknowledgeHeaderBanner }\n          Object.assign($scope, bannerParams)\n          Object.assign($rootScope, bannerParams)\n\n          $timeout(() => $scope.$apply()) // $timeout ensures that this isn't called while a digest is in progress\n\n          analytics.logPlacementImpression(headerBanners.slice(0, 1), 'homepage', 'header_banner')\n        }\n\n        updateBanners()\n\n        $scope.bannerTarget = (target = {}) => {\n          return target.openIn === 'new_tab' ? '_blank' : undefined\n        }\n\n        // Call template for header sync and when using angular header instead of react\n        if (config.dotComModule.enableHeaderFooterSync && $scope.useAngularHeader) {\n          $scope.dotComHeaderIsLoading = true\n          $scope.headerFooterSyncService\n            .fetchHeader()\n            .then(html => {\n              $scope.dotComHeader = html\n              $scope.headerSyncError = false\n            })\n            .catch(() => {\n              $scope.headerSyncError = true\n            })\n            .finally(() => {\n              $scope.dotComHeaderIsLoading = false\n            })\n        }\n\n        $scope.timeslotLabelFn = () =>\n          timeslotUtils.getMainLabel($scope.reservationService.displayReservation, {\n            verboseLevel: 1,\n            format: reservationService.reservation\n              ? config.apiDateFormat\n              : DEFAULT_TIMESLOT_DATE_FORMAT,\n          })\n      })\n    }\n  )\n  .run($templateCache => {\n    $templateCache.put('nav.desktop.html', require('./views/nav.desktop.html'))\n    $templateCache.put('nav.mobile.html', require('./views/nav.mobile.html'))\n    $templateCache.put('sideNav.html', require('./views/sideNav.html'))\n  })\n","import _ from 'lodash'\nimport angular from 'angular'\nimport urlParser from '@app/utils/urlParser'\n\nconst DEFAULT_SEARCH_ROUTE = 'main.search'\nconst ORDER_ADDON_ROUTE = 'orderAddOn'\nconst ORDER_ITEM_APPEND_ROUTE = 'main.account.orderHistory.order.edit.append'\nconst RECIPES_SEARCH_ROUTE = 'main.search.recipes'\nconst CONTENT_SEARCH_ROUTE = 'main.search.types'\n\nconst SEARCH_ROUTES = {\n  default: DEFAULT_SEARCH_ROUTE,\n  order_add_on: ORDER_ADDON_ROUTE,\n  order_item_append: ORDER_ITEM_APPEND_ROUTE,\n  recipes: RECIPES_SEARCH_ROUTE,\n  content: CONTENT_SEARCH_ROUTE,\n}\n\nexport default angular\n  .module('UnataSearchNavModule', [])\n  .component('unataSearchNav', {\n    bindings: {\n      isSearching: '<?',\n      focusSearchBar: '<?', // parent may instruct to focus the search input by setting focusSearchBar to true\n      focusInitially: '<?', // parent may initially focus the search input by setting focusInitially to true\n      setSearchingTo: '&?',\n      searchTerm: '<?',\n      liteMode: '<?',\n    },\n    controller(\n      $location,\n      $q,\n      $rootScope,\n      $state,\n      $timeout,\n      $window,\n      analytics,\n      config,\n      eComLightService,\n      lang,\n      mobileService,\n      Restangular,\n      searchService\n    ) {\n      const vm = this\n\n      vm.config = config\n      vm.isMobile = mobileService.isMobile\n      vm.lang = lang\n      vm.searchFieldType = mobileService.isMobile ? 'input' : 'search'\n      vm.typeaheadWaitTime = 400\n      vm.resultsVoiceOver = ''\n\n      // TODO: Remove this <strong> removal function and its usage in vm.autocomplete once the\n      //  back end stops sending us <strong> tags in the product autocomplete suggestions\n      const removeStrongTags = (searchTerm = '') =>\n        searchTerm && searchTerm.replace(/<strong>/g, '').replace(/<\\/strong>/g, '')\n\n      vm.autocomplete = () => {\n        // Clear autocompleteResults to ensure we don't accidentally send users to old results if they execute a\n        //  search before the call to `/autocomplete` has a chance to return\n        vm.autocompleteResults = []\n\n        if (!vm.transitioningToSearchResult) {\n          return Restangular.oneUrl('autocomplete')\n            .get({ search_term: vm.searchTerm })\n            .then(results => {\n              const redirectResults = results.redirects\n              const productResults = results.product_autocompletes\n\n              if (redirectResults && productResults) {\n                // The back end returns a list of search redirects (any page),\n                //  as well as a list of normal autocomplete search suggestions (for products).\n                // Here we handle both of these lists and append them together in such a way as to\n                //  display them correctly in the autocomplete dropdown (ui-typeahead)\n                let convertedRedirectSuggestions = []\n\n                if (!vm.liteMode) {\n                  convertedRedirectSuggestions = _.map(\n                    redirectResults,\n                    (redirectSuggestion, index) => ({\n                      // `label` will be accessible as `match.label` in the ui-typeahead templates\n                      label: redirectSuggestion.redirect_name,\n                      // the following params will be accessible inside `match.model` in the ui-typeahead templates\n                      isRedirect: true,\n                      isLastRedirect: index === redirectResults.length - 1,\n                      redirectCategory: redirectSuggestion.redirect_category,\n                      redirectIsExternal: redirectSuggestion.is_external_url,\n                      redirectUrl: redirectSuggestion.url,\n                    })\n                  )\n                }\n\n                const convertedProductSuggestions = _.map(productResults, productSuggestion => ({\n                  // `label` will be accessible as `match.label` in the ui-typeahead templates\n                  label: removeStrongTags(productSuggestion),\n                  // the following params will be accessible inside `match.model` in the ui-typeahead templates\n                  isRedirect: false,\n                }))\n\n                const resultsAvailable = productResults.length\n                const contextSuggestionLabel = removeStrongTags(productResults[0])\n\n                const contextSuggestionRecipes = {\n                  label: contextSuggestionLabel,\n                  isRedirect: false,\n                  context: 'recipes',\n                }\n\n                const contextSuggestionContent = {\n                  label: contextSuggestionLabel,\n                  isRedirect: false,\n                  context: 'content',\n                }\n\n                if (convertedRedirectSuggestions.length + convertedProductSuggestions.length > 0) {\n                  const contextSuggestions =\n                    resultsAvailable && !vm.liteMode\n                      ? [\n                          ...(searchService.isRecipesEnabled() ? [contextSuggestionRecipes] : []),\n                          ...(searchService.isDotComEnabled() ? [contextSuggestionContent] : []),\n                        ]\n                      : []\n\n                  const newProducts = injectContextResults(\n                    convertedProductSuggestions,\n                    contextSuggestions\n                  )\n\n                  vm.autocompleteResults = [...convertedRedirectSuggestions, ...newProducts]\n                }\n\n                vm.resultsVoiceOver = `${vm.autocompleteResults.length} results available`\n\n                return vm.autocompleteResults\n              }\n              $q.reject()\n            })\n            .catch(() => [])\n        }\n      }\n\n      const injectContextResults = (products, contextResults) => {\n        // inject the context results after the first matched product result\n        const productsClone = angular.copy(products)\n        productsClone.splice(1, 0, ...contextResults)\n        return productsClone\n      }\n\n      const getRoutes = searchRoutes => {\n        // eslint-disable-next-line no-restricted-syntax\n        for (const key in searchRoutes) {\n          if (searchRoutes[key] === $state.current.name) {\n            return searchRoutes[key]\n          }\n        }\n      }\n\n      const sendToSearch = {\n        page: ({ label, context, isAutocomplete }) => {\n          const destinationState =\n            SEARCH_ROUTES[context] || getRoutes(SEARCH_ROUTES) || DEFAULT_SEARCH_ROUTE\n          return $state.go(destinationState, {\n            search_term: label,\n            search_is_autocomplete: isAutocomplete || null,\n            tags: null,\n            page: null,\n            category_id:\n              (eComLightService.inEComLightMode && eComLightService.eComLightCategory) || null,\n            brand_name: null,\n            brand_names: null,\n            sort: null,\n          })\n        },\n        redirect: ({ redirectIsExternal, redirectUrl }) => {\n          if (redirectIsExternal) {\n            const redirectHasProtocol = redirectUrl.indexOf('http') === 0\n            // Handle the case where an external link is provided without a protocol,\n            //  otherwise the user is redirected to `<current url> + redirectUrl` in the new tab\n            $window.open(`${!redirectHasProtocol ? 'http://' : ''}${redirectUrl}`, '_blank')\n          } else {\n            // Redirect is claimed to be internal\n\n            const isMobileApp = mobileService.isMobileApp()\n            const parsedRedirectUrl = urlParser(redirectUrl)\n            // Use url specified at build time if it's cordova\n            const currentHostname = isMobileApp\n              ? urlParser(vm.config.env.webUrl).host\n              : $location.host()\n\n            if (currentHostname && currentHostname === parsedRedirectUrl.hostname) {\n              // If the redirect is indeed to an internal page, redirect to it with $location.url\n              $location.url(`${parsedRedirectUrl.pathname}${parsedRedirectUrl.search}`) // Does not reload the site\n            } else {\n              // If the redirect is in fact to an external page (but not set as external)\n              // Load the redirect in the same tab or system browser if cordova\n              $window.open(redirectUrl, isMobileApp ? '_system' : '_self')\n            }\n          }\n\n          return $q.resolve()\n        },\n      }\n\n      /**\n       * Handles when the user tries to perform a search, either by submitting\n       * the search input or by selecting an option in the typeahead menu.\n       * @param {Object} searchDestinationData An object containing the typeahead label, context, and whether it's a redirect\n       * @param {string} source The source of the search submit being triggered\n       */\n      const processSearchSubmit = (searchDestinationData, source = 'navigation') => {\n        const isAutocomplete = source === 'autocomplete'\n        const { label, isRedirect, context } = searchDestinationData\n        searchDestinationData.isAutocomplete = isAutocomplete\n        const sendToSearchMethod = isRedirect ? 'redirect' : 'page'\n        const search_request_id = searchService.startNewSearchSession()\n\n        let search_source = source\n        if (context) {\n          search_source = `${search_source}_${context}`\n        }\n\n        analytics.logEvent('nav search', 'submit', label)\n        analytics.logSegmentEvent('search.search', {\n          is_autocomplete: isAutocomplete,\n          search_value: label,\n          search_source,\n          snrid: search_request_id,\n          is_search_redirect: isRedirect,\n          search_redirect_data: isRedirect\n            ? {\n                search_redirect_name: label,\n                search_redirect_category: searchDestinationData.redirectCategory,\n                search_redirect_is_external: searchDestinationData.redirectIsExternal,\n                search_redirect_url: searchDestinationData.redirectUrl,\n              }\n            : null,\n        })\n        sendToSearch[sendToSearchMethod](searchDestinationData).finally(() => {\n          $rootScope.$broadcast('searchProcessingComplete')\n          vm.transitioningToSearchResult = false\n          document.activeElement.blur() // hide the keypad\n\n          if (vm.isMobile) {\n            const autoCompleteContainer = document.querySelector('.search-results-menu')\n            const autoCompleteContainerExists = document.body.contains(autoCompleteContainer)\n            if (autoCompleteContainerExists && vm.typeahead_popupOpen) {\n              document.querySelector('#react').click()\n            }\n          }\n        })\n      }\n\n      vm.search = ($model, $label, source) => {\n        if ((!$model && vm.searchTerm.length > 0) || $model) {\n          vm.transitioningToSearchResult = true // will blur the input because of ng-disabled\n\n          // Because ui-typeahead waits 400ms before calling `vm.autocomplete` which searches for new autocomplete results (and\n          //  clears the existing autocomplete results), we have to make sure the last associated call to that function was executed\n          //  before determining where to send the user on search.\n          // (Unfortunately the directive does not give us a way to know when it is waiting/debouncing the user's input, it only\n          //  allows us to detect when it is actually autocompleting)\n          setTimeout(() => {\n            if (!$model) {\n              // User entered in a search query and pressed enter\n\n              const firstDropdownResult = vm.autocompleteResults && vm.autocompleteResults[0]\n              if (\n                config.searchNavEnableFirstRedirectOnEnter &&\n                firstDropdownResult &&\n                firstDropdownResult.isRedirect\n              ) {\n                // If config.searchNavEnableFirstRedirectOnEnter is true, and there's a redirect showing in the dropdown,\n                //  send the user to that redirect\n                processSearchSubmit(firstDropdownResult, source)\n              } else {\n                // Otherwise, send them to the search page with vm.searchTerm as the search_term param\n                processSearchSubmit(\n                  {\n                    label: vm.searchTerm,\n                    isRedirect: false,\n                  },\n                  source\n                )\n              }\n            } else {\n              // User explicitly selected a dropdown search result (with keyboard or mouse)\n              processSearchSubmit($model, source)\n            }\n          }, vm.typeaheadWaitTime)\n        }\n      }\n\n      vm.clearSearch = keepFocus => {\n        if (vm.isMobile && vm.searchTerm && vm.searchTerm.length && !keepFocus) {\n          vm.setSearchingTo({ newValue: false })\n        }\n        vm.searchTerm = ''\n        vm.focusSearchBar = false\n\n        if (vm.isMobile && keepFocus) {\n          vm.focusSearchBar = true\n          $timeout(() => {\n            vm.focusSearchBar = false\n          })\n        }\n      }\n\n      vm.onBlur = blurEvent => {\n        if (vm.isMobile) {\n          const searchContainer = document.querySelector('.mobile-search-bar')\n          const blurTargetIsSearch = !!(\n            blurEvent &&\n            blurEvent.relatedTarget &&\n            searchContainer.contains &&\n            searchContainer.contains(blurEvent.relatedTarget)\n          )\n\n          if (blurEvent.relatedTarget !== null && !blurTargetIsSearch) {\n            // If the next target for blur event is not within the search module,\n            // set isSearching to false to hide the search overlay. This would not otherwise\n            // happen for keyboard users who e.g. tab away from search input.\n            vm.setSearchingTo({ newValue: false })\n          }\n        }\n        vm.isInFocus = false\n      }\n\n      vm.onFocus = () => {\n        if (vm.isMobile) {\n          // eslint-disable-next-line no-unused-expressions\n          vm?.setSearchingTo({ newValue: true })\n        }\n        vm.isInFocus = true\n      }\n    },\n    // type=\"search\" doesn't show the 'X' to clear the input on iOS.\n    // https://stackoverflow.com/questions/35583503/input-type-search-no-longer-shows-cancel-button-x-under-ios\n    template: `\n      <div class=\"search-nav\" ng-class=\"{searching: $ctrl.isSearching, 'lite-mode': $ctrl.liteMode}\">\n        <form\n          ng-submit=\"$ctrl.search(null, null, 'navigation')\"\n          ng-class=\":: {'button-right': !$ctrl.isMobile}\"\n         >\n          <span\n            class=\"screen-reader-text\"\n            id=\"search-nav-input-screen-reader-description\"\n            aria-hidden=\"{{!$ctrl.isInFocus}}\"\n          >\n            <span ng-if=\"$ctrl.isMobile\">{{::$ctrl.lang.values.searchScreenReaderDescriptionMobile}}</span>\n            <span ng-if=\"!$ctrl.isMobile\">{{::$ctrl.lang.values.searchScreenReaderDescriptionDesktop}}</span>\n          </span>\n          <span>\n            <input id=\"search-nav-input\"\n              data-test=\"search-nav-input\"\n              class=\"input\"\n              name=\"search\"\n              ng-attr-type=\"{{$ctrl.searchFieldType}}\"\n              ng-class=\":: {'mobile-search-bar-input': $ctrl.isMobile}\"\n              ng-blur=\"$ctrl.onBlur($event)\"\n              ng-focus=\"$ctrl.onFocus()\"\n              ng-model=\"$ctrl.searchTerm\"\n              ng-disabled=\"$ctrl.transitioningToSearchResult\"\n              placeholder=\"{{::$ctrl.lang.values.searchPlaceholder}}\"\n              aria-label=\"{{::$ctrl.lang.values.searchPlaceholder}}\"\n              autocomplete=\"off\"\n              aria-autocomplete=\"list\"\n              aria-describedby=\"search-nav-input-screen-reader-description\"\n              aria-expanded=\"$ctrl.typeahead_popupOpen\"\n              aria-controls=\"typeahead-search-results-list\"\n              aria-haspopup=\"listbox\"\n              aria-multiline=\"false\"\n              uib-typeahead=\"searchResult as searchResult.label for searchResult in $ctrl.autocomplete()\"\n              typeahead-accessibility\n              typeahead-is-open=\"$ctrl.typeahead_popupOpen\"\n              typeahead-min-length=\"3\"\n              typeahead-wait-ms=\"::$ctrl.typeaheadWaitTime\"\n              typeahead-on-select=\"$ctrl.search($model, $label, 'autocomplete')\"\n              typeahead-focus-first=\"false\"\n              typeahead-focus-on-select=\"false\"\n              typeahead-popup-template-url=\"typeahead-popup-template.html\"\n              typeahead-template-url=\"typeahead-match-modified-uibootstrap.html\"\n              search-dom-handling\n              clear-search=\"$ctrl.clearSearch()\"\n              focus-when=\"$ctrl.focusSearchBar\"\n              focus-initially=\"$ctrl.focusInitially\"\n            />\n          </span>\n\n          <span class=\"screen-reader-text\" aria-live=\"assertive\">{{$ctrl.resultsVoiceOver}}</span>\n\n          <span ng-if=\":: !$ctrl.isMobile || $ctrl.liteMode\">\n            <button id=\"search-nav-search\" class=\"search-control-button search-nav-search\" data-test=\"search-nav-search\" aria-label=\"{{::$ctrl.lang.aria.search}}\">\n              <span class=\"icon-search\" aria-hidden=\"true\"></span>\n            </button>\n          </span>\n\n          <span ng-if=\"::$ctrl.isMobile\" class=\"search-nav-icon-container\">\n            <span role=\"button\" ng-show=\"!$ctrl.liteMode\" class=\"search-control-button search-nav-clear\" ng-click=\"$ctrl.search(null, null, 'navigation')\" aria-label=\"Submit Search\" id=\"search-nav-clear\">\n              <span class=\"icon-search\" aria-hidden=\"true\"></span>\n            </span>\n            <span role=\"button\" ng-show=\"$ctrl.searchTerm\" ng-click=\"$ctrl.clearSearch(true)\" class=\"search-control-button search-nav-clear-delete\" data-test=\"search-nav-clear-delete\" aria-label=\"Clear Search\" id=\"search-nav-clear-delete\">\n              <span class=\"icon-delete\" aria-hidden=\"true\"></span>\n            </span>\n            <span role=\"button\" ng-if=\"::$ctrl.config.enableBarcodeScanner\" id=\"search-nav-barcode-scanner\" aria-label=\"Scan Barcode\" barcode-scanner-button>\n              <span class=\"icon-scanner\" aria-hidden=\"true\"></span>\n            </span>\n          </span>\n\n        </form>\n      </div>\n    `,\n  })\n\n  .directive('searchDomHandling', function ($timeout, mobileService) {\n    return {\n      restrict: 'A',\n      scope: {\n        focusWhen: '<?',\n        focusInitially: '<?',\n        clearSearch: '&',\n      },\n      link($scope, $element, $attrs) {\n        const searchInput = $element[0]\n        // In mobile the parent might trigger a focus on the search input\n        if (mobileService.isMobile && $attrs.focusWhen) {\n          if ($scope.focusWhen) {\n            $timeout(() => {\n              searchInput.focus()\n            })\n          }\n\n          $scope.$watch('focusWhen', (newVal, oldVal) => {\n            if (newVal !== oldVal && newVal) {\n              $timeout(() => searchInput.focus())\n            }\n          })\n        }\n\n        if ($attrs.focusInitially) {\n          const unbind = $scope.$watch('focusInitially', newVal => {\n            if (newVal) $timeout(() => searchInput.focus())\n            unbind()\n          })\n        }\n\n        // Search input needs to be blurred after search fires and cleared when new page is not search results\n        $scope.$on('$stateChangeSuccess', (_event, toState) => {\n          // If new page is not a search route, clear search input\n          if (!Object.values(SEARCH_ROUTES).includes(toState.name)) {\n            $scope.clearSearch()\n          }\n        })\n      },\n    }\n  })\n  .run($templateCache => {\n    $templateCache.put(\n      'typeahead-popup-template.html',\n      require('../shared/typeahead/typeahead-popup-template.html')\n    )\n    $templateCache.put(\n      'typeahead-match-modified-uibootstrap.html',\n      require('../shared/typeahead/typeahead-match-modified-uibootstrap.html')\n    )\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('UnataShoppingContextIconModule', [])\n  .component('unataShoppingContextIcon', {\n    controller($scope) {\n      Object.assign($scope, { size: 'large' })\n    },\n    template: `\n      <react-cart-icon-button size=\"size\"></react-cart-icon-button>\n    `,\n  })\n","import angular from 'angular'\nimport { DEFAULT_TIMESLOT_DATE_FORMAT } from '@app/angular/constants/timeslots'\nimport { utils as timeslotUtils } from '@instacart/enterprise-timeslots'\nimport { multiShoppingContextsAvailableSelector } from '@app/services/shoppingContext/selectors'\nimport {\n  ctxSubTitleSelector,\n  isCtxChangeDisabledSelector,\n  mobileShoppingModeTitleSelector,\n} from '@app/react/components/contextSelector/selectors'\nimport template from './views/shoppingSelectorNav.html'\n\nexport default angular\n  .module('UnataShoppingSelectorNavModule', [])\n  .component('unataShoppingSelectorNav', {\n    controller(\n      $ngRedux,\n      analytics,\n      auth,\n      catalogCategoriesService,\n      config,\n      contextSelectorButtonService,\n      lang,\n      mobileService,\n      reservationService,\n      shoppingContextService,\n      shoppingSelectorService,\n      uibModalAriaLabelService,\n      utilService,\n      $state,\n      $rootScope,\n      $scope\n    ) {\n      this.auth = auth\n      this.config = config\n      this.isMobile = mobileService.isMobile\n      this.lang = lang\n      this.reservationService = reservationService\n      this.$state = $state\n      this.utilService = utilService\n      this.searchIconVisible = false\n\n      this.triageSelectorButtonClicks = contextSelectorButtonService.triageSelectorButtonClicks\n      this.openMobileContextSelector = contextSelectorButtonService.openMobileContextSelector\n\n      const mapStateToService = state => ({\n        multiShoppingContextsAvailable: multiShoppingContextsAvailableSelector(state),\n      })\n      $ngRedux.connect(mapStateToService)(this)\n\n      this.shoppingModeTitle = mobileShoppingModeTitleSelector.resultFunc(\n        this.config,\n        this.auth.user\n      )\n      this.isDropdownDisabled = isCtxChangeDisabledSelector.resultFunc(\n        this.multiShoppingContextsAvailable,\n        this.auth.user\n      )\n      this.subTitle = ctxSubTitleSelector.resultFunc(this.config, this.lang.values, this.auth.user)\n\n      this.loadImg = image => {\n        return require(`assets/images/${image}`)\n      }\n\n      /**\n       * We are generating the content for the react reservation/timeslot button here to simplify\n       * the interface for the react context selector.\n       * TODO When an enterprise-services reservation service has been created, it will probably make\n       * sense to pull the reservation service directly into the react context selector component and\n       * move this logic inside of the component.\n       */\n      const generateReservationTimeslotContent = () => {\n        const content = {\n          prependText: '',\n          bodyText: '',\n        }\n\n        content.bodyText = String(\n          timeslotUtils.getMainLabel(this.reservationService.displayReservation, {\n            verboseLevel: 0,\n            returnLabel: false,\n            format: this.reservationService.reservation\n              ? this.config.apiDateFormat\n              : DEFAULT_TIMESLOT_DATE_FORMAT,\n          })\n        )\n\n        content.prependText = this.reservationService.previewTimeslot\n          ? this.lang.values.timeslotAvailable\n          : this.lang.values.on\n        this.reservationTimeslotContent = content\n      }\n\n      // Generate the reservation timeslot content every time the Angular component loads.\n      generateReservationTimeslotContent()\n\n      // Regenerate the reservation timeslot content whenever displayReservation or previewTimeslot has been changed.\n      $scope.$watch(\n        () => {\n          return this.reservationService.displayReservation\n        },\n        () => {\n          generateReservationTimeslotContent()\n        }\n      )\n\n      $scope.$watch(\n        () => {\n          return this.reservationService.previewTimeslot\n        },\n        () => {\n          generateReservationTimeslotContent()\n        }\n      )\n\n      // Property for disabling the react context selector when Instacart/Unata Order is being modified.\n      $scope.$watch(\n        () => $rootScope.modifyingInstacartOrder || $rootScope.modifyingOrder,\n        () => {\n          this.disableContextSelector =\n            $rootScope.modifyingInstacartOrder || $rootScope.modifyingOrder\n        }\n      )\n\n      $scope.$on('hideSearch', (event, hideSearch) => {\n        this.searchIconVisible = hideSearch\n      })\n    },\n\n    template,\n\n    controllerAs: '$ctrl',\n  })\n","import angular from 'angular'\nimport Hammer from 'hammerjs'\nimport { IC_PLACEMENTS } from '@app/angular/constants/express'\nimport { hasBannerImage } from '@app/utils/banners'\nimport { isReactDemo } from '@app/utils/isReactDemo'\n\nexport default angular\n  .module('SideNavControllerModule', [])\n  .controller(\n    'sideNavController',\n    function (\n      $document,\n      $element,\n      $injector,\n      $scope,\n      $state,\n      $timeout,\n      accountMenuService,\n      auth,\n      config,\n      express,\n      lang,\n      loyaltyInfoService,\n      mobileNavService,\n      reservationService,\n      shoppingSelectorService,\n      unataCommService,\n      utilService,\n      wordpressRestApiService\n    ) {\n      $scope.reservationService = reservationService\n      const accountMenuItems = accountMenuService.getAccountMenuItems()\n      $scope.accountMenuItems = config.icExpress.hideExpressLinkInSideNavAccountSection\n        ? accountMenuItems.filter(item => item.id !== 'account-menu-main-account-icExpress')\n        : accountMenuItems\n      $scope.utilService = utilService\n      $scope.mobileNavService = mobileNavService\n      $scope.config = config\n      $scope.shoppingSelectorService = shoppingSelectorService\n      $scope.auth = auth\n      // For one time binding to work value needs to be undefined. If we fail to load wordpress sidenav\n      // we will resort to platform sidenav.\n      $scope.showPlatformSideNav =\n        $scope.config.dotComModule.showSideMenu &&\n        config.dotComModule.mobileNav?.wordpressMenuItems?.length > 0\n          ? undefined\n          : true\n      $scope.hasBannerImage = hasBannerImage()\n      $scope.isExpressMenuVisible = () =>\n        config.icExpress.enabled &&\n        auth.user?.ic_linked &&\n        express.isPlacementConfigEnabled('userDropdown')\n      $scope.showSocialLinks =\n        config.dotComModule.mobileNav.showSocialIcons &&\n        Object.keys(config.footerSocialLinks).length\n\n      // Checks if gigya is enabled. We cannot inject this on controller instantiation since the existence of the service\n      // is conditional, based on whether or not gigya has been included in `app/angular/optionalComponents`\n      const gigyaService =\n        config.gigya && config.gigya.enabled ? $injector.get('gigyaService') : null\n      $scope.go = function (sref, params, event) {\n        event.preventDefault()\n        // remove check for params is same, since all links params are null\n        if ($state.is(sref)) {\n          // do not use utilService.stateIs - it doesn't work because it ignores null/undefined params\n          mobileNavService.hideSlideOutMenu()\n          $scope.$parent.$parent?.setSearchingTo(false)\n        } else {\n          $timeout(() => {\n            $state.go(sref, params)\n          }, 150)\n        }\n      }\n\n      // Gigya password reset\n      $scope.gigyaChangePassword = () => gigyaService.gigyaChangePassword()\n\n      $scope.logout = function () {\n        auth.logout()\n      }\n\n      // This triggers when a user clicks the menu icon, safely resetting the styles.\n      $scope.$watch('mobileNavService.slideOutMenuIsVisible', (newVal, oldVal) => {\n        if (newVal !== oldVal) {\n          if (newVal) {\n            menuEl.style.transform = null\n          } else {\n            menuEl.style.transform = 'translate(-100%, 0)'\n          }\n        }\n      })\n\n      // there is a 'stateChangeStart' event listener in mobileNavController, which is only loaded in the Angular header,\n      // but not the React header since we moved the logics to react.\n      // Move the stateChangeStart event listener here to make sure the slide-out menu is closed in React as well\n      $scope.$on('$stateChangeStart', () => {\n        mobileNavService.hideSlideOutMenu()\n        if (isReactDemo() || config.react.enableMobileHeader) {\n          // Resembling the logics in the `stateChangeStart` listener of `mobileNavController.js`,\n          // resetMobileSearchingState() dispatches a redux action to reset `isSearching` and `searchHidden` state in the mobile search bar.\n          mobileNavService.resetMobileSearchingState()\n        }\n      })\n\n      const dragging = false\n      const slideOutEl = $element[0].querySelector('.slide-out-menu')\n      var menuEl = $element[0].querySelector('.mobile')\n      const contentEl = $element[0].querySelector('.nav-content')\n      const menuWidth = menuEl.offsetWidth\n\n      const ham = new Hammer(slideOutEl, {\n        inputClass: Hammer.TouchInput,\n        drag_block_horizontal: true,\n        drag_lock_min_distance: 20,\n        hold: false,\n        release: true,\n        swipe: true,\n        tap: false,\n        touch: true,\n        transform: false,\n      })\n\n      const contentHam = new Hammer(contentEl)\n\n      // The deltaX coming from Hammer is currently pretty buggy ( causing the menu\n      // to jump around on things like panup events ).\n      // TODO: Revisit this UI functionality later.\n      //\n      // hamNav.on('panleft panright', function(e) {\n      //   console.log(e.deltaX);\n      //   if (e.deltaX <= 0) {\n      //     menuEl.style.transform = 'translate(' + e.deltaX + 'px, 0)';\n      //   }\n      // });\n\n      // Close the menu if the user swipes to the left over the slide-out-menu element\n      ham.on('panend', clearSideMenu)\n      // Do the same if the user is swiping over the content block itself (for some mobile browsers)\n      contentHam.on('panend', clearSideMenu)\n\n      // We want to close the menu if a user swipes to the left\n      function clearSideMenu(e) {\n        // If the user has swiped more than 50px to the left, transition the\n        // menu off to the side & clear the styles ($timeout isn't firing\n        // on all versions of Android so we're using $evalAsync here to make\n        // sure the animation is digested properly, kinda weird.)\n        if (e.deltaX <= -50) {\n          mobileNavService.hideSlideOutMenu()\n          $scope.$evalAsync(() => {\n            menuEl.style.transform = 'translate(-100%, 0)'\n          })\n        } else {\n          menuEl.style.transform = 'translate(0px, 0px)'\n        }\n      }\n\n      $scope.instoreContextDetail = function () {\n        if (lang.values.contextPersonalization.instore && auth.user.first_name) {\n          return lang.template(lang.values.contextPersonalization.instore.loggedIn, {\n            userName: auth.user.first_name,\n          })\n        } else if (lang.values.contextPersonalization.instore && !auth.user.first_name) {\n          return lang.values.contextPersonalization.instore.loggedOut\n        } else {\n          return config.shoppingSelector.instore.title\n        }\n      }\n\n      $scope.closeMenu = () => mobileNavService.hideSlideOutMenu()\n      $scope.$on('sidenav:fallback', () => {\n        $timeout(() => {\n          $scope.showPlatformSideNav = true\n        })\n      })\n\n      unataCommService.listen(unataCommService.EventType.TOGGLEMOBILESIDENAV, event => {\n        if (event.data.payload && event.data.payload.showMobileSideNav !== undefined) {\n          $scope.$apply(() => {\n            mobileNavService.setSlideOutMenu(event.data.payload.showMobileSideNav)\n          })\n        }\n      })\n\n      /**\n       * Determines if timeslot should be shown in side nav menu\n       * Shows if:\n       * 1. A reservation is present\n       * 2. OR is configured to show reservations at all times\n       *\n       * @returns {boolean}\n       */\n      $scope.shouldShowTimeslot = () => {\n        return (\n          reservationService.displayReservation ||\n          !(\n            (config.hideTimeslotReservationFromTrialUsers && auth.user.status === 'trial') ||\n            config.shoppingContextProcess[auth.getContext().intent]?.hideTimeslot\n          )\n        )\n      }\n    }\n  )\n","import angular from 'angular'\n\nexport default angular.module('unataStoreidLabelModule', []).component('unataStoreidLabel', {\n  bindings: {\n    changeStoreLink: '<',\n    isChildOfUnifiedHeader: '<',\n  },\n  controller(auth, config, mobileService, shoppingSelectorService) {\n    this.authUser = auth.user\n    this.config = config\n    this.isMobile = mobileService.isMobile\n    this.openShoppingSummary = () =>\n      shoppingSelectorService.open(config.defaultSelectorService.desktopHomeContext)\n  },\n  template: `\n      <a ng-if=\"!$ctrl.changeStoreLink\" id=\"nav-shopping-selector-store\" class=\"value store\" ng-click=\"($ctrl.isChildOfUnifiedHeader === false || !$ctrl.mobile.isMobile ) && $ctrl.openShoppingSummary()\">\n        <span>\n          {{$ctrl.authUser.store.name}}\n        </span>\n      </a>\n\n      <span ng-if=\"$ctrl.changeStoreLink\">\n        {{$ctrl.authUser.store.name}}  <a id=\"nav-shopping-selector-store\" ng-click=\"$ctrl.openShoppingSummary()\" class=\"change-store-link\">Change</a>\n      </span>\n    `,\n})\n","import angular from 'angular'\n\nexport default angular\n  .module('UnataFirstNameLabelModule', [])\n\n  .component('unataFirstNameLabel', {\n    controller(auth, config, lang) {\n      this.auth = auth\n      // eslint-disable-next-line eqeqeq\n      this.isTrialUser = () => auth.user.status == 'trial'\n      this.getUserName = () => auth.user.first_name\n      this.getFirstNameText = () => {\n        return lang.template(config.lang.registrationDropdownFirstNameText, {\n          firstName: auth.user.first_name,\n        })\n      }\n    },\n    template:\n      '<span ng-if=\"!$ctrl.isTrialUser() && $ctrl.auth.user.first_name\" aria-label=\"Logged in as {{$ctrl.getUserName()}}\">{{$ctrl.getFirstNameText()}}</span>',\n  })\n","import angular from 'angular'\nimport { LOGIN_CONTEXTS } from '@app/angular/constants/loginContexts'\nimport { eventEmitter, EVENT_TYPES } from '@app/utils/eventEmitter'\nimport template from './registrationDropdown.html'\n\nexport default angular\n  .module('UnataRegistrationDropdownModule', [])\n  .component('unataRegistrationDropdown', {\n    controller(config, $scope, $state, express, utilService, registrationService) {\n      $scope.config = config\n      $scope.express = express\n      $scope.loadImage = utilService.loadAssetImage\n      $scope.customIcon = $scope.config.icExpress.placements.userDropdown.icon\n      $scope.showLogin = () => {\n        registrationService.open(\n          'login',\n          null,\n          null,\n          null,\n          null,\n          null,\n          LOGIN_CONTEXTS.REGISTRATION_DROPDOWN\n        )\n      }\n\n      eventEmitter.on(EVENT_TYPES.MODAL_OPEN_REGISTRATION_LOGIN, $scope.showLogin)\n\n      $scope.$on('$destroy', () => {\n        eventEmitter.off(EVENT_TYPES.MODAL_OPEN_REGISTRATION_LOGIN, $scope.showLogin)\n      })\n    },\n    template,\n  })\n","import angular from 'angular'\n\nexport default angular.module('UnataNavToggleButtonModule', []).component('unataNavToggleButton', {\n  controller($scope, mobileNavService, unataCommService) {\n    $scope.slideOutMenu = false\n\n    this.toggleNav = () => {\n      mobileNavService.toggleSlideOutMenu()\n\n      const payload = { showMobileSideNav: true }\n      unataCommService.send({\n        eventType: unataCommService.EventType.TOGGLEMOBILESIDENAV,\n        payload,\n      })\n    }\n  },\n  template: `\n      <div role=\"button\" class=\"icon-menu\" ng-click=\"$ctrl.toggleNav()\"></div>\n    `,\n})\n","import angular from 'angular'\n\nexport default angular\n  .module('UnataMobileHeaderHomeButtonModule', [])\n  .component('unataMobileHeaderHomeButton', {\n    controller($state, config, mobileService, lang) {\n      this.config = config\n      this.isMobile = mobileService.isMobile\n      this.$state = $state\n      this.lang = lang\n    },\n    template: `\n      <a ng-click=\"$ctrl.$state.go('main.home')\" class=\"icon-home mobile-header-home-button\" aria-label=\"{{::lang.value.gotoHomepage}}\">\n    `,\n  })\n","import angular from 'angular'\n\nimport CategoriesMenu from './categoriesMenu/index'\nimport MobileNavController from './mobileNavController'\nimport NavCart from './navCart'\nimport NavCartController from './navCartController'\nimport NavController from './navController'\nimport SearchNav from './searchNav'\nimport ShoppingContextIcon from './shoppingContextIcon'\nimport ShoppingSelectorNav from './shoppingSelectorNav'\nimport SideNavController from './sideNavController'\nimport StoreidLabel from './storeidLabel'\nimport FirstNameLabel from './registrationDropdown/firstNameLabel'\nimport RegistrationDropdown from './registrationDropdown/registrationDropdown'\nimport NavToggleButton from './navToggleButton/navToggleButton'\nimport MobileHeaderHomeButton from './mobileHeaderHomeButton'\n\nexport default angular.module('app.component.navModule', [\n  CategoriesMenu.name,\n  MobileNavController.name,\n  NavCart.name,\n  NavCartController.name,\n  NavController.name,\n  SearchNav.name,\n  ShoppingContextIcon.name,\n  ShoppingSelectorNav.name,\n  SideNavController.name,\n  StoreidLabel.name,\n  FirstNameLabel.name,\n  RegistrationDropdown.name,\n  NavToggleButton.name,\n  MobileHeaderHomeButton.name,\n])\n","import angular from 'angular'\n\nexport default angular.module('NavLogoutButtonModule', []).component('unataNavLogoutButton', {\n  bindings: {\n    parent: '<',\n  },\n  controller(auth, config, lang, mobileNavService, registrationService, uibModalAriaLabelService) {\n    this.auth = auth\n    this.lang = lang\n    this.registrationService = registrationService\n    this.config = config\n    this.uibModalAriaLabelService = uibModalAriaLabelService\n\n    this.hideSideNav = () => mobileNavService.hideSlideOutMenu()\n  },\n  template: `\n    <div class=\"nav-menu login\">\n      <ul>\n        <li ng-if=\"$ctrl.auth.user.status === 'trial'\">\n          <button id=\"nav-register-btn\" data-test=\"nav-login\" ng-class=\"{'center-text': !$ctrl.config.dotComModule.mobileNav.loginButton.showIcons}\" ng-click=\"$ctrl.registrationService.open('login'); $ctrl.uibModalAriaLabelService.setLabel($ctrl.lang.values.login)\" analytics-click=\"['nav login register button', 'click']\" refocus>\n            <span ng-class=\"{'icon-login': $ctrl.config.dotComModule.mobileNav.loginButton.showIcons}\" aria-hidden=\"true\"></span>\n            {{::$ctrl.lang.values.loginOrRegister}}\n          </button>\n        </li>\n        <li ng-if=\"$ctrl.auth.user.status !== 'trial'\">\n          <button id=\"nav-logout-btn\" data-test=\"nav-logout\" ng-class=\"{'center-text': !$ctrl.config.dotComModule.mobileNav.loginButton.showIcons}\" ng-click=\"$ctrl.hideSideNav(); $ctrl.auth.logout()\" analytics-click=\"['nav user dropdown logout link', 'click']\">\n            <span ng-class=\"{'icon-logout': $ctrl.config.dotComModule.mobileNav.loginButton.showIcons}\" aria-hidden=\"true\"></span>\n            {{::$ctrl.lang.values.logout}}\n          </button>\n        </li>\n      </ul>\n    </div>\n    `,\n})\n","import angular from 'angular'\nimport NavLogoutButton from './navLogoutButton.js'\n\nexport default angular.module('app.component.navLogoutButtonModule', [NavLogoutButton.name])\n","import angular from 'angular'\nimport { isWaysToShopEnabled } from '@app/utils/isModuleEnabled'\n\nexport default angular\n  .module('OfferDetailsControllerModule', [])\n  .controller(\n    'OfferDetailsController',\n    function (\n      $filter,\n      $rootScope,\n      $scope,\n      $state,\n      Restangular,\n      analytics,\n      cartService,\n      config,\n      offer,\n      offerDetailsModalService,\n      offersService,\n      titleService\n    ) {\n      $scope.offer = offer\n\n      const isOffersBreadcrumbEnabled = () => {\n        return config.offersAndCoupons.showOffersBreadcrumbs\n      }\n      if (!offer) {\n        $state.go('main.404')\n      } else {\n        let offerTypeString\n\n        if ($scope.offer.offer_type === 'coupon') {\n          offerTypeString = 'coupons'\n        } else if ($scope.offer.offer_type === 'offer') {\n          offerTypeString = 'offers'\n        }\n\n        $scope.breadcrumbs = [\n          ...(!isWaysToShopEnabled()\n            ? []\n            : [\n                {\n                  label: config.lang.waysToShop,\n                  state: 'main.shop',\n                },\n              ]),\n          ...(!isOffersBreadcrumbEnabled()\n            ? []\n            : [\n                {\n                  label: config.lang[offerTypeString],\n                  state: `main.shop.${offerTypeString}`,\n                },\n              ]),\n          {\n            label: offer.name,\n            state: 'main.offers.details',\n            params: {\n              offerId: offer.id,\n            },\n          },\n        ]\n\n        $scope.isOffersDetailsPage = $state.current.name === 'main.offers.details'\n        if ($scope.isOffersDetailsPage) {\n          titleService.setTitle(config.lang.coupons)\n        }\n\n        $scope.getConditionLabel = condition_index => {\n          const numProductRewards = $scope.rewards.filter(\n            r => r.type === 'products' && r.product_details.length\n          )\n          if ($scope.conditions.length > 1 || numProductRewards > 0) {\n            // Offers with multiple conditions or reward section should display shorter condition heading titles\n            return (\n              $scope.conditions[condition_index].cdn_collection_title ||\n              $scope.offerProgressData.condition.collection_title\n            )\n          }\n          // Offers with single condition and no reward section should display full heading title on condition heading\n          return $scope.offer.cdn_collection_title\n        }\n\n        $scope.conditions = [offer.condition]\n        if (offer.additional_cdns && offer.additional_cdns.length > 1) {\n          $scope.conditions = offer.additional_cdns\n        }\n\n        $scope.rewards = [offer.reward]\n        if (offer.additional_rwds && offer.additional_rwds.length > 1) {\n          $scope.rewards = offer.additional_rwds\n        }\n\n        // eslint-disable-next-line eqeqeq\n        // eslint-disable-next-line eqeqeq\n        if ($scope.conditions.length == 1 && $scope.rewards.length == 1) {\n          // Offers with one condition and reward  should go through old endpoint for\n          // backwards compatibility\n          if (offer.condition.type !== 'cart') {\n            if (offer.condition.type !== 'collection') {\n              Restangular.one('offers', offer.id)\n                .all('condition_products')\n                .getList({ limit: 5 })\n                .then(response => {\n                  $scope.conditions[0].product_details = response\n                })\n            }\n          }\n          if (offer.reward.type === 'products') {\n            Restangular.one('offers', offer.id)\n              .all('reward_products')\n              .getList({ limit: 5 })\n              .then(response => {\n                $scope.rewards[0].product_details = response\n              })\n          }\n        } else {\n          // Newer offers with multiple condition should call the v2 endpoint\n          Restangular.one('offers', offer.id)\n            .all('v2/products')\n            .getList({ limit: 5 })\n            .then(response => {\n              $scope.conditions.forEach((condition, i) => {\n                condition.product_details = response.cdn_products[i].items\n              })\n              $scope.rewards.forEach((reward, i) => {\n                reward.product_details = response.rwd_products[i].items\n              })\n            })\n        }\n\n        // Collection conditions need to be handled by collection endpoint instead of product endpoint\n        $scope.conditions.forEach(condition => {\n          if (condition.type === 'collection') {\n            const collectionId = offer.condition.collection.collection.id\n            Restangular.one('collections', collectionId)\n              .get({ limit: 5 })\n              .then(response => {\n                const product_details = response.items\n                product_details.item_count = response.item_count\n                condition.product_details = product_details\n              })\n          }\n        })\n\n        // Log the offer details view for analytics\n        analytics.logOfferDetailsView($scope.offer, 'Offer Details')\n\n        // The offer progress data is not present in the offer reference that is passed to this controller, so we need to get it from the getOfferData function.\n        offersService.getOfferData(offer.id, false).then(offerProgressData => {\n          $scope.offerProgressData = offerProgressData\n        })\n        // We need to listen for the cart being synced so that the offer progress indicator\n        //  will be updated when the cart changes.\n        const deregisterListener = $scope.$watch(\n          () => cartService.lastUpdated,\n          () => {\n            offersService.getOfferData(offer.id).then(offerProgressData => {\n              $scope.offerProgressData = offerProgressData\n            })\n          }\n        )\n        $scope.$on('$destroy', () => {\n          deregisterListener()\n        })\n\n        $scope.unlockContinuityOfferReward = offerID => {\n          // Don't trigger the default offer cell modal opening\n          /* eslint-disable no-restricted-globals */\n          if (event) {\n            event.stopPropagation()\n          }\n          /* eslint-enable no-restricted-globals */\n\n          offersService.getOfferData(offerID).then(offer => {\n            offerDetailsModalService.open(offer.offer)\n          })\n        }\n      }\n    }\n  )\n","import angular from 'angular'\nimport OfferDetailsControllerModule from './offerDetailsController' // cannot lazyload - used in multuple places\n\nexport default angular\n  .module('OffersComponentModule', [OfferDetailsControllerModule.name])\n  .config(($ocLazyLoadProvider, $stateProvider) => {\n    $stateProvider.state('main.offers', {\n      url: '/offers',\n      abstract: true,\n    })\n\n    $stateProvider.state('main.offers.details', {\n      url: '/:offerId',\n      resolve: {\n        offer($stateParams, offersService) {\n          return offersService.getOffer($stateParams.offerId)\n        },\n      },\n      views: {\n        'content@': {\n          template: require('./offerDetails.html'),\n          controller: 'OfferDetailsController',\n        },\n      },\n    })\n\n    $stateProvider.state('main.offers.details.conditions', {\n      url: '/condition_products?page',\n      resolve: {\n        loadCtrl: $ocLazyLoad => {\n          return import(\n            /* webpackChunkName: \"offerCollectionsController\", webpackPrefetch: true */ './offerCollectionsController'\n          )\n            .then(mod => $ocLazyLoad.load(mod.default))\n            .catch(err => {\n              throw new Error(`Ooops, something went wrong, ${err}`)\n            })\n        },\n        customData() {\n          return { route: 'condition_products' }\n        },\n      },\n      views: {\n        'content@': {\n          template: require('./offerCollections.html'),\n          controller: 'OfferCollectionsController',\n        },\n      },\n    })\n\n    $stateProvider.state('main.offers.details.rewards', {\n      url: '/reward_products?page',\n      resolve: {\n        loadCtrl: $ocLazyLoad => {\n          return import(\n            /* webpackChunkName: \"offerCollectionsController\", webpackPrefetch: true */ './offerCollectionsController'\n          )\n            .then(mod => $ocLazyLoad.load(mod.default))\n            .catch(err => {\n              throw new Error(`Ooops, something went wrong, ${err}`)\n            })\n        },\n        customData() {\n          return { route: 'reward_products' }\n        },\n      },\n      views: {\n        'content@': {\n          template: require('./offerCollections.html'),\n          controller: 'OfferCollectionsController',\n        },\n      },\n    })\n  })\n","import angular from 'angular'\nimport OffersComponent from './offersRoutes.js'\n\nexport default angular.module('app.component.offersModule', [OffersComponent.name])\n","import _ from 'lodash'\nimport angular from 'angular'\nimport { getSortOptions } from '@app/utils/cart'\n\nconst ITEM_GROUPING = {\n  CATEGORY: 'category',\n  AISLE: 'aisle',\n}\n\nexport default angular\n  .module('OfflineRetryInterceptorModule', [])\n  .factory('OfflineRetryInterceptor', function ($injector, $q) {\n    return {\n      responseError(response) {\n        const offline = $injector.get('offline')\n        if (offline.isOfflineTriggered && !offline.isOffline) {\n          const $timeout = $injector.get('$timeout')\n          return $timeout(() => {\n            if (offline.isOffline) {\n              return $q.reject(response)\n            }\n            const $http = $injector.get('$http')\n            return $http(response.config)\n          }, offline.offlineRetryDelay)\n        }\n        return $q.reject(response)\n      },\n    }\n  })\n  .config([\n    '$httpProvider',\n    function ($httpProvider) {\n      $httpProvider.interceptors.push('OfflineRetryInterceptor')\n    },\n  ])\n  .service(\n    'offline',\n    function (\n      $rootScope,\n      $state,\n      $timeout,\n      config,\n      localStorageService,\n      mobileService,\n      redirectService,\n      shoppingListCache,\n      userService,\n      utilService\n    ) {\n      const service = this\n      service.isOffline = false\n      service.isOfflineTriggered = false\n      service.offlineBuffer = config.offlineBuffer\n      service.offlineRetryDelay = config.offlineRetryDelay\n\n      // debug\n      // eslint-disable-next-line no-restricted-globals\n      top.offlineService = service\n      service.goOnline = goOnline\n      service.goOffline = goOffline\n\n      function goOnline() {\n        service.isOfflineTriggered = false\n        if (!$timeout.cancel(service.currentTimeout)) {\n          shoppingListCache.putCacheToCart()\n          service.isOffline = false\n          $rootScope.$apply()\n        }\n      }\n\n      function goOffline() {\n        service.isOfflineTriggered = true\n        service.currentTimeout = $timeout(() => {\n          redirectService.saveRedirectUrl()\n          service.isOffline = true\n          if ($state.current.name === 'main.inStoreList.review') {\n            $state.go('offlineList')\n          } else {\n            $state.go('offline')\n          }\n          $rootScope.$apply()\n        }, service.offlineBuffer)\n      }\n\n      // Check online/offline\n      const addListeners = () => {\n        window.addEventListener('online', goOnline)\n        window.addEventListener('offline', goOffline)\n\n        if (navigator.connection && navigator.connection.type === 'none') {\n          goOffline()\n        }\n      }\n\n      if (mobileService.isMobileApp()) {\n        document.addEventListener('deviceready', () => addListeners())\n      } else if (mobileService.isMobile) {\n        addListeners()\n      }\n\n      // Watch for updates to the user object (if user is using native app, nibbler will send CORS errors otherwise)\n\n      if (mobileService.isMobileApp()) {\n        $rootScope.$on('auth', (event, action, _user) => {\n          if (action === 'userUpdated') {\n            userService.getLoyaltyCards().then(() => {\n              const primaryCard = angular.copy(userService.getPrimaryLoyaltyCard())\n\n              // Fetch barcode image and store in localStorage\n\n              if (primaryCard) {\n                utilService.getBase64Image(primaryCard.barcode_image).then(barcode64 => {\n                  primaryCard.barcode_image = barcode64\n                  localStorageService.deprecatedSet('primary-card', primaryCard)\n                })\n              } else {\n                localStorageService.deprecatedRemove('primary-card')\n              }\n            })\n          }\n        })\n      }\n    }\n  )\n\n  .controller(\n    'OfflineController',\n    function (\n      $scope,\n      $state,\n      $timeout,\n      cartService,\n      config,\n      lang,\n      localStorageService,\n      mobileService,\n      nativeMobileBrightnessService,\n      offline,\n      redirectService,\n      shoppingListCache\n    ) {\n      $scope.offline = offline\n      $scope.card = localStorageService.deprecatedGet('primary-card')\n      $scope.lang = lang\n      $scope.config = config\n      $scope.$state = $state\n\n      shoppingListCache.itemCount().then(count => {\n        $scope.itemCount = count\n      })\n\n      if (mobileService.isMobileApp() && $scope.card) {\n        nativeMobileBrightnessService.enableFullBrightnessMode()\n        $scope.$on('$destroy', () => {\n          nativeMobileBrightnessService.resetBrightnessMode()\n        })\n      }\n      shoppingListCache.getCache().then(({ defaultHeaderImage }) => {\n        $scope.defaultHeaderImage = defaultHeaderImage\n      })\n      $scope.getDefaultHeaderImage = () => {\n        return $scope.defaultHeaderImage\n      }\n\n      $scope.tryAgain = function () {\n        $scope.trying = true\n        $timeout(() => {\n          $scope.trying = false\n        }, 5000)\n\n        if ($state.current.name === 'offlineList') {\n          shoppingListCache\n            .putCacheToCart()\n            .then(cartService.sync)\n            .finally(() => $state.go('main.inStoreList.review'))\n        } else {\n          redirectService.loadRedirectUrl({ state: 'main.home' })\n        }\n      }\n\n      $scope.getMessage = () => {\n        if ($scope.config.offlineShoppingList.enabled && $scope.config.hasLoyalty && $scope.card) {\n          return $scope.lang.values.offlineMessageLoyaltyAndList\n        }\n        if ($scope.config.hasLoyalty && $scope.card) {\n          return $scope.lang.values.offlineMessageLoyalty\n        }\n        return $scope.lang.values.offlineMessage\n      }\n    }\n  )\n  .controller(\n    'OfflineInStoreListReviewController',\n    function OfflineInStoreListReviewController(\n      config,\n      configurableProductService,\n      imageURLService,\n      lang,\n      listPrintService,\n      shoppingListCache,\n      sideCartSortModalService,\n      utilService\n    ) {\n      const vm = this\n      const eComExists =\n        config.shoppingSelector.delivery.exist || config.shoppingSelector.pickup.exists\n      const eComLightEnabled = config.eComLight.enabled\n      vm.isOffline = true\n\n      const SORT_OPTIONS = getSortOptions(lang)\n\n      Object.assign(\n        vm,\n        { config, configurableProductService, imageURLService, lang, listPrintService },\n        {\n          hasCartItems: () => shoppingListCache.cart?.items?.length > 0,\n          showOrderOnlineButton: eComExists && !eComLightEnabled,\n        }\n      )\n      vm.cartService = shoppingListCache\n\n      vm.model = {\n        sortType: config.defaultShoppingListSort || ITEM_GROUPING.CATEGORY,\n        sortedProductsBy: {},\n        orderedGroups: {},\n        editMode: false,\n      }\n\n      vm.setSortType = sortType => {\n        vm.model.sortType = sortType\n      }\n\n      vm.newCustomItem = {\n        name: '',\n      }\n\n      shoppingListCache.getCache().then(({ defaultProductImage }) => {\n        vm.defaultProductImage = defaultProductImage\n      })\n      vm.getDefaultProductImage = () => vm.defaultProductImage\n\n      // This is taken from the InStoreListReviewController\n      // Fetch custom and non-custom items in the list\n      const getListItems = () => {\n        vm.model.customItems = shoppingListCache.getCustomItems()\n        vm.model.nonCustomItems = shoppingListCache.getNonCustomItems()\n      }\n\n      // This is taken from the InStoreListReviewController\n      // Get products sorted by Category\n      const getCategorizedProducts = () => {\n        shoppingListCache\n          .getCategorizedProductsAndCategories()\n          .then(({ productsByCategory, orderedCategories }) => {\n            vm.model.customItems = shoppingListCache.getCustomItems()\n            vm.model.sortedProductsBy.category = productsByCategory\n            vm.model.orderedGroups.category = orderedCategories\n          })\n      }\n\n      // This is taken from the InStoreListReviewController\n      // Get products sorted by Aisle\n      const getProductsSortedByAisle = () => {\n        if (!config.disableAisles) {\n          vm.model.sortedProductsBy.aisle = shoppingListCache.getAllProductsByAisle()\n          vm.model.orderedGroups.aisle = _.keys(vm.model.sortedProductsBy.aisle).sort(\n            utilService.naturalSortFunc\n          )\n        }\n      }\n      // This is taken from the InStoreListReviewController\n      vm.model.isLoading = true\n      shoppingListCache\n        .fetch()\n        .then(() => {\n          // Prepare the default user list (through cart service)\n          if (shoppingListCache.cart.items.length > 0) {\n            _.each(shoppingListCache.cart.items, item => {\n              if (item.store_product) {\n                item.isSelected = false\n              }\n            })\n\n            // Generate initial list of categorized products and custom items\n            getCategorizedProducts()\n            getListItems()\n            getProductsSortedByAisle()\n\n            // On cart update, re-set categorized products and custom items\n            // $scope.$watch(\n            //   () => cartService.lastUpdated,\n            //   () => {\n            //     getCategorizedProducts()\n            //     getListItems()\n            //     getProductsSortedByAisle()\n            //   }\n            // )\n          }\n\n          vm.model.isLoading = false\n        })\n        .catch(_err => {})\n\n      vm.incrementItem = item => {\n        item.quantity = item.quantity + 1\n\n        shoppingListCache.updateItem({ ...item }).then(getCategorizedProducts)\n      }\n\n      vm.decrementItem = item => {\n        if (item.quantity > 1) {\n          item.quantity = item.quantity - 1\n          shoppingListCache.updateItem({ ...item }).then(getCategorizedProducts)\n          return\n        }\n\n        item.showDeleteConfirm = true\n      }\n\n      vm.updateItemQuantity = item => {\n        shoppingListCache.updateItem(item).then(getCategorizedProducts)\n      }\n\n      vm.removeItem = item => {\n        item.quantity = 0\n\n        shoppingListCache.updateItem({ ...item }).then(getCategorizedProducts)\n      }\n\n      vm.removeCustomItem = itemName => {\n        const customItem = shoppingListCache.cart.items.find(\n          cartItem =>\n            cartItem.item_type === 'pseudo_product' && cartItem.pseudo_product?.name === itemName\n        )\n\n        return this.removeItem(customItem)\n      }\n\n      vm.emptyList = () => shoppingListCache.removeItems()\n\n      vm.updateItemComment = item => shoppingListCache.updateItem(item)\n\n      vm.toggleAddCustom = value => {\n        vm.model.showAddCustom = value\n        if (vm.model.showAddCustom) {\n          const customItemInput = document.querySelector('#add-custom-item-input')\n          customItemInput.focus()\n        } else {\n          utilService.blurAndHideKeyboard()\n        }\n      }\n\n      vm.addCustomItem = itemName => {\n        if (itemName.length) {\n          shoppingListCache\n            .updateItem(\n              {\n                quantity: 1,\n                pseudo_product: {\n                  name: itemName,\n                },\n                item_type: 'pseudo_product',\n                dirty: true,\n              },\n              1\n            )\n            .then(() => {\n              vm.model.customItemInput = ''\n              getListItems()\n            })\n        }\n      }\n      // I'm not sure why but there are two different versions of this function\n      // in the original controller that do the same thing\n      vm.addNewCustomItem = itemName => vm.addCustomItem(itemName)\n\n      vm.setSortType = sortType => {\n        vm.model.sortType = sortType\n      }\n\n      vm.sortOptionNameByValue = value => SORT_OPTIONS.find(option => option.value === value)?.name\n\n      vm.triggerSortModal = () => {\n        vm.showSortModal = true\n        sideCartSortModalService\n          .open({\n            sortOptions: SORT_OPTIONS,\n            sort: vm.model.sortType,\n          })\n          .then(results => {\n            vm.setSortType(results.sort)\n          })\n          .finally(() => {\n            vm.showSortModal = false\n          })\n      }\n\n      // All the functions below are from the original shopping list controller\n      // Theses functions edit the shopping list and should be added in to work\n      // with the cache list later on.\n\n      // Reqiures a REST api call\n      vm.goToProductDetailsModal = () => shoppingListCache.notYetSupported\n\n      vm.openShoppingSelectorModal = () => shoppingListCache.notYetSupported\n    }\n  )\n","import angular from 'angular'\n\nimport OfflineNavTemplate from './offlineNav.html'\nimport OfflineTemplate from './offline.html'\nimport OfflineRetryInterceptorModule from './offline.js'\n\nexport default angular\n  .module('OfflineComponentModule', [OfflineRetryInterceptorModule.name])\n  .config($stateProvider => {\n    $stateProvider\n      .state('offline', {\n        url: '/offline',\n        views: {\n          nav: {\n            template: OfflineNavTemplate,\n            controller: 'OfflineController',\n          },\n          content: {\n            template: OfflineTemplate,\n            controller: 'OfflineController',\n          },\n        },\n      })\n      .state('offlineList', {\n        url: '/offline/list',\n        views: {\n          nav: {\n            template: OfflineNavTemplate,\n            controller: 'OfflineController',\n          },\n          content: {\n            template: require('@app/angular/components/inStoreList/review/inStoreListReview.html'),\n            controller: 'OfflineInStoreListReviewController',\n            controllerAs: '$ctrl',\n          },\n        },\n        resolve: {\n          redirect($state, $timeout, config, offline) {\n            if ($state.current.name !== 'offline' && !offline.isOffline) {\n              return $timeout(() => {\n                $state.go('main.home')\n              })\n            }\n            if (!config.offlineShoppingList.enabled) {\n              return $timeout(() => {\n                $state.go('offline')\n              })\n            }\n          },\n        },\n      })\n  })\n","import angular from 'angular'\nimport Offline from './offlineRoutes.js'\n\nexport default angular.module('app.component.offlineModule', [Offline.name])\n","import angular from 'angular'\n\nexport default angular\n  .module('OrderAddOnComponentModule', [])\n  .config(($stateProvider, langProvider) => {\n    $stateProvider.state('orderAddOn', {\n      url: '/order-add-on?search_term&page',\n      views: {\n        nav: {\n          template: require('./orderAddOnNav.html'),\n          controller: 'OrderAddOnNavController',\n          controllerAs: '$ctrl',\n        },\n        content: {\n          template: require('./orderAddOn.html'),\n          controller: 'OrderAddOnController',\n          controllerAs: '$ctrl',\n        },\n      },\n      onEnter: $rootScope => {\n        $rootScope.showOverflow = true\n      },\n      onExit: $rootScope => {\n        $rootScope.showOverflow = false\n      },\n      resolve: {\n        /* Load dependencies */\n        $lazyLoadControllers(utilService) {\n          return utilService.lazyLoadControllers({\n            OrderAddOnController: () =>\n              import(\n                /* webpackChunkName: \"orderAddOnController\", webpackPrefetch: true */ './orderAddOnController'\n              ),\n            OrderAddOnNavController: () =>\n              import(\n                /* webpackChunkName: \"orderAddOnNavController\", webpackPrefetch: true */ './orderAddOnNavController'\n              ),\n          })\n        },\n\n        /* Page utilities */\n        title: titleService => {\n          return titleService.setTitle(langProvider.values.orderAddOn.addOnRequest)\n        },\n        validStateRedirect: ($state, $stateParams, $timeout) => {\n          // Initialize page by checking that user has a valid `order.id`. If `can_add_items: false`,\n          // Redirect to `order.id`. If `order.id` does not exist, go back to order history page\n          // $timeout is required to prevent flicker due to a known quirk with ui-router: https://github.com/angular-ui/ui-router/issues/326\n          $timeout(() => {\n            if ($stateParams.order && $stateParams.order.id && !$stateParams.order.can_add_items) {\n              $state.go('main.account.orderHistory.order', { id: $stateParams.order.id })\n            } else if (!$stateParams.order || ($stateParams.order && !$stateParams.order.id)) {\n              $state.go('main.account.orderHistory')\n            }\n          })\n        },\n      },\n      params: {\n        order: {},\n      },\n    })\n  })\n","import angular from 'angular'\nimport OrderAddOnRoutes from './orderAddOnRoutes.js'\n\nexport default angular.module('app.component.orderAddOnModule', [OrderAddOnRoutes.name])\n","import angular from 'angular'\nimport { AUTH_TYPES } from '@app/angular/constants/payments'\nimport { captureMessage } from '@sentry/browser'\nimport template from './stripeForm.html'\n\nclass StripeFormController {\n  constructor($timeout, lang, stripe, Restangular, auth) {\n    this.lang = lang\n    this.stripe = stripe\n    this.$timeout = $timeout\n    this.Restangular = Restangular\n    this.auth = auth\n\n    this.card = null\n    this.isSubmitting = false\n    this.cardStripeElLoaded = false\n    this.doNotSaveCard = auth.user.opt_out_save_payment_info || false\n  }\n\n  $onInit() {\n    const elements = this.stripe.elements()\n\n    // Custom styling can be passed to options when creating an Element.\n    const style = {\n      base: {\n        fontFamily: '\"Helvetica Neue\", Helvetica, sans-serif',\n        fontSmoothing: 'antialiased',\n        fontSize: '16px',\n      },\n      invalid: {\n        color: '#B03520',\n        iconColor: '#B03520',\n      },\n    }\n\n    this.card = elements.create('card', { style })\n    this.card.on('ready', () => (this.cardStripeElLoaded = true))\n    this.card.on('change', event => (this.cardErrors = event.error ? event.error.message : ''))\n    this.isStripeFormInitialized = true\n    this.authType = this.authType || AUTH_TYPES.CAPTURE\n    this._generateStripeCustomer()\n  }\n\n  _postPaymentInstrument(token) {\n    return this.Restangular.one('user').one('payment').customPOST({\n      ext_id: token.id,\n      service_type: this.paymentContext,\n    })\n  }\n\n  // PUT cart/payment tells the BE to generate customer id for Stripe\n  _generateStripeCustomer() {\n    return this.Restangular.one('cart').one('payment').customPUT({\n      payment_type: this.authType,\n      service_type: this.paymentContext,\n    })\n  }\n\n  /**\n   * Saves the user credit card\n   * @returns { Promise }\n   */\n  async saveCreditCard() {\n    this.isFormSubmitting = true\n\n    try {\n      const result = await this.stripe.createToken(this.card)\n\n      // Inform the user if there was an error.\n      if (result.error) {\n        this.cardErrors = result.error.message\n        throw result.error\n      }\n\n      const { token } = result\n      const card = await this._postPaymentInstrument(token)\n\n      // always save the users payment info save preference sync\n      // if they dont want to save the card set the status false to remove the card\n      // error doesn't block adding payment method\n      try {\n        if (this.doNotSaveCard) {\n          card.noSave = true\n          await this.Restangular.one('user/payment', card.id).remove({\n            service_type: this.paymentContext,\n          })\n        }\n\n        // keep this sync\n        this.auth.update({ opt_out_save_payment_info: this.doNotSaveCard })\n      } catch (error) {\n        captureMessage(`Unable to update users payment preference: ${error?.message || error}`)\n      }\n\n      this.onAfterSave({ card })\n      this.card.clear()\n    } catch (error) {\n      this.onSaveError({ error })\n    } finally {\n      this.$timeout(() => (this.isFormSubmitting = false))\n    }\n  }\n\n  handleFormCancelClick() {\n    this.card.clear()\n    this.onCancelFormClick()\n  }\n}\n\nexport default angular.module('StripeFormComponentModule', []).component('stripeForm', {\n  template,\n  bindings: {\n    authType: '<',\n    isLoading: '<',\n    useIcTheme: '<',\n    saveLabel: '@?',\n    onAfterSave: '&',\n    onSaveError: '&',\n    saveButtonSize: '@?',\n    onCancelFormClick: '&',\n    enableSolidBackground: '<?',\n    paymentContext: '<',\n    creditCards: '<',\n    showSaveCreditCardCheckbox: '<',\n  },\n  controller: StripeFormController,\n  controllerAs: '$ctrl',\n})\n","import angular from 'angular'\nimport StripeForm from './stripeForm'\n\nexport default angular.module('app.component.stripeForm', [StripeForm.name])\n","import angular from 'angular'\nimport { SOURCES } from '@app/angular/constants/payments'\nimport template from './creditCardList.html'\n\nclass CreditCardList {\n  constructor(errorModalService, lang, mobileService, utilService) {\n    Object.assign(this, {\n      SOURCES,\n      errorModalService,\n      lang,\n      mobileService,\n      utilService,\n    })\n  }\n\n  handleLockedCreditCardClick() {\n    if (!this.mobileService.isMobile) return\n\n    const { creditCardLocked, ok, warning } = this.lang.values\n\n    this.errorModalService.open(creditCardLocked, ok, null, warning)\n  }\n\n  showDeleteLink(creditCard) {\n    return (\n      (this.allowDeleteOfSelected || this.selectedCreditCard.ext_id !== creditCard.ext_id) &&\n      !creditCard.noSave\n    )\n  }\n\n  formatCardExpiry(expDate) {\n    const expDateStr = typeof expDate === 'number' ? expDate.toString() : ''\n    return padStart(expDateStr, 2, '0')\n  }\n\n  getCardInfoString(creditCard) {\n    const { disableCardName, lang } = this\n    return lang.template(lang.values.cardEnding, {\n      cardName: (!disableCardName && creditCard.name) || creditCard.provider,\n      cardNumber: creditCard.last_four_digits,\n    })\n  }\n\n  getCardExpiryString(creditCard) {\n    const { lang } = this\n    return lang.template(lang.values.cardExpiring, {\n      month: this.formatCardExpiry(creditCard.exp_month),\n      year: creditCard.exp_year,\n    })\n  }\n}\n\nexport default angular.module('CreditCardListComponentModule', []).component('creditCardList', {\n  template,\n  bindings: {\n    creditCards: '<', // Array<Object>: An array of credit card objects\n    onDeleteClick: '&?', // Function? called for the delete click\n    onSelect: '&?', // Function?: Called when a new card is selected\n    selectedCreditCard: '=?', // Object Reference?: The \"ng-model\" for the selected card\n    useIcTheme: '<?', // Boolean?: Whether to use the IC Theme\n    disableSelectButton: '=?', // Boolean?: True if button for select should not be enabled\n    disableDelete: '=?', // Boolean?: True if delete is disabled\n    disableCardName: '=?', // Boolean?: True if card description name is disabled and should not show\n    allowDeleteOfSelected: '=?', // Boolean?: True if allowed to delete selected\n    includeExpiryDate: '=?', // Boolean?: True if to include expiry date\n  },\n  controller: CreditCardList,\n  controllerAs: '$ctrl',\n})\n\n/*\n * TODO REMOVE THIS WHEN POLYFILL SUPPORT HAS BEEN ADDED\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/padStart#Polyfill\n */\nfunction padStart(sourceString, targetLength, padString) {\n  targetLength = targetLength >> 0 // truncate if number, or convert non-number to 0;\n  padString = String(typeof padString !== 'undefined' ? padString : ' ')\n  if (sourceString.length >= targetLength) {\n    return String(sourceString)\n  }\n\n  targetLength = targetLength - sourceString.length\n  if (targetLength > padString.length) {\n    padString += padString.repeat(targetLength / padString.length) // append to original to ensure we are longer than needed\n  }\n  return padString.slice(0, targetLength) + String(sourceString)\n}\n","import angular from 'angular'\nimport CreditCardList from './creditCardList'\n\nexport default angular.module('app.component.creditCardList', [CreditCardList.name])\n","import angular from 'angular'\nimport StripeForm from './stripe/stripeForm'\nimport CreditCardList from './creditCardList'\n\nexport default angular.module('app.component.payments', [CreditCardList.name, StripeForm.name])\n","import dayjs from 'dayjs'\n\nexport const getProductOfferPoints = offers => {\n  const offerWithPoints = offers.find(offer => offer.points !== null)\n  return offerWithPoints ? offerWithPoints.points : null\n}\n\nexport const getUnclippedCoupons = offers => {\n  return offers.filter(offer => offer.offer_type === 'coupon' && !offer.clipped)\n}\n\nexport const getProductCellBadgeClassName = config => {\n  const {\n    customBadge,\n    hasOffer,\n    hasOfferPoints,\n    hasLoyaltyPoints,\n    enableCustomOfferInsideBadge,\n  } = config\n  if (customBadge) {\n    return `${customBadge.toLowerCase()}-badge`\n  }\n  if (hasOfferPoints && hasLoyaltyPoints) {\n    return 'points-badge'\n  }\n  if (hasOffer && enableCustomOfferInsideBadge) {\n    return 'custom-offer-inside-badge'\n  }\n  if (hasOffer) {\n    return 'offer-badge'\n  }\n}\n\nexport const getProductPriceLabel = (product_config, lang) => {\n  return product_config?.config_type === 'custom' && product_config?.has_pricing\n    ? lang.values.from\n    : lang.values.price\n}\n\nexport const concatProductTitle = (product, lang, showAvg = true) => {\n  if (product.average_weight && showAvg) {\n    const averageWeight = lang.template(lang.values.avgWeight, {\n      product: product.average_weight,\n      unit: product.average_uom || product.display_uom,\n    })\n    return `${product.name} (${averageWeight})`\n  }\n\n  return product.name\n}\n\nexport const getOverlayTriggerChance = (\n  hasUnclippedCoupon,\n  productCellCouponChance,\n  productCellRecoChance\n) => {\n  const recoChance = hasUnclippedCoupon ? productCellCouponChance : productCellRecoChance\n  if (recoChance > 0 && recoChance < 1) {\n    return Math.random() <= recoChance\n  }\n  return recoChance\n}\n\nexport const adjustDollarsToCents = amt => (amt >= 1 ? `$${amt}` : `${Math.floor(amt * 100)}¢`)\n\nexport const getConfigProductTags = (tagNames, configTags) => {\n  let productTags = []\n  if (tagNames) {\n    // eslint-disable-next-line array-callback-return\n    productTags = tagNames.map(tag => {\n      // eslint-disable-next-line no-plusplus\n      for (let i = 0; i < configTags.length; i++) {\n        const configTag = configTags[i]\n        if (configTag.id === tag) {\n          return {\n            background: configTag.color,\n            icon: configTag.icon,\n            name: configTag.name,\n          }\n        }\n      }\n    })\n  }\n  return productTags\n}\n\n// adjust start sale end date for IC catalog items due to logic\n// between IC and Unata\nexport const getEnterpriseSaleEndDate = (saleEndDate, config) =>\n  config.hasICSaleEndDate ? dayjs(saleEndDate).subtract(1, 'day') : saleEndDate\n","export const SHOPPING_SELECTOR_STAGES = {\n  BANNER_SELECTOR: 'bannerSelector',\n  CART_TO_LIST_MIGRATION: 'cartToListMigration',\n  CONFIRMATION: 'confirmation',\n  SHOPPING_CONTEXT: 'shoppingContext',\n  STORE_SELECTOR: 'storeSelector',\n  TIMESLOT: 'timeslot',\n  CLOSE: 'close',\n}\n\nexport const TRANSITIONS = {\n  SHOPPING_SELECTOR: 'shoppingSelector',\n  CLOSE_MODAL: 'closeModal',\n  STATE_GO: 'stateGo',\n  CART_COMPARE: 'cartCompare',\n}\n","import angular from 'angular'\n\nexport default angular\n  .module('OrderAddOnConfirmModalControllerModule', [])\n  .controller(\n    'OrderAddOnConfirmModalController',\n    function OrderAddOnConfirmModalController(\n      $scope,\n      $state,\n      $stateParams,\n      Restangular,\n      compareCartService,\n      lang,\n      mobileService,\n      product\n    ) {\n      const vm = this\n      vm.product = product\n      vm.order = $stateParams.order\n      vm.mobile = mobileService\n\n      $scope.loading = false\n\n      vm.orderAddOnIncrement = () => {\n        if (vm.product.quantity >= vm.product.ordering_parameters.max) {\n          vm.product.quantity = vm.product.ordering_parameters.max\n        } else {\n          // eslint-disable-next-line no-plusplus\n          vm.product.quantity++\n        }\n\n        vm.calculatePrice()\n      }\n\n      vm.orderAddOnDecrement = () => {\n        // eslint-disable-next-line no-plusplus\n        if (vm.product.quantity > 1) vm.product.quantity--\n\n        vm.calculatePrice()\n      }\n\n      vm.orderAddOnUpdate = () => {\n        if (vm.product.quantity >= vm.product.ordering_parameters.max) {\n          vm.product.quantity = vm.product.ordering_parameters.max\n        }\n\n        vm.calculatePrice()\n      }\n\n      vm.calculatePrice = () => {\n        const calculateParams = {\n          product_id: vm.product.id,\n          quantity: vm.product.quantity,\n        }\n\n        return Restangular.one('orders', vm.order.id)\n          .one('add_on')\n          .get(calculateParams)\n          .then(priceResponse => {\n            vm.product.unit_price = priceResponse.unit_price\n            vm.product.subtotal = priceResponse.subtotal\n          })\n      }\n\n      vm.confirmOrderAddOn = () => {\n        const addOnPayload = {\n          item_type: 'store_product',\n          order_by_weight: vm.product.order_by_weight,\n          quantity: vm.product.quantity,\n          store_product: {\n            href: vm.product.href,\n            id: vm.product.id,\n          },\n          allow_substitutions: false,\n          comment: '',\n          unit_price: vm.product.uom_price.price,\n          subtotal: vm.product.subtotal,\n          fulfillment_type: vm.order.fulfillment_type,\n        }\n\n        $scope.loading = true\n\n        return Restangular.one('orders', vm.order.id)\n          .one('add_on')\n          .customPUT(addOnPayload)\n          .then(_addOnResponse => {\n            $state\n              .go('main.account.orderHistory.order', {\n                id: vm.order.id,\n                message: lang.values.orderAddOn.successMessage,\n              })\n              .then(() => {\n                $scope.loading = false\n              })\n          })\n          .catch(() => {\n            $state\n              .go('main.account.orderHistory.order', {\n                id: vm.order.id,\n                error: lang.values.orderAddOn.errorMessage,\n              })\n              .then(() => {\n                $scope.loading = false\n              })\n          })\n      }\n\n      vm.calculatePrice()\n    }\n  )\n","import angular from 'angular'\nimport tokens from '@app/angular/services/modules/tokens'\nimport { concatProductTitle, getEnterpriseSaleEndDate } from '@app/utils/productHelpers'\nimport { product as ProductService } from '@instacart/enterprise-services'\nimport { LOGIN_CONTEXTS } from '@app/angular/constants/loginContexts'\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\nimport { isWaysToShopEnabled } from '@app/utils/isModuleEnabled'\n\nimport { SHOPPING_SELECTOR_STAGES } from '@app/angular/constants/shoppingSelectorStages'\nimport OrderAddOnConfirmModalController from '../orderAddOn/orderAddOnConfirmModalController'\nimport OrderAddOnConfirmModalTemplate from '../orderAddOn/orderAddOnConfirmModal.html'\n\n// The ext_data object displays data provided by the BE\n// This array can be used to hide certain keys\nconst EXCLUDED_EXT_DATA = ['max_in_cart', 'availability_score', 'retailer_reference_code']\n\nexport default angular\n  .module('ProductDetailsControllerModule', [OrderAddOnConfirmModalController.name])\n  .controller(\n    'ProductDetailsController',\n    function (\n      $filter,\n      $rootScope,\n      $scope,\n      $state,\n      $stateParams,\n      $timeout,\n      $uibModal,\n      $window,\n      Restangular,\n      addressList,\n      analytics,\n      auth,\n      cartAnalytics,\n      cartService,\n      config,\n      eComLightService,\n      facetedSearchService,\n      lang,\n      mobileService,\n      offersService,\n      oneCartService,\n      placement,\n      product,\n      productId,\n      registrationService,\n      reservationService,\n      shoppingSelectorService,\n      tagsService,\n      titleService,\n      userService,\n      utilService\n    ) {\n      const enableFacets = config.enableFacetedSearchFilters || config.enableICSearch\n      $scope.config = config\n      $scope.auth = auth\n      $scope.lang = lang\n      $scope.tagsService = tagsService\n      $scope.facetedSearchService = facetedSearchService\n      $scope.shoppingSelectorService = shoppingSelectorService\n      $scope.reservationService = reservationService\n      $scope.placement = placement\n      $scope.product = null\n      $scope.productOffer = null\n      $scope.priceAlertId = null\n      $scope.maxInCart = null\n      $scope.currentCategory = $stateParams.category_id\n      $scope.inEComLightMode = eComLightService.inEComLightMode\n      $scope.inOrderAddOnMode = $state.current.name === 'orderAddOn'\n      $scope.showEbtRibbon =\n        config.ebt?.enabled &&\n        oneCartService.enabled() &&\n        auth.user.store?.ebt_enabled_in_state &&\n        auth.user.status !== 'trial' &&\n        product.usa_snap_eligible\n      $scope.isWaysToShopEnabled = isWaysToShopEnabled()\n      $scope.productAtStore = true\n      $scope.totalConfigPrice = {\n        price: 0,\n      }\n      $scope.analyticScope = cartAnalytics.createNewAnalyticScope()\n      $scope.goToRoute = (...args) => {\n        if (!placement.isExternalRoutesDisabled) {\n          $state.go(...args)\n        }\n      }\n      $scope.$on('$destroy', () => {\n        cartAnalytics.destroyAnalyticScope($scope.analyticScope)\n      })\n\n      const picCfg = config.components.productImageCarousel\n      $scope.productImageCarousel = {\n        lang: {\n          rootAriaLabel: lang.aria.productImageCarousel,\n          screenReaderInstructions: lang.aria.productImageCarouselInstructions,\n          thumbnailAriaLabel: lang.aria.goToSlide,\n        },\n        zoomEnabled: picCfg.zoomEnabled,\n        images: [],\n      }\n\n      $scope.excludedExtData = EXCLUDED_EXT_DATA\n      // adjust sale and loyalty end date for IC catalog items due to logic\n      // between IC and Unata\n      product.sale_end_date = getEnterpriseSaleEndDate(product.sale_end_date, config)\n      product.loyalty_end_date = getEnterpriseSaleEndDate(product.loyalty_end_date, config)\n\n      // React related props for Add to Cart\n      $scope.addToCartStyles = {\n        buttonGroup: mobileService.isMobile\n          ? {\n              width: 'calc(100% - 40px)',\n              margin: '0 auto',\n            }\n          : {\n              width: 230,\n              margin: 0,\n            },\n      }\n\n      $scope.hasExtData = false\n      $scope.formattedDescription = ''\n      $scope.showMoreOpen = false\n\n      let descriptionTruncated = ''\n\n      $scope.getFormattedPrepTime = function () {\n        // Contains an array of lang keys and counts for lang.pluralize\n        const components = []\n\n        const hours = Math.floor($scope.product.product_config.lead_time / 60)\n        const remainderMinutes = $scope.product.product_config.lead_time % 60\n        const days = Math.floor(hours / 24)\n        const remainderHours = hours % 24\n\n        components.push({ key: 'day', count: days })\n        components.push({ key: 'hour', count: remainderHours })\n        components.push({ key: 'minute', count: remainderMinutes })\n\n        return components\n          .filter(c => c.count > 0)\n          .map(c => `${c.count} ${lang.pluralize(c.key, c.count)}`)\n          .join(' ')\n      }\n\n      // TODO: We need to refactor price alerts, this should not be necessary.\n      $rootScope.$on('priceAlertChange', (event, { priceAlert }) => {\n        $scope.product.price_alert = priceAlert\n      })\n\n      const barcodeScannerStateNames = ['main.scanBarcode', 'main.barcodeNotFound']\n\n      // If we are accessing product details in a modal, there will not be a product details view state.\n      $scope.isProductDetailsModal = $state.current.name !== 'main.product'\n\n      // load facets to ensure they are available to get the values\n      if (!$scope.isProductDetailsModal && enableFacets) {\n        facetedSearchService.getAllFacets($stateParams)\n      }\n\n      $scope.getTagName = tag => {\n        return enableFacets ? facetedSearchService.getTagName(tag) : tagsService.byVal(tag)?.name\n      }\n\n      $scope.showBackToScanner =\n        mobileService.isMobileApp() &&\n        barcodeScannerStateNames.indexOf($rootScope.previousState) !== -1\n\n      $scope.loadProductDetails = () => {\n        const setProduct = product => {\n          $scope.product = product\n          $scope.productAtStore = product.status === true\n          $scope.product.placement = $scope.placement.promoted\n          $scope.product.sponsoredBy = $scope.placement.source\n          // This check also exists in the add to cart button,\n          // but is required here to show the message\n          $scope.maxInCart = product?.ext_data?.max_in_cart ?? null\n\n          $scope.hasExtData = product?.ext_data ? Object.keys(product.ext_data)?.length > 0 : false\n\n          // The hack to end all hacks. Emergency CUS Launch Requirement\n          const SGW =\n            'Government Warning: (1) According to the Surgeon General, women should not drink alcoholic beverages during pregnancy because of the risk of birth defects. (2) Consumption of alcoholic beverages impairs your ability to drive a car or operate machinery, and may cause health problems.'\n          if (\n            (product.warnings === null || product.warnings === undefined) &&\n            product.is_alcoholic &&\n            config.client === 'cus'\n          ) {\n            $scope.product.warnings = SGW\n          }\n\n          if ($scope.product.offers) {\n            offersService.getOfferData($scope.product.offers[0].id).then(offerProgressData => {\n              $scope.offer = offerProgressData\n            })\n          }\n          const descriptionLimit = mobileService.isMobile\n            ? config.productDetailsDescription.mobileLimit\n            : config.productDetailsDescription.desktopLimit\n          $scope.isDescriptionLong = product.description?.length >= descriptionLimit\n\n          descriptionTruncated = $scope.isDescriptionLong\n            ? `${$scope.product.description.slice(0, descriptionLimit)}...`\n            : ''\n\n          // If the read more button hasn't been clicked for a long description, show the truncated version\n          $scope.formattedDescription =\n            !$scope.showMoreOpen && $scope.isDescriptionLong\n              ? descriptionTruncated\n              : $scope.product.description\n\n          if (product.offers) {\n            $scope.productOffers = [...product.offers, ...cartService.getAllCartTypeOffers()]\n          }\n\n          if (!$scope.isProductDetailsModal) {\n            $scope.title = titleService.setTitle(product.name)\n          }\n\n          if (!$rootScope.modifyingOrder) {\n            analytics.logCriteoProductDetailsPage({\n              item: product.ext_id,\n              price: product.sale_price || product.base_price,\n              availability: product.availability_status,\n            })\n\n            analytics.logSegmentEvent('store.view_product', {\n              ...analytics.getProductInfoAnalytics($scope.product, null),\n              ...analytics.getFeaturedProductImpression($scope.product.id),\n              source: $scope.location,\n            })\n\n            analytics.logProductDetailsView(product)\n          }\n\n          if ($stateParams.tab) {\n            $scope.tab = $stateParams.tab\n            // Wait till next tick before scrolling\n            $timeout($scope.scrollToTabs)\n          } else if (!$scope.inEComLightMode && !$scope.inOrderAddOnMode) {\n            $scope.tab = 'related'\n\n            $scope.relatedLoading = true\n            product\n              .all('related')\n              .getList({\n                require_storeproduct: !config.enableUnavailableProductPDP,\n                limit: 5,\n              })\n              .then(\n                response => {\n                  $scope.related = response.plain()\n                  $scope.relatedLoading = false\n                },\n                () => {\n                  $scope.related = []\n                  $scope.relatedLoading = false\n                }\n              )\n          } else if ($scope.product.ingredients) {\n            $scope.tab = 'ingredients'\n          } else if ($scope.product.instructions) {\n            $scope.tab = 'instructions'\n          } else if ($scope.product.nutrition) {\n            $scope.tab = 'nutrition'\n          }\n\n          if ($scope.inOrderAddOnMode) {\n            $scope.product.quantity = 1\n          }\n\n          $scope.productImageCarousel.images = [\n            ...[$scope.product.images],\n            ...$scope.product.additional_images,\n          ]\n            .slice(0, 6) // Only show a max of 6 thumbnails\n            .map((image, i) => {\n              return {\n                small: image.tile.small,\n                large: image.tile.large,\n                altText:\n                  $scope.product.additional_images.length > 0\n                    ? `${$scope.product.name}, ${lang.values.view} ${i + 1}`\n                    : $scope.product.name,\n              }\n            })\n\n          $scope.productTags = $scope.tagsService.getTagsMatchingConfigTags(\n            $scope.product.tags,\n            'pdp'\n          )\n        }\n\n        setProduct(product)\n      }\n\n      $scope.activateTab = function (tabValue) {\n        const newTab = $scope.tab !== tabValue\n        $scope.tab = tabValue\n        // a11y functionality so when keyboard/screen reader user selects an already open tab focus will go to the\n        // associated tab panel's content.\n        if (!newTab) {\n          document.getElementsByClassName('extras-content')[0]?.children[0]?.focus()\n        }\n      }\n\n      // ENT-37048: do not display \"Avg\" size on PDP if configured to display PricingDisclosure\n      $scope.productTitle = () =>\n        concatProductTitle($scope.product, lang, !config.showPricingDisclaimerOnPdp)\n\n      $scope.backToScanner = function () {\n        $state.go(barcodeScannerStateNames[0])\n      }\n\n      // Order Add-On functionality\n      $scope.orderAddOnIncrement = () => {\n        if ($scope.product.quantity >= $scope.product.ordering_parameters.max) {\n          $scope.product.quantity = $scope.product.ordering_parameters.max\n        } else {\n          // eslint-disable-next-line no-plusplus\n          $scope.product.quantity++\n        }\n      }\n\n      $scope.orderAddOnDecrement = () => {\n        // eslint-disable-next-line no-plusplus\n        if ($scope.product.quantity > 0) $scope.product.quantity--\n      }\n\n      $scope.orderAddOnUpdate = () => {\n        if ($scope.product.quantity >= $scope.product.ordering_parameters.max) {\n          $scope.product.quantity = $scope.product.ordering_parameters.max\n        }\n      }\n\n      $scope.orderAddOnSubmit = product => {\n        const modalOpen = function () {\n          return $uibModal.open({\n            template: OrderAddOnConfirmModalTemplate,\n            controller: 'OrderAddOnConfirmModalController',\n            resolve: {\n              product,\n            },\n            backdrop: 'static',\n            controllerAs: '$ctrl',\n          }).result\n        }\n\n        modalOpen()\n      }\n\n      $scope.hasLoyaltyCard = () => userService.loyaltyCards.length > 0\n\n      $scope.hasLoyaltyPrice = () => $scope.product.loyalty_price && config.enableLoyaltyPricing\n\n      $scope.hasSalePrice = () => $scope.product.sale_price && !$scope.hasLoyaltyPrice()\n\n      $scope.showOfferRibbon = () => {\n        return (\n          config.showOfferRibbonOnPdp &&\n          $scope.product.offer_title &&\n          $scope.product.offer_title.length > 0\n        )\n      }\n\n      $scope.openTermsOfUse = () => {\n        if (!config.userReviews.termsOfUseUrl) {\n          return\n        }\n\n        $window.open(\n          config.userReviews.termsOfUseUrl,\n          mobileService.isMobileApp() ? '_system' : '_blank'\n        )\n      }\n\n      $scope.openPDP = () => {\n        $state.go('main.product', {\n          id: $scope.product.id,\n          name: $filter('slugify')($scope.product.name),\n          placement: $scope.placement,\n          tab: 'reviews',\n        })\n      }\n\n      $scope.openLogin = () => {\n        registrationService.open(\n          'login',\n          null,\n          null,\n          null,\n          null,\n          null,\n          LOGIN_CONTEXTS.PRODUCT_USER_REVIEW\n        )\n      }\n\n      $scope.scrollToTabs = () => {\n        const el = document.querySelector('#product-details-extras')\n\n        if (!el) {\n          return\n        }\n\n        utilService.scrollIntoView(el, $scope.isModal && '.modal-content')\n      }\n\n      $scope.openAndScrollToTab = tab => {\n        $scope.activateTab(tab)\n        $scope.scrollToTabs()\n      }\n\n      $scope.showMoreDescription = () => {\n        $scope.formattedDescription = !$scope.showMoreOpen\n          ? $scope.product.description\n          : descriptionTruncated\n        $scope.showMoreOpen = !$scope.showMoreOpen\n      }\n\n      $scope.reviewsUserData = {\n        id: auth.user.id,\n        name: auth.getUserFullName(),\n        location: addressList.getAddressRegionString(addressList.getDefault()),\n        isTrial: auth.user.status === 'trial',\n      }\n\n      if (!$scope.product) {\n        $scope.loadProductDetails()\n      }\n\n      $scope.priceStyles = {\n        root: { fontSize: tokens.size.font.body },\n        amount: { fontSize: tokens.size.font.h3 },\n      }\n\n      $scope.isProductAvailable = ProductService.utils.isProductAvailable($scope.product)\n      $scope.shopContextIntent = auth.getContext().intent\n      $scope.SHOPPING_MODES = SHOPPING_MODES\n\n      $scope.showPricingPromos =\n        !$scope.product.product_config ||\n        $scope.product.product_config.config_type !== 'custom' ||\n        $scope.product.product_config.has_pricing === false\n\n      $scope.openStoreSelectorModal = () =>\n        shoppingSelectorService.open(SHOPPING_SELECTOR_STAGES.STORE_SELECTOR)\n    }\n  )\n  .run($templateCache => {\n    $templateCache.put(\n      'productDetailsMainContent.html',\n      require('./productDetailsMainContent.html')\n    )\n    $templateCache.put(\n      'productDetailsDescription.html',\n      require('./productDetailsDescription.html')\n    )\n    $templateCache.put('productDetailsPrice.html', require('./productDetailsPrice.html'))\n    $templateCache.put('productDetailsTabs.html', require('./productDetailsTabs.html'))\n  })\n","import _ from 'lodash'\n// Sets an \"invalid\" classname to the label of an invalid input\nimport angular from 'angular'\nimport template from './configurableProduct.directive.html'\n\nexport default angular\n  .module('ConfigurableProductModule', [])\n  .directive(\n    'configurableProduct',\n    function (\n      $rootScope,\n      auth,\n      config,\n      configurableProductService,\n      lang,\n      mobileService,\n      reservationService\n    ) {\n      return {\n        restrict: 'EA',\n        scope: {\n          configType: '@',\n          product: '=',\n          updateConfigTotalPrice: '=',\n          location: '@',\n          locationValue: '<',\n        },\n        template: template,\n        link: function (scope, elem, attrs) {\n          const initStep = 3\n          const initStepMultiple = 5\n          const limitStep = 20\n          const previousSelect = {}\n          let configsPrice = 0\n          const configBasePrice = scope.product.sale_price || scope.product.base_price\n\n          scope.lang = lang\n          scope.config = config\n          scope.auth = auth\n          scope.allSelectedConfigurations = []\n          scope.selectedItems = {}\n          scope.selectedMap = {}\n          scope.uploaded = { file: null }\n          scope.configurableProductService = configurableProductService\n          scope.mobileService = mobileService\n\n          // Set base option to top of options if present\n          if (scope.product.product_config && scope.product.product_config.has_pricing) {\n            scope.product.product_config.options = _.sortBy(\n              scope.product.product_config.options,\n              option => {\n                return option.type === 'base_selection' ? 0 : 1\n              }\n            )\n          }\n\n          // Hijacks radio functionality to allow deselect if currently selected for optional params\n          // Debated using checkbox with limit checking, but it would have amounted to the same type of logic\n          // But with more overhead in data manipulation between array vs object for single vs multi param\n          scope.selectSingleParamItem = function (option, item) {\n            if (!option.mandatory) {\n              if (_.isEqual(previousSelect[option.id], item)) {\n                delete option.selected\n                delete previousSelect[option.id]\n              } else {\n                previousSelect[option.id] = angular.copy(item)\n              }\n            }\n\n            scope.consolidateSelectedOptions()\n          }\n\n          // See more button\n          scope.limit = _.map(scope.product.product_config.options, () => {\n            return initStep\n          })\n\n          scope.multipleLimit = _.map(scope.product.product_config.options, () => {\n            return initStepMultiple\n          })\n\n          // Ensures that limitTo for \"See More\" button is not occluding a single option. If only a single option is hidden, show it\n          scope.limitToMoreThanOne = function (optionLength, optionLimitByIndex) {\n            return optionLength - optionLimitByIndex > 1 ? optionLimitByIndex : optionLength\n          }\n\n          scope.incrementOptions = function (index) {\n            scope.limit[index] += limitStep\n          }\n\n          scope.incrementOptionsMultiple = function (index) {\n            scope.multipleLimit[index] += limitStep\n          }\n\n          scope.consolidateSelectedOptions = function () {\n            const extractSelectedConfigurations = []\n            configsPrice = 0\n\n            _.each(scope.product.product_config.options, option => {\n              // Checks that all options are valid, add `invalid` property if invalid\n              configurableProductService.validateSingle(option)\n              if (option.type === 'single_selection' && option.selected) {\n                extractSelectedConfigurations.push({\n                  id: option.id,\n                  option_name: option.name,\n                  item: {\n                    id: option.selected.id,\n                    name: option.selected.name,\n                    price: option.selected.price,\n                  },\n                })\n\n                if (option.selected.price) {\n                  configsPrice += option.selected.price\n                }\n              } else if (option.type === 'base_selection' && option.selected) {\n                extractSelectedConfigurations.push({\n                  id: option.id,\n                  option_name: option.name,\n                  base: {\n                    id: option.selected.id,\n                    name: option.selected.name,\n                    price: option.selected.price,\n                  },\n                })\n\n                if (option.selected.price) {\n                  configsPrice += option.selected.price\n                }\n              } else if (option.type === 'multiple_selection' && option.selected) {\n                extractSelectedConfigurations.push({\n                  id: option.id,\n                  option_name: option.name,\n                  items: option.selected.items,\n                })\n\n                _.each(option.selected.items, item => {\n                  if (item.price) {\n                    configsPrice += item.price\n                  }\n                })\n              } else if (\n                (option.type === 'text' || option.type === 'text_field') &&\n                option.selected\n              ) {\n                extractSelectedConfigurations.push({\n                  id: option.id,\n                  text: option.selected,\n                  option_name: option.name,\n                  price: option.price,\n                })\n\n                if (option.price) {\n                  configsPrice += option.price\n                }\n              } else if (\n                option.type === 'file' &&\n                scope.uploaded.file &&\n                scope.uploaded.file.success === true\n              ) {\n                extractSelectedConfigurations.push({\n                  id: option.id,\n                  option_name: option.name,\n                  price: option.price,\n                  file: {\n                    id: scope.uploaded.file.id,\n                    name: scope.uploaded.file.name,\n                    url: scope.uploaded.file.url,\n                  },\n                })\n\n                if (option.price) {\n                  configsPrice += option.price\n                }\n              }\n            })\n\n            scope.allSelectedConfigurations = extractSelectedConfigurations\n            $rootScope.$broadcast('configurableProduct', scope.allSelectedConfigurations)\n            scope.totalPrice = configBasePrice + configsPrice\n            scope.updateConfigTotalPrice = scope.totalPrice\n          }\n\n          scope.selectMultiParamItem = function (option, item, productOptionIndex) {\n            const itemIndex = _.findIndex(\n              scope.selectedItems[option.id].items,\n              selectedItemsItem => {\n                return selectedItemsItem.id == item.id\n              }\n            )\n\n            if (itemIndex !== -1) {\n              scope.selectedItems[option.id].items.splice(itemIndex, 1)\n            } else {\n              scope.selectedItems[option.id].items.push({\n                id: item.id,\n                name: item.name,\n                price: item.price,\n              })\n            }\n\n            if (scope.selectedItems[option.id].items.length > 0) {\n              scope.selectedItems[option.id].items = _.sortBy(\n                scope.selectedItems[option.id].items,\n                'id'\n              )\n              option.selected = angular.copy(scope.selectedItems[option.id])\n            } else {\n              delete option.selected\n            }\n\n            scope.consolidateSelectedOptions()\n          }\n\n          // Initializes default selections\n          _.each(scope.product.product_config.options, option => {\n            if (option.type === 'multiple_selection') {\n              scope.selectedItems[option.id] = {\n                id: option.id,\n                items: [],\n              }\n            }\n\n            _.each(option.items, (optionItem, index) => {\n              if (optionItem.default === true) {\n                option.selected = optionItem\n\n                // Moves default item to beginning of array so it is not hidden by \"See More\"\n                option.items.splice(index, 1)\n                option.items.unshift(optionItem)\n\n                if (!option.mandatory) {\n                  previousSelect[option.id] = angular.copy(optionItem)\n                }\n\n                if (option.type === 'multiple_selection') {\n                  //Leverage the function that the template uses to handle selecting a multi param item, for the default\n                  scope.selectMultiParamItem(option, optionItem)\n                  //HTML template binds the multiple selection inputs to the selectedMap object for UI selection indicator, so it needs to be initialized\n                  scope.selectedMap[`${option.id}-${optionItem.id}`] = true\n                }\n              }\n            })\n          })\n\n          // The prices that are shown in the base selection option are a combination of the config base price and the base selection price\n          // for the corresponding item. For instance, if the configBasePrice was $5.00, the base selction prices might be: small 0, medium 3, and large 5\n          // to give you the displayed options of $5 small, $8 medium and $10 large\n          scope.displayBaseSelectionTotalPrice = baseSelectionPrice => {\n            return configBasePrice + baseSelectionPrice\n          }\n          scope.$watch('uploaded.file', (newVal, oldVal) => {\n            if (!_.isEqual(newVal, oldVal)) {\n              scope.consolidateSelectedOptions()\n            }\n          })\n\n          scope.consolidateSelectedOptions()\n        },\n      }\n    }\n  )\n","import _ from 'lodash'\nimport fp from 'lodash/fp'\nimport angular from 'angular'\n\nexport default angular\n  .module('ConfigurableProductServiceModule', [])\n  .service('configurableProductService', function configurableProductService() {\n    const service = this\n\n    // Finds default parameters for single param configs\n    service.findDefault = optionItems => optionItems.find(optionItem => optionItem.default === true)\n\n    // Maps API `product_config` data structure into necessary structure for cart to do comparison for duplicates\n    // If no inboundConfiguration is defined, looks for default value based on `product_config`\n    service.formatConfigForCart = function (product, inboundConfiguration) {\n      let formattedConfiguration\n      let selectedConfiguration\n\n      // single param inboundConfigurations are objects, but it needs to be a formatted array of an object that includes the id of the parent option\n      if (product.product_config && product.product_config.config_type === 'prep_style') {\n        if (inboundConfiguration) {\n          selectedConfiguration =\n            Array.isArray(inboundConfiguration) && inboundConfiguration.length > 0\n              ? inboundConfiguration[0].base || inboundConfiguration[0].item\n              : inboundConfiguration\n        }\n\n        if (product.product_config.options.length > 0) {\n          // Get default option\n          selectedConfiguration =\n            selectedConfiguration || service.findDefault(product.product_config.options[0].items)\n        } else {\n          // Return null when no inboundConfiguration or config options\n          return null\n        }\n\n        const selectionType =\n          product.product_config.options[0].type === 'base_selection' ? 'base' : 'item'\n\n        formattedConfiguration = [\n          {\n            id: product.product_config.options[0].id,\n            option_name: product.product_config.options[0].name,\n            name:\n              Array.isArray(selectedConfiguration) && selectedConfiguration.length > 0\n                ? selectedConfiguration[0].name\n                : selectedConfiguration?.name,\n            status: product.product_config.options[0].status,\n          },\n        ]\n\n        formattedConfiguration[0][selectionType] = {\n          id: selectedConfiguration.id,\n          name: selectedConfiguration.name,\n          status: selectedConfiguration.status,\n          ...(selectedConfiguration?.default && {\n            default: selectedConfiguration?.default,\n          }),\n        }\n\n        return formattedConfiguration\n      }\n      if (inboundConfiguration) {\n        // return inboundConfiguration as-is if not prep_style\n        return inboundConfiguration.options ? inboundConfiguration.options : inboundConfiguration\n      }\n      // return null if no inboundConfiguration\n      return null\n    }\n\n    const parseOutNilProps = obj => JSON.parse(angular.toJson(_.omitBy(obj, _.isNil)))\n    const sanitizeConfig = obj => _.omit(parseOutNilProps(obj), 'status')\n\n    // Ensures that all $$hashkeys from Angular and `null` values are stripped. Forces config to be an array (requirement for areProductConfigsAndOptionsEqual utility method)\n    service.formatConfigForComparison = function (inboundConfiguration) {\n      // _.map ensures inboundConfiguration is never null, which is important because we must always return an array (even empty)\n      return _.map(inboundConfiguration, itemConfig => {\n        if (itemConfig.item) {\n          itemConfig.item = sanitizeConfig(itemConfig.item)\n        }\n        if (itemConfig.base) {\n          itemConfig.base = sanitizeConfig(itemConfig.base)\n        }\n        return sanitizeConfig(itemConfig)\n      })\n    }\n\n    // Validates that configurables do not exceed maximum allowable values\n    service.validateSingle = function (option) {\n      if (option.mandatory === true && !_.has(option, 'selected')) {\n        option.invalid = {\n          name: option.name,\n          reason: 'Required',\n        }\n        return false\n      }\n      delete option.invalid\n\n      if (\n        option.type === 'multiple_selection' &&\n        option.selected &&\n        option.maximum_selection &&\n        option.selected.items &&\n        option.selected.items.length > option.maximum_selection\n      ) {\n        option.invalid = {\n          name: option.name,\n          reason: `Exceeded maximum: ${option.maximum_selection}`,\n        }\n        return false\n      }\n      delete option.invalid\n\n      if (\n        (option.type === 'text' || option.type === 'text_field') &&\n        option.selected &&\n        option.max_length &&\n        option.selected.length > option.max_length\n      ) {\n        option.invalid = {\n          name: option.name,\n          reason: `Exceeded character limit: ${option.max_length}`,\n        }\n        return false\n      }\n      delete option.invalid\n    }\n\n    // Checks all options to see if anything is invalid\n    service.validateAll = function (options) {\n      const invalidOptionsString = []\n\n      _.each(options, option => {\n        if (option.invalid) {\n          invalidOptionsString.push(`${option.invalid.name} (${option.invalid.reason})`)\n        }\n      })\n\n      if (invalidOptionsString.length > 0) {\n        return invalidOptionsString.join(', ')\n      }\n      return true\n    }\n\n    // Creates a comma-delimited string for all configurations\n    service.configsString = function (product, allowHTML) {\n      const configsArray = []\n      const { options: storeProdOptions } =\n        (product.store_product && product.store_product.product_config) || {}\n      const { options: storeOptions } = product.product_config || {}\n\n      _.each(storeProdOptions, availableOption => {\n        _.each(storeOptions, selectedOption => {\n          if (availableOption.id === selectedOption.id) {\n            if (availableOption.type === 'single_selection') {\n              configsArray.push(`${availableOption.name}: ${selectedOption.item.name}`)\n            } else if (availableOption.type === 'base_selection') {\n              configsArray.push(`${availableOption.name}: ${selectedOption.base.name}`)\n            } else if (availableOption.type === 'text' || availableOption.type === 'text_field') {\n              // eslint-disable-next-line no-useless-concat\n              configsArray.push(`${availableOption.name}: ` + `\"${selectedOption.text}\"`)\n            } else if (availableOption.type === 'multiple_selection') {\n              let multipleString\n              const multipleItemArray = []\n\n              multipleString = `${availableOption.name}: `\n\n              _.each(selectedOption.items, item => {\n                multipleItemArray.push(item.name)\n              })\n\n              configsArray.push((multipleString += multipleItemArray.join(', ')))\n            } else if (availableOption.type === 'file') {\n              if (allowHTML) {\n                configsArray.push(\n                  `${availableOption.name}: ` +\n                    `<light-box image-url=\"'${selectedOption.file.url}'\" image-name=\"'${selectedOption.file.name}'\"></light-box>`\n                )\n              } else {\n                configsArray.push(`${availableOption.name}: ${selectedOption.file.name}`)\n              }\n            }\n          }\n        })\n      })\n\n      return configsArray.join('\\n')\n    }\n\n    service.areProductConfigsAndOptionsEqual = (x, y) => {\n      if (x.constructor !== Array || y.constructor !== Array) {\n        return false\n      }\n\n      const smallerArray = x.length > y.length ? y : x\n      const largerArray = x.length > y.length ? x : y\n\n      const cmp = (a, b) => {\n        // Rely on lodash equality behaviour in the default case\n        if (_.isEqual(a, b)) {\n          return true\n        }\n\n        // Fall back to comparing the option and option item IDs. This\n        // is somewhat fragile, but currently necessary for options with\n        // the \"custom\" type.\n        if (a.items && b.items) {\n          const aItemIDs = new Set(a.items.map(i => i.id))\n          const bItemIDs = new Set(b.items.map(i => i.id))\n\n          // Ensure that the selected option items match between the two products,\n          // ignoring the order they're provided in.\n          return (\n            a.id === b.id &&\n            aItemIDs.size === bItemIDs.size &&\n            [...aItemIDs].every(itemID => bItemIDs.has(itemID))\n          )\n        }\n        if (a.item && b.item) {\n          // option_type SINGLE\n          return a.id === b.id && a.item.id === b.item.id\n        }\n\n        return false\n      }\n\n      const arrayDiff = fp.flow(fp.differenceWith(smallerArray, cmp), fp.isEmpty)(largerArray)\n\n      return arrayDiff.length > 0\n    }\n\n    // Checks if configurations are equal, both params should be `options` array\n    service.isConfigEqual = function (existingConfiguration, inboundConfiguration) {\n      const sanitizedExistingConfiguration = service.formatConfigForComparison(\n        existingConfiguration\n      )\n      const sanitizedInboundConfiguration = service.formatConfigForComparison(inboundConfiguration)\n      return service.areProductConfigsAndOptionsEqual(\n        sanitizedExistingConfiguration,\n        sanitizedInboundConfiguration\n      )\n    }\n\n    // Creates a unique config string for a particular \"to-be-purchased\" (i.e. in the cart/list) configurable product\n    service.generateConfigIdString = product => {\n      const storeProductConfigData =\n        (product && product.store_product && product.store_product.product_config) || null\n      const selectedProductConfig = (product && product.product_config) || null\n\n      if (storeProductConfigData && selectedProductConfig) {\n        // Each option is delimited by a semi-colon\n        return selectedProductConfig.options\n          .map(selectedOption => {\n            const optionMetadata = _.find(storeProductConfigData.options, { id: selectedOption.id })\n\n            // If the status if false for the option or item (i.e. \"optionMetadata\") then many of the informational fields will be null\n            // Hence we just return empty string to mitigate printing out null as a string!\n            if (\n              !optionMetadata ||\n              selectedOption.status === false ||\n              optionMetadata.status === false\n            ) {\n              return null\n            }\n\n            switch (optionMetadata.type) {\n              case 'single_selection':\n                return `${selectedOption.item.id}`\n              case 'base_selection':\n                return `${selectedOption.base.id}`\n              case 'multiple_selection':\n                return selectedOption.items.map(item => item.id).join(',')\n              case 'text': // ⤓ (Fall through)\n              case 'text_field':\n                return `${selectedOption.text}`\n              default:\n                return null\n            }\n          })\n          .filter(id => id !== null)\n          .join(';')\n      }\n      // Return an empty string if there is no product_config\n      return ''\n    }\n  })\n","import angular from 'angular'\nimport dropdownTemplate from './configurableProductDropdown.html'\n\nexport default angular\n  .module('ConfigurableProductDropdownModule', [])\n  .directive(\n    'configurableProductDropdown',\n    function (\n      $compile,\n      $document,\n      $state,\n      $templateCache,\n      $timeout,\n      $window,\n      auth,\n      list,\n      mobileService,\n      productDetailsModal\n    ) {\n      return {\n        scope: {\n          product: '=',\n          plain: '=',\n          existingConfig: '=',\n          aggregateQuantity: '=',\n          location: '@',\n        },\n        replace: true,\n        template: dropdownTemplate,\n        controller($scope, $element, $attrs, lang) {\n          $scope.auth = auth\n          $scope.lang = lang\n        },\n        link(scope, element) {\n          const customUpsell = 'Custom Upsell'\n          const customUpsellClass = 'custom-upsell'\n          const template = mobileService.isMobile\n            ? $templateCache.get('configurableProductDropdown.mobile.html')\n            : $templateCache.get('configurableProductDropdown.desktop.html')\n          let popover\n          let timeout\n\n          scope.mobileService = mobileService\n          scope.isDropdownVisible = scope.location === customUpsell ? 'hidden' : 'visible'\n\n          // eslint-disable-next-line no-restricted-globals\n          top.scope = scope\n\n          element.on('click', e => {\n            e.stopPropagation()\n          })\n\n          scope.$on('$stateChangeStart', () => {\n            if (popover) {\n              scope.hidePopover()\n            }\n          })\n\n          scope.hidePopover = function () {\n            popover.off('mouseleave')\n            $document.off('click')\n            popover.remove()\n          }\n\n          const getElementOffset = el => {\n            const rect = el.getBoundingClientRect()\n            return {\n              top: rect.top + window.pageYOffset,\n              left: rect.left + window.pageXOffset,\n              bottom: rect.bottom,\n              height: rect.height,\n              right: rect.right,\n              width: rect.left,\n              x: rect.left + window.pageXOffset,\n              y: rect.top + window.pageYOffset,\n            }\n          }\n\n          scope.showPopover = function () {\n            const el =\n              scope.location === customUpsell\n                ? document.getElementsByClassName(customUpsellClass)[0]\n                : $document[0].body\n            const body = angular.element(el)\n            const elemPos = element[0].getBoundingClientRect()\n            const topOffset = $document[0].documentElement.scrollTop || $document[0].body.scrollTop\n\n            popover = $compile(template)(scope)\n            body.append(popover)\n            $timeout(() => {\n              // Wait for rendering to finish\n              const arrowHeight = 8\n              const popoverWidth = popover[0].offsetWidth\n              const popoverHeight = popover[0].offsetHeight\n              let inlineStyles = {}\n              let popoverClass = ''\n\n              if (!mobileService.isMobile) {\n                const offSetPostiion = getElementOffset(element[0])\n                inlineStyles = {\n                  top: `${elemPos.bottom + topOffset}px`,\n                  left: `${offSetPostiion.left - (popoverWidth - elemPos.width) / 2}px`,\n                }\n\n                // If the popover cannot fit below, show it on top\n                if (\n                  elemPos.top + popoverHeight >\n                  $window.innerHeight - elemPos.height - arrowHeight\n                ) {\n                  inlineStyles.top = `${elemPos.top - popoverHeight - arrowHeight + topOffset}px`\n                  popoverClass = 'top'\n                } else {\n                  popoverClass = 'bottom'\n                }\n\n                popover.addClass(popoverClass)\n              }\n\n              inlineStyles.visibility = 'visible'\n\n              popover.css(inlineStyles).on('click', e => {\n                e.stopPropagation()\n              })\n\n              if (!mobileService.isMobile) {\n                popover.on('mouseenter', () => {\n                  $timeout.cancel(timeout)\n                })\n\n                popover.on('mouseleave', () => {\n                  scope.hideDelay(400)\n                })\n              }\n\n              $document.on('click', () => {\n                scope.hideDelay(0)\n                scope.$apply()\n              })\n            }, 0)\n          }\n\n          scope.hideDelay = function (delay) {\n            $timeout.cancel(timeout)\n            timeout = $timeout(() => {\n              scope.toggle = false\n              scope.hidePopover()\n            }, delay)\n          }\n\n          scope.togglePopover = function () {\n            scope.toggle = !scope.toggle\n\n            if (!scope.toggle) {\n              scope.hidePopover()\n            } else if (scope.toggle) {\n              scope.showPopover()\n            }\n          }\n\n          scope.linkToProductDetails = productId => {\n            productDetailsModal.open(productId, { location: scope.location })\n            scope.hidePopover()\n          }\n        },\n      }\n    }\n  )\n  .run($templateCache => {\n    $templateCache.put(\n      'configurableProductDropdown.mobile.html',\n      require('./configurableProductDropdown.mobile.html')\n    )\n    $templateCache.put(\n      'configurableProductDropdown.desktop.html',\n      require('./configurableProductDropdown.desktop.html')\n    )\n  })\n","import angular from 'angular'\n\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\nimport appendMetaTagDescription from '@app/utils/appendMetaTagDescription'\n\nimport { appendProductStruturedData } from '@app/utils/appendStructuredData'\nimport { deleteJsonLd } from '@app/utils/jsonLd'\nimport template from './productDetails.html'\nimport ProductDetailsControllerModule from './productDetailsController'\nimport ConfigurableProductDirectiveModule from './configurableProduct/configurableProduct.directive'\nimport ConfigurableProductServiceModule from './configurableProduct/configurableProduct.service'\nimport ConfigurableProductDropdownModule from './configurableProduct/configurableProductDropdown'\n\nexport default angular\n  .module('ProductDetailsComponentModule', [\n    ProductDetailsControllerModule.name,\n    ConfigurableProductDirectiveModule.name,\n    ConfigurableProductServiceModule.name,\n    ConfigurableProductDropdownModule.name,\n  ])\n  .config(($stateProvider, langProvider) => {\n    $stateProvider.state('main.product', {\n      url: '/product/{id}/{name}?tab',\n      views: {\n        'content@': {\n          template,\n          controller: 'ProductDetailsController',\n        },\n      },\n      params: {\n        // If a name/slug is null for any reason, simply ignore it rather than 404\n        name: { squash: true, value: null },\n        placement: {},\n      },\n      resolve: {\n        productId: $stateParams => {\n          return $stateParams.id\n        },\n        placement: $stateParams => $stateParams.placement,\n        product: ($state, config, productId, Restangular) => {\n          return Restangular.one('store_products', productId)\n            .get({ require_storeproduct: !config.enableUnavailableProductPDP })\n            .catch(response => {\n              if (response.status === 404) {\n                $state.go('main.404')\n              }\n            })\n        },\n\n        tree: (auth, config, eComLightService, product) => {\n          const ecomLightCategoryID = config.eComLight?.homeRedirect?.params?.category_id\n\n          /**\n           * If the retailer has ecomLight enabled and the user is accessing a subcategory of ecomlight,\n           * set ecomlight mode to true\n           */\n          if (\n            config.eComLight?.enabled &&\n            config.isDedicatedCateringExperienceSupported &&\n            ecomLightCategoryID &&\n            !eComLightService.inEComLightMode &&\n            product.categories.find(category => category.id === ecomLightCategoryID)\n          ) {\n            eComLightService.setMode(true)\n            return auth.setIntent(SHOPPING_MODES.CATERING)\n          }\n        },\n      },\n      onEnter: product => {\n        appendProductStruturedData(product, langProvider.values.clientName)\n        appendMetaTagDescription(product.description)\n      },\n      onExit: () => {\n        deleteJsonLd()\n      },\n    })\n  })\n","import angular from 'angular'\nimport ProductDetails from './productDetailsRoutes.js'\n\nexport default angular.module('app.component.productDetailsModule', [ProductDetails.name])\n","export default tag => {\n  if (!tag) return\n\n  let styles = {}\n  const iconClass = `tag-icon icon-${tag.icon}`\n\n  // because the default value for circle is assumed to be true, we need to check if the\n  // config value has been explicitly set to false\n  if (tag.circle === false) {\n    styles = { icon: { color: `${tag.color} !important` } }\n  } else {\n    styles = { icon: { backgroundColor: `${tag.color} !important` } }\n  }\n  if (tag.fontSize) {\n    styles.icon.fontSize = `${tag.fontSize} !important`\n  }\n\n  return { styles, iconClass }\n}\n","import _ from 'lodash'\nimport angular from 'angular'\nimport tagHelper from '@app/angular/reactComponents/checkbox/tagHelper'\n\nexport default angular\n  .module('RecipeCategoriesService', [])\n\n  .service(\n    'recipeCategoriesService',\n    function recipeCategoriesService($q, Restangular, auth, tagsService) {\n      const service = this\n\n      service.categories = []\n      service.tags = []\n\n      const buildTag = tag => {\n        const configTags = tagsService.tags()\n        const matchedTag = configTags.find(ctag => ctag.id === tag.tag_name)\n        const tagFixes = tagHelper(matchedTag)\n        return { ...matchedTag, ...tagFixes }\n      }\n\n      service.fetch = (refresh = false) => {\n        const deferred = $q.defer()\n\n        if (!refresh && service.categories.length && service.tags.length) {\n          // Categories have been loaded, send them back without calling API\n          deferred.resolve(service)\n        } else {\n          return $q\n            .all({\n              categories: Restangular.all('recipe_categories').getList({\n                store_id: auth.user.store.id,\n              }),\n              recipeTags: Restangular.one('recipes').one('tags').get(),\n            })\n            .then(({ categories, recipeTags }) => {\n              service.categories = categories.plain()\n              service.tags = recipeTags.tags\n                .map(tag => buildTag(tag))\n                .filter(tag => Object.keys(tag).length)\n              // Mutate categories objects in array by adding tree data props (children, department, etc.)\n              _.each(service.categories, category => {\n                category.parents = service.getParents(category)\n                category.department = category.parents[0]\n                category.children = service.getChildren(category)\n                category.state = 'main.shop.recipes.category'\n                category.params = { recipe_category_id: category.id }\n\n                // If a category is missing an image, use their parent category's corresponding image\n                if (category.images) {\n                  // eslint-disable-next-line no-restricted-syntax\n                  for (const image in category.images) {\n                    if (!category.images[image] && category.parents) {\n                      const parentCategoryWithImage = _.find(\n                        category.parents,\n                        parentCategory => parentCategory.images && parentCategory.images[image]\n                      )\n                      if (parentCategoryWithImage) {\n                        category.images[image] = parentCategoryWithImage.images[image]\n                      }\n                    }\n                  }\n                }\n              })\n              deferred.resolve(service)\n              return service\n            })\n        }\n\n        return deferred.promise\n      }\n\n      service.searchCategories = ({ search_term, recipe_category_id, tags }) => {\n        return Restangular.all('recipe_categories').all('search').getList({\n          search_term,\n          recipe_category_id,\n          tags,\n        })\n      }\n\n      service.rootCategories = () => service.categories.filter(category => !category.parent_id)\n\n      service.getCategoryFromId = id => {\n        const categoryFromId =\n          // eslint-disable-next-line eqeqeq\n          id && _.find(service.categories, serviceCategory => serviceCategory.id == id)\n        return (\n          categoryFromId || {\n            level: null,\n            // tags: service.tags,\n            children: service.rootCategories(),\n          }\n        )\n      }\n\n      service.getParents = category => {\n        const parent =\n          category &&\n          _.find(service.categories, potentialParent => potentialParent.id === category.parent_id)\n        return parent ? [...service.getParents(parent), parent] : []\n      }\n\n      service.getSiblings = category =>\n        category\n          ? service.categories.filter(\n              serviceCategory => serviceCategory.parent_id === category.parent_id\n            )\n          : []\n\n      service.getChildren = category =>\n        category\n          ? service.categories.filter(serviceCategory => serviceCategory.parent_id === category.id)\n          : []\n    }\n  )\n","import angular from 'angular'\nimport template from './recipeDetailsModal.html'\nimport RecipeDetailsController from './recipeDetailsController'\n\nexport default angular\n  .module('RecipeDetailsModal', [RecipeDetailsController.name])\n\n  .service(\n    'recipeDetailsModal',\n    function recipeDetailsModal($uibModal, legacyModalService, uibModalAriaLabelService) {\n      const service = this\n\n      service.open = recipeId => {\n        legacyModalService.closeOpenModals()\n        $uibModal.open({\n          template,\n          controller: 'RecipeDetailsController',\n          controllerAs: 'recipeDetails',\n          resolve: {\n            ariaLabel: () => {\n              uibModalAriaLabelService.setLabel('Recipe Details')\n            },\n            recipe($stateParams, Restangular) {\n              return Restangular.one('recipes', recipeId).get()\n            },\n            savedRecipes(savedRecipesService) {\n              return savedRecipesService.getSavedRecipes().then(savedRecipesList => {\n                return savedRecipesList\n              })\n            },\n          },\n          data: {\n            setPageTitleAndBreadcrumbs: false,\n          },\n        })\n      }\n    }\n  )\n","import angular from 'angular'\n\nexport default angular.module('RecipeIngredientsModule', []).component('recipeIngredients', {\n  bindings: {\n    ingredients: '<',\n    ingredientServings: '<?', // only needed for mobile layout\n  },\n  controller(mobileService) {\n    this.isMobile = mobileService.isMobile\n  },\n  template: `\n      <section class=\"recipe-ingredients\">\n\n        <div ng-if=\":: !$ctrl.isMobile\">\n          <h2 class=\"recipe-ingredients-title title-cell\">Ingredients</h2>\n        </div>\n\n        <div ng-if=\"::($ctrl.isMobile && $ctrl.ingredientServings)\" class=\"recipe-mobile-servings\">\n          <span class=\"recipe-mobile-servings-icon icon-servings\" aria-hidden=\"true\"></span>\n          <span class=\"recipe-mobile-servings-text\">Servings:\n            <span>\n              {{::$ctrl.ingredientServings}}\n            </span>\n          </span>\n        </div>\n\n        <ul>\n          <li ng-repeat=\"ingredient in ::$ctrl.ingredients track by $index\">\n            {{::ingredient}}\n          </li>\n        </ul>\n\n      </section>\n    `,\n})\n","import angular from 'angular'\n\nexport default angular.module('RecipeMetaModule', []).component('recipeMeta', {\n  bindings: {\n    prepInfo: '<',\n    isSaved: '=?',\n    recipe: '<?',\n    savedCount: '<?',\n  },\n  controller($rootScope, config, lang, mobileService, savedRecipesService) {\n    const vm = this\n    vm.config = config\n    vm.lang = lang\n    vm.isMobile = mobileService.isMobile\n\n    vm.toggleSaveRecipe = () => {\n      savedRecipesService\n        .requireLogin()\n        .then(() => {\n          if (vm.isSaved) {\n            savedRecipesService.removeSavedRecipe(vm.recipe.id, vm.recipe).then(() => {\n              vm.isSaved = false\n              // eslint-disable-next-line no-plusplus\n              vm.savedCount--\n            })\n          } else {\n            savedRecipesService.saveRecipe(vm.recipe.id, vm.recipe).then(() => {\n              vm.showSavePrompt = false\n              vm.isSaved = true\n              // eslint-disable-next-line no-plusplus\n              vm.savedCount++\n            })\n          }\n        })\n        .catch(() => null)\n    }\n\n    if (config.enableSavedRecipes && !config.disableRecipes) {\n      // Could not keep this DRY from recipeDetailsController due to Angular scoping, repeating this was a better option\n      $rootScope.$on('cartService', (event, action) => {\n        if (action === 'add') {\n          vm.showSavePrompt = true\n        }\n      })\n    }\n  },\n  template: `\n      <section class=\"recipe-meta\">\n        <ul>\n          <li>\n            <span ng-if=\"::!$ctrl.isMobile\" class=\"recipe-meta-icon icon-clock\" aria-hidden=\"true\"></span>\n            <span class=\"recipe-meta-name\">Ready In<span ng-if=\"::!$ctrl.isMobile\">:</span></span>\n            <span class=\"recipe-meta-value\">\n              <time datetime=\"{{::$ctrl.prepInfo.total_time | secondsToHoursMins: ({ toDateTime: true })}}\">\n                {{::$ctrl.prepInfo.total_time | secondsToHoursMins: ({ shortenWords: $ctrl.isMobile })}}\n              </time>\n            </span>\n          </li>\n          <li>\n            <span ng-if=\"::!$ctrl.isMobile\" class=\"recipe-meta-icon icon-apron\" aria-hidden=\"true\"></span>\n            <span class=\"recipe-meta-name\">Prep<span ng-if=\"::!$ctrl.isMobile\">:</span></span>\n            <span class=\"recipe-meta-value\">\n              <time datetime=\"{{::$ctrl.prepInfo.preparation_time | secondsToHoursMins: ({ toDateTime: true })}}\">\n                {{::$ctrl.prepInfo.preparation_time | secondsToHoursMins: ({ shortenWords: $ctrl.isMobile })}}\n              </time>\n            </span>\n          </li>\n          <li ng-if=\"::$ctrl.prepInfo.cook_time > 0\">\n            <span ng-if=\"::!$ctrl.isMobile\" class=\"recipe-meta-icon icon-pot\" aria-hidden=\"true\"></span>\n            <span class=\"recipe-meta-name\">Cook<span ng-if=\"::!$ctrl.isMobile\">:</span></span>\n            <span class=\"recipe-meta-value\">\n              <time datetime=\"{{::$ctrl.prepInfo.cook_time | secondsToHoursMins: ({ toDateTime: true })}}\">\n                {{::$ctrl.prepInfo.cook_time | secondsToHoursMins: ({ shortenWords: $ctrl.isMobile })}}\n              </time>\n            </span>\n          </li>\n          <li ng-if=\"::!$ctrl.isMobile\">\n            <span class=\"recipe-meta-icon icon-servings\" aria-hidden=\"true\"></span>\n            <span class=\"recipe-meta-name\">Servings: </span>\n            <span class=\"recipe-meta-value\">\n              {{::$ctrl.prepInfo.serving_size}}\n            </span>\n          </li>\n          <li ng-if=\"::$ctrl.isMobile && $ctrl.config.enableSavedRecipes && !$ctrl.config.disableRecipes\" class=\"recipe-meta-save\">\n            <span class=\"recipe-meta-save-button\">\n              <button ng-click=\"$ctrl.toggleSaveRecipe()\" class=\"button small hollow icon-{{::$ctrl.config.savedRecipesSaveIcon}} save-recipe-button\" ng-class=\"{'saved': $ctrl.isSaved}\">\n                <span ng-if=\"$ctrl.isSaved\" class=\"badge icon-checkmark\" aria-hidden=\"true\"></span>\n                {{$ctrl.savedCount === 0 ? $ctrl.lang.values.savedRecipes.saveRecipe : $ctrl.lang.values.savedRecipes.savedBy + ' ' + $ctrl.savedCount }}\n              </button>\n            </span>\n            <span class=\"save-prompt\" ng-if=\"!$ctrl.isSaved && $ctrl.showSavePrompt\">\n              <span role=\"button\" class=\"icon-delete\" ng-click=\"$ctrl.showSavePrompt = false\" aria-hidden=\"true\"></span>\n              {{::$ctrl.lang.values.savedRecipes.promptPrimary}}\n            </span>\n          </li>\n        </ul>\n      </section>\n    `,\n})\n","import angular from 'angular'\n\nexport default angular.module('RecipeProductsModule', []).component('recipeProducts', {\n  bindings: {\n    products: '<',\n  },\n  controller(config, mobileService) {\n    this.isMobile = mobileService.isMobile\n\n    this.productTypes = [\n      { propName: 'mealkitOptions', label: config.lang.recipeProductsFeaturedMealkitOptions },\n      { propName: 'fresh', label: config.lang.recipeProductsFeaturedFresh },\n      { propName: 'pantry', label: config.lang.recipeProductsFeaturedPantry },\n      { propName: 'other', label: config.lang.recipeProductsFeaturedOther },\n    ]\n  },\n  template: `\n      <div class=\"recipe-products\">\n        <div ng-repeat=\"productType in ::$ctrl.productTypes\">\n          <div ng-if=\"::($ctrl.products[productType.propName].length > 0)\" class=\"recipe-products-list\">\n            <h3 class=\"recipe-product-type-title title-cell\">{{::productType.label}} ({{::$ctrl.products[productType.propName].length}})</h3>\n            <ul>\n              <li class=\"product\" ng-repeat=\"product in ::$ctrl.products[productType.propName]\">\n                <!-- <div class=\"recipe-product-image\"></div>\n                <div class=\"recipe-product-name-price\">\n                  <span class=\"recipe-product-name\">{{product.name}}</span>\n                  <span class=\"recipe-product-price\">$4.69</span>\n                  <span class=\"recipe-product-unit\">/ea</span>\n                  <span class=\"recipe-product-price-per-unit\">($4.69/ea)</span>\n                </div>\n                <div class=\"recipe-product-recommended-quantity\">(not MVP)</div>\n                <div add-to-cart small=\"true\" product=\"product\" class=\"recipe-product-add-to-cart\"></div> -->\n\n                <div related-product horizontal-layout=\"true\" product=\"::product\" location=\"Recipes Page\"></div>\n              </li>\n            </ul>\n          </div>\n        </div>\n      </div>\n    `,\n})\n","import angular from 'angular'\nimport template from './savedRecipesCell.html'\n\nexport default angular.module('SavedRecipesTileModule', []).component('savedRecipesCell', {\n  template,\n  bindings: {\n    cell: '<',\n  },\n  controller($scope, $state, config, savedRecipesService, mobileService) {\n    const vm = this\n    const thumbnailsThreshold = 4\n\n    $scope.reactProps = {\n      imagesObj: [{ loading: true }],\n      border: true,\n      fixedContent: false,\n      imageGutter: 6,\n      linkObj: {},\n      titleObj: {\n        iconClass: 'icon-go',\n        text: vm.cell.name,\n        inverted: true,\n      },\n    }\n\n    if (mobileService.isMobile) {\n      $scope.reactProps.linkObj.onClick = () => $state.go(vm.cell.state)\n    } else {\n      $scope.reactProps.linkObj.href = $state.href(vm.cell.state)\n    }\n\n    savedRecipesService.getSavedRecipes().then(savedRecipes => {\n      vm.savedRecipesList = savedRecipes\n      const hasMultipleImages = savedRecipes.length && savedRecipes.length >= thumbnailsThreshold\n\n      if (hasMultipleImages) {\n        $scope.reactProps.imagesObj = savedRecipes.map(recipe => ({\n          src: recipe.media[0].image?.header,\n        }))\n      } else {\n        $scope.reactProps.imagesObj = [{ icon: true, iconClass: config.savedRecipesIcon }]\n      }\n    })\n  },\n})\n","import angular from 'angular'\n\nimport appendMetaTagDescription from '@app/utils/appendMetaTagDescription'\nimport { appendRecipeStruturedData } from '@app/utils/appendStructuredData'\nimport { deleteJsonLd } from '@app/utils/jsonLd'\nimport RecipeCategoriesServiceModule from './recipeCategoriesService'\nimport RecipeDetailsModalServiceModule from './recipeDetailsModalService'\nimport RecipeIngredientsModule from './recipeIngredients'\nimport RecipeMetaModule from './recipeMeta'\nimport RecipeProductsModule from './recipeProducts'\nimport SavedRecipesCellModule from './savedRecipesCell'\n\nexport default angular\n  .module('RecipesComponentModule', [\n    RecipeCategoriesServiceModule.name,\n    RecipeDetailsModalServiceModule.name,\n    RecipeIngredientsModule.name,\n    RecipeMetaModule.name,\n    RecipeProductsModule.name,\n    SavedRecipesCellModule.name,\n  ])\n  .config(($stateProvider, langProvider) => {\n    const recipesTreeStates = {\n      recipesHome: {\n        name: langProvider.values.recipes,\n        state: 'main.shop.recipes',\n        // sort: true\n      },\n    }\n\n    $stateProvider\n      .state('main.recipes', {\n        url: '/recipes',\n        abstract: true,\n      })\n      .state('main.recipes.details', {\n        url: '/{recipeId}/{name}?categoryIds',\n        views: {\n          'content@': {\n            template: require('./recipeDetails.html'),\n            controller: 'RecipeDetailsController',\n            controllerAs: 'recipeDetails',\n          },\n        },\n        params: {\n          name: { squash: true, value: null },\n          index: null,\n        },\n        resolve: {\n          loadCtrl: $ocLazyLoad => {\n            return import(\n              /* webpackChunkName: \"recipeDetailsController\", webpackPrefetch: true */ './recipeDetailsController'\n            )\n              .then(mod => $ocLazyLoad.load(mod.default))\n              .catch(err => {\n                throw new Error(`Ooops, something went wrong, ${err}`)\n              })\n          },\n          recipe($stateParams, Restangular) {\n            return Restangular.one('recipes', $stateParams.recipeId).get()\n          },\n          savedRecipes(savedRecipesService) {\n            return savedRecipesService.getSavedRecipes().then(savedRecipesList => {\n              return savedRecipesList\n            })\n          },\n        },\n        onEnter: recipe => {\n          appendRecipeStruturedData(recipe, langProvider.values.clientName)\n          appendMetaTagDescription(recipe.description)\n        },\n        onExit: () => {\n          deleteJsonLd()\n        },\n        data: {\n          recipesHomeState: recipesTreeStates.recipesHome,\n          setPageTitleAndBreadcrumbs: true,\n        },\n      })\n  })\n","import angular from 'angular'\nimport { LOGIN_CONTEXTS } from '@app/angular/constants/loginContexts'\n\nexport default angular\n  .module('savedRecipesServiceModule', [])\n  .service(\n    'savedRecipesService',\n    function savedRecipesService($state, Restangular, analytics, auth, registrationService) {\n      const service = this\n\n      service.savedRecipesList = []\n\n      service.getSavedRecipes = () => {\n        return Restangular.one('recipes')\n          .one('saved')\n          .get()\n          .then(savedRecipes => {\n            service.savedRecipesList = savedRecipes.items\n            return savedRecipes.items\n          })\n          .catch(() => null)\n      }\n\n      service.requireLogin = () => {\n        return new Promise((resolve, reject) => {\n          if (auth.user.status === 'trial') {\n            return registrationService\n              .open('login', null, null, null, null, null, LOGIN_CONTEXTS.SAVE_RECIPE)\n              .then(res => {\n                if (res === 'failed') {\n                  return reject()\n                }\n                // Refresh the current state\n                $state.go($state.current.name, { reload: true })\n                return resolve()\n              })\n              .catch(() => reject())\n          }\n          return resolve()\n        })\n      }\n\n      service.saveRecipe = (recipeId, recipe, index) =>\n        Restangular.one('recipes')\n          .one('saved')\n          .post(recipeId)\n          .then(() => {\n            service.savedRecipesList = [...service.savedRecipesList, { id: recipeId }]\n\n            analytics.logSegmentEvent('recipe.save_recipe', {\n              is_saved: true,\n              recipe_details: analytics.getRecipeAnalytics(recipe, index),\n            })\n          })\n\n      service.removeSavedRecipe = (recipeId, recipe, index) =>\n        Restangular.one('recipes')\n          .one('saved', recipeId)\n          .remove()\n          .then(() => {\n            let newSavedRecipeList = [...service.savedRecipesList]\n            newSavedRecipeList = newSavedRecipeList.filter(recipe => recipe.id !== recipeId)\n            service.savedRecipesList = newSavedRecipeList\n\n            analytics.logSegmentEvent('recipe.save_recipe', {\n              is_saved: false,\n              recipe_details: analytics.getRecipeAnalytics(recipe, index),\n            })\n          })\n    }\n  )\n","import angular from 'angular'\nimport RecipeComponent from './recipesRoutes.js'\nimport SavedRecipesService from './savedRecipesService.js'\n\nexport default angular.module('app.component.recipesModule', [\n  RecipeComponent.name,\n  SavedRecipesService.name,\n])\n","import angular from 'angular'\nimport { LOGIN_CONTEXTS } from '@app/angular/constants/loginContexts'\nimport { eventEmitter, EVENT_TYPES } from '@app/utils/eventEmitter'\nimport registrationTemplate from './views/registration.html'\n\nexport default angular\n  .module('RegistrationServiceModule', [])\n  .service(\n    'registrationService',\n    function registrationService(\n      $injector,\n      $rootScope,\n      $state,\n      $uibModal,\n      $window,\n      auth,\n      config,\n      lang,\n      legacyModalService,\n      localStorageService,\n      loyaltyOnboardingService,\n      uibModalAriaLabelService,\n      unataCommService,\n      userAnalytics\n    ) {\n      'ngInject'\n\n      const service = this\n\n      // Checks if an optional auth service is enabled. We cannot inject this on controller instantiation\n      // since the existence of the service is dynamic, based on whether or not it has been included in\n      // optionalComponents\n      service.hasOptionalAuthService = function () {\n        const authService = auth.getAuthService()\n        return !!authService\n      }\n\n      service.open = function (\n        view,\n        disableClose,\n        singleView,\n        errorMessage,\n        socialSignOnData,\n        subscriptionCode,\n        context\n      ) {\n        const authService = auth.getAuthService()\n\n        legacyModalService.closeOpenModals()\n        service.view = view\n\n        // If we are in loyalty onboarding mode, open alternate login/forgot/register modal view\n\n        if (authService) {\n          localStorageService.deprecatedSet('loginContext', context)\n          return authService.init(view)\n        }\n        if (config.enableLoyaltyOnboarding) {\n          return loyaltyOnboardingService.initOnboarding(\n            view,\n            singleView,\n            errorMessage,\n            socialSignOnData,\n            context\n          )\n        }\n        const modal = $uibModal.open({\n          template: registrationTemplate,\n          controller: 'RegistrationController',\n          resolve: {\n            ariaLabel: () => {\n              uibModalAriaLabelService.setLabel(lang.values.loginOrRegister)\n            },\n            disableClose: () => disableClose,\n            singleView: () => singleView,\n            error: () => errorMessage,\n            view: () => view,\n            socialSignOnData: () => socialSignOnData,\n            subscriptionCode: () => subscriptionCode,\n          },\n          keyboard: !disableClose,\n          backdrop: disableClose ? 'static' : true,\n        })\n\n        // Handle callback functions on modal events.\n        // TODO: We should reconsider the use of tabs / overloading registration modals, they\n        // have behaviour split between this service and individual controllers right now.\n        // If we see further bugs with registration exits, this is a good place to start looking.\n        modal.result.then(\n          () => {\n            // This first callback will fire on close events, there are none when abandoning the flow.\n          },\n          () => {\n            // This second callback will fire on dismiss events.\n            if (service.view === 'register') {\n              userAnalytics.logUserRegistrationExit()\n            }\n          }\n        )\n\n        return modal.result\n      }\n\n      // If user session times out, force user to login\n      service.promptLogin = function (\n        toState,\n        toParams,\n        fromState,\n        fromParams,\n        errorMessage,\n        loginContext = LOGIN_CONTEXTS.PROMPT_LOGIN\n      ) {\n        return service.open('login', true, 'login', errorMessage, null, null, loginContext).then(\n          () => {\n            $rootScope.isAppLoading = false\n            if (toState) {\n              return $state.go(toState, toParams)\n            }\n            return $state.go('main.home', null, {\n              reload: true,\n            })\n          },\n          () => {\n            $rootScope.isAppLoading = false\n            if (!fromState) {\n              return $state.go('main.home', null, {\n                reload: true,\n              })\n            }\n          }\n        )\n      }\n\n      // Listen for requests to open the login/register modal\n      // Note to self - this doesn't look like it's being used\n      unataCommService.listen(unataCommService.EventType.OPENLOGINREGISTERMODAL, event => {\n        const targetScreen = event.data.payload ? event.data.payload.targetScreen : 'login'\n        if (['login', 'register'].includes(targetScreen)) {\n          service.open(targetScreen)\n        }\n      })\n\n      // Listen for events outside of Angular app\n      // We need a better way to do this\n      // Going to avoid rewriting/introducing more code for now\n      eventEmitter.on(EVENT_TYPES.MODAL_OPEN_REGISTRATION_LOGIN, ({ view, context }) =>\n        service.open(view, null, null, null, null, null, context)\n      )\n    }\n  )\n","import angular from 'angular'\n\nimport { IC_PLACEMENTS } from '@app/angular/constants/express'\nimport { LOGIN_CONTEXTS } from '@app/angular/constants/loginContexts'\n\nexport default angular\n  .module('RegistrationControllerModule', [])\n  .controller(\n    'RegistrationController',\n    function (\n      $rootScope,\n      $scope,\n      $uibModalInstance,\n      config,\n      error,\n      express,\n      importIcAccountService,\n      redirectService,\n      refocusService,\n      registrationService,\n      singleView,\n      socialSignOnData,\n      socialSignOnService,\n      subscriptionCode,\n      userAnalytics,\n      view\n    ) {\n      $scope.registrationService = registrationService\n      $scope.error = error\n      $scope.view = view\n      $scope.socialSignOnData = socialSignOnData\n      $scope.subscriptionCode = subscriptionCode\n\n      $scope.setView = function (view) {\n        const previousView = registrationService.view\n\n        if (previousView === 'register') {\n          userAnalytics.logUserRegistrationExit()\n        }\n\n        if (view === 'register') {\n          userAnalytics.logUserRegistrationStart()\n        }\n\n        // Update view\n        registrationService.view = view\n        $scope.view = view\n      }\n\n      $scope.showTab = function (tab) {\n        if (!singleView) {\n          return true\n        }\n        if (singleView === tab) {\n          return true\n        }\n        return false\n      }\n\n      $scope.goToSocialLinkFlow = () => {\n        socialSignOnService.goToSocialLinkFlow(socialSignOnData).then(data => {\n          // account successfully linked\n          if (data.linked) {\n            // close register modal since we no longer need to sign up linked user\n            $uibModalInstance.close()\n          }\n        })\n      }\n\n      $scope.onRegister = () => {\n        $uibModalInstance.close()\n        const redirected = redirectService.loadRedirectUrl() !== false\n        if (config.icImportAccount) {\n          return !redirected\n            ? $rootScope\n                .reloadState()\n                .then(() => importIcAccountService.openModal(LOGIN_CONTEXTS.ON_REGISTRATION))\n            : importIcAccountService.openModal(LOGIN_CONTEXTS.ON_REGISTRATION)\n        }\n        if (!redirected) {\n          $rootScope.reloadState()\n        }\n      }\n\n      $scope.express = express\n      $scope.IC_PLACEMENTS = IC_PLACEMENTS\n\n      // Initialize `modal.closing` trigger to refocus invoking element when this modal closes\n      refocusService.setRefocusTrigger($scope)\n    }\n  )\n","import angular from 'angular'\n\nimport { LOGIN_CONTEXTS } from '@app/angular/constants/loginContexts'\nimport RegistrationServiceModule from './registrationService.js'\nimport RegistrationControllerModule from './controllers/registrationController'\n\nexport default angular\n  .module('RegistrationComponentModule', [\n    RegistrationServiceModule.name,\n    RegistrationControllerModule.name,\n  ])\n\n  .config(($stateProvider, $urlRouterProvider, configConstants, langProvider) => {\n    $stateProvider\n      .state('main.changePassword', {\n        url: '/change-password?resetToken',\n        views: {\n          'content@': {\n            template: require('./views/changePassword.html'),\n            controller: 'ChangePasswordController',\n          },\n        },\n        resolve: {\n          loadCtrl: $ocLazyLoad => {\n            return import(\n              /* webpackChunkName: \"changePasswordController\", webpackPrefetch: true */ './controllers/changePasswordController'\n            )\n              .then(mod => $ocLazyLoad.load(mod.default))\n              .catch(err => {\n                throw new Error(`Ooops, something went wrong, ${err}`)\n              })\n          },\n          resetToken($stateParams) {\n            return $stateParams.resetToken\n          },\n          title(titleService) {\n            return titleService.setTitle(langProvider.values.changePassword)\n          },\n        },\n        onEnter($state, resetToken) {\n          // TODO: should probably validate resetToken before continue\n          if (configConstants.gigya && configConstants.gigya.enabled) {\n            $state.go('main.changePasswordGigya')\n          } else if (resetToken === undefined || resetToken === 'true') {\n            $state.go('main.home')\n          }\n        },\n      })\n\n      .state('main.changePasswordGigya', {\n        url: '/change-password-gigya?pwrt',\n        resolve: {\n          passwordResetToken: $stateParams => $stateParams.pwrt,\n          title: titleService => titleService.setTitle(langProvider.values.changePassword),\n        },\n        onEnter: ($state, gigyaService, passwordResetToken) => {\n          $state.go('main.home')\n\n          if (configConstants.gigya && configConstants.gigya.enabled && passwordResetToken) {\n            gigyaService.gigyaInit('reset', passwordResetToken)\n          }\n        },\n      })\n\n      .state('main.socialSignOn', {\n        url: '/social-sign-on?redirect',\n        views: {\n          'content@': {\n            template: require('./views/socialSignOn.html'),\n            controller: 'SocialSignOnController',\n          },\n        },\n        resolve: {\n          loadCtrl: $ocLazyLoad => {\n            return import(\n              /* webpackChunkName: \"socialSignOnController\", webpackPrefetch: true */ './controllers/socialSignOnController'\n            )\n              .then(mod => $ocLazyLoad.load(mod.default))\n              .catch(err => {\n                throw new Error(`Ooops, something went wrong, ${err}`)\n              })\n          },\n          title(titleService) {\n            return titleService.setTitle(langProvider.values.socialSignOn)\n          },\n        },\n        onEnter($state, auth) {\n          // Only allow trial users (non-logged in) to go to this state.\n          if (auth.user.status !== 'trial') {\n            $state.go('main.home')\n          }\n        },\n      })\n      .state('main.register', {\n        url: '/register?redirect',\n        onEnter: (\n          $state,\n          $stateParams,\n          $timeout,\n          auth,\n          config,\n          redirectService,\n          registrationService,\n          shoppingSelectorService\n        ) => {\n          // Pre-emptively set context in order to hide context modal in the case\n          //  where registration modal is covered by context modal on arrival to /register\n          if (!shoppingSelectorService.isContextIntentInValidState()) {\n            shoppingSelectorService.forceContextIntentSet()\n          }\n          if ($stateParams && $stateParams.redirect) {\n            redirectService.saveRedirectUrl($stateParams.redirect)\n          }\n          if (auth.user.status !== 'trial') {\n            redirectService.loadRedirectUrl({ state: 'main.home' })\n          } else if (\n            config.eComLight?.homeRedirect &&\n            auth.getContext().shopping_mode === 'catering'\n          ) {\n            // Catering context overrides main.home state to specific category state set by config\n            // When going to /register the redirect to main.home fails as it's overridden in stateChangeStart event on rootscope\n            // Thus registration modal will never be triggered in catering context. This conditional solves the issue by going\n            // directly to the category state and popping up the registration modal\n            $state\n              .go(config.eComLight.homeRedirect.sref, config.eComLight.homeRedirect.params, {\n                reload: true,\n              })\n              .then(() => {\n                registrationService.open('register')\n              })\n          } else {\n            // Without the $timeout this breaks if already on main.home and clicking on a non-angular `/register` link\n            $timeout(() => {\n              $state.go('main.home').then(() => {\n                registrationService.open('register')\n              })\n            }, 10)\n          }\n        },\n      })\n      .state('main.login', {\n        url: '/login?redirect&norender',\n        onEnter: (\n          $state,\n          $stateParams,\n          $timeout,\n          auth,\n          redirectService,\n          registrationService,\n          shoppingSelectorService\n        ) => {\n          if (!shoppingSelectorService.isContextIntentInValidState()) {\n            shoppingSelectorService.forceContextIntentSet()\n          }\n          if ($stateParams && $stateParams.redirect) {\n            redirectService.saveRedirectUrl($stateParams.redirect)\n          }\n          if (auth.user.status !== 'trial') {\n            redirectService.loadRedirectUrl({ state: 'main.home' })\n          } else {\n            $timeout(() => {\n              // norender param can be passed here to keep the loading spinner up to avoid flashing\n              // the loaded content in-between landing here and redirecting to the authorization URL\n              $state.go('main.home', { norender: $stateParams.norender }).then(() => {\n                registrationService.open(\n                  'login',\n                  null,\n                  null,\n                  null,\n                  null,\n                  null,\n                  LOGIN_CONTEXTS.MAIN_LOGIN_STATE\n                )\n              })\n            }, 10)\n          }\n        },\n      })\n      .state('main.logout', {\n        url: '/logout?redirect&norender',\n        onEnter: (\n          $state,\n          $stateParams,\n          $timeout,\n          redirectService,\n          registrationService,\n          shoppingSelectorService\n        ) => {\n          if (!shoppingSelectorService.isContextIntentInValidState()) {\n            shoppingSelectorService.forceContextIntentSet()\n          }\n          if ($stateParams && $stateParams.redirect) {\n            redirectService.saveRedirectUrl($stateParams.redirect)\n          }\n          $timeout(() => {\n            // norender param can be passed here to keep the loading spinner up to avoid flashing\n            // the loaded content in-between landing here and redirecting to the authorization URL\n            $state.go('main.home', { norender: $stateParams.norender }).then(() => {\n              registrationService.open('logout')\n            })\n          }, 10)\n        },\n      })\n      .state('main.forgotPassword', {\n        url: '/forgot-password',\n        onEnter: (\n          $state,\n          $stateParams,\n          $timeout,\n          auth,\n          redirectService,\n          registrationService,\n          shoppingSelectorService\n        ) => {\n          if (!shoppingSelectorService.isContextIntentInValidState()) {\n            shoppingSelectorService.forceContextIntentSet()\n          }\n          if ($stateParams && $stateParams.redirect) {\n            redirectService.saveRedirectUrl($stateParams.redirect)\n          }\n          if (auth.user.status !== 'trial') {\n            redirectService.loadRedirectUrl({ state: 'main.home' })\n          } else {\n            $timeout(() => {\n              $state.go('main.home').then(() => {\n                registrationService.open('forgot')\n              }, 10)\n            })\n          }\n        },\n      })\n  })\n","import angular from 'angular'\nimport RegistrationComponentModule from './registrationRoutes.js'\n\nexport default angular.module('app.component.registration', [RegistrationComponentModule.name])\n","import angular from 'angular'\n\nexport default angular\n  .module('FulfillmentTypeControllerModule', [])\n  .controller('FulfillmentTypeController', function ($scope, config) {})\n","import _ from 'lodash'\nimport fp from 'lodash/fp'\nimport angular from 'angular'\nimport dayjs from 'dayjs'\n\nexport default angular\n  .module('TimeslotControllerModule', [])\n\n  .controller(\n    'TimeslotController',\n    function (\n      $scope,\n      $state,\n      Restangular,\n      cartService,\n      compareCartService,\n      config,\n      reservationService,\n      timeslots\n    ) {\n      $scope.cartService = cartService\n      $scope.reservationService = reservationService\n      $scope.selectedTimeslot = null\n\n      reservationService.reservation = null\n\n      // Find the first and the last day in our data set\n\n      let lastDay\n      let firstDay\n\n      _.each(\n        _.map(timeslots, timeslot => {\n          return dayjs(timeslot.fulfillment_date).startOf('day')\n        }),\n        day => {\n          if (!lastDay || day.unix() > lastDay.unix()) {\n            lastDay = day\n          }\n\n          if (!firstDay || day.unix() < firstDay.unix()) {\n            firstDay = day\n          }\n        }\n      )\n\n      // Sort timeslots\n\n      timeslots = _.sortBy(timeslots, timeslot => {\n        return timeslot.timeslot.from_time\n      })\n\n      // Generate a list of days grouped by week\n\n      $scope.days = []\n\n      for (let day = dayjs(firstDay); day.diff(lastDay, 'days') <= 0; day = day.add(1, 'days')) {\n        let dayOfWeek = day.format('dddd')\n        const diff = dayjs().startOf('day').diff(day, 'days')\n\n        // Today\n\n        if (!diff) {\n          dayOfWeek = 'Today'\n        }\n\n        // Tomorrow\n\n        if (diff === -1) {\n          dayOfWeek = 'Tomorrow'\n        }\n\n        $scope.days.push({\n          dayOfWeek,\n          dayOfMonth: day.format('D'),\n          month: day.format('MMMM'),\n          date: day.format('MM-DD-YYYY'),\n          daysSinceStart: day.diff(firstDay, 'days'),\n        })\n      }\n\n      // Group days by week\n\n      $scope.daysByWeek = fp.flow(\n        fp.groupBy(day => Math.floor(day.daysSinceStart / 7)),\n        fp.toArray\n      )($scope.days)\n\n      // Group timeslots by day\n\n      $scope.timeslotsByDay = _.groupBy(timeslots, timeslot => {\n        return dayjs(timeslot.fulfillment_date).format('MM-DD-YYYY')\n      })\n\n      $scope.currentWeek = 0 // Keep track of which week we're viewing\n\n      // Select a particlar day and the first timeslot for that day in the select list\n\n      $scope.selectDay = function (day) {\n        $scope.selectedDay = day\n        $scope.selectedTimeslot = null\n      }\n\n      // Select the first day by default\n\n      $scope.selectDay($scope.days[0])\n\n      // Reserve the selected timeslot - Check if inventory or price of products have changed.\n\n      $scope.reserve = function () {\n        delete $scope.error\n        const timeslotStartTime = `${$scope.selectedTimeslot.fulfillment_date} ${$scope.selectedTimeslot.timeslot.from_time}`\n        compareCartService\n          .compareCart(true, 'timeslot', {\n            timeslot: $scope.selectedTimeslot.timeslot,\n            fulfillment_date: timeslotStartTime,\n          })\n          .then(() => {\n            processReserve()\n          })\n      }\n\n      function processReserve() {\n        reservationService.makeReservation($scope.selectedTimeslot.plain()).then(\n          () => {\n            cartService.fetch() // Update the cart so fees are reflected\n\n            $state.go('^.confirmation')\n          },\n          response => {\n            $scope.error = response.data ? response.data.message : response.message\n          }\n        )\n      }\n    }\n  )\n","import _ from 'lodash'\nimport angular from 'angular'\nimport dayjs from 'dayjs'\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\nimport { TIMESLOT_FEES } from '@app/angular/constants/timeslots'\nimport { HTTP_ERRORS } from '@app/angular/constants/httpErrors'\nimport { hasRxItem } from '@instacart/enterprise-services/shopping-list/_common/utils'\nimport template from './views/timeslotSelectors.html'\n\nconst TIME = 'HH:mm:ss'\nconst DAY = 'day'\nconst DAYS = 'days'\nconst DAY_FORMAT = 'D'\nconst MONTH_FORMAT = 'MMMM'\nconst MONTH_SHORT_FORMAT = 'MMM'\nconst DATE_FORMAT = 'MM-DD-YYYY'\nconst MOBILE_DAY_FORMAT = 'ddd'\nconst DESKTOP_DAY_FORMAT = 'dddd'\nconst SORTED_TIMESLOT_CONFIG = ['timeslot.within_hours', 'timeslot.from_time']\n\nconst TIMESLOT_POLYTYPES = {\n  ASAP: 'asap',\n}\n\nconst dayOfTheWeekLabels = (lang, diff, fullLabel, isMobile, customLabels = {}) => {\n  const today = customLabels.today !== false ? customLabels.today || lang.values.today : fullLabel\n  const tomorrow =\n    customLabels.tomorrow !== false ? customLabels.tomorrow || lang.values.tomorrow : fullLabel\n\n  switch (diff) {\n    case 0:\n      return today\n    case -1:\n      return !isMobile ? tomorrow : fullLabel\n    default:\n      return fullLabel\n  }\n}\n\nexport default angular\n  .module('TimeslotSelectorsDirectiveModule', [])\n\n  .directive('timeslotSelectors', function () {\n    return {\n      restrict: 'E',\n      scope: {\n        /*\n         * Properties\n         */\n        /** [{string}] Important to supply this for new checkout - E.g. \"{ <address fields> }\" * */\n        address: '<?',\n\n        /** {object} E.g. \"{ tomorrow: false, isShortDayNames: true, isShortTime: true }\" * */\n        customLabels: '<',\n\n        /** {string} The fulfillment intent (appears not to be being used though?) * */\n        fulfillmentType: '=',\n\n        /** {boolean} true to make the entire row clickable to select, making the button useless but fun * */\n        isEntireRowClick: '<',\n\n        /** {boolean} true for a condensed view (i.e. mobile) * */\n        isCondensed: '<',\n\n        /** {int} the initial number of timeslots to show, before all should be shown * */\n        pagination: '<',\n\n        /** {string} The css class for the top level of this component (useful for styling) * */\n        rootLevelCssClass: '@',\n\n        /** {boolean} true for selectable; false for read-only * */\n        timeslotsAreSelectable: '=',\n\n        /** {boolean} Whether to filter out timeslots during blackout periods * */\n        filterBlackouts: '<',\n\n        /*\n         * Callbacks\n         */\n        /** {function} Called when the a timeslot is selected and succeeds to update the cart (No params & No return) * */\n        navigateToNextStep: '&',\n\n        /** {function} Called when the a timeslot is selected, but this fails to update the cart (No params & No return) * */\n        navigateToNextStepFailed: '&',\n\n        /** {function} Called when the component begins loading timeslots (No params & No return) * */\n        onLoad: '&',\n\n        /** {function} Called when the component has loaded timeslots (No params & No return) * */\n        onReady: '&',\n\n        /** {function} Called when the component failed to load timeslots (No params & No return) * */\n        onError: '&',\n\n        /** {function} Called after a cart compare confirmation */\n        onAfterCartCompareConfirm: '&',\n      },\n      template,\n      controller(\n        $filter,\n        $rootScope,\n        $scope,\n        $state,\n        $stateParams,\n        $timeout,\n        analytics,\n        analyticsHelper,\n        api,\n        auth,\n        cartService,\n        compareCartService,\n        config,\n        errorModalService,\n        lang,\n        mobileService,\n        modalOptions,\n        reservationService,\n        shoppingContextService\n      ) {\n        // Default customLabels\n        if (!$scope.customLabels) {\n          $scope.customLabels = { tomorrow: false, isShortDayNames: true, isShortTime: true }\n        }\n        $scope.hasRxItem = cartService.cart ? hasRxItem(cartService.cart.items) : false\n        const { isMobile } = mobileService\n        const getShopContextIntent = () => {\n          const intent = shoppingContextService.selectedFulfillmentType || auth.getContext().intent\n          const shoppingModeConfig = config.shoppingSelector[intent]\n\n          return shoppingModeConfig.behaveAs || intent\n        }\n        const shopContextIntent = getShopContextIntent()\n        const isShortDayNames = $scope.customLabels?.isShortDayNames === true\n        const deliveryConfig = config.shoppingSelector.delivery\n        const willBeFulfilledByInstacart =\n          deliveryConfig.fulfilledByInstacart && shopContextIntent === 'delivery'\n        const showAvailableTimeslotsOnlyCheckbox =\n          deliveryConfig.showAvailableTimeslotsOnlyCheckbox && shopContextIntent === 'delivery'\n        const availabilityCheckboxThreshold =\n          config.shoppingSelector[shopContextIntent]?.timeslotAvailabilityCheckboxThreshold || 0\n\n        Object.assign(\n          $scope,\n          {\n            $rootScope,\n            $state,\n            cartService,\n            lang,\n            reservationService,\n            showAvailableTimeslotsOnlyCheckbox,\n            availabilityCheckboxThreshold,\n            shopContextIntent,\n            showDeliveryFee: willBeFulfilledByInstacart,\n            willBeFulfilledByInstacart,\n            config,\n          },\n          {\n            loading: true,\n            loadingReservation: false,\n            mobile: mobileService,\n            showPickFee: !willBeFulfilledByInstacart,\n            showAllTimeslots: !$scope.pagination, // If pagination, default to false. Otherwise true\n            isShortTime: !!$scope.customLabels?.isShortTime,\n            radioBoxToggleOverride: null,\n            availability: {\n              showOnlyAvailable: willBeFulfilledByInstacart,\n            },\n            TIMESLOT_POLYTYPES,\n            // Everything below was added to support react time slots\n            onTimeSlotSelected: timeSlot => $scope.reserve(0, timeSlot),\n            onGoToCart: () => $state.go('main.checkout.cartV2'),\n            // This has V2 added because 'selectedTimeSlot' is used in some functions in this component\n            selectedTimeSlotV2: reservationService.reservation,\n            reactTimeSlotsI18n: {\n              availabilityCheckboxLabel: lang.values.availableTimeslotsOnly,\n              goToCart: lang.values.goToCart,\n              moreTimes: lang.values.moreTimes,\n              nextWeek: lang.values.nextWeek,\n              previousWeek: lang.values.lastWeek,\n              changeWeek: lang.values.changeWeek,\n              noTimeslotsAvailableMessage:\n                shopContextIntent === 'delivery'\n                  ? lang.values.noTimeslotsAvailableDelivery\n                  : lang.values.noTimeslotsAvailablePickup,\n              aria: {\n                title: lang.aria.selectTimeslot,\n                daySelection: lang.aria.daySelection,\n              },\n              day: {\n                today: lang.values.today,\n              },\n              timeSlot: {\n                selected: lang.values.selected,\n                unavailable: lang.values.unavailable,\n                hideDetail: lang.values.hideDetails,\n                showDetail: lang.values.showDetails,\n                select: lang.values.select,\n                deliveryFeeLabel: lang.values.deliveryFees,\n                shopFeeLabel: lang.values.pickFees,\n                free: lang.values.free,\n                noAlcohol: lang.values.noAlcohol,\n                highDemand: lang.values.timeslotsHighDemand,\n                // TODO(after 2.26): The current string in the config uses a template format that doesn't work with\n                // the new lang service, and since we can only have one version of the config this has been commented out.\n                // The default string will work for now as no retailer has changed this string.\n                // withinHours: lang.values.withinHours,\n              },\n              rxWarning: lang.values.rx.timeslotWarning,\n            },\n            timeslots: [],\n            onDaySelected: () => {\n              analytics.logEvent('fulfillment timeslot day of week button', 'click')\n            },\n            onWeekChanged: ({ currentPage, newPage }) => {\n              if (currentPage - newPage > 0) {\n                analytics.logEvent('fulfillment timeslot next week button', 'click')\n              } else if (currentPage - newPage < 0) {\n                analytics.logEvent('fulfillment timeslot last week button', 'click')\n              }\n            },\n          }\n        )\n\n        let timeslots\n        let lastDay\n        let firstDay\n        let selectedTimeslot\n\n        this.$onInit = () => {\n          this.isCondensed = this.isCondensed ?? false\n        }\n\n        const toggleGetTimeslotComplete = value => ($scope.getTimeslotsComplete = value)\n\n        const processTimeSlots = (timeslots = []) => {\n          timeslots.forEach(timeslot => {\n            const day = dayjs(timeslot.fulfillment_date).startOf(DAY)\n            if (!lastDay || day.unix() > lastDay.unix()) {\n              lastDay = day\n            }\n            if (!firstDay || day.unix() < firstDay.unix()) {\n              firstDay = day\n            }\n          })\n\n          // Sort timeslots\n          const sortedTimeslots = _.sortBy(timeslots, SORTED_TIMESLOT_CONFIG)\n\n          // Generate a list of days grouped by week\n          $scope.days = []\n          const asapTimeslot = timeslots.find(\n            timeslot => timeslot.timeslot.polytype === TIMESLOT_POLYTYPES.ASAP\n          )\n          if (asapTimeslot) {\n            const asapDay = dayjs(asapTimeslot.fulfillment_date)\n            $scope.days.push({\n              dayOfWeek: lang.values.fastest,\n              dayOfMonth: lang.values.possible,\n              month: '',\n              monthShort: '',\n              date: TIMESLOT_POLYTYPES.ASAP,\n              daysSinceStart: asapDay.diff(firstDay, DAYS),\n            })\n          }\n          for (let day = dayjs(firstDay); day.diff(lastDay, DAYS) <= 0; day = day.add(1, DAYS)) {\n            const diff = dayjs().startOf(DAY).diff(day, DAYS)\n            const format = day.format(\n              isMobile || isShortDayNames ? MOBILE_DAY_FORMAT : DESKTOP_DAY_FORMAT\n            )\n\n            $scope.days.push({\n              dayOfWeek: dayOfTheWeekLabels(lang, diff, format, isMobile, $scope.customLabels),\n              dayOfMonth: day.format(DAY_FORMAT),\n              month: day.format(MONTH_FORMAT),\n              monthShort: day.format(MONTH_SHORT_FORMAT),\n              date: day.format(DATE_FORMAT),\n              daysSinceStart: day.diff(firstDay, DAYS),\n            })\n          }\n\n          // Group days by week\n          const dayOrd = dayObj => Math.floor(dayObj.daysSinceStart / 7)\n          $scope.daysByWeek = $scope.days.reduce((arr, dayObj) => {\n            const day = dayOrd(dayObj)\n            // eslint-disable-next-line no-multi-assign\n            const weekArr = (arr[day] = arr[day] || [])\n            dayObj.week = arr.length - 1\n            weekArr.push(dayObj)\n            return arr\n          }, [])\n\n          // Group timeslots by day\n          const dateStr = timeslot => dayjs(timeslot.fulfillment_date).format(DATE_FORMAT)\n          $scope.timeslotsByDay = sortedTimeslots.reduce((dayObject, timeslot) => {\n            if (timeslot.timeslot.polytype === TIMESLOT_POLYTYPES.ASAP) {\n              dayObject[TIMESLOT_POLYTYPES.ASAP] = [timeslot]\n            } else {\n              const time = dateStr(timeslot)\n              // eslint-disable-next-line no-multi-assign\n              const day = (dayObject[time] = dayObject[time] || [])\n              day.push(timeslot)\n            }\n\n            const { from_time, to_time } = timeslot.timeslot\n            if (dayjs(from_time, TIME).minute() || dayjs(to_time, TIME).minute()) {\n              $scope.isShortTime = false // If there are any times with minutes, we turn off isShortTime\n            }\n\n            return dayObject\n          }, {})\n\n          $scope.timeslotsByDayPaginated = $scope.pagination\n          $scope.currentWeek = 0 // Keep track of which week we're viewing\n          $scope.reservationWeek = $scope.days[0].week\n          selectInitialDate()\n        }\n\n        /**\n         * This method sets the initial state of the component by\n         * selecting the day, week and expanding the pagination\n         * if the user timeslot reservation is hidden\n         *\n         * @returns {undefined}\n         */\n        const selectInitialDate = () => {\n          const { reservation } = reservationService\n          const reservationDate = reservation?.fulfillment_date\n          const reservationTimeslot = reservation?.timeslot\n\n          if (reservationDate) {\n            const date = dayjs(reservationDate).startOf(DAY).format(DATE_FORMAT)\n            const dayInList = $scope.days.find(day => day.date === date) || $scope.days[0]\n            const dayTimeslots = $scope.timeslotsByDay[dayInList.date]\n\n            $scope.reservationWeek = dayInList.week\n\n            if (dayTimeslots && reservationTimeslot) {\n              const timeslotIndex = dayTimeslots.findIndex(\n                time => time.timeslot.id === reservationTimeslot.id\n              )\n\n              // Show all timeslots if the reservation timeslot is hidden\n              if (timeslotIndex + 1 > $scope.pagination) {\n                $scope.showAllTimeslots = true\n              }\n            }\n\n            $scope.selectDay(dayInList)\n            $scope.currentWeek = dayInList.week\n\n            if (isMobile) {\n              $timeout(() => {\n                const scrollableEl = document.getElementById('scrollable-timeslot-days')\n                const dayEl = document.getElementById(\n                  `reservation-select-day-${dayInList.daysSinceStart}`\n                )\n\n                // eslint-disable-next-line no-unused-expressions\n                scrollableEl?.scroll(dayEl?.offsetLeft || 0, 0)\n              }, 0)\n            }\n          } else {\n            $scope.selectDay($scope.days[0])\n          }\n        }\n\n        const getTimeslots = args => {\n          if ($scope.onLoad) {\n            $scope.onLoad()\n          }\n\n          const payload = {\n            fulfillment_type: $scope.shopContextIntent,\n            filter_product_blackouts_timeslots: $scope.filterBlackouts,\n            ...args,\n          }\n\n          payload.cart_id = cartService.getCartId(cartService.getCurrentCartType())\n          payload.user_timezone = Intl.DateTimeFormat().resolvedOptions().timeZone\n\n          return api\n            .getTimeSlotsList(payload)\n            .then(response => {\n              $scope.timeslots = response\n              analyticsHelper.availabilityViewEvent(response)\n              return (timeslots = response)\n            })\n            .then(() => toggleGetTimeslotComplete(false))\n            .then(() => processTimeSlots(timeslots))\n            .then(() => toggleGetTimeslotComplete(true))\n            .then(() => $scope.onReady && $scope.onReady())\n            .catch(response => {\n              $scope.onError && $scope.onError({ response })\n              if (response.data.error === HTTP_ERRORS.ALCOHOL_FULFILLMENT_ERROR) {\n                $scope.reactTimeSlotsI18n.noTimeslotsAvailableMessage = response.data.message\n              }\n            })\n            .finally(() => {\n              $scope.loading = false\n            })\n        }\n\n        const processReserve = newTimeslot => {\n          const { fulfillment_date, timeslot } = newTimeslot\n          const payload = newTimeslot.plain ? { ...newTimeslot.plain() } : { ...newTimeslot }\n\n          const cart_id = cartService.getCartId(cartService.getCurrentCartType())\n          if (cart_id) {\n            payload.cart_id = cart_id\n          }\n\n          return reservationService.makeReservation(payload).then(() => {\n            // In the checkout page, only log edit_timeslot events and not select_timeslot.\n            if ($scope.$state.current.name !== 'main.checkout.checkoutPage') {\n              analytics.logSegmentEvent('availability.select_timeslot', {\n                fulfillment_date,\n                timeslot,\n              })\n            }\n            return cartService.fetch().then(() => $scope.navigateToNextStep())\n          })\n        }\n\n        const handleProcessReservationError = response => {\n          const logReserveError = () =>\n            $scope.navigateToNextStepFailed && $scope.navigateToNextStepFailed()\n\n          // Handles expired timeslot selection\n          if (response && response.status === HTTP_ERRORS.FORBIDDEN) {\n            getTimeslots()\n              .then(() => ($scope.error = lang.values.expiredTimeslotError))\n              .then(logReserveError)\n          } else {\n            $scope.error = response?.data || response\n            logReserveError()\n          }\n\n          $scope.onError && $scope.onError({ response })\n        }\n\n        $scope.toggleUnavailableReason = timeslot => {\n          timeslot.showUnavailableReason = !timeslot.showUnavailableReason\n        }\n\n        // Select a particular day and the first timeslot for that day in the select list\n\n        $scope.selectDay = day => {\n          $scope.selectedDay = day\n          selectedTimeslot = null\n\n          const el = document.querySelector('.timeslots tbody tr')\n\n          // For keyboard users (accessibility), set the focus to the timeslots when a day is selected\n          if (el) {\n            el.focus()\n          }\n        }\n\n        $scope.resetSelectedTimeslot = () => {\n          selectedTimeslot = null\n        }\n\n        $scope.rowClick = ($index, timeslot) => {\n          if (!$scope.timeslotsAreSelectable || timeslot.timeslot.unavailable) return\n\n          if ($scope.isEntireRowClick) {\n            $scope.reserve($index, timeslot)\n          }\n        }\n\n        // Reserve the selected timeslot - Check if inventory or price of products have changed.\n        $scope.reserve = (selectedIndex, timeslot, isSkip) => {\n          if (isSkip || timeslot.timeslot.unavailable) return\n\n          delete $scope.error\n          selectedTimeslot = timeslot\n\n          const timeslotStartTime = `${selectedTimeslot.fulfillment_date} ${selectedTimeslot.timeslot.from_time}`\n          $scope.selectedTimeslotIndex = selectedIndex\n          $scope.loadingReservation = true\n          $scope.radioBoxToggleOverride = selectedTimeslot.timeslot.id\n\n          compareCartService\n            .compareCart(true, 'timeslot', {\n              timeslot: selectedTimeslot.timeslot,\n              fulfillment_date: timeslotStartTime,\n            })\n            .then($scope.onAfterCartCompareConfirm)\n            .then(() => processReserve(selectedTimeslot))\n            .catch(handleProcessReservationError)\n            .finally(() => {\n              $scope.loadingReservation = false\n              $scope.radioBoxToggleOverride = null\n              $scope.resetSelectedTimeslot()\n            })\n        }\n\n        $scope.updateTimeslotFee = timeslot => {\n          const currentValue =\n            timeslot[TIMESLOT_FEES[timeslot.source][shopContextIntent] || TIMESLOT_FEES.DEFAULT]\n          const { enabled, value, text } = config.shopperFeeTextChange\n\n          if (timeslot.is_free) {\n            return lang.values.free\n          }\n\n          return enabled && currentValue === value ? text : $filter('currency')(currentValue)\n        }\n\n        $scope.isToggled = timeslotItem => {\n          const reservation = reservationService.reservation?.timeslot\n          const timeslot = timeslotItem?.timeslot\n\n          /**\n           * Weeks share timeslots with same IDs, this check prevents\n           * the radio input from checking if the timeslot ID is the same as the\n           * user reservation but from a different week\n           */\n          if ($scope.selectedDay.week !== $scope.reservationWeek) {\n            return false\n          }\n\n          if ($scope.radioBoxToggleOverride) {\n            return $scope.radioBoxToggleOverride === timeslot?.id\n          }\n\n          if (reservation && timeslot) {\n            return (\n              reservation.id === timeslot.id ||\n              (reservation.ext_id && reservation.ext_id === timeslot.ext_id)\n            )\n          }\n\n          return false\n        }\n\n        $scope.getUnavailabilityReasonString = timeslot =>\n          timeslot.timeslot.unavailability_reasons.join('<br /><br />')\n\n        $scope.toggleShowMore = () => {\n          $scope.showAllTimeslots = !$scope.showAllTimeslots\n        }\n\n        $scope.getFeeLabel = timeslot => {\n          if (timeslot.unavailable && !$scope.timeslotsAreSelectable) {\n            return lang.values.unavailable\n          }\n\n          return shopContextIntent === SHOPPING_MODES.DELIVERY\n            ? lang.values.deliveryFees\n            : lang.values.pickFees\n        }\n\n        let getTimeslotArgs = {}\n\n        // If not on the checkout page, pass above_threshold as True.\n        // Otherwise, pass the street_address and delivery postal code,\n        // and above_threshold as False\n        if ($scope.$state.current.name !== 'main.checkout.checkoutPage') {\n          getTimeslotArgs = {\n            above_threshold: true,\n          }\n        } else {\n          // TODO Remove $scope.address once CRM for HEI and CCA is fixed to sync address correctly\n          const address = $scope.address || auth.getContext()\n          getTimeslotArgs = {\n            above_threshold: false,\n            street_address: address?.address1 || address?.street_address,\n            deliveryPostalCode: address?.postal_code || address?.deliveryPostalCode,\n          }\n        }\n\n        getTimeslots(getTimeslotArgs)\n      },\n    }\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('TimeslotSelectorStateControllerModule', [])\n  .controller(\n    'TimeslotSelectorStateController',\n    function ($scope, $state, $stateParams, mobileService, redirectService, timeslotService) {\n      $scope.redirect = $stateParams && $stateParams.redirect\n      $scope.mobileService = mobileService\n\n      $scope.redirectToPreviousState = () => {\n        $scope.selectedTimeslot = true\n        if ($state.current.name === 'main.timeslot') {\n          redirectService.goToRedirectUrl(\n            { href: $stateParams && $stateParams.redirect },\n            { state: 'main.home' }\n          )\n        }\n      }\n\n      $scope.timeslotsAreSelectable =\n        !timeslotService.areTimeslotsSelectableAtCheckoutOnly() ||\n        $state.current.name === 'main.checkout.reservation.confirmation'\n    }\n  )\n","import angular from 'angular'\n\nimport FulfillmentAddressControllerModule from './fulfillmentAddressController'\nimport FulfillmentTypeControllerModule from './fulfillmentTypeController'\nimport ReservationConfirmationControllerModule from './reservationConfirmationController'\nimport ReservationControllerModule from './reservationController'\nimport TimeslotControllerModule from './timeslotController'\nimport TimeslotSelectorsModule from './timeslotSelectors'\nimport TimeslotSelectorStateControllerModule from './timeslotSelectorState.controller'\n\nimport template from './views/timeslotSelectorState.html'\n\nexport default angular\n  .module('TimeSlotComponentModule', [\n    FulfillmentAddressControllerModule.name,\n    FulfillmentTypeControllerModule.name,\n    ReservationConfirmationControllerModule.name,\n    ReservationControllerModule.name,\n    TimeslotControllerModule.name,\n    TimeslotSelectorsModule.name,\n    TimeslotSelectorStateControllerModule.name,\n  ])\n  .config(($stateProvider, langProvider) => {\n    $stateProvider.state('main.timeslot', {\n      url: '/timeslot?redirect',\n      views: {\n        'content@': {\n          template,\n        },\n      },\n      resolve: {\n        title(titleService) {\n          return titleService.setTitle(langProvider.values.timeslot)\n        },\n      },\n    })\n  })\n","import angular from 'angular'\nimport TimeSlotComponent from './timeslotRoutes.js'\n\nexport default angular.module('app.component.reserverationModule', [TimeSlotComponent.name])\n","import _ from 'lodash'\nimport angular from 'angular'\n\nexport default angular\n  .module('SearchComponent', [])\n  .config(($stateProvider, langProvider) => {\n    $stateProvider.state('main.search', {\n      url:\n        '/search?search_term&tags&sort&page&category_id&brand_name&brand_names&offer_sources&group_display_name&search_is_autocomplete&allow_autocorrect',\n\n      views: {\n        'content@': {\n          template: require('./views/search.html'),\n          controller: 'SearchController',\n        },\n      },\n      onEnter($state, $stateParams, tagsService) {\n        // If any of the tags in the new state's params require registration, ensure the user either registers or is logged in\n        if ($stateParams.tags && $stateParams.tags.length > 0) {\n          const activeTags = _.isArray($stateParams.tags)\n            ? angular.copy($stateParams.tags)\n            : [$stateParams.tags]\n\n          return tagsService.checkRegistrationRequired({\n            activeTags,\n            allTags: tagsService.tags(),\n            success: () => {}, // User gets to continue with the route change\n            failure: () => {\n              // Did not login/register, refresh the page without the required filter/tags (removed in checkRegistrationRequired)\n              $state.go('.', { tags: activeTags, page: null }, { reload: true })\n            },\n          })\n        }\n      },\n      resolve: {\n        loadCtrl: $ocLazyLoad => {\n          return import(\n            /* webpackChunkName: \"searchController\", webpackPrefetch: true */ './searchController'\n          )\n            .then(mod => $ocLazyLoad.load(mod.default))\n            .catch(err => {\n              throw new Error(`Ooops, something went wrong, ${err}`)\n            })\n        },\n        title($stateParams, titleService) {\n          return titleService.setTitle(\n            `${langProvider.values.searchResults}: ${$stateParams.search_term}`\n          )\n        },\n        fetchedRootCategories(catalogCategoriesService) {\n          let categories = catalogCategoriesService.rootCategories()\n          if (!categories) {\n            categories = catalogCategoriesService.fetchCategories().then(() => {\n              return catalogCategoriesService.rootCategories()\n            })\n          }\n          return categories\n        },\n        searchCategories($stateParams, configConstants, Restangular) {\n          if (configConstants.enableFacetedSearchFilters || configConstants.enableICSearch) {\n            return null // Facets replaces searchCategories if enabled.\n          }\n          // Checks if client has a custom `offer_sources` for `on_sale` products\n          if (\n            $stateParams.tags &&\n            $stateParams.tags.indexOf('on_sale') > -1 &&\n            configConstants.onSaleOfferSources\n          ) {\n            $stateParams.offer_sources = configConstants.onSaleOfferSources\n          }\n\n          // Checks if client has a custom `offer_sources` for `has_coupon` products\n          if (\n            $stateParams.tags &&\n            $stateParams.tags.indexOf('has_coupon') > -1 &&\n            configConstants.hasCouponOfferSources\n          ) {\n            $stateParams.offer_sources = configConstants.hasCouponOfferSources\n          }\n\n          return Restangular.all('categories')\n            .all('search')\n            .getList({ keyword: $stateParams.search_term })\n        },\n      },\n      params: {\n        toggledFilterId: null,\n      },\n    })\n\n    // For dotCom module search use\n    $stateProvider.state('main.search.types', {\n      url: '/types',\n      views: {\n        'content@': {\n          template: require('./views/search.html'),\n          controller: 'SearchPostsController',\n        },\n      },\n      resolve: {\n        loadCtrl: $ocLazyLoad => {\n          return import(/* webpackChunkName: \"searchPostsController\" */ './searchPostsController')\n            .then(mod => $ocLazyLoad.load(mod.default))\n            .catch(err => {\n              throw new Error(`Ooops, something went wrong, ${err}`)\n            })\n        },\n      },\n      onEnter($state, searchService) {\n        // Precautionary: if dotComSearch is disabled, then redirect to 404\n        if (!searchService.isDotComEnabled()) {\n          $state.go('main.404')\n        }\n      },\n    })\n\n    $stateProvider.state('main.search.recipes', {\n      url: '/recipes',\n      views: {\n        'content@': {\n          template: require('./views/search.html'),\n          controller: 'SearchRecipesController',\n        },\n      },\n      resolve: {\n        loadCtrl: $ocLazyLoad => {\n          return import(\n            /* webpackChunkName: \"searchRecipesController\" */ './searchRecipesController'\n          )\n            .then(mod => $ocLazyLoad.load(mod.default))\n            .catch(err => {\n              throw new Error(\n                langProvider.template(langProvider.values.defaultErrorMessageSuffix, { error: err })\n              )\n            })\n        },\n        title(titleService) {\n          return titleService.setTitle(langProvider.values.searchResults)\n        },\n        recipeTags: (tagsService, Restangular) => {\n          return Restangular.all('recipes')\n            .all('tags')\n            .getList()\n            .then(({ tags }) =>\n              tags\n                .map(tag => ({\n                  ...tagsService.byVal(tag.tag_name),\n                  name: tag.tag_display_name,\n                }))\n                // Filter out buggy tags with missing names and icons\n                // TODO find a consistent way to inform devs about things like missing configs\n                // either through proper logging or documentation\n                .filter(v => !!v.name && !!v.icon)\n            )\n        },\n        recipeCategoriesFetched: recipeCategoriesService => recipeCategoriesService.fetch(),\n        // eslint-disable-next-line no-unused-vars\n        recipeCategories: (recipeCategoriesService, recipeCategoriesFetched) => {\n          // This currently does not return the actual root categories as\n          // defined in the service as the recipe_categories/search endpoint\n          // below does not return actual root categories. This may be specific\n          // to Wegmans data only, but that's unknown currently\n          // Context: https://github.com/instacart/unata-buffet/pull/6701/files#r327146390\n\n          return recipeCategoriesService.categories\n        },\n        searchCategories: ($stateParams, recipeCategoriesService) => {\n          return recipeCategoriesService.searchCategories({\n            search_term: $stateParams.search_term,\n            recipe_category_id: $stateParams.category_id,\n            tags: $stateParams.tags,\n          })\n        },\n      },\n      onEnter($state, searchService) {\n        // If recipes search is disabled, then redirect to 404\n        if (!searchService.isRecipesEnabled()) {\n          $state.go('main.404')\n        }\n      },\n    })\n  })\n  .run($templateCache => {\n    $templateCache.put('searchProducts.html', require('./views/searchProducts.html'))\n    $templateCache.put('searchRecipes.html', require('./views/searchRecipes.html'))\n    $templateCache.put('searchPosts.html', require('./views/searchPosts.html'))\n    $templateCache.put(\n      'pagination-modified-uibootstrap-desktop.html',\n      require('../shared/pagination/pagination-modified-uibootstrap-desktop.html')\n    )\n    $templateCache.put(\n      'pagination-modified-uibootstrap-mobile.html',\n      require('../shared/pagination/pagination-modified-uibootstrap-mobile.html')\n    )\n  })\n","import angular from 'angular'\nimport SearchComponent from './searchRoutes.js'\n\nexport default angular.module('app.component.searchModule', [SearchComponent.name])\n","import angular from 'angular'\n\nexport default angular\n  .module('AddressAutocompleteModule', [])\n  .component('addressAutocompleteInput', {\n    bindings: {\n      inputAutoFocus: '<',\n      inputClass: '@',\n      inputId: '@',\n      inputName: '@',\n      inputRequired: '<',\n      inputPlaceholder: '<',\n      inputChangedCallback: '<',\n      addressChosenCallback: '<',\n      hasError: '&',\n      initialAddress: '<',\n      showStreetAddress: '@',\n      setAutoCompleteOptionSelected: '=',\n    },\n    controller(\n      $element,\n      $interval,\n      $scope,\n      $timeout,\n      lang,\n      addressSearchService,\n      errorModalService,\n      mobileService\n    ) {\n      this.$onInit = () => {\n        // Service\n        this.lang = lang\n\n        // Internal States\n        this.inputText = ''\n        this.autoCorrectResults = 0\n        this.autocomplete = null\n        this.autocompleteListener = null\n        this.pacContainer = null\n\n        // Instance names\n        this.autocompleteResultId = `${this.inputId}-autocomplete-results`\n        this.instructionId = `${this.inputId}-instructions`\n      }\n\n      this.$postLink = () => {\n        this.addressInputField = $element[0].children[0]\n\n        if (this.inputAutoFocus) {\n          this.addressInputField.focus()\n        }\n\n        // Set pre-filled address\n        if (this.initialAddress) {\n          this.inputText = this.initialAddress\n        }\n\n        // Initialize address autocomplete service with a11y enhancements\n        const handleArrowKeys = event => {\n          if (event.keyCode === 38 || event.keyCode === 40) {\n            this.addressInputField.setAttribute('aria-autocomplete', 'both')\n          }\n        }\n\n        const mutationCallback = mutationsList => {\n          // eslint-disable-next-line no-restricted-syntax\n          for (const mutation of mutationsList) {\n            if (mutation.type === 'childList' && mutation.addedNodes.length === 1) {\n              // Set a11y attributes for autocomplete results\n              if (mobileService.isMobileApp()) {\n                // For a11y on the mobile apps.\n                // First we insert a label for the address value for screen readers\n                const spanLabel = document.createElement('span')\n                spanLabel.setAttribute('aria-label', mutation.addedNodes[0].innerText)\n                spanLabel.setAttribute('class', 'screen-reader-text')\n                mutation.addedNodes[0].prepend(spanLabel)\n                // Next we use tabIndex attribute on the option container so that voiceover users can focus on an autocomplete suggestion\n                mutation.addedNodes[0].setAttribute('tabIndex', '0')\n              } else {\n                // role=\"option\" is required on the web for a11y but interferes with Talkback/Voiceover selecting an\n                // autocomplete result in the Cordova app\n                mutation.addedNodes[0].setAttribute('role', 'option')\n              }\n              const nodeID = mutation.addedNodes[0].innerText.replace(/\\s/g, '')\n              mutation.addedNodes[0].setAttribute('id', nodeID)\n              // Set aria attributes on input field if there are autocomplete results\n              this.addressInputField.setAttribute('aria-autocomplete', 'list')\n              this.addressInputField.setAttribute('aria-expanded', true)\n              this.addressInputField.setAttribute('aria-haspopup', 'listbox')\n              this.addressInputField.setAttribute('aria-controls', this.autocompleteResultId)\n\n              this.addressInputField.addEventListener('keydown', handleArrowKeys)\n\n              $timeout(() => {\n                // eslint-disable-next-line no-plusplus\n                this.autoCorrectResults++\n              })\n            } else {\n              // Targetting the 'mutation.addNotes.length === 0', ie. there are no autocomplete results,\n              // remove/update the aria attributes\n              this.addressInputField.setAttribute('aria-autocomplete', 'none')\n              this.addressInputField.setAttribute('aria-expanded', false)\n              this.addressInputField.removeAttribute('aria-haspopup')\n              this.addressInputField.removeAttribute('aria-controls')\n              this.autoCorrectResults = 0\n            }\n          }\n        }\n\n        const handleAddressSelected = address => {\n          // Gets triggered when user press enter on input field or suggestion list\n          // Also gets triggered when user tab out of the suggestion list while highlighting one of the addresses\n          $scope.$apply(() => {\n            if (this.showStreetAddress) {\n              this.inputText = address.address1\n            }\n\n            if (this.addressChosenCallback) {\n              address.address1 = address.address1 || this.inputText\n              this.addressChosenCallback(address)\n            }\n          })\n        }\n\n        addressSearchService.sdkLoaded\n          .then(() => {\n            const [autocomplete, autocompleteListener] = addressSearchService.addAutoCompleteWidget(\n              this.addressInputField,\n              handleAddressSelected\n            )\n\n            // Attach autocomplete instance and listener to scope for clean up\n            this.autocomplete = autocomplete\n            this.autocompleteListener = autocompleteListener\n\n            const interval = $interval(\n              () => {\n                if (this.pacContainer) {\n                  return $interval.cancel(interval)\n                }\n\n                const autocompleteContainers = document.getElementsByClassName('pac-container')\n\n                // Find autocomplete container associated with the input\n                let containerIndex\n\n                for (\n                  containerIndex = 0;\n                  containerIndex < autocompleteContainers.length;\n                  containerIndex += 1\n                ) {\n                  if (!autocompleteContainers[containerIndex].id) {\n                    this.pacContainer = autocompleteContainers[containerIndex]\n                  }\n                }\n\n                // Set required a11y attributes on autocomplete container\n                if (!mobileService.isMobileApp()) {\n                  // listbox attribute prevents selection by Talkback/Voiceover users in the Cordova apps, so conditionally apply for web only\n                  this.pacContainer?.setAttribute('role', 'listbox')\n                }\n                this.pacContainer?.setAttribute('aria-labelledby', 'continue-with-zip-code-label')\n                this.pacContainer?.setAttribute('id', this.autocompleteResultId)\n\n                // Move autocomplete results to be under the same parent as the input\n                // By default this results node is appended to the body and automatically position themselves next to the input\n                // Since we use autocomplete in modals, we need to move it to get the right stacking context\n                this.addressInputField.parentNode.appendChild(this.pacContainer)\n\n                // There's an issue where items in the autocomplete dropdown cannot\n                // be selected on mobile devices. This fixes it.\n                this.pacContainer.addEventListener('touchstart', evt => {\n                  evt.stopImmediatePropagation()\n                })\n\n                const observer = new MutationObserver(mutationCallback)\n\n                // We use this mutation observer to track when Google Maps SDK inserts a new\n                // autocomplete suggestion in the list so we can then add a11y attributes to it (in mutationCallback)\n                observer.observe(this.pacContainer, { childList: true })\n\n                // Google map sdk overrides this attribute to off resulting in Chrome autofill\n                // interfering with address autocomplete. Setting autocomplete attribute to\n                // random string will disable Chrome autofill feature\n                this.addressInputField.setAttribute(\n                  'autocomplete',\n                  `address-line-${Math.min(containerIndex, 2)}`\n                )\n              },\n              300,\n              10\n            )\n          })\n          .catch(err => {\n            errorModalService.open(err.data?.message || err.message, 'OK')\n          })\n\n        this.inputChanged = () => {\n          if (this.inputText === '') {\n            this.autoCorrectResults = 0\n          }\n          if (this.inputChangedCallback) {\n            this.inputChangedCallback(this.inputText)\n          }\n        }\n\n        // Track the autocomplete cursor for a11y\n        this.trackAriaActiveDescendant = () => {\n          $timeout(() => {\n            const focusedAutocompleteElement = document.getElementsByClassName('pac-item-selected')\n            if (focusedAutocompleteElement?.length > 0) {\n              this.addressInputField.setAttribute(\n                'aria-activedescendant',\n                focusedAutocompleteElement[0].id\n              )\n            } else {\n              this.clearActiveDescendant()\n            }\n\n            if (this.setAutoCompleteOptionSelected) {\n              this.setAutoCompleteOptionSelected(!!focusedAutocompleteElement?.length)\n            }\n          })\n        }\n\n        this.clearActiveDescendant = () => {\n          this.addressInputField.removeAttribute('aria-activedescendant')\n        }\n\n        this.onBlur = () => {\n          this.clearActiveDescendant()\n\n          if (this.addressChosenCallback) {\n            this.addressChosenCallback({ address1: this.inputText })\n          }\n        }\n      }\n\n      this.$onDestroy = () => {\n        addressSearchService.removeAutoCompleteWidget(\n          this.autocomplete,\n          this.autocompleteListener,\n          this.pacContainer\n        )\n      }\n    },\n    template: `\n      <input\n        id=\"{{::$ctrl.inputId}}\"\n        class=\"{{::$ctrl.inputClass}}\"\n        type=\"text\"\n        name=\"{{::$ctrl.inputName}}\"\n        ng-model=\"$ctrl.inputText\"\n        ng-change=\"$ctrl.inputChanged(event)\"\n        ng-keyup=\"$ctrl.trackAriaActiveDescendant()\"\n        ng-class=\"{error: $ctrl.hasError()}\"\n        placeholder=\"{{::$ctrl.inputPlaceholder}}\"\n        aria-label=\"{{::$ctrl.lang.aria.enter + ' ' + $ctrl.lang.aria.address}}\"\n        aria-describedby=\"{{::$ctrl.instructionId}}\"\n        ng-blur=\"$ctrl.onBlur()\"\n        ng-required=\"::$ctrl.inputRequired\"\n      >\n      <span class=\"validation-icon\" aria-hidden=\"true\"></span>\n      <div id=\"{{::$ctrl.instructionId}}\" class=\"screen-reader-text\">{{$ctrl.lang.aria.addressAutocompleteInstructions}}</div>\n      <div class=\"screen-reader-text\" aria-live=\"assertive\">{{$ctrl.lang.templateAsString( $ctrl.lang.aria.addressAutocompleteResultsMessage, { number:\n        $ctrl.autoCorrectResults } )}}</div>\n    `,\n  })\n","import angular from 'angular'\nimport AddressAutocompleteInput from './addressAutocomplete.component.js'\n\nexport default angular.module('app.component.AddressAutocompleteModule', [\n  AddressAutocompleteInput.name,\n])\n","import _ from 'lodash'\nimport angular from 'angular'\nimport { ADDRESS_FIELDS } from '@app/angular/constants/address'\n\nimport template from './addressList.html'\n\nexport default angular.module('AddressListComponentModule', []).component('addressList', {\n  bindings: {\n    selectableAddresses: '@',\n    selectAddressCallback: '&',\n    editAddressCallback: '&',\n    currentAddress: '<',\n    validateAddress: '<',\n    /**\n     * Boolean flag wether to display the new address entry form,\n     * or hide it and leave it to the user to click the \"Add new address\" button\n     **/\n    hideAddressFormOnLoad: '<',\n    showSaveMessages: '<',\n    /** Boolean flag wether to display some idle message when there are no address entries */\n    showIdleMessage: '<',\n    /** An optional message that will appear on the top left of the list of addresses */\n    textHeader: '<',\n    optionalFields: '<?',\n  },\n  template,\n  controller: function (\n    $rootScope,\n    $scope,\n    $state,\n    $timeout,\n    addressList,\n    addressValidationService,\n    analytics,\n    auth,\n    config,\n    errorModalService,\n    lang\n  ) {\n    const vm = this\n\n    Object.assign(vm, {\n      lang,\n      addressList,\n      config,\n      profile: null,\n      successMessage: '',\n      selectedAddress: null,\n      currentEditingId: null,\n      currentEditingItem: null,\n      editableAddresses: !vm.selectableButtons,\n      selectableRadios: vm.selectableAddresses === 'radio',\n      selectableButtons: vm.selectableAddresses === 'button',\n    })\n\n    vm.$onInit = () => {\n      vm.optionalFields = vm.optionalFields || []\n    }\n\n    const selectAddressFromCurrentAddress = address => {\n      if (address.id) {\n        const addressItem = _.find(vm.addressList.addressItems, o => o.id === address.id)\n        if (addressItem) {\n          return addressItem\n        }\n      }\n\n      let filteredAddresses = vm.addressList.addressItems\n      let selectedAddress\n      const ADDRESS_KEYS = [\n        ADDRESS_FIELDS.POSTAL_CODE,\n        ADDRESS_FIELDS.CITY,\n        ADDRESS_FIELDS.ADDRESS_LINE_ONE,\n        ADDRESS_FIELDS.ADDRESS_LINE_TWO,\n        ADDRESS_FIELDS.LAST_NAME,\n        ADDRESS_FIELDS.FIRST_NAME,\n        ADDRESS_FIELDS.PHONE_NUMBER,\n        ADDRESS_FIELDS.INSTRUCTIONS,\n      ]\n      for (let i = 0; i < ADDRESS_KEYS.length; i++) {\n        const key = ADDRESS_KEYS[i]\n        if (address[key] && filteredAddresses.length) {\n          filteredAddresses = _.filter(filteredAddresses, o => o[key] === address[key])\n          if (filteredAddresses && filteredAddresses.length) {\n            selectedAddress = filteredAddresses[0]\n            if (filteredAddresses.length === 1) {\n              return selectedAddress\n            }\n          }\n        }\n      }\n      return selectedAddress\n    }\n\n    const prefillNewAddress = () => {\n      const { id, ...addressWithoutId } = vm.currentAddress || {}\n      // null index means there's no item being currently edited and the form should not be shown\n      const initialIndex = vm.hideAddressFormOnLoad ? null : -1\n      vm.editAddressItem(initialIndex, addressWithoutId)\n    }\n\n    vm.getAddressItems = () => {\n      return addressList.getAddresses().then(response => {\n        if (vm.addressList.addressItems.length === 0) {\n          // Open the New address form if there are no saved addresses.\n          prefillNewAddress()\n        }\n      })\n    }\n\n    vm.getAddressItems().then(() => {\n      if (vm.selectableRadios && vm.currentAddress) {\n        // Set the correct selected address id.\n        const selectedAddress = selectAddressFromCurrentAddress(vm.currentAddress)\n        if (selectedAddress && selectedAddress.id) {\n          vm.selectedAddress = selectedAddress.id\n\n          if (!addressValidationService.isAddressComplete(selectedAddress, vm.optionalFields)) {\n            vm.editAddressItem(vm.selectedAddress)\n            return\n          }\n\n          vm.onAddressSelected(selectedAddress)\n        } else if (vm.currentAddress && vm.currentAddress.postal_code) {\n          // Prefill new address if none of the existing ones match.\n          prefillNewAddress()\n        }\n      }\n    })\n\n    const _mergeProfileToAddress = (profile, address) => {\n      const { first_name, last_name, phone_number } = profile\n      return { first_name, last_name, phone_number, ...address }\n    }\n\n    const _handleProfileFetch = profile => {\n      const { context = {}, first_name, last_name, primary_number_key } = profile\n      const phone_number = profile[primary_number_key]\n\n      return {\n        address1: context.street_address,\n        city: context.city,\n        first_name,\n        last_name,\n        phone_number,\n        province: context.province,\n        postal_code: context.deliveryPostalCode,\n      }\n    }\n\n    const _setProfile = profile => {\n      vm.profile = profile\n      vm.currentEditingItem = _mergeProfileToAddress(profile, vm.currentEditingItem)\n    }\n\n    vm.editAddressItem = (itemId, initialAddress) => {\n      // Prevent this action if user is modifying IC order\n      if ($rootScope.modifyingInstacartOrder) return\n\n      vm.resetSuccessMessage()\n      vm.currentEditingId = itemId\n\n      // Add new address\n      if (itemId === -1) {\n        vm.currentEditingItem = initialAddress || {}\n        if (vm.profile) {\n          // prefill first name, last name and phone number from profile\n          vm.currentEditingItem = _mergeProfileToAddress(vm.profile, vm.currentEditingItem)\n        } else {\n          auth.getProfile().then(_handleProfileFetch).then(_setProfile)\n        }\n      } else if (itemId === null) {\n        vm.currentEditingItem = null\n      } else {\n        vm.currentEditingItem = angular.copy(\n          _.find(vm.addressList.addressItems, o => o.id === itemId)\n        )\n      }\n\n      vm.editingAddress(vm.currentEditingItem)\n    }\n\n    $scope.$on('editAddressItem', (event, { itemId, initialAddress }) =>\n      vm.editAddressItem(itemId, initialAddress)\n    )\n\n    vm.editingAddress = address => {\n      vm.editAddressCallback && vm.editAddressCallback({ address })\n    }\n\n    vm.cancelAddressEdit = () => {\n      const index = vm.addressList.addressItems.findIndex(item => item.id === vm.currentEditingId)\n      vm.editAddressItem(null)\n\n      $timeout(() => {\n        document\n          .getElementById('saved-address-list')\n          .querySelectorAll('.address-list-item-action-edit')\n          [index]?.focus()\n      })\n    }\n\n    vm.selectedLoading = false\n    vm.onAddressSelected = (address, saveSelectedAddress) => {\n      if (vm.selectAddressCallback) {\n        vm.selectedLoading = true\n        // The return can sometimes be a promise or null.\n        // Therefore, try to resolve the promise before turning off the loading wheel.\n        try {\n          vm.selectAddressCallback({ address, saveSelectedAddress }).finally(() => {\n            vm.selectedLoading = false\n          })\n        } catch (TypeError) {\n          vm.selectedLoading = false\n        }\n      }\n    }\n\n    vm.onAddressSave = address => {\n      vm.setSuccessMessage()\n      vm.editAddressItem(null)\n      // Select the address that just got saved if radio inputs are shown.\n      if (vm.selectableAddresses && address.id) {\n        vm.selectedAddress = address.id\n        vm.onAddressSelected(address, true)\n      }\n    }\n\n    vm.deleteAddressItem = itemId => {\n      // Prevent this action if user is modifying IC order\n      if ($rootScope.modifyingInstacartOrder) return\n\n      vm.resetSuccessMessage()\n      errorModalService\n        .open(\n          lang.values.addressDeleteConfirmation,\n          lang.values.yes,\n          lang.values.cancel,\n          lang.values.addressDelete\n        )\n        .then(() => {\n          addressList\n            .deleteAddress(itemId)\n            .then(response => {\n              vm.editAddressItem(null)\n              vm.setSuccessMessage('Address deleted successfully!')\n              // Unselect the current address if it's the one that was deleted.\n              if (vm.selectedAddress === itemId) {\n                vm.selectedAddress = null\n                vm.onAddressSelected({})\n              }\n              return response\n            })\n            .catch(response => {\n              if (response.error === 40304) {\n                registrationService.promptLogin(\n                  $state.current.name,\n                  '',\n                  '',\n                  '',\n                  lang.values.loginToContinue\n                )\n              } else {\n                vm.error = response.data ? response.data.message : response.message\n              }\n            })\n        })\n    }\n\n    vm.setSuccessMessage = message => (vm.successMessage = message || 'Address saved successfully!')\n    vm.resetSuccessMessage = () => (vm.successMessage = '')\n  },\n})\n","import angular from 'angular'\nimport AddressList from './addressList.component'\n\nexport default angular.module('app.shared.addressList', [AddressList.name])\n","import _ from 'lodash'\nimport angular from 'angular'\nimport { ADDRESS_FIELDS } from '@app/angular/constants/address'\n\nimport template from './addressListForm.html'\n\nexport default angular.module('AddressListFormComponentModule', []).component('addressListForm', {\n  bindings: {\n    data: '<',\n    onSave: '&',\n    onCancel: '&',\n    onDelete: '&',\n    validateAddress: '<',\n    useContinueCopy: '<',\n    saveToDb: '<',\n    optionalFields: '<?',\n  },\n  template,\n  controller($q, $scope, $state, $timeout, addressList, config, lang, registrationService) {\n    const vm = this\n    vm.addressList = addressList\n    vm.lang = lang\n    vm.config = config\n    vm.ADDRESS_FIELDS = ADDRESS_FIELDS\n\n    const handleErrorResponse = response => {\n      if (response.error === 40304) {\n        registrationService.promptLogin(\n          $state.current.name,\n          '',\n          '',\n          '',\n          lang.values.loginToContinue\n        )\n      } else {\n        vm.error = response.data ? response.data.message : response.message\n      }\n    }\n\n    vm.$onInit = () => {\n      vm.saveToDb = !!(vm.saveToDb || _.isNil(vm.saveToDb))\n    }\n\n    vm.addressChosenCallback = address => {\n      // address can be manually edited by user so should update alone\n      if (address.address1) {\n        vm.data.address1 = address.address1\n        $scope.addressForm.address1.$setValidity('address1', true)\n      }\n      if (address.city || address.province_short || address.postal_code) {\n        vm.data.city = address.city\n        $scope.addressForm.city.$setTouched()\n        address.city && $scope.addressForm.city.$setValidity('city', true)\n        vm.data.province = address.province_short\n        $scope.addressForm.province.$setTouched()\n        address.province_short && $scope.addressForm.province.$setValidity('province', true)\n        vm.data.postal_code = address.postal_code\n        $scope.addressForm.postalCode.$setTouched()\n        address.postal_code && $scope.addressForm.postalCode.$setValidity('postalCode', true)\n      }\n\n      $timeout(() => {\n        const missingFields = document.getElementsByClassName('address-input-field ng-invalid')\n        if (missingFields.length) {\n          missingFields[0].focus()\n        }\n      })\n    }\n\n    vm.saveAddress = () => {\n      delete vm.error\n      delete vm.message\n\n      if (!vm.saveToDb) {\n        const address = vm.data\n\n        vm.onSave({ address })\n        return $q.resolve(address)\n      }\n\n      return addressList.saveAddress(vm.data).then(address => {\n        addressList.unMarkAddressValidated(address.id)\n        vm.message = 'Saved changes successfully!'\n        vm.onSave({ address })\n        return address\n      })\n    }\n\n    vm.normalizeData = () => {\n      // Normalize postal code\n      vm.data.postal_code = vm.data.postal_code?.toUpperCase().replace(/\\s/g, '')\n    }\n\n    vm.validateAddressAndSave = () => {\n      if ($scope.addressForm.$invalid) {\n        $scope.addressForm.address1.$setTouched()\n        $scope.addressForm.city.$setTouched()\n        $scope.addressForm.postalCode.$setTouched()\n        $scope.addressForm.firstName.$setTouched()\n        $scope.addressForm.lastName.$setTouched()\n        $scope.addressForm.phoneNumber.$setTouched()\n\n        return\n      }\n\n      vm.normalizeData()\n\n      if (vm.validateAddress) {\n        addressList\n          .validateAddress(vm.data)\n          .then(() => vm.saveAddress())\n          .then(address => addressList.markAddressValidated(address.id))\n          .catch(error => error && handleErrorResponse(error))\n      } else {\n        vm.saveAddress().catch(error => error && handleErrorResponse(error))\n      }\n    }\n\n    vm.cancelAddressEdit = () => vm.onCancel()\n\n    vm.isFieldRequired = field => !vm.optionalFields || !vm.optionalFields.includes(field)\n  },\n})\n","import angular from 'angular'\nimport AddressListForm from './addressListForm.component'\n\nexport default angular.module('app.shared.addressListForm', [AddressListForm.name])\n","import angular from 'angular'\nimport { product } from '@instacart/enterprise-services'\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\n\nimport template from './templates/addToCartButton.ng.html'\nimport reactTemplate from './templates/addToCartButton.react.html'\nimport triggerTemplate from './templates/addToCartTrigger.html'\nimport modifyTemplate from './templates/addToCartModify.html'\n\nexport default angular\n  .module('AddToCartModule', [])\n  .directive('addToCart', function () {\n    return {\n      scope: {\n        product: '=',\n        small: '@',\n        isDropdown: '=',\n        location: '@',\n        locationValue: '<',\n        index: '<',\n        configuration: '=?',\n        existingCartItems: '=',\n        isProductCell: '=',\n        isRelatedProduct: '=?',\n        existingConfigSingular: '=',\n        isModal: '=?',\n        reactStyles: '<',\n        useReact: '<',\n        color: '<',\n        aggregateQuantity: '=',\n        buttonType: '@',\n        triggerCallback: '&',\n        removeCallback: '&',\n      },\n      template: '<div ng-include=\"templateUrl\"></div>',\n      controller(\n        $rootScope,\n        $sce,\n        $scope,\n        $state,\n        addToCartService,\n        auth,\n        analytics,\n        cartAnalytics,\n        cartService,\n        collectionsService,\n        config,\n        configurableProductService,\n        lang,\n        mobileService,\n        orderWeightOptionsService,\n        productDetailsModal,\n        productsService,\n        rateApp,\n        $element,\n        capitalizeFilter\n      ) {\n        const element = $element[0]\n        const isProductDetails = !$scope.isProductCell && !$scope.isRelatedProduct\n\n        /*  React Template will be used under following conditions:\n         *   - It's Product Details page\n         *   - react.enableAddToCart is true in config\n         *   - Product has no configurable products\n         */\n\n        $scope.isConfigurableProduct = $scope.product?.product_config?.options\n\n        const ariaLabelAddText = capitalizeFilter(\n          auth.getContext().intent === 'instore'\n            ? lang.values.addToListButtonLabel\n            : lang.values.addToCartButtonLabel\n        )\n\n        $scope.templateUrl =\n          $scope.useReact && config.react.enableAddToCart && $scope.isConfigurableProduct\n            ? 'templates/addToCartButton.react.html'\n            : 'templates/addToCartButton.ng.html'\n\n        // Overwrite the existing templateUrl if a type is provided\n        if ($scope.buttonType === 'trigger') {\n          $scope.templateUrl = 'templates/addToCartTrigger.html'\n        }\n\n        if ($scope.buttonType === 'modify') {\n          $scope.templateUrl = 'templates/addToCartModify.html'\n        }\n\n        $scope.selectedQuantity = {\n          value: null,\n        }\n\n        $scope.mobile = mobileService\n        $scope.lang = lang\n        $scope.auth = auth\n        $scope.config = config\n        $scope.cartAnalytics = cartAnalytics\n        $scope.cartService = cartService\n        $scope.analytics = analytics\n        $scope.isProductDetails = isProductDetails\n        $scope.productsService = productsService\n        $scope.orderWeightOptionsService = orderWeightOptionsService\n        $scope.idStringContext = $scope.location\n          ? `-${$scope.location.toLowerCase().replace(/\\s/g, '-')}`\n          : ''\n        $scope.addButtonARIALabel = `${ariaLabelAddText} ${$scope.product.name || ''}`\n        $scope.isDynamicCollection = false\n\n        // If a product max has been passed, check to see if the number of products in the cart exceeds the limit\n        // This is used to disable and warn users\n        // TODO - implement in react\n        $scope.maxInCart = $scope.product?.ext_data?.max_in_cart ?? null\n        $scope.hasReachedProductAddLimit = () =>\n          $scope.maxInCart && ($scope.cartItem?.quantity || $scope.quantity) >= $scope.maxInCart\n\n        // Check if the product is in stock\n        $scope.isProductInStock = product.utils.isProductAvailable($scope.product)\n\n        $scope.enableOutOfStockAdd = config.enableOutOfStockAddToCartContexts?.includes(\n          auth.getContext().intent\n        )\n\n        if ($state.current.name === 'main.shop.collection' && $state.params.collection_id) {\n          collectionsService\n            .getCollection($state.params.collection_id, 1, false)\n            .then(collection => {\n              $scope.isDynamicCollection = collection.dynamic || false\n            })\n        }\n\n        /*\n         * HTML Popovers\n         * This isn't an ideal way to do it, but I can't figure out how to make this DRY in Angular\n         */\n        $scope.maxQuantityWarningPopover = $sce.trustAsHtml(\n          `<span class=\"icon-warning add-to-cart__warning\" aria-hidden=\"true\"></span> ${lang.template(\n            lang.values.limitPerOrder,\n            { limit: $scope.maxInCart }\n          )}`\n        )\n\n        $scope.outOfStockWarningPopover = $sce.trustAsHtml(\n          `<span class=\"icon-warning add-to-cart__warning\" aria-hidden=\"true\"></span> ${lang.values.outOfStockDescription}`\n        )\n\n        // Literally hacking this in for 2.23 for WEG launch, will create a PR to remove it in 2.24\n        $scope.accessibleItemRemoved = () => {\n          element.querySelector(`#add-to-cart-ada-decrement-${$scope.product.id}`).textContent = ''\n          element.querySelector(`#add-to-cart-ada-decrement-${$scope.product.id}`).textContent = `${\n            $scope.product.name\n          } was removed from your shopping cart, you have ${\n            $scope.quantity - 1\n          } remaining in your cart`\n        }\n        // Ditto\n        $scope.accessibleItemAdded = () => {\n          element.querySelector(`#add-to-cart-ada-increment-${$scope.product.id}`).textContent = ''\n          element.querySelector(`#add-to-cart-ada-increment-${$scope.product.id}`).textContent = `${\n            $scope.product.name\n          } was added to your shopping cart, you have ${$scope.quantity + 1} in your cart`\n          setTimeout(() => {\n            const addItemIncrementElement = element.querySelector(\n              `#add-to-cart-button-cart-service-update-item-quantity-increment-${$scope.product.id}${$scope.idStringContext}`\n            )\n            if (addItemIncrementElement) {\n              addItemIncrementElement.focus()\n            }\n          }, 0)\n        }\n\n        const context = auth.getContext().intent\n        const isInstoreContent = context === 'instore'\n        const addToCartConfigProps = config.reactProps.addToCart\n\n        const { index } = $scope\n\n        // Register analytics\n        addToCartService.registerAddToCartAnalytics(element, index)\n\n        // Functions\n        const getCornerDistance = () => {\n          return addToCartService.getCornerDistance(element, $scope.index)\n        }\n\n        const formatQuantity = (item = {}) => {\n          return addToCartService.formatQuantity($scope.product, item.quantity)\n        }\n\n        const linkToProductDetails = productId => {\n          productDetailsModal.open(productId, {\n            location: $scope.location,\n            locationValue: $scope.locationValue,\n          })\n        }\n\n        // Add or update product by weight\n        const updateWeight = (configuration, selectedQuantity) => {\n          addToCartService.updateWeight({\n            cartItem: $scope.cartItem,\n            configuration: [configuration],\n            element,\n            index: $scope.index,\n            isModal: $scope.isModal,\n            location: $scope.location,\n            locationValue: $scope.locationValue,\n            product: $scope.product,\n            quantity: $scope.quantity,\n            selectedQuantity,\n          })\n        }\n\n        const appReviewCheck = () => {\n          addToCartService.appReviewCheck(rateApp)\n        }\n\n        // Tell the parent scopes when a product was added so the product cell can show recommended\n        const tellParents = () => {\n          addToCartService.tellParents($scope.product)\n        }\n\n        // REACT bindings\n        $scope.passToCtrl = {}\n        $scope.addToCartContent = ''\n        $scope.variant = addToCartConfigProps.variant\n        $scope.addIcon = $scope.product.order_by_weight\n          ? addToCartConfigProps.addIcon.order_by_weight\n          : addToCartConfigProps.addIcon.order_by_each\n        // eslint-disable-next-line no-unused-expressions\n        config.reactProps.addToCart.iconBefore\n        $scope.labelButtonProps = {\n          iconBefore:\n            addToCartConfigProps.iconBefore[context] !== undefined\n              ? addToCartConfigProps.iconBefore[context]\n              : 'icon-cart',\n          iconAfter: addToCartConfigProps.iconAfter[context],\n        }\n        $scope.placeholder = isInstoreContent\n          ? lang.values.addToListButtonLabel\n          : lang.values.addToCartButtonLabel\n\n        $scope.items = []\n\n        $scope.onAdd = () => {\n          addToCartService.onAdd({\n            element,\n            index: $scope.index,\n            isModal: $scope.isModal,\n            location: $scope.location,\n            locationValue: $scope.locationValue,\n            passToCtrl: $scope.passToCtrl,\n            product: $scope.product,\n            quantity: $scope.quantity,\n          })\n        }\n\n        $scope.onDropDownSelect = e => {\n          updateWeight($scope.configuration, parseFloat(e.currentTarget.value))\n          appReviewCheck()\n        }\n\n        $scope.onRemove = () => {\n          addToCartService.onRemove({\n            element,\n            index: $scope.index,\n            isModal: $scope.isModal,\n            location: $scope.location,\n            locationValue: $scope.locationValue,\n            product: $scope.product,\n            quantity: $scope.quantity,\n          })\n        }\n\n        // Only implemented on trigger button\n        $scope.onTrigger = () => {\n          if ($scope.triggerCallback) {\n            $scope.triggerCallback()\n          }\n        }\n\n        // Only implemented on modify add to cart variant\n        $scope.onAllItemsRemoved = () => {\n          if ($scope.removeCallback && ($scope.quantity === 0 || $scope.quantity === 1)) {\n            $scope.removeCallback()\n          }\n        }\n\n        // Watch for changes to cart and update local scope\n        function update(newConfiguration) {\n          // Check if a new config is passed in via configurable product directive option click\n          const updatedConfiguration = newConfiguration || $scope.configuration\n\n          // Checks if there is no more than one config in cart (passed down from productCell)\n          // This is to handle \"select default\" behaviour for configurable products\n          if ($scope.product && !$scope.existingConfigSingular) {\n            if (updatedConfiguration && $scope.product.product_config) {\n              const selectedConfiguration = configurableProductService.formatConfigForCart(\n                $scope.product,\n                updatedConfiguration\n              )\n\n              // Checks if configuration already exists in cart\n              const item = cartService.getItem($scope.product, selectedConfiguration)\n\n              if (\n                item &&\n                item.product_config &&\n                configurableProductService.isConfigEqual(\n                  item.product_config.options,\n                  selectedConfiguration\n                )\n              ) {\n                $scope.cartItem = item\n                $scope.quantity = item ? item.quantity : 0\n                $scope.addToCartContent = formatQuantity(item)\n              } else {\n                $scope.cartItem = $scope.product\n                $scope.quantity = item ? item.quantity : 0\n                $scope.addToCartContent = formatQuantity($scope.product)\n              }\n            } else {\n              // Checks if standard product already exists in cart\n              const item = cartService.getItem($scope.product)\n              $scope.cartItem = item\n              $scope.quantity = item ? item.quantity : 0\n              $scope.addToCartContent = formatQuantity(item)\n            }\n          } else if ($scope.existingConfigSingular) {\n            $scope.cartItem = $scope.existingConfigSingular\n            $scope.quantity = $scope.existingConfigSingular.quantity\n          }\n\n          $scope.selectedQuantity.value = $scope.quantity > 0 ? $scope.quantity : null\n\n          const orderWeightOptions =\n            $scope.product && orderWeightOptionsService.generate({ product: $scope.product })\n\n          $scope.orderWeightOptions = orderWeightOptions\n          $scope.items = mobileService.isMobile ? [] : orderWeightOptions\n          $scope.addToCartContent = formatQuantity($scope.cartItem)\n        }\n\n        $scope.linkToProductDetails = linkToProductDetails\n        $scope.updateWeight = updateWeight\n        $scope.appReviewCheck = appReviewCheck\n        $scope.tellParents = tellParents\n        $scope.getCornerDistance = getCornerDistance\n\n        // Deregister functions\n        const deregisterGroupWatcher = $scope.$watchGroup(\n          ['cartService.lastUpdated', 'product'],\n          () => update()\n        )\n        const deregisterCartServiceWatcher = $scope.$on('cartService', (event, method, item) => {\n          if (\n            $scope.product &&\n            (method === 'add' || method === 'remove') &&\n            item &&\n            item.store_product &&\n            item.store_product.id === $scope.product.id\n          ) {\n            update()\n          }\n        })\n        const deregisterConfigurableChangeWatcher = $scope.$on(\n          'configurableProduct',\n          (event, newConfiguration) => {\n            update(newConfiguration)\n          }\n        )\n        $scope.$on('$destroy', () => {\n          deregisterGroupWatcher()\n          deregisterCartServiceWatcher()\n          deregisterConfigurableChangeWatcher()\n        })\n\n        $scope.getAddToCartLabel = () =>\n          auth.getContext().intent === SHOPPING_MODES.INSTORE_LIST\n            ? lang.values.addToListButtonLabel\n            : $rootScope.modifyingOrder\n            ? lang.values.addToOrderButtonLabel\n            : lang.values.addToCartButtonLabel\n      },\n    }\n  })\n  .run($templateCache => {\n    $templateCache.put('templates/addToCartModify.html', modifyTemplate)\n    $templateCache.put('templates/addToCartTrigger.html', triggerTemplate)\n    $templateCache.put('templates/addToCartButton.react.html', reactTemplate)\n    $templateCache.put('templates/addToCartButton.ng.html', template)\n  })\n","import _ from 'lodash'\nimport angular from 'angular'\n\nexport default angular\n  .module('orderWeightOptionsServiceModule', [])\n  .service('orderWeightOptionsService', function orderWeightOptionsService() {\n    /**\n     * Memoized generator for order weight options\n     * (must have one param only to work with _.memoize)\n     */\n    this.generate = _.memoize(\n      /**\n       * Generates order weight options\n       *\n       * @param {object} product                        - The product item\n       * @param {boolean} [includeZeroOption = false]   - Whether to include a 0lbs option or not\n       * @returns {{object}[]}                          - Array of label/value objects\n       */\n      ({ product, includeZeroOption = false }) => {\n        const { order_by_weight, ordering_parameters } = product || {}\n\n        if (order_by_weight) {\n          const { display_name, increment, min, max } = ordering_parameters || {}\n          const result = includeZeroOption ? [0] : []\n          let ii = min\n\n          do {\n            result.push(ii)\n            const previous = ii\n            ii = parseFloat((ii + increment).toFixed(2))\n\n            // Prevent infinite loops\n            if (ii === previous) {\n              break\n            }\n          } while (ii <= max)\n\n          return result.map(value => ({ value, label: `${value} ${display_name}` }))\n        }\n      },\n      ({ product, includeZeroOption }) => {\n        // Use ordering parameters as the memoize hash\n        return JSON.stringify({\n          ordering_parameters: product?.ordering_parameters,\n          includeZeroOption,\n        })\n      }\n    )\n  })\n","import angular from 'angular'\nimport AddToCartButton from './addToCartButton'\nimport OrderWeightOptionsService from './orderWeightOptionsService'\n\nexport default angular.module('app.shared.addToCartButton', [\n  AddToCartButton.name,\n  OrderWeightOptionsService.name,\n])\n","import angular from 'angular'\nimport template from './addToList.html'\n\nexport default angular.module('AddToListComponentModule', []).component('addToList', {\n  bindings: {\n    products: '<',\n    toggleStyle: '@?',\n    configuration: '<?', // the configuration the user has selected in the PDP\n    isConfigurationInvalid: '<?', // if the configuration is valid (has all required fields)\n    popoverButtonExtraClass: '@?',\n    isExternalRoutesDisabled: '<',\n  },\n  template,\n  replace: true,\n  controller($element, $timeout, analytics, auth, lang, list, mobileService) {\n    this.isMobile = mobileService.isMobile\n    this.isTrialUser = auth.user.status !== 'trial'\n    this.lang = lang\n    this.lists = list.lists\n    this.toggleStyle = this.toggleStyle || 'button'\n    this.popoverButtonExtraClass = this.popoverButtonExtraClass || ''\n\n    this.toggled = open => {\n      if (!open) {\n        // return focus to toggle button once modal is closed\n        $element[0].querySelector('.add-to-list-button').focus()\n      }\n    }\n\n    this.close = function () {\n      this.dropdownIsOpen = false\n    }\n\n    this.productsAreIn = someList => list.itemsInList(this.products, someList, this.configuration)\n\n    this.productsAreInOneList = () => list.itemsInOneList(this.products, this.configuration)\n\n    this.addOrRemoveItemsFrom = targetList => {\n      if (this.products.length > 0) {\n        if (this.productsAreIn(targetList)) {\n          // Item(s) is/are IN the list, remove it/them\n          list.removeItems(this.products, targetList, this.configuration)\n        } else {\n          // Item(s) is/are NOT in the list, add it/them\n          list.addItems(this.products, targetList, this.configuration)\n          const payload = {\n            product_id: this.products[0].id,\n            list_name: targetList.name,\n            source: this.toggleStyle === 'icon' ? 'productTile' : 'productDetail',\n          }\n          analytics.logSegmentEvent('store.save_for_later', payload)\n        }\n      }\n    }\n\n    this.createNewList = () => {\n      this.isCreatingNewList = true\n\n      list.create(this.newListName, this.products, this.configuration).then(() => {\n        // Reset new list name input and isCreatingNewList flag\n        delete this.newListName\n        delete this.isCreatingNewList\n      })\n    }\n  },\n})\n","import angular from 'angular'\nimport AddToList from './addToList.component'\n\nexport default angular.module('app.shared.addToList', [AddToList.name])\n","import { registerPlugin } from '@capacitor/core'\n\nexport interface Channel {\n  id: string\n}\n\ninterface UrbanAirship {\n  getChannel(): Promise<Channel>\n}\n\nconst Airship = registerPlugin<UrbanAirship>('UrbanAirshipPlugin')\n\nexport default Airship\n","import isCapacitor from '@app/utils/isCapacitor'\nimport UrbanAirshipPlugin from '@app/react/mobile/plugins/urbanAirshipPlugin'\n\nexport function getUrbanAirshipChannelId(cb: (id: string) => void) {\n  if (isCapacitor()) {\n    UrbanAirshipPlugin.getChannel().then(channel => cb(channel.id))\n  }\n  if (window.UAirship) {\n    window.UAirship.getChannelID(channelID => cb(channelID))\n  }\n}\n","import angular from 'angular'\nimport isMobile from 'ismobilejs'\nimport isMobileDevice from '@app/utils/isMobile'\nimport isMobileApp from '@app/utils/isMobileApp'\nimport { getUrbanAirshipChannelId } from '@app/utils/getUrbanAirshipChannelId'\nimport { getCodePushBundleLabel } from '@app/utils/codePushUtils'\n\nexport const DEVICE_TYPES = {\n  IOS: 'ios',\n  ANDROID: 'android',\n  UNKNOWN: 'unknown',\n}\n\nexport default angular\n  .module('mobileServicesModule', [])\n  .service(\n    'mobileService',\n    function mobileService($document, $rootScope, $timeout, $window, config) {\n      const service = this\n\n      service.isMobileApp = isMobileApp\n\n      service.getMobileOs = function () {\n        if (isMobile.apple.device) return DEVICE_TYPES.IOS\n\n        if (isMobile.android.device) return DEVICE_TYPES.ANDROID\n      }\n\n      service.isIOS = () => isMobile.apple.device\n\n      service.iosWebViewCheck = () => {\n        try {\n          const { messageHandlers } = window.webkit || {}\n          return (\n            messageHandlers && service.isMobileApp() && service.getMobileOs() === DEVICE_TYPES.IOS\n          )\n        } catch (err) {\n          return false\n        }\n      }\n\n      const setIsMobile = function () {\n        service.isMobile = service.isMobileApp() || isMobileDevice(config)\n\n        if (service.isMobile) {\n          window.isMobile = true\n          angular.element($document[0].body).addClass('mobile')\n          angular.element($document[0].body).removeClass('desktop')\n        } else {\n          window.isMobile = false\n          angular.element($document[0].body).addClass('desktop')\n          angular.element($document[0].body).removeClass('mobile')\n\n          // When on a tablet with mobile web disabled, enable pinch zooming\n\n          if (isMobile.tablet && !config.mobileWeb.tablet) {\n            allowPinchZooming()\n          }\n        }\n\n        /*\n      Allows specific targeting of native mobile application styles.\n      The not-native class avoids use of :not(.native) selector which is not IE8 supported\n       */\n        if (service.isMobileApp()) {\n          angular.element($document[0].body).addClass('native')\n          angular.element($document[0].body).removeClass('not-native')\n        } else {\n          angular.element($document[0].body).addClass('not-native')\n          angular.element($document[0].body).removeClass('native')\n        }\n      }\n\n      // Remove the mobile viewport setting to allow pinch zooming.\n\n      function allowPinchZooming() {\n        angular.element(document.querySelector('#viewport-meta'))[0].setAttribute('content', '')\n      }\n\n      setIsMobile()\n      angular.element($window).bind('resize', () => {\n        setIsMobile()\n        $rootScope.$apply()\n      })\n\n      document.addEventListener('deviceready', () => {\n        // Hide the splash screen\n\n        if (navigator.splashscreen) {\n          navigator.splashscreen.hide()\n        }\n\n        // Expose the mobile app version using cordova-plugin-app-version\n        if (service.isMobileApp()) {\n          if (window.cordova.getAppVersion.getVersionNumber) {\n            window.cordova.getAppVersion.getVersionNumber(version => {\n              service.appVersion = version\n            })\n          }\n          if (window.cordova.getAppVersion.getVersionCode) {\n            window.cordova.getAppVersion.getVersionCode(version => {\n              service.buildNumber = version\n            })\n          }\n          if (window.cordova.getAppVersion.getAppName) {\n            window.cordova.getAppVersion.getAppName(name => {\n              service.appName = name\n            })\n          }\n          if (config.urbanAirshipEnabled) {\n            getUrbanAirshipChannelId(id => (service.UrbanAirshipChannelId = id))\n          }\n          getCodePushBundleLabel(label => (service.codePushBundleLabel = label))\n        }\n      })\n    }\n  )\n","import isCapacitor from '@app/utils/isCapacitor'\nimport { codePush } from 'capacitor-codepush'\n\nexport function getCodePushBundleLabel(cb: (id: string) => void) {\n  // We are not releasing this on Cordova going forward.\n  if (isCapacitor()) {\n    codePush.getCurrentPackage().then(pack => cb(pack ? pack.label : ''))\n  }\n}\n","// A directive to autoFocus inputs expressly when they become visible in the UI\n// Can be set directly: (auto-focus=\"true\"), or set with an interpolated boolean\n// value: (auto-focus=\"{{ someValue }}\"). Important note, if {{ someVale }} is a\n// string, it needs to be explicitly cast to a boolen.\n\nimport angular from 'angular'\nimport { DEVICE_TYPES } from '@app/angular/services/modules/mobile'\n\nexport default angular\n  .module('AutoFocusModule', [])\n  .directive('autoFocus', function ($timeout, mobileService) {\n    return {\n      link(scope, el, attrs) {\n        // mobile safari does not play well with autoFocus\n        if (mobileService.getMobileOs() !== DEVICE_TYPES.IOS) {\n          const stopObserving = attrs.$observe('autoFocus', val => {\n            if (val === 'true') {\n              $timeout(() => {\n                el[0].focus()\n              }, 0)\n            }\n          })\n          if (attrs.keepObserving) {\n            scope.$on('$destroy', () => {\n              stopObserving()\n            })\n          } else {\n            stopObserving()\n          }\n        }\n      },\n    }\n  })\n","import angular from 'angular'\nimport AutoFocus from './autoFocus'\n\nexport default angular.module('app.shared.autoFocus', [AutoFocus.name])\n","import angular from 'angular'\n\nexport default angular.module('BannerImageComponentModule', []).component('bannerImage', {\n  bindings: {\n    bannerSlug: '<',\n  },\n  controller(utilService) {\n    Object.assign(this, { utilService })\n  },\n  template: `\n      <img class=\"banner-image\" ng-src=\"{{$ctrl.utilService.getLogoFromBannerSlug($ctrl.bannerSlug)}}\" alt=\"{{::ctrl.bannerSlug}}\">\n    `,\n})\n","import angular from 'angular'\nimport BannerImage from './bannerImage.component.js'\n\nexport default angular.module('app.shared.bannerImage', [BannerImage.name])\n","import angular from 'angular'\nimport template from './bannerForm.html'\n\nconst FORM_ID = 'banner'\n\nclass BannerForm {\n  constructor($q, $scope, $timeout, auth, compareCartService, config, storesService) {\n    Object.assign(this, {\n      $q,\n      $scope,\n      $timeout,\n      auth,\n      bannerSlugsInZip: [],\n      compareCartService,\n      config,\n      storesService,\n      hasFetchedBanners: false,\n    })\n\n    // Cannot use ES6 class property initializers within a class.\n    // Causes the minified version of the app to fail.\n    this._handleFetchBanners = this._handleFetchBanners.bind(this)\n  }\n\n  $onInit() {\n    // Watch for the section expanding\n    this.$scope.$watch(\n      () => this.editMode,\n      () => {\n        if (this.editMode && !this.hasFetchedBanners) {\n          this.fetchBanners()\n        }\n      }\n    )\n  }\n\n  _handleFetchBanners(banners) {\n    this.hasFetchedBanners = true\n    this.bannerSlugsInZip = banners.items\n  }\n\n  fetchBanners() {\n    this.storesService\n      .fetchBanners({ delivery_postal_code: this.address.postal_code })\n      .then(this._handleFetchBanners)\n      .catch(this.handleError)\n  }\n\n  enterEditMode() {\n    this.edit({ step: FORM_ID })\n\n    if (!this.hasFetchedBanners) {\n      this.fetchBanners()\n    }\n  }\n\n  selectBanner(bannerSlug) {\n    this.storesService\n      .fetch({\n        delivery_postal_code: this.address.postal_code,\n        retailer_slug: bannerSlug,\n        show_delivery: true,\n      })\n      .then(stores => {\n        if (stores.length > 0) {\n          this.updateDeliveryStore(stores[0])\n        } else {\n          // This should not happen\n          this.handleError({ message: this.config.lang.noDeliveryToPostalCodeError })\n        }\n      })\n      .catch(this.handleError)\n  }\n\n  updateDeliveryStore(store) {\n    const params = this.auth.getUrlParamsFromAddress(this.address)\n    params.store_id = store.id\n    params.delivery_address = this.address\n\n    const contextParams = this.auth.getContextFromAddress(this.address)\n    if (store.store_banner && store.store_banner.key) {\n      contextParams.retailer_slug = store.store_banner && store.store_banner.key\n    }\n\n    return this.compareCartService\n      .compareCart(true, 'store', params)\n      .then(() => this.auth.setContext(contextParams))\n      .then(() => this.changeHomeStore(store))\n  }\n\n  changeHomeStore(store) {\n    // Update the store\n    return this.auth\n      .update({ store_id: store.id, has_changed_store: true })\n      .then(() => this.auth.sendUserUpdatedStore(this.auth.user))\n      .then(() => this.auth.sendAvailableStoreContexts(this.auth.user))\n      .then(() => this.onChangeBanner())\n  }\n}\n\nexport default angular.module('BannerFormModule', []).component('bannerForm', {\n  bindings: {\n    address: '=',\n    edit: '&',\n    editMode: '<',\n    hideChevron: '<',\n    onChangeBanner: '&',\n    userStore: '<',\n  },\n  template,\n  controller: BannerForm,\n})\n","import angular from 'angular'\nimport BannerForm from './bannerForm'\n\nexport default angular.module('app.shared.bannerForm', [BannerForm.name])\n","import angular from 'angular'\nimport { getBannerConfig } from '@app/utils/banners'\n\nexport default angular.module('BannerTagsModule', []).directive('bannerTags', function () {\n  return {\n    scope: {\n      bannerKey: '<',\n      hasPickup: '<',\n      hasDelivery: '<',\n    },\n    controller($scope, config, lang, mobileService) {\n      $scope.bannerToDisplay = getBannerConfig($scope.bannerKey)\n      $scope.mobile = mobileService\n      $scope.lang = lang\n    },\n    link(scope, el) {\n      const banner = scope.bannerToDisplay\n      const { hasPickup, hasDelivery, lang } = scope\n\n      if (!banner || (hasPickup === false && hasDelivery === false)) {\n        return\n      }\n\n      let exclusiveContextText = ''\n      if (hasPickup && !hasDelivery) exclusiveContextText = ` - ${lang.values.pickupOnly}`\n      if (hasDelivery && !hasPickup) exclusiveContextText = ` - ${lang.values.deliveryOnly}`\n\n      // Decorate the icons with properties that are defined\n      if (banner.icon) {\n        el.append(\n          `<span>\n            <span class=\"${banner.icon}\" aria-hidden=\"true\" />\n          </span>`\n        )\n      } else {\n        // hide the icon\n        el.addClass('hide-empty')\n      }\n\n      if (banner.color) {\n        el.css('background-color', banner.color)\n      }\n\n      if (banner.tagText) {\n        if (!scope.mobile.isMobile) {\n          el.append(`<span>${banner.tagText}<i>${exclusiveContextText}</i></span>`)\n        }\n      }\n    },\n  }\n})\n","import angular from 'angular'\n\nimport BannerTags from './bannerTags.js'\n\nexport default angular.module('app.shared.bannerTags', [BannerTags.name])\n","import angular from 'angular'\nimport template from './billingInformationForm.html'\n\nclass BillingInformationForm {\n  constructor(lang) {\n    this.lang = lang\n  }\n}\n\nexport default angular.module('BillingInformationForm', []).component('billingInformationForm', {\n  bindings: {\n    condensed: '<',\n    onValidationChange: '&',\n    sameAsDeliveryAddress: '=',\n    fulfillmentType: '<',\n    billingAddress: '=',\n    title: '@',\n  },\n  controller: BillingInformationForm,\n  template,\n})\n","import angular from 'angular'\nimport billingInformationForm from './billingInformationForm'\n\nexport default angular.module('app.shared.billingInformationForm', [billingInformationForm.name])\n","import angular from 'angular'\n\nexport default angular\n  .module('BarcodeScannerButtonModule', [])\n  .directive('barcodeScannerButton', function ($state, Restangular, barcodeScanner) {\n    return function (scope, element) {\n      if (barcodeScanner.isSupported()) {\n        element.on('click', () => {\n          $state.go('main.scanBarcode')\n        })\n      } else {\n        element.remove()\n      }\n    }\n  })\n","import angular from 'angular'\nimport template from './barcodeNotFound.html'\nimport BarcodeScannerButtonModule from './barcodeScanner'\n\nexport default angular\n  .module('BarCodeComponentModule', [BarcodeScannerButtonModule.name])\n\n  .config($stateProvider => {\n    $stateProvider.state('main.barcodeNotFound', {\n      url: '/scan-not-found',\n      views: {\n        'content@': {\n          template,\n        },\n      },\n    })\n\n    $stateProvider.state('main.scanBarcode', {\n      url: '/scan-barcode',\n      views: {\n        'content@': {\n          controller($state, $timeout, barcodeScanner) {\n            barcodeScanner.search()\n          },\n        },\n      },\n    })\n  })\n","import angular from 'angular'\nimport BarcodeScanner from './barcodeRoutes.js'\n\nexport default angular.module('app.shared.barcodeScanner', [BarcodeScanner.name])\n","import angular from 'angular'\nimport template from './cartCompareDialog.html'\n\nclass CartCompareDialog {\n  constructor(lang, $filter) {\n    Object.assign(this, {\n      $filter,\n      lang,\n      cartLengthDiff: 0,\n    })\n  }\n\n  $onChanges({ items }) {\n    if (items && !items.isFirstChange() && items.previousValue !== items.currentValue) {\n      this.cartLengthDiff = items.currentValue.length - items.previousValue.length\n    }\n  }\n\n  onMessageDismiss() {\n    this.cartLengthDiff = 0\n  }\n\n  /**\n   * Sets a cart update message object based on the length diff of the cart\n   * Originally from the cart-form component developed by Henrique\n   */\n  get updateMessage() {\n    const { cartUpdateMessage, item, addedTo, removedFrom } = this.lang.values\n    const changeSize = Math.abs(this.cartLengthDiff)\n    const changeType = this.cartLengthDiff > 0 ? addedTo : removedFrom\n    const itemText = this.$filter('pluralize')(item, changeSize)\n    const body = this.lang.template(cartUpdateMessage, {\n      changeSize,\n      changeType,\n      item: itemText,\n    })\n\n    return body\n  }\n}\n\nexport default angular.module('cartCompareDialog', []).component('cartCompareDialog', {\n  bindings: {\n    items: '<',\n  },\n  template,\n  controller: CartCompareDialog,\n})\n","import angular from 'angular'\nimport cartCompareDialog from './cartCompareDialog'\n\nexport default angular.module('app.shared.cartCompareDialog', [cartCompareDialog.name])\n","import angular from 'angular'\nimport { product as enterpriseProductService } from '@instacart/enterprise-services'\nimport template from './cartForm.html'\n\nconst DISPLAY_ITEMS = {\n  MOBILE: 5,\n  DESKTOP: 10,\n}\n\nclass CartForm {\n  constructor(\n    $scope,\n    cartService,\n    checkoutAnalytics,\n    imageURLService,\n    lang,\n    mobileService,\n    utilService\n  ) {\n    Object.assign(this, {\n      $scope,\n      cartService,\n      checkoutAnalytics,\n      imageURLService,\n      lang,\n      isMobile: mobileService.isMobile,\n      utilService,\n    })\n  }\n\n  $onInit() {\n    this.cartSizes = [this.items?.length]\n    /**\n     * Watches for cart size changes and calls the `onCartSizeChange` callback attribute\n     * with the size of the change.\n     */\n    this.$scope.$watch(\n      () => this.items?.length,\n      newCartSize => {\n        const lastCartSize = this.cartSizes.pop()\n        const cartChangeSize = newCartSize - lastCartSize\n\n        if (cartChangeSize !== 0) {\n          this.onCartSizeChange({ cartChangeSize })\n        }\n\n        this.cartSizes.push(newCartSize)\n      }\n    )\n  }\n\n  /**\n   * Gets the first 10 items to display\n   *\n   * @returns { object[] } items subset\n   */\n  getDisplayItems() {\n    const itemsSize = this.isMobile ? DISPLAY_ITEMS.MOBILE : DISPLAY_ITEMS.DESKTOP\n\n    return (\n      this.items &&\n      this.items\n        .filter(\n          item =>\n            item?.store_product?.product_type === 'product' &&\n            enterpriseProductService.utils.isProductAvailable(item.store_product)\n        )\n        .slice(0, itemsSize)\n    )\n  }\n\n  editItems() {\n    const { checkoutAnalytics } = this\n    checkoutAnalytics.clickEditCart()\n  }\n\n  getCartType() {\n    return this.cartService.getCurrentCartType()\n  }\n}\n\nexport default angular.module('CartFormModule', []).component('cartForm', {\n  bindings: {\n    items: '<',\n    editMode: '<',\n    title: '@',\n    updateMessage: '<',\n    onCartSizeChange: '&',\n    onMessageDismiss: '&',\n  },\n  template,\n  controller: CartForm,\n})\n","import angular from 'angular'\nimport cartForm from './cartForm'\n\nexport default angular.module('app.shared.cartForm', [cartForm.name])\n","import angular from 'angular'\nimport _ from 'lodash'\nimport { shoppingList as shoppingListService } from '@instacart/enterprise-services'\nimport { IC_PLACEMENTS } from '@app/angular/constants/express'\nimport { FULFILLMENT_TYPES, CHECKOUT_STEP_IDS } from '@app/angular/constants/checkout'\nimport template from './cartSummary.html'\n\nclass CartSummary {\n  constructor(\n    $filter,\n    $scope,\n    cartService,\n    config,\n    express,\n    lang,\n    checkoutService,\n    mobileService,\n    orderService,\n    reactCartLoyaltyBalanceDefaultProps,\n    userService,\n    utilService,\n    loyaltyService,\n    orderFeesService\n  ) {\n    const { minimumOrderAmount } = config.icExpress\n    const checkoutPlacementEnabled = express.isPlacementConfigEnabled(IC_PLACEMENTS.CHECKOUT)\n\n    Object.assign(this, {\n      $scope,\n      loyaltyService,\n      currencyFilter: $filter('currency'),\n      cartService,\n      checkoutPlacementEnabled,\n      checkoutService,\n      config,\n      express,\n      fees: [() => this.cart.additional_fees, () => this.cart],\n      getFeeLabel: fee => orderService.fulfillmentLabel(fee, this.fulfillmentType),\n      getMinCartSpend: shoppingListService.commonUtils.getMinimumCartSpend,\n      hasIcExpressOptedIn: false,\n      lang,\n      loyaltyReactProps: reactCartLoyaltyBalanceDefaultProps,\n      minimumOrderAmount,\n      mobileService,\n      showLoyaltyCardBalance: () =>\n        userService.loyaltyCards.length > 0 &&\n        // eslint-disable-next-line no-restricted-globals\n        !isNaN(userService.getLoyaltyCard().points_balance) &&\n        config.hasLoyalty &&\n        config.showLoyaltyBalanceInCart,\n      userCurrentSubscription: null,\n      userService,\n      utilService,\n      orderFeesService,\n      rewards: [],\n      orderTotalsLines: [],\n    })\n  }\n\n  $onInit() {\n    // Fetches user current express subscription if necessary, and passes it down to components\n    if (this.config.icExpress.enabled) {\n      this.express\n        .getCurrentSubscription()\n        .then(subscription => (this.userCurrentSubscription = subscription))\n    }\n\n    if (this.config.rewards.visible.length > 0) {\n      this.$scope.$watch(\n        () => this.cartService.syncing,\n        () => this._setRewards()\n      )\n    }\n  }\n\n  syncAndValidate() {\n    return this.cartService.sync({\n      validate: this.checkoutService.isCartValidated,\n      validatePayload: {\n        with_fees: true,\n        ...this.checkoutService.getValidationPayload(this.fulfillmentType),\n      },\n    })\n  }\n\n  getTipCopy() {\n    return this.fulfillmentType === FULFILLMENT_TYPES.PICKUP\n      ? this.lang.values.tipPickup\n      : this.lang.values.tipGoesToDriver\n  }\n\n  getOrderTotalsLines() {\n    // Add appropriate order totals lines\n    let setOrderTotalsLines = [\n      {\n        type: 'value',\n        label: this.lang.values.itemTotal,\n        value: this.cartTotals.pre_discount_product_total,\n      },\n    ]\n\n    if (!this.cartService.isCartBelowMin()) {\n      if (this.showCreditsApplied()) {\n        setOrderTotalsLines.push({\n          type: 'value',\n          label: this.lang.values.creditsApplied,\n          value: this.cart.credit_total,\n        })\n      }\n\n      if (this.showOfferDiscount()) {\n        setOrderTotalsLines.push({\n          type: 'value',\n          label: this.lang.values.offerDiscount,\n          value: -this.cart.offer_total,\n        })\n      }\n\n      if (this.rewards.length) {\n        setOrderTotalsLines.push({\n          type: 'divider',\n        })\n\n        this.rewards.forEach(reward => {\n          setOrderTotalsLines.push({\n            type: 'value',\n            label: reward.altLabel,\n            description: reward.primaryInfo,\n            value: reward.amount,\n          })\n        })\n      }\n\n      if (this.checkoutService.isCartValidated) {\n        if (this.rewards.length) {\n          setOrderTotalsLines.push({\n            type: 'divider',\n          })\n        }\n\n        setOrderTotalsLines.push({\n          type: 'value',\n          label: this.lang.values.tax,\n          value: this.cartService.getFinalTaxTotal(),\n        })\n\n        setOrderTotalsLines.push({\n          type: 'divider',\n        })\n\n        setOrderTotalsLines = setOrderTotalsLines.concat(\n          this.orderFeesService.formattedFees(this.fees, this.fulfillmentType)\n        )\n      }\n    }\n\n    // Ensures that a digset cycle is only triggered if the lines have changed.\n    if (!_.isEqual(setOrderTotalsLines, this.orderTotalsLines)) {\n      this.orderTotalsLines = setOrderTotalsLines\n    }\n\n    return this.orderTotalsLines\n  }\n\n  openPromoCodeModal() {\n    this.utilService.openPromoCodeModal(\n      this.syncAndValidate.bind(this),\n      this.mobileService.isMobile,\n      true\n    )\n  }\n\n  _setRewards() {\n    this.rewards = this.loyaltyService.getVisibleRewards(\n      this.cartService.cart?.cart_totals?.[this.cartService.getCurrentCartType()]?.reward_discounts\n    )\n  }\n\n  get placeOrderValidationLabel() {\n    if (!this.currentEditStep) return ''\n\n    const { values, template } = this.lang\n    const intent =\n      this.fulfillmentType === FULFILLMENT_TYPES.PICKUP ? values.pickup : values.delivery\n\n    switch (this.currentEditStep) {\n      case CHECKOUT_STEP_IDS.PICKUP:\n        return values.pleaseSelectPickup\n      case CHECKOUT_STEP_IDS.SCHEDULE:\n        return template(values.pleaseSelectTimeslot, { fulfillmentType: intent })\n      case CHECKOUT_STEP_IDS.CONTACT:\n        return values.pleaseFillContactInfo\n      case CHECKOUT_STEP_IDS.PAYMENT:\n        return values.pleaseSelectPaymentMethod\n      case CHECKOUT_STEP_IDS.DELIVERY:\n        return values.pleaseSelectDeliveryAddress\n    }\n\n    return ''\n  }\n\n  /**\n   * Returns the cart totals object depending on the user current cart type\n   *\n   * @returns { object }\n   */\n  get cartTotals() {\n    return this.cartService.getCartTotals()\n  }\n\n  /**\n   * Returns whether the client currently has a client or instacart express subscription\n   *\n   * @returns { boolean }\n   */\n  hasClientSubscription() {\n    const total = this.cart?.product_total\n\n    return (\n      this.cartService.cart.subscription_total !== '0' ||\n      ((this.express.isIcExpressOptedIn || this.express.hasSubscription()) &&\n        total &&\n        total >= this.minimumOrderAmount)\n    )\n  }\n\n  /**\n   * Callback that executes after a tip is susscessfully applied to the cart\n   *\n   * @returns { Promise }\n   */\n  onTipApplied() {\n    return this.cartService.validateCart({\n      with_fees: true,\n      ...this.checkoutService.getValidationPayload(this.fulfillmentType),\n    })\n  }\n\n  /**\n   * Returns true if we should show the subscription selection\n   *\n   * @returns { boolean }\n   */\n  showSubscriptionSelection() {\n    return (\n      // Make sure the user is in delivery or pickup fulfillment type\n      (this.fulfillmentType === FULFILLMENT_TYPES.DELIVERY ||\n        this.fulfillmentType === FULFILLMENT_TYPES.PICKUP) &&\n      // Make sure that the subscriptions feature is enabled\n      this.config.subscriptions.enabled &&\n      // Make sure that the cartCheckout feature is also enabled\n      this.config.subscriptions.cartCheckout.enabled &&\n      // Check that purchasing for subscriptions is enabled\n      this.config.subscriptions.isPurchasingEnabled\n    )\n  }\n\n  /**\n   * Returns true if the offer discount should be shown.\n   *\n   * @returns { boolean }\n   */\n  showOfferDiscount() {\n    return (\n      this.config.showOfferDiscountAndCreditsApplied || parseInt(this.cart.offer_total, 10) !== 0\n    )\n  }\n\n  /**\n   * Returns true if the credit applied should be shown.\n   *\n   * @returns { boolean }\n   */\n  showCreditsApplied() {\n    return (\n      this.config.showOfferDiscountAndCreditsApplied || parseInt(this.cart.credit_total, 10) !== 0\n    )\n  }\n}\n\nexport default angular.module('CartSummaryModule', []).component('cartSummary', {\n  template,\n  bindings: {\n    cart: '<',\n    fulfillmentType: '<',\n    isPlaceOrderEnabled: '<',\n    totalLabelText: '<',\n    currentEditStep: '<',\n    condensed: '<',\n    onPlaceOrder: '&',\n    isPlacingOrder: '<',\n    cartType: '<',\n  },\n  controller: CartSummary,\n})\n","import angular from 'angular'\n\nimport cartSummary from './cartSummary'\n\nexport default angular.module('app.shared.cartSummary', [cartSummary.name])\n","import _ from 'lodash'\nimport angular from 'angular'\n\nexport default angular\n  .module('CellServiceModule', [])\n  .service('cellService', function cellService(mobileService, utilService) {\n    const service = this\n\n    const elSum = function (group) {\n      let sum = 0\n      _.each(group, item => {\n        sum += item.workingSpan\n      })\n      return sum\n    }\n\n    const swapEl = function (toList, fromList, fromListAt) {\n      const toListLast = toList.pop()\n      toList.push(fromList.splice(fromListAt, 1)[0])\n      fromList.unshift(toListLast)\n    }\n\n    service.group = function (inputArr, colMax) {\n      const set = angular.copy(inputArr)\n      const sortedSet = []\n\n      while (set.length && colMax) {\n        const group = []\n        let positionInSet = 0\n        while (elSum(group) < colMax && positionInSet < set.length) {\n          const item = set[positionInSet]\n          let itemSpan // span of the item: 1, 2, 3 or 4 cells wide\n\n          if (item.promoted_media) {\n            if (item.promoted_media.mobile && mobileService.isMobile) {\n              itemSpan = item.promoted_media.mobile.span\n            } else if (\n              item.promoted_media.desktop &&\n              (!mobileService.isMobile || item.promoted_media.desktop.span <= 2)\n            ) {\n              itemSpan = item.promoted_media.desktop.span\n            } else {\n              itemSpan = 1\n            }\n          } else {\n            itemSpan = 1\n          }\n\n          if (!itemSpan) {\n            throw new ReferenceError('Item does not have property \"span\"')\n          }\n          if (itemSpan > colMax) {\n            throw new RangeError(\"The Item's width exceeds the maximum width allowed by the window\")\n          }\n\n          item.workingSpan = itemSpan // precalculated span so we dont need to make more checks elsewhere\n\n          if (elSum(group) + item.workingSpan <= colMax) {\n            // first we just try to append the item to the group\n            group.push(set.splice(positionInSet, 1)[0])\n          } else if (\n            group[group.length - 1].workingSpan - item.workingSpan !== 0 &&\n            elSum(group) - group[group.length - 1].workingSpan + item.workingSpan <= colMax\n          ) {\n            // try swapping, but only if the item you are swapping with changes the length of the group\n            // increasing or decreasing the length is good but swapping a 4 span with a 4 span is completely pointless\n            swapEl(group, set, positionInSet)\n            // swap then move to the next item as the one at the first position was already used\n            // eslint-disable-next-line no-plusplus\n            positionInSet++\n          } else {\n            // if we cant add or swap just move to the next and try there\n            // eslint-disable-next-line no-plusplus\n            positionInSet++\n          }\n        }\n        sortedSet.push(group)\n      }\n\n      return sortedSet\n    }\n\n    service.sort = function (inputArr, colMax) {\n      // Preserve the original objects when returning so any Restangular bindings will remain\n\n      try {\n        const sorted = _.flatten(service.group(inputArr, colMax))\n        inputArr.length = 0\n\n        _.each(sorted, item => {\n          inputArr.push(item)\n        })\n\n        return inputArr\n      } catch (err) {\n        utilService.log(`Error: ${err.message}`)\n        return inputArr\n      }\n    }\n\n    service.getMaxCols = function () {\n      const cellContainer = document.querySelector('.view.shop')\n      const cellContainerWidth = cellContainer ? cellContainer.offsetWidth : 0\n      const cellWidth = 200\n      const gutter = 30\n\n      if (mobileService.isMobile) {\n        return 2\n      }\n      return Math.floor(cellContainerWidth / (cellWidth + gutter))\n    }\n\n    // Functions for testing the math and the service in general\n\n    service.visualizeInConsole = function (matrix) {\n      _.each(matrix, group => {\n        _.each(group, (item, index) => {\n          const val = item.workingSpan\n          let itemLength = val\n          const visualized = []\n\n          while (itemLength > 0) {\n            visualized.push(val)\n            // eslint-disable-next-line no-plusplus\n            itemLength--\n          }\n\n          group.splice(index, 1, visualized)\n        })\n\n        // eslint-disable-next-line no-console\n        console.log(group.toString())\n      })\n    }\n\n    // Function for testing the math\n\n    service.test = function () {\n      const getRandomNumber = function () {\n        const values = [1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 4]\n        const value = Math.floor(Math.random() * (values.length - 1) + 1) // non uniform selection\n        // return Math.floor(Math.random() * (4 - 1 + 1)) + 1; // uniformly random between [1,4]\n        return values[value]\n      }\n\n      const set = (function () {\n        let span = 40\n        const arr = []\n        while (span > 0) {\n          arr.push({\n            promoted_media: { desktop: { span: getRandomNumber() } },\n          })\n          // eslint-disable-next-line no-plusplus\n          span--\n        }\n        return arr\n      })()\n\n      service.visualizeInConsole(service.group(set, 7))\n    }\n  })\n","import _ from 'lodash'\nimport angular from 'angular'\nimport { imageTransform } from '@instacart/enterprise-services'\nimport CellServiceModule from './cellService'\n\nexport default angular\n  .module('CellImageModule', [CellServiceModule.name])\n  .directive('cellImage', function (mobileService, utilService) {\n    return {\n      restrict: 'A',\n      scope: {\n        promotedMedia: '=',\n        defaultImage: '=',\n        useImageTag: '<',\n        lazyLoadImage: '<',\n        fallbackImage: '@',\n      },\n      link(scope, element) {\n        // Check if browser supports observing\n        const canObserve = () => utilService.hasIntersectionObserver() && scope.lazyLoadImage\n        // Watch images\n        scope.$watchGroup(['promotedMedia', 'defaultImage'], () => {\n          let image = utilService.escapeImageUrl(scope.defaultImage)\n          let promotedImage = false\n          let altText = ''\n\n          // Select a promoted media image, if one is appropriate\n\n          if (scope.promotedMedia) {\n            if (scope.promotedMedia.mobile && mobileService.isMobile) {\n              image = utilService.escapeImageUrl(\n                imageTransform(scope.promotedMedia.mobile.image_url)\n              )\n              altText = scope.promotedMedia.mobile.alt_text\n              promotedImage = true\n            } else if (\n              scope.promotedMedia.desktop &&\n              (!mobileService.isMobile || scope.promotedMedia.desktop.span <= 2)\n            ) {\n              image = utilService.escapeImageUrl(\n                imageTransform(scope.promotedMedia.desktop.image_url)\n              )\n              altText = scope.promotedMedia.desktop.alt_text\n              promotedImage = true\n            }\n          }\n\n          // We have to check for the undefined string as utilService.escapeImageUrl() always returns a string\n          if (image === 'undefined' && !_.isNil(scope.fallbackImage)) {\n            image = utilService.loadStaticImage(scope.fallbackImage)\n          }\n\n          // Mark image as promoted\n          element.parent().toggleClass('promoted', promotedImage)\n\n          // Fade in image\n          if (image) {\n            element.removeClass('show')\n            const observableElement = element\n\n            // Conditionally check to see if `use-image-tag` attr is set to true\n            // If so, append an image element as a child in order to implement alt text and be semantically correct for accessibility\n            // Otherwise, maintain the \"old\" way of showing images as `background-image`. This is a TODO to eventually convert\n            // All images to follow this pattern and deprecating the using of `background-image`\n            if (scope.useImageTag) {\n              const imageElement = angular.element('<img>')\n              imageElement[0].dataset.src = image\n              imageElement[0].alt = altText || ''\n\n              if (element[0].children.length > 0) {\n                element[0].innerHTML = ''\n              }\n\n              element[0].appendChild(imageElement[0])\n            } else {\n              observableElement[0].dataset.src = image\n            }\n\n            const loadImage = (loadedImageElement, loadImage) => {\n              const img = new Image()\n              img.onload = function () {\n                loadedImageElement.addClass('show')\n              }\n\n              img.src = loadImage\n\n              if (scope.useImageTag) {\n                loadedImageElement[0].querySelector('img').src = loadImage\n              } else {\n                loadedImageElement[0].style.backgroundImage = `url(${utilService.escapeImageUrl(\n                  loadImage,\n                  true\n                )})`\n              }\n            }\n\n            // Lazy load images if supported\n            if (canObserve()) {\n              const observerOptions = {\n                root: null,\n                rootMargin: '0px',\n                threshold: 0.1, // percentage of image that needs to be in view\n              }\n\n              const handleIntersection = (entries, self) => {\n                entries.forEach(entry => {\n                  if (entry.isIntersecting) {\n                    loadImage(observableElement, image)\n                    self.unobserve(entry.target)\n                  }\n                })\n              }\n\n              // The observer for the images on the page\n              const observer = new IntersectionObserver(handleIntersection, observerOptions)\n              observer.observe(observableElement[0])\n            } else {\n              loadImage(observableElement, image)\n            }\n          } else {\n            element[0].style.backgroundImage = 'none'\n          }\n        })\n      },\n    }\n  })\n","import angular from 'angular'\nimport CellImage from './cellImage'\n\nexport default angular.module('app.shared.cellImage', [CellImage.name])\n","import angular from 'angular'\nimport template from './cellSlider.html'\n\nexport default angular\n  .module('CellSliderModule', [])\n  .directive('cellSlider', function () {\n    return {\n      scope: {\n        items: '=',\n        location: '@',\n      },\n      replace: true,\n      template,\n      link(scope, element, _attrs) {\n        let slider\n\n        // We need this function as `.cell-slider-content` does not exist at link time\n        function getSlider() {\n          return slider || (slider = element[0].querySelector('.cell-slider-content'))\n        }\n\n        function updatePosition() {\n          const slider = getSlider()\n          scope.hasLess = slider.scrollLeft > 0\n          scope.hasMore = slider.scrollLeft < slider.scrollWidth - slider.clientWidth\n        }\n\n        scope.next = function () {\n          const slider = getSlider()\n          slider.scrollLeft += slider.clientWidth\n          updatePosition()\n        }\n\n        scope.prev = function () {\n          const slider = getSlider()\n          slider.scrollLeft -= slider.clientWidth\n          updatePosition()\n        }\n\n        // update position after children have had a chance to initialize\n        setTimeout(scope.$apply.bind(scope, updatePosition), 0)\n      },\n    }\n  })\n  .run($templateCache => {\n    $templateCache.put('cellContainer.html', require('../cellContainer/cellContainer.html'))\n  })\n","import angular from 'angular'\nimport CellSlider from './cellSlider.js'\n\nexport default angular.module('app.shared.cellSlider', [CellSlider.name])\n","import angular from 'angular'\n\nexport default angular\n  .module('CollectionModalControllerModule', [])\n  .controller(\n    'CollectionModalController',\n    function (\n      $scope,\n      $uibModal,\n      Restangular,\n      auth,\n      cartService,\n      config,\n      endpoint,\n      noticeAlert,\n      utilService\n    ) {\n      $scope.auth = auth\n      $scope.cartService = cartService\n      $scope.config = config\n\n      // Pagination\n\n      $scope.page = { current: 1 }\n\n      $scope.$watch('page.current', (newPage, oldPage) => {\n        if (oldPage && newPage !== oldPage) {\n          utilService.scrollElementToTop(document.querySelector('.collection-modal .modal-content')) // Hack\n          delete $scope.items\n          $scope.loadItems()\n        }\n      })\n\n      // Load items from the API, if an endpoint is specified\n      // (may not be, for subcategory view, etc..)\n\n      if (endpoint) {\n        $scope.loadItems = function () {\n          const params = {\n            offset: $scope.page.current ? ($scope.page.current - 1) * config.productsPerPage : 0,\n            limit: config.productsPerPage,\n          }\n          Restangular.all(endpoint)\n            .getList(params)\n            .then(items => {\n              $scope.items = items\n            })\n        }\n        $scope.loadItems()\n      }\n\n      // Watch for state to change, closing the modal if it does\n\n      $scope.$on('$stateChangeStart', () => {\n        $scope.$close()\n      })\n\n      $scope.noticeAlert = noticeAlert\n    }\n  )\n  .run($templateCache => {\n    $templateCache.put(\n      'pagination-modified-uibootstrap-desktop.html',\n      require('../pagination/pagination-modified-uibootstrap-desktop.html')\n    )\n    $templateCache.put(\n      'pagination-modified-uibootstrap-mobile.html',\n      require('../pagination/pagination-modified-uibootstrap-mobile.html')\n    )\n  })\n","import angular from 'angular'\nimport template from './collectionModal.html'\nimport CollectionModalControllerModule from './collectionModalController'\n\nexport default angular\n  .module('CollectionModalServiceModule', [CollectionModalControllerModule.name])\n  .service('collectionModal', function collectionModal($uibModal, lang, uibModalAriaLabelService) {\n    const service = this\n\n    service.open = function (endpoint, noticeAlert = null) {\n      $uibModal.open({\n        template,\n        controller: 'CollectionModalController',\n        resolve: {\n          ariaLabel: () => {\n            uibModalAriaLabelService.setLabel(lang.values.collections)\n          },\n          endpoint() {\n            return endpoint\n          },\n          noticeAlert() {\n            return noticeAlert\n          },\n        },\n      })\n    }\n  })\n","import angular from 'angular'\nimport CollectionModal from './collectionModalService.js'\n\nexport default angular.module('app.shared.collectionModal', [CollectionModal.name])\n","import angular from 'angular'\nimport template from './contactForm.html'\n\nconst CONTACT_FORM_ID = 'contact'\nconst PRIMARY_NUMBER_KEY = 'mobile_phone_number'\n\nclass ContactForm {\n  constructor($scope, auth, checkoutAnalytics, config, lang, utilService) {\n    const localContact = {\n      first_name: '',\n      last_name: '',\n      phone_number: '',\n    }\n\n    const shouldUpdateProfile = !config.profile.disabledNameFields\n\n    Object.assign(this, {\n      $scope,\n      auth,\n      checkoutAnalytics,\n      config,\n      hasErrors: false,\n      lang,\n      localContact,\n      shouldUpdateProfile,\n      utilService,\n      isLoading: false,\n    })\n  }\n\n  $onInit() {\n    this.$scope.$watch(\n      () => this.editMode,\n      () => {\n        if (this.editMode && this.contact) {\n          this.localContact = { ...this.contact }\n        }\n      }\n    )\n  }\n\n  /**\n   * Returns the contact full name\n   *\n   * @returns { string }\n   */\n  get fullName() {\n    return `${this.contact.first_name} ${this.contact.last_name}`\n  }\n\n  hasRequiredInformation() {\n    const { first_name, last_name, phone_number } = this.contact || {}\n\n    return !!(first_name && last_name && phone_number)\n  }\n\n  /**\n   * Changes the section to edit mode by calling the\n   * edit prop function\n   *\n   * @returns { undefined }\n   */\n  enterEditMode() {\n    const { checkoutAnalytics, contact } = this\n    this.edit({ step: CONTACT_FORM_ID })\n    checkoutAnalytics.viewContactOptions({ contact })\n  }\n\n  /**\n   * Handles the contact form submit\n   *\n   * @returns { undefined }\n   */\n  handleSubmit() {\n    const { checkoutAnalytics, localContact } = this\n    const { first_name, last_name, phone_number, address1, postal_code } = localContact\n\n    const contact = {\n      delivery_address: {\n        first_name,\n        last_name,\n        address1,\n        postal_code,\n      },\n      primary_number_key: this.contact.primary_number_key || PRIMARY_NUMBER_KEY,\n    }\n\n    contact[this.contact.primary_number_key || PRIMARY_NUMBER_KEY] = phone_number\n\n    const logEditContact = success => checkoutAnalytics.editContactOptions({ success })\n\n    if (this.form.$valid) {\n      this.hasErrors = false\n\n      if (!this.shouldUpdateProfile) {\n        this.onSave({ fetch: false, contact: this.localContact })\n        return\n      }\n\n      this.isLoading = true\n\n      this.auth\n        .updateProfile(contact)\n        .then(() => this.onSave({ fetch: true, contact: this.localContact }))\n        .then(() => logEditContact(true))\n        .catch(error => {\n          this.onError({ error })\n          logEditContact(false)\n        })\n        .finally(() => {\n          this.isLoading = false\n        })\n    } else {\n      this.hasErrors = true\n      logEditContact(false)\n    }\n  }\n\n  handleBlur() {\n    this.hasErrors = !this.form.$valid\n  }\n}\n\nexport default angular.module('ContactFormModule', []).component('contactForm', {\n  bindings: {\n    address: '<',\n    editMode: '<',\n    title: '@',\n    contact: '<',\n    onError: '&',\n    onSave: '&',\n    edit: '&',\n    condensed: '<',\n    hideChevron: '<',\n  },\n  template,\n  controller: ContactForm,\n})\n","import angular from 'angular'\nimport ContactForm from './contactForm'\n\nexport default angular.module('app.shared.contactForm', [ContactForm.name])\n","import angular from 'angular'\nimport template from './continuityOfferCell.html'\n\nexport default angular\n  .module('ContinuityOfferCellModule', [])\n  .directive('continuityOfferCell', function () {\n    return {\n      scope: {\n        offer: '=',\n      },\n      replace: true,\n      template,\n      controller($scope, config, lang, offerDetailsModalService, offersService) {\n        $scope.config = config\n        $scope.lang = lang\n        $scope.offerDetailsModalService = offerDetailsModalService\n\n        $scope.unlockContinuityOfferReward = offerID => {\n          // Don't trigger the default offer cell modal opening\n          /* eslint-disable no-restricted-globals */\n          if (event) {\n            event.stopPropagation()\n          }\n          /* eslint-enable no-restricted-globals */\n\n          offersService.getOfferData(offerID).then(offer => {\n            offerDetailsModalService.open(offer.offer)\n          })\n        }\n      },\n    }\n  })\n","import angular from 'angular'\nimport ContinuityOfferCell from './continuityOfferCell'\n\nexport default angular.module('app.shared.continuityOfferCell', [ContinuityOfferCell.name])\n","import angular from 'angular'\nimport template from './couponClipper.html'\n\nexport default angular.module('CouponClipperModule', []).directive('couponClipper', function () {\n  return {\n    scope: {\n      coupon: '=',\n      couponclass: '=',\n      location: '@',\n      isDisabled: '<?',\n    },\n    replace: true,\n    template,\n    controller(\n      $rootScope,\n      $scope,\n      $element,\n      $attrs,\n      analytics,\n      cartService,\n      config,\n      lang,\n      localStorageService,\n      offerAnalytics,\n      offersService,\n      offerDetailsModalService,\n      rateApp\n    ) {\n      $scope.config = config\n      $scope.lang = lang\n      const couponTrack = increment => {\n        const rateClip = config.mobileAppRate.couponsClipped\n        // eslint-disable-next-line eqeqeq\n        if (rateClip != -1) {\n          const coupons_clipped = localStorageService.deprecatedGet('coupons_clipped')\n          if (coupons_clipped + increment >= rateClip) {\n            // re-set clipped coupons\n            localStorageService.deprecatedSet('coupons_clipped', 0)\n            // prompt review\n            rateApp.promptAppReview()\n          } else {\n            // update coupons clipped\n            localStorageService.deprecatedSet('coupons_clipped', coupons_clipped + increment)\n          }\n        }\n      }\n\n      $scope.toggleClippedState = function () {\n        if (!$scope.coupon.clipped || !config.disableCouponUnclipping) {\n          $scope.coupon.clipped = !$scope.coupon.clipped\n          offersService.updateClippedState($scope.coupon)\n          // Log analytics when coupon has been clipped\n          if ($scope.coupon.clipped) {\n            if (!$rootScope.modifyingOrder) {\n              analytics.logOfferClick($scope.coupon, $scope.location)\n              offerAnalytics.addOffer({ offer: $scope.coupon })\n            }\n\n            if (config.openOfferAfterCouponClip) {\n              offerDetailsModalService.open($scope.coupon)\n            }\n\n            // check app review if clipped\n            couponTrack(1)\n          }\n        }\n      }\n      $scope.isCartSyncing = () => cartService.syncing\n    },\n  }\n})\n","import angular from 'angular'\nimport CouponClipper from './couponClipper.js'\n\nexport default angular.module('app.shared.couponClipper', [CouponClipper.name])\n","import angular from 'angular'\nimport template from './couponUnclippedModal.html'\n\nexport default angular\n  .module('CouponUnclippedModalServiceModule', [])\n\n  // Service to provide access to launching the modal dialog\n\n  .service('couponUnclippedModalService', function couponUnclippedModalService($uibModal) {\n    this.open = function () {\n      const modal = $uibModal.open({\n        template,\n        controller($scope, config, lang) {\n          $scope.lang = lang\n          $scope.config = config\n        },\n        keyboard: false,\n        backdrop: 'static',\n        windowClass: 'no-scrol',\n      })\n\n      return modal.result\n    }\n  })\n","import angular from 'angular'\nimport CouponUnclippedModal from './couponUnclippedModal'\n\nexport default angular.module('app.shared.couponUnclippedModal', [CouponUnclippedModal.name])\n","import angular from 'angular'\nimport template from './creditCardLogos.html'\n\nexport default angular.module('CreditCardLogosModule', []).component('creditCardLogos', {\n  bindings: {\n    creditCards: '<',\n    selectedCreditCard: '<',\n    isDirty: '<',\n  },\n  template,\n  controller($scope, utilService) {\n    $scope.utilService = utilService\n  },\n})\n","import angular from 'angular'\nimport creditCardLogos from './creditCardLogos'\n\nexport default angular.module('app.shared.creditCardLogos', [creditCardLogos.name])\n","import _ from 'lodash'\nimport angular from 'angular'\nimport template from './deliveryForm.html'\n\nconst DELIVERY_FORM_ID = 'delivery'\n\nclass DeliveryForm {\n  constructor(\n    $filter,\n    $q,\n    addressList,\n    auth,\n    checkoutAnalytics,\n    checkoutService,\n    compareCartService,\n    config,\n    lang,\n    storesService,\n    utilService\n  ) {\n    Object.assign(this, {\n      $filter,\n      $q,\n      addressList,\n      auth,\n      checkoutAnalytics,\n      checkoutService,\n      compareCartService,\n      config,\n      isEditingAddress: false,\n      errors: [],\n      lang,\n      storesService,\n      utilService,\n      isLoading: false,\n    })\n  }\n\n  /**\n   * Gets a human readable string from an address object\n   *\n   * @param { city, province, postal_code } address\n   */\n  addressAsString({ address1, city, province, postal_code }) {\n    if (!address1 || !city || !province || !postal_code) {\n      return ''\n    }\n\n    return `${address1}<br />${city}, ${province} ${postal_code}`\n  }\n\n  /**\n   * Gets a human readable string from an address object for contact information\n   *\n   * @param { first_name, last_name, phone_number } address\n   */\n  contactInformationAsString({ first_name, last_name, phone_number }) {\n    if (!first_name || !last_name) {\n      return ''\n    }\n\n    let contactInfo = `${first_name} ${last_name}`\n\n    if (phone_number) {\n      contactInfo += `, ${this.$filter('telephone')(phone_number)}`\n    }\n\n    return contactInfo\n  }\n\n  /**\n   * Returns whether an address is valid or not\n   * Only checks if the address object is empty\n   *\n   * @param address object\n   * @returns { Boolean }\n   */\n  isValid(address) {\n    return !_.isEmpty(address)\n  }\n\n  /**\n   * Returns whether an address phone number is valid or not\n   * Only checks if the address.phone_number is empty\n   *\n   * @param address object\n   * @returns { Boolean }\n   */\n  isValidPhoneNumber(address) {\n    return !_.isEmpty(address) && !_.isEmpty(address.phone_number)\n  }\n\n  /**\n   * Returns whether we can deliver to a postal code or not\n   *\n   * @param { object } address - Address object that has *postal_code* attribute\n   * @returns { Promise }\n   */\n  isValidPostalCode({ postal_code }) {\n    const userStore = this.auth.user.store\n    const payload = {\n      delivery_postal_code: postal_code,\n      show_delivery: true,\n    }\n\n    if (userStore && userStore.store_banner && userStore.store_banner.key) {\n      payload.retailer_slug = userStore.store_banner.key\n    }\n\n    return this.storesService\n      .fetch(payload)\n      .then(stores => {\n        // eslint-disable-next-line no-throw-literal\n        if (!stores || stores.length === 0) throw null\n\n        return stores\n      })\n      .catch(() => this.handleInvalidPostalCodeError())\n  }\n\n  /**\n   * Handles postal code validation errors\n   *\n   * @returns {undefined}\n   */\n  handleInvalidPostalCodeError() {\n    this.errors.push(this.lang.values.noDeliveryToPostalCodeError)\n    this.onError()\n  }\n\n  /**\n   * Changes the section to edit mode by calling the\n   * edit prop function\n   *\n   * @returns { undefined }\n   */\n  enterEditMode() {\n    this.edit({ step: DELIVERY_FORM_ID })\n    this.checkoutAnalytics.viewFulfillmentOptions()\n  }\n\n  /**\n   * Sets the address to whatever is selected by the\n   * address list component.\n   *\n   * Sets the *isEditingAddress* prop to `false` to show\n   * the save button\n   *\n   * @param { Object } address\n   * @param { boolean } saveSelectedAddress Whether to save the set address and exit the form.\n   * @returns { undefined }\n   */\n  setDeliveryAddress(address, saveSelectedAddress) {\n    this.address = address\n    this.isEditingAddress = false\n\n    if (saveSelectedAddress) {\n      this.saveAddress(address)\n    }\n  }\n\n  /**\n   * This method is passed to the addressList component and it gets called\n   * whenever the user opens the form to edit an existing address\n   *\n   * Sets the *isEditingAddress* to `true` to hide the save button.\n   *\n   * @returns { undefined }\n   */\n  editingDeliveryAddress(address) {\n    if (!address) {\n      this.isEditingAddress = false\n    } else {\n      this.isEditingAddress = true\n    }\n  }\n\n  /**\n   * Save the currently selected address to the user context\n   * then exits out of the edit state\n   *\n   * @param { Object } address\n   * @returns { undefined }\n   */\n  saveAddress(address) {\n    /**\n     * Returns whether there are cart changes for the new address\n     * and if the user accepts these changes\n     *\n     * @param Object store\n     * @param Object address\n     * @returns { Promise }\n     */\n    const storeCartCompare = (store, address) => {\n      return this.compareCartService.compareCart(true, 'store', {\n        store_id: store.id,\n        delivery_postal_code: address.postal_code,\n      })\n    }\n\n    this.errors = []\n\n    this.isLoading = true\n\n    const initialStore = this.auth.user.store\n    let newStore\n\n    return this.isValidPostalCode(address, this.auth.user)\n      .then(stores => {\n        newStore = stores[0]\n        return storeCartCompare(newStore, address)\n      })\n      .then(({ shouldRecalculateFees }) => {\n        this.checkoutService.handleCartCompareChange(shouldRecalculateFees)\n      })\n      .then(async () => {\n        const newAddress = this.auth.getContextFromAddress(address)\n        const newContext = { ...this.auth.getContext(), ...newAddress, storeNumber: newStore.id }\n\n        await this.auth.setContext(newContext)\n        await this.auth.update({\n          delivery_address: address,\n          context: newContext,\n          store: newStore,\n          store_id: newStore.id,\n        })\n\n        // This is behind a config as this needs to be backported to 2.29 and it would be really risky to turn it on for every client\n        // TODO: See if this would break anything on other clients\n        if (this.config?.saveAddressUserProfile) {\n          await this.auth.updateProfile({\n            delivery_address: address,\n          })\n        }\n\n        return address\n      })\n      .then(add => {\n        const hasStoreChanged = newStore.id !== initialStore.id\n        return this.onAddressApplied({ address: add, hasStoreChanged })\n      })\n      .then(() => this.checkoutAnalytics.editFulfillmentOptions({ success: true }))\n      .catch(() => {\n        this.onError()\n        this.checkoutAnalytics.editFulfillmentOptions({ success: false })\n      })\n      .finally(() => {\n        this.isLoading = false\n      })\n  }\n}\n\nexport default angular.module('DeliveryFormModule', []).component('deliveryForm', {\n  bindings: {\n    address: '<',\n    edit: '&',\n    editMode: '<',\n    onAddressApplied: '&',\n    onError: '&',\n    onCancel: '&',\n    hideChevron: '<',\n  },\n  template,\n  controller: DeliveryForm,\n})\n","import angular from 'angular'\nimport DeliveryForm from './deliveryForm'\n\nexport default angular.module('app.shared.deliveryForm', [DeliveryForm.name])\n","import _ from 'lodash'\nimport angular from 'angular'\nimport template from './deliveryZipCode.html'\n\nexport default angular.module('DeliveryZipCodeModule', []).component('deliveryZipCode', {\n  bindings: {\n    zipCode: '<',\n    onClick: '&',\n  },\n  template,\n  controller($scope, lang) {\n    const { add, change } = lang.values\n    const hasZipCode = !_.isEmpty(this.zipCode)\n\n    $scope.label = hasZipCode ? change : add\n    $scope.handleClick = this.onClick\n  },\n})\n","import angular from 'angular'\nimport DeliveryZipCode from './deliveryZipCode'\n\nexport default angular.module('app.shared.deliveryZipCode', [DeliveryZipCode.name])\n","import angular from 'angular'\n\nimport { SHOPPING_SELECTOR_STAGES } from '@app/angular/constants/shoppingSelectorStages'\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\n\nimport template from './emptyResultsContextSwitcher.html'\n\nexport default angular\n  .module('EmptyResultsContextSwitcherModule', [])\n  .component('emptyResultsContextSwitcher', {\n    bindings: {\n      searchTerm: '@',\n      showPickupContextSwitch: '<',\n      showDeliveryContextSwitch: '<',\n      showCateringContextSwitch: '<',\n    },\n    template,\n    controller(\n      $rootScope,\n      $scope,\n      auth,\n      cartService,\n      cartListTransferModalService,\n      cartListTransferService,\n      config,\n      lang,\n      shoppingSelectorService,\n      shoppingContextService\n    ) {\n      $scope.lang = lang\n      $scope.showPickupContextSwitch = this.showPickupContextSwitch\n      $scope.showDeliveryContextSwitch = this.showDeliveryContextSwitch\n      $scope.showCateringContextSwitch = this.showCateringContextSwitch\n\n      const currentContext = auth.user.context.intent\n      if (currentContext) {\n        $scope.noItemsInContextHeader = lang.template(lang.values.noItemsInContextHeader, {\n          term: this.searchTerm,\n          context: config.shoppingSelector[currentContext].title,\n        })\n        $scope.noItemsInContextBody = lang.template(lang.values.noItemsInContextBody, {\n          context: config.shoppingSelector[currentContext].title,\n        })\n      }\n\n      $scope.switchShoppingMethodToDelivery = () => {\n        auth.setIntent(SHOPPING_MODES.DELIVERY).then(() => {\n          shoppingSelectorService\n            .open(SHOPPING_SELECTOR_STAGES.STORE_SELECTOR)\n            .finally($rootScope.reloadState)\n        })\n      }\n\n      $scope.switchShoppingMethodToPickup = () => {\n        auth.setIntent(SHOPPING_MODES.PICKUP).then(() => {\n          shoppingSelectorService\n            .open(SHOPPING_SELECTOR_STAGES.STORE_SELECTOR)\n            .finally($rootScope.reloadState)\n        })\n      }\n\n      $scope.switchShoppingMethodToCatering = () => {\n        shoppingContextService.setSelectedFulfillmentType(SHOPPING_MODES.CATERING)\n\n        const updateContext = () =>\n          auth.setIntent(SHOPPING_MODES.CATERING).then(() => {\n            shoppingSelectorService\n              .open(SHOPPING_SELECTOR_STAGES.STORE_SELECTOR)\n              .finally($rootScope.reloadState)\n          })\n        const shoppingMode = auth.getCurrentShoppingMode()\n        const initialContext = config.shoppingSelector[shoppingMode].title\n        const updatedContext = config.shoppingSelector[SHOPPING_MODES.CATERING].title\n        const itemCount = cartService.countItems()\n\n        cartListTransferModalService\n          .open({ initialContext, updatedContext, itemCount })\n          .then(updateContext)\n      }\n    },\n  })\n","import angular from 'angular'\nimport EmptyResultsContextSwitcher from './emptyResultsContextSwitcher'\n\nexport default angular.module('app.shared.emptyResultsContextSwitcher', [\n  EmptyResultsContextSwitcher.name,\n])\n","import angular from 'angular'\nimport template from './errorModal.html'\n\nexport default angular\n  .module('errorModalServiceModule', [])\n\n  // Service to provide access to launching the modal dialog\n\n  .service('errorModalService', function errorModalService($uibModal, uibModalAriaLabelService) {\n    this.open = function (\n      message,\n      okText,\n      cancelText,\n      title,\n      returnModal,\n      meta = {},\n      callbacks = {}\n    ) {\n      const modal = $uibModal.open({\n        template,\n        controller: [\n          '$scope',\n          'analytics',\n          'config',\n          function ($scope, analytics, config) {\n            Object.assign($scope, {\n              message,\n              okText,\n              cancelText,\n              title,\n              meta,\n              config,\n              ...callbacks,\n            })\n\n            $scope.handleClose = () => {\n              analytics.logEvent('error modal ok button', 'click')\n              if ($scope.onClose) {\n                $scope.onClose()\n              }\n              $scope.$close()\n            }\n\n            $scope.handleDismiss = () => {\n              analytics.logEvent('error modal cancel button', 'click')\n              if ($scope.onDismiss) {\n                $scope.onDismiss()\n              }\n              $scope.$dismiss()\n            }\n          },\n        ],\n        resolve: {\n          message: () => message,\n          okText: () => okText,\n          cancelText: () => cancelText,\n          title: () => title,\n          meta: () => meta,\n          ariaLabel: () => {\n            uibModalAriaLabelService.setLabel(title)\n          },\n        },\n        keyboard: true,\n        backdrop: 'static',\n        windowClass: 'no-scroll',\n      })\n\n      // Allow returning the actual modal instance, or by default\n      // just return the result promise\n\n      if (returnModal) {\n        return modal\n      }\n      return modal.result\n    }\n\n    /**\n     * Opens a custom modal for a given *customTemplate*\n     *\n     * @param { String } customTemplate - Modal template\n     * @param { Object } props - attributes that will be assigned to the modal controller instance.\n     *                           props will be available in the template via `$ctrl`\n     */\n    this.openCustom = (customTemplate, props = {}) => {\n      const modalInstance = $uibModal.open({\n        template: customTemplate,\n        controller: [\n          '$interpolate',\n          '$scope',\n          'lang',\n          function ($interpolate, $scope, lang) {\n            let isRendered = false\n\n            function callAndShutModalFactory(fn, isDismiss = false) {\n              if (!fn._wrappedShut) {\n                fn._wrappedShut = (...args) => {\n                  const result = fn(...args)\n                  if (isDismiss) {\n                    $scope.$dismiss()\n                  } else {\n                    $scope.$close()\n                  }\n                  return result\n                }\n              }\n\n              return fn._wrappedShut\n            }\n\n            Object.assign(this, {\n              ...props,\n              lang,\n              /**\n               * You can access helper functions in the template via $ctrl.$custom...\n               */\n              $custom: {\n                /**\n                 * Factory method: Returns a function that calls the passed function and then closes\n                 * the modal. It is cached (using the original function object as a cache) to\n                 * prevent unnecessary re-rendering. This can be used for React components that\n                 * accept one function argument being passed in.\n                 *\n                 * @example:\n                 *   <react-error-window\n                 *     on-click-primary-button=\"($ctrl.$custom.callAndCloseFactory($ctrl.myFn))\"\n                 *   />\n                 *\n                 * @param fn\n                 * @returns {function(...[*]): *}\n                 */\n                callAndCloseFactory: callAndShutModalFactory,\n                callAndDismissFactory: fn => callAndShutModalFactory(fn, true),\n                /**\n                 * Turns a template string into a interpolated string.\n                 * Use this for passing customized strings to React components.\n                 * Don't use template literals (i.e. backticks `etc`), due to browser compatibility,\n                 * you'll have to use escaped quotes.\n                 *\n                 * @example\n                 *   <react-error-window\n                 *     body=\"$ctrl.$custom.templateToString('\n                 *       {{::$ctrl.lang.values.cancelOrderModal.pleaseDontCancel}}\n                 *     ')\"\n                 *   />\n                 *\n                 * @param template\n                 * @returns {*}\n                 */\n                templateToString: template => $interpolate(template)({ $ctrl: this }),\n                isModalRendered: () => isRendered,\n              },\n            })\n\n            modalInstance.opened.then(() => (isRendered = true)).catch(() => (isRendered = false))\n            modalInstance.$dismiss = $scope.$dismiss\n          },\n        ],\n        keyboard: true,\n        backdrop: 'static',\n        controllerAs: '$ctrl',\n      })\n\n      return modalInstance\n    }\n  })\n","import angular from 'angular'\nimport ErrorModal from './errorModal.js'\n\nexport default angular.module('app.shared.errorModal', [ErrorModal.name])\n","import angular from 'angular'\n\nexport default angular\n  .module('FacetedFilterModalControllerModule', [])\n  .controller('facetedFilterModalController', function ($scope, $timeout, filterModalOptions) {\n    const filterModalElem = () => document.querySelector('button.close')\n    $scope.filterModalOptions = filterModalOptions\n\n    // Focus on modal close button after the template has been loaded\n    $timeout(() => {\n      filterModalElem().focus()\n    })\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('FacetedFilterModalLineItemModule', [])\n  .component('facetedFilterModalLineItem', {\n    bindings: {\n      tagOption: '<',\n      selectedCheckboxObject: '<',\n      toggleOption: '&',\n    },\n    controller(tagsService) {\n      const vm = this\n      vm.tagValue = vm.tagOption.id || vm.tagOption.name\n      vm.fullTag = tagsService.byVal(vm.tagValue, 'filters')\n      // tagOption.name needs to be set to lower case to be used for label and input value\n      vm.displayName = vm.tagOption.display_name || vm.tagOption.name.toLowerCase()\n      vm.itemCount = vm.tagOption.item_count\n\n      vm.onChange = () => {\n        vm.toggleOption({ id: vm.tagValue })\n      }\n    },\n    template: `\n      <div data-test=\"facet {{::$ctrl.tagValue}}\">\n        <input type=\"checkbox\" id=\"tag-{{::$ctrl.tagValue}}\" name=\"tag-{{::$ctrl.tagValue}}\" ng-click=\"$ctrl.onChange()\" ng-model=\"$ctrl.selectedCheckboxObject[$ctrl.tagValue]\">\n        <label for=\"tag-{{::$ctrl.tagValue}}\">\n          <div ng-if=\"::$ctrl.fullTag.icon\" class=\"tag-icon\" tag-style tag=\"$ctrl.fullTag\" tag-location=\"filters\" aria-hidden=\"true\"></div>\n          <span class=\"capitalize\">{{::$ctrl.displayName}} {{::$ctrl.itemCount ? '(' + $ctrl.itemCount + ')' : '' }}</span>\n          <span class=\"indicator\" aria-hidden=\"true\"></span>\n        </label>\n      </div>\n    `,\n  })\n","import _ from 'lodash'\nimport angular from 'angular'\nimport FacetedFilterModalControllerModule from './facetedFilterModalController.js'\nimport FacetedFilterModalLineItemModule from './facetedFilterModalLineItem.js'\n\nexport default angular\n  .module('FacetedFilterModalModule', [\n    FacetedFilterModalControllerModule.name,\n    FacetedFilterModalLineItemModule.name,\n  ])\n  .component('facetedFilterModal', {\n    bindings: {\n      filterModalOptions: '<',\n      dismiss: '<',\n      close: '<',\n    },\n    controller($scope, $state, $stateParams, facetedSearchService, lang) {\n      const vm = this\n      // Ones we definitely need\n      vm.lang = lang\n      vm.selectedBrands = []\n      vm.selectedFacets = []\n      vm.searchTerm = vm.filterModalOptions.searchTerm || $stateParams.search_term || null\n\n      vm.sortOptions = vm.filterModalOptions.sortOptions\n      vm.coreFacets = vm.filterModalOptions.tagOptions\n      vm.secondaryFacets = facetedSearchService.categorizedFacetsObject.sideFilters\n      vm.hideFacets = facetedSearchService.hideFacets\n\n      const currentSort = vm.filterModalOptions.sort || vm.filterModalOptions.defaultSort || null\n      vm.sort = currentSort\n\n      vm.showSort = vm.filterModalOptions.showSort\n\n      vm.content = vm.filterModalOptions.content\n      // See All/Minimize functionality\n      vm.baseNumberShown = 10\n      vm.facetShowMore = _.map(\n        facetedSearchService.categorizedFacetsObject.sideFilters,\n        () => vm.baseNumberShown\n      )\n\n      vm.showOrHideMore = (index, totalNumber) => {\n        vm.facetShowMore[index] = totalNumber || vm.baseNumberShown\n      }\n\n      // \"Sort by selection\" and \"previously selected\" initialization\n      vm.selectedBrandsCheckboxObject = {}\n      if ($stateParams.brand_names || $stateParams.brand_name) {\n        const brandNamesParamArray = $stateParams.brand_names || $stateParams.brand_name\n\n        if (Array.isArray(brandNamesParamArray)) {\n          brandNamesParamArray.forEach(brandName => {\n            vm.selectedBrands.push(brandName)\n            vm.selectedBrandsCheckboxObject[brandName] = true\n          })\n        } else {\n          vm.selectedBrands.push(brandNamesParamArray)\n          vm.selectedBrandsCheckboxObject[brandNamesParamArray] = true\n        }\n      }\n\n      vm.selectedFacetsCheckboxObject = {}\n      if ($stateParams.tags) {\n        if (_.isArray($stateParams.tags)) {\n          _.each($stateParams.tags, tag => {\n            vm.selectedFacets.push(tag)\n            vm.selectedFacetsCheckboxObject[tag] = true\n          })\n        } else {\n          vm.selectedFacets.push($stateParams.tags)\n          vm.selectedFacetsCheckboxObject[$stateParams.tags] = true\n        }\n      }\n\n      const areTagsSameAsOriginal = (originalSelectedTags, currentSelectedTags) => {\n        // originalSelectedTags can be either undefined | string | string[]\n        if (Array.isArray(originalSelectedTags)) {\n          // string[] (more than one filters selected)\n          return (\n            originalSelectedTags.length === currentSelectedTags.length &&\n            _.isEqual(originalSelectedTags, currentSelectedTags)\n          )\n        }\n        if (typeof originalSelectedTags === 'string') {\n          // string (only one filter selected)\n          return (\n            currentSelectedTags.length === 1 && currentSelectedTags.includes(originalSelectedTags)\n          )\n        }\n        // undefined (no filter selected)\n        return currentSelectedTags.length === 0\n      }\n\n      vm.isApplyButtonDisabled = true\n      const updateApplyButton = () => {\n        const originalSelectedFacets = $stateParams.tags\n        const originalSelectedBrands = $stateParams.brand_names || $stateParams.brand_name\n\n        vm.isApplyButtonDisabled =\n          areTagsSameAsOriginal(originalSelectedFacets, vm.selectedFacets) &&\n          areTagsSameAsOriginal(originalSelectedBrands, vm.selectedBrands) &&\n          currentSort === vm.sort\n      }\n      updateApplyButton()\n\n      // A toggle function for adding tags to our selected tags\n      vm.toggleTag = id => {\n        if (_.includes(vm.selectedFacets, id)) {\n          _.remove(vm.selectedFacets, currentID => {\n            return currentID === id\n          })\n        } else {\n          vm.selectedFacets.push(id)\n        }\n        updateApplyButton()\n      }\n\n      // A toggle functions for adding brands to the selected brands\n      vm.toggleBrand = id => {\n        if (_.includes(vm.selectedBrands, id)) {\n          _.remove(vm.selectedBrands, currentID => {\n            return currentID === id\n          })\n        } else {\n          vm.selectedBrands.push(id)\n          facetedSearchService.setTagCrumbs(true, vm.selectedBrands, 'brand_name')\n        }\n        updateApplyButton()\n      }\n\n      // Reset the filters to their defaults\n      vm.reset = function () {\n        vm.selectedBrands = []\n        vm.selectedFacets = []\n        vm.selectedBrandsCheckboxObject = {}\n        vm.selectedFacetsCheckboxObject = {}\n        updateApplyButton()\n      }\n\n      // Apply the filters!\n      vm.apply = function () {\n        const key = $state.current.name === 'main.search' ? 'brand_names' : 'brand_name'\n\n        $state.go('.', {\n          content: vm.content,\n          sort: vm.sort,\n          tags: vm.selectedFacets.length > 0 ? vm.selectedFacets : null,\n          [key]: vm.selectedBrands.length > 0 ? vm.selectedBrands : null,\n          search_term: vm.searchTerm,\n        })\n      }\n\n      // This has been added to support keyboard accessible selecting of brands and tags from the filter\n      // list. This was a quick solution, using tabindex=\"0\" to keyboard focus the li elements within this component,\n      // and this function handles updating the selection state (toggleBrand()) and updating the child faceted-filter-modal-line-item component's\n      // checkbox UI elements' value.\n      vm.keyboardToggleOption = (id, areBrands) => {\n        if (areBrands) {\n          vm.selectedBrandsCheckboxObject[id] = !vm.selectedBrandsCheckboxObject[id]\n          vm.toggleBrand(id)\n        } else {\n          vm.selectedFacetsCheckboxObject[id] = !vm.selectedFacetsCheckboxObject[id]\n          vm.toggleTag(id)\n        }\n      }\n\n      $scope.$watch(() => vm.sort, updateApplyButton)\n    },\n    template: `\n      <div class=\"filter-modal modal-container\" data-test=\"filter-modal\">\n        <div class=\"modal-header\">\n          <button ng-click=\"$ctrl.dismiss()\" class=\"close\" analytics-click=\"['filter modal close button', 'click']\" aria-label=\"{{::$ctrl.lang.aria.modalClose}}\">\n            <span class=\"icon-delete\" aria-hidden=\"true\"></span>\n          </button>\n          <h1 class=\"screen-reader-text\">{{::$ctrl.lang.values.filters}}</h1>\n          <button ng-click=\"$ctrl.reset()\" ng-disabled=\"$ctrl.selectedFacets.length + $ctrl.selectedBrands.length === 0\" class=\"reset\" analytics-click=\"['filter modal reset button', 'click']\">\n            {{::$ctrl.lang.values.reset}}\n            <span ng-if=\"$ctrl.selectedFacets.length + $ctrl.selectedBrands.length > 0\">({{$ctrl.selectedFacets.length + $ctrl.selectedBrands.length}})</span>\n          </button>\n        </div>\n\n        <div class=\"filter-modal-content modal-content\">\n\n          <fieldset ng-if=\"$ctrl.sortOptions && $ctrl.sortOptions.length && $ctrl.showSort\">\n            <legend>\n              <h2>{{::$ctrl.lang.values.sortBy}}</h2>\n            </legend>\n            <ul class=\"sort\">\n              <li ng-repeat=\"sortOption in $ctrl.sortOptions\" class=\"sort-option\">\n                <input ng-model=\"$ctrl.sort\" type=\"radio\" name=\"sortOption\" id=\"tag-{{::sortOption.value}}\" ng-value=\"sortOption.value\" class=\"radio\" aria-current=\"{{sortOption.value === $ctrl.sort ? true : false}}\">\n                <label for=\"tag-{{::sortOption.value}}\" class=\"radio-button\">\n                  <span>{{sortOption.name}}</span>\n                </label>\n              </li>\n            </ul>\n          </fieldset>\n\n          <fieldset ng-if=\"($ctrl.coreFacets && $ctrl.coreFacets.length > 0)\">\n            <legend>\n              <h2>{{::$ctrl.lang.values.filters}}</h2>\n            </legend>\n            <ul class=\"tags list\">\n              <li ng-repeat=\"facetOption in $ctrl.coreFacets\" class=\"tag-option tag {{facetOption.value}} list-item\">\n                <faceted-filter-modal-line-item tag-option=\"facetOption\" selected-checkbox-object=\"$ctrl.selectedFacetsCheckboxObject\" toggle-option=\"$ctrl.toggleTag(id)\"></faceted-filter-modal-line-item>\n              </li>\n            </ul>\n          </fieldset>\n\n          <fieldset ng-if=\"!$ctrl.hideFacets\" ng-repeat=\"facet in $ctrl.secondaryFacets\">\n            <legend>\n              <h2>{{facet.group_display_name}}</h2>\n            </legend>\n            <ul class=\"tags list\">\n              <li ng-repeat=\"facetOption in facet.items | sortBySelected: 'name':$ctrl.selectedBrandsCheckboxObject:$ctrl.selectedFacetsCheckboxObject | limitTo: $ctrl.facetShowMore[$index] track by facetOption.name\" class=\"tag-option tag {{facetOption.value || facetOption.name}} list-item\">\n                <faceted-filter-modal-line-item tag-option=\"facetOption\" selected-checkbox-object=\"$ctrl.selectedBrandsCheckboxObject\" toggle-option=\"$ctrl.toggleBrand(id)\"  ng-if=\"facet.group_display_name === 'Brands'\"></faceted-filter-modal-line-item>\n                <faceted-filter-modal-line-item tag-option=\"facetOption\" selected-checkbox-object=\"$ctrl.selectedFacetsCheckboxObject\" toggle-option=\"$ctrl.toggleTag(id)\" ng-if=\"facet.group_display_name !== 'Brands'\"></faceted-filter-modal-line-item>\n              </li>\n            </ul>\n            <a ng-click=\"$ctrl.showOrHideMore($index, facet.items.length)\" ng-if=\"facet.items.length > $ctrl.facetShowMore[$index]\"  aria-expanded=\"false\">{{::$ctrl.lang.values.seeAll}} ({{facet.items.length}})</a>\n            <a ng-click=\"$ctrl.showOrHideMore($index)\" ng-if=\"facet.items.length === $ctrl.facetShowMore[$index] && facet.items.length > $ctrl.baseNumberShown\" aria-expanded=\"true\">{{::$ctrl.lang.values.seeAll}}</a>\n          </fieldset>\n\n        </div>\n\n        <button ng-click=\"$ctrl.apply()\" ng-disabled=\"$ctrl.isApplyButtonDisabled\" class=\"button mobile-bottom footer\" analytics-click=\"['filter modal apply button', 'click']\" data-test=\"mobile-apply-filters-button\">{{::$ctrl.lang.values.applyFilters}}</button>\n      </div>\n    `,\n  })\n","import angular from 'angular'\nimport FacetedFilterModalLineItemModule from './facetedFilterModalLineItem.js'\n\nexport default angular\n  .module('FacetedFilterModalSectionModule', [FacetedFilterModalLineItemModule.name])\n  .component('facetedFilterModalSection', {\n    bindings: {\n      facet: '<',\n    },\n    controller() {},\n    template: `\n      <section ng-if=\"$ctrl.facet.group_display_name !== 'Categories'\">\n        <h2>{{::$ctrl.facet.group_display_name}}</h2>\n        <ul class=\"tags list\">\n          <li ng-repeat=\"tagOption in $ctrl.facet.items\" class=\"tag-option tag {{tagOption.value}} list-item\" analytics-click=\"['tag filter ' + tagOption.value, 'click']\">\n            <faceted-filter-modal-line-item tag-option=\"tagOption\"></faceted-filter-modal-line-item>\n          </li>\n        </ul>\n      </section>\n    `,\n  })\n","import angular from 'angular'\nimport FacetedFilterModal from './facetedFilterModal'\nimport FacetedFilterModalSection from './facetedFilterModalSection.js'\n\nexport default angular.module('app.shared.facetedFilterModal', [\n  FacetedFilterModalSection.name,\n  FacetedFilterModal.name,\n])\n","/**\n * @deprecated This is a util for use in the angular app to fetch the height of\n * the sticky header in react. Do not use in the react app\n */\nexport const getStickyHeaderHeight = (inEComLightMode = false) => {\n  const stickyHeaderHeight = document.getElementById('sticky-react-header')?.offsetHeight\n  return inEComLightMode ? 72 : stickyHeaderHeight ?? 113\n}\n","import _ from 'lodash'\nimport fp from 'lodash/fp'\n// This is the root component for faceted search. It requires the array of filterable\n// tags for a given client and the results of the /facets GET request.\nimport angular from 'angular'\nimport { getStickyHeaderHeight } from '@app/utils/getStickyHeaderHeight'\nimport template from './facetedFiltersBar.html'\n\nexport default angular.module('FacetedFiltersBarModule', []).component('facetedFiltersBar', {\n  template,\n  bindings: {\n    tags: '<',\n    showSort: '<',\n    subset: '<',\n  },\n  controller(\n    $scope,\n    $state,\n    $stateParams,\n    auth,\n    config,\n    eComLightService,\n    facetedSearchService,\n    lang,\n    utilService\n  ) {\n    $scope.lang = config.lang\n    const vm = this\n\n    vm.inEComLightMode = eComLightService.inEComLightMode\n    vm.lang = lang\n\n    // Component state variables\n    vm.selectedTags = {}\n    vm.selectedBrands = []\n    vm.showSmallDropdown = false\n    vm.showFullDropdown = false\n    vm.extraFiltersOpen = false\n    vm.subset = vm.subset || 'search' // This is the context where this page is operated on. Could be 'shop' or 'search'. Default 'search'.\n\n    // Initialize sorter\n    vm.state = $state\n    vm.sortOptions = config.sortOptions\n    vm.sortOptions =\n      fp.flow(\n        fp.filter(option => _.includes(option.showIn, vm.subset)),\n        fp.sortBy(option => option.order)\n      )(config.sortOptions) || []\n\n    // Set sort order, using a default value if one isn't provided\n\n    let sortValue = $stateParams.sort\n\n    if (!sortValue) {\n      const authMode = auth.user.status === 'trial' ? 'trial' : 'loggedIn'\n      sortValue = config.defaultSort[authMode][vm.subset]\n    }\n\n    const filteredValue = _.filter(vm.sortOptions, { value: sortValue })\n\n    vm.sort = filteredValue[0]\n\n    vm.sortChange = () => {\n      $state.go('.', { sort: vm.sort.value }).then(() => {\n        utilService.focusNodeWhenInDOM(`.faceted-sort-dropdown select`)\n      })\n    }\n\n    if ($stateParams.tags) {\n      if (_.isArray($stateParams.tags)) {\n        _.each($stateParams.tags, tag => {\n          vm.selectedTags[tag] = true\n          facetedSearchService.setTagCrumbs(true, tag, 'tags')\n        })\n      } else {\n        vm.selectedTags[$stateParams.tags] = true\n        facetedSearchService.setTagCrumbs(true, $stateParams.tags, 'tags')\n      }\n    }\n\n    // Wait for `facetedSearchService.getAllFacets` to successfully return data in `searchController`\n    $scope.$on('facetsDataReceived', () => {\n      // Facets based on categories\n      // 'Categories' is always returned from BE and is safe to hardcode\n      vm.categoriesFacetObject = facetedSearchService.categorizedFacetsObject.categories\n    })\n\n    $scope.stickyOffset = getStickyHeaderHeight($scope.inEComLightMode)\n  },\n})\n","import _ from 'lodash'\nimport angular from 'angular'\nimport tagHelper from '@app/angular/reactComponents/checkbox/tagHelper'\nimport template from './facetedSearchCheckbox.html'\n\nexport default angular\n  .module('FacetedSearchCheckboxModule', [])\n  .component('facetedSearchCheckbox', {\n    template,\n    bindings: {\n      checked: '<',\n      id: '<',\n      item: '<',\n      label: '<',\n      selectValue: '<',\n      selectTag: '<',\n      selectedTags: '<',\n    },\n    controller($scope, $state, $stateParams, facetedSearchService, tagsService, utilService) {\n      const vm = this\n\n      const selectTagFilter = facetGroupDisplayName => {\n        const selectedTags = []\n\n        _.each(vm.selectedTags, (selected, tag) => {\n          if (selected) {\n            selectedTags.push(tag)\n          }\n\n          const ignoredGroupTags = [\n            'purchased',\n            'on_sale',\n            'has_coupon',\n            'has_points',\n            'loyalty_deal',\n          ]\n\n          facetedSearchService.setTagCrumbs(selected, tag, 'tags')\n          if (ignoredGroupTags.indexOf(tag) === -1) {\n            facetedSearchService.setGroupDisplayName(selected, facetGroupDisplayName)\n          }\n        })\n\n        tagsService.checkRegistrationRequired({\n          activeTags: vm.selectedTags,\n          allTags: tagsService.tags(),\n          success: () => {\n            $state.go('.', {\n              tags: selectedTags,\n              page: null,\n              group_display_name: facetedSearchService.tagGroupDisplayNameArray,\n              toggledFilterId: $scope.createId,\n            })\n          },\n          failure: () => {\n            $scope.checked = false\n            vm.selectedTags[vm.selectValue] = false\n          },\n        })\n      }\n\n      // Create values to pass to react component\n      $scope.checked = !!vm.checked || false\n      $scope.label = vm.label\n\n      $scope.createId = `tag-${vm.selectValue || ''}`\n      $scope.className = `tag ${vm.selectValue || ''}`.trim()\n\n      const tagFixes = tagHelper(vm.item)\n      $scope.iconClass = vm.item.icon ? tagFixes.iconClass : null\n      $scope.styles = tagFixes.styles\n\n      if (vm.id) {\n        $scope.createId += `-${vm.id}`\n      }\n\n      $scope.onCheckboxChange = () => {\n        $scope.checked = !$scope.checked\n        vm.selectedTags[vm.selectValue] = $scope.checked\n        selectTagFilter(vm.selectValue)\n\n        if ($scope.checked) {\n          // focus on previous checked\n          utilService.focusNodeWhenInDOM(`#${$scope.createId}`)\n        } else {\n          // focus on first element, sometimes when unchecked, it is not visible\n          utilService.focusNodeWhenInDOM(`.faceted-filters-wrapper input`)\n        }\n      }\n    },\n  })\n","// This is the root component for faceted search. It requires the array of filterable\n// tags for a given client and the results of the /facets GET request.\nimport angular from 'angular'\nimport template from './facetedSearchTagCrumbs.html'\n\nexport default angular\n  .module('FacetedSearchTagCrumbsModule', [])\n  .component('facetedSearchTagCrumbs', {\n    template,\n    controller($scope, $state, $stateParams, $timeout, facetedSearchService, lang, utilService) {\n      this.facetedSearchService = facetedSearchService\n      this.lang = lang\n      this.selectedTagCrumbs =\n        $stateParams.tags || $stateParams.brand_name || $stateParams.brand_names\n          ? facetedSearchService.tagCrumbsArray\n          : []\n\n      let brandNamesParam\n      if ($stateParams.brand_name) {\n        brandNamesParam = 'brand_name'\n      } else if ($stateParams.brand_names) {\n        brandNamesParam = 'brand_names'\n      }\n\n      this.removeSelectedTagCrumb = index => {\n        this.selectedTagCrumbs = facetedSearchService.removeTagCrumbByIndex(index)\n\n        const newQueryParams = facetedSearchService.generateTagCrumbsQueryParams()\n\n        const newQueryParamsObject = {\n          tags: newQueryParams.tags.length ? newQueryParams.tags : null,\n          group_display_name: facetedSearchService.tagGroupDisplayNameArray,\n        }\n\n        newQueryParamsObject[brandNamesParam] = newQueryParams.brandNames.length\n          ? newQueryParams.brandNames\n          : null\n\n        $state.go('.', newQueryParamsObject).then(() => {\n          $timeout(() => {\n            const previousIndex = index !== 0 ? index - 1 : index\n            const focusWithinElement =\n              this.selectedTagCrumbs.length === 0\n                ? document.querySelector('.page-header')\n                : document.querySelector('faceted-search-tag-crumbs')\n            utilService.focusWithin(focusWithinElement, previousIndex)\n          })\n        })\n      }\n\n      this.resetSelectedTagCrumbs = () => {\n        this.selectedTagCrumbs = facetedSearchService.resetTagCrumbs()\n        $state\n          .go('.', {\n            tags: null,\n            brand_name: null,\n            brand_names: null,\n            page: null,\n            group_display_name: null,\n          })\n          .then(() => {\n            $timeout(() => {\n              const focusWithinElement = document.querySelector('.page-header')\n              utilService.focusWithin(focusWithinElement)\n            })\n          })\n      }\n\n      this.getFacetDisplayName = name => {\n        return this.facetedSearchService.getFacetDisplayName(name)\n      }\n    },\n  })\n","import angular from 'angular'\nimport FacetedFilterBar from './facetedFiltersBar'\nimport FacetedSearchCheckbox from './facetedSearchCheckbox'\nimport FacetedSearchTagCrumbs from './facetedSearchTagCrumbs'\n\nexport default angular.module('app.shared.facetedFilterBar', [\n  FacetedFilterBar.name,\n  FacetedSearchCheckbox.name,\n  FacetedSearchTagCrumbs.name,\n])\n","import _ from 'lodash'\nimport angular from 'angular'\n\nexport default angular\n  .module('FacetedSearchCategoriesComponentModule', [])\n  .component('facetedSearchCategories', {\n    bindings: {\n      searchContext: '<?',\n      categories: '<',\n      onCategoryClick: '&',\n      selectedCategory: '<',\n    },\n\n    controller(catalogCategoriesService, config, recipeCategoriesService, mobileService) {\n      this.ICSearchEnabled = config.enableICSearch\n\n      switch (this.searchContext) {\n        case 'recipes':\n          this.categoryNameFromID = id => {\n            return recipeCategoriesService.getCategoryFromId(id?.toString())?.name || ''\n          }\n          break\n        default:\n          this.categoryNameFromID = id =>\n            catalogCategoriesService.categoryFromId(id?.toString())?.name || ''\n      }\n\n      this.facetCountFromID = id =>\n        _.find(this.categories, category => {\n          return category.id === id\n        }).item_count || 0\n\n      this.displayClassName = id => {\n        // Set the appropriate class names for each line item  (mobile v desktop, current v active)\n        // TODO: would be nicer if we could unify this in our styles\n        let className = mobileService.isMobile ? 'search-scroll-tab' : 'child'\n        // eslint-disable-next-line eqeqeq\n        if (mobileService.isMobile && this.selectedCategory == id) {\n          className = `${className} current`\n          return className\n        }\n        // eslint-disable-next-line eqeqeq\n        if (!mobileService.isMobile && this.selectedCategory == id) {\n          className = `${className} active`\n          return className\n        }\n        return className\n      }\n    },\n    template: `\n      <ul>\n        <li ng-repeat=\"searchCat in $ctrl.categories\" ng-class=\"$ctrl.displayClassName(searchCat.id)\"  class=\"sidenav-item child\">\n          <button\n            type=\"button\"\n            class=\"text-left\"\n            ng-click=\"$ctrl.onCategoryClick({ id: searchCat.id })\"\n            analytics-click=\"['search menu ' + $ctrl.categoryNameFromID(searchCat.id) + ' link', 'click']\"\n            data-test=\"department-faceted-search-link\"\n            aria-current=\"{{ $ctrl.selectedCategory == searchCat.id }}\"\n          >\n            {{$ctrl.categoryNameFromID(searchCat.id)}}\n            <span ng-if=\"::!$ctrl.ICSearchEnabled\">({{$ctrl.facetCountFromID(searchCat.id)}})</span>\n          </button>\n        </li>\n      </ul>\n    `,\n  })\n","import angular from 'angular'\nimport FacetedSearchCategories from './facetedSearchCategories'\n\nexport default angular.module('app.shared.facetedSearchCategories', [FacetedSearchCategories.name])\n","import _ from 'lodash'\nimport angular from 'angular'\nimport template from './facetedSideFilters.html'\n\nexport default angular.module('FacetedSideFiltersModule', []).component('facetedSideFilters', {\n  template,\n  bindings: {\n    facetedSideFilters: '<',\n  },\n  controller($scope, $state, $stateParams, $timeout, facetedSearchService, lang, utilService) {\n    const vm = this\n\n    // a11y feature to force select of next sequential facet option on group expansion with \"Show All\" button\n    const getFacetFocusOnGroupExpand = (facetGroupIndex, facetIndex) =>\n      document\n        .querySelectorAll('faceted-side-filters fieldset')\n        [facetGroupIndex].querySelectorAll('faceted-side-filters-checkbox')[facetIndex]\n\n    vm.baseNumberShown = 4\n    vm.lang = lang\n    vm.facetShowMore = _.map(\n      facetedSearchService.categorizedFacetsObject.sideFilters,\n      () => vm.baseNumberShown\n    )\n\n    $scope.selectedFacetedSideFilters = {}\n    $scope.selectedFacetedSideBrands = {}\n\n    if ($stateParams.brand_name || $stateParams.brand_names) {\n      const brandNamesParamArray = $stateParams.brand_name || $stateParams.brand_names\n\n      if (_.isArray(brandNamesParamArray)) {\n        _.each(brandNamesParamArray, brandName => {\n          $scope.selectedFacetedSideBrands[brandName] = true\n          facetedSearchService.setTagCrumbs(true, brandName, 'brand_name')\n        })\n      } else {\n        $scope.selectedFacetedSideBrands[brandNamesParamArray] = true\n        facetedSearchService.setTagCrumbs(true, brandNamesParamArray, 'brand_name')\n      }\n    }\n\n    if ($stateParams.tags) {\n      if (_.isArray($stateParams.tags)) {\n        _.each($stateParams.tags, tag => {\n          $scope.selectedFacetedSideFilters[tag] = true\n          facetedSearchService.setTagCrumbs(true, tag, 'tags')\n        })\n      } else {\n        $scope.selectedFacetedSideFilters[$stateParams.tags] = true\n        facetedSearchService.setTagCrumbs(true, $stateParams.tags, 'tags')\n      }\n    }\n\n    vm.showOrHideMore = (facetGroupIndex, totalNumber) => {\n      const indexToFocus = totalNumber ? vm.baseNumberShown : vm.baseNumberShown - 1\n      vm.facetShowMore[facetGroupIndex] = totalNumber || vm.baseNumberShown\n\n      // a11y feature to select sequential option after showing more options, must use $timeout because of angular digest cycle\n      $timeout(() =>\n        utilService.focusWithin(getFacetFocusOnGroupExpand(facetGroupIndex, indexToFocus))\n      )\n    }\n\n    // Wait for `facetedSearchService.getAllFacets` to successfully return data in `searchController`\n    $scope.$on('facetsDataReceived', () => {\n      vm.facetShowMore = _.map(\n        facetedSearchService.categorizedFacetsObject.sideFilters,\n        () => vm.baseNumberShown\n      )\n    })\n  },\n})\n","import _ from 'lodash'\nimport angular from 'angular'\nimport template from './facetedSideFiltersCheckbox.html'\n\nexport default angular\n  .module('FacetedSideFiltersCheckboxModule', [])\n  .component('facetedSideFiltersCheckbox', {\n    template,\n    bindings: {\n      item: '<',\n      parent: '<',\n      selectedFacetedSideFilters: '<',\n      selectedFacetedSideBrands: '<',\n    },\n    controller($scope, $state, facetedSearchService, utilService) {\n      const vm = this\n      const { name } = vm.item\n      const isBrandFilter = vm.parent.group_display_name === 'Brands'\n\n      $scope.checked = !!(isBrandFilter\n        ? vm.selectedFacetedSideBrands[name]\n        : vm.selectedFacetedSideFilters[name])\n\n      const selectTagFilter = facetGroupDisplayName => {\n        const facetedSideTags = []\n        _.each(vm.selectedFacetedSideFilters, (selected, tag) => {\n          if (selected) {\n            facetedSideTags.push(tag)\n          }\n\n          facetedSearchService.setTagCrumbs(selected, tag, 'tags')\n          facetedSearchService.setGroupDisplayName(selected, facetGroupDisplayName)\n        })\n\n        $state.go('.', {\n          tags: facetedSideTags,\n          page: null,\n          group_display_name: facetedSearchService.tagGroupDisplayNameArray,\n        })\n      }\n\n      const selectBrandFilter = () => {\n        const facetedSideBrands = []\n        _.each(vm.selectedFacetedSideBrands, (selected, brand) => {\n          if (selected) {\n            facetedSideBrands.push(brand)\n          }\n\n          facetedSearchService.setTagCrumbs(selected, brand, 'brand_name')\n        })\n\n        const key = $state.current.name === 'main.search' ? 'brand_names' : 'brand_name'\n        $state.go('.', { [key]: facetedSideBrands, page: null })\n      }\n\n      $scope.onCheckboxChange = () => {\n        $scope.checked = !$scope.checked\n\n        if (isBrandFilter) {\n          vm.selectedFacetedSideBrands[name] = $scope.checked\n          selectBrandFilter()\n        } else {\n          vm.selectedFacetedSideFilters[name] = $scope.checked\n          selectTagFilter(vm.parent.group_display_name)\n        }\n\n        if ($scope.checked) {\n          // focus on previous checked\n          utilService.focusNodeWhenInDOM(`#${$scope.createId}`)\n        } else {\n          // focus on first element, sometimes when unchecked, it is not visible\n          utilService.focusNodeWhenInDOM(\n            `#facet-section-${vm.parent.group_display_name.replace(' ', '-')} input`\n          )\n        }\n      }\n\n      $scope.createLabelText = `${vm.item.display_name || vm.item.name} (${vm.item.item_count})`\n\n      $scope.createId = `facet-side-filter-checkbox-${vm.item.name?.replace(' ', '-')}`\n    },\n  })\n","import angular from 'angular'\nimport FacetedSideFilters from './facetedSideFilters'\nimport FacetedSideFiltersCheckbox from './facetedSideFiltersCheckbox'\n\nexport default angular.module('app.shared.FacetedSideFilters', [\n  FacetedSideFilters.name,\n  FacetedSideFiltersCheckbox.name,\n])\n","import _ from 'lodash'\nimport fp from 'lodash/fp'\nimport angular from 'angular'\nimport tagHelper from '@app/angular/reactComponents/checkbox/tagHelper'\nimport template from './filterModal.html'\n\nexport default angular\n  .module('FilterModalComponentModule', [])\n  .controller(\n    'filterModal',\n    function filterModal(\n      $scope,\n      $state,\n      $stateParams,\n      $uibModalInstance,\n      config,\n      filterModalOptions,\n      lang,\n      tagsService\n    ) {\n      this.dismissModal = $uibModalInstance.dismiss\n      this.config = config\n      this.lang = lang\n      this.sortOptions =\n        filterModalOptions.subset && !filterModalOptions.hideSort\n          ? fp.flow(\n              fp.filter(option => _.includes(option.showIn, filterModalOptions.subset)),\n              fp.sortBy(option => option.order)\n            )(config.sortOptions)\n          : []\n\n      this.tagOptions = filterModalOptions.tagOptions.map(tag => {\n        const fullTag = tagsService.byVal(tag.id)\n        // tagHelper applies the correct styles to the tag based on the config\n        const tagStyles = tagHelper(fullTag)\n        return (tag = { ...fullTag, ...tagStyles })\n      })\n\n      this.brandOptions = _.concat(\n        [{ name: 'All Brands', value: null }],\n        filterModalOptions.brandOptions || []\n      )\n\n      this.model = {\n        content: filterModalOptions.content,\n        sort: filterModalOptions.sort || filterModalOptions.defaultSort || null,\n        tags: _.zipObject(\n          filterModalOptions.tags,\n          _.times(_.get(filterModalOptions.tags, 'length', 0), _.constant(true))\n        ),\n        brand: filterModalOptions.brand || filterModalOptions.defaultBrand || null,\n      }\n\n      this.reset = () => {\n        this.model.content = filterModalOptions.content\n        this.model.sort = filterModalOptions.defaultSort || null\n        this.model.tags = {}\n        this.model.brand = filterModalOptions.defaultBrand || null\n      }\n\n      const searchTerm = $stateParams.search_term\n\n      this.applyFilters = function () {\n        $uibModalInstance.close({\n          content: this.model.content,\n          sort: this.model.sort,\n          tags: _.keys(_.pickBy(this.model.tags)),\n          brand_name: this.model.brand,\n          search_term: searchTerm,\n        })\n      }\n\n      this.keyboardToggleTagOption = tagOptionId => {\n        if (this.model.tags.hasOwnProperty(tagOptionId)) {\n          this.model.tags[tagOptionId] = !this.model.tags[tagOptionId]\n        } else {\n          this.model.tags[tagOptionId] = true\n        }\n      }\n\n      this.keyboardSelectBrandOption = brandOptionValue => {\n        this.model.brand = brandOptionValue\n      }\n\n      // Show registration modal if they click on a filter that requires registration\n\n      $scope.$watch(\n        'this.model.tags',\n        (newTags, oldTags) => {\n          if (newTags && newTags !== oldTags) {\n            tagsService.checkRegistrationRequired({\n              activeTags: this.model.tags,\n              allTags: this.tagOptions,\n              success: loginWasRequired => {\n                if (loginWasRequired) {\n                  const activeTags = Object.keys(newTags).filter(key => Boolean(newTags[key]))\n                  $state.go('.', { tags: activeTags, page: null })\n                }\n              },\n            })\n          }\n        },\n        true\n      )\n    }\n  )\n\n  .service('filterModalService', function filterModalService($uibModal, uibModalAriaLabelService) {\n    /**\n     * Opens a filter modal dialog.\n     * @param {FilterOptions} options Options to pass to modal\n     * @return {Promise<FilterResults>} The new filter options to be used\n     */\n    this.open = function (options) {\n      return $uibModal.open({\n        template: template,\n        controller: 'filterModal',\n        controllerAs: '$ctrl',\n        resolve: {\n          filterModalOptions: function () {\n            return options\n          },\n          ariaLabel: () => {\n            uibModalAriaLabelService.setLabel('Filters')\n          },\n        },\n      }).result\n    }\n\n    return this\n  })\n","import angular from 'angular'\nimport FilterModal from './filterModal.js'\n\nexport default angular.module('app.shared.filterModal', [FilterModal.name])\n","import _ from 'lodash'\nimport fp from 'lodash/fp'\nimport angular from 'angular'\nimport tagHelper from '@app/angular/reactComponents/checkbox/tagHelper'\nimport { getStickyHeaderHeight } from '@app/utils/getStickyHeaderHeight'\nimport template from './filters.html'\n\nexport default angular\n  .module('FilterComponentModule', [])\n  .directive('filters', function ($state, $stateParams, eComLightService, tagsService) {\n    return {\n      scope: {\n        filterTags: '=tags',\n        showSort: '=',\n        subset: '@',\n        brands: '=',\n      },\n      template,\n      controller($scope, $element, $attrs, auth, config, lang, utilService) {\n        $scope.auth = auth\n        $scope.config = config\n        $scope.stateParams = $stateParams\n        $scope.state = $state\n        $scope.tagsService = tagsService\n        $scope.inEComLightMode = eComLightService.inEComLightMode\n\n        $scope.fixedTags = $scope.filterTags.map(tag => {\n          const fullTag = tagsService.byVal(tag.id, 'filters')\n          const tagFixes = tagHelper(fullTag)\n          return (tag = { ...fullTag, ...tagFixes })\n        })\n\n        // Manage filtering\n        $scope.tags = {}\n\n        if ($stateParams.tags) {\n          if (_.isArray($stateParams.tags)) {\n            _.each($stateParams.tags, tags => {\n              $scope.tags[tags] = true\n            })\n          } else {\n            $scope.tags[$stateParams.tags] = true\n          }\n        }\n\n        $scope.sortOptions = $scope.subset\n          ? fp.flow(\n              fp.filter(option => _.includes(option.showIn, $scope.subset)),\n              fp.sortBy(option => option.order)\n            )(config.sortOptions)\n          : []\n\n        // Set sort order, using a default value if one isn't provided\n\n        let sortValue = $stateParams.sort\n\n        if (!sortValue) {\n          const authMode = auth.user.status === 'trial' ? 'trial' : 'loggedIn'\n          sortValue = config.defaultSort[authMode][$scope.subset]\n        }\n\n        const filteredValue = _.filter($scope.sortOptions, { value: sortValue })\n\n        $scope.sort = filteredValue[0]\n\n        $scope.sortChange = sort => {\n          $state.go('.', { sort: sort.value }).then(() => {\n            utilService.focusNodeWhenInDOM('.sort select')\n          })\n        }\n\n        // Set Brands\n\n        $scope.mappedBrands = _.map($scope.brands, brand => {\n          return { name: brand, value: brand }\n        })\n\n        // Perform case insensitive sorting\n\n        $scope.mappedBrands.sort((a, b) => {\n          return a.name.toLowerCase().localeCompare(b.name.toLowerCase())\n        })\n\n        $scope.onCheckboxChange = e => {\n          const { checked } = e.target\n          const { id } = e.target\n\n          const newTags = $scope.tags\n          newTags[id] = checked\n\n          tagsService.checkRegistrationRequired({\n            activeTags: $scope.tags,\n            allTags: $scope.filterTags,\n            success: () => {\n              const activeTags = Object.keys(newTags).filter(key => Boolean(newTags[key]))\n              $state.go('.', { tags: activeTags, page: null })\n            },\n          })\n        }\n\n        $scope.mappedBrands.unshift({ name: lang.values.allBrands, value: null })\n        $scope.brand = _.find($scope.mappedBrands, { value: $stateParams.brand_name || null })\n        $scope.stickyOffset = getStickyHeaderHeight($scope.inEComLightMode)\n      },\n    }\n  })\n","import _ from 'lodash'\nimport angular from 'angular'\nimport tagHelper from '@app/angular/reactComponents/checkbox/tagHelper'\n\nexport default angular\n  .module('FiltersBarResizeHideModule', [])\n  .directive('filtersBarResizeHide', function ($timeout, $window, tagsService) {\n    return {\n      link: function (scope, element, attrs) {\n        const root = element.children()[0]\n        const wrapper = angular.element(root).children()[0]\n        const toggles = angular.element(wrapper).children()[0]\n        const more = angular.element(toggles).children()[0]\n        let elWidth = 0\n\n        root.style.visibility = 'hidden'\n\n        // Ideally this would all be more custom with manual insetions in the DOM or pre-calculations of element dimensions\n        const calculateFilters = function () {\n          scope.$applyAsync(scope => {\n            scope.extraFilters = []\n            const manipulate = function () {\n              _.eachRight(angular.element(toggles).children(), (el, index) => {\n                if (index > 0) {\n                  // at index(0) we have the \"More Filters\" dropdown link and it doesn't count as a filter\n                  const tag = el.getAttribute('data-tag-name')\n                  const label = tagsService.byVal(tag, 'filters')\n                  const tagFixes = tagHelper(label)\n                  const mergedLabel = { ...label, ...tagFixes }\n                  if (\n                    el.offsetTop + el.offsetHeight > toggles.offsetTop + toggles.offsetHeight &&\n                    !_.includes(scope.extraFilters, mergedLabel)\n                  ) {\n                    if (mergedLabel) {\n                      // prevent adding duplicate tags\n                      const index = scope.extraFilters.findIndex(x => x.id === mergedLabel.id)\n                      if (index === -1) {\n                        scope.extraFilters.push(mergedLabel)\n                      }\n                    }\n                  }\n                }\n              })\n            }\n\n            // The first timeout accounts from when the filters are added in the DOM and some of them are pushed out\n\n            $timeout(() => {\n              manipulate()\n\n              // The second timeout is for when the dropdown gets added and then pushes one or more filters out of the way\n\n              $timeout(() => {\n                manipulate()\n                root.style.visibility = 'visible'\n                elWidth = root.offsetWidth\n              }, 0)\n            }, 0)\n          })\n        }\n\n        calculateFilters()\n\n        const wrapperWidth = scope.$watch(\n          () => angular.element(wrapper)[0].getBoundingClientRect().width,\n          (newVal, oldVal) => {\n            if (oldVal !== newVal) {\n              calculateFilters()\n            }\n          }\n        )\n\n        scope.$on('$destroy', wrapperWidth)\n      },\n    }\n  })\n","import angular from 'angular'\nimport Filters from './filters.js'\nimport FiltersBarResizeHide from './filtersBarResizeHide.js'\n\nexport default angular.module('app.shared.filters', [Filters.name, FiltersBarResizeHide.name])\n","import { lang as langService } from '@instacart/enterprise-services'\n\n/**\n * Validates the `giftCardLengths` config is correct and that it's not in conflict with `giftCardLength`\n *\n * @param {object}                      config           - Retailer configs\n * @param  {number|undefined}            config.giftCardLength   - Original old giftCardLength config\n * @param  {array<number>|undefined}     config.giftCardLengths  - New multi giftCardLengths config\n */\nexport const validateGiftCardConfigs = function validateGiftCardConfigs(config) {\n  const { giftCardLength, giftCardLengths } = config\n\n  if (giftCardLength && giftCardLengths)\n    console.warn('Conflict: \"giftCardLengths\" config takes precedence over \"giftCardLength\"')\n\n  if (\n    giftCardLengths &&\n    (!Array.isArray(giftCardLengths) || giftCardLengths.some(len => typeof len !== 'number'))\n  )\n    console.error('Invalid config: \"giftCardLengths\" should be an array of numbers')\n}\n\n/**\n * Checks if the gift card number and amount are valid\n *\n * @param {object}                      config           - Retailer configs\n * @param  {number|undefined}            config.giftCardLength   - Original old giftCardLength config\n * @param  {array<number>|undefined}     config.giftCardLengths  - New multi giftCardLengths config\n * @param  {array<number>|undefined}     config.lag              - The lang configs\n *\n * @param {object}                      giftCard         - The gift card information\n * @param  {string}                      giftCard.card_number     - The card number string\n * @param  {string}                      giftCard.amount          - The card amount string\n *\n * @returns {{isValid: boolean, message: (string|null)}}\n */\nexport const validateGiftCard = function validateGiftCard(config, giftCard) {\n  const { amount, card_number: cardNumber } = giftCard || {}\n  const { giftCardLength, giftCardLengths, lang } = config\n  const { hasGiftCardLengths, isGiftCardLengthRange } = produceGiftCardFacts(giftCardLengths)\n\n  const hasInvalidFields = !cardNumber || !amount\n  if (hasInvalidFields) return { isValid: false, message: lang.giftCard.invalidFields }\n\n  const hasBadLength = hasGiftCardLengths\n    ? !giftCardLengths.includes(cardNumber?.length)\n    : giftCardLength && cardNumber?.length !== giftCardLength\n  if (hasBadLength) {\n    const message = langService.interpolate(lang.giftCard.invalidLength, {\n      giftCardLength: hasGiftCardLengths\n        ? isGiftCardLengthRange\n          ? `${giftCardLengths[0]} - ${giftCardLengths[giftCardLengths.length - 1]}`\n          : giftCardLengths.sort().join(` ${lang.or} `)\n        : giftCardLength,\n    })\n\n    return { isValid: false, message }\n  }\n\n  return { isValid: true, message: null }\n}\n\n/**\n * @private\n * Takes in the `giftCardLengths` and produces facts about how the config is defined\n *\n * @param {array<number>|void|unknown} giftCardLengths  - The `giftCardLengths` retailer config\n * @returns {{isGiftCardLengthRange: boolean, hasGiftCardLengths: boolean}}\n */\nfunction produceGiftCardFacts(giftCardLengths) {\n  const hasGiftCardLengths = Array.isArray(giftCardLengths) && giftCardLengths.length > 0\n\n  const isGiftCardLengthRange = Boolean(\n    hasGiftCardLengths &&\n      giftCardLengths.length >= 2 &&\n      giftCardLengths.every((current, idx, arr) => (idx > 0 ? arr[idx - 1] === current - 1 : true))\n  )\n\n  return { hasGiftCardLengths, isGiftCardLengthRange }\n}\n","import angular from 'angular'\nimport { USER_PAYMENT_ACTION } from '@app/angular/services/modules/analytics/analyticsConstants'\nimport { validateGiftCardConfigs, validateGiftCard } from './util/validation'\n\n// eslint-disable-next-line angular/controller-name\nexport default angular\n  .module('GiftCardModalControllerModule', [])\n  .controller(\n    'giftCardModalController',\n    function (\n      $scope,\n      checkoutAnalytics,\n      config,\n      errorModalService,\n      giftCardOptions,\n      lang,\n      mobileService\n    ) {\n      validateGiftCardConfigs(config)\n\n      $scope.error = null\n      $scope.isMobile = mobileService.isMobile\n\n      if (giftCardOptions?.onClose) {\n        $scope.$on('modal.closing', () => giftCardOptions.onClose())\n      }\n\n      $scope.submitAddGiftCard = function () {\n        const { payment } = giftCardOptions\n        const { amount, card_number } = $scope.giftCard || {}\n\n        const { isValid, message } = validateGiftCard(config, $scope.giftCard)\n        if (!isValid) return errorModalService.open(message, lang.values.ok)\n        if (!payment) return errorModalService.open(lang.values.defaultErrorMessage, lang.values.ok)\n\n        // Add new gift card, push to server, then switch back to the old gift cards. Update to new upon success from server.\n        const giftCardsClone = angular.copy(payment.gift_cards)\n        $scope.isLoading = true\n        payment.gift_cards.push({ amount, card_number })\n        payment\n          .put()\n          .then(response => {\n            payment.gift_cards = response.gift_cards // Replace the local cards list with the response version\n            $scope.$dismiss()\n          })\n          .then(() =>\n            checkoutAnalytics.addPaymentOption({\n              payment,\n              success: true,\n              user_action: USER_PAYMENT_ACTION.GIFT_CARD_CHANGE,\n            })\n          )\n          .catch(err => {\n            errorModalService.open(err.data?.message || err.message, 'OK')\n            $scope.isLoading = false\n            checkoutAnalytics.addPaymentOption({\n              payment,\n              success: false,\n              user_action: USER_PAYMENT_ACTION.GIFT_CARD_CHANGE,\n            })\n          })\n\n        payment.gift_cards = giftCardsClone\n      }\n    }\n  )\n","import angular from 'angular'\nimport GiftCardModal from './giftCardModalController.js'\n\nexport default angular.module('app.shared.giftCardModal', [GiftCardModal.name])\n","import angular from 'angular'\nimport template from './imageCell.html'\n\nexport default angular.module('ImageCellComponentModule', []).directive('imageCell', function () {\n  return {\n    scope: {\n      url: '=',\n      imageUrl: '=',\n      promotedMedia: '=',\n      useImageTag: '<',\n    },\n    replace: true,\n    template,\n    controller($scope) {\n      $scope.imageOnly = !$scope.url\n    },\n  }\n})\n","import angular from 'angular'\nimport ImageCell from './imageCell.js'\n\nexport default angular.module('app.shared.imageCell', [ImageCell.name])\n","import _ from 'lodash'\nimport angular from 'angular'\nimport { UNIT_OF_MEASURE } from '@app/angular/constants/uom'\n\nexport default angular\n  .module('InvalidCartItemsDisplayComponentModule', [])\n  .component('invalidCartItemsDisplay', {\n    bindings: {\n      validateResponse: '<',\n      onDismiss: '&',\n    },\n    controller($q, $state, cartService, lang, imageURLService, mobileService) {\n      const vm = this\n      vm.lang = lang\n      vm.imageURLService = imageURLService\n      vm.mobile = mobileService\n      vm.UNIT_OF_MEASURE = UNIT_OF_MEASURE\n      vm.warningMessage = vm.validateResponse.message\n\n      const unavailableItemsIds = vm.validateResponse.unavailable_item_ids\n      const unavailableItems = _.filter(\n        cartService.cart.items,\n        i => unavailableItemsIds.indexOf(i.id) >= 0\n      )\n\n      vm.hasUnavailableItems = unavailableItems.length\n      vm.unavailableItemsByCategory = _.groupBy(\n        unavailableItems,\n        item => item.store_product.categories[0].name\n      )\n\n      vm.removeUnavailableItems = () => {\n        cartService\n          .removeItems(unavailableItems)\n          .then(() =>\n            cartService.countItems() > 0\n              ? cartService.validateCart()\n              : $state.go('main.checkout.cart')\n          )\n          .catch(() => $state.go('main.checkout.cart'))\n\n        vm.onDismiss()\n      }\n\n      vm.goBack = () => {\n        vm.onDismiss()\n        $state.go('main.checkout.cart')\n      }\n    },\n    template: `\n      <div class=\"compare-cart-modal modal-container\">\n        <div class=\"modal-header\">\n          {{::$ctrl.lang.values.warning}}\n        </div>\n        <div class=\"compare-cart-content modal-content\">\n\n          <div class=\"message warn\">\n            <span class=\"icon-warning\" aria-hidden=\"true\"></span>\n            {{::$ctrl.warningMessage}}\n          </div>\n\n          <table class=\"table\">\n            <thead ng-if=\":: (!$ctrl.mobile.isMobile && $ctrl.hasUnavailableItems)\">\n              <tr>\n                <td>{{::$ctrl.lang.values.productName}}</td>\n                <td>{{::$ctrl.lang.values.quantity}}</td>\n                <td>{{::$ctrl.lang.values.total}}</td>\n              </tr>\n            </thead>\n            <tbody ng-repeat=\"(category, items) in ::$ctrl.unavailableItemsByCategory\">\n\n              <!-- Category Heading -->\n\n              <tr class=\"category\">\n                <td colspan=\"3\">{{category}}</td>\n              </tr>\n\n              <!-- Product -->\n\n              <tr ng-repeat=\"item in items track by $index\" class=\"products-list\" ng-if=\"item.quantity > 0 && (!item.store_product.product_type || item.store_product.product_type !== 'subscription')\">\n\n                <!-- Product name / image -->\n\n                <td>\n                  <div class=\"product\">\n                    <div class=\"image\" ng-attr-style=\"background-image: url('{{::$ctrl.imageURLService.getProductImageURL(item.store_product, 'small')}}')\" analytics-click=\"['cart product link', 'click']\"></div>\n                    <div class=\"meta\">\n                      <div class=\"prod-name\">{{item.store_product.name}}</div>\n                      <div ng-if=\"item.hasProductInventoryChange\" class=\"inventory-diff\">{{::$ctrl.lang.values.outOfStock}}</div>\n                      <div ng-if=\"item.hasProductBlackout\" class=\"product-blackout\">{{item.blackoutMessage}}</div>\n                      <div ng-if=\"item.hasconfigurableProductLeadtime\" class=\"product-blackout\">{{item.configurableProductLeadtimeMessage}}</div>\n                      <div ng-if=\"item.hasProductPricingChange\" class=\"pricing-diff\">{{::$ctrl.lang.values.pricingChange}}</div>\n                    </div>\n                  </div>\n                </td>\n\n                <td>\n                  <div class=\"quantity\">\n                    {{:: $ctrl.mobile.isMobile ? $ctrl.lang.values.values.qty + ' ' : ''}}\n                    <span class=\"quant-amnt\">{{item.quantity}}</span>\n                    <span class=\"quant-unit\">{{item.store_product.ordering_parameters.display_name.toLowerCase() != $ctrl.UNIT_OF_MEASURE.EACH ? item.store_product.ordering_parameters.display_name : ''}}</span>\n                  </div>\n                </td>\n\n                <td>\n                  <div class=\"total\">\n                    <div class=\"total-txt\">{{:: $ctrl.mobile.isMobile ? $ctrl.lang.values.total : ''}}</div>\n                    <div class=\"total\">{{item.unit_price | currency}} <span class=\"per-unit\">/ {{item.store_product.display_uom}}</span></div>\n                  </div>\n                </td>\n              </tr>\n            </tbody>\n\n          </table>\n\n          <!-- If the user canProceed they will be given the option to continue or cancel from the dialog -->\n          <!-- If user canProceed is not true they will be given the option to click 'Ok' and that will dismiss the modal -->\n\n          <div class=\"mobile-bottom\" ng-class=\"::{ 'row buttons-box': !$ctrl.mobile.isMobile, 'buttons': $ctrl.mobile.isMobile }\" fixed-to-body>\n            <button\n              ng-click=\"$ctrl.goBack()\"\n              class=\"button\" ng-class=\"::{ 'hollow': !$ctrl.mobile.isMobile, 'mobile-bottom dark': $ctrl.mobile.isMobile }\"\n              analytics-click=\"['invalidCartItems modal back button', 'click']\">\n              {{ $ctrl.lang.values.cancelAndBackToCart }}\n            </button>\n            <button\n              ng-click=\"$ctrl.removeUnavailableItems()\"\n              class=\"button\" ng-class=\"::{ 'mobile-bottom': $ctrl.mobile.isMobile }\"\n              analytics-click=\"['invalidCartItems modal continue button', 'click']\">\n              {{ $ctrl.lang.values.removeAndContinue }}\n            </button>\n          </div>\n        </div>\n      </div>\n\n    `,\n  })\n","import angular from 'angular'\nimport InvalidCartItemsDisplay from './invalidCartItemsDisplay.component'\n\nexport default angular.module('app.shared.invalidCartItemsDisplay', [InvalidCartItemsDisplay.name])\n","import angular from 'angular'\nimport template from './lightBox.html'\n\nexport default angular.module('LightBoxComponentModule', []).component('lightBox', {\n  bindings: {\n    imageUrl: '<',\n    imageName: '<',\n  },\n  controller($scope, $uibModal) {\n    this.openModal = () => {\n      $uibModal.open({\n        template,\n        controller: function lightBoxModalController($scope) {\n          $scope.imageUrl = $scope.$parent.$ctrl.imageUrl\n          $scope.imageName = $scope.$parent.$ctrl.imageName || 'uploaded image'\n        },\n        keyboard: true,\n        scope: $scope,\n      })\n    }\n  },\n  template: `\n      <span ng-click=\"$ctrl.openModal()\" class=\"light-box-file-name\">{{$ctrl.imageName}}</span>\n    `,\n})\n","import angular from 'angular'\nimport LightBox from './lightBox.js'\n\nexport default angular.module('app.shared.lightBox', [LightBox.name])\n","import angular from 'angular'\nimport template from './loadingDots.html'\n\nexport default angular\n  .module('LoadingDotsComponentModule', [])\n  .directive('loadingDots', function () {\n    return {\n      scope: {\n        show: '=',\n      },\n      template,\n    }\n  })\n","import angular from 'angular'\nimport LoadingDots from './loadingDots.js'\n\nexport default angular.module('app.shared.loadingDots', [LoadingDots.name])\n","import angular from 'angular'\nimport dayjs from 'dayjs'\nimport isMobileApp from '@app/utils/isMobileApp'\nimport template from './loyaltyCard.html'\n\nexport default angular\n  .module('LoyaltyCardComponentModule', [])\n  .directive('loyaltyCard', function () {\n    return {\n      scope: {\n        card: '=',\n        loyaltyPass: '=',\n        printable: '=?',\n        useBarcodeNumberLabel: '=?',\n      },\n      replace: true,\n      template,\n      controller(\n        $compile,\n        $document,\n        $scope,\n        $state,\n        $templateCache,\n        $timeout,\n        $q,\n        $window,\n        config,\n        errorModalService,\n        lang,\n        mobileService,\n        userService,\n        utilService\n      ) {\n        const DEFAULT_EXPIRY_DATE_FMT = 'MMM D, YYYY'\n\n        $scope.config = config\n        $scope.lang = lang\n        $scope.mobile = mobileService\n        $scope.util = utilService\n\n        if ($scope.printable === undefined || $scope.printable === null) {\n          $scope.printable = !!config.printableLoyaltyCard\n        }\n\n        const cardImgUrl = utilService.loadAssetImage('images/loyalty-card-bg-design.png')\n        const windowLocation = window.location\n        const origin = `${windowLocation.protocol}//${windowLocation.hostname}${\n          windowLocation.port ? `:${windowLocation.port}` : ''\n        }`\n\n        // origin needed for printing card. Image breaks in mobile app if origin is there\n        $scope.cardImgUrl = isMobileApp() ? cardImgUrl : `${origin}/${cardImgUrl}`\n\n        $scope.render = function () {\n          let progress\n          let pointsRemainder\n          const deferred = $q.defer()\n\n          if (angular.isDefined($scope.card)) {\n            pointsRemainder = $scope.card.points_balance % $scope.card.points_increment\n            $scope.pointsRedemptionDeficit = $scope.card.points_increment - pointsRemainder\n            progress = (pointsRemainder / $scope.card.points_increment) * 100\n          }\n\n          if (config.hasLoyaltyIncrement && $scope.card) {\n            progress = (pointsRemainder / $scope.card.points_increment) * 100\n\n            $timeout(() => {\n              // Wait for dom to be ready\n              Circles.create({\n                id: 'loyalty-progress',\n                radius: 100,\n                value: progress,\n                width: 27,\n                colors: [],\n                text: '',\n                duration: 400,\n              })\n\n              // Override some attributes on the SVG so we can make it responsive.\n\n              const svg = document.querySelector('#loyalty-progress svg')\n              // If we want to override the widge of this via css, we'll need to\n              // strip the inline css attributes\n              // svg.removeAttribute('width');\n              // svg.removeAttribute('height');\n              svg.setAttribute('viewBox', '0 0 200 200')\n              return deferred.promise\n            }, 0)\n          } else {\n            return deferred.promise\n          }\n        }\n\n        $scope.render()\n\n        // Go to Loyalty Pass url\n\n        $scope.openInWallet = function () {\n          // Open the loyalty pass in a new tab/windows on mobile web and in the system browser on cordova\n          $window.open($scope.loyaltyPass.url, isMobileApp() ? '_system' : '_blank')\n        }\n\n        $scope.addToWallet = function () {\n          $scope.updating = true\n          userService\n            .createLoyaltyPass()\n            .then(() => userService.fetchLoyaltyPasses())\n            .catch(response => {\n              $scope.updating = false\n              errorModalService\n                .open(\n                  response?.message || config.lang.defaultErrorMessage,\n                  'Reload',\n                  'Back To Home'\n                )\n                .then(() => {\n                  $state.go($state.current, null, { location: 'replace' })\n                })\n                .catch(() => {\n                  $state.go('main.home')\n                })\n            })\n            .then(() => {\n              $scope.loyaltyPass = userService.loyaltyPasses?.[0]\n              $scope.updating = false\n            })\n        }\n\n        $scope.printCard = function () {\n          const className = 'printing'\n          $document[0].body.classList.add(className)\n\n          const loyaltyCard = document.querySelector('[loyalty-card]').cloneNode(true)\n          loyaltyCard.classList.add('printable')\n          $document[0].body.appendChild(loyaltyCard)\n\n          try {\n            // window.print() doesn't work on Safari in some circumstances,\n            // neither blocks the executions.\n            document.execCommand('print', false, null)\n          } catch {\n            window.print()\n          }\n\n          loyaltyCard.remove()\n\n          $document[0].body.classList.remove(className)\n        }\n\n        $scope.getCardExpiryDate = function (format = DEFAULT_EXPIRY_DATE_FMT) {\n          if ($scope.card?.expiry_timestamp) {\n            return dayjs($scope.card.expiry_timestamp).format(format)\n          }\n          // no expiry date found\n          return ''\n        }\n      },\n    }\n  })\n  .run($templateCache => {\n    $templateCache.put('loyaltyCard.html', require('./loyaltyCard.html'))\n  })\n","import angular from 'angular'\nimport LoyaltyCard from './loyaltyCard.js'\n\nexport default angular.module('app.shared.loyaltyCard', [LoyaltyCard.name])\n","import angular from 'angular'\n\nimport template from './loyaltyInfo.html'\n\nexport default angular\n  .module('loyaltyInfoServiceModule', [])\n  .service('loyaltyInfoService', function registrationService($uibModal) {\n    const service = this\n\n    service.open = function () {\n      const modal = $uibModal.open({\n        template,\n        controller: 'LoyaltyInfoController',\n        keyboard: true,\n        backdrop: true,\n      })\n\n      return modal.result\n    }\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('LoyaltyInfoControllerModule', [])\n  .controller('LoyaltyInfoController', function ($scope, $state, auth) {\n    $scope.auth = auth\n  })\n","import angular from 'angular'\nimport LoyaltyInfoService from './loyaltyInfoService.js'\nimport LoyaltyInfoController from './loyaltyInfoController.js'\n\nexport default angular.module('app.shared.loyaltyInfo', [\n  LoyaltyInfoService.name,\n  LoyaltyInfoController.name,\n])\n","import angular from 'angular'\nimport { AUTH_ACTIONS } from '@app/angular/constants/authActions'\n\nexport default angular\n  .module('LoyaltyOptInPlacementModule', [])\n  .component('loyaltyOptInPlacement', {\n    bindings: {\n      isInfoBox: '<',\n    },\n    controller(auth, lang, registrationService, userService, $state) {\n      const vm = this\n      vm.lang = lang\n\n      // Make sure that the loyalty cards are loaded.\n      userService.getLoyaltyCards()\n\n      vm.shouldShow = () => auth.user.status === 'trial' || !userService.loyaltyCards.length\n      // The loyalty flow should go through the login process automatically if the user is not logged in.\n      vm.proceedToAction = () =>\n        registrationService\n          .open(AUTH_ACTIONS.LOYALTY)\n          .then(() => {\n            return userService.fetchLoyaltyCards()\n          })\n          .then(() => {\n            // Need to reload state for third party sign up on mobile because\n            // instead of redirecting back to the app, the third party auth\n            // closes in app browser window instead resulting in user going back to loyalty sign up view\n            $state.reload('main.account.loyalty')\n          })\n    },\n    template: `\n      <div class=\"loyalty-opt-in-container\" ng-class=\"{'message info-positive': $ctrl.isInfoBox}\" ng-if=\"$ctrl.shouldShow()\" data-test=\"loyalty-opt-in\">\n        <span class=\"icon-error\" aria-hidden=\"true\" ng-if=\"$ctrl.isInfoBox\"></span>\n        <a class=\"button call-to-action\" ng-click=\"$ctrl.proceedToAction()\">\n          {{::$ctrl.lang.values.loyaltyOptInCta}}\n        </a>\n        <strong class=\"\">{{::$ctrl.lang.values.loyaltyOptInHeader}}</strong>\n        <span class=\"\">{{::$ctrl.lang.values.loyaltyOptInDescription}}</span>\n      </div>\n    `,\n  })\n","import angular from 'angular'\nimport LoyaltyOptInPlacement from './loyaltyOptInPlacement.component.js'\n\nexport default angular.module('app.shared.loyaltyOptInPlacement', [LoyaltyOptInPlacement.name])\n","import angular from 'angular'\nimport { AUTH_ACTIONS } from '@app/angular/constants/authActions'\nimport template from './loyaltyPlacement.html'\n\nclass LoyaltyPlacement {\n  constructor($filter, lang, registrationService, userService) {\n    Object.assign(this, {\n      $filter,\n      lang,\n      registrationService,\n      userService,\n    })\n  }\n\n  $onInit() {\n    this.title = this.title || this.lang.values.loyaltySavings\n    this.subtitle = this.subtitle || this.lang.values.loyaltySubtitle\n    this.ctaButtonLabel = this.ctaButtonLabel || this.lang.values.loyaltyJoinNow\n    this.ctaButtonAction =\n      this.ctaButtonAction ||\n      (() =>\n        this.registrationService\n          .open(AUTH_ACTIONS.LOYALTY)\n          .then(() => this.userService.fetchLoyaltyCards()))\n  }\n\n  get formattedTitle() {\n    return this.lang.template(this.title, {\n      savings: this.savings > 0 ? this.$filter('currency')(this.savings) : '',\n    })\n  }\n}\n\nexport default angular.module('LoyaltyPlacementModule', []).component('loyaltyPlacement', {\n  bindings: {\n    savings: '<',\n    title: '@?',\n    subtitle: '@?',\n    ctaButtonLabel: '@?',\n    ctaButtonAction: '&?',\n  },\n  template,\n  controller: LoyaltyPlacement,\n})\n","import angular from 'angular'\nimport LoyaltyPlacement from './loyaltyPlacement'\n\nexport default angular.module('app.shared.loyaltyPlacement', [LoyaltyPlacement.name])\n","import angular from 'angular'\nimport * as storage from '@app/utils/storage'\nimport template from './mobileAppPromotionBanner.html'\n\nexport default angular\n  .module('MobileAppPromotionBannerComponentModule', [])\n  .directive('mobileAppPromotionBanner', function () {\n    return {\n      scope: {},\n      template,\n      controller($scope, config, mobileService, utilService) {\n        const storageKey = 'hideMobilePromotionBanner'\n        // eslint-disable-next-line import/no-named-as-default-member\n        const storageService = storage.getInstance()\n\n        $scope.mobile = mobileService\n        $scope.hasBannerBeenHidden = true\n        $scope.isBannerEnabled = false\n        $scope.config = config\n        $scope.util = utilService\n        // eslint-disable-next-line no-unused-expressions\n        $scope.bannerImageUrl\n        // eslint-disable-next-line no-unused-expressions\n        $scope.appStoreLink\n        checkForBannerHideFlag()\n        setAppStoreLink()\n\n        $scope.closeBanner = function () {\n          storageService.setItem(storageKey, true)\n          $scope.hasBannerBeenHidden = true\n        }\n\n        function setAppStoreLink() {\n          const mobileOs = mobileService.getMobileOs()\n          if (\n            mobileOs &&\n            config.appStoreLinks &&\n            config.appStoreLinks[mobileOs] &&\n            config.mobileAppPromotionBannerImageUrl[mobileOs]\n          ) {\n            $scope.appStoreLink = config.appStoreLinks[mobileOs]\n            $scope.bannerImageUrl = config.mobileAppPromotionBannerImageUrl[mobileOs]\n\n            // Enable banner when a proper app store link and banner is configured for OS/App type combination.\n\n            $scope.isBannerEnabled = true\n          }\n        }\n\n        function getLegacyCookieValue() {\n          const value = `; ${document.cookie}`\n          const parts = value.split(`; ${storageKey}=`)\n          // eslint-disable-next-line eqeqeq\n          if (parts.length == 2) return parts.pop().split(';').shift()\n        }\n\n        function checkForBannerHideFlag() {\n          storageService.getItem(storageKey).then(value => {\n            // Show banner if no value found in storage and cookie\n            // TODO: Remove cookie check once the new storage method has been\n            // running for a release cycle\n            if (!value && !getLegacyCookieValue()) {\n              $scope.hasBannerBeenHidden = false\n            }\n          })\n        }\n      },\n    }\n  })\n","import angular from 'angular'\nimport MobileAppPromotionBanner from './mobileAppPromotionBanner'\n\nexport default angular.module('app.shared.mobileAppPromotionBanner', [\n  MobileAppPromotionBanner.name,\n])\n","import angular from 'angular'\nimport template from './modifyQuantity.html'\n\nexport default angular\n  .module('ModifyQuantityComponentModule', [])\n  .directive('modifyQuantity', function () {\n    return {\n      scope: {\n        item: '=', // {object} The product item\n        incrementFn: '&', // {function} Callback for when the + button on the product is clicked\n        decrementFn: '&', // {function} Callback for when the - button on the product is clicked\n        onUpdate: '&', // {function} Callback for when the weight is changed via the dropdown\n        onZeroFn: '&', // {function} Callback for when the 0lbs weight option is selected\n        includeZero: '=?', // {boolean} Whether to include the 0lbs option on the weight dropdown\n        analyticsName: '@', // {string} The analytics tracking name\n        secondaryStyle: '<', // {boolean} Style the modify quanity component differently?\n        disableInput: '<?', // {boolean} Disable the input\n      },\n      template,\n      controller($scope, $element, $attrs, orderWeightOptionsService, lang) {\n        $scope.lang = lang\n        $scope.orderWeightOptionsService = orderWeightOptionsService\n        $scope.maxItemsInCart = $scope.item.store_product?.ext_data?.max_in_cart || null\n\n        $scope.shouldDisableButton = () => {\n          return (\n            $scope.disableInput ||\n            $scope.item.quantity === $scope.item.ordering_parameters?.max ||\n            $scope.item.quantity >= $scope.item.store_product?.ext_data?.max_in_cart\n          )\n        }\n\n        // For QA regression and automation, need unique IDs between full and side cart\n        $scope.context = $scope.analyticsName === 'side cart product' ? 'sidecart' : 'fullcart'\n\n        // `store_product` needs to be set for when modify quantity is used via Modify Order Add-On feature\n        // this feature necessitates this property because it appears in the PDP, which does not have `store_product`\n        if ($scope.secondaryStyle) {\n          $scope.item.store_product = $scope.item\n        }\n\n        /**\n         * This is called when the modify quantity is changed - via the drop down\n         *\n         * @param {string} originalQuantity   - The string of the number selected\n         */\n        $scope.onUpdateValue = originalQuantity => {\n          /**\n           * onUpdate attribute called with two parameters (these will be recognised in the template)\n           */\n          $scope.onUpdate({\n            $originalQuantity: parseFloat(originalQuantity),\n            $onZeroFn: $scope.onZeroFn,\n          })\n        }\n      },\n    }\n  })\n","import angular from 'angular'\nimport ModifyQuantity from './modifyQuantity.js'\n\nexport default angular.module('app.shared.modifyQuantity', [ModifyQuantity.name])\n","import _ from 'lodash'\nimport angular from 'angular'\nimport template from './notificationSettingsTable.html'\n\nexport default angular\n  .module('NotificationSettingsTableComponentModule', [])\n  .directive('notificationSettingsTable', function (Restangular) {\n    return {\n      scope: {\n        showGroupTitles: '=',\n        atRegistration: '=',\n        onSave: '=',\n      },\n      template,\n      controller($scope, $q, $sce, config, lang) {\n        $scope.config = config\n        $scope.lang = lang\n        $scope.payload = {}\n\n        Restangular.one('user')\n          .one('notifications')\n          .get()\n          .then(notifications => {\n            $scope.notifications = notifications.plain()\n\n            $scope.notificationGroups = config.notificationLabels\n            _.each($scope.notificationGroups, group => {\n              // only show notifications for keys that have been returned by the GET /user/notifications object\n              _.remove(group.notifications, notification => {\n                if (_.has($scope.notifications, notification.key)) {\n                  // Map the notification into a payload for easy saving\n                  $scope.payload[notification.key] = $scope.notifications[notification.key]\n\n                  // trust more text as html as it is defined in configuration and can be trusted.\n                  // trustAsHtml will convert the string to an object so check we do not convert twice\n                  if (notification.moreText && typeof notification.moreText === 'string') {\n                    notification.moreText = $sce.trustAsHtml(notification.moreText)\n                  }\n\n                  return false\n                }\n                return true\n              })\n              // default the set all option\n              $scope.setSubToAllGroup(group)\n            })\n            $scope.filteredNotificationGroups = _.filter(\n              $scope.notificationGroups,\n              $scope.filterGroupRegistrationOnly\n            )\n          })\n\n        $scope.setSubToAllGroup = function (group) {\n          group.all = _.filter(group.notifications, notification => {\n            return notification.showAtNotifications !== false\n          })\n            .map(notification => {\n              return $scope.payload[notification.key]\n            })\n            .every(Boolean)\n        }\n\n        $scope.subToAll = function (group) {\n          _.each(group.notifications, notification => {\n            if (!isResponsysUnavailable(notification)) {\n              $scope.payload[notification.key] = group.all\n            }\n          })\n        }\n\n        $scope.filterRegistrationOnly = function (notification) {\n          return $scope.atRegistration\n            ? notification.showAtRegistration\n            : notification.showAtNotifications !== false\n        }\n\n        $scope.filterGroupRegistrationOnly = function (notificationGroup) {\n          return (\n            !$scope.atRegistration ||\n            _.some(notificationGroup.notifications, notification => {\n              return notification.showAtRegistration\n            })\n          )\n        }\n        const isResponsys = notification => notification.key.indexOf('responsys') !== -1\n\n        const isResponsysUnavailable = notification =>\n          $scope.payload[notification.key].toString().toLowerCase().indexOf('none') !== -1\n\n        $scope.checkDisableNotification = notification =>\n          isResponsys(notification) && isResponsysUnavailable(notification)\n      },\n      link(scope) {\n        scope.onSave = function () {\n          return Restangular.one('user').one('notifications').customPUT(scope.payload)\n        }\n      },\n    }\n  })\n","import angular from 'angular'\nimport NotificationSettingsTable from './notificationSettingsTable.js'\n\nexport default angular.module('app.shared.notificationSettingsTable', [\n  NotificationSettingsTable.name,\n])\n","import angular from 'angular'\nimport template from './nutritionTable.html'\n\nexport default angular.module('NutritionTableModule', []).component('nutritionTable', {\n  bindings: {\n    nutrients: '<',\n  },\n  controller(mobileService, lang) {\n    this.mobile = mobileService\n    this.lang = lang\n  },\n  template,\n})\n","import angular from 'angular'\nimport NutritionTable from './nutritionTable.js'\n\nexport default angular.module('app.shared.nutritionTable', [NutritionTable.name])\n","import angular from 'angular'\nimport template from './offerCell.html'\n\nexport default angular.module('OfferCellComponentModule', []).directive('offerCell', function () {\n  return {\n    scope: {\n      offer: '=',\n      promotedMedia: '=',\n      location: '@',\n    },\n    replace: true,\n    template,\n    controller($scope, config, lang, offerDetailsModalService) {\n      Object.assign($scope, { config, lang, offerDetailsModalService })\n    },\n  }\n})\n","import angular from 'angular'\nimport OfferCell from './offerCell.js'\n\nexport default angular.module('app.shared.offerCell', [OfferCell.name])\n","import angular from 'angular'\n\nexport default angular\n  .module('OfferDetailsModalControllerModule', [])\n  .controller(\n    'OfferDetailsModalController',\n    function ($controller, $scope, auth, cartService, mobileService, offer) {\n      $controller('OfferDetailsController', {\n        $scope,\n        offer,\n      })\n      $scope.isModal = true\n      $scope.auth = auth\n      $scope.cartService = cartService\n      $scope.mobile = mobileService\n    }\n  )\n  .run($templateCache => {\n    $templateCache.put('offerDetails.html', require('../../offers/offerDetails.html'))\n  })\n","import angular from 'angular'\nimport template from './offerDetailsModal.html'\nimport OfferDetailsModalControllerModule from './offerDetailsModalController.js'\n\nexport default angular\n  .module('OfferDetailsModalServiceModule', [OfferDetailsModalControllerModule.name])\n  .service(\n    'offerDetailsModalService',\n    function offerDetailsModalService($uibModal, legacyModalService, uibModalAriaLabelService) {\n      const service = this\n\n      service.open = offer => {\n        legacyModalService.closeOpenModals()\n        $uibModal.open({\n          template,\n          controller: 'OfferDetailsModalController',\n          resolve: {\n            ariaLabel: () => {\n              uibModalAriaLabelService.setLabel('Offer Details')\n            },\n            offer: () => offer,\n          },\n        })\n      }\n    }\n  )\n","import angular from 'angular'\nimport OfferDetailsModal from './offerDetailsModalService.js'\n\nexport default angular.module('app.shared.offerDetailsModal', [OfferDetailsModal.name])\n","import _ from 'lodash'\nimport angular from 'angular'\nimport template from './continuityProgress.html'\n\nexport default angular\n  .module('ContinuityProgressComponentModule', [])\n  .directive('continuityProgress', function () {\n    return {\n      scope: {\n        offer: '=',\n      },\n      replace: true,\n      template,\n      controller($scope, cartService, config, lang, offerDetailsModalService, offersService) {\n        $scope.config = config\n        $scope.lang = lang\n        $scope.offerDetailsModalService = offerDetailsModalService\n\n        // We should use full offers for continuity - we need to PUT some info\n        if ($scope.offer.offer) {\n          offersService.getOffer($scope.offer.id).then(response => {\n            $scope.offer = response\n          })\n        }\n\n        const calculateContinuityOfferProgress = () => {\n          // Work out the current stamp progress arrays for non-cart offers\n          // ie) Progress [1,2,3] -- Remaining [4,5]\n          if ($scope.offer.condition.type !== 'cart') {\n            // This is a truncated offer being returned in the /cart API call\n            if ($scope.offer.condition.max_value) {\n              $scope.continuityStampProgress =\n                $scope.offer.continuity.cdn_count > 0\n                  ? _.range(1, $scope.offer.continuity.cdn_count + 1)\n                  : []\n              $scope.continuityStampProgressRemaining = _.range(\n                $scope.continuityStampProgress.length + 1,\n                Number($scope.offer.condition.max_value) + 1\n              )\n            } else {\n              // Regular offer\n              $scope.continuityStampProgress =\n                $scope.offer.continuity.cdn_count > 0\n                  ? _.range(1, $scope.offer.continuity.cdn_count + 1)\n                  : []\n              $scope.continuityStampProgressRemaining = _.range(\n                $scope.continuityStampProgress.length + 1,\n                Number($scope.offer.condition[$scope.offer.condition.type].quantity) + 1\n              )\n            }\n\n            // Some 3rd parties will prevent the quantity from being set until after the offer is activated - check for updates to this value and update continuityStampProgress\n            $scope.$watchCollection('offer', (newVal, oldVal) => {\n              if (newVal !== oldVal) {\n                $scope.continuityStampProgressRemaining = _.range(\n                  $scope.continuityStampProgress.length + 1,\n                  Number($scope.offer.condition[$scope.offer.condition.type].quantity) + 1\n                )\n              }\n            })\n\n            // Max out at 10 stamps. Essentially a design choice right now, if a\n            // client wants more we'll need a different tile design.\n            if ($scope.continuityStampProgress.length > 10) {\n              $scope.continuityStampProgress = $scope.continuityStampProgress.slice(0, 10)\n            }\n\n            if ($scope.continuityStampProgressRemaining.length > 10) {\n              $scope.continuityStampProgressRemaining = $scope.continuityStampProgressRemaining.slice(\n                0,\n                10\n              )\n            }\n          }\n\n          // Work out current cart $ progress bar for cart offers\n          // ie) $430 of $500\n          if ($scope.offer.condition.type === 'cart') {\n            // This is a truncated offer being returned in the /cart API call\n            if ($scope.offer.condition.max_value) {\n              $scope.continuityCartProgressMax = $scope.offer.condition.max_value\n            } else {\n              // Regular offer\n              $scope.continuityCartProgressMax = $scope.offer.condition.cart.min_spend\n            }\n\n            $scope.continuityProgressBarWidth = `${Math.min(\n              Math.max(\n                Number(\n                  ($scope.offer.continuity.cdn_count / $scope.continuityCartProgressMax) * 100\n                ),\n                0\n              ),\n              100\n            )}%`\n          }\n        }\n\n        // Calculate the progress of active offers\n        if ($scope.offer.continuity && $scope.offer.continuity.offer_activated) {\n          calculateContinuityOfferProgress()\n        }\n\n        // Start a continuity offer by sending `offer_activated = true`\n        $scope.startContinuityOffer = (event, offer) => {\n          // Don't trigger the default offer cell modal opening\n          if (event) {\n            event.stopPropagation()\n          }\n\n          offer.offer_activated = true\n          offer.continuity.offer_activated = true\n\n          offer.put().then(response => {\n            $scope.offer = response\n            calculateContinuityOfferProgress()\n            cartService.fetch()\n          })\n        }\n      },\n    }\n  })\n","import _ from 'lodash'\nimport angular from 'angular'\n\nexport default angular\n  .module('OfferIconComponentModule', [])\n  .directive('offerIcon', function (config) {\n    return {\n      scope: {\n        offer: '=',\n      },\n      template: '<div class=\"offer-icon\" ng-class=\"offerIcon()\" style=\"{{offerImage}}\"></div>',\n      replace: true,\n      controller: function ($scope, $element) {\n        // A function to update the styling for offers with associated images. Immediately invoked.\n        const updateOfferImage = () => {\n          if (\n            $scope.offer &&\n            $scope.offer.images &&\n            $scope.offer.images.tile &&\n            $scope.offer.images.tile.medium\n          ) {\n            $scope.offerImage = 'background-image: url(\"' + $scope.offer.images.tile.medium + '\")'\n          } else {\n            $scope.offerImage = ''\n          }\n        }\n        updateOfferImage()\n\n        // A watcher to make sure images get updated if the offer call is too slow\n        $scope.$watch('offer', (newOffer, oldOffer) => {\n          if (_.isEmpty($scope.offerImage) || newOffer !== oldOffer) {\n            updateOfferImage()\n          }\n        })\n\n        $scope.offerIcon = function () {\n          if (\n            $scope.offer &&\n            $scope.offer.reward.type == 'percent' &&\n            $scope.offer.reward.value == 100\n          ) {\n            return 'amount'\n          } else {\n            // Default to the cart icon if the offer is waiting.\n            return $scope.offer\n              ? config.offerIcons[$scope.offer.reward.type]\n              : config.offerIcons.cart\n          }\n        }\n      },\n    }\n  })\n","export const CONDITION_TYPES = {\n  PRODUCT: 'products',\n  BRAND: 'brands',\n  COLLECTION: 'collection',\n  CATEGORIES: 'categories',\n\n  CART: 'cart',\n  NONE: 'none',\n}\n\nexport const OFFER_TYPES = {\n  COUPON: 'coupon',\n  CONTINUITY: 'continuity',\n  PRODUCT: 'products',\n  DISCOUNT: 'discount',\n}\n\nexport const DISCOUNT_AND_REWARD_TYPES = {\n  AMOUNT: 'amount',\n  PERCENT: 'percent',\n  SET_PRICE: 'set_price',\n  NONE: 'none',\n}\n\nexport const PRODUCT_CELL_OFFER_TYPES = {\n  AMOUNT_REWARD: 'amountReward',\n  BMSM: 'bmsm',\n  BUY_X: 'buyX',\n  PERCENT_REWARD: 'percentReward',\n}\n\nexport const ITEM_CONDITION_TYPES = [\n  CONDITION_TYPES.PRODUCT,\n  CONDITION_TYPES.BRAND,\n  CONDITION_TYPES.COLLECTION,\n  CONDITION_TYPES.CATEGORIES,\n]\n","import angular from 'angular'\nimport template from './offerProgress.html'\n\nimport { CONDITION_TYPES, OFFER_TYPES, ITEM_CONDITION_TYPES } from '../../../constants/offers'\n\nexport default angular\n  .module('OfferProgressComponentModule', [])\n  .directive('offerProgress', $filter => {\n    return {\n      scope: {\n        offerProgressData: '=',\n        openOfferDetailsModal: '&?',\n      },\n      template,\n      controller($scope, lang) {\n        /*\n         * Language constants\n         */\n        const {\n          getTheDeal,\n          itemConditionType,\n          cartConditionType,\n          rewardType,\n          complete,\n        } = lang.values.offersContent\n        const { spendMoreToQualify, addItemsToQualify, addMoreToQualify } = itemConditionType\n        const { spendMoreToComplete } = cartConditionType\n        const { multipleItemsForReward, singleItemForReward } = rewardType\n        const { clipThisCoupon, offerCompleted, offerTimes } = complete\n\n        /*\n         * OFFER LABELS\n         */\n        // eslint-disable-next-line complexity\n        $scope.$watch('offerProgressData', value => {\n          $scope.offerCount = null // this handles when offers are removed\n          $scope.label = getTheDeal\n\n          if (value) {\n            const { reward } = value\n            const conditionType = value.condition.type\n            const conditionCurrent = parseFloat(value.condition.current_value) || 0\n            let conditionMax = parseInt(value.condition.max_value, 10) || 0\n\n            if (\n              value.offer &&\n              value.offer.additional_cdns &&\n              value.offer.additional_cdns.length > 1\n            ) {\n              conditionMax = value.offer.additional_cdns.reduce(\n                (accumulator, cdn) => accumulator + cdn.products.quantity,\n                0\n              )\n            }\n\n            const conditionDifference = conditionMax - conditionCurrent\n            const rewardDifference = reward ? reward.max_value - reward.current_value : 0\n\n            if (ITEM_CONDITION_TYPES.includes(conditionType) && conditionDifference > 0) {\n              const offerConditionData = value.offer.condition[conditionType]\n\n              if (offerConditionData?.min_spend) {\n                const conditionMax = parseFloat(offerConditionData.min_spend) || 0\n                const conditionDifference = (conditionMax - conditionCurrent).toFixed(2)\n                $scope.label = lang.template(spendMoreToQualify, { conditionDifference })\n              } else {\n                const conditionMinWeight = offerConditionData?.min_weight\n                const minWeightStr = conditionMinWeight\n                  ? `(${conditionMinWeight}${offerConditionData.uom})`\n                  : ''\n                const itemTitle = $filter('pluralize')('item', conditionDifference)\n                $scope.label = lang.template(addMoreToQualify, {\n                  conditionDifference,\n                  itemTitle,\n                  minWeightStr,\n                })\n              }\n            }\n\n            if (conditionType === CONDITION_TYPES.CART && conditionDifference > 0) {\n              $scope.label = lang.template(spendMoreToComplete, {\n                conditionDifference: conditionDifference.toFixed(2),\n              })\n            }\n\n            // Detect collection missing condition data\n            if (conditionType === CONDITION_TYPES.COLLECTION && conditionCurrent === 0) {\n              $scope.label = addItemsToQualify\n            }\n\n            // Show how many reward products need to be added to redeem the offer\n            if (\n              conditionType !== CONDITION_TYPES.NONE &&\n              conditionDifference <= 0 &&\n              rewardDifference > 0\n            ) {\n              $scope.label =\n                rewardDifference > 1\n                  ? lang.template(multipleItemsForReward, { rewardDifference })\n                  : singleItemForReward\n            }\n\n            // Label offers as completed, with an optional count if completed more than once\n            if (conditionType === CONDITION_TYPES.NONE || value.completion_count > 0) {\n              if (value.offer.offer_type === OFFER_TYPES.COUPON && value.offer.clipped === false) {\n                $scope.label = clipThisCoupon\n              } else {\n                const count = value.completion_count\n                $scope.label = lang.template(offerCompleted, {\n                  text: count > 1 ? `${count} ${offerTimes}` : '',\n                })\n              }\n            }\n\n            $scope.offerCount = value.completion_count ? value.completion_count : ''\n\n            let progress = 0\n            if (value.completion_count > 0 || ($scope.offerCount && conditionCurrent === 0)) {\n              progress = 100\n            } else {\n              progress = Math.min(\n                Math.max(parseInt((conditionCurrent / (conditionMax || 1)) * 100, 10), 0),\n                100\n              )\n            }\n\n            $scope.progress = `${progress}%`\n\n            // Set values to determine if we are displaying completed, conditional or the unclipped state for the progress indicator.\n            $scope.completed = value.completion_count > 0\n            $scope.conditional = $scope.progress === '100%' && !$scope.completed\n\n            if (\n              $scope.offerProgressData.offer_type === OFFER_TYPES.COUPON ||\n              ($scope.offerProgressData.offer &&\n                $scope.offerProgressData.offer.offer_type === OFFER_TYPES.COUPON)\n            ) {\n              $scope.unclipped = $scope.completed && $scope.offerProgressData.clipped === false\n            }\n          }\n        })\n      },\n    }\n  })\n","// This directive can be used in two ways. Either directly if the offer you have\n// access to on scope is a full cart offer (ie. offer-tile=\"offer\"), otherwise\n// you can provide a product's offer reference, and it will fetch the all of the\n// associated offer info (ie. <div offer-tile offer-data=\"offer\"> ).\nimport angular from 'angular'\nimport template from './offerTile.html'\n\nexport default angular.module('OfferTileModule', []).directive('offerTile', function () {\n  return {\n    scope: {\n      offer: '=?offerTile',\n      offerData: '=',\n      offerOrigin: '<?',\n      location: '@',\n      disableCouponClipping: '<?',\n    },\n    template: template,\n    controller: function (\n      $rootScope,\n      $scope,\n      $element,\n      $attrs,\n      config,\n      cartService,\n      lang,\n      offerAnalytics,\n      offerDetailsModalService,\n      offersService\n    ) {\n      $scope.config = config\n      $scope.lang = lang\n      $scope.offerDetailsModalService = offerDetailsModalService\n      $scope.openOfferModal = offer => {\n        const offerId = offer.id\n        const { offerOrigin } = $scope\n\n        if (!offer.has_details) {\n          return\n        }\n\n        offersService.getOffer(offerId).then(offer => {\n          offerDetailsModalService.open(offer)\n\n          offerAnalytics.viewOffers({\n            offers: [offer],\n            offerPageMeta: { count: 1 },\n            offerOrigin: offerOrigin && Object.assign({ store_product: offerOrigin }, offerOrigin),\n            is_modal: true,\n          })\n        })\n      }\n\n      if ($scope.offerData) {\n        // offerData is an offer reference with not all of the offer information, so in order to populate the offer information for\n        // the tile we need to use the getOfferData function.\n        offersService.getOfferData($scope.offerData.id).then(offerProgressData => {\n          $scope.offer = offerProgressData\n        })\n        // We need to listen for the cart being synced so that the offer progress indicator\n        //  will be updated when the cart changes.\n        const deregisterListener = $scope.$watch(\n          () => cartService.lastUpdated,\n          newVal => {\n            offersService.getOfferData($scope.offerData.id).then(offerProgressData => {\n              $scope.offer = offerProgressData\n            })\n          }\n        )\n        $scope.$on('$destroy', () => {\n          deregisterListener()\n        })\n      }\n    },\n  }\n})\n","import angular from 'angular'\n\nimport ContinuityProgress from './continuityProgress.js'\nimport OfferIcon from './offerIcon.js'\nimport OfferProgress from './offerProgress.js'\nimport OfferTile from './offerTile.js'\n\nexport default angular.module('app.shared.offers', [\n  ContinuityProgress.name,\n  OfferIcon.name,\n  OfferProgress.name,\n  OfferTile.name,\n])\n","import angular from 'angular'\nimport template from './orderDeliveryInstructionsForm.html'\n\nconst ORDER_DELIVERY_INSTRUCTIONS = 'orderDeliveryInstructions'\n\n/**\n * This handles the Order Delivery Instructions section in checkout, which depends on IC Fulfillment\n *\n * - The source of truth for the read only values is via the cart (in different places)\n * - For the input fields, their source is controlled via a $ctrl.draft object\n * - The address comment is synced as the address changes, depending on the app state\n */\nexport default angular\n  .module('OrderDeliveryInstructionsFormModule', [])\n  .component('orderDeliveryInstructionsForm', {\n    bindings: {\n      editMode: '<',\n      title: '@',\n      contact: '<',\n      onSave: '&',\n      edit: '&',\n      condensed: '<',\n      hideChevron: '<',\n      sectionOptions: '<',\n      validateCart: '&',\n    },\n    template,\n    controller: function OrderDeliveryInstructionsForm(\n      $q,\n      $rootScope,\n      $scope,\n      addressList,\n      cartService,\n      checkoutService,\n      config,\n      lang,\n      utilService\n    ) {\n      Object.assign(this, {\n        cartService,\n        config,\n        lang,\n        utilService,\n        hasErrors: false,\n        isInitialized: false,\n        isSaving: false,\n        watcherDestroyFns: [],\n        draft: { comment: null, leaveUnattended: null },\n      })\n\n      /**\n       * @private\n       * Helper functions\n       */\n      const isCommentSet = comment => typeof comment === 'string'\n      const isUnattendedSet = leaveUnattended => typeof leaveUnattended === 'boolean'\n\n      /**\n       * Initialization and Destroying\n       * • Synchronize the input fields on entering edit mode\n       * • If \"syncSelectedAddress\": Synchronize the cart if address changes\n       * • If never saved a comment: Synchronize the cart if address changes\n       *   (And auto save that comment if auto save is on)\n       */\n      this.$onInit = () => {\n        this.synchronize()\n\n        this.watcherDestroyFns = [\n          $scope.$watch(\n            () => this.editMode,\n            editMode => editMode && this.synchronize()\n          ),\n          $scope.$watch(() => checkoutService.deliveryAddress, this.onAddressChange),\n        ]\n      }\n      this.$onDestroy = () => this.watcherDestroyFns.forEach(destroyer => destroyer())\n\n      /**\n       * @private\n       * Triggered when edit mode is entered, syncing the edit fields with the saved fields\n       */\n      this.synchronize = () => {\n        const comment = this.getComment()\n        const leaveUnattended = this.isUnattendedDelivery()\n        Object.assign(this.draft, { comment, leaveUnattended })\n      }\n\n      /**\n       * @private\n       * Triggered when a new address is selected (also triggered at least once by initial address)\n       * This will update the comment if it is null OR if syncing of addresses is turned on.\n       * Note: This determines whether to open the UI section or not initially!\n       * (The two boolean parameters are controlled via configs)\n       *\n       * @param {object}  newAddress - The new address object\n       * @returns {*}\n       */\n      this.onAddressChange = newAddress => {\n        const { autoSaveInitially, syncSelectedAddress } = this.sectionOptions || {}\n        const { comment } = cartService.getOrderDeliveryInstruction()\n        const addressComment = newAddress?.instructions\n        const isInitialAutoSave = autoSaveInitially && comment === null && addressComment\n\n        if ((syncSelectedAddress || comment === null) && newAddress?.id) {\n          Object.assign(this.draft, { comment: addressComment || '' })\n          return this.handleSubmit().then(() => !isInitialAutoSave && this.onSave())\n        }\n      }\n\n      /**\n       * Get the current comment, either as set in the cart object or the delivery address\n       * comment as a default\n       * @returns {string | void}\n       */\n      this.getComment = () => {\n        const { comment } = cartService.getOrderDeliveryInstruction()\n        return isCommentSet(comment) ? comment : ''\n      }\n\n      /**\n       * Get the current state of unattended delivery as either set in the cart object, or using a\n       * propagated config value¹, but false if there is alcohol!\n       * ¹: config.StepsOrder[<orderDeliveryInstructions>].options.initialUnattendedDelivery\n       * @returns {boolean}\n       */\n      this.isUnattendedDelivery = () => {\n        const { leaveUnattended } = cartService.getOrderDeliveryInstruction()\n        return Boolean(\n          !cartService.getHasAlcohol() &&\n            (isUnattendedSet(leaveUnattended)\n              ? leaveUnattended\n              : this.sectionOptions?.initialUnattendedDelivery)\n        )\n      }\n\n      /**\n       * Whether the unattended delivery checkbox should be enabled or not.\n       * For modify or alcohol, it will be disabled!\n       * @returns {boolean}\n       */\n      this.enableUnattendedDeliveryCheckbox = () => {\n        return !cartService.getHasAlcohol() && !$rootScope.modifyingOrder && !this.isSaving\n      }\n\n      /** Provides dynamic UI messaging */\n      this.messages = {\n        comment: () => {\n          const { comment } = cartService.getOrderDeliveryInstruction()\n          return comment || ''\n        },\n        unattendedDelivery: () => {\n          const { leaveUnattended } = cartService.getOrderDeliveryInstruction()\n          return leaveUnattended ? lang.values.orderDeliveryInstructions.unattendedDelivery : ''\n        },\n        warning: () => {\n          const {\n            alcoholNotice,\n            warningWithUnattended,\n            warningWithoutUnattended,\n          } = lang.values.orderDeliveryInstructions\n\n          if (cartService.getHasAlcohol()) return alcoholNotice\n          return this.isUnattendedDelivery() ? warningWithUnattended : warningWithoutUnattended\n        },\n      }\n\n      /**\n       * Changes the section to edit mode by calling the edit prop function\n       * @returns { undefined }\n       */\n      this.enterEditMode = () => this.edit({ step: ORDER_DELIVERY_INSTRUCTIONS })\n\n      /**\n       * Handles the form submit\n       *\n       * If has changes:\n       * 1. Sync the instructions to the cart object\n       * 2. Save the leaveUnattended state to the checkout model (causes section close)\n       * 3. Update the address comments if the config requires it\n       *\n       * If not changes:\n       * 1. Save the leaveUnattended state to the checkout model (causes section close)\n       *\n       * @returns { Promise }\n       */\n      this.handleSubmit = () => {\n        const { comment: commentDraft, leaveUnattended: leaveUnattendedDraft } = this.draft\n        const { comment, leaveUnattended } = cartService.getOrderDeliveryInstruction()\n        const hasChange = commentDraft !== comment || leaveUnattendedDraft !== leaveUnattended\n\n        this.hasErrors = false\n        if (hasChange) {\n          return $q\n            .resolve()\n            .then(() => (this.isSaving = true))\n            .then(() =>\n              cartService.updateOrderDeliveryInstruction(commentDraft, leaveUnattendedDraft)\n            )\n            .then(() => this.onSave({ leaveUnattended: leaveUnattendedDraft }))\n            .then(() => this.updateAddressIfRequired(commentDraft))\n            .catch(error => {\n              checkoutService.logCheckoutErrorAnalytics(error)\n              this.hasErrors = true\n              this.onSave() // Force this section open again\n              console.error(error)\n            })\n            .finally(() => (this.isSaving = false))\n        }\n        this.onSave({ leaveUnattended: leaveUnattendedDraft })\n        return $q.resolve()\n      }\n\n      /**\n       * @private\n       * Updates the current address if the \"syncSelectedAddress\" is switched on\n       *\n       * @param {string} instructions     - The new instruction\n       * @return {undefined}\n       */\n      this.updateAddressIfRequired = instructions => {\n        const { deliveryAddress } = checkoutService\n        const id = deliveryAddress?.id\n        if (this.sectionOptions?.syncSelectedAddress && id) {\n          Object.assign(deliveryAddress, { instructions })\n          addressList.saveAddress(deliveryAddress)\n        }\n      }\n    },\n  })\n","import angular from 'angular'\nimport OrderDeliveryInstructionsForm from './orderDeliveryInstructionsForm'\n\nexport default angular.module('app.shared.orderDeliveryInstructionsForm', [\n  OrderDeliveryInstructionsForm.name,\n])\n","import angular from 'angular'\n\nexport default angular.module('OverlayModule', []).directive('overlay', function ($document) {\n  return {\n    restrict: 'A',\n    scope: true,\n    link(scope, element, _) {\n      function onClick() {\n        const sideCartContainer = $document[0].getElementsByClassName('slideInRight')[0]\n        sideCartContainer.classList.remove('hover')\n        scope.$root.isSideCartOpen = false\n        scope.$root.$apply()\n      }\n\n      element.on('click', onClick)\n    },\n  }\n})\n","import angular from 'angular'\nimport Overlay from './overlayDirective'\n\nexport default angular.module('app.shared.overlay', [Overlay.name])\n","import _ from 'lodash'\nimport angular from 'angular'\nimport template from './pageHeader.html'\n\nexport default angular\n  .module('PageHeaderComponentModule', [])\n  .directive('pageHeader', function () {\n    return {\n      scope: {\n        label: '=',\n        loading: '=',\n        background: '=',\n        breadcrumbs: '=',\n        button: '=',\n        link: '=',\n        previousPage: '=',\n        hideMobileAnimation: '<',\n        flyerData: '<?',\n        previewToken: '@?',\n        noBackgroundBorder: '=',\n        searchReformulationText: '=',\n        selectedFilters: '<',\n        showSearchTabs: '=?',\n        initialSearchTerm: '=',\n        isSpellCorrected: '=',\n        searchSpellCorrectionDisabledSref: '=',\n      },\n      transclude: true,\n      replace: 'element',\n      template,\n      controller(\n        $filter,\n        $scope,\n        $state,\n        config,\n        eComLightService,\n        facetedSearchService,\n        lang,\n        mobileService,\n        utilService,\n        searchService\n      ) {\n        $scope.lang = lang\n        $scope.mobileService = mobileService\n        $scope.state = $state\n        $scope.utilService = utilService\n        $scope.tabs = searchService.getTypes()\n        $scope.facetedSearchService = facetedSearchService\n        $scope.config = config\n\n        $scope.enableBackground = mobileService.isMobile\n          ? config.enablePageHeaderBackground?.mobile\n          : config.enablePageHeaderBackground?.desktop\n        $scope.tabHrefParamCategoryId =\n          eComLightService.inEComLightMode && eComLightService.eComLightCategory\n            ? eComLightService.eComLightCategory\n            : null\n\n        // Explicitly stop breadcrumbs from inheiriting a page param, we always\n        // want breadcrumbs to direct the user to the first page for paginated items.\n        if ($scope.breadcrumbs) {\n          _.forEach($scope.breadcrumbs, breadcrumb => {\n            if (breadcrumb.params) {\n              breadcrumb.params.page = null\n            } else {\n              breadcrumb.params = { page: null }\n            }\n          })\n        }\n\n        $scope.hasFacetedSearchFilters = config.enableFacetedSearchFilters || config.enableICSearch\n        $scope.isSearchState = $filter('includedByState')('main.search')\n\n        if ($scope.showSearchTabs === undefined) {\n          $scope.showSearchTabs = searchService.hasMultipleTypes() && $scope.isSearchState\n        }\n\n        $scope.activeTab = searchService.getTypeBy($state.current.name, 'state')\n\n        $scope.hasMultipleSearchTabs = searchService.hasMultipleTypes()\n\n        if (mobileService.isMobile) {\n          const getFacetDisplayName = name => {\n            return $scope.facetedSearchService.getFacetDisplayName(name)\n          }\n\n          $scope.getFacetDisplayNames = names => {\n            const displayNames = []\n            if (names) {\n              const nameArray = names.split(', ')\n              nameArray.forEach(name => {\n                displayNames.push(getFacetDisplayName(name))\n              })\n              return displayNames.toString().replace(/,/g, ', ')\n            }\n            return null\n          }\n          // Figure out back button behaviour for mobile\n\n          const currentBreadcrumb =\n            $scope.breadcrumbs && $scope.breadcrumbs[$scope.breadcrumbs.length - 1]\n          const currentBreadcrumbCategoryId =\n            (currentBreadcrumb &&\n              currentBreadcrumb.params &&\n              currentBreadcrumb.params.category_id) ||\n            null\n          $scope.shouldShowMobileBackButton = () =>\n            !(\n              eComLightService.inEComLightMode &&\n              currentBreadcrumbCategoryId &&\n              currentBreadcrumbCategoryId === eComLightService.eComLightCategory\n            )\n\n          $scope.mobileGoBack = () => {\n            if ($scope.previousPage) {\n              utilService.goBack()\n            } else {\n              // The breadcrumb that comes right before the current page\n              const breadcrumbParent =\n                $scope.breadcrumbs && $scope.breadcrumbs.length > 1\n                  ? $scope.breadcrumbs[$scope.breadcrumbs.length - 2]\n                  : null\n\n              // Direct the user to the breadcrumbParent state/page unless it's the Ways to Shop page (which we\n              //  don't want to show in mobile), or unless the breadcrumb state does not contain a route\n              // TODO: Perhaps find a way to erase the 'main.shop' route from the breadcrumbs altogether if the user is in mobile\n              // TODO: Eventually we should probably avoid using breadcrumbs that do not contain their corresponding state\n              if (\n                breadcrumbParent &&\n                breadcrumbParent.state &&\n                breadcrumbParent.state !== 'main.shop'\n              ) {\n                $state.go(breadcrumbParent.state, breadcrumbParent.params)\n              } else {\n                $state.go('main.home')\n              }\n            }\n          }\n        }\n        $scope.showNewTag = tab =>\n          config.searchTabTag.enabled &&\n          config.searchTabTag.tab.toLowerCase() === tab.label.toLowerCase()\n      },\n    }\n  })\n  .run($templateCache => {\n    $templateCache.put('pageHeader.desktop.html', require('./pageHeader.desktop.html'))\n    $templateCache.put('pageHeader.mobile.html', require('./pageHeader.mobile.html'))\n    $templateCache.put(\n      'pageHeader.search.desktop.html',\n      require('./pageHeader.search.desktop.html')\n    )\n    $templateCache.put('pageHeader.search.mobile.html', require('./pageHeader.search.mobile.html'))\n  })\n","import angular from 'angular'\nimport PageHeader from './pageHeaderDirective.js'\n\nexport default angular.module('app.shared.pageHeader', [PageHeader.name])\n","/*\n * For a list of payment providers and their compatibility with the new checkout redesign, please see:\n * https://instacart.atlassian.net/wiki/spaces/ENG/pages/995098979/Payment+Providers+and+new+checkout+styling\n *\n * For each payment provider service, you'll want to set the css class it should use with the new checkout (paymentForm.styl):\n *    paymentGatewayProvider.registerGateway({\n *      name: ...\n *      ...\n *      ...\n *      newCheckoutCssClass: 'provider-generic_styling'   // This is useful for most, but use a custom style if need be!\n *    });\n */\nimport angular from 'angular'\n\nimport { CART_TYPES } from '@app/angular/constants/cart'\nimport {\n  CHECKOUT_STEP_IDS,\n  FULFILLMENT_TYPES,\n  RESET_CHECKOUT_STEPS,\n} from '@app/angular/constants/checkout'\nimport { PAYMENT_TYPES, PAYMENT_CONTEXTS } from '@app/angular/constants/payments'\nimport { USER_PAYMENT_ACTION } from '@app/angular/services/modules/analytics/analyticsConstants'\n\nimport template from './paymentForm.html'\n\nconst PAYMENT_FORM_ID = 'payment'\nconst EVENT_TRIGGER_DELAY = 250\nconst NOTHING_TO_SHOW_GATEWAY = true\nconst BRAIN_TREE_NAME = 'Braintree'\nconst CREDIT_CARD_TYPE = 'auth_capture'\n\nclass PaymentForm {\n  constructor(\n    $scope,\n    $element,\n    $timeout,\n    $uibModal,\n    auth,\n    cartService,\n    checkoutService,\n    config,\n    checkoutAnalytics,\n    giftCardModalService,\n    lang,\n    mobileService,\n    paymentGateway,\n    reservationService,\n    utilService\n  ) {\n    const { payment_types } = auth.user.store\n    const { loadStaticImage } = utilService\n\n    Object.assign(this, {\n      $uibModal,\n      config,\n      hasErrors: false,\n      hasBeenEdited: false,\n      lang,\n      loadStaticImage,\n      NOTHING_TO_SHOW_GATEWAY,\n      payment_types,\n      isBillingAddressSameAsDelivery: true,\n      gatewayInformation: {},\n    })\n\n    this.services = {\n      $scope,\n      $element,\n      $timeout,\n      auth,\n      cartService,\n      checkout: checkoutService,\n      checkoutAnalytics,\n      giftCardModalService,\n      mobile: mobileService,\n      paymentGateway,\n      reservationService,\n    }\n\n    // Assigning to `$scope` allows the payment providers to access required resources\n    Object.assign($scope, {\n      lang,\n      payment: null,\n      paymentContext: PAYMENT_CONTEXTS.CHECKOUT,\n      checkoutNewCreditCard: success => {\n        $timeout(() => {\n          const { payment } = this\n\n          checkoutAnalytics.addPaymentOption({\n            payment,\n            success,\n            user_action: USER_PAYMENT_ACTION.PAYMENT_CHANGE,\n          })\n        }, EVENT_TRIGGER_DELAY)\n      },\n      onShowCardForm: () => checkoutAnalytics.addCreditCardOpen(),\n      doSave: () => this.doSave(),\n      toggleIsShowingAddCard: isNewCard => (this.isNewCard = isNewCard),\n    })\n  }\n\n  /**\n   * Validates current paymentType\n   * @param {string} paymentType\n   *\n   * @returns {boolean}\n   */\n  isSelectedPaymentValid(paymentType) {\n    if (!paymentType) return false\n\n    switch (paymentType) {\n      case PAYMENT_TYPES.HOUSE_ACCOUNT:\n        return this._isHouseAccountValid(this.payment?.house_account?.id)\n      default:\n        return true\n    }\n  }\n\n  /**\n   * Validates a given house account object\n   *\n   * @param {object} houseAccountNumber - Object that contains an *id* key\n   * @returns {boolean}\n   */\n  _isHouseAccountValid(houseAccountNumber) {\n    const houseAccountLength = houseAccountNumber?.length || 0\n    const { maxHouseAccountLength, shouldValidateHouseAccount } = this.config\n\n    if (!shouldValidateHouseAccount) {\n      return houseAccountLength !== 0\n    }\n\n    return houseAccountLength === maxHouseAccountLength\n  }\n\n  /**\n   * Initialise tasks required for payment after constructor\n   * @returns { undefined }\n   */\n  $onInit() {\n    const { $scope, reservationService } = this.services\n\n    // Respond to payment object changes and reservation (timeslot) changes\n    const watchPaymentGroup = [() => this.payment, () => reservationService.reservation]\n\n    $scope.$watchGroup(watchPaymentGroup, () => {\n      this._updatePaymentOptions()\n      this._hasErrors()\n    })\n\n    // If error, show an error message\n    $scope.$watch(\n      () => $scope.error,\n      () => {\n        const message = $scope.error\n        if (message) {\n          this.onError({ error: { message } })\n        }\n      }\n    )\n\n    // Indicate if this section has ever been expanded for editing\n    $scope.$watch(\n      () => this.editMode,\n      () => {\n        this.hasBeenEdited = this.hasBeenEdited || this.editMode\n        $scope.lastEditMode = this.editMode\n\n        // Abort edit if this section is set to read only on modify mode\n        if (this.isModifyAndPaymentReadOnly()) {\n          this.abortEdit()\n        }\n      }\n    )\n\n    // When all the sections collapse, show if there are errors\n    $scope.$on(RESET_CHECKOUT_STEPS, () => this._hasErrors())\n  }\n\n  /**\n   * Returns the current fullfilment type\n   * @returns { string }\n   */\n  get fulfillmentType() {\n    return this.services.auth.getContext().intent\n  }\n\n  /**\n   * Returns whether or not payment type has auth capture (used for auth notice)\n   * @returns { string }\n   */\n  get doesPaymentTypeHaveAuth() {\n    return this.payment?.payment_type === PAYMENT_TYPES.AUTH_CAPTURE\n  }\n\n  /**\n   * Returns the current payment type\n   * @returns { string }\n   */\n  get currentPaymentType() {\n    const { lang, payment } = this\n    return this.getPaymentTypeString(payment?.payment_type) || lang.values.pleaseSelectPaymentMethod\n  }\n\n  isSingleOption() {\n    const {\n      payment_types,\n      fulfillmentType,\n      services: { paymentGateway },\n    } = this\n    const paymentMethods = payment_types && payment_types[fulfillmentType]\n\n    if (paymentMethods && paymentMethods.length === 1) {\n      const gatewayInformation = paymentGateway.get(paymentMethods[0])\n      return gatewayInformation.noSettingsRequired\n    }\n\n    return false\n  }\n\n  isModifyAndPaymentReadOnly() {\n    const {\n      config,\n      services: { cartService },\n    } = this\n\n    return cartService.cart.order && config.modifyOrder.readOnlyPayment\n  }\n\n  /**\n   * Returns a human readable form of the payment type passed in\n   * @param   paymentType <string>      The payment type (credit, debit, etc)\n   * @returns { string }\n   */\n  getPaymentTypeString(paymentType) {\n    const { fulfillmentType, lang } = this\n    const paymentTypeStrings = paymentType && lang.values.paymentTypes[paymentType]\n    return paymentTypeStrings ? paymentTypeStrings[fulfillmentType] : null\n  }\n\n  /**\n   * Changes the section to edit mode by calling the edit prop function\n   *\n   * @returns { undefined }\n   */\n  enterEditMode() {\n    this.hasErrors = false\n    this.edit({ step: PAYMENT_FORM_ID })\n    this.services.checkoutAnalytics.viewPaymentOptions({ payment: {} })\n\n    // if editing credit-card-list\n    // focus on the radial button with the selected credit card\n    this.services.$timeout(() => {\n      // eslint-disable-next-line no-unused-expressions\n      this.services.$element[0]?.querySelector('.credit-card-list-selected-card')?.focus()\n    })\n  }\n\n  /**\n   * Updates the payment type, setting the payment gateway to the required provider\n   * @param   { string } newPayType            Optional: The new payment type (credit, debit, etc)\n   * @param   { boolean }  logAnalytics:     Optional: True if logging the edit_payment event\n   * @returns { undefined }\n   */\n  updatePaymentType(newPayType = null, logAnalytics = false) {\n    const { payment, editMode, fulfillmentType, payment_types } = this\n    const { $scope, checkoutAnalytics, paymentGateway } = this.services\n    let paymentTypeValid\n    let selectedGateway\n    let gatewayInformation\n    let paymentCssClassName\n\n    $scope.toggleIsShowingAddCard(false)\n\n    if (payment && (newPayType || newPayType === '')) {\n      payment.payment_type = newPayType\n    }\n\n    // If there's only one payment option and it's not selected - then select it!\n    if (payment && !payment.payment_type) {\n      const paymentIntentTypes = this.getPaymentIntentTypes()\n      payment.payment_type = paymentIntentTypes.length === 1 ? paymentIntentTypes[0] : null\n    }\n\n    const { payment_type } = payment || {}\n    if (payment_type) {\n      if (logAnalytics) {\n        checkoutAnalytics.editPaymentOptions({\n          payment,\n          paymentLabel: this.getPaymentTypeString(payment_type),\n          success: true,\n          user_action: USER_PAYMENT_ACTION.PAYMENT_CHANGE,\n        })\n      }\n      const gatewayService = paymentGateway.getService(payment_type)\n      const gatewayContent = paymentGateway.getTemplate(payment_type)\n      selectedGateway = gatewayContent || NOTHING_TO_SHOW_GATEWAY\n      gatewayInformation = paymentGateway.get(payment_type)\n      this.gatewayInformation = gatewayInformation\n      paymentTypeValid = gatewayService.status // gatewayService.status is an object -> {ready: T/F} so that we can get that inheritance magic\n      paymentCssClassName = gatewayInformation.newCheckoutCssClass\n\n      const paymentMethods = payment_types && payment_types[fulfillmentType]\n      if (\n        gatewayInformation.noSettingsRequired &&\n        editMode &&\n        paymentMethods &&\n        paymentMethods.length === 1\n      ) {\n        this.doSave()\n      }\n    }\n\n    Object.assign(this, {\n      paymentTypeValid,\n      paymentCssClassName,\n      selectedGateway,\n      gatewayInformation,\n    })\n  }\n\n  getPaymentIntentTypes() {\n    const { payment_types } = this\n    const { auth, mobile } = this.services\n    const isCatering = this.services.cartService.getCurrentCartType() === CART_TYPES.CATERING\n    const intent = !isCatering ? auth.intent.toString() : FULFILLMENT_TYPES.CATERING\n    const paymentIntentTypes = payment_types[intent]\n\n    if (!paymentIntentTypes?.length) {\n      return isCatering ? [PAYMENT_TYPES.CASH] : []\n    }\n    if (mobile.isMobileApp() || window.inAppBrowser) {\n      return paymentIntentTypes.filter(p => p !== 'paypal')\n    }\n    return paymentIntentTypes\n  }\n\n  /**\n   * Opens the gift card modal\n   *\n   * @returns { undefined }\n   */\n  showAddGiftCard() {\n    const { payment } = this\n    const { giftCardModalService } = this.services\n    giftCardModalService.open({ payment })\n  }\n\n  /**\n   * Removes a gift card by index and saves the change to the server\n   *\n   * @returns { undefined }\n   */\n  removeGiftCard(index) {\n    const { payment } = this\n    if (payment.gift_cards) {\n      payment.gift_cards.splice(index, 1)\n      payment.put()\n    }\n  }\n\n  /**\n   * Updates the user billing information\n   *\n   * @returns {Promise}\n   */\n  updateBillingInformation() {\n    const { auth } = this.services\n    const { billing_address } = auth.user\n    return auth.updateProfile({ billing_address })\n  }\n\n  /**\n   * Triggered by the save button\n   * Validates that payment is ready to save and triggers the save method if so\n   *\n   * @returns { undefined }\n   */\n  doSave() {\n    const { payment, paymentTypeValid } = this\n    const { $timeout, auth, checkout } = this.services\n    const { ready: isValid } = paymentTypeValid || {}\n\n    if (!this.isSelectedPaymentValid(payment?.payment_type)) {\n      return\n    }\n\n    if (this.suppressInitialAutoClose) {\n      $timeout(() => (this.suppressInitialAutoClose = false), 500)\n      return\n    }\n\n    if (this.config.enableBillingInformation && payment?.payment_type === CREDIT_CARD_TYPE) {\n      if (!checkout.isBillingAddressValid(auth.user?.billing_address)) {\n        this.hasErrors = this.editMode\n        return\n      }\n\n      this.updateBillingInformation().then(() => this.onSave({ isValid }))\n    } else {\n      const { hasBeenEdited } = this\n      this.onSave({ isValid, hasBeenEdited })\n    }\n  }\n\n  /**\n   * Returns is we should show the save button outside the payment provider component.\n   * In the future, all payment providers should implement a customizable select/save button\n   * that executes a given callback fn when clicked. Right now, only Stripe is configured\n   * to be used like this.\n   *\n   * @returns { boolean }\n   */\n  shouldShowSaveButton() {\n    if (this.gatewayInformation && this.gatewayInformation.hideSaveButton) {\n      return false\n    }\n\n    return this.editMode\n  }\n\n  /**\n   * Returns if we should show the gift cards outside the payment provider.\n   * In the future, gift cards should be part of every payment provider. Right now, only\n   * Stripe is configured to use gift cards internally\n   *\n   * @returns { boolean}\n   */\n  shouldShowGiftCardsLink() {\n    if (this.gatewayInformation && this.gatewayInformation.hideGiftCardLink) {\n      return false\n    }\n\n    return this.config.showGiftCards && this.editMode && !this.isNewCard\n  }\n\n  shouldShowPaymentWarning() {\n    return Boolean(this.lang.values?.paymentWarning && this.lang.values?.paymentWarning !== '')\n  }\n\n  /**\n   * [Private] Updates the payment options presented in the UI and invalidates the current method if need be\n   */\n  _updatePaymentOptions() {\n    const { fulfillmentType, payment } = this\n    const { $scope, auth } = this.services\n    const { payment_types } = auth.user?.store || {}\n\n    const paymentOptions = payment_types[fulfillmentType]\n    const isValidPaymentType = paymentOptions?.includes(payment?.payment_type)\n\n    $scope.payment = payment // This allows the payment providers to access payment\n    this.payment_types = payment_types\n    this.updatePaymentType(!isValidPaymentType ? '' : null)\n  }\n\n  /**\n   * [Private] Checks for errors and sets \"hasErrors\" accordingly\n   */\n  _hasErrors() {\n    const { $timeout, checkout } = this.services\n\n    // Delay to allow time for the step to edit\n    $timeout(() => {\n      const {\n        editMode,\n        fulfillmentType,\n        gatewayInformation: { name: gatewayName } = {},\n        hasBeenEdited,\n        isNewCard,\n        payment: { payment_type } = {},\n        paymentTypeValid: { loaded, ready } = {},\n        stepNames,\n      } = this\n\n      const isSelectedPaymentValid = this.isSelectedPaymentValid(payment_type)\n      const isBrainTree = gatewayName === BRAIN_TREE_NAME\n      const isInitialized = payment_type && fulfillmentType\n\n      const invalidStatuses = stepNames\n        .filter(step => step !== CHECKOUT_STEP_IDS.PAYMENT)\n        .map(step => checkout.stepsStatuses[step])\n        .filter(status => status && status.valid === false)\n\n      const isAllOtherSectionsValid = invalidStatuses.length === 0\n\n      this.hasErrors =\n        loaded && // Payment provider has loaded\n        !editMode && // Payment section is in read only mode\n        isAllOtherSectionsValid && // All other sections are valid (otherwise payment section is N/A, not error)\n        hasBeenEdited && // The payment section has been opened at least once\n        isInitialized && // A payment type has been selected as well as a valid delivery mode\n        // Not ready (Brain tree excluded), or is a new card, or selected payment type invalid\n        ((!ready && !isBrainTree) || !!isNewCard || !isSelectedPaymentValid)\n    })\n  }\n}\n\nexport default angular.module('PaymentFormModule', []).component('paymentForm', {\n  bindings: {\n    editMode: '<',\n    payment: '<',\n    onError: '&',\n    onSave: '&',\n    edit: '&',\n    abortEdit: '&',\n    hideChevron: '<',\n    stepNames: '<',\n    showDeferredPaymentNotice: '<',\n    suppressInitialAutoClose: '<',\n  },\n  template,\n  controller: PaymentForm,\n})\n","import angular from 'angular'\nimport PaymentForm from './paymentForm'\n\nexport default angular.module('app.shared.paymentForm', [PaymentForm.name])\n","import angular from 'angular'\n\nexport default angular\n  .module('PhoneInputComponentModule', [])\n  .directive('phoneInput', function ($filter) {\n    function link(scope) {\n      scope.inputValue = scope.phoneInputModel\n      scope.$watch('inputValue', function (value) {\n        const sanitizedValue = String(value).replace(/[^0-9]+/g, '')\n        scope.phoneInputModel = sanitizedValue\n        scope.inputValue = $filter('phoneNumber')(sanitizedValue)\n      })\n    }\n\n    return {\n      link,\n      restrict: 'E',\n      scope: {\n        phoneInputLabel: '@label',\n        phoneInputId: '@componentId',\n        phoneInputErrorId: '@errorId',\n        phoneInputModel: '=model',\n      },\n      template: `\n      <input\n        id=\"{{::phoneInputId}}\"\n        class=\"input\"\n        type=\"tel\"\n        name=\"phoneNumber\"\n        aria-label=\"{{::phoneInputLabel}}\"\n        aria-describedby=\"{{::phoneInputErrorId}}\"\n        placeholder=\"{{::phoneInputLabel}}\"\n        ng-model=\"inputValue\"\n        ng-model-options=\"{allowInvalid: true}\"\n        required\n        update-on-enter\n        validate-phone\n      />\n      <span class=\"validation-icon\" aria-hidden=\"true\"></span>\n    `,\n    }\n  })\n  .directive('validatePhone', function () {\n    const PHONE_REGEXP = /^\\(\\d{3}\\)\\s?\\d{3}-\\d{4}$/\n    return {\n      require: 'ngModel',\n      link(scope, elem, attrs, ctrl) {\n        ctrl.$validators.phone = function (modelValue) {\n          return modelValue === '' || PHONE_REGEXP.test(modelValue)\n        }\n      },\n    }\n  })\n  .filter('phoneNumber', function () {\n    // Format phone number specific to North American use case\n    return function (phoneNumber = '') {\n      let formattedPhoneNumber = ''\n\n      if (phoneNumber) {\n        phoneNumber\n          .slice(0, 10)\n          .split('')\n          .forEach((digit, index) => {\n            if (index === 0) {\n              formattedPhoneNumber += '('\n            } else if (index === 3) {\n              formattedPhoneNumber += ') '\n            } else if (index === 6) {\n              formattedPhoneNumber += '-'\n            }\n\n            formattedPhoneNumber += digit\n          })\n      }\n\n      return formattedPhoneNumber\n    }\n  })\n","import angular from 'angular'\nimport PhoneInput from './phoneInput.js'\n\nexport default angular.module('app.component.phoneInputModule', [PhoneInput.name])\n","import angular from 'angular'\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\n\nimport template from './pickupForm.html'\n\nconst PICKUP_FORM_ID = 'pickup'\n\nclass PickupForm {\n  constructor(\n    $q,\n    $scope,\n    $timeout,\n    api,\n    auth,\n    checkoutAnalytics,\n    config,\n    lang,\n    shoppingSelectorService,\n    storesService,\n    utilService\n  ) {\n    const {\n      intent,\n      user: { store },\n    } = auth\n\n    Object.assign(this, {\n      $q,\n      $scope,\n      $timeout,\n      api,\n      auth,\n      checkoutAnalytics,\n      config,\n      intent,\n      lang,\n      searchTerm: '',\n      shoppingSelectorService,\n      storesService,\n      utilService,\n    })\n\n    this.selectedStore = store\n  }\n\n  $onInit() {\n    const { $scope } = this\n\n    this.getInitialLocation().then(location => this.setCurrentLocation(location))\n    this.filteredStores = this.stores\n    // Executes whenever the *stores* prop changes\n    $scope.$watch(\n      () => this.stores,\n      () => this._handleStoresChange()\n    )\n\n    $scope.$watch(\n      () => this.editMode,\n      () => {\n        if (this.editMode) {\n          this.enterEditMode()\n        }\n      }\n    )\n  }\n\n  /**\n   * Sets the current location to the first store in the list\n   * in case there's no selected store\n   *\n   * @returns { undefined }\n   */\n  _handleStoresChange() {\n    if (!this.selectedStore && this.stores.length > 0) {\n      this.currentLocation = {\n        ...this.stores[0].location,\n      }\n    }\n    this.filteredStores = this.stores\n  }\n\n  /**\n   * Returns promise that resolve in the initial map location based on the user store\n   * or the user geolocation\n   *\n   * @returns { Promise }\n   */\n  getInitialLocation() {\n    const deferred = this.$q.defer()\n\n    if (this.selectedStore) {\n      deferred.resolve(this.selectedStore.location)\n    } else if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition(position => {\n        const { latitude, longitude } = position.coords\n\n        deferred.resolve({ latitude, longitude })\n      })\n    }\n\n    return deferred.promise\n  }\n\n  /**\n   * Sets the current location\n   *\n   * @param { object } location\n   */\n  setCurrentLocation(location) {\n    this.currentLocation = location\n  }\n\n  /**\n   * Searches for an address and sets the current location\n   *\n   * @returns { undefined }\n   */\n  searchAddress() {\n    this.api\n      .getGeocodeAddress(this.searchTerm)\n      .then(response => this.handleAddressSearchSuccess(response))\n      .then(response => this.filterList(response))\n      .finally(() => (this.searchTerm = ''))\n  }\n\n  filterList(location) {\n    if (!location) return\n\n    const { stores, matchedStore } = this.storesService.filterStores({\n      location,\n      allStores: this.stores,\n      searchTerm: this.searchTerm,\n      intent: SHOPPING_MODES.PICKUP,\n      storeID: this.auth.getContext().storeNumber,\n    })\n\n    this.filteredStores = stores\n    this.currentLocation = {\n      latitude: matchedStore.location.latitude,\n      longitude: matchedStore.location.longitude,\n    }\n    this.scrollToStore(matchedStore)\n  }\n\n  /**\n   * Handles the getGeocodeAddress success response\n   *\n   * @param { object } response\n   */\n  handleAddressSearchSuccess(response) {\n    const { features } = response.data\n\n    if (features && features.length > 0) {\n      const [longitude, latitude] = features[0].center\n\n      this.currentLocation = {\n        latitude,\n        longitude,\n      }\n    }\n\n    return this.currentLocation\n  }\n\n  /**\n   * Changes the section to edit mode by calling the\n   * edit prop function\n   *\n   * @returns { undefined }\n   */\n  enterEditMode() {\n    this.edit({ step: PICKUP_FORM_ID })\n\n    this.selectedStore = this.auth.user.store\n    if (this.selectedStore) {\n      this.$timeout(() => this.scrollToStore(this.selectedStore))\n    }\n\n    this.checkoutAnalytics.viewFulfillmentOptions()\n  }\n\n  /**\n   * Sets the store selected by the user\n   *\n   * @param { object } store\n   * @returns { undefined }\n   */\n  selectStore(store) {\n    this.$timeout(() => {\n      this.selectedStore = store\n      this.currentLocation = store.location\n    })\n  }\n\n  /**\n   * Handles the store selection through the map\n   *\n   * @param { object } store\n   * @returns { undefined }\n   */\n  handleMapStoreSelect(store) {\n    this.selectStore(store)\n    this.scrollToStore(store)\n  }\n\n  /**\n   * Scrolls the list to a given store\n   *\n   * @param { object } store\n   * @returns { undefined }\n   */\n  scrollToStore(store) {\n    this.$timeout(() => {\n      const storeEl = document.querySelector(`#unata-store-list-item-${store.id}`)\n      const parentEl = document.querySelector('.unata-store-list')\n      const height = storeEl.offsetTop\n\n      parentEl.scrollTo(0, height)\n    })\n  }\n\n  /**\n   * Updates the user current store\n   * and calls the prop method *onStoreApplied*\n   * so the parent can handle it\n   *\n   * @param { object } store\n   * @returns { Promise }\n   */\n  applyStore(store) {\n    const { user } = this.auth\n    const hasChanged = user.store.id !== store.id || !this.auth.user.has_changed_store\n\n    this.onStoreApplied({ hasChanged, store })\n  }\n}\n\nexport default angular.module('PickupFormModule', []).component('pickupForm', {\n  bindings: {\n    edit: '&',\n    editMode: '<',\n    onEditModeChange: '&',\n    onStoreApplied: '&',\n    title: '@',\n    stores: '<',\n    hideChevron: '<',\n    userStore: '<',\n  },\n  template,\n  controller: PickupForm,\n})\n","import angular from 'angular'\nimport PickupForm from './pickupForm'\n\nexport default angular.module('app.shared.pickupForm', [PickupForm.name])\n","import angular from 'angular'\nimport template from './preferredPhoneNumberSelect.html'\n\nexport default angular\n  .module('PreferredPhoneNumberSelectComponentModule', [])\n  .directive('preferredPhoneNumberSelect', function () {\n    return {\n      scope: {\n        preferredPhoneNumber: '=',\n        inputIdAttr: '@?',\n        disabled: '@?',\n      },\n      replace: true,\n      template,\n      controller($scope, config, lang) {\n        $scope.config = config\n        $scope.lang = lang\n        $scope.phoneNumberFields = config.deliveryAddressPhoneNumberFields\n\n        $scope.labels = {}\n        config.deliveryAddressPhoneNumberFields.forEach(field => {\n          $scope.labels[field.key] = field.label\n        })\n      },\n    }\n  })\n","import angular from 'angular'\nimport PreferredPhoneNumberSelect from './preferredPhoneNumberSelect.js'\n\nexport default angular.module('app.shared.preferredPhoneNumberSelect', [\n  PreferredPhoneNumberSelect.name,\n])\n","// A directive to prevent all touchmove events on the specified element.\n// Mostly to account for modals on mobile.\n\nimport angular from 'angular'\n\nexport default angular\n  .module('PreventAllScrollingModule', [])\n  .directive('preventAllScrolling', $timeout => {\n    return {\n      link(scope, el) {\n        $timeout(() => {\n          el[0].addEventListener(\n            'touchmove',\n            event => {\n              event.preventDefault()\n            },\n            false\n          )\n        }, 0)\n      },\n    }\n  })\n","import angular from 'angular'\nimport PreventAllScrolling from './preventAllScrolling.js'\n\nexport default angular.module('app.shared.preventAllScrolling', [PreventAllScrolling.name])\n","import angular from 'angular'\nimport template from './priceAlertButton.html'\n\nexport default angular\n  .module('PriceAlertButtonComponentModule', [])\n  .directive('priceAlert', function () {\n    return {\n      scope: {\n        product: '=',\n        small: '=',\n        source: '@',\n      },\n      template,\n      controller($rootScope, $scope, analytics, auth, config, lang, priceAlertsService) {\n        $scope.auth = auth\n        $scope.config = config\n        $scope.lang = lang\n\n        $scope.togglePriceAlert = () => {\n          analytics.logSegmentEvent('store.price_alert', {\n            product_details: $scope.product,\n            add_price_alert: !$scope.product.price_alert,\n            remove_price_alert: !!$scope.product.price_alert,\n            price_alert_source: $scope.source,\n          })\n          return priceAlertsService.togglePriceAlert($scope.product)\n        }\n      },\n    }\n  })\n","import angular from 'angular'\nimport PriceAlertButton from './priceAlertButton.js'\n\nexport default angular.module('app.shared.priceAlertButton', [PriceAlertButton.name])\n","import angular from 'angular'\nimport template from './cellOverlay.html'\n\nexport default angular\n  .module('CellOverlayComponentModule', [])\n  .directive('cellOverlay', function () {\n    return {\n      scope: {\n        showIf: '=',\n      },\n      replace: true,\n      transclude: true,\n      template,\n      controller($scope, $element) {\n        $scope.close = function () {\n          $scope.showIf = null\n        }\n\n        // Add a class to the parent scope's element if the overlay is open\n        // This is used to hide the promo tag\n\n        $scope.$watch('showIf', (newVal, oldVal) => {\n          if (newVal !== oldVal) {\n            $element.parent().toggleClass('overlay-open', !!$scope.showIf)\n          }\n        })\n      },\n    }\n  })\n","import angular from 'angular'\n\n// Angular Product Cell\nimport { isReactDemo } from '@app/utils/isReactDemo'\nimport ngTemplate from './productCell.ng.html'\nimport ngTemplate01 from './productCell.variant-01.html'\nimport reactTemplate from './productCell.react.html'\n\nexport default angular\n  .module('ProductCellComponentModule', [])\n  .directive('productCell', function (config) {\n    const angularTemplate = config.enableInstacartProductCell ? ngTemplate01 : ngTemplate\n    const template =\n      config.react.enableNewItemTile || isReactDemo() ? reactTemplate : angularTemplate\n\n    return {\n      scope: {\n        product: '=',\n        promotedMedia: '=',\n        location: '@',\n        locationValue: '<',\n        index: '<',\n        recommended: '@',\n        productDetailsModalLink: '=',\n        promotedProduct: '<',\n        isExternalRoutesDisabled: '<',\n      },\n      replace: true,\n      template,\n      controller: 'ProductCellNgController',\n    }\n  })\n","import _ from 'lodash'\nimport angular from 'angular'\n\nimport { product as ProductService } from '@instacart/enterprise-services'\nimport { PRODUCT_CELL_OFFER_TYPES } from '@app/angular/constants/offers'\nimport tokens from '@app/angular/services/modules/tokens'\nimport {\n  adjustDollarsToCents,\n  concatProductTitle,\n  getProductOfferPoints,\n  getUnclippedCoupons,\n  getProductCellBadgeClassName,\n  getProductPriceLabel,\n  getOverlayTriggerChance,\n  getEnterpriseSaleEndDate,\n} from '@app/utils/productHelpers'\n\nexport default angular.module('ProductCellNgControllerModule', []).controller(\n  'ProductCellNgController',\n  // eslint-disable-next-line complexity\n  function (\n    $document,\n    $element,\n    $filter,\n    $rootScope,\n    $scope,\n    $state,\n    $timeout,\n    Restangular,\n    analytics,\n    auth,\n    cartService,\n    config,\n    configurableProductService,\n    eComLightService,\n    facetedSearchService,\n    imageURLService,\n    lang,\n    mobileService,\n    offersService,\n    productDetailsModal,\n    productsService,\n    tagsService,\n    userService\n  ) {\n    let customBadge = null\n    const product = $scope.product || {}\n    const productConfig = product.product_config || {}\n\n    // adjust sale and loyalty end date for IC catalog items due to logic\n    // between IC and Unata\n    product.sale_end_date = getEnterpriseSaleEndDate(product.sale_end_date, config)\n    product.loyalty_end_date = getEnterpriseSaleEndDate(product.loyalty_end_date, config)\n\n    $scope.isProductAvailable = ProductService.utils.isProductAvailable($scope.product)\n\n    // Services\n    $scope.imageURLService = imageURLService\n    $scope.tagsService = tagsService\n    $scope.mobile = mobileService\n    $scope.lang = lang\n    $scope.facetedSearchService = facetedSearchService\n\n    // General defaults\n    $scope.overlay = {}\n    $scope.config = config\n    $scope.showAllOptions = false\n    const enableFacets = config.enableFacetedSearchFilters || config.enableICSearch\n\n    // Variant\n    $scope.showQuickAdd = false\n    $scope.isMobileApp = mobileService.isMobileApp()\n\n    // Flags\n    const {\n      enableCustomOfferBadges,\n      enableIntegrationOfferBadges,\n      enableCustomOfferInsideBMSMBadge,\n      enableLoyaltyPricing,\n    } = config\n\n    // Offers\n    const { offers } = product\n    $scope.offerType = null\n    $scope.offerConditionAndReward = {}\n    $scope.OFFER_TYPES = PRODUCT_CELL_OFFER_TYPES\n    $scope.hasOffer = !!offers\n    const hasOneOffer = $scope.hasOffer && offers.length === 1\n\n    // Offer Points\n    $scope.offerPoints = $scope.hasOffer ? getProductOfferPoints(offers) : null\n    $scope.hasOfferPoints = !!$scope.offerPoints\n\n    $scope.showOfferBadge =\n      $scope.hasOffer &&\n      (!$scope.hasOfferPoints || !config.hasLoyaltyPoints) &&\n      config.enableOfferBadge &&\n      config.enableOfferBadgeTypes.includes(product.offers[0].offer_type)\n\n    $scope.offerBadgeAltText = lang.aria.offerBadge || 'Offer inside!'\n\n    // Show a custom badge if one is present in the offer ext_data\n    if (enableIntegrationOfferBadges && product.offers) {\n      // This is RAY specific (and likely always will be) filter out the product offers\n      // with badges from the full set & the product offers that they wish to hide the\n      // badges on from the full set\n      const productOffersWithBadges = product.offers.filter(product => product.badge_type !== null)\n      const hiddenProductOffers = product.offers.filter(product => !product.display_badge)\n\n      if (product?.offers?.length === 1) {\n        // If we only have one offer, hide the badge if they are passing dsiplay_badge=false\n        // otherwise render the badge as passed via API\n        if (!product.offers[0].display_badge) {\n          customBadge = 'hidden'\n        } else if (product.offers[0].badge_type) {\n          customBadge = product.offers[0].badge_type\n          $scope.offerBadgeAltText = `${product.offers[0].badge_type} offer`\n        }\n      } else {\n        // If we have multiple offers, check if all of the offers present are display_badge=False,\n        // if so - hide the badge entirely, if not and there is a single badge on the product render that\n        // badge, otherwise defer the render logic to the getProductCellBadgeClassName helper by passing null\n        // eslint-disable-next-line no-lonely-if\n        if (\n          hiddenProductOffers.length > 0 &&\n          hiddenProductOffers.length === product?.offers?.length\n        ) {\n          customBadge = 'hidden'\n        } else if (productOffersWithBadges.length === 1) {\n          customBadge = productOffersWithBadges[0].badge_type\n          $scope.offerBadgeAltText = `${productOffersWithBadges[0].badge_type} offer`\n        } else {\n          customBadge = null\n        }\n      }\n    }\n\n    // We should show a custom badge if there is not more than one offer on a product & conditions are met\n    if (enableCustomOfferBadges && hasOneOffer) {\n      offersService.getOffer(product.offers[0].id).then(result => {\n        // Checks\n        const isConditionTypeProducts = result.condition.type === 'products'\n        const isRewardTypeProducts = result.reward.type === 'products'\n        const isRewardTypeDiscount = result.reward.type === 'discount'\n\n        // Result values\n        const resultReward = result.reward[result.reward.type]\n        const resultCondition = result.condition[result.condition.type]\n\n        const setOffer = ({ badge, condition, type }) => {\n          if (type) $scope.offerType = type\n          if (badge) customBadge = badge\n          if (condition) $scope.offerConditionAndReward = condition\n        }\n\n        if (enableCustomOfferInsideBMSMBadge && resultCondition.max_quantity !== null) {\n          setOffer({\n            badge: 'custom-offer',\n            type: $scope.OFFER_TYPES.BMSM,\n          })\n        } else if (isConditionTypeProducts && isRewardTypeDiscount) {\n          // Potentially a $ off or % off offer\n          if (resultReward.type === 'amount' && result.source === 'internal') {\n            setOffer({\n              badge: 'custom-offer',\n              condition: {\n                rewardAmount: adjustDollarsToCents(resultReward.value),\n              },\n              type: $scope.OFFER_TYPES.AMOUNT_REWARD,\n            })\n          } else if (resultReward.type === 'percent') {\n            setOffer({\n              badge: 'custom-offer',\n              condition: {\n                rewardAmount: resultReward.value,\n              },\n              type: $scope.OFFER_TYPES.PERCENT_REWARD,\n            })\n          }\n        } else if (isConditionTypeProducts && isRewardTypeProducts) {\n          setOffer({\n            badge: 'custom-offer',\n            condition: {\n              conditionAmount: resultCondition.quantity,\n              rewardAmount: resultReward.quantity,\n            },\n            type: $scope.OFFER_TYPES.BUY_X,\n          })\n        }\n      })\n    }\n\n    const unclippedCoupons = $scope.hasOffer ? getUnclippedCoupons(product.offers) : []\n\n    $scope.hasUnclippedCoupon = unclippedCoupons.length > 0\n\n    $scope.showAisle = !$scope.config.disableAisles && product.aisle\n\n    $scope.hasLoyaltyCard = () => userService.loyaltyCards.length > 0\n\n    $scope.showLoyaltyRibbon = () =>\n      enableLoyaltyPricing && product.promo_tag && product.loyalty_price\n\n    $scope.showSaleRibbon = () => product.promo_tag && !$scope.showLoyaltyRibbon()\n\n    $scope.showOfferPreviewRibbon = () => product.offer_title && product.offer_title.length > 0\n\n    // Grabs copy for sponsered by text from config\n    $scope.sponsoredByText =\n      product.sponsored && product.sponsoredBy\n        ? lang.values.sponsoredBy[product.sponsoredBy]\n        : undefined\n\n    $scope.showFeaturedLabel =\n      $scope.promotedProduct && config.showFeaturedLabel && !$scope.sponsoredByText\n\n    $scope.showSponsoredLabel =\n      product.sponsored &&\n      config.showSponsoredLabel &&\n      !$scope.showFeaturedLabel &&\n      !$scope.sponsoredByText\n\n    // If the API response determines the sponsored label should be hidden, hide it\n    // This property doesn't exist yet, so check if the value is explicitly set to false\n    // Otherwise, use the logic above\n    if (product.sponsoredLabel === false) {\n      $scope.showSponsoredLabel = false\n    }\n\n    $scope.productCellBadge = () =>\n      getProductCellBadgeClassName({\n        customBadge,\n        hasOffer: $scope.hasOffer,\n        hasOfferPoints: $scope.hasOfferPoints,\n        hasLoyaltyPoints: config.hasLoyaltyPoints,\n        enableCustomOfferInsideBadge: config.enableCustomOfferInsideBadge,\n      })\n\n    // \"From\" text is shown when there is a custom configurable product that has pricing associated with it.\n    $scope.priceLabel = getProductPriceLabel(productConfig, lang)\n\n    $scope.priceStyles = { root: { fontSize: tokens.size.font.caption - 1 } }\n\n    // Similar to the `update` function in `addToCartButton.js`, this method fires when there is change to cart\n    // So that we can update the Add To Cart button accordingly to reflect any additions/removals\n    // This has to be executed in `productCell` to support the configurable products popover on addToCartButton\n    const updateForConfigurations = function (cleared) {\n      if (productConfig.options?.length > 0 && productConfig.config_type === 'prep_style') {\n        let selectedConfiguration = []\n\n        $scope.aggregateQuantityCount = 0\n        $scope.existingConfigurationCartItems = []\n        $scope.existingConfigSingular = null\n\n        // No default options available, show all options on Add To Cart popover\n        $scope.showAllOptions = !configurableProductService.findDefault(\n          productConfig.options[0].items\n        )\n\n        // Checks all product's available configs and sees if they exist in cart\n        productConfig.options[0].items.forEach(option => {\n          selectedConfiguration = configurableProductService.formatConfigForCart(product, option)\n\n          // Find configuration in cart and update quantity counts and aggregates in-cart configurations\n          // To pass to addToCartButton popover\n          const item = !cleared && cartService.getItem(product, selectedConfiguration)\n          // TODO - remove lodash (probably rewrite this) when I can find out where this is used.\n          if (item && !_.find($scope.existingConfigurationCartItems, item)) {\n            $scope.aggregateQuantityCount += item.quantity\n            $scope.existingConfigurationCartItems.push(item)\n\n            if ($scope.existingConfigurationCartItems.length === 1) {\n              $scope.aggregateQuantityCount = item.quantity\n              $scope.existingConfigSingular = item\n            } else {\n              $scope.existingConfigSingular = null\n            }\n          }\n        })\n      }\n    }\n\n    /*\n     * COMPONENTS\n     */\n    // Title\n    $scope.productTitle = () => concatProductTitle(product, lang)\n\n    // Price Alerts\n\n    // Catch price alert changes from a modal\n    // TODO: This needs to be refactored, we shouldn't need to $emit to capture scope.\n    $rootScope.$on('priceAlertChange', (event, { productId, priceAlert }) => {\n      if (productId === product.id) {\n        product.price_alert = priceAlert\n      }\n    })\n\n    // Product Details can be a modal or a regular page.\n    $scope.linkToProductDetails = () => {\n      productsService.cellOnClick({\n        location: $scope.location,\n        locationValue: $scope.locationValue,\n        modal: $scope.productDetailsModalLink,\n        onAddToCartBeacon: product.onAddToCartBeacon,\n        product,\n        placement: {\n          promoted: $scope.promotedProduct,\n          source: product.sponsoredBy,\n          isExternalRoutesDisabled: $scope.isExternalRoutesDisabled,\n        },\n      })\n    }\n\n    const overlayTriggerChance = getOverlayTriggerChance(\n      $scope.hasUnclippedCoupon,\n      config.productCellCouponChance,\n      config.productCellRecoChance\n    )\n\n    if (!config.disableProductTileProductReco && !eComLightService.inEComLightMode) {\n      const deregister = $scope.$on('productAdded', (name, addedProduct) => {\n        if (addedProduct.id === product.id && overlayTriggerChance) {\n          if ($scope.hasUnclippedCoupon && $state.current.name !== 'main.offers.details') {\n            offersService.getOfferData(unclippedCoupons[0].id).then(argument => {\n              $scope.overlay.featuredCoupon = argument.offer\n            })\n          } else {\n            Restangular.one('store_products', addedProduct.id)\n              .all('related')\n              .getList({ limit: 1 })\n              .then(response => {\n                $scope.overlay.recoProduct = response.plain()[0]\n              })\n          }\n        }\n        updateForConfigurations()\n      })\n      $scope.$on('$destroy', () => {\n        deregister()\n      })\n    }\n\n    // Watchers to update configurable dropdown\n    if (productConfig.options?.length > 0 && productConfig.config_type === 'prep_style') {\n      const deregisterGroupWatcher = $scope.$watchGroup(\n        ['cartService.lastUpdated', 'product'],\n        updateForConfigurations\n      )\n      const deregisterCartServiceWatcher = $scope.$on('cartService', (event, method, item) => {\n        const cartChange =\n          ['add', 'remove'].includes(method) && product.id === item?.store_product?.id\n        const cartCleared = method === 'clearConfirm'\n        if (cartChange || cartCleared) {\n          updateForConfigurations(cartCleared)\n        }\n      })\n\n      if (cartService.cart) {\n        updateForConfigurations()\n      } else {\n        cartService.fetch().then(updateForConfigurations)\n      }\n\n      $scope.$on('$destroy', () => {\n        deregisterGroupWatcher()\n        deregisterCartServiceWatcher()\n      })\n    }\n\n    $scope.storeImpressionIfFeatured = () => {\n      if (product.placement) analytics.setFeaturedProductImpressionToStore(product.id)\n    }\n\n    $scope.closeQuickAdd = (event, forceClose) => {\n      const el = $element[0]\n\n      // Detect where the element is clicked so that buttons inside don't close the overlay\n      if ((el !== event?.target && !el.contains(event?.target)) || forceClose) {\n        $scope.showQuickAdd = false\n        $document.off('click', $scope.closeQuickAdd)\n\n        // Force refresh\n        $timeout(() => $scope.$apply())\n      }\n    }\n\n    $scope.onQuickAddClick = () => {\n      // Hack to get around binding issue\n      $timeout(() => {\n        $scope.showQuickAdd = true\n        const el = document.getElementById(`add-to-cart-modify-add-button-${$scope.product.id}`)\n\n        if (el) {\n          // Hack to get around waiting for element to be visible\n          // Focus the add to cart button so the user can continue to add to cart\n          $timeout(() => {\n            el.focus()\n          }, 10)\n        }\n\n        $document.on('click', $scope.closeQuickAdd)\n      })\n    }\n\n    $scope.offerBadgeAriaRole = () => (!$scope.offerType ? 'img' : undefined)\n    $scope.offerBadgeAriaLabel = () => (!$scope.offerType ? $scope.offerBadgeAltText : undefined)\n\n    $scope.getTagName = tag => {\n      return enableFacets ? facetedSearchService.getTagName(tag) : tagsService.byVal(tag)?.name\n    }\n\n    productsService.trackViewPort($element, $scope, product)\n  }\n)\n","import angular from 'angular'\n\nimport {\n  // adjustDollarsToCents,\n  concatProductTitle,\n  getConfigProductTags,\n  // getUnclippedCoupons,\n  // getProductCellBadgeClassName,\n  // getProductPriceLabel,\n  // getOverlayTriggerChance,\n} from '@app/utils/productHelpers'\n\nconst offerBadgeSvg = require('static/images/offer.svg')\n/*\n * This controller is used to configure the product cell as we start to move\n * towards the new @instacart/enterprise-product-cell package. As features\n * are migrated, please delete them from this file.\n */\nexport default angular\n  .module('ProductCellReactControllerModule', [])\n  .controller(\n    'ProductCellReactController',\n    function (\n      $element,\n      $filter,\n      $scope,\n      addToCartService,\n      auth,\n      cartService,\n      config,\n      imageURLService,\n      lang,\n      mobileService,\n      productsService,\n      userService\n    ) {\n      const product = $scope.product || {}\n      const cellProps = {}\n      const element = $element[0]\n      const { index } = $scope\n\n      // Use scope to trigger an update when an item has been changed\n      $scope.currentItem = cartService.getItem(product) || {}\n\n      // Flags\n      const { isMobile } = mobileService\n      const isLoggedIn = auth.user.status !== 'trial'\n      // const showAisle = !$scope.config.disableAisles && product.aisle\n\n      /*\n       * Generic product cell options\n       */\n      cellProps.isLoggedIn = isLoggedIn\n      cellProps.noBorder = true\n      cellProps.noShadow = true\n      cellProps.variant = 'default'\n\n      /*\n       * Product\n       */\n      let thumbnailCaption = null\n\n      // Caption - Sponsored By\n      if (product.sponsored && product.sponsoredBy) {\n        thumbnailCaption = lang.values.sponsoredBy[product.sponsoredBy]\n      }\n\n      // Caption - Featured\n      if (!thumbnailCaption && $scope.promotedProduct && config.showFeaturedLabel) {\n        thumbnailCaption = lang.values.featured\n      }\n\n      // Caption - Sponsored\n      if (!thumbnailCaption && product.sponsored && config.showSponsoredLabel) {\n        thumbnailCaption = lang.values.sponsored\n      }\n\n      cellProps.product = {\n        id: product.id,\n        onClick: () => {\n          productsService.cellOnClick({\n            location: $scope.location,\n            locationValue: $scope.locationValue,\n            modal: $scope.productDetailsModalLink,\n            product,\n            placement: { promoted: $scope.promotedProduct, source: product.sponsoredBy },\n          })\n        },\n        thumbnail: imageURLService.getProductImageURL(product, isMobile ? 'medium' : 'small'),\n        title: concatProductTitle(product, lang),\n        thumbnailCaption,\n      }\n\n      /*\n       * Add to cart\n       */\n      cellProps.addToCart = {\n        onAdd: () => {\n          addToCartService.onAdd({\n            element,\n            index,\n            location: $scope.location,\n            locationValue: $scope.locationValue,\n            passToCtrl: {},\n            product,\n            quantity: $scope.currentItem.quantity || 0,\n          })\n        },\n        onRemove: () => {\n          addToCartService.onRemove({\n            element,\n            index,\n            location: $scope.location,\n            locationValue: $scope.locationValue,\n            product,\n            quantity: $scope.currentItem.quantity || 0,\n          })\n        },\n        productCount: $scope.currentItem.quantity || 0,\n      }\n\n      /*\n       * Aisle\n       */\n      cellProps.aisle = {\n        enabled: !!(!config.disableAisles && product.aisle),\n        value: product.aisle?.trim(),\n      }\n\n      /*\n       * offerBadge || offerPointsBadge\n       */\n      cellProps.offerBadge = {\n        enabled: !!product.offers,\n        backgroundSrc: offerBadgeSvg,\n      }\n\n      /*\n       * price\n       */\n      cellProps.price = {\n        enabled: true,\n        loyaltyPricingEnabled: config.enableLoyaltyPricing,\n        hasLoyaltyCard: userService.loyaltyCards.length > 0,\n        showUom: true,\n        product,\n      }\n\n      /*\n       * priceAlert\n       */\n      cellProps.priceAlert = {\n        enabled:\n          !isMobile &&\n          !config.disablePriceAlerts &&\n          !config.disablePriceAlertsOnProductCells &&\n          isLoggedIn,\n        initialSelectedState: !!product.price_alert,\n      }\n\n      /*\n       * rating\n       */\n      cellProps.rating = {\n        enabled: config.userReviews.enabled,\n        value: product.product_rating.average_rating,\n      }\n\n      /*\n       * relatedProduct\n       */\n\n      /*\n       * salesTag\n       */\n      const salesTagEnabled =\n        product.promo_tag &&\n        !!(config.enableLoyaltyPricing && product.promo_tag && product.loyalty_price)\n      cellProps.salesTag = {\n        enabled: salesTagEnabled,\n        ribbonContent: product.promo_tag,\n        direction: 'left',\n        tooltipContent:\n          isMobile || config.showSaleEndDate\n            ? ''\n            : lang.template(\n                lang.values.saleEndDate,\n                $filter('apiDate')(lang.values.saleEndDate, 'MMM D')\n              ),\n      }\n      /*\n       * saveForLaterList\n       */\n      cellProps.saveForLaterList = {\n        onAdd: () => {},\n      }\n\n      /*\n       * tags\n       */\n      const configTags = config.tags\n      const productTags = getConfigProductTags(product.tags, configTags)\n      cellProps.tags = productTags\n\n      /*\n       * unitSize\n       */\n      cellProps.unitSize = {\n        enabled: !!product.size_string,\n        value: product.size_string,\n      }\n\n      // Set the final product props to scope\n      $scope.cellProduct = cellProps\n\n      /*\n       * Configurable product\n       */\n      const update = updatedItem => {\n        $scope.currentItem.quantity = updatedItem.quantity || 0\n\n        // Update the product count\n        cellProps.addToCart = {\n          ...cellProps.addToCart,\n          productCount: $scope.currentItem.quantity,\n        }\n\n        // Set cell product to newly formatted product\n        $scope.cellProduct = cellProps\n      }\n\n      // Deregister functions\n      const deregisterCartServiceWatcher = $scope.$on(\n        'cartService',\n        (event, method, newItem = {}) => {\n          const cartChange =\n            ['add', 'remove'].includes(method) && product.id === newItem?.store_product?.id\n          const cartCleared = method === 'clearConfirm'\n\n          if (cartChange || cartCleared) {\n            update(newItem)\n          }\n        }\n      )\n\n      $scope.$on('$destroy', () => {\n        deregisterCartServiceWatcher()\n      })\n    }\n  )\n","import angular from 'angular'\nimport CellOverlay from './cellOverlay.js'\nimport ProductCell from './productCell.js'\n\n// Controllers\nimport ProductCellNgController from './ProductCellController.ng.js'\nimport ProductCellReactController from './ProductCellController.react.js'\n\nexport default angular.module('app.shared.productCell', [\n  CellOverlay.name,\n  ProductCell.name,\n  ProductCellReactController.name,\n  ProductCellNgController.name,\n])\n","import angular from 'angular'\nimport template from './productComments.html'\n\nexport default angular\n  .module('ProductCommentsComponentModule', [])\n  .directive('productComments', function () {\n    return {\n      scope: {\n        item: '=',\n        productCommentCallback: '&',\n        disableInput: '<?',\n      },\n      template,\n      controller($scope, cartService, config, lang, mobileService, oneCartService, utilService) {\n        Object.assign($scope, {\n          lang,\n          config,\n          cartService,\n          util: utilService,\n          mobile: mobileService,\n        })\n\n        $scope.finishEditing = function () {\n          $scope.$emit('finishedEditingNotes')\n        }\n\n        $scope.disableProductComments = () => {\n          return (\n            $scope.disableInput ||\n            $scope.config.disableInput.item_comments ||\n            $scope.item.product_config\n          )\n        }\n\n        $scope.hideProductComments = () => !!$scope.item.product_config\n      },\n    }\n  })\n","import angular from 'angular'\nimport ProductComments from './productComments.js'\n\nexport default angular.module('app.shared.productComments', [ProductComments.name])\n","import angular from 'angular'\nimport template from './productCommentsV2.html'\n\nexport default angular\n  .module('ProductCommentsV2ComponentModule', [])\n  .directive('productCommentsV2', function () {\n    return {\n      scope: {\n        item: '=',\n        productCommentCallback: '&',\n        productShowComment: '=',\n        disableInput: '<?',\n      },\n      template,\n      controller(\n        $scope,\n        analytics,\n        cartService,\n        config,\n        lang,\n        mobileService,\n        oneCartService,\n        utilService\n      ) {\n        Object.assign($scope, {\n          lang,\n          config,\n          cartService,\n          util: utilService,\n          mobile: mobileService,\n          tempComment: $scope.item.comment || '',\n        })\n\n        $scope.removeNote = () => {\n          $scope.item.comment = ''\n          $scope.productShowComment = false\n          $scope.productCommentCallback($scope.item)\n        }\n\n        $scope.onCancel = () => {\n          $scope.productShowComment = false\n          $scope.tempComment = ''\n        }\n\n        $scope.onSaveNote = note => {\n          $scope.item.comment = note\n          $scope.productCommentCallback($scope.item)\n          $scope.productShowComment = false\n          analytics.logEvent('product save comment update', 'blur')\n        }\n\n        $scope.disableProductComments = () => {\n          return (\n            $scope.disableInput ||\n            $scope.config.disableInput.item_comments ||\n            $scope.item.product_config\n          )\n        }\n\n        $scope.hideProductComments = () => !!$scope.item.product_config\n      },\n    }\n  })\n","import angular from 'angular'\nimport ProductComments from './productCommentsV2.js'\n\nexport default angular.module('app.shared.productCommentsV2', [ProductComments.name])\n","import angular from 'angular'\n\nexport default angular\n  .module('ProductDetailsModalControllerModule', [])\n  .controller(\n    'ProductDetailsModalController',\n    function (\n      $controller,\n      $scope,\n      $state,\n      Restangular,\n      auth,\n      cartService,\n      mobileService,\n      modalOptions,\n      noticeAlert,\n      placement,\n      productId\n    ) {\n      Restangular.one('store_products', productId)\n        .get()\n        .then(product => {\n          $controller('ProductDetailsController', {\n            $scope,\n            productId,\n            product,\n            placement,\n          })\n        })\n        .catch(responseOrException => {\n          if (responseOrException.status === 404) {\n            $state.go('main.404')\n          } else if (responseOrException instanceof Error) {\n            return Promise.reject(responseOrException)\n          } else {\n            console.error('ProductDetailsModalController - unhandled case', responseOrException)\n          }\n        })\n\n      $scope.noticeAlert = noticeAlert\n      $scope.isModal = true\n      $scope.auth = auth\n      $scope.cartService = cartService\n      $scope.mobile = mobileService\n\n      if (modalOptions) {\n        Object.assign($scope, modalOptions)\n      }\n    }\n  )\n  .run($templateCache => {\n    $templateCache.put('productDetails.html', require('../../productDetails/productDetails.html'))\n  })\n","import angular from 'angular'\nimport slugify from 'slugify'\nimport { eventEmitter, EVENT_TYPES } from '@app/utils/eventEmitter'\nimport template from './productDetailsModal.html'\nimport ProductDetailsControllerModule from './productDetailsModalController.js'\n\nexport default angular\n  .module('ProductDetailsModalComponentModule', [ProductDetailsControllerModule.name])\n  .service(\n    'productDetailsModal',\n    function productDetailsModal($state, $uibModal, legacyModalService, uibModalAriaLabelService) {\n      const service = this\n\n      service.open = (productId, modalOptions, placement = {}, noticeAlert = null) => {\n        legacyModalService.closeOpenModals()\n        $uibModal.open({\n          template,\n          controller: 'ProductDetailsModalController',\n          resolve: {\n            ariaLabel: () => {\n              uibModalAriaLabelService.setLabel('Product Details')\n            },\n            productId: () => productId,\n            modalOptions: () => modalOptions,\n            noticeAlert: () => noticeAlert,\n            placement: () => placement,\n          },\n        })\n      }\n\n      eventEmitter.on(\n        EVENT_TYPES.LINK_TO_PRODUCT_DETAIL,\n        (product, openAsModal, location, placement) => {\n          if (openAsModal) {\n            service.open(\n              product.id,\n              { location },\n              {\n                source: product?.sponsoredBy,\n                ...placement,\n              }\n            )\n          } else {\n            $state.go('main.product', {\n              id: product.id,\n              placement,\n              name: slugify(product.name, { lower: true }),\n            })\n          }\n        }\n      )\n\n      eventEmitter.on(EVENT_TYPES.LINK_TO_USERLIST_DETAIL, (product, userList) => {\n        $state.go('list', { list_id: userList.id })\n      })\n    }\n  )\n","import angular from 'angular'\nimport ProductDetails from './productDetailsModalService'\n\nexport default angular.module('app.shared.productDetails', [ProductDetails.name])\n","import _ from 'lodash'\nimport angular from 'angular'\nimport template from './productPoints.html'\n\nexport default angular\n  .module('ProductPointsComponentModule', [])\n  .directive('productPoints', $filter => {\n    return {\n      scope: {\n        product: '=',\n      },\n      template,\n      controller($scope, config, lang) {\n        $scope.config = config\n        $scope.lang = lang\n\n        $scope.hasOfferPoints = _.some($scope.product && $scope.product.offers, offer => {\n          return offer.points !== null\n        })\n\n        // Select the first offer that has points associated with it.\n        if ($scope.hasOfferPoints) {\n          $scope.targetOffer = _.find($scope.product && $scope.product.offers, offer => {\n            return offer.points !== null\n          })\n        }\n\n        $scope.getFormatedDate = function (targetDate) {\n          return targetDate\n            ? lang.template(lang.values.saleEndDate, $filter('apiDate')(targetDate, 'MMM D'))\n            : ''\n        }\n      },\n    }\n  })\n","import angular from 'angular'\nimport ProductPoints from './productPoints.js'\n\nexport default angular.module('app.shared.productPoints', [ProductPoints.name])\n","// If the product is a configurable product that has pricing associated with it (hasConfigurablePricing), in the context of the cart, the\n// side cart, list or pricing list screen we need to pass in the unit-price, and flag use-unit-price-for-configurable-pricing as true. This unit_price reflects any modifications that have been done to the price as a result\n// of configurable product pricing. When hasConfigurablePricing is used and the unit_price is passed in, we will display just the unit_price\n// and neither the base price nor the sales price nor the loyalty price.\nimport { shouldShowUOMSelector } from '@app/services/product/selectors'\nimport angular from 'angular'\nimport template from './productPrices.html'\n\n// This is the angular version of packages/enterprise-ui-product-price/ProductPrices.js\nexport default angular\n  .module('ProductPricesComponentModule', [])\n  .directive('productPrices', function () {\n    return {\n      scope: {\n        product: '<',\n        unitPrice: '<?',\n        showUom: '<?',\n        showEbtLabel: '<?',\n        loyaltyIcon: '<?',\n        nonLoyaltySuffix: '<?',\n        inline: '<?',\n        label: '<?',\n        styles: '<?',\n        salePriceOverride: '<?',\n      },\n      template,\n      controller($scope, config, lang, userService) {\n        $scope.loyaltyPricingEnabled = $scope.product.loyalty_price && config.enableLoyaltyPricing\n        $scope.showUom = shouldShowUOMSelector.resultFunc($scope.product, config)\n        $scope.hasLoyaltyCard = userService.loyaltyCards.length > 0\n\n        $scope.i18n = {\n          loyaltyTooltip: lang.values.loyaltyPricing.priceTooltip,\n          loyaltyBaseSuffix: $scope.nonLoyaltySuffix || lang.values.or,\n        }\n      },\n    }\n  })\n","import angular from 'angular'\nimport ProductPrices from './productPrices.js'\n\nexport default angular.module('app.shared.productPrices', [ProductPrices.name])\n","import _ from 'lodash'\nimport angular from 'angular'\n\nexport default angular\n  .module('ProgressIndicatorComponentModule', [])\n  .component('progressIndicator', {\n    bindings: {\n      segments: '<',\n      currentSegment: '@',\n    },\n    controller(mobileService, lang) {\n      const { checkoutProgress } = lang.values\n      this.isMobile = mobileService.isMobile\n\n      this.currentSegmentIndex = _.findIndex(this.segments, { id: this.currentSegment })\n\n      // Mark which segments are complete, and only allow complete segments to hold on to their sref\n      this.segments = _.map(this.segments, (segment, index) => {\n        if (index < this.currentSegmentIndex) {\n          return {\n            ...segment,\n            complete: true,\n            screenread: checkoutProgress.steps.complete,\n          }\n        }\n        return {\n          ...segment,\n          complete: false,\n          sref: null,\n          screenread:\n            index === this.currentSegmentIndex\n              ? checkoutProgress.steps.inProgress\n              : checkoutProgress.steps.incomplete,\n        }\n      })\n    },\n    template: `\n      <div class=\"progress-indicator\">\n        <div\n          ng-repeat=\"segment in $ctrl.segments\"\n          class=\"segment-container\"\n          ng-class=\"{ complete: segment.complete, current: $ctrl.currentSegmentIndex == $index }\"\n          ng-attr-style=\"width: {{ 100 / $ctrl.segments.length }}%; z-index: {{ $ctrl.segments.length - $index }};\"\n          aria-label=\"{{segment.label}} Segment\"\n          analytics-click=\"['progress bar segment', 'click', $index]\">\n          <a\n            ng-if=\":: !$ctrl.isMobile && segment.sref\"\n            ui-sref=\"{{segment.sref}}\"\n            class=\"segment\"\n            id=\"progress-{{segment.id}}\">\n            <span class=\"screen-reader-text\">{{segment.screenread}}</span>\n            <progress-segment-content label=\"{{:: segment.label}}\" number=\"{{:: ($index + 1)}}\"></progress-segment-content>\n          </a>\n          <span\n            ng-if=\":: $ctrl.isMobile || !segment.sref\"\n            class=\"segment\"\n            id=\"progress-{{segment.id}}\">\n            <span class=\"screen-reader-text\">{{segment.screenread}}</span>\n            <progress-segment-content label=\"{{:: segment.label}}\" number=\"{{:: ($index + 1)}}\"></progress-segment-content>\n          </span>\n        </div>\n      </div>\n    `,\n  })\n  .component('progressSegmentContent', {\n    bindings: {\n      label: '@',\n      number: '@',\n    },\n    template: `\n      <span class=\"number\">{{$ctrl.number}}</span>\n      <span class=\"icon\" aria-hidden=\"true\"></span>\n      <span class=\"label\">{{$ctrl.label}}</span>\n    `,\n  })\n","import angular from 'angular'\nimport ProgressIndicator from './progressIndicator.component'\n\nexport default angular.module('app.shared.progressIndicator', [ProgressIndicator.name])\n","import angular from 'angular'\n\nexport default angular\n  .module('PromoCodeModalControllerModule', [])\n  .controller(\n    'PromoCodeModalController',\n    function (\n      $scope,\n      $timeout,\n      cartService,\n      checkoutAnalytics,\n      lang,\n      mobileService,\n      offerDetailsModalService,\n      offersService,\n      promoCodeOptions,\n      promoCodeValidationService,\n      refocusService\n    ) {\n      $scope.promoCodeOptions = promoCodeOptions\n      $scope.error = null\n      $scope.promoCodeValue = null\n\n      if (promoCodeOptions.onClose) {\n        $scope.$on('modal.closing', () => promoCodeOptions.onClose())\n      }\n\n      const setError = (errMsg, promoForm) => {\n        $scope.error = errMsg\n        promoForm.promoCode.$setValidity('promoCode', errMsg === null)\n      }\n\n      $scope.checkIfValidPromoCode = (promo, promoForm) => {\n        // Reset error message on submit\n        setError(null, promoForm)\n\n        promoCodeValidationService\n          .checkIfValidPromoCode(promo)\n          .then(result => {\n            const promoCode = promo.promo_code\n\n            // If an offer has been unlocked the id will be returned to us\n            if (result.offer_id) {\n              offersService.getOfferData(result.offer_id).then(offer => {\n                promoCodeOptions.onSuccess && promoCodeOptions.onSuccess()\n                promoCodeOptions.setSuccessMessage &&\n                  promoCodeOptions.setSuccessMessage(lang.values.promoCodeSuccessMessage)\n\n                cartService.cart.promo_codes.push(promoCode)\n                checkoutAnalytics.addPromo({ promoCode, offer, success: true })\n\n                $scope.$dismiss()\n\n                if (!$scope.promoCodeOptions.disableOfferModal) {\n                  offerDetailsModalService.open(offer.offer)\n                }\n              })\n            } else if (!result.offer_id && !$scope.promoCodeOptions.isUserLoggedIn) {\n              setError(lang.values.promoCodeError, promoForm) // They may need to log in to unlock this offer\n              if (mobileService.isMobileApp()) {\n                // a11y fix for VoiceOver users to focus input that has errors\n                document.getElementById('promo-code-input').focus()\n              }\n              checkoutAnalytics.addPromo({ promoCode, success: false })\n            }\n          })\n          .catch(err => {\n            setError(err.data?.message || err.message, promoForm)\n            if (mobileService.isMobileApp()) {\n              // a11y fix for VoiceOver users to focus input that has errors\n              document.getElementById('promo-code-input').focus()\n              // eslint-disable-next-line no-unused-expressions\n            } else document.getElementById('promo-code-error-message')?.focus()\n            checkoutAnalytics.addPromo({ promoCode: promo.promo_code, success: false })\n          })\n      }\n\n      // Initialize `modal.closing` trigger to refocus invoking element when this modal closes\n      refocusService.setRefocusTrigger($scope)\n    }\n  )\n","import angular from 'angular'\nimport PromoCodeModal from './promoCodeModalController.js'\n\nexport default angular.module('app.shared.promoCodeModal', [PromoCodeModal.name])\n","import angular from 'angular'\nimport template from './promoCollectionCell.html'\n\nexport default angular\n  .module('PromoCollectionCellComponentModule', [])\n  .directive('promoCollectionCell', $state => {\n    return {\n      scope: {\n        promoCollection: '=',\n        promotedMedia: '=',\n      },\n      replace: true,\n      template,\n      controller($scope, collectionModal, config, lang, mobileService) {\n        $scope.lang = lang\n        $scope.config = config\n        $scope.mobile = mobileService\n        $scope.openCollection = () => {\n          if ($scope.promoCollection.count > config.maxNumberOfCollectionItemsPerModal) {\n            $state.go('main.shop.collection', {\n              collection_id: $scope.promoCollection.collection.id,\n            })\n          } else {\n            collectionModal.open(`collections/${$scope.promoCollection.collection.id}`)\n          }\n        }\n      },\n    }\n  })\n","import angular from 'angular'\nimport PromoCollectionCell from './promoCollectionCell.js'\n\nexport default angular.module('app.shared.promoCollectionCell', [PromoCollectionCell.name])\n","import angular from 'angular'\nimport template from './provinceSelect.html'\n\nexport default angular\n  .module('ProvinceSelectComponentModule', [])\n  .directive('provinceSelect', function (config) {\n    return {\n      restrict: 'AE',\n      scope: {\n        provinceIsRequired: '=',\n        province: '=',\n        inputIdAttr: '@?',\n        disabled: '@?',\n        placeholder: '@?',\n        errorElementId: '@?',\n      },\n      replace: true,\n      template: template,\n      controller: function ($scope, config, lang, values) {\n        $scope.config = config\n        $scope.lang = lang\n        $scope.provinces = values[config.provinceOptions]\n\n        // Set province to default if empty\n        if (!$scope.province) {\n          $scope.province = config.defaultProvince\n        }\n      },\n    }\n  })\n","import angular from 'angular'\nimport ProvinceSelect from './provinceSelect.js'\n\nexport default angular.module('app.shared.provinceSelect', [ProvinceSelect.name])\n","import angular from 'angular'\nimport template from './quickshop.html'\n\nexport default angular.module('QuickshopComponentModule', []).directive('quickshop', function () {\n  return {\n    template,\n    controller($scope, $element, $attrs, tagsService) {\n      $scope.tags = tagsService.quickshopTags\n    },\n  }\n})\n","import angular from 'angular'\nimport Quickshop from './quickshop.js'\n\nexport default angular.module('app.shared.quickshop', [Quickshop.name])\n","import angular from 'angular'\nimport template from './rating.html'\n\nexport default angular\n  .module('RatingComponentModule', [])\n  .directive('ratingDirective', function () {\n    return {\n      scope: {\n        product: '=',\n        onRate: '=',\n      },\n      template,\n      controller($rootScope, $scope, Restangular, config, lang) {\n        $scope.config = config\n        $scope.lang = lang\n        $scope.isDisabled = true\n        $scope.reco_rating = Math.max(1, Math.round($scope.product.reco_rating))\n\n        function ratingUpdatedCallback(res) {\n          $scope.product.user_rating = res.rating\n          if ($scope.onRate) {\n            $scope.onRate(res)\n          }\n        }\n\n        $scope.setRating = function (rating, product) {\n          Restangular.one('storeproduct_ratings')\n            .post(null, {\n              product_id: product.id,\n              rating,\n            })\n            .then(res => {\n              $rootScope.$broadcast('productRatingChange', res, product.id)\n            })\n        }\n\n        // Listen for change ot a product rating and update it so that if you have a product tile open while the product detail modal is open, updating\n        // the rating will cause the UI to update in both contexts.\n\n        $rootScope.$on('productRatingChange', (event, ratingItem, productId) => {\n          if (productId === $scope.product.id) {\n            ratingUpdatedCallback(ratingItem)\n          }\n        })\n\n        $scope.$watch(['product'], (newVal, oldVal) => {\n          if (newVal !== oldVal) {\n            if ($scope.product) {\n              $scope.rating =\n                Math.round(\n                  $scope.product.user_rating\n                    ? $scope.product.user_rating\n                    : $scope.product.reco_rating\n                ) || 0\n            } else {\n              $scope.rating = 0\n            }\n          }\n        })\n      },\n    }\n  })\n","import angular from 'angular'\nimport Rating from './rating.js'\n\nexport default angular.module('app.shared.rating', [Rating.name])\n","import angular from 'angular'\nimport template from './views/recaptchaCheckbox.html'\n\nexport default angular.module('recaptchaModule', []).component('recaptchaCheckbox', {\n  bindings: {\n    action: '<',\n    onExpired: '<?',\n    onError: '<?',\n    onRender: '<?',\n    onSuccess: '<?',\n  },\n  controller($document, $interval, $element, config, recaptchaService) {\n    const vm = this\n    vm.renderIncrement = 0\n    vm.renderInterval = null\n\n    window.onRecaptchaCheckboxSuccess = vm.onSuccess\n    window.onRecaptchaCheckboxExpired = vm.onExpired\n    window.onRecaptchaCheckboxError = vm.onError\n\n    vm.siteKey = config.googleRecaptcha?.siteKey\n\n    if (!vm.siteKey) {\n      console.error('Missing Google reCAPTCHA Site Key!')\n    }\n\n    vm.renderCheckbox = () => {\n      // eslint-disable-next-line no-plusplus\n      vm.renderIncrement++\n      const root = $element.children()[0]\n      // We must remove old nodes/reCAPTCHA mount points\n      // A different DOM element is required for mounting each time\n      root.innerHTML = ''\n\n      // Create checkbox\n      const checkbox = document.createElement('div')\n      const checkboxId = `g-recaptcha-${vm.action}-${vm.renderIncrement}`\n      checkbox.id = checkboxId\n      checkbox.dataset.sitekey = vm.siteKey\n      checkbox.dataset.action = vm.action\n      checkbox.dataset.callback = 'onRecaptchaCheckboxSuccess'\n      checkbox.dataset.expiredCallback = 'onRecaptchaCheckboxExpired'\n      checkbox.dataset.errorCallback = 'onRecaptchaCheckboxError'\n\n      let promise\n      if ($document[0] instanceof ShadowRoot) {\n        const slot = document.createElement('slot')\n        slot.name = 'recaptcha'\n        promise = new Promise(resolve => {\n          slot.addEventListener('slotchange', () => {\n            const [root] = slot.assignedElements()\n            if (!root) {\n              return\n            }\n\n            root.replaceChildren(checkbox)\n            const result = recaptchaService.renderCheckbox(checkbox)\n            resolve(result)\n          })\n        })\n        root.querySelector('slot')?.remove()\n        root.appendChild(slot)\n      } else {\n        root.appendChild(checkbox)\n        promise = recaptchaService.renderCheckbox(checkbox)\n      }\n\n      return promise\n    }\n\n    vm.$onInit = () => {\n      vm.renderCheckbox().then(() => vm.onRender && vm.onRender())\n\n      // Unfortunately, the client signature expires every ~2 min.\n      // Once this happens, we MUST destory the old checkbox, get\n      // a new client signature, and re-create the checkbox with it\n      vm.renderInterval = $interval(() => vm.renderCheckbox(), 110000)\n    }\n\n    vm.$onDestroy = () => {\n      delete window.onRecaptchaCheckboxSuccess\n      delete window.onRecaptchaCheckboxExpired\n      delete window.onRecaptchaCheckboxError\n\n      if (vm.renderInterval) {\n        $interval.cancel(vm.renderInterval)\n      }\n    }\n  },\n  template,\n})\n","import angular from 'angular'\nimport RecaptchaCheckbox from './recaptchaCheckbox.component'\n\nexport default angular.module('app.shared.recaptchaModule', [RecaptchaCheckbox.name])\n","import angular from 'angular'\nimport template from './recipeCell.html'\n\nexport default angular\n  .module('RecipeCellComponentModule', [])\n  .directive('recipeCell', function (imageURLService) {\n    return {\n      bindToController: {\n        recipe: '=',\n        openDetailsInModal: '=?',\n        breadcrumbs: '=?',\n      },\n      controllerAs: 'recipeCell',\n      template,\n      replace: true,\n      controller($filter, $state, mobileService, recipeDetailsModal, savedRecipesService) {\n        const vm = this\n\n        vm.imageURLService = imageURLService\n        vm.mobile = mobileService\n\n        vm.tagLimit = 6\n        vm.recipeTags = vm.recipe.tags && vm.recipe.tags.tags ? vm.recipe.tags.tags : []\n\n        vm.isSaved = () =>\n          savedRecipesService.savedRecipesList.some(savedRecipe => {\n            return vm.recipe.id === savedRecipe.id\n          })\n\n        vm.toggleSaveRecipe = (recipeId, index) => {\n          savedRecipesService\n            .requireLogin()\n            .then(() => {\n              if (!vm.isSaved()) {\n                savedRecipesService.saveRecipe(recipeId, vm.recipe, index)\n              } else {\n                savedRecipesService.removeSavedRecipe(recipeId, vm.recipe, index)\n              }\n            })\n            .catch(() => null)\n        }\n\n        // Recipe Details can be a modal or a regular page\n        vm.linkToRecipeDetails = (recipeId, index) => {\n          if (vm.openDetailsInModal) {\n            recipeDetailsModal.open(recipeId, index)\n          } else {\n            $state.go('main.recipes.details', {\n              index,\n              recipeId,\n              name: $filter('slugify')(vm.recipe.name),\n              // starting from 2nd element since the first element is just a link to the recipes shop view, not a category\n              categoryIds: vm.breadcrumbs\n                ? vm.breadcrumbs.slice(1).map(breadcrumb => breadcrumb.params.recipe_category_id)\n                : null,\n            })\n          }\n        }\n      },\n    }\n  })\n","import angular from 'angular'\nimport RecipeCell from './recipeCell.js'\n\nexport default angular.module('app.shared.recipeCell', [RecipeCell.name])\n","import angular from 'angular'\nimport template from './relatedCoupon.html'\n\nexport default angular.module('RelatedCouponModule', []).directive('relatedCoupon', function () {\n  return {\n    scope: {\n      coupon: '=',\n      location: '@',\n    },\n    replace: true,\n    template,\n  }\n})\n","import angular from 'angular'\nimport RelatedCoupon from './relatedCoupon.js'\n\nexport default angular.module('app.shared.relatedCoupon', [RelatedCoupon.name])\n","import _ from 'lodash'\nimport angular from 'angular'\nimport { product } from '@instacart/enterprise-services'\n\nimport template from './relatedProduct.html'\n\nexport default angular\n  .module('RelatedProductComponentModule', [])\n  .directive('relatedProduct', function () {\n    return {\n      scope: {\n        product: '=',\n        location: '@',\n        index: '<',\n        condensedLayout: '<',\n        horizontalLayout: '<?',\n        isModal: '=?',\n      },\n      replace: true,\n      template,\n      controller(\n        $document,\n        $element,\n        $sce,\n        $scope,\n        $timeout,\n        auth,\n        lang,\n        cartService,\n        config,\n        configurableProductService,\n        eComLightService,\n        imageURLService,\n        mobileService,\n        productDetailsModal,\n        productsService\n      ) {\n        $scope.config = config\n        $scope.imageURLService = imageURLService\n        $scope.isMobileApp = mobileService.isMobileApp()\n        $scope.isMobile = mobileService.isMobile\n        $scope.lang = lang\n        $scope.auth = auth\n        $scope.productDetailsModal = productDetailsModal\n        $scope.showQuickAdd = false\n        $scope.shoppingContext = auth.getContext().intent\n        $scope.horizontalOos = $scope.horizontalLayout && !$scope.isMobile\n\n        // Check if the product is in stock\n        // Not to be confused with product the product availability status\n        // The util checks against the IC catalog product ext_data.availability_score, not the Unata availability_status\n        $scope.isProductInStock = product.utils.isProductAvailable($scope.product)\n\n        // item not available online but might be available in store, still allow add to cart\n        $scope.inStockOrInStore = $scope.isProductInStock || $scope.shoppingContext === 'instore'\n\n        /*\n         * HTML Popovers\n         * This isn't an ideal way to do it, but I can't figure out how to make this DRY in Angular\n         */\n        $scope.outOfStockWarningPopover = $sce.trustAsHtml(\n          `<span class=\"icon-warning add-to-cart__warning\" aria-hidden=\"true\"></span> ${lang.values.outOfStockDescription}`\n        )\n\n        /*\n         * Add to cart overlay variant events\n         */\n        $scope.closeQuickAdd = (event, forceClose) => {\n          const el = $element[0]\n\n          // Detect where the element is clicked so that buttons inside don't close the overlay\n          if ((el !== event?.target && !el.contains(event?.target)) || forceClose) {\n            $scope.showQuickAdd = false\n            $document.off('click', $scope.closeQuickAdd)\n\n            // Force refresh\n            $timeout(() => $scope.$apply())\n          }\n        }\n\n        $scope.onQuickAddClick = () => {\n          // Hack to get around binding issue\n          $timeout(() => {\n            $scope.showQuickAdd = true\n            const el = document.getElementById(`add-to-cart-modify-add-button-${$scope.product.id}`)\n\n            if (el) {\n              // Hack to get around waiting for element to be visible\n              // Focus the add to cart button so the user can continue to add to cart\n              $timeout(() => {\n                el.focus()\n              }, 10)\n            }\n\n            $document.on('click', $scope.closeQuickAdd)\n          })\n        }\n\n        // This method fires when there is change to cart so that we can update the Add To Cart button accordingly to\n        // reflect any additions/removals.\n        // NOTE: the below function and listeners are a slightly striped down version from productCell.js\n        // TODO: Move this somewhere else to make it reuseable\n        const updateForConfigurations = function () {\n          if (\n            $scope.product.product_config &&\n            $scope.product.product_config.options &&\n            $scope.product.product_config.options.length > 0 &&\n            $scope.product.product_config.config_type === 'prep_style'\n          ) {\n            let selectedConfiguration = []\n\n            $scope.aggregateQuantityCount = 0\n            $scope.existingConfigurationCartItems = []\n            $scope.existingConfigSingular = null\n\n            // No default options available, show all options on Add To Cart popover\n            $scope.showAllOptions = !configurableProductService.findDefault(\n              $scope.product.product_config.options[0].items\n            )\n\n            // Checks all product's available configs and sees if they exist in cart\n            _.each($scope.product.product_config.options[0].items, option => {\n              selectedConfiguration = configurableProductService.formatConfigForCart(\n                $scope.product,\n                option\n              )\n\n              // Find configuration in cart and update quantity counts and aggregates in-cart configurations\n              // To pass to addToCartButton popover\n              const item = cartService.getItem($scope.product, selectedConfiguration)\n              if (item && !_.find($scope.existingConfigurationCartItems, item)) {\n                $scope.aggregateQuantityCount += item.quantity\n                $scope.existingConfigurationCartItems.push(item)\n                if ($scope.existingConfigurationCartItems.length === 1) {\n                  $scope.aggregateQuantityCount = item.quantity\n                  $scope.existingConfigSingular = item\n                } else {\n                  $scope.existingConfigSingular = null\n                }\n              }\n            })\n          }\n        }\n\n        if (!config.disableProductTileProductReco && !eComLightService.inEComLightMode) {\n          const deregister = $scope.$on('productAdded', () => {\n            updateForConfigurations()\n          })\n          $scope.$on('$destroy', () => {\n            deregister()\n          })\n        }\n\n        // Watchers to update configurable dropdown\n        if (\n          $scope.product.product_config &&\n          $scope.product.product_config.options &&\n          $scope.product.product_config.options.length > 0 &&\n          $scope.product.product_config.config_type === 'prep_style'\n        ) {\n          const deregisterGroupWatcher = $scope.$watchGroup(\n            ['cartService.lastUpdated', 'product'],\n            updateForConfigurations\n          )\n          const deregisterCartServiceWatcher = $scope.$on('cartService', (event, method, item) => {\n            const cartChange =\n              ['add', 'remove'].includes(method) &&\n              $scope.product &&\n              $scope.product.id === item?.store_product?.id\n            const cartCleared = method === 'clearConfirm'\n            if (cartChange || cartCleared) {\n              updateForConfigurations()\n            }\n          })\n\n          if (cartService.cart) {\n            updateForConfigurations()\n          } else {\n            cartService.fetch().then(updateForConfigurations)\n          }\n\n          $scope.$on('$destroy', () => {\n            deregisterGroupWatcher()\n            deregisterCartServiceWatcher()\n          })\n        }\n\n        productsService.trackViewPort($element, $scope, $scope.product)\n      },\n    }\n  })\n","import angular from 'angular'\nimport RelatedProduct from './relatedProduct.js'\n\nexport default angular.module('app.shared.relatedProduct', [RelatedProduct.name])\n","import angular from 'angular'\n\nimport { utils as timeslotUtils } from '@instacart/enterprise-timeslots'\nimport { DEFAULT_TIMESLOT_DATE_FORMAT } from '@app/angular/constants/timeslots'\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\nimport { IC_PLACEMENTS } from '@app/angular/constants/express'\nimport { HTTP_ERRORS } from '@app/angular/constants/httpErrors'\nimport { CHECKOUT_STEP_IDS } from '@app/angular/constants/checkout'\n\nimport template from './scheduleForm.html'\nimport weightDriftModal from './views/weightDriftModal.html'\n\nclass ScheduleForm {\n  constructor(\n    $rootScope,\n    $state,\n    $timeout,\n    $uibModalStack,\n    auth,\n    cartService,\n    checkoutAnalytics,\n    checkoutService,\n    config,\n    errorModalService,\n    express,\n    imageURLService,\n    lang,\n    mobileService,\n    registrationService,\n    reservationService,\n    shoppingSelectorService,\n    utilService\n  ) {\n    const { intent, user } = auth\n    const { delivery, pickup } = config.shoppingSelector\n    const { enableAccountLinking } = config.instacart\n    const { icExpress } = config\n    const { loadStaticImage } = utilService\n\n    Object.assign(this, {\n      $rootScope,\n      $state,\n      $timeout,\n      $uibModalStack,\n      auth,\n      cartService,\n      checkoutAnalytics,\n      checkoutService,\n      config,\n      enableAccountLinking,\n      errorModalService,\n      express,\n      icExpress,\n      imageURLService,\n      intent,\n      lang,\n      loadStaticImage,\n      mobileService,\n      registrationService,\n      reservationService,\n      shoppingSelectorService,\n      user,\n    })\n\n    this.services = { reservationService }\n    this.showContextChangeBtn = delivery.exists || pickup.exists\n  }\n\n  showTimeslotPlacement() {\n    return this.user.ic_linked && this.express.isPlacementConfigEnabled(IC_PLACEMENTS.TIMESLOT)\n  }\n\n  showFulfillmentBanner() {\n    return (\n      !this.showTimeslotPlacement() &&\n      this.intent.delivery() &&\n      this.config.shoppingSelector.delivery.fulfilledByInstacart\n    )\n  }\n\n  /**\n   * Changes the section to edit mode by calling the\n   * edit prop function\n   *\n   * @returns { undefined }\n   */\n  enterEditMode() {\n    const { $timeout } = this\n    this.edit({ step: CHECKOUT_STEP_IDS.SCHEDULE })\n    $timeout(() => this.logViewEvent())\n  }\n\n  /**\n   * Is triggered by <timeslot-selectors> when a time slot has been selected, and logs this CHANGE event\n   * @param {boolean} success - Whether updating to the new timeslot was successful\n   *\n   * @returns { undefined }\n   */\n  onDoSave({ success }) {\n    if (success) {\n      this.onSave()\n    }\n\n    this.checkoutAnalytics.editTimeslotOptions({\n      reservation: this.reservationService.reservation,\n      success,\n    })\n  }\n\n  /**\n   * Is triggered by <timeslot-selectors> when the timeslot component is loading\n   *\n   * @returns { undefined }\n   */\n  onLoad() {\n    this.loadedSuccess = null\n  }\n\n  /**\n   * Is triggered by <timeslot-selectors> when the timeslot component has loaded, showing timeslot events\n   *\n   * @returns { undefined }\n   */\n  onLoadDone() {\n    this.loadedSuccess = true\n    this.logViewEvent()\n  }\n\n  /**\n   * Is triggered by <timeslot-selectors> when the timeslot component has failed to load\n   *\n   * @returns { undefined }\n   */\n  onLoadError(response) {\n    const { $state, auth, edit, errorModalService, lang, registrationService } = this\n    const currentState = $state.current.name\n\n    this.loadedSuccess = false\n    this.logViewEvent()\n\n    if (currentState === 'main.checkout.checkoutPage') {\n      const { error, message, payload } = response?.data || {}\n      const errorMessage = message || response?.message\n\n      const invalidItemIds = (payload?.weight_drift_item_ids || []).map(id => id.toString())\n      const invalidItems = this.cartService\n        .getItems()\n        .filter(item => invalidItemIds.includes(item.store_product.id))\n\n      const step =\n        auth.getContext().intent === SHOPPING_MODES.DELIVERY\n          ? CHECKOUT_STEP_IDS.DELIVERY\n          : CHECKOUT_STEP_IDS.PICKUP\n\n      switch (error) {\n        case HTTP_ERRORS.EXT_FULFILLMENT_PROVIDER_ERROR:\n          // pop a lite version of the cart compare modal\n          if (invalidItems.length) {\n            return errorModalService.openCustom(weightDriftModal, {\n              items: invalidItems,\n              imageURLService: this.imageURLService,\n              message: errorMessage,\n              onClose: () => this.$rootScope.reloadState(),\n            })\n          }\n\n          return errorModalService.open(errorMessage, lang.values.ok).then(() => edit({ step }))\n        case HTTP_ERRORS.SESSION_EXPIRED_ERROR:\n        case HTTP_ERRORS.PII_UNAUTHORIZED:\n        case HTTP_ERRORS.MISSING_CART:\n          return errorModalService\n            .open(lang.values.expiredTokenErrorMessage, 'OK', null)\n            .then(() =>\n              registrationService.promptLogin(currentState, '', '', '', lang.values.loginToContinue)\n            )\n            .then(() => {\n              /*\n               * The need to login again is a rare edge case. We do this to resolve two problems:\n               *  1. For timeslots, Connect does not seem to reload session info for social login\n               *  2. Timeslots state gets in a confused state when logged out\n               */\n              window.location.reload()\n            })\n        default:\n        // Timeslot timeout error, let user just try again\n      }\n    }\n  }\n\n  /**\n   * Is triggered by enterEditMode, onLoadDone and onLoadError - logs a VIEW event\n   * The event is only logged if the timeslot is already loaded or failed to load, otherwise it waits\n   *\n   * @returns { undefined }\n   */\n  logViewEvent() {\n    const { checkoutAnalytics, editMode, loadedSuccess } = this\n\n    if (editMode && loadedSuccess !== null) {\n      checkoutAnalytics.viewTimeslotOptions({ success: loadedSuccess })\n    }\n  }\n\n  onAfterCartCompare(shouldRecalculateFees) {\n    this.checkoutService.handleCartCompareChange(shouldRecalculateFees)\n  }\n\n  getSelectedCheckoutAddress() {\n    return this.checkoutService.deliveryAddress\n  }\n}\n\nexport default angular\n  .module('ScheduleFormModule', [])\n  .component('scheduleForm', {\n    bindings: {\n      editMode: '<',\n      onError: '&',\n      onSave: '&',\n      edit: '&',\n      hideChevron: '<',\n    },\n    template,\n    controller: ScheduleForm,\n  })\n  .filter('reservationScheduleToString', (config, reservationService) => {\n    return reservation => {\n      return timeslotUtils.getMainLabel(reservation, {\n        format: reservationService.reservation\n          ? config.apiDateFormat\n          : DEFAULT_TIMESLOT_DATE_FORMAT,\n      })\n    }\n  })\n","import angular from 'angular'\nimport ScheduleForm from './scheduleForm'\n\nexport default angular.module('app.shared.scheduleForm', [ScheduleForm.name])\n","import angular from 'angular'\nimport { ACTIONS } from '@app/angular/constants/recaptcha'\n\nimport template from './sharedForgotPassword.html'\n\nexport default angular\n  .module('SharedForgotPasswordComponentModule', [])\n  .directive('sharedForgotPassword', function () {\n    return {\n      replace: true,\n      template,\n      controller(\n        $attrs,\n        $scope,\n        config,\n        recaptchaService,\n        Restangular,\n        userAnalytics,\n        utilService\n      ) {\n        // Defines whether the forgot password is on the main flow (context=\"mainForgotPassword\") or the loyalty onboarding flow (context=\"loyaltyForgotPassword\")\n        // This is passed in as an attribute when the directive is implemented.\n\n        $scope.forgotPasswordContext = $attrs.context\n        $scope.identifier = { email: '' }\n\n        const el = document.getElementById('password-reset-form')\n\n        $scope.inputFocusHelper = function (event) {\n          event.preventDefault()\n          utilService.getFocusableElements(el)[0].focus()\n        }\n\n        // eslint-disable-next-line no-unused-expressions\n        el?.addEventListener('touchstart', event => {\n          // eslint-disable-next-line no-unused-expressions\n          document.getElementById('password-reset-email-error')\n            ? $scope.inputFocusHelper(event)\n            : null\n        })\n\n        $scope.recaptcha = {\n          enabled: recaptchaService.isEnabled(),\n          token: null,\n          action: ACTIONS.PASSWORD_RESET,\n        }\n\n        $scope.onRecaptchaSuccess = recaptchaToken => {\n          $scope.$apply(() => {\n            $scope.recaptcha.token = recaptchaToken\n          })\n        }\n\n        $scope.onRecaptchaExpired = () => {\n          $scope.$apply(() => {\n            $scope.recaptcha.token = null\n          })\n        }\n\n        $scope.reset = function () {\n          delete $scope.message\n          delete $scope.error\n\n          const passwordResetPayload = {\n            email: $scope.identifier.email,\n          }\n\n          if ($scope.recaptcha.enabled) {\n            if (!$scope.recaptcha.token) {\n              $scope.error = $scope.lang.values.recaptchaError\n              return\n            }\n            passwordResetPayload.recaptcha = {\n              token: $scope.recaptcha.token,\n              siteKey: config.googleRecaptcha?.siteKey,\n            }\n          }\n\n          $scope.resetting = true\n          Restangular.one('user/password_reset')\n            .customPUT(passwordResetPayload)\n            .then(\n              result => {\n                delete $scope.identifier\n                $scope.message = result.message\n                $scope.resetting = false\n              },\n              response => {\n                $scope.resetting = false\n                $scope.error = response.data ? response.data.message : response.message\n                document.getElementById('password-reset-email').focus()\n              }\n            )\n            .finally(userAnalytics.logUserChangePassword())\n        }\n      },\n    }\n  })\n","import angular from 'angular'\nimport SharedForgotPassword from './sharedForgotPassword.js'\n\nexport default angular.module('app.shared.sharedForgotPassword', [SharedForgotPassword.name])\n","import { registerPlugin } from '@capacitor/core'\n\nexport interface ShareData {\n  title?: string\n  content: string\n  type?: string\n}\n\ninterface SharePlugin {\n  share(data: ShareData): Promise<void>\n}\n\nconst Share = registerPlugin<SharePlugin>('SharePlugin')\n\nexport default Share\n","import angular from 'angular'\nimport { UNIT_OF_MEASURE } from '@app/angular/constants/uom'\nimport SharePlugin from '@app/react/mobile/plugins/sharePlugin'\nimport isCordova from '@app/utils/isCordova'\nimport isCapacitor from '@app/utils/isCapacitor'\nimport template from './shareListButton.html'\n\nexport default angular\n  .module('ShareListButtonModule', [])\n  .directive('shareListButton', function () {\n    return {\n      scope: {\n        customItems: '&',\n        listTitle: '<',\n        sortedProducts: '<',\n        sortedCategories: '<',\n        hideText: '<',\n      },\n      replace: true,\n      template,\n      controller($scope, cartService, $filter, lang, $window) {\n        $scope.lang = lang\n\n        // FIXME - Clean this up so it can be more re-usable.\n\n        $scope.shareListToMobile = function () {\n          // Use Title for title of page and subject line of email\n\n          const title = $scope.listTitle || lang.values.shareListTitle\n\n          // Build content string with \"custom\" items and regular items broken down by category\n\n          let content = `${title}\\n\\n`\n\n          // Loop through any customer items and add them with the heading.\n\n          if ($scope.customItems()?.length > 0) {\n            content += lang.values.customItem.toUpperCase()\n            content += '\\n\\n'\n            $scope.customItems().forEach(item => {\n              content += '\\u2022 '\n              content += item.pseudo_product.name\n              content += '\\n'\n            })\n            content += '\\n\\n'\n          }\n\n          // Loop through the categorized products and make heading for each then loop through and display products in category.\n          if ($scope.sortedCategories.length > 0) {\n            $scope.sortedCategories.forEach(category => {\n              content += category.toUpperCase()\n              content += '\\n\\n'\n              $scope.sortedProducts[category].forEach(product => {\n                content += '\\u2022 '\n                content += product.store_product.name\n                content += ' - '\n                content += getFormattedPrice(product)\n                content += ' '\n                content += getFormattedQuantity(product)\n                content += '\\n'\n              })\n              content += '\\n\\n'\n            })\n            content += lang.values.estimatedTotal\n            content += '\\n'\n            content += $filter('currency')(cartService.cart.product_total)\n          }\n\n          // Use cordova social sharing plugin, passing in \"content\" and \"subject\" parameters\n          if (isCordova()) {\n            $window.plugins.socialsharing.share(content, title)\n          } else if (isCapacitor()) {\n            SharePlugin.share({ title, content })\n          }\n        }\n\n        // Format the price depending upon whether it is on sale or not and whether is has base quantity of one or more than 1\n\n        function getFormattedPrice(product) {\n          let formattedPrice\n          if (product.store_product.sale_price) {\n            // eslint-disable-next-line eqeqeq\n            if (product.store_product.sale_quantity == 1) {\n              formattedPrice = `${$filter('currency')(product.store_product.sale_price)}/${\n                product.store_product.display_uom\n              }`\n            } else if (product.store_product.sale_quantity > 1) {\n              formattedPrice = `${product.store_product.sale_quantity} `\n              formattedPrice +=\n                // eslint-disable-next-line eqeqeq\n                product.store_product.display_uom != UNIT_OF_MEASURE.EACH\n                  ? product.store_product.display_uom\n                  : ''\n              formattedPrice += ` for ${$filter('currency')(product.store_product.sale_price)}`\n            }\n            // eslint-disable-next-line eqeqeq\n          } else if (product.store_product.base_quantity == 1) {\n            formattedPrice = `${$filter('currency')(product.store_product.base_price)}/${\n              product.store_product.display_uom\n            }`\n          } else if (product.store_product.base_quantity > 1) {\n            formattedPrice = `${product.store_product.base_quantity} `\n            formattedPrice +=\n              // eslint-disable-next-line eqeqeq\n              product.store_product.display_uom != UNIT_OF_MEASURE.EACH\n                ? product.store_product.display_uom\n                : ''\n            formattedPrice += ` for ${$filter('currency')(product.store_product.base_price)}`\n          }\n          return formattedPrice\n        }\n\n        // Display a quantity unit if the display unit of measure is not each\n\n        function getFormattedQuantity(product) {\n          let formattedQty = `x ${product.quantity} `\n          formattedQty +=\n            // eslint-disable-next-line eqeqeq\n            product.store_product.display_uom.toLowerCase() != UNIT_OF_MEASURE.EACH\n              ? `${product.store_product.display_uom} `\n              : ''\n          return formattedQty\n        }\n      },\n    }\n  })\n","import angular from 'angular'\nimport ShareListButton from './shareListButton.js'\n\nexport default angular.module('app.shared.shareListButton', [ShareListButton.name])\n","import angular from 'angular'\nimport template from './shopModalHeader.html'\n\nexport default angular\n  .module('ShopModalHeaderComponentModule', [])\n  .directive('shopModalHeader', function ($rootScope, config, oneCartService) {\n    return {\n      template,\n      link(scope) {\n        const nextStep = () => {\n          $rootScope.$broadcast('sideCart', 'open')\n          scope.$dismiss()\n        }\n        scope.goToNextStep = () => (oneCartService.enabled() ? nextStep : undefined)\n      },\n    }\n  })\n","import angular from 'angular'\nimport shopModalHeader from './shopModalHeader.js'\n\nexport default angular.module('app.shared.shopModalHeader', [shopModalHeader.name])\n","import angular from 'angular'\nimport template from './sideCartSortModal.html'\n\nexport default angular\n  .module('sideCartSortModalModule', [])\n  .controller('sideCartSortModal', function ($scope, $window, auth, modalOptions) {\n    $scope.sortOptions = modalOptions.sortOptions\n    $scope.sort = modalOptions.sort || null\n\n    $scope.$watch('sort', (newVal, oldVal) => {\n      if (newVal !== oldVal) {\n        $scope.apply()\n      }\n    })\n    $scope.apply = function () {\n      $scope.$close({\n        sort: $scope.sort,\n      })\n    }\n  })\n\n  .service('sideCartSortModalService', function sideCartSortModalService($uibModal) {\n    /**\n     * Opens a side cart sort modal dialog.\n     * @param {ModalOptions} options Options to pass to modal\n     * @return {Promise<FilterResults>} The new filter options to be used\n     */\n    this.open = function (options) {\n      return $uibModal.open({\n        template: template,\n        controller: 'sideCartSortModal',\n        resolve: {\n          modalOptions: function () {\n            return options\n          },\n        },\n      }).result\n    }\n\n    return this\n  })\n","import angular from 'angular'\nimport SideCartSortModal from './sideCartSortModal.js'\n\nexport default angular.module('app.shared.sideCartSortModal', [SideCartSortModal.name])\n","import angular from 'angular'\nimport template from './simplifiedHeader.html'\n\nclass SimplifiedController {\n  constructor(lang) {\n    this.lang = lang\n    this.customUiSref = this.customUiSref || 'main.home'\n  }\n}\n\nexport default angular.module('SimplifiedHeaderModule', []).component('simplifiedHeader', {\n  template,\n  bindings: {\n    screenReaderTitle: '<?',\n    customUiSref: '=?',\n  },\n  controller: SimplifiedController,\n})\n","import angular from 'angular'\n\nimport simplifiedHeader from './simplifiedHeader'\n\nexport default angular.module('app.shared.simplifiedHeader', [simplifiedHeader.name])\n","import angular from 'angular'\nimport template from './storeList.html'\n\nclass StoreList {\n  constructor($rootScope, config, utilService) {\n    Object.assign(this, { $rootScope, config, utilService, currentStore: null })\n  }\n\n  handleButtonClick(store) {\n    this.onStoreApply({ store })\n  }\n\n  handleRadioChange(store) {\n    this.onStoreSelect({ store })\n  }\n\n  createStoreAddressString(store) {\n    return `${store.address.address1}, ${store.address.province} ${store.address.postal_code}`\n  }\n\n  createFullStoreAddressString(store) {\n    return `\n        ${store.address.address1},\n        ${store.address.address2 ? `, ${store.address.address2}` : ''}\n        ${store.address.address3 ? `, ${store.address.address3}` : ''}\n        ${store.address.city}, ${store.address.province} ${store.address.postal_code}\n      `\n  }\n}\n\nexport default angular.module('StoreListModule', []).component('storeList', {\n  template,\n  bindings: {\n    stores: '<',\n    selectedStore: '<',\n    applyButtonText: '<',\n    onStoreSelect: '&',\n    onStoreApply: '&',\n  },\n  controller: StoreList,\n})\n","import angular from 'angular'\nimport StoreList from './storeList'\n\nexport default angular.module('app.shared.storeList', [StoreList.name])\n","import angular from 'angular'\nimport template from './storesMap.html'\n\nconst mapHasPickup = require('static/images/map-pin-hasPickup.png')\nconst mapPinActive = require('static/images/map-pin-active.png')\n\nconst MAP_INITIAL_POSITION = ['-95.665', '37.6']\nconst MAP_STYLE = 'mapbox://styles/mapbox/streets-v9'\nconst MAP_ZOOM = 7\nconst MAP_ZOOM_SELECTED = 10\n\nclass StoreMap {\n  constructor($scope, $timeout, config, lang) {\n    this.config = config\n    this.$scope = $scope\n    this.map = {}\n    this.setupMapBox()\n    this.lang = lang\n    this.$timeout = $timeout\n  }\n\n  $onInit() {\n    // Ensures that the HTML container exists\n    this.$timeout(() => {\n      this.initializeMap()\n\n      this.$scope.$watch(\n        () => this.currentLocation,\n        () => this.centralize()\n      )\n\n      this.$scope.$watch(\n        () => this.selectedStore,\n        () => {\n          this.clearMarkers()\n          this.drawStores()\n        }\n      )\n\n      this.$scope.$watch(\n        () => this.stores,\n        () => {\n          this.clearMarkers()\n          this.drawStores()\n        }\n      )\n    })\n  }\n\n  /**\n   * Centralize the map to the currentLocation coordinates\n   *\n   * @returns { undefined }\n   */\n  centralize() {\n    if (this.currentLocation) {\n      const { latitude, longitude } = this.currentLocation\n\n      this.map.flyTo({\n        center: [longitude, latitude],\n        zoom: this.initialZoom || MAP_ZOOM_SELECTED,\n      })\n    }\n  }\n\n  /**\n   * Configure mapboxgl with the accessToken\n   *\n   * @returns { undefined }\n   */\n  setupMapBox() {\n    if (window.mapboxgl) {\n      window.mapboxgl.accessToken = this.config.mapboxglAccessToken\n    }\n  }\n\n  /**\n   * Initialized the map by creating a canvas inside the given *mapId* element\n   *\n   * @returns { undefined }\n   */\n  initializeMap() {\n    const { latitude, longitude } = this.currentLocation || {}\n    const center = this.currentLocation ? [longitude, latitude] : MAP_INITIAL_POSITION\n\n    if (window.mapboxgl) {\n      this.map = new window.mapboxgl.Map({\n        center,\n        container: this.mapId,\n        style: MAP_STYLE,\n        zoom: this.initialZoom || MAP_ZOOM,\n      })\n\n      this.map.addControl(new window.mapboxgl.NavigationControl())\n    }\n  }\n\n  /**\n   * Draw store markers on the map\n   *\n   * @returns { undefined }\n   */\n  drawStores() {\n    this.stores.forEach(store => {\n      const { latitude, longitude } = store.location\n\n      if (latitude && longitude && window.mapboxgl) {\n        const el = this.createMarkerForStore(store)\n        new window.mapboxgl.Marker(el) //eslint-disable-line\n          .setLngLat([longitude, latitude])\n          .addTo(this.map)\n      }\n    })\n  }\n\n  /**\n   * Creates a marker element for a given store\n   * and attach a click event handler to it\n   *\n   * @param { object } store\n   *\n   * @returns { object } HTML object\n   */\n  createMarkerForStore(store) {\n    const markerElement = document.createElement('div')\n    const icon =\n      this.selectedStore && this.selectedStore.id === store.id ? mapPinActive : mapHasPickup\n\n    markerElement.id = `store-marker-${store.id}`\n    markerElement.className = 'marker'\n    markerElement.style.width = '30px'\n    markerElement.style.height = '40px'\n    markerElement.style.backgroundImage = `url('${icon}')`\n\n    markerElement.addEventListener(\n      'click',\n      (store => {\n        const { latitude, longitude } = store.location\n\n        return () => {\n          this.onStoreSelect({ store })\n          this.clearMarkers()\n          this.drawStores()\n          this.map.flyTo({\n            center: [longitude, latitude],\n          })\n        }\n      })(store)\n    )\n\n    return markerElement\n  }\n\n  /**\n   * Removes all markers from the map\n   */\n  clearMarkers() {\n    document.querySelectorAll(`#${this.mapId} .marker`).forEach(el => el.remove())\n  }\n}\n\nexport default angular.module('StoresMapModule', []).component('storesMap', {\n  bindings: {\n    mapId: '@',\n    initialZoom: '<',\n    stores: '<',\n    selectedStore: '<',\n    currentLocation: '<',\n    onStoreSelect: '&',\n  },\n  template,\n  controller: StoreMap,\n})\n","import angular from 'angular'\nimport StoresMap from './storesMap'\n\nexport default angular.module('app.shared.storesMap', [StoresMap.name])\n","import angular from 'angular'\nimport template from './subscriptionSelect.html'\n\nexport default angular.module('subscriptionSelect', []).component('subscriptionSelect', {\n  bindings: {},\n  template,\n  controller: [\n    'analytics',\n    'auth',\n    'cartService',\n    'config',\n    'lang',\n    'subscriptionsService',\n    function (analytics, auth, cartService, config, lang, subscriptionsService) {\n      const vm = this\n\n      vm.$onInit = () => {\n        Object.assign(vm, {\n          analytics,\n          auth,\n          cartService,\n          config,\n          lang,\n          subscriptionsService,\n        })\n\n        vm.subscriptionsService\n          .fetch()\n          .then(subscriptions => {\n            vm.subscriptions = subscriptions.plain()\n          })\n          .catch(err => {\n            throw new Error(`Ooops, something went wrong, ${err}`)\n          })\n      }\n\n      vm.onSubscriptionSelected = ({ selectedSubscription, oldSubscription }) => {\n        if (selectedSubscription) {\n          vm.cartService\n            .removeSubscriptions()\n            .then(() => vm.cartService.addItem(selectedSubscription, undefined, undefined, false))\n            .then(() => vm.cartService.validateCart())\n            .then(() => vm.analytics.logEvent('checkout payment subscribe button', 'click'))\n        } else if (oldSubscription) {\n          vm.cartService\n            .removeSubscriptions()\n            .then(() => vm.cartService.validateCart())\n            .then(() =>\n              vm.analytics.logEvent('checkout payment remove subscription button', 'click')\n            )\n        }\n      }\n    },\n  ],\n})\n","import angular from 'angular'\nimport subscriptionSelect from './subscriptionSelect'\n\nexport default angular.module('app.shared.subscriptionSelect', [subscriptionSelect.name])\n","import angular from 'angular'\n\nexport default angular.module('TagStyleModule', []).directive('tagStyle', function () {\n  return {\n    scope: {\n      tag: '<',\n      tagLocation: '@',\n    },\n    controller($scope, tagsService) {\n      const getTagValues = (tagValue, location) => tagsService.byVal(tagValue, location)\n      if (typeof $scope.tag === 'string') {\n        $scope.tagObj = getTagValues($scope.tag, $scope.tagLocation)\n      } else {\n        $scope.tagObj = $scope.tag\n      }\n    },\n    link(scope, el) {\n      const tag = scope.tagObj\n      const tagLocation = scope.tagLocation\n\n      if (!tag) {\n        // no tag, no styling\n        el.addClass('hide-empty')\n        return\n      }\n      // because the default value for circle is assumed to be true, we need to check if the\n      // config value has been explicitly set to false\n      // if no background color is set, we default to white\n      const defaultBackColor = '#FFFFFF'\n\n      if (tag.circle === false) {\n        el.css('color', tag.color)\n        el.css('backgroundColor', tag.backgroundColor || defaultBackColor)\n      } else {\n        el.css('background-color', tag.color)\n        el.css('color', tag.backgroundColor || defaultBackColor)\n      }\n\n      if (tag.fontSize) {\n        el.css('font-size', tag.fontSize)\n      }\n\n      if (tag.icon) {\n        if (tagLocation === 'mobile-home') {\n          el.append(\n            `<span>\n              <span class=\"icon-${tag.icon}\" aria-hidden=\"true\" />\n            </span>`\n          )\n        } else {\n          el.append(\n            `<span>\n              <span class=\"screen-reader-text\">${tag.name}</span>\n              <span class=\"icon-${tag.icon}\" aria-hidden=\"true\" />\n            </span>`\n          )\n        }\n      } else {\n        // hide the icon\n        el.addClass('hide-empty')\n      }\n    },\n  }\n})\n","import angular from 'angular'\nimport TagStyle from './tagStyle.js'\n\nexport default angular.module('app.shared.tagStyle', [TagStyle.name])\n","import angular from 'angular'\nimport { MAX_TIP } from '../../../constants/checkout'\n\nexport default angular.module('TipPickerComponentModule', []).component('tipPicker', {\n  bindings: {\n    tipIsValidCallback: '&',\n    onTipApplied: '&',\n  },\n  controller($element, analytics, cartService, checkoutAnalytics, config, lang, utilService) {\n    const vm = this\n    vm.lang = lang\n    vm.config = config\n    vm.cartService = cartService\n    vm.maxTipValue = MAX_TIP\n    vm.error = null\n    vm.isFocused = false\n\n    const invalidTipErrorMsg = lang.values.tipErrorMsg\n\n    const setTipPercent = val => {\n      cartService.setTip({ percentage: val })\n    }\n\n    const isValidTip = tipAmount => {\n      return (\n        tipAmount === '' || tipAmount === null || (tipAmount >= 0 && tipAmount <= vm.maxTipValue)\n      )\n    }\n\n    const validateTip = () => {\n      if (vm.currentTipPercent !== null || isValidTip(vm.currentTipValue)) {\n        vm.error = null\n        vm.tipIsValidCallback && vm.tipIsValidCallback({ isValid: true })\n        return true\n      }\n      vm.error = invalidTipErrorMsg\n      vm.tipIsValidCallback && vm.tipIsValidCallback({ isValid: false })\n      return false\n    }\n\n    /**\n     * Updates and syncs the cart when a tip percentage is selected.\n     */\n    vm.tipChangedPercent = val => {\n      if (val === -1) {\n        utilService.focusSelector('.tip-number-value', $element[0])\n        vm.currentTipValue = Number(cartService.cart.tip_total)\n      } else {\n        setTipPercent(val)\n      }\n\n      if (val === 0) {\n        cartService.cart.tip_total = val\n        cartService.cart.tip_percent = val\n      }\n\n      const payload = {\n        tip: {\n          option: val,\n          customAmount: null,\n        },\n      }\n\n      cartService\n        .sync()\n        .then(() => checkoutAnalytics.editTipOptions({ ...payload, success: true }))\n        .then(() => vm.onTipApplied())\n        .catch(() => checkoutAnalytics.editTipOptions({ ...payload, success: false }))\n    }\n\n    /**\n     * Updates and syncs the cart when a custom tip is entered.\n     */\n    vm.tipChangedValue = () => {\n      if (!validateTip() || vm.currentTipValue === null) {\n        vm.currentTipValue = 0\n      }\n      cartService.cart.tip_total = vm.currentTipValue\n      cartService.cart.tip_percent = null\n\n      const payload = {\n        tip: {\n          option: 'value',\n          customAmount: vm.currentTipValue,\n        },\n      }\n\n      cartService\n        .sync()\n        .then(() => checkoutAnalytics.editTipOptions({ ...payload, success: true }))\n        .then(() => vm.onTipApplied())\n        .catch(() => checkoutAnalytics.editTipOptions({ ...payload, success: false }))\n    }\n\n    const updateScopeValues = () => {\n      vm.currentTipPercent =\n        cartService.cart && cartService.cart.tip_percent !== null\n          ? // eslint-disable-next-line radix\n            parseInt(cartService.cart.tip_percent)\n          : null\n      vm.currentTipValue =\n        cartService.cart && cartService.cart.tip_total !== null\n          ? parseFloat(cartService.cart.tip_total)\n          : null\n\n      // User last entered a 'custom' tip.\n      if (vm.currentTipPercent === -1) {\n        vm.currentTipPercent = null\n      }\n\n      // User has not selected or entered any tip yet.\n      if (\n        !vm.isFocused &&\n        cartService.cart &&\n        vm.currentTipPercent === null &&\n        vm.currentTipValue === null\n      ) {\n        if (config.defaultStaticTip) {\n          vm.currentTipValue = parseFloat(config.defaultStaticTip)\n        } else {\n          vm.currentTipPercent = config.tipDefault\n        }\n        vm.tipChangedValue()\n      }\n    }\n    vm.$onChanges = updateScopeValues\n  },\n  template: `\n      <div class=\"tip-container\" role=\"radiogroup\" aria-label=\"{{::$ctrl.lang.values.tip}}\">\n        <div class=\"tip-container\" ng-repeat=\"tip in $ctrl.config.tipPercents\" ng-class=\"{'tip-percent-value': tip !== null, 'tip-custom-value': tip === null}\">\n          <input data-test=\"tip-percentage-input\" name=\"tip-percent-value\" id=\"tip-picker-{{::tip}}\" type=\"radio\" ng-model=\"$ctrl.currentTipPercent\" ng-change=\"$ctrl.tipChangedPercent(tip)\" ng-value=\"{{::tip}}\" class=\"radio\">\n          <label for=\"tip-picker-{{::tip}}\">{{::tip}}%</label>\n        </div>\n        <div class=\"tip-container\">\n          <input data-test=\"tip-amount-input\" class=\"radio\" name=\"tip-percent-value\" id=\"tip-picker-null\" type=\"radio\" ng-model=\"$ctrl.currentTipPercent\" ng-change=\"$ctrl.tipChangedPercent(-1)\" ng-value=\"null\">\n          <label class=\"\" for=\"tip-picker-null\">{{::$ctrl.lang.values.customAmount}}</label>\n        </div>\n      </div>\n      <div class=\"tip-container tip-custom-value\">\n        <input\n          data-test=\"tip-amount-text-input\"\n          class=\"input small tip-number-value\"\n          type=\"number\"\n          min=\"0\"\n          max=\"{{$ctrl.maxTipValue}}\"\n          step=\"any\"\n          ng-model=\"$ctrl.currentTipValue\"\n          ng-show=\"$ctrl.currentTipPercent === null\"\n          ng-value=\"$ctrl.currentTipValue\"\n          ng-change=\"$ctrl.tipChangedValue()\"\n          ng-model-options=\"{ updateOn: 'default blur', debounce: { 'default': 1000, 'blur': 0 } }\"\n          aria-label=\"{{::$ctrl.lang.values.tip + $ctrl.lang.values.customAmount}}\"\n        >\n      </div>\n      <div class=\"tip-error\" ng-if=\"$ctrl.error\"><span class=\"icon-info\"></span>{{$ctrl.error}}</div>\n    `,\n})\n","import angular from 'angular'\nimport TipPicker from './tipPicker.component.js'\n\nexport default angular.module('app.shared.tipPicker', [TipPicker.name])\n","import angular from 'angular'\nimport template from './tipPickerModal.html'\nimport modalTemplate from './tipPickerModalTemplate.html'\nimport { FULFILLMENT_TYPES, MAX_TIP, CUSTOM_TIP_OPTION } from '../../../constants/checkout'\n\nclass TipPickerModal {\n  constructor($uibModal, mobileService, cartService, config, lang, uibModalAriaLabelService) {\n    this.modal = $uibModal\n    this.modalAriaLabelService = uibModalAriaLabelService\n    this.isMobile = mobileService.isMobile\n    this.cartService = cartService\n    this.config = config\n    this.lang = lang\n    this.maxTipValue = MAX_TIP\n    this.customTipOption = CUSTOM_TIP_OPTION\n  }\n\n  open() {\n    const parent = this\n\n    this.modal.open({\n      animation: true,\n      template: modalTemplate,\n      controller: [\n        '$uibModalInstance',\n        'auth',\n        'checkoutAnalytics',\n        'cartService',\n        'checkoutService',\n        'config',\n        'lang',\n        function (\n          $uibModalInstance,\n          auth,\n          checkoutAnalytics,\n          cartService,\n          checkoutService,\n          config,\n          lang\n        ) {\n          Object.assign(this, {\n            $uibModalInstance,\n            auth,\n            config,\n            dismiss: $uibModalInstance.dismiss,\n            error: '',\n            lang,\n            tip: {\n              option: null,\n              customAmount: null,\n            },\n            isLoading: false,\n          })\n\n          /**\n           * Sets the initial tip value based on the cart and\n           * configuration defaults\n           *\n           * @returns { undefined }\n           */\n          const setInitialTip = () => {\n            const { cart } = cartService\n\n            if (cart.tip_percent === null) {\n              if (cart.tip_total !== null) {\n                this.tip.option = parent.customTipOption\n                this.tip.customAmount = Number(cart.tip_total)\n              } else {\n                this.tip.option = this.config.tipDefault\n              }\n            } else {\n              this.tip.option = Number(cart.tip_percent)\n            }\n\n            checkoutAnalytics.viewTipOptions({ tip: this.tip })\n\n            // Set tip percentage to a string to allow the radio button to behave as expected.\n            if (this.tip.option != null) {\n              this.tip.option = String(this.tip.option)\n            }\n          }\n\n          /**\n           * Calculates the tip amount based on cart *product_total* attribute\n           * @param { string } value - the percentage of the tip\n           *\n           * @returns { number }\n           */\n          this.getTipAmount = percentage => {\n            // check cart object for tip totals calculated from percents from BE\n            const cartTotals = cartService.getCartTotals()\n\n            if (cartTotals.tip_options?.[percentage]) {\n              return cartTotals.tip_options[percentage]\n            }\n\n            // calculate tip amount from product_total and tip percent\n            const total = _getProductTotal()\n            return _calculateTipAmount(percentage, total)\n          }\n\n          /**\n           * Get product total for tip calculation\n           *\n           * @returns { number }\n           */\n          const _getProductTotal = () => {\n            let productTotal = cartService.cart.product_total\n            if (this.config.tipUsesPreDiscountProductTotal) {\n              productTotal = cartService.cart.pre_discount_product_total\n            }\n            return Math.floor(productTotal * 100)\n          }\n\n          /**\n           * Calculate tip amount\n           *\n           * @returns { number }\n           */\n          const _calculateTipAmount = (percentage, total) => {\n            return (percentage * total) / 100 / 100\n          }\n\n          /**\n           * Returns the modal title based on the current fulfillment type\n           *\n           * @returns { string }\n           */\n          const getTitle = () => {\n            const { tipPickup, tipDelivery } = this.lang.values\n\n            return parent.fulfillmentType === FULFILLMENT_TYPES.PICKUP ? tipPickup : tipDelivery\n          }\n\n          /**\n           * Applies the tip that was selected to the cart\n           *\n           * @returns { undefined }\n           */\n          this.applyTip = () => {\n            const { tip } = this\n            const { cart } = cartService\n            const logEditTip = success => checkoutAnalytics.editTipOptions({ tip, success })\n            if (tip.option !== parent.customTipOption) {\n              cart.tip_percent = tip.option\n\n              if (Number(tip.option) === 0) {\n                cart.tip_total = 0\n              }\n            } else {\n              if (!this.isCustomTipValid()) {\n                this.error = this.lang.values.tipErrorMsg\n                return\n              }\n              cart.tip_percent = null\n              cart.tip_total = Number(tip.customAmount)\n            }\n\n            this.isLoading = true\n\n            cartService\n              .sync({\n                validate: checkoutService.isCartValidated,\n                validatePayload: {\n                  ...checkoutService.getValidationPayload(auth.getContext().intent),\n                },\n              })\n              .then(parent.onTipApplied)\n              .then(this.dismiss)\n              .then(() => logEditTip(true))\n              .catch(err => {\n                handleSyncError(err)\n                logEditTip(false)\n              })\n              .finally(() => {\n                this.isLoading = false\n              })\n          }\n\n          /**\n           * Handles cart sync errors\n           *\n           * @returns { undefined }\n           */\n          const handleSyncError = error => {\n            const { message } = error.data || {}\n\n            this.error = message || this.lang.values.defaultErrorMessage\n          }\n\n          /**\n           * Validates the custom tip amount\n           *\n           * @returns { boolean }\n           */\n          this.isCustomTipValid = () => {\n            const tipAmount = this.tip.customAmount\n            return tipAmount >= 0 && tipAmount <= parent.maxTipValue\n          }\n\n          /**\n           * Determine if tip option should be shown to customer\n           *\n           * @returns { boolean }\n           */\n          this.showTipOption = configTip => {\n            if (configTip === 0) {\n              return true\n            }\n\n            const tipAmount = this.getTipAmount(configTip)\n            return (\n              !this.config.tipCalculationMinimum || tipAmount >= this.config.tipCalculationMinimum\n            )\n          }\n\n          /**\n           * Gets the appropriate html for the tips description given the current intent mode\n           * @returns {string}\n           */\n          this.getTipsFormDescriptions = () => {\n            const { auth, lang } = this\n            const { intent } = auth.getContext()\n            const { tipsFormDescriptions } = lang.values\n            return tipsFormDescriptions[intent] || tipsFormDescriptions.default\n          }\n\n          setInitialTip()\n          this.title = getTitle()\n          this.isMobile = parent.isMobile\n          this.maxTipValue = parent.maxTipValue\n        },\n      ],\n      keyboard: false,\n      backdrop: 'static',\n      controllerAs: '$ctrl',\n      resolve: {\n        ariaLabel: () => {\n          parent.modalAriaLabelService.setLabel(parent.lang.values.tips)\n        },\n        cartService: parent.cartService,\n        config: parent.config,\n        lang: parent.lang,\n      },\n    })\n  }\n}\n\nexport default angular.module('TipPickerModalModule', []).component('tipPickerModal', {\n  bindings: {\n    label: '@',\n    fulfillmentType: '<',\n    onTipApplied: '&',\n  },\n  template,\n  controller: TipPickerModal,\n})\n","import angular from 'angular'\nimport tipPickerModal from './tipPickerModal'\n\nexport default angular.module('app.shared.tipPickerModal', [tipPickerModal.name])\n","/*\n * This directive fixes accessibility for the AngularJS Bootstrap Typeahead directive\n * AngularJS Bootstrap Typeahead has two bugs:\n * 1. It places the \"aria-expanded\" HTML attribute on the input field, when aria-expanded is unnecessary and may cause issues\n * 2. The value it sets it to is just plain wrong.\n *\n * To use:\n *   <input\n *     ...\n *     typeahead-is-open=\"$ctrl.<state_name>\"     // Will make the open/close state available to your controller\n *     typeahead-accessibility                    // Will cause this directive to patch the AngularJS Bootstrap bugs\n *     ...\n *\n * The <state_name> is simply what you expect the open state of the dropdown to be called in your as-controller scope.\n */\nimport angular from 'angular'\n\nconst TYPEAHEAD_DROPDOWN_CSS_CLASS = 'dropdown-menu' // The css class of the dropdown menu generated by AngularJS Bootstrap\nconst MENU_HIDE_DELAY_MS = 100 // Delay to allow appropriate time for hiding of menu\n\nexport default angular\n  .module('TypeaheadAccessibilityModule', [])\n  .directive('typeaheadAccessibility', function ($parse, $timeout, mobileService) {\n    return {\n      restrict: 'A',\n      link: (scope, element, attr) => {\n        const parent = element.parent()\n        const typeaheadIsOpenKey = attr.typeaheadIsOpen\n\n        let dropdownMenu = null\n\n        if (!typeaheadIsOpenKey) {\n          throw new Error(\n            'Please ensure that the \"typeahead-is-open\" attribute on element with ' +\n              `id \"${attr.id || '?'}\" has a string value to access the scope`\n          )\n        }\n\n        if (parent) {\n          const typeaheadIsOpenGetter = $parse(typeaheadIsOpenKey)\n\n          const accessibilityFix = function (newValue) {\n            if (!dropdownMenu) {\n              dropdownMenu = element.next(`.${TYPEAHEAD_DROPDOWN_CSS_CLASS}`)\n              dropdownMenu.attr('role', 'listbox')\n            }\n            element.removeAttr('aria-expanded')\n\n            if (!mobileService.isMobile) {\n              // as per A360 a11y audit, aria-expanded should only be applied to the input field on desktop\n              element.attr('aria-expanded', newValue)\n            }\n          }\n\n          scope.$watch(() => typeaheadIsOpenGetter(scope), accessibilityFix)\n\n          // The reason for this piece of nasty looking code is because the \"typeahead-is-open\" attribute does not get\n          // toggled on blur - the typehead feature in angular-bootstrap itself is broken!\n          // So: If the blur event is followed by a hidden dropdown menu, we consider expanded=false\n          element.on('blur', () => {\n            $timeout(() => {\n              if (dropdownMenu && dropdownMenu.is && !dropdownMenu.is(':visible')) {\n                accessibilityFix(false)\n              }\n            }, MENU_HIDE_DELAY_MS)\n          })\n        }\n      },\n    }\n  })\n","import angular from 'angular'\nimport TypeaheadAccessibility from './typeaheadAccessibility.js'\n\nexport default angular.module('app.shared.typeahead', [TypeaheadAccessibility.name])\n","/*\n * For a list of payment providers and their compatibility, please see:\n * https://instacart.atlassian.net/wiki/spaces/ENG/pages/995098979/Payment+Providers+and+new+checkout+styling\n *\n * For each payment provider service, you'll want to set the css class it should use with the new checkout (paymentForm.styl):\n *    paymentGatewayProvider.registerGateway({\n *      name: ...\n *      ...\n *      ...\n *      newCheckoutCssClass: 'provider-generic_styling'   // This is useful for most, but use a custom style if need be!\n *    });\n */\nimport angular from 'angular'\n\nimport template from './updateCreditCard.html'\n\nclass UpdateCreditCard {\n  constructor($q, $scope, config, lang, mobileService, paymentGateway) {\n    Object.assign(this, {\n      config,\n      lang,\n      isNewCard: false,\n      paymentGateway,\n    })\n\n    this.services = {\n      $q,\n      $scope,\n      mobile: mobileService,\n    }\n\n    Object.assign($scope, {\n      toggleIsShowingAddCard: isNewCard => (this.isNewCard = isNewCard),\n      lang,\n    })\n  }\n\n  $onInit() {\n    this.services.$scope.payment = this.payment\n    this.selectedGateway = this.paymentGateway.getTemplate(this.paymentType)\n    this.gatewayInformation = this.paymentGateway.get(this.paymentType)\n    this.gatewayService = this.paymentGateway.getService(this.paymentType)\n    this.paymentCssClassName = this.gatewayInformation.newCheckoutCssClass\n  }\n\n  shouldShowSaveButton() {\n    return !this.gatewayInformation?.hideSaveButton && !this.isNewCard\n  }\n\n  doSave() {\n    const {\n      gatewayService,\n      onSave,\n      services: {\n        $q,\n        $scope: { payment },\n      },\n    } = this\n\n    $q.resolve()\n      .then(() => gatewayService.verifyPayment && gatewayService.verifyPayment())\n      .then(() => onSave({ payment }))\n      .catch(error => onSave({ error }))\n  }\n}\n\nexport default angular.module('UpdateCreditCardModule', []).component('updateCreditCard', {\n  bindings: {\n    fulfillmentType: '<',\n    deliveryAddress: '<',\n    billingAddress: '<',\n    payment: '<',\n    paymentType: '<',\n    onSave: '&',\n  },\n  template,\n  controller: UpdateCreditCard,\n})\n","import angular from 'angular'\nimport UpdateCreditCard from './updateCreditCard'\n\nexport default angular.module('app.shared.updateCreditCard', [UpdateCreditCard.name])\n","import angular from 'angular'\n\nexport default angular.module('bgImgFadeComponentModule', []).directive('bgImgFade', function () {\n  return {\n    restrict: 'A',\n    link(scope, element, attrs) {\n      scope.$watch(attrs.bgImgFade, value => {\n        element.removeClass(attrs.addClassOnLoad)\n        const url = value\n        element[0].style.backgroundImage = `url(${url})`\n        const img = new Image()\n        img.onload = function () {\n          element.addClass(attrs.addClassOnLoad)\n        }\n        img.src = url\n      })\n    },\n  }\n})\n","// For use in the .com header/footer sync to compile the Angular components\nimport angular from 'angular'\nimport { windowManager } from '@instacart/enterprise-services-cordova'\nimport { renderTemplate } from '@instacart/enterprise-services-shadow-templates'\n\nexport default angular\n  .module('bindHtmlCompileComponentModule', [])\n  .directive('bindHtmlCompile', $compile => {\n    return {\n      restrict: 'A',\n      scope: {\n        afterCompileHandler: '=',\n        bindHtmlCompile: '=',\n      },\n      link(scope, element) {\n        scope.$watch('bindHtmlCompile', value => {\n          if (!value) return\n\n          /**\n           * Bind html compile is used to render and bootstrap raw html.\n           *\n           * Templates make better containers for raw html than raw html.\n           * They can contain scripts and styles that won't be evaluated\n           * making them ideal for passing around. We can also encapsulate\n           * the contents of a template onto a shadow dom.\n           *\n           * If the raw html just so happens to be a template\n           * we will render it before bootstraping.\n           *\n           * The code bellow parses the raw html and trys to grab the\n           * template if its the outermost tag.\n           *\n           * DomParser behaves different on different browsers when parsing\n           * partial html.\n           * On IE template tags are placed into the body tag of the Document.\n           */\n          const templateHtml = new DOMParser()\n            .parseFromString(value, 'text/html')\n            .querySelector('head > template, body > template')\n\n          let templateRoot\n          if (templateHtml) {\n            const doc = document.createElement('div')\n            element.append(doc)\n            templateRoot = renderTemplate(doc, templateHtml)\n          } else {\n            element.html(value)\n          }\n\n          $compile(element.contents())(scope)\n          if (scope.afterCompileHandler) {\n            scope.afterCompileHandler(templateRoot || element[0])\n          }\n\n          // windowManager.listen() should have been called on app bootstrap to set up global listeners for events (clicks, window opens, comms, etc)\n          // so that the Cordova container has access to them. We call it again here as we have inserted a shadowDOM root node above and the Cordova container\n          // needs access to events  in teh shadow DOM as well.\n          windowManager.listen()\n        })\n      },\n    }\n  })\n","// Compile directive that acts as an advanced ng-bind-html that can compile directives/components\n\nimport angular from 'angular'\n\nexport default angular.module('CompileComponentModule', []).directive('compile', $compile => {\n  return function (scope, element, attrs) {\n    scope.$watch(\n      scope => {\n        return scope.$eval(attrs.compile)\n      },\n      value => {\n        element.html(value)\n        $compile(element.contents())(scope)\n      }\n    )\n  }\n})\n","// Intercept clicks on an element if the disable expression is falsy\n\nimport angular from 'angular'\n\nexport default angular.module('DisableComponentModule', []).directive('disable', function () {\n  return {\n    restrict: 'A',\n    scope: {\n      disable: '=',\n    },\n    link(scope, el) {\n      el.on('click', e => {\n        if (scope.disable) {\n          e.preventDefault()\n        }\n      })\n\n      scope.$watch('disable', () => {\n        if (scope.disable) {\n          el.addClass('disable')\n        } else {\n          el.removeClass('disable')\n        }\n      })\n    },\n  }\n})\n","import angular from 'angular'\n\nexport default angular\n  .module('ElementInViewComponentModule', [])\n  .directive('elementInView', function ($document, $timeout) {\n    return {\n      restrict: 'A',\n      scope: {\n        inView: '=',\n      },\n      link: (scope, el) => {\n        const checkIfInView = () => {\n          const elementBounds = el[0].getBoundingClientRect()\n          const elementIsInViewport =\n            elementBounds.top >= 0 &&\n            elementBounds.left >= 0 &&\n            elementBounds.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&\n            elementBounds.right <= (window.innerWidth || document.documentElement.clientWidth)\n\n          // $timeout needed to trigger Angular digest cycle to adjacent scopes\n          $timeout(() => {\n            scope.inView = elementIsInViewport\n          })\n        }\n\n        $document.on('scroll', checkIfInView)\n        scope.$on('$destroy', () => {\n          $document.off('scroll', checkIfInView)\n        })\n\n        checkIfInView()\n      },\n    }\n  })\n","import angular from 'angular'\n\nexport default angular.module('ElementMatchPollyfillComponentModule', []).config(() => {\n  // patches Element#matches\n  window.Element &&\n    (function (ElementPrototype) {\n      ElementPrototype.matches =\n        ElementPrototype.matches ||\n        ElementPrototype.matchesSelector ||\n        ElementPrototype.mozMatchesSelector ||\n        ElementPrototype.msMatchesSelector ||\n        ElementPrototype.oMatchesSelector ||\n        ElementPrototype.webkitMatchesSelector ||\n        function (selector) {\n          const node = this\n          const nodes = (node.parentNode || node.document).querySelectorAll(selector)\n          let i = -1\n          // eslint-disable-next-line no-plusplus, eqeqeq\n          while (nodes[++i] && nodes[i] != node) {}\n          return !!nodes[i]\n        }\n    })(Element.prototype)\n})\n","import angular from 'angular'\n\nexport default angular\n  .module('FallbackSrcComponentModule', [])\n  .directive('fallbackSrc', function () {\n    return {\n      link(scope, element, attrs) {\n        element.bind('error', () => {\n          // eslint-disable-next-line eqeqeq\n          if (attrs.src != attrs.fallbackSrc) {\n            attrs.$set('src', attrs.fallbackSrc)\n          }\n        })\n      },\n    }\n  })\n","import angular from 'angular'\n\nexport default angular.module('FeaturedHeaderComponentModule', []).component('featuredHeader', {\n  bindings: {\n    collection: '<',\n    hideBack: '<',\n  },\n  controller(mobileService, lang) {\n    this.lang = lang\n    const { isMobile } = mobileService\n    const { images } = this.collection\n\n    this.showBackButton = isMobile && !this.hideBack\n    this.showCollectionName = !!(this.collection.show_name_with_details && this.collection.name)\n    // We want to show a translucent dark overlay on top of the background image if there is text (or a back button for mobile)\n    this.headerHasText = this.showCollectionName || this.collection.description\n    const imageObj = isMobile && images.mobile ? images.mobile : images.desktop\n\n    if (imageObj && typeof imageObj === 'object') {\n      this.imageSrc = imageObj.src\n      this.imageAltText = imageObj.alt_text\n    } else {\n      this.imageSrc = imageObj\n      this.imageAltText = ''\n    }\n\n    // TODO: Incorporate proper back button behaviour (currently in pageHeader directive) in one place and apply it to both\n    //       pageHeader and featuredHeader directives. Currently featuredHeader back button always just sends users to 'main.home'.\n  },\n  template: `\n      <section class=\"featured-header\">\n        <div class=\"background-image\" ng-class=\":: { 'header-has-text': $ctrl.headerHasText }\" >\n          <img src=\"{{ $ctrl.imageSrc }}\" alt=\"{{ $ctrl.imageAltText }}\" />\n        </div>\n        <a ng-if=\":: $ctrl.showBackButton\" ui-sref=\"main.home\" class=\"mobile-back-button\" aria-label=\"{{::lang.aria.goBack}}\"></a>\n        <h2 ng-if=\":: $ctrl.showCollectionName\" class=\"title\">{{ $ctrl.collection.name }}</h2>\n        <div class=\"description\">{{ $ctrl.collection.description }}</div>\n      </section>\n    `,\n})\n","import angular from 'angular'\n\nexport default angular\n  .module('FileUploaderComponentModule', [])\n  .component('fileUploader', {\n    bindings: {\n      uploaded: '=',\n      price: '<?',\n    },\n    controller(lang, mobileService) {\n      this.lang = lang\n      this.mobileService = mobileService\n\n      this.removeUpload = () => {\n        this.uploaded = {}\n      }\n    },\n    template: `\n      <div class=\"file-uploader-wrapper\">\n\n        <div class=\"result-wrapper\" ng-if=\"$ctrl.uploaded.success && !$ctrl.mobileService.isMobile\">\n          <div class=\"upload-success-wrapper\">\n            <div ng-init=\"$ctrl.showDeleteConfirm = false\" ng-class=\"{shown: $ctrl.showDeleteConfirm}\" class=\"delete-confirm\">\n              <div class=\"confirm-remove\">\n                {{::$ctrl.lang.values.imageUpload.wantToRemove}}\n              </div>\n              <div>\n                <button ng-click=\"$ctrl.showDeleteConfirm = false;\" class=\"button smaller dark\" analytics-click=\"['configurable product image upload delete confirmation cancel button', 'click']\">{{::$ctrl.lang.values.cancel}}</button>\n                <button ng-click=\"$ctrl.showDeleteConfirm = false; $ctrl.removeUpload()\" class=\"button smaller highlight\" analytics-click=\"['configurable product image upload delete confirmation remove button', 'click']\">{{::$ctrl.lang.values.remove}}</button>\n              </div>\n            </div>\n\n            <img ng-src=\"{{$ctrl.uploaded.src}}\" class=\"uploaded-pic\" ng-if=\"$ctrl.uploaded.type !== 'application/pdf'\" alt=\"{{::lang.aria.uploaded}}\"/>\n            <i class=\"icon-pdf\" ng-if=\"$ctrl.uploaded.type === 'application/pdf'\"></i>\n            <div class=\"uploaded-info\">\n              <span>{{$ctrl.uploaded.name}}</span>\n              <span role=\"button\" ng-click=\"$ctrl.showDeleteConfirm = true\" class=\"remove-button\" ng-bind=\"::$ctrl.lang.values.remove\"></span>\n            </div>\n          </div>\n          <div class=\"success-message\">\n            <div class=\"message-icon\"><i class=\"icon-checkmark-circle\"></i></div>\n            <div class=\"message-text\">\n              <span ng-bind=\"::$ctrl.lang.values.imageUpload.success\"></span>\n              <span ng-bind=\"::$ctrl.lang.values.imageUpload.uploadCTA.dragAndDropAfterSuccess\"></span>\n              <label>\n                <input type='file' file-reader='$ctrl.uploaded' class='click-only'>\n                <span ng-bind=\"::$ctrl.lang.values.imageUpload.uploadCTA.browse\"></span>\n              </label>\n              <span ng-bind=\"::$ctrl.lang.values.imageUpload.uploadCTA.uploadADifferentImage\"></span>\n            </div>\n          </div>\n        </div>\n        <div class=\"result-wrapper\" ng-if=\"$ctrl.uploaded.success && $ctrl.mobileService.isMobile\">\n          <div class=\"upload-success-wrapper\">\n            <div class=\"upload-success-main-mobile-content\">\n              <div ng-init=\"$ctrl.showDeleteConfirm = false\" ng-class=\"{shown: $ctrl.showDeleteConfirm}\" class=\"delete-confirm\">\n                <div class=\"confirm-remove\">\n                  {{::$ctrl.lang.values.imageUpload.wantToRemove}}\n                </div>\n                <div>\n                  <button ng-click=\"$ctrl.showDeleteConfirm = false;\" class=\"button smaller dark\" analytics-click=\"['configurable product image upload delete confirmation cancel button', 'click']\">{{::$ctrl.lang.values.cancel}}</button>\n                  <button ng-click=\"$ctrl.showDeleteConfirm = false; $ctrl.removeUpload()\" class=\"button smaller highlight\" analytics-click=\"['configurable product image upload delete confirmation remove button', 'click']\">{{::$ctrl.lang.values.remove}}</button>\n                </div>\n              </div>\n              <div role=\"button\" ng-click=\"$ctrl.showDeleteConfirm = true\" class=\"button smaller round darker icon-delete\"></div>\n              <img ng-src=\"{{$ctrl.uploaded.src}}\" class=\"uploaded-pic\" ng-if=\"$ctrl.uploaded.type !== 'application/pdf'\" alt=\"{{::lang.aria.uploaded}}\"/>\n              <i class=\"icon-pdf\" ng-if=\"$ctrl.uploaded.type === 'application/pdf'\"></i>\n              <div class=\"uploaded-info\">\n                <span>{{$ctrl.uploaded.name}}</span>\n              </div>\n            </div>\n            <div class=\"change-image-box\">\n              <label>\n                <input type='file' file-reader='$ctrl.uploaded' class='click-only'>\n                <span>{{$ctrl.lang.values.changeImage}}</span>\n              </label>\n            </div>\n          </div>\n          <div class=\"upload-restrictions\" ng-bind-html=\"::$ctrl.lang.values.imageUpload.uploadRestrictions\"></div>\n        </div>\n        <div class=\"upload-wrapper\" ng-if=\"!$ctrl.mobileService.isMobile && !$ctrl.uploaded.success\">\n          <div class=\"upload-wrapper-main-content\">\n            <i class=\"icon-image-upload upload-icon\"></i>\n            <div class=\"upload-text-container\">\n              <div class=\"upload-message\">\n                <span ng-bind=\"::$ctrl.lang.values.imageUpload.uploadCTA.dragAndDrop\"></span>\n                <label>\n                  <input type='file' file-reader='$ctrl.uploaded' class='click-only'>\n                  <span ng-bind=\"::$ctrl.lang.values.imageUpload.uploadCTA.browse\"></span>\n                </label>\n              </div>\n              <div class=\"upload-restrictions\" ng-bind-html=\"::$ctrl.lang.values.imageUpload.uploadRestrictions\"></div>\n            </div>\n          </div>\n          <div class=\"upload-wrapper-error-content\">\n            <div ng-if=\"$ctrl.uploaded.invalidLang\" class=\"error-message\">\n              <div class=\"message-icon\"><i class=\"icon-error\"></i></div>\n              <div class=\"message-text\"><span ng-bind=\"$ctrl.lang.values.imageUpload.invalid[$ctrl.uploaded.invalidLang]\"></span></div>\n            </div>\n          </div>\n        </div>\n        <div class=\"upload-wrapper\" ng-if=\"$ctrl.mobileService.isMobile && !$ctrl.uploaded.success\">\n          <label class=\"button dark darker-text hollow mobile-uploader\">\n            <input type='file' file-reader='$ctrl.uploaded' class='click-only'>\n            <span class=\"upload-a-photo-icon\"></span>\n            <span class=\"upload-a-photo-text\" ng-bind=\"::$ctrl.lang.values.imageUpload.uploadCTA.uploadPhoto\"></span>\n          </label>\n          <div class=\"upload-restrictions\" ng-bind-html=\"::$ctrl.lang.values.imageUpload.uploadRestrictions\"></div>\n          <div class=\"upload-wrapper-error-content\">\n            <div ng-if=\"$ctrl.uploaded.invalidLang\" class=\"error-message\">\n              <div class=\"message-icon\"><i class=\"icon-error\"></i></div>\n              <div class=\"message-text\"><span ng-bind=\"$ctrl.lang.values.imageUpload.invalid[$ctrl.uploaded.invalidLang]\"></span></div>\n            </div>\n          </div>\n        </div>\n\n        <input type=\"file\" file-reader=\"$ctrl.uploaded\" class=\"drag-drop-only\" drag-drop-only=\"true\">\n        <div class=\"file-uploader-price\" ng-if=\"$ctrl.price\">+ {{::$ctrl.price | currency}}</div>\n      </div>\n    `,\n  })\n  .directive('fileReader', function ($http, config) {\n    return {\n      scope: {\n        fileReader: '=',\n        dragDropOnly: '=',\n      },\n      link: (scope, elem) => {\n        let uploadedObjectData = {}\n\n        const dragOverOrEnter = dragEvent => {\n          const dragParentElement = angular.element(dragEvent.target.parentNode)\n          dragParentElement.addClass('dragging')\n        }\n\n        const dragLeaveOrEnd = dragEvent => {\n          const dragParentElement = angular.element(dragEvent.target.parentNode)\n          dragParentElement.removeClass('dragging')\n        }\n\n        const isFileTypeValid = type => {\n          return config.imageUploadRestrictions.types.indexOf(type) > -1\n        }\n\n        const isFileSizeValid = size => {\n          return config.imageUploadRestrictions.size > size\n        }\n\n        const upload = file => {\n          const formData = new FormData()\n\n          formData.append('file', file, file.name)\n          formData.append('polytype', 'configurable_product')\n\n          // We need to manually set `Content-Type: undefined` here since we are using FormData,\n          // the $http.post service will automatically insert a boundary header when `Content-Type: undefined`\n          // also, we are using $http because Restangular forces an app reload if the API throws an exception, which can happen depending on file type\n\n          return $http.post('/api/v2/upload', formData, {\n            headers: {\n              'Content-Type': undefined,\n            },\n          })\n        }\n\n        elem.on('change', changeEvent => {\n          const reader = new FileReader()\n          const file = changeEvent.target.files[0]\n\n          uploadedObjectData = {}\n\n          reader.onload = loadEvent => {\n            scope.$apply(() => {\n              if (isFileTypeValid(file.type) && isFileSizeValid(file.size)) {\n                upload(file).then(\n                  uploadedResp => {\n                    uploadedObjectData = {\n                      success: true,\n                      invalid: false,\n                      src: loadEvent.target.result,\n                      url: uploadedResp.data.url,\n                      name: uploadedResp.data.name,\n                      id: uploadedResp.data.id,\n                    }\n\n                    scope.fileReader = uploadedObjectData\n                  },\n                  () => {\n                    // Handle any API after-post errors with generic error message\n                    uploadedObjectData = {\n                      success: false,\n                      invalidLang: 'generic',\n                    }\n\n                    scope.fileReader = uploadedObjectData\n                  }\n                )\n              } else {\n                if (!isFileTypeValid(file.type)) {\n                  uploadedObjectData = {\n                    success: false,\n                    invalidLang: 'type',\n                  }\n                } else if (!isFileSizeValid(file.size)) {\n                  uploadedObjectData = {\n                    success: false,\n                    invalidLang: 'size',\n                  }\n                }\n\n                scope.fileReader = uploadedObjectData\n              }\n            })\n          }\n\n          reader.readAsDataURL(file)\n        })\n\n        if (scope.dragDropOnly) {\n          elem.on('click', clickEvent => {\n            clickEvent.preventDefault()\n          })\n\n          elem.on('dragover dragenter', dragOverOrEnter)\n          elem.on('dragleave dragend drop', dragLeaveOrEnd)\n        }\n      },\n    }\n  })\n","import _ from 'lodash'\nimport angular from 'angular'\nimport dayjs from 'dayjs'\nimport pluralize from 'pluralize'\n\nexport default angular\n  .module('DateFiltersComponentModule', [])\n\n  // Return the specified name for a given value from an array of\n  // name/value pairs such as: [{name: \"foo\", value=\"bar\"}]\n\n  .filter('nameFromValue', function () {\n    // Unused? potentially deprecate?\n    return function (value, arr) {\n      const obj = _.find(arr, { value })\n      return obj ? obj.name : null\n    }\n  })\n\n  .filter('unsafe', function ($sce) {\n    return $sce.trustAsHtml\n  })\n\n  .filter('linebreaks', function ($sce) {\n    return function (value) {\n      if (!value) {\n        value = ''\n      }\n      return $sce.trustAsHtml(value.replace(/[\\n\\r]/g, '<br>'))\n    }\n  })\n\n  .filter('rootHref', function ($location) {\n    return function (value) {\n      // Prepend '#' when html5 mode isn't enabled (cordova)\n      if (value && value.startsWith('/') && !$location.$$html5) {\n        return `#${value}`\n      }\n      return value\n    }\n  })\n\n  // Return the specified object with a given value, similar\n  // to nameFromValue\n\n  .filter('objFromValue', function () {\n    // Unused? potentially deprecate?\n    return function (value, arr) {\n      return _.find(arr, { value })\n    }\n  })\n\n  .filter('stripDecimal', function () {\n    return function (value) {\n      if (value) {\n        return value.toString().replace(/\\..+$/g, '')\n      }\n      return null\n    }\n  })\n\n  .filter('pluralize', function () {\n    return function (str, num) {\n      return pluralize(str, num)\n    }\n  })\n\n  .filter('date', function () {\n    return function (str, format, parseFormat) {\n      const day = dayjs(str, parseFormat)\n      return day.isValid() ? day.format(format) : dayjs(str, 'YYYY-MM-DD').format(format)\n    }\n  })\n\n  .filter('time', function () {\n    return function (str, short) {\n      const m = dayjs(str, 'HH:mm:ss')\n      return m.format(short && !m.minutes() ? 'hA' : 'h:mmA')\n    }\n  })\n\n  .filter('apiDate', function (config) {\n    return function (str, format) {\n      return dayjs(str, config.apiDateFormat).format(format)\n    }\n  })\n\n  .filter('daysFromNow', function () {\n    return function (str) {\n      return dayjs(str, 'YYYY/MM/DD H:mm:ss Z').diff(dayjs(), 'days')\n    }\n  })\n\n  .filter('offset', function () {\n    return function (input, start) {\n      start = parseInt(start, 10)\n      return input.slice(start)\n    }\n  })\n\n  .filter('humanBool', function () {\n    return function (input) {\n      return input ? 'Yes' : 'No'\n    }\n  })\n\n  .filter('or', function () {\n    return function (str, or) {\n      return str || or\n    }\n  })\n\n  .filter('capitalize', function () {\n    return function (input) {\n      if (!input) {\n        return ''\n      }\n      const lowerCaseInput = input\n        .trim()\n        .split(' ')\n        .map(word => word.toLowerCase())\n        .join(' ')\n      return lowerCaseInput.charAt(0).toUpperCase() + lowerCaseInput.slice(1)\n    }\n  })\n\n  .filter('sortBySelected', function () {\n    return (items, selectedValue, selectedObj1, selectedObj2) => {\n      const sortedItems = _.orderBy(items, item => {\n        return selectedObj1[item[selectedValue]] || selectedObj2[item[selectedValue]]\n      })\n\n      return sortedItems\n    }\n  })\n\n  .filter('todaysHours', function () {\n    return function (storeHours) {\n      const todaysHoursObj = storeHours ? storeHours[dayjs().format('dddd').toLowerCase()] : null\n      if (storeHours && todaysHoursObj && !_.isEmpty(todaysHoursObj)) {\n        const startTime = dayjs(todaysHoursObj.start, 'HH:mm:ss')\n        const endTime = dayjs(todaysHoursObj.end, 'HH:mm:ss')\n\n        if (startTime.isValid() && endTime.isValid()) {\n          return `${startTime.format('h:mm A')} - ${endTime.format('h:mm A')}`\n        }\n        return 'Closed'\n      }\n    }\n  })\n  .filter('reverse', function () {\n    return function (items) {\n      return items && items.slice().reverse()\n    }\n  })\n\n  .filter('appendIfNotNull', function () {\n    return function (val, toAppend) {\n      return val ? val + toAppend : ''\n    }\n  })\n\n  // SEO friendly urls\n  .filter('slugify', function () {\n    return input => {\n      if (!input) {\n        return\n      }\n      // make lower case and trim\n      let slug = input.toLowerCase().trim()\n\n      // replace invalid chars with spaces\n      slug = slug.replace(/[^a-z0-9\\s-]/g, ' ')\n\n      // replace multiple spaces or hyphens with a single hyphen\n      slug = slug.replace(/[\\s-]+/g, '-')\n\n      // If the last character is a hypen (was a special char) trim it\n      if (slug[slug.length - 1] === '-') {\n        slug = slug.substring(0, slug.length - 1)\n      }\n\n      return slug\n    }\n  })\n\n  // Add http:// for absolute links\n\n  .filter('absoluteUrl', function () {\n    return url => {\n      let fullUrl\n      const httpProtocol = 'http://'\n      const secureHttpProtocol = 'https://'\n\n      if (url.indexOf(httpProtocol) === 0 || url.indexOf(secureHttpProtocol) === 0) {\n        fullUrl = url\n      } else {\n        fullUrl = httpProtocol + url\n      }\n\n      return fullUrl\n    }\n  })\n\n  // Find any offer which:\n  // a) Has a condition related to cart total\n  // b) Is related to a promo code the user has entered\n  // c) Is related to an item in the cart, either a condition or a reward\n  // d) Has progress toward completion\n\n  .filter('completedOffers', function () {\n    return function (allOffers, itemList) {\n      return _.filter(allOffers, offer => {\n        if (offer.condition.type === 'cart' || offer.promo_code) {\n          return true\n        }\n        if (itemList && itemList.length) {\n          const anyProductBelongsToOffer = _.some(itemList, item => {\n            let inRewards\n            const inConditions = _.find(offer.condition.products.products, {\n              id: item.store_product.id,\n            })\n\n            if (offer.reward.products) {\n              inRewards = _.find(offer.reward.products.products, { id: item.store_product.id })\n            } else {\n              inRewards = false\n            }\n            return inConditions || inRewards\n          })\n          return (\n            anyProductBelongsToOffer &&\n            offer.offer_progress &&\n            (offer.offer_progress.condition.current_value || offer.offer_progress.completion_count)\n          )\n        }\n        return (\n          offer.offer_progress &&\n          offer.offer_progress.condition &&\n          (offer.offer_progress.condition.current_value > 0 ||\n            offer.offer_progress.completion_count > 0)\n        )\n      })\n    }\n  })\n\n  .filter('secondsToHoursMins', function () {\n    return function (\n      seconds,\n      { shortenWords = false, toDateTime = false, allowSubMinuteTime = false } = {}\n    ) {\n      // Round up the time to 1 minute if !allowSubMinuteTime\n      if (!allowSubMinuteTime && seconds < 60) {\n        seconds = 60\n      }\n\n      const hours = Math.floor(seconds / 3600)\n      const minutes = Math.floor((seconds % 3600) / 60)\n\n      if (toDateTime) {\n        const hoursPhrase = hours > 0 ? `${hours}H` : ''\n        const minutesPhrase = minutes > 0 || (minutes === 0 && hours === 0) ? `${minutes}M` : ''\n\n        return `PT${hoursPhrase}${minutesPhrase}`\n      }\n      const hoursWord = shortenWords ? 'hr' : `hour${hours === 1 ? '' : 's'}`\n      const minutesWord = shortenWords ? 'm' : `min${minutes === 1 ? '' : 's'}`\n\n      const hoursPhrase = hours > 0 ? `${hours} ${hoursWord}` : ''\n      const minutesPhrase =\n        minutes > 0 || (minutes === 0 && hours === 0) ? `${minutes} ${minutesWord}` : ''\n\n      return `${hoursPhrase}${hoursPhrase && minutesPhrase ? ' ' : ''}${minutesPhrase}`\n    }\n  })\n\n  .filter('telephone', function () {\n    return function (input) {\n      let number = input || ''\n\n      number = number.trim().replace(/[-\\s()]/g, '')\n\n      if (number.length === 9 || number.length === 10) {\n        const local = [number.substr(0, 3), number.substr(3, 3), number.substr(6)].join('-')\n\n        return local\n      }\n\n      return number\n    }\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('FixedToBodyComponentModule', [])\n  .directive('fixedToBody', function ($document, mobileService) {\n    return function (scope, element, attrs) {\n      if (mobileService.isMobile || attrs.fixedToBody === 'desktop') {\n        element[0].parentNode.removeChild(element[0])\n        $document[0].body.appendChild(element[0])\n\n        scope.$on('$destroy', () => {\n          element.remove()\n        })\n      }\n    }\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('FocusFirstInputComponentModule', [])\n  .directive('focusFirstInput', function () {\n    return {\n      restrict: 'A',\n      link: (scope, el) => {\n        // Use evalAsync in case first input is wrapped by ng-if\n        scope.$evalAsync(() => {\n          const inputs = el.find('input')\n          if (inputs.length) {\n            inputs[0].focus()\n          }\n        })\n      },\n    }\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('ForgotPasswordButtonComponentModule', [])\n  .component('forgotPasswordButton', {\n    bindings: {\n      setViewFn: '&',\n    },\n    controller(config, lang) {\n      this.config = config\n      this.lang = lang\n    },\n    template: `\n      <button\n        type=\"button\"\n        ng-if=\":: !$ctrl.config.externalForgotPasswordHref\"\n        ng-click=\"$ctrl.setViewFn()\"\n        id=\"login-forgot\" class=\"link\" analytics-click=\"['login forgot password button', 'click']\">\n        {{::$ctrl.lang.values.forgotYourPassword}}\n      </button>\n      <a\n        ng-if=\":: $ctrl.config.externalForgotPasswordHref\"\n        href={{::$ctrl.config.externalForgotPasswordHref}}\n        id=\"login-forgot\" class=\"link\" analytics-click=\"['login forgot password button', 'click']\">\n        {{::$ctrl.lang.values.forgotYourPassword}}\n      </a>\n    `,\n  })\n","import angular from 'angular'\nimport dayjs from 'dayjs'\n\nexport default angular\n  .module('FormattedBirthdayComponentModule', [])\n  .directive('formattedBirthday', function () {\n    return {\n      restrict: 'A',\n      require: 'ngModel',\n      link(scope, el, attrs, modelCtrl) {\n        modelCtrl.$parsers.push(birthday => {\n          const format = attrs.format || 'MM/DD/YYYY'\n          const obj = dayjs(birthday)\n          let newBirthday = birthday\n\n          if (obj.isValid()) {\n            newBirthday = obj.format(format)\n          }\n\n          modelCtrl.$setViewValue(newBirthday)\n          modelCtrl.$commitViewValue()\n          if (newBirthday !== birthday) {\n            modelCtrl.$render()\n          }\n          return birthday\n        })\n      },\n    }\n  })\n","import angular from 'angular'\n\nexport default angular.module('HelpComponentModule', []).directive('help', function () {\n  return {\n    scope: {\n      descriptionId: '@',\n      help: '=',\n    },\n    transclude: true,\n    template:\n      '<div class=\"help-content\" ng-bind-html=\"help\" id=\"{{descriptionId}}\" role=\"tooltip\"></div>',\n    link: (scope, el) => {\n      // Add keyboard focus for accessibility\n      el.on('keyup focus', event => {\n        if (event.which === 9) {\n          el[0].focus()\n        }\n      })\n    },\n  }\n})\n","// Allow including templates that may or may not exist\n\nimport angular from 'angular'\n\nexport default angular\n  .module('IncludeIfComponentModule', [])\n  .directive('includeIfExists', function ($compile, $templateCache, config) {\n    return {\n      restrict: 'A',\n      scope: {\n        includeIfExists: '=',\n        ngModel: '=',\n      },\n      link(scope, el) {\n        scope.config = config\n        scope.parent = scope.$parent\n        if ($templateCache.get(scope.includeIfExists)) {\n          el.attr('ng-include', `'${scope.includeIfExists}'`)\n          el.removeAttr('include-if-exists')\n          $compile(el)(scope)\n        }\n      },\n    }\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('IncludeReplaceComponentModule', [])\n  .directive('includeReplace', function () {\n    return {\n      require: 'ngInclude',\n      restrict: 'A' /* optional */,\n      link(scope, el) {\n        el.replaceWith(el.children())\n      },\n    }\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('InvalidFocusComponentModule', [])\n  .directive('invalidFocus', function () {\n    return {\n      restrict: 'A',\n      link: (scope, el) => {\n        scope.directiveScope = scope.invalidFocusFn || {}\n        scope.directiveScope.goToFocus = elementSelector => {\n          const focusElement = el[0].querySelector(elementSelector)\n          if (focusElement) {\n            focusElement.focus()\n          }\n        }\n      },\n    }\n  })\n","// Sets an \"invalid\" classname to the label of an invalid input\n\nimport angular from 'angular'\n\nexport default angular.module('LabelComponentModule', []).directive('label', $timeout => {\n  return {\n    restrict: 'E',\n    link: function labelLink(_scope, labelElement, attrs) {\n      if (attrs.for) {\n        const inputElement = document.getElementById(attrs.for)\n        if (inputElement && inputElement.validity) {\n          const updateLabel = () => {\n            if (inputElement.required) {\n              labelElement.addClass('ng-required')\n            } else {\n              labelElement.removeClass('ng-required')\n            }\n          }\n\n          $timeout(updateLabel, 0) // Wait for the rest of the DOM to populate\n        }\n      }\n    },\n  }\n})\n","// Override the default ui-bootstrap modal template to add closing when\n// clicking the container\n\nimport angular from 'angular'\n\nexport default angular\n  .module('uib/template/modal/window.html', [])\n  .run([\n    '$templateCache',\n    'lang',\n    $templateCache =>\n      $templateCache.put('uib/template/modal/window.html', require('./modalTemplate.html')),\n  ])\n","import angular from 'angular'\n\nexport default angular\n  .module('noApplyClickComponentModule', [])\n  .directive('noApplyClick', $parse => {\n    return {\n      compile($element, attr) {\n        const fn = $parse(attr.noApplyClick)\n        return function (scope, element) {\n          element.on('click', e => {\n            fn(scope, { $event: e, $element: element })\n          })\n        }\n      },\n    }\n  })\n","import angular from 'angular'\n\nexport default angular.module('noticeModalComponentModule', []).component('noticeModal', {\n  bindings: {\n    browserWarning: '<',\n  },\n  transclude: true,\n  controller(localStorageService) {\n    const vm = this\n\n    vm.dismissModal = () => {\n      vm.modalIsDismissed = true\n    }\n\n    vm.dismissBrowserWarning = () => {\n      localStorageService.deprecatedSet('ieBrowserWarningSeen', true)\n      vm.dismissModal()\n    }\n  },\n  template: `\n      <div ng-if=\"!$ctrl.modalIsDismissed\" class=\"notice-modal\">\n        <div class=\"message info\">\n          <button class=\"button smaller darker round icon-delete\" ng-click=\"$ctrl.dismissModal()\" ng-if=\"!$ctrl.browserWarning\" aria-label=\"{{::lang.aria.modalClose}}\"></button>\n          <ng-transclude></ng-transclude>\n          <span role=\"button\" class=\"dismiss-text\" ng-if=\"$ctrl.browserWarning\" ng-click=\"$ctrl.dismissBrowserWarning()\"><button>Dismiss</button></span>\n        </div>\n      </div>\n    `,\n})\n","import angular from 'angular'\n\nexport default angular\n  .module('titleServiceComponentModule', [])\n  .service('titleService', function ($q, $rootScope, config) {\n    const service = this\n    const configTitle = config.lang.titleTagDescription || config.lang.clientName\n    const separator = ' | '\n\n    // A promise to keep track of cases where the title is set asynchronously\n    $rootScope.$on('$locationChangeSuccess', () => {\n      if ($rootScope.titlePromise && $rootScope.titlePromise.promise.$$state.status > 0) {\n        $rootScope.titlePromise = $q.defer()\n      }\n    })\n\n    service.setTitle = function (title) {\n      if (title && title.length) {\n        $rootScope.title = title + separator + configTitle\n      } else {\n        $rootScope.title = configTitle\n      }\n\n      $rootScope.titlePromise.resolve()\n      window.document.title = $rootScope.title\n\n      return $rootScope.title\n    }\n\n    service.resetTitle = function () {\n      $rootScope.title = configTitle\n      $rootScope.titlePromise.resolve()\n      window.document.title = $rootScope.title\n    }\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('PlaceholderImageModule', [])\n  .service('placeholderImageService', function placeholderImageService(utilService) {\n    const service = this\n\n    service.getImagePath = {\n      nonImage: null,\n      productCell: utilService.loadStaticImage('emt-product-cell-img.svg'),\n      productDetails: utilService.loadStaticImage('emt-blocks-img.svg'),\n    }\n  })\n  .component('placeholderImage', {\n    bindings: {\n      type: '@',\n      removeOn: '<',\n      showMax: '@?',\n    },\n    controller($interval, placeholderImageService) {\n      const vm = this\n      const showMaxPlaceholders = parseInt(vm.showMax, 10) || 1\n\n      vm.placeholderSkeleton = [{}]\n      vm.placeholderImage = placeholderImageService.getImagePath[vm.type]\n\n      if (showMaxPlaceholders > 1) {\n        const loadingInt = $interval(() => {\n          if (vm.removeOn || vm.placeholderSkeleton.length >= showMaxPlaceholders) {\n            $interval.cancel(loadingInt)\n          } else {\n            vm.placeholderSkeleton.push({})\n          }\n        }, 500)\n      }\n    },\n    template: `\n    <div ng-if=\"!$ctrl.removeOn\" class=\"loading-shimmer\">\n      <span ng-if=\"::!$ctrl.placeholderImage\">Loading...</span>\n      <img ng-if=\"::$ctrl.placeholderImage\" ng-src=\"{{::$ctrl.placeholderImage}}\" ng-repeat=\"cell in $ctrl.placeholderSkeleton\" alt=\"Loading Image\"/>\n    </div>\n  `,\n  })\n","import angular from 'angular'\nimport { angularIsReactRoute } from '@app/react/routes'\n\nexport default angular\n  .module('ReactStorefrontBuilderModule', [])\n  .directive('reactStorefrontBuilder', function () {\n    // react-storefront-builder is used to determine where to append element\n    // (attrs.reactStorefrontBuilder)\n    return function (scope, element, attrs) {\n      // TODO: when we make homepage composable for everyone, remove this condition\n      if (angularIsReactRoute()) {\n        element[0].parentNode.removeChild(element[0])\n        document.getElementById(attrs.reactStorefrontBuilder)?.appendChild(element[0])\n\n        scope.$on('$destroy', () => {\n          element.remove()\n        })\n      }\n    }\n  })\n","// Helper for keyboard a11y such that focus returns to invoking element\n//\n\nimport angular from 'angular'\nimport { CONTENT_ELEMENT } from '@app/angular/constants/elementSelectors'\n\nexport default angular\n  .module('refocusComponentModule', [])\n  .directive('refocus', (mobileNavService, refocusService) => ({\n    link: (scope, el) => {\n      scope.refocusService = refocusService\n\n      el.on('click', event => {\n        // \"Save\" last clicked element with the `refocus` directive attached\n        refocusService.refocusElement = event.target\n      })\n\n      scope.$watch('refocusService.triggerRefocus', newVal => {\n        const isSlideOutMenuItem = document\n          .querySelector('#mobile-side-nav')\n          ?.contains(refocusService.refocusElement)\n\n        if (newVal === true) {\n          // Open slide-out menu if it is currently closed\n          if (isSlideOutMenuItem && mobileNavService.slideOutMenuIsVisible === false) {\n            mobileNavService.showSlideOutMenu()\n          }\n\n          // refocus on last clicked element then reset triggers and refocus element\n          refocusService.refocusElement.focus()\n          refocusService.triggerRefocus = false\n          refocusService.refocusElement = document.querySelector(CONTENT_ELEMENT)\n        }\n      })\n    },\n  }))\n  .service('refocusService', function refocusService() {\n    const service = this\n\n    service.refocusElement = document.querySelector(CONTENT_ELEMENT)\n    service.triggerRefocus = false\n\n    // Method used to initialize `modal.closing` listener in controller scope\n    service.setRefocusTrigger = scope =>\n      scope.$on('modal.closing', () => {\n        service.triggerRefocus = true\n      })\n  })\n","export const CONTENT_ELEMENT = '[ui-view=\"content\"]'\n","// Require users to be registered before allowing links / buttons to be clicked\n\nimport angular from 'angular'\n\nexport default angular\n  .module('requireRegisteredUserComponentModule', [])\n  .directive('requireRegisteredUser', function ($location, $state, auth, registrationService) {\n    return {\n      restrict: 'A',\n      priority: 1,\n      link(scope, el, attrs) {\n        el.on('click', e => {\n          // If user is not registered, prevent links from firing\n          // then prompt them to register, continuing to their intended\n          // destination afterward\n\n          if (auth.user.status === 'trial') {\n            e.preventDefault()\n            e.stopPropagation()\n            registrationService.open('login').then(() => {\n              if (attrs.uiSref) {\n                $state.go(attrs.uiSref)\n              } else if (attrs.href) {\n                $location.path(attrs.href)\n              }\n            })\n          } else {\n            // Perform some action on click if user is registered\n\n            // eslint-disable-next-line no-lonely-if\n            if (attrs.ifRegistered) {\n              scope.$apply(scope.$eval(attrs.ifRegistered))\n            }\n          }\n        })\n      },\n    }\n  })\n","// Runs run-on-enter when enter key is pressed.\n\nimport angular from 'angular'\n\nexport default angular.module('runOnEnterComponentModule', []).directive('runOnEnter', function () {\n  return {\n    restrict: 'A',\n    link(scope, el, attrs) {\n      el.bind('keypress', event => {\n        if (event.which === 13) {\n          scope.$apply(() => {\n            scope.$eval(attrs.runOnEnter)\n          })\n        }\n      })\n    },\n  }\n})\n","// Removes any attribute name passed into a scoped array via `sanitize-uib` variable.\n// Due to our use of `angular-ui-bootstrap`, we unfortunately need to \"hijack\" some of\n// the default functionality of its `dropdown` plugin, which manifests by\n// uibDropdown having a default scope watcher for `isOpen` that sets `aria-expanded`.\n// Along with `aria-haspopup`, it must be removed for a11y reasons. The addToList component\n// will pass ['aria-haspopup','aria-expanded'] which gets removed by this directive\n\nimport angular from 'angular'\n\nexport default angular.module('SanitizeUibModule', []).directive('sanitizeUib', function () {\n  return {\n    scope: {\n      sanitizeUib: '=',\n    },\n    require: '?^uibDropdown',\n    link: (scope, el, attr, dropdownCtrl) => {\n      const removeAttributes = () =>\n        scope.sanitizeUib.forEach(attribute => {\n          el[0].removeAttribute(attribute)\n        })\n\n      scope.$watch(dropdownCtrl.isOpen, () => removeAttributes())\n    },\n  }\n})\n","import angular from 'angular'\nimport { CONTENT_ELEMENT } from '@app/angular/constants/elementSelectors'\n\nexport default angular\n  .module('scrollIntoViewComponentModule', [])\n  .directive('scrollIntoView', function ($document, $timeout, utilService) {\n    // Set the css selectors for the container that the scroll will happen within and the target element to be scrolled to\n    // Scroll container if not set will default to the content view and targetelement the element the directive is called in.\n\n    return function (_scope, element, attrs) {\n      $timeout(() => {\n        const targetElement = attrs.targetElement\n          ? document.querySelector(attrs.targetElement)\n          : element[0]\n        const scrollContainer = attrs.scrollContainer || CONTENT_ELEMENT\n        utilService.scrollIntoView(targetElement, scrollContainer)\n      }, 0)\n    }\n  })\n","import _ from 'lodash'\nimport angular from 'angular'\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\nimport { MOBILE_HEADER_CLICKED } from '@app/angular/constants/navigation'\n\nimport template from './sideCartSubMenu.html'\n\nexport default angular\n  .module('unataSideCartSubMenuComponentModule', [])\n  .component('unataSideCartSubMenu', {\n    bindings: {\n      sortList: '&',\n      currentSortType: '<',\n      emptyList: '&',\n      showNotesSubstitutions: '=',\n      sortedCategories: '<',\n      sortedProducts: '<',\n      uncheckAllItems: '&',\n      deleteCheckedItems: '&',\n      checkedItemsCount: '<',\n    },\n    controller(\n      $rootScope,\n      $scope,\n      $state,\n      $attrs,\n      $timeout,\n      auth,\n      cartService,\n      config,\n      lang,\n      mobileService\n    ) {\n      this.$onInit = () => {\n        // Close the dropdown menu when clicking on the mobile header (currently not covered by the menu backdrop)\n        this.mobileHeaderClickDeregister = $rootScope.$on(\n          MOBILE_HEADER_CLICKED,\n          () => (this.isMenuOpen = false)\n        )\n      }\n      this.$onDestroy = () => {\n        this.mobileHeaderClickDeregister()\n      }\n\n      this.mobileService = mobileService\n      this.lang = lang\n      this.auth = auth\n      this.cartService = cartService\n      this.config = config\n\n      this.isMenuOpen = false\n      this.menuOpenedBy = undefined\n\n      this.menuConfig =\n        this.auth.getContext().intent === SHOPPING_MODES.INSTORE_LIST\n          ? this.config.userList\n          : this.config.cartReview\n\n      this.inShoppingList =\n        $state.current.name === 'main.inStoreList.review' || $state.current.name === 'offlineList'\n      this.inShoppingListContext = this.auth?.getContext()?.intent === SHOPPING_MODES.INSTORE_LIST\n      this.inInstoreListPage = $state.current.name === 'main.sideCart' || this.inShoppingList\n\n      this.inCheckoutCartPage = $state.current.name === 'main.checkout.cart'\n\n      this.toggleMenu = () => {\n        this.isMenuOpen = !this.isMenuOpen\n\n        if (this.isMenuOpen) {\n          this.menuOpenedBy = document.activeElement\n          $timeout(() => {\n            document.querySelector('.side-sub-menu-close-button')?.focus()\n          })\n        }\n\n        // a11y: Re-focus on the element that opened the dialog\n        if (!this.isMenuOpen && this.menuOpenedBy) {\n          this.menuOpenedBy.focus()\n        }\n      }\n\n      this.triggerSortModal = () => {\n        this.sortList()\n      }\n\n      this.toggleShowNotesSubs = () => {\n        this.showNotesSubstitutions = !this.showNotesSubstitutions\n      }\n\n      if (this.cartService.cart) {\n        this.getCustomItems = () =>\n          _.filter(this.cartService.cart.items, { item_type: 'pseudo_product' })\n      }\n    },\n    template,\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('stickyComponentModule', [])\n\n  // Directive controlling the sticky header\n  // Note: You can listen for the broadcast of the UI events for navStick and navUnStick\n\n  .directive('sticky', $document => {\n    const $$document = angular.element(document)\n\n    return function (scope, el, attrs) {\n      let elTop\n      let stuck\n      // eslint-disable-next-line radix\n      const offset = attrs.offset ? parseInt(attrs.offset) : 0\n\n      // If sticky-check-callback is defined, it will call the specified function name on the\n      // scope, allowing for custom action as the body is scrolled\n      const callback =\n        typeof scope[attrs.stickyCheckCallback] === 'function' && scope[attrs.stickyCheckCallback]\n\n      function shouldStick() {\n        const docTop = $$document[0].documentElement.scrollTop || $$document[0].body.scrollTop\n        // If elTop is undefined or 0 the element will never come unstuck, explicitly set it &\n        // return false to start the loop\n        if (elTop === undefined || elTop === 0) {\n          elTop = docTop + el[0].getBoundingClientRect().top\n          return false\n        }\n\n        if (stuck) {\n          return docTop >= elTop - offset\n        }\n        const newTop = el[0].getBoundingClientRect().top\n        elTop = docTop + newTop\n        return newTop <= offset\n      }\n\n      function stick() {\n        if (!stuck) {\n          stuck = true\n          el.addClass('sticky')\n          el.removeClass('un-sticky')\n\n          if (attrs.bodyClass) {\n            angular.element($document[0].body).addClass(attrs.bodyClass)\n            angular.element($$document[0].body).addClass(`unata-${attrs.bodyClass}`)\n          }\n        }\n      }\n\n      function unstick() {\n        if (stuck) {\n          stuck = false\n          el.removeClass('sticky')\n          el.addClass('un-sticky')\n\n          if (attrs.bodyClass) {\n            angular.element($document[0].body).removeClass(attrs.bodyClass)\n            angular.element($$document[0].body).removeClass(`unata-${attrs.bodyClass}`)\n          }\n        }\n      }\n\n      function check() {\n        // Prevent items from remaining stuck if the window is resized\n        if (attrs.minWidth && window.innerWidth <= attrs.minWidth) {\n          unstick()\n        }\n\n        if (!attrs.minWidth || window.innerWidth >= attrs.minWidth) {\n          // Allow disabling below a certain screen width\n          if (shouldStick()) {\n            stick()\n          } else {\n            unstick()\n          }\n        }\n\n        if (callback) callback(el)\n      }\n\n      scope.$on('$destroy', () => {\n        unstick()\n        $$document.off('scroll', check)\n        $$document.off('wheel', check)\n      })\n\n      $$document.on('scroll', check)\n      $$document.on('wheel', check)\n\n      check()\n    }\n  })\n","// Detects if user tabbed into element\n\nimport angular from 'angular'\n\nexport default angular.module('tabEnterComponentModule', []).directive('tabEnter', $timeout => {\n  return {\n    scope: {\n      tabEnter: '=',\n      tabEnterFn: '&',\n      tabExitFn: '&',\n    },\n    restrict: 'A',\n    link(scope, el, attrs) {\n      el.on('keyup focus', event => {\n        if (event.which === 9) {\n          scope.tabEnter = true\n          scope.$apply()\n          if (angular.isDefined(attrs.tabEnterFn)) {\n            scope.tabEnterFn(event)\n          }\n        }\n      })\n\n      el.on('keydown blur', event => {\n        if (event.which === 9) {\n          scope.tabEnter = false\n          scope.$apply()\n\n          // timeout required because jqLite does not offer event delegation, so the event does not bubble up to grandparent element\n          // As such, this acts as a debounce\n          $timeout(() => {\n            if (angular.isDefined(attrs.tabExitFn) && scope.tabEnter === false) {\n              scope.tabExitFn(event)\n            }\n          }, 100)\n        }\n      })\n    },\n  }\n})\n","// Helper for a11y tabs such that they can be controlled\n// properly by keyboard users using arrow keys\n\nimport angular from 'angular'\n\nexport default angular\n  .module('TabsKeyboardControlModule', [])\n  .directive('tabsKeyboardControl', () => ({\n    link: (scope, el) => {\n      const KEYS = {\n        left: 37,\n        right: 39,\n      }\n\n      const setTabIndex = () => {\n        el[0].querySelectorAll('button[aria-selected=\"false\"]').forEach(unselectedButton => {\n          // give unselected buttons tabindex=-1 so user cannot tab into them\n          unselectedButton.setAttribute('tabindex', -1)\n        })\n\n        // remove tabindex from selected tab so it can be entered with the tab key\n        el[0].querySelector('button[aria-selected=\"true\"]').removeAttribute('tabindex')\n      }\n\n      el.on('keydown', e => {\n        const keyPress = e.keyCode\n\n        setTabIndex()\n\n        switch (keyPress) {\n          case KEYS.left:\n            e.preventDefault()\n            e.target.previousElementSibling.focus()\n            break\n          case KEYS.right:\n            e.preventDefault()\n            e.target.nextElementSibling.focus()\n            break\n        }\n      })\n    },\n  }))\n","// Helper for keyboard a11y such that toggling focus for keyboard-only users\n// is contained within the target node/element\n\nimport angular from 'angular'\n\nexport default angular\n  .module('trapFocusComponentModule', [])\n  .directive('trapFocus', ($timeout, utilService) => ({\n    link: (scope, element) => {\n      $timeout(() => {\n        const targetElement = element ? element[0] : null\n        const isNativeElement = targetElement ? !!targetElement.addEventListener : false\n        if (isNativeElement) {\n          const trapFocusOff = utilService.trapFocusOn(targetElement, true)\n          element.on('$destroy', () => {\n            trapFocusOff()\n          })\n        }\n      }, 0)\n    },\n  }))\n","// Updates the model of the form element when enter is pressed\n// and removes focus.\n\nimport angular from 'angular'\n\nexport default angular\n  .module('uibModalAriaLabelComponentModule', [])\n  .service('uibModalAriaLabelService', function () {\n    const service = this\n\n    service.ariaLabel = ''\n\n    service.setLabel = ariaLabel => {\n      const topModalEl = document.querySelectorAll('[uib-modal-aria-label]')[0]\n\n      service.resetLabel()\n      service.ariaLabel = ariaLabel\n\n      // Hack: Unfortunately, due to $uibModal, this is necessary because the plugin instantiates outside of our controllable scope\n      // This checks to see if the modal already exists and sets aria-label if true, otherwise rely on directive to automatically set on init\n      if (topModalEl) {\n        topModalEl.setAttribute('aria-label', service.ariaLabel)\n      }\n\n      return service.ariaLabel\n    }\n\n    service.resetLabel = () => {\n      service.ariaLabel = ''\n    }\n  })\n  .directive('uibModalAriaLabel', function (uibModalAriaLabelService) {\n    return {\n      restrict: 'A',\n      link(scope, el) {\n        el[0].setAttribute('aria-label', uibModalAriaLabelService.ariaLabel)\n\n        // Reset saved aria label to empty string after setting so it does not carry over to the next modal initialization\n        uibModalAriaLabelService.resetLabel()\n      },\n    }\n  })\n","// Updates the model of the form element when enter is pressed\n// and removes focus.\n\nimport angular from 'angular'\n\nexport default angular\n  .module('updateOnEnterComponentModule', [])\n  .directive('updateOnEnter', function () {\n    return {\n      restrict: 'A',\n      link(scope, el) {\n        el.bind('keydown keypress', event => {\n          if (event.which === 13) {\n            scope.$apply()\n            el[0].blur()\n          }\n        })\n      },\n    }\n  })\n","import angular from 'angular'\nimport BgImgFade from './bgImgFade'\nimport BindHtmlCompile from './bindHtmlCompile'\nimport Compile from './compile'\nimport Disable from './disable'\nimport ElementInView from './elementInView'\nimport ElementMatchesPolyfill from './elementMatchesPolyfill'\nimport FallbackSrc from './fallbackSrc'\nimport FeaturedHeader from './featuredHeader.component'\nimport FileUploader from './fileUploader'\nimport Filters from './filters'\nimport FixedToBody from './fixedToBody'\nimport FocusFirstInput from './focusFirstInput'\nimport ForgotPasswordButton from './forgotPasswordButton'\nimport FormattedBirthday from './formattedBirthday'\nimport Help from './help'\nimport IncludeIfExists from './includeIfExists'\nimport IncludeReplace from './includeReplace'\nimport InvalidFocus from './invalidFocus'\nimport Label from './label'\nimport ModalTemplate from './modalTemplate'\nimport NoApplyClick from './noApplyClick'\nimport NoticeModal from './noticeModal'\nimport PageTitle from './pageTitle'\nimport PlaceholderImage from './placeholderImage'\nimport ReactStorefrontBuilder from './reactStorefrontBuilder'\nimport Refocus from './refocus'\nimport RequireRegisteredUser from './requireRegisteredUser'\nimport RunOnEnter from './runOnEnter'\nimport SanitizeUib from './sanitizeUib'\nimport ScrollIntoView from './scrollIntoView'\nimport SideCartSubMenu from './sideCartSubMenu'\nimport Sticky from './sticky'\nimport TabEnter from './tabEnter'\nimport TabsKeyboardControl from './tabsKeyboardControl'\nimport TrapFocus from './trapFocus'\nimport UibModalAriaLabel from './uibModalAriaLabel'\nimport UpdateOnEnter from './updateOnEnter'\n\nexport default angular.module('app.shared.util', [\n  BgImgFade.name,\n  BindHtmlCompile.name,\n  Compile.name,\n  Disable.name,\n  ElementInView.name,\n  ElementMatchesPolyfill.name,\n  FallbackSrc.name,\n  FeaturedHeader.name,\n  FileUploader.name,\n  Filters.name,\n  FixedToBody.name,\n  FocusFirstInput.name,\n  ForgotPasswordButton.name,\n  FormattedBirthday.name,\n  Help.name,\n  IncludeIfExists.name,\n  IncludeReplace.name,\n  InvalidFocus.name,\n  Label.name,\n  ModalTemplate.name,\n  NoApplyClick.name,\n  NoticeModal.name,\n  PageTitle.name,\n  PlaceholderImage.name,\n  ReactStorefrontBuilder.name,\n  Refocus.name,\n  RequireRegisteredUser.name,\n  RunOnEnter.name,\n  SanitizeUib.name,\n  ScrollIntoView.name,\n  SideCartSubMenu.name,\n  Sticky.name,\n  TabEnter.name,\n  TabsKeyboardControl.name,\n  TrapFocus.name,\n  UibModalAriaLabel.name,\n  UpdateOnEnter.name,\n])\n","import _ from 'lodash'\nimport angular from 'angular'\nimport urlParser from '@app/utils/urlParser'\nimport template from './videoModal.html'\n\nexport default angular\n  .module('videoModalServiceComponentModule', [])\n\n  // Service to provide access to launching the modal dialog\n\n  .service('videoModalService', function videoModalService($uibModal) {\n    const videoSites = [\n      'youtube.com/watch',\n      'youtube.com/embed/',\n      'youtube.com/v/',\n      'youtube.com/e/',\n      'youtu.be',\n      'vimeo.com',\n    ]\n\n    this.isVideoURL = function (url) {\n      return _.some(videoSites, _.includes.bind(_, url))\n    }\n\n    function convertToEmbedURL(url) {\n      const urlParts = urlParser(url)\n      const query = new URLSearchParams(urlParts.search)\n      const lastPathSegment = urlParts.pathname.slice(urlParts.pathname.lastIndexOf('/') + 1)\n\n      switch (urlParts.hostname) {\n        case 'www.youtube.com':\n        case 'youtube.com':\n        case 'youtu.be':\n          return `https://www.youtube.com/embed/${query.get('v') || lastPathSegment}?autoplay=1`\n\n        case 'vimeo.com':\n          return `https://player.vimeo.com/video/${lastPathSegment}?autoplay=1`\n      }\n      return url\n    }\n\n    this.open = function (url) {\n      const modal = $uibModal.open({\n        template,\n        controller: [\n          '$scope',\n          '$sce',\n          function ($scope, $sce) {\n            $scope.src = $sce.trustAsResourceUrl(convertToEmbedURL(url))\n          },\n        ],\n        backdrop: 'static',\n        windowClass: 'no-scroll',\n      })\n\n      return modal\n    }\n  })\n\n  .run(($document, videoModalService) => {\n    // Intercept all link clicks, and if the link is to a video hosting site, open video in is modal dialog instead.\n    $document.on('click', e => {\n      const target = e.target || e.srcElement\n      if (target.tagName === 'A' && target.target !== '_blank') {\n        const href = target.getAttribute('href')\n\n        if (videoModalService.isVideoURL(href)) {\n          e.preventDefault()\n          videoModalService.open(href)\n        }\n      }\n    })\n  })\n","import angular from 'angular'\nimport VideoModal from './videoModal.js'\n\nexport default angular.module('app.shared.videoModal', [VideoModal.name])\n","import angular from 'angular'\n\nimport AddressAutocompleteInput from './addressAutocomplete'\nimport AddressList from './addressList'\nimport AddressListForm from './addressListForm'\nimport AddToCartButton from './addToCartButton'\nimport AddToList from './addToList'\nimport AutoFocus from './autoFocus'\nimport BannerImage from './bannerImage'\nimport BannerForm from './bannerForm'\nimport BannerTags from './bannerTags'\nimport BillingInformationForm from './billingInformationForm'\nimport BarcodeScannerButton from './barcodeScannerButton'\nimport CategoryCard from './categoryCard'\nimport CartCompareDialog from './cartCompareDialog'\nimport CartForm from './cartForm'\nimport CartSummary from './cartSummary'\nimport Cell from './cell'\nimport CellSlider from './cellSlider'\nimport CollectionModal from './collectionModal'\nimport ContactForm from './contactForm'\nimport ContinuityOfferCell from './continuityOfferCell'\nimport CouponClipper from './couponClipper'\nimport CouponUnclippedModal from './couponUnclippedModal'\nimport CreditCardLogos from './creditCardLogos'\nimport DeliveryForm from './deliveryForm'\nimport DeliveryZipCode from './deliveryZipCode'\nimport EmptyResultsContextSwitcher from './emptyResultsContextSwitcher'\nimport ErrorModal from './errorModal'\nimport FacetedFilterModal from './facetedFilterModal'\nimport FacetedSearchBar from './facetedSearchBar'\nimport FacetedSearchCategories from './facetedSearchCategories'\nimport FacetedSideFilters from './facetedSideFilters'\nimport FilterModal from './filterModal'\nimport Filters from './filters'\nimport GiftCardModal from './giftCardModal'\nimport ImageCell from './imageCell'\nimport InvalidCartItemsDisplay from './invalidCartItemsDisplay'\nimport LightBox from './lightBox'\nimport LoadingDots from './loadingDots'\nimport LoyaltyCard from './loyaltyCard'\nimport LoyaltyInfo from './loyaltyInfo'\nimport LoyaltyOptInPlacement from './loyaltyOptInPlacement'\nimport LoyaltyPlacement from './loyaltyPlacement'\nimport MobileAppPromotionBanner from './mobileAppPromotionBanner'\nimport ModifyQuantity from './modifyQuantity'\nimport NotificationSettings from './notificationSettings'\nimport NutritionTable from './nutritionTable'\nimport OfferCell from './offerCell'\nimport OfferDetailsModal from './offerDetailsModal'\nimport Offers from './offers'\nimport OrderDeliveryInstructionsForm from './orderDeliveryInstructionsForm'\nimport Overlay from './overlay'\nimport PageHeader from './pageHeader'\nimport PaymentForm from './paymentForm'\nimport PhoneInput from './phoneInput'\nimport PickForm from './pickupForm'\nimport PreferredPhoneNumberSelect from './preferredPhoneNumberSelect'\nimport PreventAllScrolling from './preventAllScrolling'\nimport PriceAlertButton from './priceAlertButton'\nimport ProductCell from './productCell'\nimport ProductComments from './productComments'\nimport ProductCommentsV2 from './productCommentsV2'\nimport ProductDetailsModal from './productDetailsModal'\nimport ProductPoints from './productPoints'\nimport ProductPrices from './productPrices'\nimport ProgressIndicator from './progressIndicator'\nimport PromoCodeModal from './promoCodeModal'\nimport PromoCollectionCell from './promoCollectionCell'\nimport ProvinceSelect from './provinceSelect'\nimport Quickshop from './quickshop'\nimport Rating from './rating'\nimport Recaptcha from './recaptcha'\nimport RecipeCell from './recipeCell'\nimport RelatedCoupon from './relatedCoupon'\nimport RelatedProduct from './relatedProduct'\nimport ScheduleForm from './scheduleForm'\nimport SharedForgotPassword from './sharedForgotPassword'\nimport ShareListButton from './shareListButton'\nimport ShopModalHeader from './shopModalHeader'\nimport SideCartSortModal from './sideCartSortModal'\nimport SimplifiedHeader from './simplifiedHeader'\nimport StoreList from './storeList'\nimport StoresMap from './storesMap'\nimport SubscriptionSelect from './subscriptionSelect'\nimport TagStyle from './tagStyle'\nimport TipPicker from './tipPicker'\nimport TipPickerModal from './tipPickerModal'\nimport Typeahead from './typeahead'\nimport UpdateCreditCard from './updateCreditCard'\nimport Util from './util'\nimport VideoModal from './videoModal'\n\nexport default angular.module('app.shared', [\n  AddressAutocompleteInput.name,\n  AddressList.name,\n  AddressListForm.name,\n  AddToCartButton.name,\n  AddToList.name,\n  AutoFocus.name,\n  BannerForm.name,\n  BannerImage.name,\n  BannerTags.name,\n  BarcodeScannerButton.name,\n  BillingInformationForm.name,\n  CategoryCard.name,\n  CartCompareDialog.name,\n  CartForm.name,\n  CartSummary.name,\n  Cell.name,\n  CellSlider.name,\n  CollectionModal.name,\n  ContactForm.name,\n  ContinuityOfferCell.name,\n  CouponClipper.name,\n  CouponUnclippedModal.name,\n  CreditCardLogos.name,\n  DeliveryForm.name,\n  DeliveryZipCode.name,\n  ErrorModal.name,\n  EmptyResultsContextSwitcher.name,\n  FacetedFilterModal.name,\n  FacetedSearchBar.name,\n  FacetedSearchCategories.name,\n  FacetedSideFilters.name,\n  FilterModal.name,\n  Filters.name,\n  GiftCardModal.name,\n  ImageCell.name,\n  InvalidCartItemsDisplay.name,\n  LightBox.name,\n  LoadingDots.name,\n  LoyaltyCard.name,\n  LoyaltyInfo.name,\n  LoyaltyOptInPlacement.name,\n  LoyaltyPlacement.name,\n  MobileAppPromotionBanner.name,\n  ModifyQuantity.name,\n  NotificationSettings.name,\n  NutritionTable.name,\n  OfferCell.name,\n  OfferDetailsModal.name,\n  Offers.name,\n  OrderDeliveryInstructionsForm.name,\n  Overlay.name,\n  PageHeader.name,\n  PaymentForm.name,\n  PhoneInput.name,\n  PickForm.name,\n  PreferredPhoneNumberSelect.name,\n  PreventAllScrolling.name,\n  PriceAlertButton.name,\n  ProductCell.name,\n  ProductComments.name,\n  ProductCommentsV2.name,\n  ProductDetailsModal.name,\n  ProductPoints.name,\n  ProductPrices.name,\n  ProgressIndicator.name,\n  PromoCodeModal.name,\n  PromoCollectionCell.name,\n  ProvinceSelect.name,\n  Quickshop.name,\n  Rating.name,\n  Recaptcha.name,\n  RecipeCell.name,\n  RelatedCoupon.name,\n  RelatedProduct.name,\n  ScheduleForm.name,\n  SharedForgotPassword.name,\n  ShareListButton.name,\n  ShopModalHeader.name,\n  SideCartSortModal.name,\n  SimplifiedHeader.name,\n  StoreList.name,\n  StoresMap.name,\n  SubscriptionSelect.name,\n  TagStyle.name,\n  TipPicker.name,\n  TipPickerModal.name,\n  Typeahead.name,\n  UpdateCreditCard.name,\n  Util.name,\n  VideoModal.name,\n])\n","import _ from 'lodash'\nimport angular from 'angular'\nimport * as catalogSelectors from '@app/services/catalog/selectors'\nimport { actions } from '@app/services/catalog/slice'\nimport * as thunks from '@app/services/catalog/thunks'\nimport { store as reduxStore } from '@app/services/store'\n\nexport default angular\n  .module('catalogCategoriesServiceComponentModule', [])\n  .service(\n    'catalogCategoriesService',\n    function catalogCategoriesService($filter, $ngRedux, $q, eComLightService, lang, tagsService) {\n      const service = this\n      let cachePromise\n\n      service.tags = []\n\n      const mapStateToService = state => {\n        const categories = catalogSelectors.categoriesSelector(state)\n\n        // Fetch a list of all unique tags present in category structure\n        categories.forEach(category => {\n          if (category && category.tags) {\n            category.tags.forEach(tag => {\n              if (service.tags.indexOf(tag) === -1) {\n                service.tags.push(tag)\n              }\n            })\n          }\n        })\n\n        return { categories }\n      }\n\n      $ngRedux.connect(mapStateToService, {\n        ...actions,\n      })(service)\n\n      service.fetch = function (refresh) {\n        const deferred = $q.defer()\n\n        if (!refresh && service.categories) {\n          deferred.resolve(service.categories)\n          return deferred.promise\n        }\n\n        reduxStore\n          .dispatch(thunks.fetchCategories())\n          .then(() => deferred.resolve(service.categories))\n          .then(() => {\n            if (eComLightService.eComLightCategory) {\n              const eComLightCategoryObj = service.categoryFromId(\n                eComLightService.eComLightCategory\n              )\n              eComLightService.setEComLightCategories(eComLightCategoryObj)\n            }\n          })\n          .finally(() => {\n            cachePromise = null\n          })\n\n        return deferred.promise\n      }\n\n      // If multiple fetch calls are made from different components, intercept them\n      // and send along the result of the promise already started.\n      service.fetchCategories = function (refresh) {\n        if (!refresh && cachePromise) {\n          return cachePromise\n        } else {\n          cachePromise = service.fetch(refresh)\n          return cachePromise\n        }\n      }\n\n      // Find / fetch all categories without a parent_id or featured department placements\n      // and construct a rootCategory object array that can be consumed by the rest of the\n      // frontend platform\n      service.rootCategories = function (featuredDepartmentPlacements) {\n        const findRootCategories = () => {\n          if (service.categories) {\n            return _.filter(service.categories, category => {\n              return !category.parent_id\n            })\n          } else {\n            service.fetchCategories().then(result => {\n              return _.filter(result, category => {\n                return !category.parent_id\n              })\n            })\n          }\n        }\n\n        const findFeaturedDepartments = () => {\n          if (service.categories && featuredDepartmentPlacements) {\n            return _.filter(featuredDepartmentPlacements, featured_department => {\n              return featured_department.id\n            })\n          }\n        }\n\n        // Build the root categories from featured departments + roots\n        const buildRoot = () => {\n          const rootCategories = findRootCategories()\n          const rootFeatured = findFeaturedDepartments() || []\n\n          // Provide the keys necessary for featured department placements to\n          // function identically to traditional categories\n          _.each(rootFeatured, featured => {\n            featured.state = 'main.shop.mlp'\n            featured.params = { mlp_id: featured.id }\n            featured.images = { tile: { medium: featured.media.image || '' } }\n            const slug = $filter('slugify')(featured.name)\n            featured.link = `shop/featured/${featured.id}/${slug}`\n            featured.sref = `main.shop.mlp({mlp_id: ${featured.id}, mlp_slug: ${JSON.stringify(\n              slug\n            )}, tags: null, page: null, brand_name: null, sort: null})`\n            featured.children = [\n              // Omit until we can test actual fetch performance, will be added in a future commit\n              // {\n              //   name: 'child',\n              //   state: 'main.shop.collections',\n              //   sref: 'main.shop.collections',\n              // },\n            ]\n          })\n\n          return rootFeatured.concat(rootCategories)\n        }\n\n        if (service.categories) {\n          return buildRoot()\n        } else {\n          service.fetchCategories().then(() => {\n            return buildRoot()\n          })\n        }\n      }\n\n      // Returns a list of root categories that should be visible, as permitted by eCom Light\n      // rules. This can't be applied at load as we need the full root category hierarchy\n      // elsewhere.\n      service.visibleRootCategories = featuredDepartmentPlacements => {\n        return service.rootCategories(featuredDepartmentPlacements).filter(category => {\n          return eComLightService.isNonEComLightCategory(category)\n        })\n      }\n\n      service.parents = function (category) {\n        const parents = []\n\n        if (category) {\n          let child = category\n          let parent\n\n          while ((parent = _.find(service.categories, { id: child.parent_id }))) {\n            parents.unshift(parent)\n            child = parent\n          }\n        }\n\n        return parents\n      }\n\n      service.siblings = function (category) {\n        let siblings = []\n\n        if (category) {\n          siblings = _.filter(service.categories, c => {\n            return c.parent_id === category.parent_id\n          })\n        }\n\n        return siblings\n      }\n\n      service.children = function (category) {\n        let children = []\n\n        if (category) {\n          children = _.filter(service.categories, c => {\n            return c.parent_id === category.id\n          })\n        }\n\n        return children\n      }\n\n      service.categoryFromId = function (id) {\n        if (id) {\n          return _.find(service.categories, { id: id })\n        } else {\n          return {\n            level: null,\n            tags: service.tags,\n            children: service.rootCategories(),\n          }\n        }\n      }\n\n      /**\n       * Creates and returns an object containing a list of ordered categories\n       * in the sequence of rootCategories and categorized products with their respective categories.\n       * @param  { array } products\n       *\n       * @returns { Promise<object> } - orderedCategories, categorizedProducts\n       *\n       */\n      service.getOrderedCategoriesAndProductsWithCategories = function (products) {\n        return service.fetchCategories().then(() => {\n          const rootCategories = service.rootCategories().map(category => category.name)\n          rootCategories.unshift(lang.values.uncategorizedCategory)\n          const sortedByStockLevelItems = _.sortBy(\n            products,\n            item => item.store_product?.availability?.stock_level\n          )\n          const categorizedProducts = _.groupBy(sortedByStockLevelItems, item => {\n            if (item.store_product.categories && item.store_product.categories.length > 0) {\n              return item.store_product.categories[0].name\n            } else return lang.values.uncategorizedCategory\n          })\n          const productCategories = Object.keys(categorizedProducts)\n\n          // Sorted categorized product categories by order of root categories\n          const orderedCategories = rootCategories.filter(\n            rootCategory =>\n              productCategories.findIndex(productCategory => productCategory === rootCategory) > -1\n          )\n          return { orderedCategories, categorizedProducts }\n        })\n      }\n    }\n  )\n","import _ from 'lodash'\nimport angular from 'angular'\n\nexport default angular\n  .module('collectionsCategoriesServiceComponentModule', [])\n  .service(\n    'collectionsCategoriesService',\n    function collectionsCategoriesService($q, $rootScope, $stateParams, Restangular) {\n      const service = this\n\n      $rootScope.$on('reloadState', () => {\n        delete service.categories\n      })\n\n      // Fetch collections\n\n      service.fetch = function (refresh) {\n        const deferred = $q.defer()\n\n        if (!refresh && service.categories) {\n          deferred.resolve(service.categories)\n          return deferred.promise\n        }\n\n        Restangular.all('placements/shop_collections')\n          .getList()\n          .then(\n            items => {\n              const results = []\n\n              _.each(items, item => {\n                results.push({\n                  name: item.target.collection.name,\n                  state: 'main.shop.collection',\n                  params: {\n                    collection_id: item.target.collection.id,\n                  },\n                  // FIXME: Add tags / sorting when backend supports them\n                })\n              })\n\n              service.categories = results\n              deferred.resolve(service.categories)\n            },\n            () => {\n              // Encountered an error, shop_collections placement may not be set up\n\n              service.categories = []\n              deferred.resolve(service.categories)\n            }\n          )\n\n        return deferred.promise\n      }\n\n      // From a set of featured department collections, build collection categories\n      service.buildFeaturedDepartmentCollectionCategories = collections => {\n        const results = []\n\n        collections.forEach(collection => {\n          results.push({\n            name: collection.name,\n            state: 'main.shop.departments.featured',\n            params: {\n              collection_id: collection.id,\n              category_id: collection.featuredDepartmentID,\n            },\n          })\n        })\n\n        return results\n      }\n    }\n  )\n","import _ from 'lodash'\nimport angular from 'angular'\n\nexport default angular\n  .module('couponsCategoriesServiceComponentModule', [])\n  .service(\n    'couponsCategoriesService',\n    function couponsCategoriesService($q, $rootScope, Restangular) {\n      const service = this\n\n      $rootScope.$on('reloadState', () => {\n        delete service.categories\n      })\n\n      service.fetch = function (refresh) {\n        const deferred = $q.defer()\n\n        if (!refresh && service.categories) {\n          deferred.resolve(service.categories)\n          return deferred.promise\n        }\n\n        Restangular.all('offers/categories')\n          .getList({ type: 'coupon' })\n          .then(categories => {\n            service.categories = categories\n\n            _.each(categories, category => {\n              // Pre-resolve tree information for all categories\n\n              category.state = 'main.shop.coupons.category'\n              category.params = { category_id: category.id }\n              category.tags = [\n                {\n                  name: 'Clipped',\n                  value: 'clipped',\n                },\n              ]\n            })\n\n            deferred.resolve(categories)\n          })\n\n        return deferred.promise\n      }\n\n      service.rootCategories = function () {\n        return _.filter(service.categories, category => {\n          return !category.parent_id\n        })\n      }\n    }\n  )\n","import _ from 'lodash'\nimport angular from 'angular'\n\nexport default angular\n  .module('flyerCategoriesAndPdfsServiceComponentModule', [])\n  .service(\n    'flyerCategoriesAndPdfsService',\n    function flyerCategoriesAndPdfsService($q, $rootScope, $state, Restangular, tagsService) {\n      const service = this\n\n      service.clearFlyerCategories = () => {\n        delete service.flyerCategories\n      }\n      service.clearPdfHrefs = () => {\n        delete service.pdfHrefs\n      }\n      // Clear our cached flyer categories or PDF hrefs when the user's state is changed\n      $rootScope.$on('auth', (event, action) => {\n        if (action === 'userUpdated') {\n          // Flyer categories, like flyer content, are highly dynamic and change according to various user state changes including:\n          //  shopping context, store (store segments), profile data (customer segments), loyalty status\n\n          // Flyer PDFs can change depending on the user's:\n          //  store (store segments), loyalty status\n\n          // Although ideally they would only be cleared from this service when those specific parts of the  user state change,\n          //  that's currently not feasible, so we instead clear them both on any user state change\n\n          // Flyer categories also need to be cleared when a user toggles betweeen regular/preview flyer\n          service.clearFlyerCategories()\n          // Flyer PDF Hrefs do not need to be cleared when a user toggles between regular/preview flyer because we need to\n          //  fetch all of them at once anyway (in order to show links for each flyer in the flyer preview modal)\n          service.clearPdfHrefs()\n        }\n      })\n\n      // Fetch flyer categories\n      // (If `params.preview_token` is provided, the categories will be specific to that preview flyer)\n\n      service.fetchFlyerCategories = (params = {}, refresh) => {\n        if (!refresh && service.flyerCategories) {\n          return $q.resolve(service.flyerCategories)\n        }\n        return Restangular.all('flyer')\n          .all('categories')\n          .getList(params)\n          .then(\n            categories =>\n              (service.flyerCategories = _.map(categories, category => {\n                const categoryParams = { category_id: category.id }\n                if (params.preview_timestamp) {\n                  categoryParams.preview_timestamp = params.preview_timestamp\n                }\n                return {\n                  name: category.name,\n                  state: 'main.shop.flyer.category',\n                  sort: true,\n                  tags: tagsService.tags(),\n                  id: category.id,\n                  params: categoryParams,\n\n                  // Add 'See All Deals' button to header in these views\n                  pageHeaderButton: {\n                    label: `See All Deals In ${category.name}`,\n                    onclick: () => {\n                      $state.go('main.shop.category', {\n                        category_id: category.id,\n                        tags: 'on_sale',\n                        page: null,\n                      })\n                    },\n                  },\n                }\n              }))\n          )\n      }\n\n      const fetchFlyerPdfHref = (params = {}) =>\n        Restangular.all('placements/flyer_pdf')\n          .getList(params)\n          .then(content =>\n            // Return '' if there is no PDF href for this flyer\n            content.length ? content[0].target.url : ''\n          )\n          // Return '' if the call fails\n          .catch(() => '')\n\n      // Fetch the PDF hrefs for the current and preview flyers\n\n      service.fetchFlyerPdfHrefs = (previewFlyerData, previewTimestamp, refresh) => {\n        if (!refresh && service.pdfHrefs) {\n          return $q.resolve(service.pdfHrefs)\n        }\n        const pdfHrefPromises = _.reduce(\n          previewFlyerData,\n          (_pdfHrefPromises, currentFlyerOrPreviewFlyers, flyerType) => {\n            // `previewFlyerData` has the following form: `{ current: { <current flyer data> }, previews: [{ <preview flyer data> }, ...] }``\n            if (flyerType === 'current') {\n              const flyerPdfCallParams = previewTimestamp\n                ? { preview_timestamp: previewTimestamp }\n                : {}\n              _pdfHrefPromises.current = fetchFlyerPdfHref(flyerPdfCallParams)\n            } else if (flyerType === 'previews' && currentFlyerOrPreviewFlyers) {\n              _pdfHrefPromises.previews = $q.all(\n                _.map(currentFlyerOrPreviewFlyers, previewFlyer =>\n                  fetchFlyerPdfHref({ preview_token: previewFlyer.preview_token })\n                )\n              )\n            }\n            return _pdfHrefPromises\n          },\n          {}\n        )\n\n        return $q.all(pdfHrefPromises).then(pdfHrefs => (service.pdfHrefs = pdfHrefs))\n      }\n    }\n  )\n","import _ from 'lodash'\nimport fp from 'lodash/fp'\nimport angular from 'angular'\nimport dayjs from 'dayjs'\n\nexport default angular\n  .module('purchasesCategoriesServiceComponentModule', [])\n  .service(\n    'purchasesCategoriesService',\n    function purchasesCategoriesService(\n      $q,\n      $rootScope,\n      $stateParams,\n      Restangular,\n      config,\n      list,\n      tagsService\n    ) {\n      const service = this\n\n      $rootScope.$on('reloadState', () => {\n        delete service.categories\n      })\n\n      // Fetch purchases\n\n      service.fetch = function (refresh) {\n        const deferred = $q.defer()\n\n        const params = {\n          with_ecommerce: true,\n          limit: 10,\n        }\n\n        if (!refresh && service.categories) {\n          deferred.resolve(service.categories)\n          return deferred.promise\n        }\n\n        Restangular.all('purchases')\n          .getList(params)\n          .then(purchases => {\n            const results = []\n\n            // Sort purchases by date in descending order\n\n            purchases = fp.flow(\n              fp.sortBy(purchase => purchase.timestamp),\n              fp.reverse,\n              fp.slice(0, config.maxPreviousPurchases)\n            )(purchases)\n\n            // Populate tree objects\n\n            _.each(purchases, purchase => {\n              results.push({\n                name: dayjs(purchase.timestamp, config.apiDateFormat).format('MMMM, DD YYYY'),\n                state: 'main.shop.purchases.purchase',\n                params: {\n                  purchase_id: purchase.id,\n                },\n\n                // Add 'Add All' button to header in these views\n\n                pageHeaderButton: {\n                  label: 'Add All',\n                  onclick() {\n                    Restangular.one('purchases', purchase.id)\n                      .get()\n                      .then(order => {\n                        list.loadListToCart(order.items)\n                      })\n                  },\n                },\n\n                sort: true,\n\n                // Use all tags except purchased (as it's redundant here)\n\n                tags: tagsService.tags({ value: 'purchased' }),\n              })\n            })\n\n            service.categories = results\n            deferred.resolve(service.categories)\n          })\n\n        return deferred.promise\n      }\n    }\n  )\n","import _ from 'lodash'\nimport angular from 'angular'\n\nexport default angular\n  .module('categoryFilterComponentModule', [])\n\n  // Hide links to categories which don't support one or more of the selected filters\n\n  .directive('categoryFilter', $state => {\n    return {\n      restrict: 'A',\n      scope: {\n        categoryFilter: '=',\n      },\n      link(scope, el) {\n        if ($state.params.tag) {\n          let tags\n          if (!angular.isArray($state.params.tags)) {\n            tags = [$state.params.tags]\n          } else {\n            tags = $state.params.tags\n          }\n          // eslint-disable-next-line eqeqeq\n          const found = _.intersection(tags, scope.categoryFilter.tags).length == tags.length\n          if (!found) {\n            el[0].style.display = 'none'\n          }\n        }\n      },\n    }\n  })\n","export const ANALYTICS_VALUES = {\n  GA_FLYER_CLICK: 'current weekly flyer PDF',\n}\n","export const COUPON_TAGS = {\n  CLIPPED: 'clipped',\n  INSTACART_ONLINE_ONLY: 'instacart_online_coupon',\n}\n","export const COUPON_TYPES = {\n  COUPON: 'coupon',\n}\n\nexport const COUPON_SOURCES = {\n  INSTACART: 'instacart',\n}\n","/* eslint-disable max-lines */\n\nimport angular from 'angular'\nimport isMobile from '@app/utils/isMobile'\nimport isMobileApp from '@app/utils/isMobileApp'\nimport { ANALYTICS_VALUES } from '@app/angular/constants/analyticsValues'\nimport { COUPON_TAGS } from '@app/angular/constants/tags'\nimport { COUPON_TYPES, COUPON_SOURCES } from '@app/angular/constants/coupons'\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\nimport { SCRIPT_TIMEOUT } from '@app/angular/constants/personalizationLoading'\nimport appendMetaTagDescription from '@app/utils/appendMetaTagDescription'\nimport { deleteJsonLd } from '@app/utils/jsonLd'\nimport { isWaysToShopEnabled } from '@app/utils/isModuleEnabled'\nimport {\n  getAll as getMerchandisedLandingPages,\n  getOne as getMerchandisedLandingPage,\n} from '@app/services/merchandisedLandingPages/api'\nimport { inCateringContext } from '@app/services/shoppingContext/selectors'\n\nlet _offerAnalytics = null\nlet _removeAuthListener = null\n\nexport default angular\n  .module('ShopComponentModule', [])\n  .config(($stateProvider, configConstants) => {\n    // Reused for multiple views\n    // Must be duplicated to force a refresh of the\n    // menu when state changes\n\n    const shopViews = {\n      'content@': {\n        template: require('./views/shop.html'),\n      },\n      'content@main.shop': {\n        template: require('./views/waysToShop.html'),\n        controller: 'ShopHomeController',\n      },\n    }\n\n    const shopContentViews = {\n      'content@main.shop': {\n        template: require('./views/shopContent.html'),\n        controller: 'ShopContentController',\n      },\n    }\n\n    const shopCollectionViews = {\n      'content@main.shop': {\n        template: require('./views/collectionsHome.html'),\n        controller: 'CollectionsHomeController',\n      },\n    }\n\n    const shopDepartmentViews = {\n      'content@main.shop': {\n        template: require('./views/featuredDepartment.html'),\n        controller: 'FeaturedDepartmentController',\n        controllerAs: '$ctrl',\n      },\n    }\n\n    const shopMerchandisedLandingPageViews = {\n      'content@main.shop': {\n        template: require('./views/merchandisedLandingPage.html'),\n        controller: 'MerchandisedLandingPageController',\n        controllerAs: '$ctrl',\n      },\n    }\n\n    const shopFlyerFlippViews = {\n      'content@main.shop': {\n        controller: 'FlyerFlippController',\n        template: require('./views/flyerFlipp.html'),\n        controllerAs: '$ctrl',\n      },\n    }\n\n    shopFlyerFlippViews['desktopMenu@main.shop'] = {\n      template: require('./views/empty.html'),\n    }\n\n    // Use mobile shop menu on mobile devices and Cordova\n    if (isMobile(configConstants) || isMobileApp()) {\n      shopViews['mobileMenu@main.shop'] = {\n        template: require('./views/shopMenu.mobile.html'),\n        controller: 'ShopMenuController',\n      }\n\n      shopContentViews['mobileMenu@main.shop.*'] = {\n        template: require('./views/shopMenu.mobile.html'),\n        controller: 'ShopMenuController',\n      }\n\n      shopCollectionViews['mobileMenu@main.shop.collections'] = {\n        template: require('./views/shopMenu.mobile.html'),\n        controller: 'ShopMenuController',\n      }\n\n      shopDepartmentViews['mobileMenu@main.shop.departments'] = {\n        template: require('./views/shopMenu.mobile.html'),\n        controller: 'ShopMenuController',\n      }\n\n      shopMerchandisedLandingPageViews['mobileMenu@main.shop.mlp'] = {\n        template: require('./views/shopMenu.mobile.html'),\n        controller: 'ShopMenuController',\n      }\n    } else {\n      shopViews['desktopMenu@main.shop'] = {\n        template: require('./views/shopMenu.desktop.html'),\n        controller: 'ShopMenuController',\n      }\n\n      shopContentViews['desktopMenu@main.shop'] = {\n        template: require('./views/shopMenu.desktop.html'),\n        controller: 'ShopMenuController',\n      }\n\n      shopCollectionViews['desktopMenu@main.shop'] = {\n        template: require('./views/shopMenu.desktop.html'),\n        controller: 'ShopMenuController',\n      }\n\n      shopDepartmentViews['desktopMenu@main.shop'] = {\n        template: require('./views/shopMenu.desktop.html'),\n        controller: 'ShopMenuController',\n      }\n\n      shopMerchandisedLandingPageViews['desktopMenu@main.shop'] = {\n        template: require('./views/shopMenu.desktop.html'),\n        controller: 'ShopMenuController',\n      }\n    }\n\n    function loadShopContentViewsCtrl($ocLazyLoad) {\n      const importShopMenuController = import(\n        /* webpackChunkName: \"shopMenuController\", webpackPrefetch: true */ './controllers/shopMenuController'\n      )\n      const importShopContentController = import(\n        /* webpackChunkName: \"shopContentController\", webpackPrefetch: true */ './controllers/shopContentController'\n      )\n\n      return Promise.all([importShopMenuController, importShopContentController])\n        .then(values => $ocLazyLoad.load(values.map(module => module.default)))\n        .catch(err => {\n          throw new Error(`Ooops, something went wrong, ${err}`)\n        })\n    }\n\n    const recipesTreeStates = {\n      recipesHome: {\n        name: configConstants.lang.recipes,\n        state: 'main.shop.recipes',\n      },\n      savedRecipes: {\n        name: configConstants.lang.savedRecipes.savedRecipes,\n        state: 'main.shop.recipes.saved',\n      },\n    }\n\n    // Decorator to handle DRY views objects\n    // Replaces any state declaration that uses a '*' with the exact current state\n\n    $stateProvider.decorator('views', (state, parent) => {\n      const result = {}\n      const views = parent(state)\n\n      angular.forEach(views, (configConstants, name) => {\n        if (name.indexOf('*') > 0) {\n          name = name.substring(0, name.indexOf('@') + 1) + state.name\n        }\n        result[name] = configConstants\n      })\n\n      return result\n    })\n\n    // Make things more DRY, we use these quite a bit to refer to parents, etc..\n\n    const shopContentParents = {\n      collections: {\n        name: configConstants.lang.collections,\n        state: 'main.shop.collections',\n      },\n\n      coupons: {\n        name: configConstants.lang.coupons,\n        state: 'main.shop.coupons',\n      },\n\n      offers: {\n        name: configConstants.lang.offers,\n        state: 'main.shop.offers',\n      },\n\n      waysToShop: {\n        name: configConstants.lang.waysToShop,\n        state: 'main.shop',\n        params: { tags: null, brand_name: null },\n      },\n\n      weeklyAd: {\n        name: configConstants.lang.weeklyAd,\n        state: 'main.shop.flyer',\n        link: configConstants.dotComModule.weeklyAdPath\n          ? configConstants.dotComModule.url + configConstants.dotComModule.weeklyAdPath\n          : '',\n      },\n\n      offersAndCoupons: {\n        name: configConstants.lang.offersAndCoupons,\n        state: 'main.shop.offersAndCoupons',\n      },\n\n      departments: {\n        name: configConstants.lang.departments,\n        state: 'main.shop.departments',\n      },\n    }\n\n    // Initialize states\n\n    $stateProvider\n\n      // Main shop route + shop homepage\n\n      .state('main.shop', {\n        url: '/shop?tags&sort&page&brand_name&brand_names&offer_sources&group_display_name',\n\n        data: {\n          section: 'catalog',\n        },\n\n        resolve: {\n          loadCtrl: $ocLazyLoad => {\n            const importShopMenuController = import(\n              /* webpackChunkName: \"shopMenuController\", webpackPrefetch: true */ './controllers/shopMenuController'\n            )\n            const importShopHomeController = import(\n              /* webpackChunkName: \"shopHomeController\", webpackPrefetch: true */ './controllers/shopHomeController'\n            )\n\n            return Promise.all([importShopMenuController, importShopHomeController])\n              .then(values => $ocLazyLoad.load(values.map(module => module.default)))\n              .catch(err => {\n                throw new Error(`Ooops, something went wrong, ${err}`)\n              })\n          },\n\n          tree(lang) {\n            const tree = {\n              current: shopContentParents.waysToShop,\n              children: [],\n            }\n\n            tree.children.push({\n              name: lang.values.departments,\n              state: 'main.shop.categories',\n            })\n\n            const purchasedExists = configConstants.tags.find(tag => tag.id === 'purchased')\n            if (purchasedExists) {\n              tree.children.push({\n                name: configConstants.lang.previousPurchases,\n                state: 'main.shop.purchases',\n              })\n            }\n\n            if (!configConstants.disableWeeklyAd) {\n              tree.children.push(shopContentParents.weeklyAd)\n            }\n\n            if (!configConstants.disableCollections) {\n              tree.children.push(shopContentParents.collections)\n            }\n\n            if (!configConstants.disableCoupons) {\n              tree.children.push(shopContentParents.coupons)\n            }\n            if (configConstants.waysToShopLinks && configConstants.waysToShopLinks.length) {\n              configConstants.waysToShopLinks.forEach(link => {\n                tree.children.push({ ...link })\n              })\n            }\n\n            return tree\n          },\n        },\n\n        views: shopViews,\n\n        onEnter($rootScope, $state, $stateParams, tagsService) {\n          // If any of the tags in the new state's params require registration, ensure the user either registers or is logged in\n          if ($stateParams.tags && $stateParams.tags.length > 0) {\n            const activeTags = Array.isArray($stateParams.tags)\n              ? angular.copy($stateParams.tags)\n              : [$stateParams.tags]\n\n            return tagsService.checkRegistrationRequired({\n              activeTags,\n              allTags: tagsService.tags(),\n              success: () => {}, // User gets to continue with the route change\n              failure: () => {\n                // Did not login/register, refresh the page without the required filter/tags (removed in checkRegistrationRequired)\n                return $state.go('.', { tags: activeTags, page: null }, { reload: true })\n              },\n            })\n          }\n        },\n      })\n\n      // Shop categories front page\n\n      .state('main.shop.categories', {\n        url: '/categories',\n\n        resolve: {\n          loadCtrl: loadShopContentViewsCtrl,\n          src($stateParams, configConstants) {\n            // Checks if client has a custom `offer_sources` for `on_sale` products\n            if (\n              $stateParams.tags &&\n              $stateParams.tags.indexOf('on_sale') > -1 &&\n              configConstants.onSaleOfferSources\n            ) {\n              $stateParams.offer_sources = configConstants.onSaleOfferSources\n            }\n\n            // Checks if client has a custom `offer_sources` for `has_coupon` products\n            if (\n              $stateParams.tags &&\n              $stateParams.tags.indexOf('has_coupon') > -1 &&\n              configConstants.hasCouponOfferSources\n            ) {\n              $stateParams.offer_sources = configConstants.hasCouponOfferSources\n            }\n\n            // Checks if client has a custom `offer_sources` for `has_offer` products\n            if (\n              $stateParams.tags &&\n              $stateParams.tags.indexOf('has_offer') > -1 &&\n              configConstants.hasOfferOfferSources\n            ) {\n              $stateParams.offer_sources = configConstants.hasOfferOfferSources\n            }\n\n            // Show subcategories unless tags or brands are applied,\n            // otherwise show products\n\n            return {\n              endpoint:\n                ($stateParams.tags && $stateParams.tags.length) || $stateParams.brand_name?.length\n                  ? 'store_products'\n                  : null,\n            }\n          },\n\n          categories(catalogCategoriesService, eComLightService) {\n            return catalogCategoriesService\n              .fetchCategories()\n              .then(categories => categories.filter(eComLightService.isNonEComLightCategory))\n          },\n\n          async merchandisedLandingPageCategories($location, configConstants) {\n            // this applies to desktop only because MLPs are persisted through the fixed header nav, to prevent fetching on every child category route\n            // in mobile, we should be fetching MLPs on this route every time because there is no persistent nav\n            if (!$location.path().endsWith('/categories') && !isMobile(configConstants)) {\n              return []\n            }\n            const merchandisedLandingPages = await getMerchandisedLandingPages()\n\n            return merchandisedLandingPages.items.map(mlp => {\n              const imageUrl =\n                isMobile(configConstants) || isMobileApp()\n                  ? mlp.images?.mobile?.url\n                  : mlp.images?.desktop?.url\n              return {\n                ...mlp,\n                type: 'mlp_v2',\n                media: {\n                  image: imageUrl,\n                },\n              }\n            })\n          },\n\n          tree(\n            $q,\n            lang,\n            categories,\n            catalogCategoriesService,\n            merchandisedLandingPageCategories,\n            tagsService\n          ) {\n            return {\n              current: {\n                name: lang.values.departments,\n                state: 'main.shop.categories',\n                sort: true,\n                tags: tagsService.filterBarTags,\n                level: -1,\n              },\n              parents: !isWaysToShopEnabled() ? [] : [shopContentParents.waysToShop],\n              children: catalogCategoriesService.visibleRootCategories(\n                merchandisedLandingPageCategories\n              ),\n              siblings: [],\n            }\n          },\n        },\n\n        views: shopContentViews,\n\n        params: {\n          toggledFilterId: null,\n        },\n      })\n\n      // Shop category\n\n      .state('main.shop.category', {\n        parent: 'main.shop.categories',\n        url: '/:category_id',\n\n        resolve: {\n          loadCtrl: loadShopContentViewsCtrl,\n\n          category($stateParams, catalogCategoriesService) {\n            const category = catalogCategoriesService.categoryFromId($stateParams.category_id)\n\n            // If the category doesn't exist in memory, we try once more after fetching a new list of categories\n            if (!category) {\n              return catalogCategoriesService\n                .fetchCategories(true)\n                .then(() => catalogCategoriesService.categoryFromId($stateParams.category_id))\n            }\n\n            return category\n          },\n\n          src($state, $stateParams, category) {\n            if (!category) {\n              $state.go('main.404')\n            }\n            // Checks if client has a custom `offer_sources` for `has_coupon` products\n            if (\n              $stateParams.tags &&\n              $stateParams.tags.indexOf('has_coupon') > -1 &&\n              configConstants.hasCouponOfferSources\n            ) {\n              $stateParams.offer_sources = configConstants.hasCouponOfferSources\n            }\n\n            // Checks if client has a custom `offer_sources` for `has_offer` products\n            if (\n              $stateParams.tags &&\n              $stateParams.tags.indexOf('has_offer') > -1 &&\n              configConstants.hasOfferOfferSources\n            ) {\n              $stateParams.offer_sources = configConstants.hasOfferOfferSources\n            }\n\n            // Show product tiles instead of product category tiles starting on this productCategory level (and deeper)\n            const categoryLevelToShowProductTiles = configConstants.categoryLeveltoShowProducts\n\n            return {\n              endpoint:\n                category.level >= categoryLevelToShowProductTiles ||\n                $stateParams.tags?.length ||\n                $stateParams.brand_name ||\n                !category.children?.length\n                  ? 'store_products'\n                  : null,\n            }\n          },\n\n          catering: (\n            $rootScope,\n            $stateParams,\n            auth,\n            category,\n            config,\n            eComLightService,\n            localStorageService\n          ) => {\n            const isEComLightEnabled =\n              config.eComLight?.enabled && config.isDedicatedCateringExperienceSupported\n            const isInEComLightMode = eComLightService.inEComLightMode\n            const ecomLightCategoryID = config.eComLight?.homeRedirect?.params?.category_id\n            const hasEComLightCategory =\n              ecomLightCategoryID &&\n              ($stateParams.category_id === ecomLightCategoryID ||\n                category.parents.find(category => category.id === ecomLightCategoryID))\n\n            /**\n             * If the retailer has ecomLight enabled and the user is accessing a subcategory of\n             * ecomlight, set ecomlight mode to true\n             */\n            if (isEComLightEnabled && !isInEComLightMode && hasEComLightCategory) {\n              eComLightService.setMode(true)\n              // This is needed as this intent change will break the shopping selector popping up\n              localStorageService.deprecatedSet(\n                'userCartIntent',\n                auth.getCurrentShoppingMode() || auth.user.context.intent\n              )\n              return auth.setIntent(SHOPPING_MODES.CATERING)\n            }\n          },\n\n          onEnter: (lang, tree) => {\n            appendMetaTagDescription(\n              lang.templateAsString(lang.values.metaTagCategoryDefault, {\n                category: tree?.current?.name?.toLowerCase() || '',\n                retailer: lang.values.clientName,\n              })\n            )\n          },\n\n          tree: (\n            $q,\n            $stateParams,\n            category,\n            catalogCategoriesService,\n            config,\n            eComLightService,\n            lang\n          ) => {\n            let { parents } = category\n\n            if (!eComLightService.inEComLightMode) {\n              const facetsEnabled =\n                configConstants.enableFacetedSearchFilters || configConstants.enableICSearch\n\n              // Only show the Ways To Shop and Departments links if not in eCom Light mode\n              parents = [\n                ...(!isWaysToShopEnabled() ? [] : [shopContentParents.waysToShop]),\n                {\n                  name: lang.values.departments,\n                  state: 'main.shop.categories',\n                  params: { ...(!facetsEnabled && { brand_name: null }) },\n                },\n                ...parents,\n              ]\n            }\n\n            const siblings =\n              eComLightService.inEComLightMode && category.id === eComLightService.eComLightCategory\n                ? []\n                : catalogCategoriesService.siblings(category)\n\n            return {\n              current: category,\n              parents,\n              children: catalogCategoriesService.children(category),\n              siblings,\n            }\n          },\n        },\n\n        views: shopContentViews,\n      })\n\n      // All previous purchases\n\n      .state('main.shop.purchases', {\n        url: '/purchases',\n\n        data: {\n          section: 'purchases',\n          requireRegistered: true,\n        },\n\n        resolve: {\n          loadCtrl: loadShopContentViewsCtrl,\n          src() {\n            return {\n              endpoint: 'store_products',\n              params: {\n                tags: ['purchased'],\n              },\n            }\n          },\n\n          purchasesCategories(purchasesCategoriesService) {\n            return purchasesCategoriesService.fetch()\n          },\n\n          tree(purchasesCategories, tagsService) {\n            return {\n              current: {\n                name: configConstants.lang.previousPurchases,\n                state: 'main.shop.purchases',\n                sort: true,\n                tags: tagsService.tags({ id: 'purchased' }), // Use all tags except purchased (as it's redundant here)\n              },\n              children: configConstants.shopCollections.purchases.concat(purchasesCategories),\n              parents: !isWaysToShopEnabled() ? [] : [shopContentParents.waysToShop],\n            }\n          },\n        },\n\n        views: shopContentViews,\n      })\n\n      // Previous purchases collection\n\n      .state('main.shop.purchases.collection', {\n        url: '/collection/:collection_id',\n\n        resolve: {\n          loadCtrl: loadShopContentViewsCtrl,\n          src($stateParams) {\n            return { endpoint: `collections/${$stateParams.collection_id}` }\n          },\n\n          tree($stateParams, purchasesCategories, tagsService) {\n            const collection = configConstants.shopCollections.purchases.find(\n              collection =>\n                collection.params.collection_id.toString() === $stateParams.collection_id\n            )\n\n            return {\n              current: {\n                name: collection.name,\n                state: 'main.shop.purchases.collection',\n                sort: true,\n                tags: tagsService.tags({ id: 'purchased' }), // Use all tags except purchased (as it's redundant here)\n              },\n              children: [],\n              siblings: configConstants.shopCollections.purchases.concat(purchasesCategories),\n              parents: [\n                ...(!isWaysToShopEnabled() ? [] : [shopContentParents.waysToShop]),\n                {\n                  name: configConstants.lang.previousPurchases,\n                  state: 'main.shop.purchases',\n                  sort: true,\n                  tags: tagsService.tags({ id: 'purchased' }), // Use all tags except purchased (as it's redundant here)\n                },\n              ],\n            }\n          },\n        },\n\n        views: shopContentViews,\n      })\n\n      // Individual previous purchases\n\n      .state('main.shop.purchases.purchase', {\n        url: '/purchase/:purchase_id',\n\n        resolve: {\n          loadCtrl: loadShopContentViewsCtrl,\n          src($stateParams) {\n            return {\n              endpoint: 'store_products',\n              params: {\n                purchase_id: $stateParams.purchase_id,\n              },\n            }\n          },\n\n          tree($stateParams, purchasesCategories, tagsService) {\n            const purchase = purchasesCategories.find(\n              purchase => purchase.params.purchase_id.toString() === $stateParams.purchase_id\n            )\n\n            return {\n              current: purchase,\n              children: [],\n              siblings: configConstants.shopCollections.purchases.concat(purchasesCategories),\n              parents: [\n                ...(!isWaysToShopEnabled() ? [] : [shopContentParents.waysToShop]),\n                {\n                  name: configConstants.lang.previousPurchases,\n                  state: 'main.shop.purchases',\n                  sort: true,\n                  tags: tagsService.tags({ id: 'purchased' }), // Use all tags except purchased (as it's redundant here)\n                },\n              ],\n            }\n          },\n        },\n\n        views: shopContentViews,\n      })\n\n      // Flyer front page\n\n      .state('main.shop.flyer', {\n        url: '/flyer?preview_timestamp&show_first_preview',\n\n        data: {\n          section: 'flyerhomepage',\n        },\n\n        resolve: {\n          loadCtrl: loadShopContentViewsCtrl,\n          // Set previewTimestamp or previewToken in flyerPreviewParams to be used by future resolves\n          flyerPreviewParams($stateParams, auth, flyerPreviewService) {\n            const previewTimestamp = $stateParams.preview_timestamp\n\n            if ($stateParams.preview_timestamp) {\n              // If there's a preview_timestamp in the address bar, set it in the flyerPreviewService and show that flyer.\n              flyerPreviewService.setPreviewTimestamp(previewTimestamp)\n              return { preview_timestamp: previewTimestamp }\n            }\n            // Otherwise, fetch flyer preview data before page load - data will be stored and accessible via flyerPreviewService.\n            // (We only do this if preview_timestamp is not provided, otherwise they'd clash awkwardly.\n            //  We do this for backwards compatibility for Dashboard Flyer preview - preview_timestamp always takes priority.)\n            return flyerPreviewService.fetchFlyerData(auth.getStore()).then(() => {\n              if ($stateParams.show_first_preview) {\n                // If there's the param \"show_first_preview\" in the address bar, set the first available preview token in the flyerPreviewService.\n                flyerPreviewService.setFirstAvailablePreviewToken()\n              }\n              // Show whatever preview flyer whose preview token is set in flyerPreviewService\n              //  (if no preview token is set it'll return null and we just show the regular flyer page).\n              return { preview_token: flyerPreviewService.getPreviewToken() }\n            })\n          },\n\n          src(flyerPreviewParams) {\n            return {\n              endpoint: 'flyer',\n              params: flyerPreviewParams,\n            }\n          },\n\n          flyerCategories(flyerCategoriesAndPdfsService, flyerPreviewParams) {\n            return flyerCategoriesAndPdfsService.fetchFlyerCategories(flyerPreviewParams)\n          },\n\n          flyerPdfHrefs(flyerCategoriesAndPdfsService, flyerPreviewParams, flyerPreviewService) {\n            // Make sure we've resolved `flyerPreviewParams` to ensure the flyer preview data has been fetched\n            return flyerCategoriesAndPdfsService.fetchFlyerPdfHrefs(\n              flyerPreviewService.getFlyerData(),\n              flyerPreviewService.getPreviewTimestamp()\n            )\n          },\n\n          // PDF href for current flyer being viewed (regular or preview)\n          currentFlyerPdfHref(flyerPdfHrefs, flyerPreviewParams, flyerPreviewService) {\n            const isPreview = flyerPreviewParams && flyerPreviewParams.preview_token\n\n            let flyerPdfHref = ''\n            if (isPreview) {\n              const flyerPreviewIndex = flyerPreviewService.getPreviewFlyerIndexBeingViewed()\n              if (flyerPreviewIndex > -1) {\n                flyerPdfHref = flyerPdfHrefs.previews[flyerPreviewIndex]\n              }\n            } else {\n              flyerPdfHref = flyerPdfHrefs.current\n            }\n            return flyerPdfHref\n          },\n\n          tree(currentFlyerPdfHref, eComLightService, flyerCategories, flyerPreviewParams) {\n            const isPreview = flyerPreviewParams && flyerPreviewParams.preview_token\n            let weeklyAdChildLinks = isPreview\n              ? configConstants.shopCollections.flyer.filter(links => !links.hideWhenPreviewing)\n              : configConstants.shopCollections.flyer\n            weeklyAdChildLinks = eComLightService.inEComLightMode\n              ? configConstants.shopCollections.flyer.filter(links => !links.hideWhenInEcomLight)\n              : weeklyAdChildLinks\n            weeklyAdChildLinks = weeklyAdChildLinks.concat(flyerCategories)\n\n            const currentLinkParams = {}\n            if (flyerPreviewParams.preview_timestamp) {\n              currentLinkParams.preview_timestamp = flyerPreviewParams.preview_timestamp\n            }\n\n            return {\n              current: {\n                name: isPreview\n                  ? `${configConstants.lang.weeklyAd} Preview`\n                  : configConstants.lang.weeklyAd,\n                state: 'main.shop.flyer',\n                params: currentLinkParams,\n                sort: false,\n                tags: null,\n                pageHeaderLink: {\n                  label: configConstants.lang.downloadPdf,\n                  href: configConstants.dotComModule.weeklyAdPath\n                    ? configConstants.dotComModule.url + configConstants.dotComModule.weeklyAdPath\n                    : currentFlyerPdfHref,\n                  target: configConstants.dotComModule.weeklyAdPath ? undefined : '_blank',\n                  eventName: ANALYTICS_VALUES.GA_FLYER_CLICK,\n                },\n              },\n              parents: !isWaysToShopEnabled() ? [] : [shopContentParents.waysToShop],\n              children: weeklyAdChildLinks,\n              siblings: [],\n            }\n          },\n        },\n\n        views: shopContentViews,\n      })\n\n      // Flyer collection\n\n      .state('main.shop.flyer.collection', {\n        url: '/collection/:collection_id',\n\n        data: {\n          section: 'flyer',\n        },\n\n        resolve: {\n          loadCtrl: loadShopContentViewsCtrl,\n          src($stateParams, flyerPreviewParams) {\n            return {\n              endpoint: `collections/${$stateParams.collection_id}`,\n              params: flyerPreviewParams,\n            }\n          },\n\n          tree(\n            $stateParams,\n            currentFlyerPdfHref,\n            eComLightService,\n            flyerCategories,\n            flyerPreviewParams\n          ) {\n            const collection = configConstants.shopCollections.flyer.find(\n              collection =>\n                collection.params.collection_id.toString() === $stateParams.collection_id\n            )\n\n            const isPreview = flyerPreviewParams && flyerPreviewParams.preview_token\n            let weeklyAdChildLinks = isPreview\n              ? configConstants.shopCollections.flyer.filter(links => !links.hideWhenPreviewing)\n              : configConstants.shopCollections.flyer\n            weeklyAdChildLinks = eComLightService.inEComLightMode\n              ? configConstants.shopCollections.flyer.filter(links => !links.hideWhenInEcomLight)\n              : weeklyAdChildLinks\n            weeklyAdChildLinks = weeklyAdChildLinks.concat(flyerCategories)\n\n            const weeklyAdParentName = isPreview\n              ? `${configConstants.lang.weeklyAd} Preview`\n              : configConstants.lang.weeklyAd\n\n            const currentLinkParams = { collection_id: $stateParams.collection_id }\n            if (flyerPreviewParams.preview_timestamp) {\n              currentLinkParams.preview_timestamp = flyerPreviewParams.preview_timestamp\n            }\n            const treeToReturn = {\n              current: {\n                name: collection.name,\n                state: 'main.shop.flyer.collection',\n                params: currentLinkParams,\n              },\n              parents: [\n                ...(!isWaysToShopEnabled() ? [] : [shopContentParents.waysToShop]),\n                { ...shopContentParents.weeklyAd, name: weeklyAdParentName },\n              ],\n              children: [],\n              siblings: weeklyAdChildLinks,\n            }\n\n            if (\n              configConstants.showFlyerPdfInSpecialsFlyerCollection &&\n              $stateParams.collection_id === 'specials'\n            ) {\n              treeToReturn.current.pageHeaderLink = {\n                label: configConstants.lang.downloadPdf,\n                href: configConstants.dotComModule.weeklyAdPath\n                  ? configConstants.dotComModule.url + configConstants.dotComModule.weeklyAdPath\n                  : currentFlyerPdfHref,\n                target: configConstants.dotComModule.weeklyAdPath ? undefined : '_blank',\n                eventName: ANALYTICS_VALUES.GA_FLYER_CLICK,\n              }\n            }\n\n            return treeToReturn\n          },\n        },\n\n        views: shopContentViews,\n      })\n\n      // Flyer category\n\n      .state('main.shop.flyer.category', {\n        url: '/category/:category_id',\n\n        data: {\n          section: 'flyer',\n        },\n\n        resolve: {\n          loadCtrl: loadShopContentViewsCtrl,\n          src($stateParams, flyerPreviewParams) {\n            return {\n              endpoint: `flyer/categories/${$stateParams.category_id}`,\n              params: flyerPreviewParams,\n            }\n          },\n\n          tree($stateParams, eComLightService, flyerCategories, flyerPreviewParams, tagsService) {\n            const category = flyerCategories.find(\n              category => category.id.toString() === $stateParams.category_id\n            )\n\n            const isPreview = flyerPreviewParams && flyerPreviewParams.preview_token\n            let weeklyAdChildLinks = isPreview\n              ? configConstants.shopCollections.flyer.filter(links => !links.hideWhenPreviewing)\n              : configConstants.shopCollections.flyer\n            weeklyAdChildLinks = eComLightService.inEComLightMode\n              ? configConstants.shopCollections.flyer.filter(links => !links.hideWhenInEcomLight)\n              : weeklyAdChildLinks\n            weeklyAdChildLinks = weeklyAdChildLinks.concat(flyerCategories)\n\n            const weeklyAdParentName = isPreview\n              ? `${configConstants.lang.weeklyAd} Preview`\n              : configConstants.lang.weeklyAd\n\n            return {\n              current: {\n                ...category,\n                tags: tagsService.filterBarTags,\n              },\n              parents: [\n                ...(!isWaysToShopEnabled() ? [] : [shopContentParents.waysToShop]),\n                { ...shopContentParents.weeklyAd, name: weeklyAdParentName },\n              ],\n              children: [],\n              siblings: weeklyAdChildLinks,\n            }\n          },\n        },\n\n        views: shopContentViews,\n      })\n\n      // Coupons front page\n\n      .state('main.shop.coupons', {\n        url: '/coupons',\n\n        data: {\n          section: 'coupons',\n        },\n\n        resolve: {\n          loadCtrl: loadShopContentViewsCtrl,\n          src($stateParams) {\n            const srcResult = {\n              endpoint: '/offers',\n              callback: payload => _offerAnalytics.viewOffers(payload),\n            }\n\n            const instacartOnlineOnly = COUPON_TAGS.INSTACART_ONLINE_ONLY\n            const couponParams = { type: COUPON_TYPES.COUPON }\n\n            // if the instacart online only fitler was selected, add a\n            // source of COUPON_SOURCES.INSTACART\n            if (\n              (Array.isArray($stateParams.tags) &&\n                $stateParams.tags.includes(instacartOnlineOnly)) ||\n              $stateParams.tags === instacartOnlineOnly\n            ) {\n              Object.assign(couponParams, { source: COUPON_SOURCES.INSTACART })\n            }\n\n            srcResult.params = configConstants.offersAndCoupons.showCouponsTogether\n              ? couponParams\n              : Object.assign(couponParams, configConstants.offersAndCoupons.queries.coupons)\n\n            return srcResult\n          },\n\n          couponsCategories(couponsCategoriesService) {\n            return couponsCategoriesService.fetch()\n          },\n\n          tree(couponsCategories, tagsService) {\n            return {\n              current: {\n                ...shopContentParents.coupons,\n                tags: tagsService.couponTags,\n              },\n              children: couponsCategories,\n              parents: !isWaysToShopEnabled() ? [] : [shopContentParents.waysToShop],\n            }\n          },\n        },\n\n        views: shopContentViews,\n\n        onEnter($rootScope, $state) {\n          if (!_removeAuthListener) {\n            _removeAuthListener = $rootScope.$on('auth', (event, action) => {\n              if (action === 'userLoggedIn') {\n                $state.reload()\n              }\n            })\n          }\n        },\n\n        onExit() {\n          if (_removeAuthListener) {\n            _removeAuthListener() // Call here removes the auth listener\n            _removeAuthListener = null\n          }\n        },\n      })\n\n      // Coupons category\n\n      .state('main.shop.coupons.category', {\n        url: '/category/:category_id',\n\n        resolve: {\n          loadCtrl: loadShopContentViewsCtrl,\n          src($stateParams) {\n            return {\n              endpoint: '/offers',\n              callback: payload => _offerAnalytics.viewOffers(payload),\n              params: {\n                type: 'coupon',\n                category_id: $stateParams.category_id,\n              },\n            }\n          },\n\n          tree($stateParams, couponsCategories) {\n            const category = couponsCategories.find(\n              category => category.id.toString() === $stateParams.category_id\n            )\n\n            return {\n              current: category,\n              siblings: couponsCategories,\n              parents: [\n                ...(!isWaysToShopEnabled() ? [] : [shopContentParents.waysToShop]),\n                shopContentParents.coupons,\n              ],\n            }\n          },\n        },\n\n        views: shopContentViews,\n      })\n\n      // Offers front page\n\n      .state('main.shop.offers', {\n        url: '/offers',\n\n        data: {\n          section: 'offers',\n        },\n\n        resolve: {\n          loadCtrl: loadShopContentViewsCtrl,\n          src() {\n            return {\n              endpoint: '/offers',\n              callback: payload => _offerAnalytics.viewOffers(payload),\n              params: {\n                type: 'offer',\n                ...configConstants.offersAndCoupons.queries.offers,\n              },\n            }\n          },\n\n          tree(tagsService) {\n            return {\n              current: {\n                ...shopContentParents.offers,\n                tags: tagsService.offerTags,\n              },\n              children: [],\n              parents: !isWaysToShopEnabled() ? [] : [shopContentParents.waysToShop],\n            }\n          },\n        },\n\n        views: shopContentViews,\n      })\n\n      // Collections home\n\n      .state('main.shop.collections', {\n        url: '/collections',\n        data: {\n          section: 'collection',\n        },\n\n        resolve: {\n          loadCtrl: $ocLazyLoad => {\n            const importShopMenuController = import(\n              /* webpackChunkName: \"shopMenuController\", webpackPrefetch: true */ './controllers/shopMenuController'\n            )\n            const importCollectionsHomeController = import(\n              /* webpackChunkName: \"collectionsHomeController\", webpackPrefetch: true */ './controllers/collectionsHomeController'\n            )\n\n            return Promise.all([importShopMenuController, importCollectionsHomeController])\n              .then(values => $ocLazyLoad.load(values.map(module => module.default)))\n              .catch(err => {\n                throw new Error(`Ooops, something went wrong, ${err}`)\n              })\n          },\n          collectionsCategories($stateParams, collectionsCategoriesService) {\n            return collectionsCategoriesService.fetch()\n          },\n\n          tree(collectionsCategories) {\n            return {\n              current: shopContentParents.collections,\n              parents: !isWaysToShopEnabled() ? [] : [shopContentParents.waysToShop],\n              children: collectionsCategories,\n            }\n          },\n          collectionsContent(Restangular) {\n            return Restangular.all('placements/shop_collections').getList()\n          },\n        },\n\n        views: shopCollectionViews,\n      })\n\n      // Individual collection\n\n      .state('main.shop.collection', {\n        parent: 'main.shop.collections',\n\n        url: '/:collection_id?source',\n\n        resolve: {\n          loadCtrl: loadShopContentViewsCtrl,\n          src($stateParams) {\n            return { endpoint: `collections/${$stateParams.collection_id}` }\n          },\n\n          collectionCategories($stateParams, Restangular) {\n            return Restangular.one(`collections/${$stateParams.collection_id}`)\n              .all('categories')\n              .getList()\n              .then(categories => {\n                // We're using angular.copy here as map will strip the metadata from the restangular object\n\n                const mappedCategories = angular.copy(categories).map(category => {\n                  return {\n                    id: category.id,\n                    name: category.name,\n                    state: 'main.shop.collection.category',\n                    params: { collection_id: $stateParams.collection_id, category_id: category.id },\n                  }\n                })\n\n                // Preserve metadata needed to render menu\n\n                mappedCategories.name = categories.name\n                mappedCategories.id = categories.id\n\n                return mappedCategories\n              })\n          },\n\n          tree($stateParams, $ngRedux, collectionsCategories, collectionCategories) {\n            if (collectionCategories.length === 1) {\n              // Don't bother showing if there's only one\n              collectionCategories.length = 0 // Preserve metadata\n            }\n\n            const mapStateToService = state => ({ inCateringContext: inCateringContext(state) })\n            $ngRedux.connect(mapStateToService)(this)\n\n            // decide wether or not to show the Collections parent\n            const showCollections = !configConstants.disableCollections && !this.inCateringContext\n\n            const parents = []\n            if (isWaysToShopEnabled()) {\n              parents.push(shopContentParents.waysToShop)\n            }\n            if (showCollections) {\n              parents.push(shopContentParents.collections)\n            }\n\n            return {\n              current: {\n                name: collectionCategories.name,\n                state: 'main.shop.collection',\n                params: { collection_id: $stateParams.collection_id },\n              },\n              parents,\n              siblings: collectionsCategories,\n              children: collectionCategories,\n            }\n          },\n        },\n\n        views: shopContentViews,\n      })\n\n      // Individual collection subcategory\n\n      .state('main.shop.collection.category', {\n        url: '/:category_id',\n\n        resolve: {\n          loadCtrl: loadShopContentViewsCtrl,\n          src($stateParams) {\n            return {\n              endpoint: `collections/${$stateParams.collection_id}`,\n            }\n          },\n\n          tree($stateParams, collectionsCategories, collectionCategories) {\n            const category = collectionCategories.find(\n              category => category.id.toString() === $stateParams.category_id\n            )\n\n            return {\n              current: {\n                name: category.name,\n                state: 'main.shop.collection.category',\n                params: {\n                  collection_id: $stateParams.collection_id,\n                  category_id: $stateParams.category_id,\n                },\n              },\n              parents: [\n                ...(!isWaysToShopEnabled() ? [] : [shopContentParents.waysToShop]),\n                shopContentParents.collections,\n                {\n                  name: collectionCategories.name,\n                  state: 'main.shop.collection',\n                  params: { collection_id: $stateParams.collection_id },\n                },\n              ],\n              siblings: collectionCategories,\n              children: [],\n            }\n          },\n        },\n\n        views: shopContentViews,\n      })\n\n      .state('main.shop.offersAndCoupons', {\n        url: '/offersAndCoupons',\n\n        resolve: {\n          loadCtrl: $ocLazyLoad => {\n            return import(\n              /* webpackChunkName: \"collectionPreviewsController\", webpackPrefetch: true */ './controllers/collectionPreviewsController'\n            )\n              .then(mod => $ocLazyLoad.load(mod.default))\n              .catch(err => {\n                throw new Error(`Ooops, something went wrong, ${err}`)\n              })\n          },\n          collections($q, lang, Restangular) {\n            function convertToCollection(name, sref) {\n              return function convertToCollectionObject(items) {\n                return {\n                  name,\n                  items,\n                  sref,\n                }\n              }\n            }\n\n            const offers = Restangular.all('offers')\n              .getList(configConstants.offersAndCoupons.queries.offers)\n              .then(convertToCollection(lang.values.offers, 'main.shop.offers'))\n            const coupons = Restangular.all('offers')\n              .getList(configConstants.offersAndCoupons.queries.coupons)\n              .then(convertToCollection(lang.values.coupons, 'main.shop.coupons'))\n            return $q.all([offers, coupons]).then(([offers, coupons]) => {\n              const offersAndCollections = [...offers.items, ...coupons.items]\n\n              _offerAnalytics.viewOffers({\n                offers: offersAndCollections,\n                offerPageMeta: configConstants.offersAndCoupons.queries,\n                offerOrigin: null,\n              })\n\n              return [offers, coupons]\n            })\n          },\n\n          tree() {\n            return {\n              current: shopContentParents.offersAndCoupons,\n              parents: !isWaysToShopEnabled() ? [] : [shopContentParents.waysToShop],\n            }\n          },\n        },\n\n        views: {\n          'content@main.shop': {\n            template: require('./views/collectionPreviews.html'),\n            controller: 'CollectionPreviewsController',\n            children: [],\n          },\n        },\n      })\n\n      .state('main.shop.recipes', {\n        url: '/recipes',\n        views: shopContentViews,\n        data: {\n          section: 'recipes',\n        },\n        resolve: {\n          loadCtrl: loadShopContentViewsCtrl,\n          src($stateParams) {\n            // Show subcategories unless tags or brands are applied,\n            // otherwise show products\n\n            return {\n              endpoint:\n                ($stateParams.tags && $stateParams.tags.length) || $stateParams.brand_name\n                  ? 'recipes'\n                  : null,\n            }\n          },\n\n          recipeCategoriesFetched: recipeCategoriesService => recipeCategoriesService.fetch(),\n          savedRecipesFetched: savedRecipesService => savedRecipesService.getSavedRecipes(),\n\n          tree(lang, recipeCategoriesFetched, recipeCategoriesService) {\n            // We must inject recipeCategoriesFetched to ensure the call to categories has been completed\n            // Include recipe tags from API into tree's `current` structure\n            recipesTreeStates.recipesHome.tags = recipeCategoriesService.tags\n\n            const tree = {\n              current: recipesTreeStates.recipesHome,\n              children: recipeCategoriesService.rootCategories(),\n              promoted: [],\n              siblings: [],\n            }\n\n            if (configConstants.enableSavedRecipes && !configConstants.disableRecipes) {\n              // Pass a type to determine which tile type to display\n              recipesTreeStates.savedRecipes.tile = 'saved-recipes'\n\n              // Add it to the promoted array which will display in front of the rest of the categories\n              tree.promoted.push(recipesTreeStates.savedRecipes)\n            }\n\n            return tree\n          },\n        },\n      })\n\n      .state('main.shop.recipes.category', {\n        url: '/categories/:recipe_category_id',\n        views: shopContentViews,\n        resolve: {\n          loadCtrl: loadShopContentViewsCtrl,\n          src($state, $stateParams, recipeCategoriesService) {\n            const recipeCategory = recipeCategoriesService.getCategoryFromId(\n              $stateParams.recipe_category_id\n            )\n            if (!recipeCategory) {\n              $state.go('main.404')\n            }\n\n            // Show recipe tiles instead of recipe category tiles starting on this recipeCategory level (and deeper)\n            // NOTE: The level AFTER \"Recipes\" is level 0\n            const categoryLevelToShowRecipeTiles = configConstants.categoryLevelToShowRecipes\n            return {\n              // Call the 'recipe' endpoint if the following conditions are met:\n              endpoint:\n                recipeCategory.level >= categoryLevelToShowRecipeTiles ||\n                recipeCategory.level === null ||\n                recipeCategory.children.length === 0\n                  ? 'recipes'\n                  : null,\n            }\n          },\n          tree(\n            $q,\n            lang,\n            $stateParams,\n            recipeCategoriesFetched,\n            recipeCategoriesService,\n            savedRecipesService\n          ) {\n            // We must inject recipeCategoriesFetched to ensure the call to categories has been completed\n\n            savedRecipesService.getSavedRecipes()\n\n            const recipeCategory = recipeCategoriesService.getCategoryFromId(\n              $stateParams.recipe_category_id\n            )\n            recipeCategory.tags = recipeCategoriesService.tags\n\n            return {\n              current: recipeCategory,\n              parents: [\n                recipesTreeStates.recipesHome,\n                ...recipeCategoriesService.getParents(recipeCategory).map(parent => ({\n                  name: parent.name,\n                  state: 'main.shop.recipes.category',\n                  params: { recipe_category_id: parent.params.recipe_category_id },\n                })),\n              ],\n              children: recipeCategoriesService.getChildren(recipeCategory),\n              siblings: recipeCategoriesService.getSiblings(recipeCategory),\n            }\n          },\n          onExit: () => {\n            deleteJsonLd()\n          },\n        },\n      })\n\n      // Saved Recipes\n\n      .state('main.shop.recipes.saved', {\n        url: '/saved',\n        views: shopContentViews,\n        data: {\n          recipesHomeState: recipesTreeStates.recipesHome,\n          requireRegistered: true,\n          section: 'savedRecipes',\n        },\n        resolve: {\n          loadCtrl: loadShopContentViewsCtrl,\n          src($state) {\n            if (!configConstants.enableSavedRecipes) {\n              $state.go('main.404')\n            }\n\n            return {\n              endpoint: 'recipes/saved',\n            }\n          },\n          tree(lang, recipeCategoriesFetched, recipeCategoriesService, savedRecipesService) {\n            // We must inject recipeCategoriesFetched to ensure the call to categories has been completed\n\n            savedRecipesService.getSavedRecipes()\n\n            const tree = {\n              current: recipesTreeStates.savedRecipes,\n              siblings: recipeCategoriesService.rootCategories(),\n              parents: [recipesTreeStates.recipesHome],\n            }\n\n            if (configConstants.enableSavedRecipes && !configConstants.disableRecipes) {\n              tree.siblings.unshift(recipesTreeStates.savedRecipes)\n            }\n\n            return tree\n          },\n        },\n      })\n\n      // Featured Departments\n\n      .state('main.shop.departments', {\n        url: '/featured/:category_id?collections',\n        resolve: {\n          loadCtrl: $ocLazyLoad => {\n            const importShopMenuController = import(\n              /* webpackChunkName: \"shopMenuController\", webpackPrefetch: true */ './controllers/shopMenuController'\n            )\n            const importFeaturedDepartmentController = import(\n              /* webpackChunkName: \"featuredDepartmentController\", webpackPrefetch: true */ './controllers/featuredDepartmentController'\n            )\n\n            return Promise.all([importShopMenuController, importFeaturedDepartmentController])\n              .then(values => {\n                $ocLazyLoad.load(values.map(module => module.default))\n              })\n              .catch(err => {\n                throw new Error(`Ooops, something went wrong, ${err}`)\n              })\n          },\n          featuredDepartment($stateParams, $state, configConstants, placementsService) {\n            if (\n              configConstants.allowPassingCollectionIDAsQueryParams?.merchandisingLandingPage &&\n              placementsService.getURLPassedCollectionsList($stateParams)?.length > 0\n            ) {\n              return placementsService.getFeaturedDepartmentById(\n                $stateParams.category_id,\n                placementsService.getURLPassedCollectionsList($stateParams)\n              )\n            }\n            return placementsService.getFeaturedDepartmentById($stateParams.category_id)\n          },\n\n          featuredDepartmentCollections(\n            $state,\n            $stateParams,\n            configConstants,\n            collectionsService,\n            featuredDepartment,\n            placementsService\n          ) {\n            const collectionList = featuredDepartment?.target?.collection_list\n            if (!collectionList) {\n              $state.go('main.404')\n              return []\n            }\n            return collectionsService.getCollectionsFromSet(collectionList).then(result => {\n              result.forEach(item => {\n                item.featuredDepartmentID =\n                  placementsService.getURLPassedCollectionsList($stateParams)?.length > 0 &&\n                  configConstants.allowPassingCollectionIDAsQueryParams?.merchandisingLandingPage\n                    ? $stateParams.category_id\n                    : featuredDepartment.id.toString()\n              })\n              return result\n            })\n          },\n\n          featuredDepartmentCollectionCategories(\n            collectionsCategoriesService,\n            featuredDepartmentCollections\n          ) {\n            return collectionsCategoriesService.buildFeaturedDepartmentCollectionCategories(\n              featuredDepartmentCollections\n            )\n          },\n\n          tree(\n            $stateParams,\n            catalogCategoriesService,\n            collectionsCategoriesService,\n            featuredDepartment,\n            featuredDepartmentCollections,\n            featuredDepartmentCollectionCategories\n          ) {\n            return {\n              current: {\n                name: featuredDepartment.name,\n                state: 'main.shop.departments',\n                placement: featuredDepartment,\n              },\n              parents: [\n                ...(!isWaysToShopEnabled() ? [] : [shopContentParents.waysToShop]),\n                {\n                  name: 'Departments',\n                  state: 'main.shop.categories',\n                },\n              ],\n              children: featuredDepartmentCollectionCategories,\n              siblings: [],\n            }\n          },\n        },\n\n        views: shopDepartmentViews,\n      })\n\n      // 'Pseudo route' to allow retailers to load their GTM loaded personalization script which will run, send an xhr request\n      // to their personalization provider (Adobe), and wait for a list of collection id's to be returned. Once this is returned\n      // they can route the user to the MLP, i.e. '/shop/featured/:category_id?collections=$retailerCollectionArray'.\n\n      // We put in a timeout in case the clients personalization script fails, in which case we route them to the default MLP\n      .state('main.shop.departments.loading', {\n        url: '/script-loading',\n        resolve: {\n          waitForRetailerScript($state, $stateParams, $timeout) {\n            $timeout(\n              () => {\n                $state.go('main.shop.departments', {\n                  category_id: $stateParams.category_id,\n                })\n              },\n              configConstants.allowPassingCollectionIDAsQueryParams?.merchandisingLandingPage\n                ? SCRIPT_TIMEOUT\n                : 0\n            )\n            return new Promise(() => {})\n          },\n        },\n      })\n\n      // Individual featured department collection subcategory\n      .state('main.shop.departments.featured', {\n        url: '/{collection_id:int}',\n\n        resolve: {\n          loadCtrl: loadShopContentViewsCtrl,\n\n          categoryID($stateParams) {\n            return $stateParams.category_id\n          },\n\n          src($stateParams) {\n            return {\n              endpoint: `collections/${$stateParams.collection_id}`,\n              params: {\n                // This isn't a real category, don't pass it to the API call otherwise it will\n                // filter by the placement ID and return no product results\n                category_id: null,\n              },\n            }\n          },\n\n          tree(\n            $stateParams,\n            categoryID,\n            collectionsCategoriesService,\n            featuredDepartmentCollections,\n            featuredDepartmentCollectionCategories,\n            featuredDepartment\n          ) {\n            const featuredCollection = featuredDepartmentCollectionCategories.find(\n              featuredDepartmentCollection =>\n                featuredDepartmentCollection.params.collection_id.toString() ===\n                $stateParams.collection_id.toString()\n            )\n\n            return {\n              current: {\n                name: featuredCollection.name,\n                state: 'main.shop.departments.featured',\n                params: {\n                  collection_id: $stateParams.collection_id,\n                  category_id: categoryID,\n                },\n              },\n              parents: [\n                ...(!isWaysToShopEnabled() ? [] : [shopContentParents.waysToShop]),\n                {\n                  name: 'Departments',\n                  state: 'main.shop.categories',\n                },\n                {\n                  name: featuredDepartment.name,\n                  state: 'main.shop.departments',\n                  params: {\n                    category_id: categoryID,\n                  },\n                },\n              ],\n              siblings: featuredDepartmentCollectionCategories,\n              children: [],\n            }\n          },\n        },\n\n        views: shopContentViews,\n      })\n\n      // Merchandised Landing Page\n\n      .state('main.shop.mlp', {\n        url: '/featured/:mlp_id/:mlp_slug?collections',\n        resolve: {\n          loadCtrl: $ocLazyLoad => {\n            const importShopMenuController = import(\n              /* webpackChunkName: \"shopMenuController\", webpackPrefetch: true */ './controllers/shopMenuController'\n            )\n            const importMerchandisedLandingPageController = import(\n              /* webpackChunkName: \"merchandisedLandingPageController\", webpackPrefetch: true */ './controllers/merchandisedLandingPageController'\n            )\n\n            return Promise.all([importShopMenuController, importMerchandisedLandingPageController])\n              .then(values => {\n                $ocLazyLoad.load(values.map(module => module.default))\n              })\n              .catch(err => {\n                throw new Error(`Ooops, something went wrong, ${err}`)\n              })\n          },\n\n          async merchandisedLandingPage(\n            $stateParams,\n            collectionsService,\n            configConstants,\n            placementsService\n          ) {\n            const collectionIdsFromURLParams = placementsService.getURLPassedCollectionsList(\n              $stateParams\n            )\n            const enableCollectionsURLParams =\n              configConstants.allowPassingCollectionIDAsQueryParams?.merchandisingLandingPage\n\n            const merchandisedLandingPage = await getMerchandisedLandingPage($stateParams.mlp_id)\n\n            if (\n              collectionIdsFromURLParams &&\n              collectionIdsFromURLParams.length > 0 &&\n              enableCollectionsURLParams\n            ) {\n              const collectionsFromSet = await collectionsService.getCollectionsFromSet(\n                collectionIdsFromURLParams\n              )\n\n              const mlpContentFromURL = collectionsFromSet.map(collection => ({\n                data: collection,\n                type: 'collection',\n              }))\n\n              return {\n                mlp: merchandisedLandingPage.mlp,\n                mlp_content: mlpContentFromURL,\n              }\n            }\n            return merchandisedLandingPage\n          },\n\n          merchandisedLandingPageCollectionCategories(merchandisedLandingPage) {\n            return merchandisedLandingPage.mlp_content\n              .filter(({ type }) => type === 'collection')\n              .map(({ data: { id, display_name, name } }) => ({\n                state: 'main.shop.mlp.collection',\n                name: display_name || name,\n                params: { collection_id: id },\n              }))\n          },\n\n          tree(merchandisedLandingPage, merchandisedLandingPageCollectionCategories) {\n            return {\n              current: {\n                name: merchandisedLandingPage.mlp.name,\n                state: 'main.shop.mlp',\n              },\n              parents: [\n                ...(!isWaysToShopEnabled() ? [] : [shopContentParents.waysToShop]),\n                {\n                  name: 'Departments',\n                  state: 'main.shop.categories',\n                },\n              ],\n              children: merchandisedLandingPageCollectionCategories,\n              siblings: [],\n            }\n          },\n        },\n\n        views: shopMerchandisedLandingPageViews,\n      })\n\n      .state('main.shop.mlp.collection', {\n        url: '/{collection_id:int}',\n\n        resolve: {\n          loadCtrl: loadShopContentViewsCtrl,\n\n          src($stateParams) {\n            return {\n              endpoint: `collections/${$stateParams.collection_id}`,\n              params: {\n                // This isn't a real category, don't pass it to the API call otherwise it will\n                // filter by the placement ID and return no product results.\n                category_id: null,\n              },\n            }\n          },\n\n          merchandisedLandingPageCollection($stateParams, merchandisedLandingPage) {\n            return merchandisedLandingPage.mlp_content.find(\n              ({ type, data: { id } }) => type === 'collection' && id === $stateParams.collection_id\n            )?.data\n          },\n\n          tree(\n            merchandisedLandingPage,\n            merchandisedLandingPageCollection,\n            merchandisedLandingPageCollectionCategories\n          ) {\n            const { display_name: displayName, name } = merchandisedLandingPageCollection\n\n            return {\n              current: {\n                name: displayName || name,\n                state: 'main.shop.mlp.collection',\n              },\n              parents: [\n                ...(!isWaysToShopEnabled() ? [] : [shopContentParents.waysToShop]),\n                {\n                  name: 'Departments',\n                  state: 'main.shop.categories',\n                },\n                {\n                  name: merchandisedLandingPage.mlp.name,\n                  state: 'main.shop.mlp',\n                },\n              ],\n              siblings: merchandisedLandingPageCollectionCategories,\n              children: [],\n            }\n          },\n        },\n\n        views: shopContentViews,\n      })\n\n      // Flyer - Flipp\n\n      .state('main.shop.flyerFlipp', {\n        cache: false,\n        url: '/flyers',\n        resolve: {\n          loadCtrl: $ocLazyLoad => {\n            const importFlyerFlippController = import(\n              /* webpackChunkName: \"flyerFlippController\", webpackPrefetch: true */ './controllers/flyerFlippController'\n            )\n\n            return Promise.all([importFlyerFlippController])\n              .then(values => {\n                $ocLazyLoad.load(values.map(module => module.default))\n              })\n              .catch(err => {\n                throw new Error(`Ooops, something went wrong, ${err}`)\n              })\n          },\n        },\n        views: shopFlyerFlippViews,\n      })\n  })\n  .run(($templateCache, offerAnalytics) => {\n    _offerAnalytics = offerAnalytics\n\n    $templateCache.put('shopMenu.desktop.html', require('./views/shopMenu.desktop.html'))\n    $templateCache.put('shopMenu.mobile.html', require('./views/shopMenu.mobile.html'))\n    $templateCache.put('shopPagination.html', require('./views/shopPagination.html'))\n    $templateCache.put('shopCells.html', require('./views/shopCells.html'))\n    $templateCache.put('shopSubcategories.html', require('./views/shopSubcategories.html'))\n    $templateCache.put('recipeCategories.html', require('../recipes/recipeCategories.html'))\n    $templateCache.put('cellContainer.html', require('../shared/cellContainer/cellContainer.html'))\n    $templateCache.put('categoryCard.html', require('../shared/categoryCard/categoryCard.html'))\n    $templateCache.put(\n      'pagination-modified-uibootstrap-desktop.html',\n      require('../shared/pagination/pagination-modified-uibootstrap-desktop.html')\n    )\n    $templateCache.put(\n      'pagination-modified-uibootstrap-mobile.html',\n      require('../shared/pagination/pagination-modified-uibootstrap-mobile.html')\n    )\n  })\n","import angular from 'angular'\n\nimport CatalogCategoriesService from './services/catalogCategoriesService'\nimport CollectionsCategoriesService from './services/collectionsCategoriesService'\nimport CouponsCategoriesService from './services/couponsCategoriesService'\nimport FlyerCategoriesAndPdfsService from './services/flyerCategoriesAndPdfs.service'\nimport PurchasesCategoriesService from './services/purchasesCategoriesService'\nimport CategoryFilterDirective from './categoryFilterDirective'\nimport Shop from './shopRoutes'\n\nexport default angular.module('app.component.shopModule', [\n  CatalogCategoriesService.name,\n  CollectionsCategoriesService.name,\n  CouponsCategoriesService.name,\n  FlyerCategoriesAndPdfsService.name,\n  PurchasesCategoriesService.name,\n  CategoryFilterDirective.name,\n  Shop.name,\n])\n","import angular from 'angular'\n\nexport default angular\n  .module('MobileAppInfoComponentModule', [])\n  .config(($stateProvider, langProvider) => {\n    $stateProvider.state('main.mobileAppInfo', {\n      url: '/about-this-app',\n      views: {\n        'content@': {\n          controller: 'MobileAppInfoController',\n          template: require('./mobileAppInfo.html'),\n        },\n      },\n      resolve: {\n        loadCtrl: $ocLazyLoad => {\n          return import(\n            /* webpackChunkName: \"mobileAppInfoController\", webpackPrefetch: true */ './mobileAppInfoController'\n          )\n            .then(mod => $ocLazyLoad.load(mod.default))\n            .catch(err => {\n              throw new Error(`Ooops, something went wrong, ${err}`)\n            })\n        },\n        title(titleService) {\n          return titleService.setTitle(langProvider.values.aboutThisApp || 'About this app')\n        },\n      },\n    })\n  })\n","import angular from 'angular'\nimport MobileAppInfoRoutes from './mobileAppInfoRoutes.js'\n\nexport default angular.module('app.component.mobileAppInfoModule', [MobileAppInfoRoutes.name])\n","import angular from 'angular'\n\nexport default angular\n  .module('CartListTransferStateControllerComponentModule', [])\n  .controller(\n    'CartListTransferStateController',\n    function (\n      $scope,\n      $stateParams,\n      auth,\n      cartListTransferService,\n      cartService,\n      compareCartService,\n      lang\n    ) {\n      $scope.lang = lang\n      $scope.cartListTransferLoaded = false\n\n      const { initialContext } = $stateParams\n      const { updatedContext } = $stateParams\n\n      cartService.fetch().then(() => {\n        compareCartService\n          .compareCart(true, 'fulfillment', { fulfillment_type: updatedContext })\n          .then(result => {\n            cartListTransferService.initializeTransfer({\n              initialContext,\n              updatedContext,\n              transferData: result,\n            })\n          })\n          .then(() => auth.setContext({ intent: updatedContext }))\n          .then(() => {\n            $scope.cartListTransferLoaded = true\n          })\n      })\n    }\n  )\n","import angular from 'angular'\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\nimport template from './cartListTransfer.component.html'\n\nexport default angular.module('CartListTransferComponentModule', []).component('cartListTransfer', {\n  template,\n  controller(\n    $state,\n    auth,\n    cartService,\n    cartListTransferService,\n    config,\n    lang,\n    mobileService,\n    oneCartService,\n    shoppingContextService\n  ) {\n    // We assume the cartListTransferService.initializeTransfer() has been called\n    const {\n      cancelContextSwitch,\n      completeContextSwitch,\n      transferData: { numCustom, numTotal, numTransferable },\n      transferStatus,\n    } = cartListTransferService\n\n    const initialContext = auth.getContext().intent\n    const updatedContext = shoppingContextService.selectedFulfillmentType\n\n    Object.assign(this, {\n      lang,\n      config,\n      transferStatus,\n      numTransferable,\n      cancelContextSwitch,\n      completeContextSwitch,\n      mobile: mobileService,\n      cartListTransferService,\n      hideButton: { yes: false },\n    })\n\n    this.transferItems = () => {\n      this.hideButton.yes = true\n      // We need to pass the a redirect route if we are in the cart review page and one cart is enabled\n      cartListTransferService.transferItems(\n        oneCartService.enabled() && $state.current.name === 'main.checkout.cartV2'\n          ? 'main.home'\n          : null\n      )\n    }\n\n    this.loadImg = image => {\n      // eslint-disable-next-line import/no-dynamic-require\n      return require(`static/images/${image}`)\n    }\n\n    // Check if a redirect back to the .Com is necessary\n\n    // eslint-disable-next-line eqeqeq\n    this.shouldRedirectToDotCom = $state.current.name == 'cartListTransfer'\n\n    // Determine copy to show user\n\n    const initialCartOrList =\n      initialContext === SHOPPING_MODES.INSTORE_LIST\n        ? lang.values.inStoreList\n        : lang.values.shoppingCart\n    const updatedCartOrList =\n      updatedContext === SHOPPING_MODES.INSTORE_LIST\n        ? lang.values.inStoreList\n        : lang.values.shoppingCart\n    const initialContextTitle = shoppingContextService.getShoppingModeTitle(initialContext)\n    const updatedContextTitle =\n      config.shoppingSelector[updatedContext].shortTitle ||\n      config.shoppingSelector[updatedContext].title\n\n    this.stayInShoppingModeText = lang.template(lang.values.stayInShoppingMode, {\n      shoppingMode: initialContextTitle,\n    })\n\n    if (numTransferable === 0) {\n      // If NO products can be transfered\n      this.cartListTransferTitle = lang.template(\n        lang.values.transferBetweenCartAndList.titleTransferUnavailable,\n        { initialContextTitle }\n      )\n\n      const unavailableText = lang.values.transferBetweenCartAndList.messageTransferUnavailable\n      this.cartListTransferMsg = lang.template(unavailableText.msg, { updatedContextTitle })\n      this.cartListTransferFollowUp =\n        numCustom === 0\n          ? lang.template(unavailableText.remainingProducts, { numTotal, initialCartOrList })\n          : lang.template(unavailableText.remainingProductsWithCustom, {\n              numTotal,\n              initialCartOrList,\n              numCustom,\n            })\n      this.doNotTransferTxt = lang.template(lang.values.transferBetweenCartAndList.yesContinue, {\n        updatedContextTitle,\n      })\n    } else {\n      // If products can be transfered\n      this.cartListTransferTitle = lang.template(\n        lang.values.transferBetweenCartAndList.titleTransferAvailable,\n        { numTransferable, initialCartOrList }\n      )\n\n      const availableText = lang.values.transferBetweenCartAndList.messageTransferAvailable\n      this.cartListTransferFollowUp = lang.template(availableText.question, { updatedCartOrList })\n      this.doNotTransferTxt = lang.values.no\n\n      if (numTransferable < numTotal) {\n        // If SOME products can be transfered\n        this.cartListTransferMsg = lang.template(availableText.someMsg, {\n          numTransferable,\n          numTotal,\n          initialCartOrList,\n          updatedContextTitle,\n        })\n\n        // Add note about the remaining products in their cart/list (with info about custom items if they have any)\n        this.cartListTransferFollowUp += ` ${\n          numCustom === 0\n            ? lang.template(availableText.remainingProducts, { initialCartOrList })\n            : lang.template(availableText.remainingProductsWithCustom, {\n                numCustom,\n                initialCartOrList,\n              })\n        }`\n      } else {\n        // If ALL products can be transfered\n        this.cartListTransferMsg = lang.template(availableText.allMsg, {\n          numTotal,\n          initialCartOrList,\n          updatedContextTitle,\n        })\n      }\n    }\n  },\n})\n","import angular from 'angular'\nimport template from './cartListTransferState.html'\nimport CartListTransferStateControllerModule from './cartListTransferState.controller.js'\nimport CartListTransferComponentModule from './cartListTransfer.component.js'\n\nexport default angular\n  .module('CartListTransferModule', [\n    CartListTransferStateControllerModule.name,\n    CartListTransferComponentModule.name,\n  ])\n  .config(($stateProvider, langProvider) => {\n    $stateProvider.state('cartListTransfer', {\n      url: '/cart_transfer?initialContext&updatedContext&redirect',\n      views: {\n        'content@': {\n          template,\n          controller: 'CartListTransferStateController',\n        },\n      },\n      resolve: {\n        title(titleService) {\n          return titleService.setTitle(langProvider.values.cartListTransfer)\n        },\n      },\n      onEnter: ($stateParams, auth, config) => {\n        if (!auth.user.context || !auth.user.context.intent) {\n          auth.setContext({ intent: config.defaultShoppingContext })\n        }\n      },\n    })\n  })\n","import angular from 'angular'\nimport dayjs from 'dayjs'\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\nimport { DEFAULT_TIMESLOT_DATE_FORMAT } from '@app/angular/constants/timeslots'\nimport { utils as timeslotUtils } from '@instacart/enterprise-timeslots'\nimport { hasBannerImage } from '@app/utils/banners.ts'\n\nexport default angular\n  .module('ShoppingSelectorConfirmationControllerComponentModule', [])\n  .controller(\n    'ShoppingSelectorConfirmationController',\n    function (\n      $controller,\n      $scope,\n      $state,\n      addressList,\n      auth,\n      cartService,\n      config,\n      eComLightService,\n      errorModalService,\n      modalOptions,\n      shoppingContextService\n    ) {\n      $controller('ContextSelectorController', {\n        $scope,\n      })\n\n      $scope.shoppingContextService = shoppingContextService\n      $scope.hasBannerImage = hasBannerImage()\n\n      // Switch to default store and go to context selector view.\n\n      function exitB2bMode() {\n        auth\n          .update({ store_id: null })\n          .then(() => {\n            $scope.$parent.setShoppingSelectorStage('shoppingContext')\n          })\n          .catch(() => {\n            errorModalService\n              .open(config.lang.defaultErrorMessage, 'Reload', 'Back To Home')\n              .then(() => {\n                window.location.reload()\n              })\n              .catch(() => {\n                $state.go('main.home', null, { reload: true })\n              })\n          })\n      }\n\n      // When user selects \"Change\" next to the store/zip code, proceed differently depending on whether or not they are in B2B mode\n\n      $scope.changeStoreOrZipcode = function () {\n        modalOptions.reset()\n\n        if (auth.user.store.is_b2b) {\n          exitB2bMode()\n        } else {\n          if (config.eComLight?.enabled && eComLightService.inEComLightMode) {\n            shoppingContextService.setSelectedFulfillmentType(SHOPPING_MODES.CATERING)\n          }\n          $scope.$parent.setShoppingSelectorStage('storeSelector')\n        }\n      }\n\n      $scope.cartEmpty = function () {\n        // Cart doesn't exist, or is empty.\n        return !$scope.cartService.cart || !$scope.cartService.cart.items.length\n      }\n\n      $scope.changeTimeslot = () => {\n        modalOptions.reset()\n        $scope.$parent.setShoppingSelectorStage('timeslot')\n      }\n\n      $scope.changeBanner = () => {\n        modalOptions.reset()\n        $scope.$parent.setShoppingSelectorStage('bannerSelector')\n      }\n\n      const format = 'hh:mm:ss'\n      const time = dayjs()\n      const morningStartTime = dayjs('04:00:00', format)\n      const afternoonStartTime = dayjs('12:00:00', format)\n      const eveningStartTime = dayjs('18:00:00', format)\n\n      $scope.unifiedWelcomeMessage = function () {\n        if (time.isBetween(morningStartTime, afternoonStartTime)) {\n          return 'Good Morning'\n        }\n        if (time.isBetween(afternoonStartTime, eveningStartTime)) {\n          return 'Good Afternoon'\n        }\n        return 'Good Evening'\n      }\n\n      // prevents b2b mode infinite loop when no timeslots are available\n      $scope.startContinueShopping = function () {\n        auth.user.store.is_b2b ? $scope.$parent.processModalCloseClick() : $scope.$dismiss()\n      }\n\n      // show change link if more than one selector modes are enabled\n      $scope.showChangeLink =\n        Object.values(config.shoppingSelector).filter(({ exists }) => exists).length > 1\n\n      $scope.timeslotLabelFn = () =>\n        timeslotUtils.getMainLabel($scope?.reservationService?.displayReservation, {\n          verboseLevel: 1,\n          returnLabel: false,\n          format: $scope.reservationService.reservation\n            ? config.apiDateFormat\n            : DEFAULT_TIMESLOT_DATE_FORMAT,\n        })\n\n      const context = auth.getContext()\n      if (context.intent === 'delivery') {\n        $scope.deliveryAddress = auth.getAddressFromContext()\n        if ($scope.deliveryAddress.id) {\n          addressList\n            .getAddresses()\n            .then(\n              () =>\n                ($scope.deliveryAddress = addressList.getAddressFromId($scope.deliveryAddress.id))\n            )\n        }\n      }\n\n      if (config.multipleBanners.enabled && context.intent === 'delivery') {\n        const bannerSlug = auth.user.store?.store_banner?.key\n        const bannerInfo = config.multipleBanners?.banners?.find(b => b.bannerSlug === bannerSlug)\n        $scope.bannerSlug = bannerInfo?.bannerSlug\n        $scope.bannerName = bannerInfo?.name\n      }\n    }\n  )\n","import angular from 'angular'\n\nexport default angular.module('ShoppingSelectorContextItem', []).component('shoppingContextItem', {\n  bindings: {\n    classIcons: '<',\n    ctxName: '<',\n    isActive: '<',\n    showTransition: '<',\n  },\n  controller(config, lang) {\n    this.id = `shopping-selector-shop-context-intent-${this.ctxName}`\n    this.class = `li-el ${this.classIcons} icon ${this.ctxName}-context`\n    this.title = config.shoppingSelector[this.ctxName].title\n    this.selectedSrText = lang.values.selected\n  },\n  template: `\n      <button\n        id=\"{{ $ctrl.id }}\"\n        class=\"{{ $ctrl.class }}\"\n        ng-class=\"{ active: $ctrl.isActive, 'modal-transition': $ctrl.showTransition }\"\n        aria-current=\"{{ $ctrl.isActive }}\"\n      >\n        <div class=\"shopping-context-list-title\">\n          <span>{{ $ctrl.title }}</span>\n          <span ng-if=\"$ctrl.isActive\" class=\"screen-reader-text\">{{ $ctrl.selectedSrText }}</span>\n        </div>\n      </button>\n    `,\n})\n","/**\n * Turns the value of a context param into a json blob\n * See app/angular/services/modules/userOverridesV2.service.js\n *\n * @param {object} paramsObject  - All params from the url\n * @param {string} name          - The param to select\n * @param {object} ALLOWED_OVERRIDES   - The params to allow, as a map with their types\n *\n * @returns {object}\n */\nexport default function parse(paramsObject, name, ALLOWED_OVERRIDES) {\n  const urlParamValue = paramsObject[name]\n  if (!urlParamValue) return null\n\n  // Regexp\" Insert quotes around key/values (fix ending for validity)\n  const jsonReadyValue = `${urlParamValue}${!urlParamValue.endsWith(',') ? ',' : ''}`\n    .replace(/(.+?):(.+?),/g, '\"$1\":\"$2\",')\n    .slice(0, -1)\n\n  try {\n    const overrides = JSON.parse(`{${jsonReadyValue}}`)\n\n    // Filter out overrides not in ALLOWED_OVERRIDES, convert those that are to the correct type\n    return Object.entries(overrides).reduce((out, [key, value]) => {\n      const newOut = key in ALLOWED_OVERRIDES ? { [key]: ALLOWED_OVERRIDES[key](value) } : {}\n      return { ...out, ...newOut }\n    }, {})\n  } catch (e) {\n    console.warn(`Could not process url \"${name}\" param - wrong format`, urlParamValue, e)\n    return null\n  }\n}\n","import angular from 'angular'\nimport debounce from 'lodash/debounce'\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\nimport { SHOPPING_SELECTOR_STAGES } from '@app/angular/constants/shoppingSelectorStages'\nimport parse from '@app/utils/parseV2ContextParam'\n\n/**\n * User can be forced into a certain store/context through URL override context params\n *\n * NOTE: See ALLOWED_OVERRIDES below for currently supported overrides\n *\n * The format should be like this (you can combine, using \"context\" for defaults):\n *  - \"?context=mode:delivery,location.zip:26201,...\"\n *  - \"?context_trial=mode:pickup,location.store:34,...\"\n *  - \"?context_authed=mode:delivery,location.name:26201,...\"\n *\n * Override names (e.g. mode:...,location.zip:...) must be defined in ALLOWED_OVERRIDES below\n *\n * This provides a more simple alternative to userOverridesService\n * It leverages the the shopping context modal selector to do the work\n * This means that as we change the way context works, this won't break,\n * which should hopefully make this code much easier to maintain\n */\n\n/** Constants for override key names, exported */\nexport const URL_OVERRIDES = {\n  MODE: 'mode',\n  DISMISS_INITIAL_MODALS: 'dismissInitialModals',\n}\n\n/** The URL can contain params: context_trial, context_authed and/or context (for defaults) */\nconst PARAMS = {\n  CONTEXT: 'context',\n  CONTEXT_TRIAL: 'context_trial',\n  CONTEXT_AUTHED: 'context_authed',\n}\n\n/** Allowed override options (anything else will be filtered out) */\nconst ALLOWED_OVERRIDES = {\n  [URL_OVERRIDES.MODE]: String, // The mode to choose in the shopping selector\n  /* TODO Future options for this (to be implemented)\n    'location.zip': String, // The zip to use on the location step\n    'location.store': Number, // The store id to use\n    'location.name': String, // The store name to use\n    time: Number, // The timeslot to select as an offset in hours from now\n    closeable: Boolean, // [true|false] Show close button on context select when it shows up\n    forceClose: Boolean, // [true|false] Close the shopping selector even if not complete after this\n    dismissCartCompare: Boolean, // [true|false] Auto-accept the result of any cart compare\n  */\n  [URL_OVERRIDES.DISMISS_INITIAL_MODALS]: Boolean, // [true|false] Close sign up modals, any other modals before this\n}\n\n/** User Overrides V2 Service */\nexport default angular\n  .module('userOverridesV2ServicesModule', [])\n  .service(\n    'userOverridesV2Service',\n    function userOverridesV2Service(\n      $q,\n      $rootScope,\n      $timeout,\n      $uibModalStack,\n      auth,\n      shoppingSelectorService\n    ) {\n      const service = this\n      let capturedParams = null // Initially null to indicate not yet captured\n\n      /**\n       * A list of valid url param names we're watching for\n       *\n       * Used by app.js to remove the params from the url after capture\n       */\n      service.PARAM_NAMES = Object.values(PARAMS)\n\n      /**\n       * STEP 1\n       * Pre-captures and records context params from the url (if any) for later usage\n       * Note: See top comment for url param formatting\n       *\n       * Called in app.js at the point the router map params\n       * (This potentially gets fired multiple times, so once we collect, we ignore any excess calls)\n       *\n       * @param {object} paramObject  - The object of urls params and their values\n       */\n      service.preCaptureContextParamOverrides = paramObject => {\n        const defaults = parse(paramObject, PARAMS.CONTEXT, ALLOWED_OVERRIDES)\n        const trial = parse(paramObject, PARAMS.CONTEXT_TRIAL, ALLOWED_OVERRIDES)\n        const authed = parse(paramObject, PARAMS.CONTEXT_AUTHED, ALLOWED_OVERRIDES)\n\n        capturedParams = capturedParams || {} // Shows that this got called at least once\n\n        if (defaults || trial) {\n          capturedParams.trial = { ...defaults, ...trial }\n        }\n        if (defaults || authed) {\n          capturedParams.authed = { ...defaults, ...authed }\n        }\n      }\n\n      /**\n       * Helper function - Listen for auth events, set up actions and call debounced callback\n       *\n       * @param {function} callback    - Callback once intent is present\n       *                                 (Call the passed param to stop listening)\n       * @param {function} [firstCall] - Optional: Always called on the first auth event triggered\n       */\n      service.onAuthReady = (callback, firstCall = null) => {\n        const callbackDebounced = debounce(destroyListenerCallback => {\n          if (auth.getContext()?.intent !== undefined) {\n            callback(destroyListenerCallback)\n          }\n        }, 100)\n\n        let hasDoneInitialCall = false\n        const destroyListenerCallback = $rootScope.$on('auth', () => {\n          if (!hasDoneInitialCall && firstCall) {\n            hasDoneInitialCall = true\n            firstCall()\n          }\n          callbackDebounced(destroyListenerCallback)\n        })\n      }\n\n      /**\n       * STEP 2\n       * This listens for the a successful intent and handles opening the shopping context\n       * after all modals have been closed\n       */\n      service.initializeContextParamOverrideSystem = () => {\n        if (capturedParams === null) {\n          console.error(`Must first use \"userOverridesV2Service.preCaptureContextParamOverrides\"\n          before using \"userOverridesV2Service.initializeContextParamOverrideSystem\"`)\n          return\n        }\n\n        const onAuthCall = destroyListenerCallback => {\n          // Once there is an intent and there is no open modal\n          if (!$uibModalStack.getTop()) {\n            destroyListenerCallback()\n            const overrides = service.selectOverrides()\n            if (Object.values(SHOPPING_MODES).includes(overrides[URL_OVERRIDES.MODE])) {\n              shoppingSelectorService.suppressAnimationOnNextOpen()\n              shoppingSelectorService.open(SHOPPING_SELECTOR_STAGES.SHOPPING_CONTEXT)\n            } else if (overrides[URL_OVERRIDES.MODE]) {\n              console.error(`Context param in URL must have valid \"mode\" override!\n              Found value: ${overrides[URL_OVERRIDES.MODE]}`)\n            }\n          } else {\n            waitForAllModalsClosed().then(() => onAuthCall(destroyListenerCallback))\n          }\n        }\n\n        service.onAuthReady(onAuthCall, () => {\n          // Dismiss all initial modals if requested\n          const initialOverrides = capturedParams[auth.user.status === 'trial' ? 'trial' : 'authed']\n          if (initialOverrides?.[URL_OVERRIDES.DISMISS_INITIAL_MODALS]) {\n            $uibModalStack.dismissAll()\n            service.deleteOverride(URL_OVERRIDES.DISMISS_INITIAL_MODALS)\n          }\n        })\n      }\n\n      /**\n       * Waits for all the modals to be closed via promise chaining\n       * This is a horrible piece of code all because $uibModalStack does not provide access to the\n       * stack. Whomever wrote $uibModalStack at Angular has unfortunately made it difficult to use.\n       *\n       * @returns {Promise}\n       */\n      function waitForAllModalsClosed() {\n        return $q(resolve => {\n          // Timeout to wait for the modal to close and be popped off fo the modal stack\n          $timeout(() => {\n            const topModal = $uibModalStack.getTop()\n            if (!topModal) {\n              resolve()\n            } else {\n              // Somehow the promises for the modal don't work when fetched this way. This is so\n              // backwards but there's no other way to detect a modal closing, so here we are <_<\n              $uibModalStack\n                .getTop()\n                .value.modalScope.$on('modal.closing', () => resolve(waitForAllModalsClosed()))\n            }\n          })\n        })\n      }\n\n      /**\n       * STEP 3\n       * Used by the context selector to check and get overrides for automated application\n       * SIDE EFFECT NOTE: Removes whichever context mode params are not applicable (trial vs auth)\n       *\n       * @returns {object}\n       */\n      service.selectOverrides = () => {\n        const isUserTrial = auth.user.status === 'trial'\n        return capturedParams[isUserTrial ? 'trial' : 'authed'] || {}\n      }\n\n      /**\n       * STEP 4\n       * Used by the context selector to removes whichever context mode params are not applicable\n       * I.e. Trial vs Authed\n       *\n       * @returns {object}\n       */\n      service.removeNonApplicableOverrides = () => {\n        const isUserTrial = auth.user.status === 'trial'\n        capturedParams[isUserTrial ? 'authed' : 'trial'] = {}\n      }\n\n      /**\n       * STEP 5\n       * Used by the context selector to indicate that overrides have been processed\n       * @returns {null}\n       */\n      service.deleteOverride = key => {\n        const isUserTrial = auth.user.status === 'trial'\n        const overrides = capturedParams[isUserTrial ? 'trial' : 'authed']\n        if (overrides) {\n          delete overrides[key]\n        }\n      }\n    }\n  )\n","import angular from 'angular'\nimport { USER_STATUSES } from '@app/angular/constants/user'\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\nimport {\n  SHOPPING_SELECTOR_STAGES,\n  TRANSITIONS,\n} from '@app/angular/constants/shoppingSelectorStages'\nimport { SOURCES as TIMESLOT_SOURCES } from '@app/angular/constants/timeslots'\nimport { URL_OVERRIDES } from '@app/angular/services/modules/userOverridesV2.service'\nimport { hasRxItem } from '@instacart/enterprise-services/shopping-list/_common/utils'\nimport unableToChangeToPickupRx from '../views/unableToChangeToPickupRx.html'\n\nexport default angular\n  .module('ContextSelectorControllerComponentModule', [])\n\n  // Shopping context controller\n\n  .controller(\n    'ContextSelectorController',\n    function (\n      $q,\n      $rootScope,\n      $scope,\n      $state,\n      $timeout,\n      analytics,\n      auth,\n      cartListTransferService,\n      cartService,\n      compareCartService,\n      config,\n      confirmationModal,\n      eComLightService,\n      fulfillmentNotAvailableModalService,\n      lang,\n      mobileService,\n      reservationService,\n      shoppingContextService,\n      shoppingSelectorService,\n      userOverridesV2Service\n    ) {\n      $scope.auth = auth\n      $scope.lang = lang\n      $scope.shopContextIntent = auth.getContext().intent\n      $scope.mobile = mobileService\n      $scope.cartService = cartService\n      $scope.reservationService = reservationService\n      $scope.modalTransition = false\n      $scope.initialContextIntent = auth.getContext().intent\n      $scope.inCheckout = $state.includes('main.checkout')\n\n      /**\n       * Checks for V2 overrides for shopping mode\n       * @param {function} [deregisterListener] - Optional: Function to stop listening for auth changes\n       */\n      function checkOverrides(deregisterListener) {\n        if (deregisterListener) deregisterListener()\n        const { [URL_OVERRIDES.MODE]: overrideMode } = userOverridesV2Service.selectOverrides()\n        if (Object.values(SHOPPING_MODES).includes(overrideMode)) {\n          $scope.shoppingContextSubmit(overrideMode)\n          userOverridesV2Service.deleteOverride(URL_OVERRIDES.MODE)\n          userOverridesV2Service.removeNonApplicableOverrides()\n        }\n      }\n\n      this.$onInit = () => {\n        if (auth.getContext()?.intent !== undefined) {\n          checkOverrides()\n        } else {\n          userOverridesV2Service.onAuthReady(checkOverrides)\n        }\n      }\n\n      $scope.shopContextIntents = [\n        {\n          name: SHOPPING_MODES.DELIVERY,\n          displayOrder: config.shoppingSelector.delivery.displayOrder,\n          classIcons: 'icon-delivery',\n          ariaLabel: lang.aria.switchDelivery,\n          isActive: $scope.shopContextIntent === SHOPPING_MODES.DELIVERY,\n          visible:\n            (!auth.user.store.is_b2b && config.shoppingSelector.delivery.exists) ||\n            (config.shoppingSelector.delivery.exists &&\n              auth.user.store.is_b2b &&\n              auth.userStoreSupportsDelivery()),\n        },\n        {\n          name: SHOPPING_MODES.PICKUP,\n          displayOrder: config.shoppingSelector.pickup.displayOrder,\n          classIcons: 'icon-pickup icon-card',\n          ariaLabel: lang.aria.switchPickup,\n          isActive:\n            $scope.shopContextIntent === SHOPPING_MODES.PICKUP && !eComLightService.inEComLightMode,\n          visible: config.shoppingSelector.pickup.exists,\n        },\n        {\n          name: SHOPPING_MODES.INSTORE_LIST,\n          displayOrder: config.shoppingSelector.instore.displayOrder,\n          classIcons: 'icon-list',\n          ariaLabel: lang.aria.switchInstoreList,\n          isActive: $scope.shopContextIntent === SHOPPING_MODES.INSTORE_LIST,\n          visible: config.shoppingSelector.instore.exists && !auth.user.store.is_b2b,\n        },\n        {\n          name: SHOPPING_MODES.CATERING,\n          displayOrder: config.shoppingSelector.catering.displayOrder,\n          classIcons: 'icon-catering icon-card',\n          ariaLabel: lang.aria.switchCatering,\n          isActive:\n            $scope.shopContextIntent === SHOPPING_MODES.PICKUP && eComLightService.inEComLightMode,\n          visible: config.shoppingSelector.catering.exists,\n        },\n      ]\n\n      $scope.visibleShopContextIntents = $scope.shopContextIntents.filter(ctx => ctx.visible)\n\n      const shouldHideStoreSelector = {\n        [SHOPPING_MODES.PICKUP]: config?.shoppingContextProcess?.pickup?.hideStoreSelector,\n        [SHOPPING_MODES.DELIVERY]: config?.shoppingContextProcess?.delivery?.hideStoreSelector,\n        [SHOPPING_MODES.INSTORE_LIST]: config?.shoppingContextProcess?.instore?.hideStoreSelector,\n      }\n\n      const shouldHideTimeslotSelector = {\n        [SHOPPING_MODES.PICKUP]: config?.shoppingContextProcess?.pickup?.hideTimeslot,\n        [SHOPPING_MODES.DELIVERY]: config?.shoppingContextProcess?.delivery?.hideTimeslot,\n        [SHOPPING_MODES.INSTORE_LIST]: config?.shoppingContextProcess?.instore?.hideTimeslot,\n      }\n\n      const _getPickupTransitionState = initialContext => {\n        const userHasStore = auth.user?.store?.id\n        const isTimeslotSelectorHidden =\n          (auth.user.status === USER_STATUSES.TRIAL &&\n            config.hideTimeslotReservationFromTrialUsers) ||\n          shouldHideTimeslotSelector.pickup\n        const isStoreSelectorHidden =\n          userHasStore && auth.userStoreSupportsPickup() && shouldHideStoreSelector.pickup\n\n        if (isStoreSelectorHidden) {\n          if (isTimeslotSelectorHidden) {\n            return {\n              transition: TRANSITIONS.CART_COMPARE,\n              destination: SHOPPING_SELECTOR_STAGES.CLOSE,\n            }\n          }\n\n          return {\n            transition: TRANSITIONS.CART_COMPARE,\n            destination: SHOPPING_SELECTOR_STAGES.TIMESLOT,\n          }\n        }\n\n        // If the user is coming from list or catering and the current store supports pickup, skip the store selection\n        // This behaviour is optional\n        const allowSkippingStoreSelection =\n          config?.shoppingContextProcess?.instore?.allowSkippingStoreSelection\n\n        if (\n          allowSkippingStoreSelection &&\n          (initialContext === SHOPPING_MODES.INSTORE_LIST ||\n            initialContext === SHOPPING_MODES.CATERING) &&\n          auth.user?.store?.has_pickup\n        ) {\n          // if timeslot selection is disabled, close the modal\n          const destination = isTimeslotSelectorHidden\n            ? SHOPPING_SELECTOR_STAGES.CLOSE\n            : SHOPPING_SELECTOR_STAGES.TIMESLOT\n\n          return {\n            transition: TRANSITIONS.CART_COMPARE,\n            destination,\n          }\n        }\n\n        // Store selector is visible\n        return {\n          transition: TRANSITIONS.SHOPPING_SELECTOR,\n          destination: SHOPPING_SELECTOR_STAGES.STORE_SELECTOR,\n        }\n      }\n\n      const _getCateringTransitionState = () => {\n        if (\n          auth.user?.store?.has_catering &&\n          auth.getContext().shopping_mode !== SHOPPING_MODES.CATERING\n        ) {\n          return {\n            transition: TRANSITIONS.CART_COMPARE,\n            destination: SHOPPING_SELECTOR_STAGES.CLOSE,\n          }\n        }\n\n        return {\n          transition: TRANSITIONS.SHOPPING_SELECTOR,\n          destination: SHOPPING_SELECTOR_STAGES.STORE_SELECTOR,\n        }\n      }\n\n      const _getDeliveryTransitionState = () => {\n        const userHasZip = auth.user && auth.user.context && auth.user.context.deliveryPostalCode\n        const isStoreSelectorHidden = userHasZip && shouldHideStoreSelector.delivery\n        const isTimeslotSelectorHidden =\n          (auth.user.status === USER_STATUSES.TRIAL &&\n            config.hideTimeslotReservationFromTrialUsers) ||\n          shouldHideTimeslotSelector.delivery\n\n        if (isStoreSelectorHidden) {\n          if (isTimeslotSelectorHidden) {\n            return {\n              transition: TRANSITIONS.CART_COMPARE,\n              destination: SHOPPING_SELECTOR_STAGES.CLOSE,\n            }\n          }\n\n          return {\n            transition: TRANSITIONS.CART_COMPARE,\n            destination: SHOPPING_SELECTOR_STAGES.TIMESLOT,\n          }\n        }\n\n        // Store selection (address) is visible\n        return {\n          transition: TRANSITIONS.SHOPPING_SELECTOR,\n          destination: SHOPPING_SELECTOR_STAGES.STORE_SELECTOR,\n        }\n      }\n\n      const _getInstoreListTransitionState = initialContext => {\n        const userHasStore = auth.user && auth.user.store && auth.user.store.id\n\n        /**\n         * If the user is currently in *instore* list mode, and selects it again,\n         * we open the store selector\n         */\n        if (initialContext === SHOPPING_MODES.INSTORE_LIST) {\n          return {\n            transition: TRANSITIONS.SHOPPING_SELECTOR,\n            destination: SHOPPING_SELECTOR_STAGES.STORE_SELECTOR,\n          }\n        }\n\n        if (userHasStore && $scope.inCheckout) {\n          return {\n            transition: TRANSITIONS.CART_COMPARE,\n            destination: 'main.home',\n          }\n        }\n\n        if (shouldHideStoreSelector.instore) {\n          return {\n            transition: TRANSITIONS.CART_COMPARE,\n            destination: SHOPPING_SELECTOR_STAGES.CLOSE,\n          }\n        }\n\n        /**\n         * TODO: uncomment this block when the BE returns a has_list or similar attribute\n         * in the user store. Right now, let's assume all stores supports list mode\n         */\n        // if (initialContext === SHOPPING_MODES.PICKUP && auth.user.store.has_list) {\n        //   return {\n        //     transition: TRANSITIONS.CART_COMPARE,\n        //     destination: SHOPPING_SELECTOR_STAGES.CLOSE,\n        //   }\n        // }\n\n        // return {\n        //   transition: TRANSITIONS.SHOPPING_SELECTOR,\n        //   destination: SHOPPING_SELECTOR_STAGES.STORE_SELECTOR,\n        // }\n\n        return {\n          transition: TRANSITIONS.CART_COMPARE,\n          destination: SHOPPING_SELECTOR_STAGES.CLOSE,\n        }\n      }\n\n      function determineShoppingContextTransition() {\n        const updatedContext = shoppingContextService.selectedFulfillmentType\n        const transitionStateMap = {\n          [SHOPPING_MODES.PICKUP]: _getPickupTransitionState,\n          [SHOPPING_MODES.DELIVERY]: _getDeliveryTransitionState,\n          [SHOPPING_MODES.INSTORE_LIST]: _getInstoreListTransitionState,\n          [SHOPPING_MODES.CATERING]: _getCateringTransitionState,\n        }\n\n        // When user changed to/from eCom Light mode, set the requiredRedirect on the eComLightService.\n        // When the modal 'flow' is complete send them to \"Home\" which will trigger the correct redirects.\n        if (eComLightService.inEComLightMode) {\n          if ($state.is('main.home')) {\n            eComLightService.requiresRedirect = false\n          } else {\n            eComLightService.requiresRedirect = true\n          }\n        }\n\n        const initialContext = shoppingContextService.getIntentFromContext()\n        const transitionState = transitionStateMap[updatedContext](initialContext)\n\n        return (\n          transitionState || {\n            transition: TRANSITIONS.SHOPPING_SELECTOR,\n            destination: SHOPPING_SELECTOR_STAGES.STORE_SELECTOR,\n          }\n        )\n      }\n\n      const _handleCartCompareConfirmation = transferData => {\n        const { shopping_mode: initialFulfillmentType } = auth.getContext()\n        const { selectedFulfillmentType } = shoppingContextService\n        const fulfillmentTypesShowTransferModal = [\n          SHOPPING_MODES.INSTORE_LIST,\n          SHOPPING_MODES.CATERING,\n        ]\n\n        const showCartListTransfer =\n          // We should only show the transfer modal if we are switching in/out of catering or instore list\n          [initialFulfillmentType, selectedFulfillmentType].some(type =>\n            fulfillmentTypesShowTransferModal.includes(type)\n          ) &&\n          initialFulfillmentType !== selectedFulfillmentType &&\n          (transferData.numTotal > 0 || cartService.countItems() > 0)\n\n        if (!showCartListTransfer) {\n          return $q.resolve()\n        }\n\n        $scope.$parent.setShoppingSelectorStage(SHOPPING_SELECTOR_STAGES.CART_TO_LIST_MIGRATION)\n\n        return cartListTransferService.initializeTransfer({\n          initialContext: initialFulfillmentType,\n          updatedContext: selectedFulfillmentType,\n          transferData,\n        })\n      }\n\n      function transitionToNextStep(transition, destination) {\n        if (transition === TRANSITIONS.SHOPPING_SELECTOR) {\n          $scope.$parent.setShoppingSelectorStage(destination)\n        } else if (transition === TRANSITIONS.STATE_GO) {\n          $state.go(destination)\n        } else if (transition === TRANSITIONS.CLOSE_MODAL) {\n          $scope.$close()\n        } else if (transition === TRANSITIONS.CART_COMPARE) {\n          const storeId = auth.user?.store?.id\n          const { deliveryPostalCode } = auth.user.context\n          const cateringConfig = config.shoppingSelector.catering\n          const intent = shoppingContextService.selectedFulfillmentType\n\n          compareCartService\n            .compareCart(true, 'store', {\n              store_id: storeId,\n              fulfillment_type: intent,\n              delivery_postal_code: deliveryPostalCode,\n            })\n            .then(_handleCartCompareConfirmation)\n            .then(() => auth.setIntent(intent))\n            .then(cartService.fetch)\n            .then(() => {\n              if (shoppingContextService.selectedFulfillmentType === SHOPPING_MODES.CATERING) {\n                eComLightService.setMode(true)\n                $state\n                  .go(cateringConfig?.redirectTo, cateringConfig?.redirectParams)\n                  .then($rootScope.reloadState)\n              } else {\n                eComLightService.setMode(false)\n              }\n\n              if (destination === SHOPPING_SELECTOR_STAGES.CLOSE) {\n                return $scope.$close()\n              }\n\n              if (destination && destination.match(/^[a-z]+\\.[a-z]/i)) {\n                return $state.go(destination)\n              }\n\n              $scope.$parent.setShoppingSelectorStage(destination)\n            })\n            .catch(error => {\n              console.error('Context selector error:', error)\n              $scope.$close()\n            })\n        }\n      }\n\n      function proceedToNextShoppingSelectorStage(userCameFromTransfer) {\n        const { transition, destination } = determineShoppingContextTransition(userCameFromTransfer)\n        // Only show modal transition if we're going to store or timeslot selector in mobile and we didn't come from transfer\n        if (\n          mobileService.isMobile &&\n          transition === TRANSITIONS.SHOPPING_SELECTOR &&\n          (destination === SHOPPING_SELECTOR_STAGES.TIMESLOT ||\n            destination === SHOPPING_SELECTOR_STAGES.STORE_SELECTOR)\n        ) {\n          $scope.modalTransition = true\n          $timeout(() => {\n            transitionToNextStep(transition, destination)\n          }, 700)\n        } else {\n          $scope.modalTransition = false\n          transitionToNextStep(transition, destination)\n        }\n      }\n\n      $scope.shoppingContextSubmitNoChecks = updatedContext => {\n        $scope.shopContextIntent = updatedContext\n\n        // TODO find a cleaner way to make sure we don't have an invalid reservation for the fulfillment type\n        if (\n          config.eComLight.enabled &&\n          ((updatedContext === SHOPPING_MODES.CATERING &&\n            reservationService?.reservation?.timeslot?.source === TIMESLOT_SOURCES.IC) ||\n            (updatedContext !== SHOPPING_MODES.CATERING &&\n              reservationService?.reservation?.timeslot?.source === TIMESLOT_SOURCES.INTERNAL))\n        ) {\n          reservationService.deleteReservation()\n        }\n\n        shoppingContextService.setSelectedFulfillmentType(updatedContext)\n        proceedToNextShoppingSelectorStage()\n      }\n\n      $scope.shoppingContextSubmit = updatedContext => {\n        if (hasRxItem(cartService.cart.items) && SHOPPING_MODES.DELIVERY !== updatedContext) {\n          analytics.logSegmentEvent('rx.context_switching_triggered', {\n            source: 'shopping_context',\n          })\n\n          confirmationModal.open({}, unableToChangeToPickupRx).then(proceed => {\n            if (proceed) {\n              cartService.removeRxItems().then(() => {\n                $scope.shoppingContextSubmitNoChecks(updatedContext)\n              })\n            } else {\n              shoppingSelectorService.closeModal()\n            }\n            analytics.logSegmentEvent('rx.context_switched', {\n              source: 'shopping_context',\n              context_switched: proceed,\n              rx_item_removed: proceed,\n            })\n          })\n        } else {\n          $scope.shoppingContextSubmitNoChecks(updatedContext)\n        }\n      }\n    }\n  )\n","import angular from 'angular'\nimport { HTTP_ERRORS } from '@app/angular/constants/httpErrors'\n\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\n\nexport default angular\n  .module('TimeslotSelectorControllerComponentModule', [])\n  .controller(\n    'TimeslotSelectorController',\n    function (\n      $q,\n      $rootScope,\n      $scope,\n      $state,\n      auth,\n      cartService,\n      config,\n      errorModalService,\n      instacartCustomerLinkModalService,\n      lang,\n      mobileService,\n      modalOptions,\n      registrationService,\n      reservationService,\n      shoppingContextService,\n      shoppingSelectorService,\n      timeslotService\n    ) {\n      $scope.config = config\n      $scope.lang = lang\n      $scope.shopContextIntent = auth.getContext().intent\n      $scope.shopContextMode = auth.getContext().shopping_mode\n      $scope.selectedTimeslot = false\n      $scope.reservationService = reservationService\n      $scope.mobileService = mobileService\n      $scope.$rootScope = $rootScope\n\n      $scope.timeslotsAreSelectable =\n        !timeslotService.areTimeslotsSelectableAtCheckoutOnly() ||\n        $state.current.name === 'main.checkout.reservation.confirmation'\n\n      $scope.processComplete = function () {\n        $scope.selectedTimeslot = true\n        // call $dismiss rather than $close to force a $rootScope.reloadState();\n        $scope.$dismiss()\n      }\n\n      $scope.selectLater = function () {\n        $scope.$dismiss()\n      }\n\n      $scope.onTimeslotError = function (response) {\n        const currentState = $state.current.name\n        const { error } = response.data || {}\n\n        switch (error) {\n          // Account not linked\n          case HTTP_ERRORS.EXTERNAL_AUTH_ERROR:\n            return (\n              config.instacart.enableAccountLinking &&\n              instacartCustomerLinkModalService\n                .openModal()\n                .then(() => shoppingSelectorService.open('timeslot'))\n                .catch(err => {\n                  return $q\n                    .resolve($state.includes('main.checkout') && $state.go('main.checkout.cart'))\n                    .then(() => {\n                      $scope.$dismiss()\n                      throw err\n                    })\n                })\n            )\n\n          // User logged out or token timed out\n          case HTTP_ERRORS.SESSION_EXPIRED_ERROR:\n          case HTTP_ERRORS.PII_UNAUTHORIZED:\n          case HTTP_ERRORS.MISSING_CART:\n            return errorModalService\n              .open(lang.values.expiredTokenErrorMessage, 'OK', null)\n              .then(() =>\n                registrationService.promptLogin(\n                  currentState,\n                  '',\n                  '',\n                  '',\n                  lang.values.loginToContinue\n                )\n              )\n              .then(() => shoppingSelectorService.open('timeslot'))\n\n          // All other errors.\n          default:\n            throw response\n        }\n      }\n\n      $scope.shoppingContextText = shoppingContextService.getShoppingModeTitle(\n        $scope.shopContextIntent\n      )\n\n      $scope.resetSelectedTimeslot = function () {\n        $scope.selectedTimeslot = false\n      }\n\n      $scope.isSelectLaterLinkVisible = modalOptions.isTimeslotSelectLaterLinkVisible()\n      $scope.getTitle = () =>\n        $scope.timeslotsAreSelectable\n          ? $scope.lang.values.selectTimeSlotNoDate\n          : $scope.lang.values.selectTimePreviewTitle\n      $scope.getSubTitle = () =>\n        $scope.shopContextIntent === SHOPPING_MODES.DELIVERY\n          ? $scope.config.shoppingSelector.delivery.content\n          : $scope.config.shoppingSelector.pickup.content\n    }\n  )\n","import angular from 'angular'\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\nimport { EVENTS } from '@app/angular/services/modules/analytics/analyticsConstants'\nimport { SHOPPING_SELECTOR_STAGES } from '@app/angular/constants/shoppingSelectorStages'\nimport parentShoppingSelectorTemplate from './views/parentShoppingSelector.html'\n\nexport default angular\n  .module('ShoppingSelectorServiceModule', [])\n\n  // Service to provide access to launching the parent modal where the user select his or her\n  // shopping context, store and timeslot.\n\n  .service(\n    'shoppingSelectorService',\n    function shoppingSelectorService(\n      $rootScope,\n      $state,\n      $uibModal,\n      analytics,\n      auth,\n      catalogCategoriesService,\n      config,\n      eComLightService,\n      lang,\n      mobileService,\n      modalOptions,\n      shoppingContextService,\n      uibModalAriaLabelService,\n      unataCommService\n    ) {\n      const service = this\n      let suppressAnimation = false\n      // If user closes the modal and there is no context set, then set it to SHOPPING_MODES.INSTORE_LIST.\n\n      let initialContext\n      let initialStore\n\n      // Add listeners for UnataComm to trigger launching the context selector modal\n      // to one of the following targets screens: shoppingContext, storeSelector, confirmation\n      unataCommService.listen(unataCommService.EventType.OPENCONTEXTSELECTOR, event => {\n        const payload = event.data.payload && event.data.payload.shoppingSelectorTarget\n        const targetScreen = payload || SHOPPING_SELECTOR_STAGES.SHOPPING_CONTEXT\n        if (\n          [\n            SHOPPING_SELECTOR_STAGES.CONFIRMATION,\n            SHOPPING_SELECTOR_STAGES.SHOPPING_CONTEXT,\n            SHOPPING_SELECTOR_STAGES.STORE_SELECTOR,\n          ].includes(targetScreen)\n        ) {\n          service.open(targetScreen)\n        }\n      })\n\n      service.forceContextIntentSet = function () {\n        if (!auth.user.context || !auth.user.context.intent) {\n          auth.setIntent(config.defaultShoppingContext)\n          if (config.defaultShoppingContext === SHOPPING_MODES.CATERING) {\n            shoppingContextService.setSelectedFulfillmentType(SHOPPING_MODES.CATERING)\n          }\n        } else if (\n          auth.user.context &&\n          auth.user.context.intent === SHOPPING_MODES.DELIVERY &&\n          !auth.user.context.deliveryPostalCode\n        ) {\n          service.open(SHOPPING_SELECTOR_STAGES.STORE_SELECTOR)\n        }\n      }\n\n      function triggerOpenModal(shoppingSelectorTarget, errorMessage) {\n        // We should only ever have one shoppingSelectorService modal at a time\n        if (service.showing) {\n          return\n        }\n\n        // When modifying an IC order we should not allow this modal to open to any view other than timeslots\n        const selectorTargets = [\n          SHOPPING_SELECTOR_STAGES.CONFIRMATION,\n          SHOPPING_SELECTOR_STAGES.TIMESLOT,\n        ]\n        if (\n          $rootScope.modifyingInstacartOrder &&\n          !selectorTargets.includes(shoppingSelectorTarget)\n        ) {\n          return\n        }\n\n        initialContext = auth.getContext().intent\n        initialStore = auth.getStore()\n        /*\n        Disable keyboard access (escape key and stuff) when:\n        1. Enfore no close on store selector via config\n        2. Or just in delivery mode and does not have valid deliviery postal code\n        */\n        const allowDeliveryModalClose =\n          service.isContextIntentInValidState() ||\n          !(\n            config.enableMandatoryStoreSelection &&\n            auth.user.context.intent !== SHOPPING_MODES.DELIVERY &&\n            shoppingSelectorTarget === SHOPPING_SELECTOR_STAGES.STORE_SELECTOR\n          )\n\n        const modalInstance = $uibModal.open({\n          template: parentShoppingSelectorTemplate,\n          controller: 'ParentShoppingSelectorController',\n          animation: !suppressAnimation,\n          keyboard: allowDeliveryModalClose,\n          backdrop: 'static',\n          resolve: {\n            ariaLabel: () => {\n              uibModalAriaLabelService.setLabel(config.shoppingSelector[initialContext]?.title)\n            },\n            shoppingSelectorTarget() {\n              return shoppingSelectorTarget\n            },\n            initialSelectorErrorMessage() {\n              return errorMessage\n            },\n          },\n        })\n\n        service.showing = shoppingSelectorTarget\n        service.closeModal = modalInstance.close\n\n        suppressAnimation = false // Reset animation suppression\n\n        return modalInstance.result.finally(() => {\n          service.showing = false\n          service.forceContextIntentSet()\n\n          // Ignore change from null intent to actual intent\n          const userChangedContext = initialContext && initialContext !== auth.getContext().intent\n          const userChangedStore = initialStore !== auth.getStore()\n\n          // Expose if user changed context/stores to refresh featured departments\n          service.userChangedContextOrStore = userChangedContext || userChangedStore\n\n          analytics.logSegmentEvent(EVENTS.CHECKOUT.SELECT_FULFILLMENT, {\n            display_name: shoppingSelectorTarget,\n          })\n\n          // TODO: Move this category fetching logic elsewhere so we don't have to potentially repeat it\n          //       in other places where we refresh the app and require category refreshes\n          if (eComLightService.requiresRedirect) {\n            eComLightService.requiresRedirect = false\n\n            // Available categories may change, so refresh them.\n            catalogCategoriesService.fetchCategories(true).then(() => {\n              $state.go('main.home', {}, { reload: true })\n            })\n          } else if (userChangedContext || userChangedStore) {\n            // Available categories may change, so refresh them.\n            catalogCategoriesService.fetchCategories(true).then(() => {\n              // Strip pagination from the query params platform-wide since when changing\n              // the store/context we can no longer guarantee the current page will exist\n              $state\n                .transitionTo($state.current, { ...$state.params, page: null }, { location: true })\n                .then(() => {\n                  // This call can disrupt any modals or other UI components the user\n                  // gets to before the fetching of categories is resolved\n                  $rootScope.reloadState({ page: null }).then(() => {\n                    $rootScope.$broadcast('contextSelectionComplete')\n                  })\n                })\n            })\n          } else {\n            $rootScope.$broadcast('contextSelectionComplete')\n          }\n\n          modalOptions.reset()\n        })\n      }\n\n      /**\n       * Open the store selector in a modal dialog, optionally preventing the\n       * closing of the dialog. Pass in the shoppingSelector Target and\n       * optionally pass in an error message to display on initialization.\n       * The options param can be optionally used to customize the the modal by\n       * hiding the close and back buttons and the \"select later\" timeslot option\n       *\n       * @param {string} shoppingSelectorTarget The shopping selector target\n       * @param {string} [errorMessage] optional error message\n       * @param {object} [options] optional object that contains one or multiple attributes of\n       *                           the modalOptions service\n       *\n       * @returns {Promise}\n       */\n      service.open = (shoppingSelectorTarget, errorMessage, options) => {\n        modalOptions.setOptions(options)\n        if (shoppingContextService.selectedFulfillmentType !== SHOPPING_MODES.CATERING) {\n          shoppingContextService.setSelectedFulfillmentType(\n            shoppingContextService.getIntentFromContext()\n          )\n        }\n\n        if (\n          shoppingSelectorTarget === SHOPPING_SELECTOR_STAGES.SHOPPING_CONTEXT ||\n          shoppingSelectorTarget === SHOPPING_SELECTOR_STAGES.STORE_SELECTOR\n        ) {\n          if (auth.user.store.is_b2b && auth.user.context.intent && mobileService.isMobile) {\n            // If user is a b2b store and on mobile, force 'confirmation' to allow an exit from b2b mode\n            return triggerOpenModal(SHOPPING_SELECTOR_STAGES.CONFIRMATION, errorMessage)\n          }\n          if (\n            shoppingSelectorTarget === SHOPPING_SELECTOR_STAGES.SHOPPING_CONTEXT &&\n            !config.shoppingSelector.pickup.exists &&\n            !config.shoppingSelector.delivery.exists &&\n            !config.shoppingSelector.catering.exists\n          ) {\n            // If neither delivery nor pickup are supported, then select instore and skip to the store selector step.\n            return auth.setIntent(SHOPPING_MODES.INSTORE_LIST).then(() => {\n              return triggerOpenModal(SHOPPING_SELECTOR_STAGES.STORE_SELECTOR, errorMessage)\n            })\n          }\n          return triggerOpenModal(shoppingSelectorTarget, errorMessage)\n        }\n        return triggerOpenModal(shoppingSelectorTarget, errorMessage)\n      }\n\n      service.suppressAnimationOnNextOpen = () => {\n        suppressAnimation = true\n      }\n\n      service.isShowing = function () {\n        return !!service.showing\n      }\n\n      service.isContextIntentInValidState = function () {\n        let isStateValid = true\n\n        // If there is no context intent send user to shopping context selector\n\n        if (!auth.user.context || !auth.user.context.intent) {\n          isStateValid = false\n        }\n\n        // If user is set to delivery but doesn't have a postal code, clear context and go to shopping context selector.\n        else if (\n          auth.user.context &&\n          auth.user.context.intent &&\n          auth.user.context.intent === SHOPPING_MODES.DELIVERY &&\n          !auth.user.context.deliveryPostalCode\n        ) {\n          isStateValid = false\n        }\n\n        return isStateValid\n      }\n\n      // Reset context intent and go to the shopping context selector\n\n      service.resumeContextSwitch = function () {\n        // if the only context is instore then we should not set the context to null\n        let intent = null\n        if (\n          config.defaultShoppingContext === SHOPPING_MODES.CATERING &&\n          auth.onlyCateringEnabled()\n        ) {\n          intent = SHOPPING_MODES.CATERING\n        } else if (\n          !config.shoppingSelector.delivery.exists &&\n          !config.shoppingSelector.pickup.exists\n        ) {\n          intent = SHOPPING_MODES.INSTORE_LIST\n        } else {\n          intent = null\n        }\n        auth.setIntent(intent).then(() => {\n          service.open(SHOPPING_SELECTOR_STAGES.SHOPPING_CONTEXT)\n        })\n      }\n\n      service.setContextForB2B = function () {\n        auth.setContext({ intent: SHOPPING_MODES.PICKUP }).then(() => {\n          service.open(SHOPPING_SELECTOR_STAGES.TIMESLOT)\n        })\n      }\n\n      const shouldForceStoreDeliveryPostalCode = () => {\n        const { context, store } = auth.user\n        const { intent, deliveryPostalCode } = context\n\n        return (\n          config.forceSetDeliveryPostalCode &&\n          intent === SHOPPING_MODES.DELIVERY &&\n          !deliveryPostalCode &&\n          store?.address?.postal_code\n        )\n      }\n\n      const forceDeliveryPostalCode = () => {\n        const storePostalCode = auth.user.store?.address?.postal_code.split('-')[0]\n        auth.setContext({ deliveryPostalCode: storePostalCode })\n      }\n\n      service.homeStateContextHandler = function (skipModal) {\n        if (!service.isContextIntentInValidState()) {\n          if (shouldForceStoreDeliveryPostalCode()) return forceDeliveryPostalCode()\n\n          if (config.showShoppingSelectorOnEnter && !skipModal) {\n            service.resumeContextSwitch()\n          } else {\n            service.forceContextIntentSet()\n\n            const skipToShopSelectorIntents = [SHOPPING_MODES.INSTORE_LIST, SHOPPING_MODES.PICKUP]\n            if (\n              config.showStoreSelectorOnEnter &&\n              !skipModal &&\n              skipToShopSelectorIntents.includes(auth.user.context.intent)\n            ) {\n              service.open(SHOPPING_SELECTOR_STAGES.STORE_SELECTOR)\n            }\n          }\n        }\n      }\n    }\n  )\n","import angular from 'angular'\nimport ShoppingSelectorServiceModule from './shoppingSelectorService'\n\nexport default angular\n  .module('ShoppingSelectorComponentModule', [ShoppingSelectorServiceModule.name])\n  .config(($stateProvider, $urlRouterProvider) => {\n    $urlRouterProvider.when('/shopping-mode', ($state, shoppingSelectorService) => {\n      $state.go('main.home').then(() => {\n        shoppingSelectorService.open('shoppingContext')\n      })\n    })\n  })\n","import angular from 'angular'\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\nimport { SHOPPING_SELECTOR_STAGES } from '@app/angular/constants/shoppingSelectorStages'\n\nexport default angular\n  .module('ParentShoppingSelectorControllerComponentModule', [])\n  .controller(\n    'ParentShoppingSelectorController',\n    function (\n      $rootScope,\n      $scope,\n      $state,\n      $timeout,\n      addressList,\n      auth,\n      config,\n      initialSelectorErrorMessage,\n      lang,\n      mobileService,\n      modalOptions,\n      shoppingContextService,\n      shoppingSelectorService,\n      shoppingSelectorTarget\n    ) {\n      $scope.auth = auth\n      $scope.addressList = addressList\n      $scope.config = config\n      $scope.lang = lang\n      $scope.shoppingSelectorStage = shoppingSelectorTarget\n      $scope.mobile = mobileService\n      $scope.modalOptions = modalOptions\n      $scope.shopContextIntent =\n        shoppingContextService.selectedFulfillmentType ||\n        auth.getContext().intent ||\n        config.defaultShoppingContext\n\n      $scope.shoppingContextText = shoppingContextService.getShoppingModeTitle(\n        $scope.shopContextIntent\n      )\n      $scope.hasPreviousShoppingSelectorStage = false\n      $scope.previousStoreSelectorShoppingState = SHOPPING_SELECTOR_STAGES.SHOPPING_CONTEXT\n\n      $scope.$watch('shoppingSelectorStage', (newStage, oldStage) => {\n        // Only clear when moving from one stage to another stage, not when initializing the first stage.\n        if (newStage !== oldStage) {\n          $scope.clearShoppingSelectorStageErrorMessage(oldStage)\n          $scope.hasPreviousShoppingSelectorStage = true\n          $scope.previousStoreSelectorShoppingState = oldStage\n        }\n        $scope.currentShoppingStage = newStage\n        if (shoppingContextService.selectedFulfillmentType) {\n          $scope.shopContextIntent = shoppingContextService.selectedFulfillmentType\n        }\n        if (\n          $scope.shopContextIntent &&\n          config.shoppingSelector[$scope.shopContextIntent].fulfilledByInstacart &&\n          config.shoppingSelector[$scope.shopContextIntent].poweredByTitle\n        ) {\n          $scope.shoppingContextText =\n            config.shoppingSelector[$scope.shopContextIntent].poweredByTitle\n        } else if ($scope.shopContextIntent) {\n          $scope.shoppingContextText =\n            config.shoppingSelector[$scope.shopContextIntent].title ||\n            shoppingContextService.getShoppingModeTitle($scope.shopContextIntent)\n        }\n        $scope.triggerInputShake = false\n      })\n      $scope.modalOpen = true\n\n      // Take over escape key behaviour so that it is forced to go through processModalCloseClick\n      $scope.$on('modal.closing', (event, reason) => {\n        if (reason === 'escape key press') {\n          event.preventDefault()\n          $scope.processModalCloseClick()\n        }\n      })\n\n      // Error message value for the Shopping Selector\n\n      $scope.shoppingSelectorErrorMessageList = {\n        shoppingContext: null,\n        bannerSelector: null,\n        cartToListMigration: null,\n        storeSelector: null,\n        timeslot: null,\n        confirmation: null,\n      }\n\n      $scope.isThereAnError = function () {\n        return $scope.shoppingSelectorErrorMessageList[$scope.shoppingSelectorStage] !== null\n      }\n\n      $scope.getErrorMessage = function () {\n        return $scope.shoppingSelectorErrorMessageList[$scope.shoppingSelectorStage]\n      }\n\n      $scope.invalidFocusFn = {}\n\n      $scope.setShoppingSelectorErrorMessage = function (stage, message) {\n        $scope.triggerInputShake = true\n        $scope.shoppingSelectorErrorMessageList[stage] = message\n\n        $timeout(() => {\n          document.getElementById('shopping-selector-postal-code')?.focus()\n        })\n\n        // $timeout is to reset the 0.8s error shake animation\n        $timeout(() => {\n          $scope.triggerInputShake = false\n        }, 800)\n      }\n\n      $scope.clearShoppingSelectorStageErrorMessage = function (stage) {\n        $scope.shoppingSelectorErrorMessageList[stage] = null\n      }\n\n      // This is a bit of a hack - but it is better than the $parent hack that is not reliable\n      // Unfortunately the timeslot and shopping stage system is just a mess. It's too arduous to try fix it.\n      // eslint-disable-next-line no-multi-assign\n      $rootScope.setShoppingSelectorStage = $scope.setShoppingSelectorStage = function (stage) {\n        $scope.shoppingSelectorStage = stage\n      }\n\n      $scope.reloadContextValues = function () {\n        $rootScope.reloadState()\n      }\n\n      const hasDeliveryOrPickup =\n        config.shoppingSelector.delivery.exists || config.shoppingSelector.pickup.exists\n\n      const numOfEnabledContexts = Object.values(SHOPPING_MODES).reduce((count, shoppingMode) => {\n        if (config.shoppingSelector[shoppingMode]?.exists) {\n          count += 1\n        }\n        return count\n      }, 0)\n\n      const onlyInstoreEnabled = !hasDeliveryOrPickup\n\n      const hasSavedAddresses = $scope.addressList.hasAddressItems()\n\n      $scope.showBackButtonInStoreSelector = () =>\n        $scope.shoppingSelectorStage === SHOPPING_SELECTOR_STAGES.STORE_SELECTOR &&\n        hasDeliveryOrPickup &&\n        (numOfEnabledContexts > 1 || $scope.hasPreviousShoppingSelectorStage)\n\n      // Only show Close button if...\n      $scope.showCloseButton = () => {\n        if (!modalOptions.isCloseButtonVisible()) {\n          return false\n        }\n\n        // If enableMandatoryStoreSelection is enabled and it is not in DEVLIERY,\n        // force store selection by preventing the close / automatically set to default store flow\n        // if user in delivery context and does not have a valid deliver postal code, do not show close\n        const storeSelectorCloseHidden =\n          (auth.user.context.intent &&\n            auth.user.context.intent !== SHOPPING_MODES.DELIVERY &&\n            config.enableMandatoryStoreSelection) ||\n          !shoppingSelectorService.isContextIntentInValidState()\n\n        // on Desktop\n        if (!mobileService.isMobile) {\n          // Note: not sure what is the difference between the `mobile` and `desktop` behaviour, looks the same. Will not remove the similar logic for now\n          if (\n            $scope.shoppingSelectorStage === SHOPPING_SELECTOR_STAGES.STORE_SELECTOR &&\n            storeSelectorCloseHidden\n          ) {\n            return false\n          }\n          return true\n        }\n\n        // on Mobile and...\n        switch ($scope.shoppingSelectorStage) {\n          case SHOPPING_SELECTOR_STAGES.CONFIRMATION:\n          case SHOPPING_SELECTOR_STAGES.SHOPPING_CONTEXT:\n          case SHOPPING_SELECTOR_STAGES.TIMESLOT:\n            return true\n          case SHOPPING_SELECTOR_STAGES.STORE_SELECTOR:\n            if (storeSelectorCloseHidden) {\n              return false\n            }\n            if (hasSavedAddresses) {\n              return true\n            }\n            // on Store Selector screen and delivery/pickup are not enabled for that retailer\n            return onlyInstoreEnabled\n\n          default:\n            return false\n        }\n      }\n\n      $scope.processModalCloseClick = function () {\n        $scope.triggerInputShake = false\n\n        if (\n          auth.user.context &&\n          auth.user.context.intent &&\n          auth.user.context.intent === SHOPPING_MODES.DELIVERY &&\n          !auth.user.context.deliveryPostalCode\n        ) {\n          $scope.setShoppingSelectorStage(SHOPPING_SELECTOR_STAGES.STORE_SELECTOR)\n          const errorTemplate = config.shoppingContextProcess.delivery.requireFullAddress\n            ? lang.values.deliveryFullAddressRequired\n            : lang.values.deliveryPostalCodeRequired\n          $scope.setShoppingSelectorErrorMessage(\n            SHOPPING_SELECTOR_STAGES.STORE_SELECTOR,\n            lang.template(errorTemplate, { postalCode: lang.values.postalCode })\n          )\n        } else if (\n          auth.user.context &&\n          auth.user.context.intent &&\n          auth.user.context.intent === SHOPPING_MODES.PICKUP &&\n          !auth.userStoreSupportsPickup()\n        ) {\n          // This is a workaround fix for the ability to enter an eCom in a store which does not support eCom\n          // TODO: Don't change contexts until a user has both selected a context & a store appropriate to that context.\n          $scope.setShoppingSelectorStage(SHOPPING_SELECTOR_STAGES.STORE_SELECTOR)\n          $scope.setShoppingSelectorErrorMessage(\n            SHOPPING_SELECTOR_STAGES.STORE_SELECTOR,\n            lang.values.pickupStoreRequired\n          )\n        } else {\n          $scope.clearShoppingSelectorStageErrorMessage($scope.shoppingSelectorStage)\n          $scope.modalOpen = false\n\n          // $timeout is to allow the 0.3s zoom out animation to happen\n          $timeout(() => $scope.$close(), 300)\n        }\n      }\n\n      $scope.handleBackButtonClickFrom = origin => {\n        switch (origin) {\n          case SHOPPING_SELECTOR_STAGES.TIMESLOT:\n            $scope.setShoppingSelectorStage(SHOPPING_SELECTOR_STAGES.STORE_SELECTOR)\n            break\n          case SHOPPING_SELECTOR_STAGES.STORE_SELECTOR:\n            $scope.setShoppingSelectorStage($scope.previousStoreSelectorShoppingState)\n            break\n          case SHOPPING_SELECTOR_STAGES.BANNER_SELECTOR:\n            $scope.setShoppingSelectorStage(SHOPPING_SELECTOR_STAGES.STORE_SELECTOR)\n            break\n          default:\n            console.error(`The shopping selector \"${origin}\" doesn't have a back handler.`)\n        }\n      }\n\n      /**\n       * Returns if the back button is visible\n       * @returns {boolean}\n       */\n      $scope.isBackButtonVisible = () => {\n        return (\n          ($scope.shoppingSelectorStage === SHOPPING_SELECTOR_STAGES.STORE_SELECTOR &&\n            $scope.showBackButtonInStoreSelector()) ||\n          $scope.shoppingSelectorStage === SHOPPING_SELECTOR_STAGES.TIMESLOT ||\n          $scope.shoppingSelectorStage === SHOPPING_SELECTOR_STAGES.BANNER_SELECTOR\n        )\n      }\n\n      /**\n       * Returns the back button ID\n       * @returns {string}\n       */\n      $scope.getBackButtonId = () => {\n        switch ($scope.shoppingSelectorStage) {\n          case SHOPPING_SELECTOR_STAGES.STORE_SELECTOR:\n            return 'shopping-selector-parent-set-shopping-selector-stage-context'\n          case SHOPPING_SELECTOR_STAGES.TIMESLOT:\n            return 'shopping-selector-set-shopping-selector-stage-store'\n          case SHOPPING_SELECTOR_STAGES.BANNER_SELECTOR:\n            return 'shopping-selector-set-shopping-selector-stage-banner'\n          default:\n            return ''\n        }\n      }\n\n      // Initialize initial selector error message.\n      if (shoppingSelectorTarget && initialSelectorErrorMessage) {\n        $scope.setShoppingSelectorErrorMessage(shoppingSelectorTarget, initialSelectorErrorMessage)\n      }\n    }\n  )\n  .run($templateCache => {\n    $templateCache.put('contextSelector.html', require('./contextSelector/contextSelector.html'))\n    $templateCache.put('storeSelector.html', require('./storeSelector/storeSelector.html'))\n    $templateCache.put('timeslotSelector.html', require('./timeslotSelector/timeslotSelector.html'))\n    $templateCache.put(\n      'shoppingSelectorConfirmation.html',\n      require('./confirmation/shoppingSelectorConfirmation.html')\n    )\n  })\n","import angular from 'angular'\nimport { SHOPPING_MODES, CART_COMPARE_CHANGES } from '@app/angular/constants/context'\nimport { SHOPPING_SELECTOR_STAGES } from '@app/angular/constants/shoppingSelectorStages'\n\nexport default angular\n  .module('StoreSelectorControllerComponentModule', [])\n\n  .controller(\n    'StoreSelectorController',\n    function (\n      $q,\n      $scope,\n      $state,\n      analytics,\n      auth,\n      cartListTransferService,\n      cartService,\n      compareCartService,\n      config,\n      eComLightService,\n      lang,\n      manualUpsellService,\n      modalOptions,\n      placementsService,\n      shoppingContextService,\n      storesService\n    ) {\n      // Check whether the shopping context is instore, delivery or pickup. For delivery, we are just showing the zip code, and then\n      // upon submitting it gets selected and we proceed to the timeslot\n      // For pickup and instore, we show the zip, but then when you submit you reveal the store list and they select it.\n      // After selecting, we move along.\n\n      $scope.lang = lang\n      let setAddress\n      if (\n        auth.getContext().intent === undefined &&\n        !shoppingContextService.selectedFulfillmentType\n      ) {\n        $scope.$parent.setShoppingSelectorStage(SHOPPING_SELECTOR_STAGES.SHOPPING_CONTEXT)\n      } else {\n        $scope.shopContextIntent =\n          shoppingContextService.selectedFulfillmentType || auth.getContext().intent\n      }\n\n      if ($scope.shoppingSelectorStage === SHOPPING_SELECTOR_STAGES.BANNER_SELECTOR) {\n        // Came back from timeslot picker.\n        const address = auth.getAddressFromContext(auth.user.context)\n        storesService\n          .fetchBanners({\n            ...auth.getUrlParamsFromAddress(address),\n            show_delivery: true,\n          })\n          .then(storeBanners => {\n            $scope.setDeliveryBannersAndAddress(storeBanners.items, address)\n          })\n        $scope.$parent.clearShoppingSelectorStageErrorMessage(\n          SHOPPING_SELECTOR_STAGES.BANNER_SELECTOR\n        )\n      }\n\n      $scope.onShopAnotherWay = () => {\n        $scope.$parent.setShoppingSelectorStage(SHOPPING_SELECTOR_STAGES.SHOPPING_CONTEXT)\n      }\n\n      $scope.setDeliveryBannersAndAddress = (banners, address) => {\n        setAddress = address\n        $scope.availableBannerSlugs = banners\n        $scope.availableBannersCopy = lang.template(lang.values.availableBannerCountMessage, {\n          bannerCount: $scope.availableBannerSlugs.length,\n        })\n      }\n\n      $scope.bannerSelectedFromBannerList = bannerSlug => {\n        storesService\n          .fetch({\n            delivery_postal_code: setAddress.postal_code,\n            retailer_slug: bannerSlug,\n            show_delivery: true,\n          })\n          .then(stores => {\n            if (stores.length > 0) {\n              $scope.updateDeliveryStore(stores[0], setAddress)\n            } else {\n              // Partial Zip and delivery is not available.\n              $scope.setShoppingSelectorErrorMessage(\n                SHOPPING_SELECTOR_STAGES.BANNER_SELECTOR,\n                lang.values.deliveryUnavailableAtAddress\n              )\n            }\n          })\n      }\n\n      $scope.updateDeliveryStore = (store, address) => {\n        const params = auth.getUrlParamsFromAddress(address)\n        const contextParams = auth.getContextFromAddress(address)\n        const fulfillmentType =\n          shoppingContextService.selectedFulfillmentType || auth.getContext().intent\n\n        params.store_id = store.id\n        params.delivery_address = address\n        params.fulfillment_type =\n          fulfillmentType === SHOPPING_MODES.CATERING ? SHOPPING_MODES.PICKUP : fulfillmentType\n\n        contextParams.intent = fulfillmentType\n\n        if (store.store_banner && store.store_banner.key) {\n          contextParams.retailer_slug = store.store_banner && store.store_banner.key\n        }\n\n        return compareCartService\n          .compareCart(true, CART_COMPARE_CHANGES.STORE, params)\n          .then(transferData => {\n            // shortcut to closed on a cancel\n            if (transferData.dismissed) throw new Error('modal dismissed')\n\n            return transferData\n          })\n          .then(transferData => _handleCartCompareConfirmation(transferData))\n          .then(() => changeHomeStore(store, fulfillmentType, contextParams))\n          .catch($scope.$close)\n      }\n\n      const handleCustomFulfillmentTypeFlow = () => {\n        const shoppingModeConfig =\n          config.shoppingSelector[shoppingContextService.selectedFulfillmentType]\n\n        eComLightService.setMode(\n          shoppingContextService.selectedFulfillmentType === SHOPPING_MODES.CATERING\n        )\n\n        if (shoppingModeConfig.redirectTo) {\n          $state.go(shoppingModeConfig.redirectTo, shoppingModeConfig.redirectParams)\n        }\n      }\n\n      $scope.updateHomeStore = store => {\n        const { deliveryPostalCode } = auth.user.context\n        const fulfillmentType =\n          shoppingContextService.selectedFulfillmentType ||\n          shoppingContextService.getIntentFromContext()\n\n        return compareCartService\n          .compareCart(true, CART_COMPARE_CHANGES.STORE, {\n            store_id: store.id,\n            fulfillment_type: fulfillmentType,\n            delivery_postal_code: deliveryPostalCode,\n          })\n          .then(transferData => {\n            // shortcut to closed on a cancel\n            if (transferData.dismissed) throw new Error('modal dismissed')\n\n            return transferData\n          })\n          .then(transferData => _handleCartCompareConfirmation(transferData))\n          .then(() => changeHomeStore(store, fulfillmentType))\n          .then(() => handleCustomFulfillmentTypeFlow())\n          .catch($scope.$close)\n      }\n\n      const _handleCartCompareConfirmation = transferData => {\n        const { shopping_mode: initialFulfillmentType } = auth.getContext()\n        const { selectedFulfillmentType } = shoppingContextService\n        const fulfillmentTypesShowTransferModal = [\n          SHOPPING_MODES.INSTORE_LIST,\n          SHOPPING_MODES.CATERING,\n        ]\n        const showCartListTransfer =\n          // We should only show the transfer modal if we are switching in/out of catering or instore list\n          [initialFulfillmentType, selectedFulfillmentType].some(type =>\n            fulfillmentTypesShowTransferModal.includes(type)\n          ) &&\n          initialFulfillmentType !== selectedFulfillmentType &&\n          (transferData.numTotal > 0 || cartService.countItems() > 0)\n\n        if (!showCartListTransfer) {\n          return $q.resolve()\n        }\n\n        $scope.$parent.setShoppingSelectorStage(SHOPPING_SELECTOR_STAGES.CART_TO_LIST_MIGRATION)\n\n        return cartListTransferService.initializeTransfer({\n          initialContext: initialFulfillmentType,\n          updatedContext: selectedFulfillmentType,\n          transferData,\n        })\n      }\n\n      // Triage whether to proceed to timeslot depending on the shopContextIntent and the shoppingContextProcess config\n\n      function proceedToTimeslot() {\n        const isTimeslotSelectionDisabled =\n          config.shoppingContextProcess[$scope.shopContextIntent]?.hideTimeslot\n\n        modalOptions.reset()\n\n        if (\n          (auth.user.status === 'trial' && config.hideTimeslotReservationFromTrialUsers) ||\n          $scope.shopContextIntent === SHOPPING_MODES.INSTORE_LIST ||\n          isTimeslotSelectionDisabled\n        ) {\n          $scope.$dismiss()\n        } else {\n          $scope.$parent.setShoppingSelectorStage(SHOPPING_SELECTOR_STAGES.TIMESLOT)\n        }\n      }\n\n      // analytics for store selection\n      const selectStoreAnalytics = storeid => {\n        analytics.logSegmentEvent('availability.select_store', { storeid })\n      }\n\n      // Change the home store via auth service\n      function changeHomeStore(store, fulfillmentType = null, context = {}) {\n        const { selectedFulfillmentType } = shoppingContextService\n\n        if (!auth.user) {\n          // We're creating a trial user, just return the store\n          $scope.$close(store)\n        } else {\n          const oldStore = auth.user.store\n\n          selectStoreAnalytics(store.id)\n\n          // Update the store in the backend\n          return (\n            auth\n              .update({ store_id: store.id, has_changed_store: true })\n              .then(() => {\n                const newContext = {\n                  ...auth.getContext(),\n                  ...context,\n                  storeNumber: store.id,\n                }\n\n                if (selectedFulfillmentType !== SHOPPING_MODES.DELIVERY) {\n                  newContext.deliveryPostalCode = ''\n                }\n\n                if (fulfillmentType) {\n                  if (fulfillmentType === SHOPPING_MODES.CATERING) {\n                    newContext.shopping_mode = SHOPPING_MODES.CATERING\n                  } else {\n                    newContext.shopping_mode = selectedFulfillmentType\n                  }\n                  newContext.intent = fulfillmentType\n                }\n                const updatedContext = auth.setContext(newContext)\n                auth.sendUserUpdatedStore(auth.user)\n                return updatedContext\n              })\n              .then(auth.sendAvailableStoreContexts(auth.user))\n              .then(cartService.fetch)\n              .then(proceedToTimeslot)\n              // Update the upsell items if the store has changed\n              .then(\n                () =>\n                  config.enableCheckoutManualUpsell &&\n                  manualUpsellService.getUpsellProducts(oldStore.id !== store.id)\n              )\n              // Update the featured departments if the store has changed\n              .then(placementsService.getFeaturedDepartments(oldStore.id !== store.id))\n          )\n        }\n      }\n    }\n  )\n  .run($templateCache => {\n    $templateCache.put('storeSelectorMap.html', require('./storeSelectorMap.html'))\n    $templateCache.put('storeSelectorList.html', require('./storeSelectorList.html'))\n\n    $templateCache.put(\n      'storeSelectorMapStores.mobile.html',\n      require('./storeSelectorMapStores.mobile.html')\n    )\n    $templateCache.put(\n      'storeSelectorMapStores.desktop.html',\n      require('./storeSelectorMapStores.desktop.html')\n    )\n\n    $templateCache.put(\n      'storeSelectorListStores.desktop.html',\n      require('./storeSelectorListStores.desktop.html')\n    )\n    $templateCache.put(\n      'storeSelectorListStores.mobile.html',\n      require('./storeSelectorListStores.mobile.html')\n    )\n  })\n","import angular from 'angular'\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\n\nconst mapHasPickup = require('static/images/map-pin-hasPickup.png')\nconst mapPinGrey = require('static/images/map-pin-grey.png')\nconst mapPinActive = require('static/images/map-pin-active.png')\n\nexport default angular\n  .module('StoreSelectorMapControllerComponentModule', [])\n  .controller(\n    'StoreSelectorMapController',\n    function StoreSelectorMapController(\n      $filter,\n      $http,\n      $q,\n      $scope,\n      $timeout,\n      auth,\n      config,\n      errorModalService,\n      mobileService,\n      shoppingContextService,\n      storesService\n    ) {\n      const vm = this\n\n      // Expose to views\n      vm.config = config\n      vm.mobile = mobileService\n      vm.shopContextIntent =\n        shoppingContextService.selectedFulfillmentType ||\n        auth.getContext().intent ||\n        config.defaultShoppingContext\n      vm.distanceUnits = config.useKMForStoreSelectorUnits ? 'kilometers' : 'miles'\n      vm.distanceUnitsAbbreviation = config.useKMForStoreSelectorUnits ? 'km' : 'm'\n\n      vm.isStoreSelectable = store =>\n        (store.show_pickup && vm.shopContextIntent === SHOPPING_MODES.PICKUP) ||\n        (store.show_catering && vm.shopContextIntent === SHOPPING_MODES.CATERING)\n\n      if (\n        config.shoppingSelector[vm.shopContextIntent] &&\n        config.shoppingSelector[vm.shopContextIntent].fulfilledByInstacart &&\n        config.shoppingSelector[vm.shopContextIntent].poweredByTitle\n      ) {\n        vm.shoppingContextText = config.shoppingSelector[vm.shopContextIntent].poweredByTitle\n      } else {\n        vm.shoppingContextText =\n          config.shoppingSelector[vm.shopContextIntent].shortTitle ||\n          config.shoppingSelector[vm.shopContextIntent].title\n      }\n\n      vm.shoppingContextText =\n        config.shoppingSelector[vm.shopContextIntent].title ||\n        shoppingContextService.getShoppingModeTitle(vm.shopContextIntent)\n      vm.showMap = !config.hideStoreSelectorMapOnInit\n      vm.storeFilters = {\n        banner_slug: '',\n      }\n\n      // Only show stores of primary banner if nonTabulatedView is enabled (ie. only show grocery for CUS)\n      if (config.multipleBanners.enabled && config.multipleBanners.enableNonTabulatedView) {\n        vm.storeFilters.banner_slug = config.multipleBanners.banners[0]?.bannerSlug ?? ''\n      }\n\n      if (vm.shopContextIntent === SHOPPING_MODES.PICKUP) {\n        vm.storeFilters.onlyShowPickup = true\n      }\n      vm.stores = storesService.stores || null\n\n      vm.storeFilterFn = value => {\n        return (\n          (vm.storeFilters.onlyShowPickup !== true || value?.show_pickup === true) &&\n          (!vm.storeFilters.banner_slug || vm.storeFilters.banner_slug === value.store_banner.key)\n        )\n      }\n\n      vm.preciseLocation = false\n      vm.locationLookupInProgress = false\n\n      // Additional variables\n      let allStores = []\n      let location = null\n      let map = {}\n      let mapAlreadyLoaded = false\n      let markers = {}\n      let onlyShowPickup = true\n\n      //* ****\n      // Internal Functions\n      //* ****\n\n      // Fetch stores from the storesService\n      const initStores = () => {\n        const params = {} // Empty param list by default\n\n        // we'll want to fetch a different store list from the API depending on our\n        // shop context.\n        if (vm.shopContextIntent !== SHOPPING_MODES.INSTORE_LIST) {\n          params.show_ecommerce = true\n        }\n\n        // Fetch only catering stores\n        if (vm.shopContextIntent === SHOPPING_MODES.CATERING) {\n          params.show_catering = true\n        } else if (vm.shopContextIntent === SHOPPING_MODES.PICKUP && onlyShowPickup === true) {\n          params.show_pickup = true\n        }\n\n        return storesService.fetch(params).then(() => {\n          allStores = storesService.stores\n        })\n      }\n\n      // Function to drive selecting a store when selecting a map marker\n      const selectStoreMarker = store => {\n        vm.selectStoreList(store)\n\n        // Index of store selected\n        const storeIndex = vm.stores.indexOf(store)\n\n        // Simple function to move stores in the list\n        const moveStore = (origin, destination) => {\n          const storeToMove = vm.stores[destination]\n          vm.stores[destination] = vm.stores[origin]\n          vm.stores[origin] = storeToMove\n        }\n\n        // Move store to top of list\n        moveStore(storeIndex, 0)\n\n        // Scroll stores list to selected store on mobile\n        if ($scope.mobile.isMobile) {\n          const storesList = document.getElementsByClassName('stores stores-scroll-flag')[0]\n          storesList.scrollTop = 0\n        }\n      }\n\n      // Build our array of map markers\n      const drawMarkers = () => {\n        allStores.forEach(store => {\n          const storeLatitude = store.location.latitude\n          const storeLongitude = store.location.longitude\n\n          if (storeLatitude && storeLongitude) {\n            const el = document.createElement('div')\n\n            // Set up custom marker styles / event listeners\n            el.className = 'marker'\n            el.style.backgroundImage = store.show_pickup\n              ? `url('${mapHasPickup}')`\n              : `url('${mapPinGrey}')`\n            el.style.height = '40px'\n            el.style.width = '30px'\n            el.addEventListener(\n              'click',\n              (() => {\n                return () => {\n                  el.style.backgroundImage = `url('${mapPinActive}')`\n                  map.flyTo({ center: [storeLongitude, storeLatitude] })\n                  selectStoreMarker(store)\n                }\n              })(store)\n            )\n\n            if (window.mapboxgl) {\n              const marker = new window.mapboxgl.Marker(el) //eslint-disable-line\n                .setLngLat([storeLongitude, storeLatitude])\n                .addTo(map)\n\n              markers[store.id] = marker\n            }\n          }\n        })\n      }\n\n      const GEO_ERRORS = {\n        CURRENT_POSITION: 'CURRENT_POSITION',\n        NOT_SUPPORTED: 'NOT_SUPPORTED',\n      }\n\n      // Prompt user for location information\n      const geolocate = () => {\n        let geolocationFetched = false\n\n        // Use their last shopped store if config enabled\n        if (config.useLastStoreForGeolocation && auth.user && auth.user.store) {\n          location = auth.user.store.location\n          vm.search()\n        } else if (navigator.geolocation) {\n          getCurrentPosition()\n            .then(position => {\n              geolocationFetched = true\n              location = position.coords\n              vm.preciseLocation = true\n              updateStoresAndUI()\n            })\n            .catch(e => {\n              if (e?.code !== GEO_ERRORS.CURRENT_POSITION) {\n                return Promise.reject(e)\n              }\n              geolocationFetched = true\n              updateStoresAndUI()\n            })\n          // Handle users taking too long to allow geolocation\n          $timeout(() => {\n            if (!geolocationFetched) {\n              vm.search()\n            }\n          }, 3000)\n        } else {\n          // No geolocation support\n          vm.search()\n        }\n      }\n\n      function updateStoresAndUI() {\n        vm.search()\n        $scope.$apply()\n      }\n\n      function getCurrentPosition() {\n        return new Promise((resolve, reject) => {\n          if (navigator.geolocation) {\n            // Browser geolocation exists & user accepted\n            navigator.geolocation.getCurrentPosition(\n              position => {\n                resolve(position)\n              },\n              () => {\n                const e = new Error('failed to get current position')\n                e.code = GEO_ERRORS.CURRENT_POSITION\n                reject(e)\n              },\n              {\n                enableHighAccuracy: true,\n              }\n            )\n          } else {\n            const e = new Error('geolocation not supported')\n            e.code = GEO_ERRORS.NOT_SUPPORTED\n            reject(e)\n          }\n        })\n      }\n\n      vm.useMyLocation = () => {\n        if (vm.locationLookupInProgress) {\n          return\n        }\n        vm.terms = ''\n        const timerID = setTimeout(() => {\n          vm.locationLookupInProgress = true\n          $scope.$apply()\n        }, 500)\n        getCurrentPosition()\n          .then(position => {\n            location = position.coords\n            updateUIAfterUseMyLocation(timerID, true)\n            updateStoresAndUI()\n          })\n          .catch(e => {\n            updateUIAfterUseMyLocation(timerID, false)\n            switch (e?.code) {\n              case GEO_ERRORS.CURRENT_POSITION:\n                errorModalService.open(\n                  'To help us find your closest store, please go to Settings and share Location access',\n                  config.lang.close,\n                  null,\n                  'Grant Access'\n                )\n                break\n              default:\n                return Promise.reject(e)\n            }\n          })\n      }\n      function updateUIAfterUseMyLocation(timerID, preciseLocation) {\n        clearTimeout(timerID)\n        vm.locationLookupInProgress = false\n        vm.preciseLocation = preciseLocation\n        $scope.$apply()\n      }\n\n      // Instantiate the map in the storeSelectorMap container\n      const initMap = () => {\n        let initialLatitude\n        let initialLongitude\n\n        if (auth.user && auth.user.store) {\n          initialLatitude = auth.user.store.location.latitude\n          initialLongitude = auth.user.store.location.longitude\n        } else {\n          initialLatitude = allStores[0].location.latitude\n          initialLongitude = allStores[0].location.longitude\n        }\n\n        if (window.mapboxgl) {\n          window.mapboxgl.accessToken = config.mapboxglAccessToken\n          map = new window.mapboxgl.Map({\n            container: 'storeSelectorMap',\n            style: 'mapbox://styles/mapbox/streets-v9',\n            center: [initialLongitude, initialLatitude],\n            zoom: 7,\n          })\n          map.addControl(new window.mapboxgl.NavigationControl())\n        }\n\n        // Hacky workaround to give map time to initialize\n        $timeout(() => {\n          map.resize()\n          drawMarkers()\n          geolocate()\n        }, 100)\n      }\n\n      const centerOnStore = store => {\n        if (!store || !vm.showMap || !map) {\n          return\n        }\n\n        map.flyTo({\n          center: [store.location.longitude, store.location.latitude],\n          zoom: 7,\n        })\n      }\n\n      // Clear out / reset any map markers\n      const removeAllMarkers = () => {\n        Object.values(markers).forEach(marker => {\n          marker.remove()\n        })\n\n        markers = {} // Empty markers object (keys are the store id)\n      }\n\n      // Initialize the stores & mapbox map\n      const initMapboxMap = () => {\n        initStores().then(() => {\n          // Open map on initialization if client does not have hideStoreSelectorMapOnInit enabled.\n          if (!config.hideStoreSelectorMapOnInit && !mapAlreadyLoaded) {\n            removeAllMarkers()\n            initMap()\n            mapAlreadyLoaded = true\n          } else {\n            geolocate()\n          }\n        })\n      }\n\n      //* ****\n      // View Model Functions\n      //* ****\n\n      // Toggle the map (only called if the corresponding config is enabled)\n      vm.toggleMap = () => {\n        vm.showMap = !vm.showMap\n\n        if (vm.showMap && !mapAlreadyLoaded) {\n          mapAlreadyLoaded = true\n          removeAllMarkers()\n          initMap()\n        }\n      }\n\n      // Select a given store in the list\n      vm.selectStoreList = (store, index) => {\n        if (vm.currentStore && store && vm.currentStore.id === store.id) {\n          vm.currentStore = null\n        } else {\n          vm.currentStore = store\n        }\n\n        // Prevent non-pickup store from being updated for pickup context.\n        if (vm.shopContextIntent !== SHOPPING_MODES.PICKUP || store.show_pickup) {\n          vm.updateHomeStore(store, index)\n        }\n      }\n\n      // Filter the markers when toggling pickup / non-pickup stores\n      vm.filterMarkers = function () {\n        vm.stores = null\n        onlyShowPickup = !onlyShowPickup\n        return initStores(true).then(() => {\n          if (vm.showMap) {\n            // If the map is open, redraw markers\n            removeAllMarkers()\n            drawMarkers()\n          }\n          geolocate()\n        })\n      }\n\n      // Provide location information for a given address / general location search term (pretty good case for tossing this into a service)\n      vm.geocodeAddress = address => {\n        const deferred = $q.defer()\n        $http\n          .get(\n            `https://api.mapbox.com/geocoding/v5/mapbox.places/${address}.json?country=us,ca&access_token=${config.mapboxglAccessToken}`\n          )\n          .then(response => {\n            let location\n            if (response.data.features.length > 0) {\n              location = {\n                latitude: response.data.features[0].center[1],\n                longitude: response.data.features[0].center[0],\n              }\n              if (vm.showMap) {\n                if (response.data.features[0].bbox) {\n                  // If the map is open & we have a bounding box, do a fancy pan/zoom\n                  // eslint-disable-next-line no-unused-expressions\n                  map.fitBounds\n                    ? map.fitBounds(response.data.features[0].bbox, { maxZoom: 7 })\n                    : null\n                } else {\n                  map.flyTo({ center: response.data.features[0].center }) // Otherwise just jump to the point\n                }\n              }\n            }\n            deferred.resolve(location)\n          })\n\n        return deferred.promise\n      }\n\n      // Search for stores with the given location or search term (via geocode)\n      vm.search = () => {\n        vm.currentStore = null\n        delete vm.stores\n\n        const termsEl = document.querySelector('.store-selector [ng-model=\"terms\"]')\n        if (termsEl) {\n          document.querySelector('.store-selector [ng-model=\"terms\"]').blur()\n        }\n\n        const types = storesService.MATCHED_STORE_TYPES\n        const sharedProps = {\n          allStores,\n          searchTerm: vm.terms,\n          intent: shoppingContextService.selectedFulfillmentType,\n          storeID: auth.user?.store.id,\n        }\n        if (vm.terms && location) {\n          vm.geocodeAddress(vm.terms).then(location => {\n            const { stores, matchedStore } = storesService.filterStores({\n              location,\n              returnMatchedFor: types.SEARCH_BASED,\n              ...sharedProps,\n            })\n            vm.stores = stores\n            centerOnStore(matchedStore)\n          })\n        } else if (location) {\n          const { stores, matchedStore } = storesService.filterStores({\n            location,\n            returnMatchedFor: vm.preciseLocation ? types.LOCATION_BASED : types.DEFAULT,\n            ...sharedProps,\n          })\n          vm.stores = stores\n          centerOnStore(matchedStore)\n        } else {\n          const { stores, matchedStore } = storesService.filterStores(sharedProps)\n          vm.stores = stores\n          centerOnStore(matchedStore)\n        }\n      }\n\n      // Update the home store in the parent controller\n      vm.updateHomeStore = (store, index) => {\n        vm.loadingIndex = index\n\n        $scope.$parent.updateHomeStore(store).finally(() => {\n          delete vm.loadingIndex\n        })\n      }\n\n      // Set parent shopping selector stage if a user wants to change shopping mode for an unavailable store\n      vm.shopAnotherWay = () => {\n        auth.setContext({ intent: null }).then(() => {\n          $scope.$parent.setShoppingSelectorStage('shoppingContext')\n        })\n      }\n\n      vm.updateBannerFilter = bannerSlug => {\n        vm.storeFilters.banner_slug = bannerSlug\n      }\n\n      initMapboxMap()\n    }\n  )\n","import angular from 'angular'\nimport { ADDRESS_FIELDS } from '@app/angular/constants/address'\nimport { SHOPPING_SELECTOR_STAGES } from '@app/angular/constants/shoppingSelectorStages'\nimport unsupportedPostalCodeErrorModalTemplate from '../views/unsupportedPostalCodeErrorModalTemplate.html'\nimport { isUnsupportedPostalCode } from './helpers'\n\nexport default angular\n  .module('StoreSelectorListControllerComponentModule', [])\n  .controller(\n    'StoreSelectorListController',\n    function (\n      $rootScope,\n      $scope,\n      addressList,\n      analytics,\n      auth,\n      config,\n      errorModalService,\n      lang,\n      storesService\n    ) {\n      $scope.auth = auth\n      $scope.addressList = addressList\n      $scope.stores = null\n      $scope.loading = false\n      $scope.config = config\n      $scope.showInput = true\n      $scope.ADDRESS_FIELDS = ADDRESS_FIELDS\n      $scope.delivery = { postalCode: '' }\n      $scope.isUnsupportedPostalCode = false\n      $scope.autoCompleteOptionSelected = false\n\n      $scope.requireFullAddress = config.shoppingContextProcess.delivery.requireFullAddress\n      $scope.showMultipleDeliveryAddresses =\n        config.enableMultipleDeliveryAddresses && auth.user.status !== 'trial'\n\n      $scope.addressInputLabel = `${lang.values.enter} ${\n        $scope.requireFullAddress ? lang.values.deliveryAddress : lang.values.postalCode\n      }`\n\n      $scope.addressInputChangedCallback = () => {\n        $scope.$parent.clearShoppingSelectorStageErrorMessage(\n          SHOPPING_SELECTOR_STAGES.STORE_SELECTOR\n        )\n        if ($scope.requireFullAddress) {\n          $scope.delivery.postalCode = ''\n        }\n      }\n\n      if ($scope.requireFullAddress) {\n        $scope.addressChosenCallback = address => {\n          $scope.selectedAddress = address\n          $scope.delivery.postalCode = address.postal_code\n          if ($scope.deliveryDefaultPrevented) {\n            $scope.deliveryDefaultPrevented = false\n            $scope.fetchStores()\n          }\n        }\n      }\n\n      $scope.addressListChosenCallback = address => {\n        $scope.selectedAddress = address\n        $scope.delivery.postalCode = address.postal_code\n        return $scope.fetchStores()\n      }\n\n      $scope.fetchStores = function (e) {\n        $scope.stores = null\n        $scope.loading = true\n        $scope.$parent.clearShoppingSelectorStageErrorMessage(\n          SHOPPING_SELECTOR_STAGES.STORE_SELECTOR\n        )\n\n        if ($scope.$parent.shopContextIntent === 'delivery') {\n          // Picking a store also results in submitting the form.\n          if (e && e.type === 'submit') {\n            if ($scope.requireFullAddress) {\n              if (!$scope.delivery.postalCode) {\n                e.preventDefault()\n                $scope.deliveryDefaultPrevented = true\n                // Do not show message when submit was triggered by hitting enter while user had\n                // selected address from autocomplete list.\n                // Hitting enter in this case will make autocomplete widget asynchronously  populate\n                // address and trigger fetchStores\n                if (!$scope.autoCompleteOptionSelected) {\n                  $scope.$parent.setShoppingSelectorErrorMessage(\n                    SHOPPING_SELECTOR_STAGES.STORE_SELECTOR,\n                    lang.template(lang.values.deliveryFullAddressRequired)\n                  )\n                }\n                $scope.loading = false\n                return\n              }\n            } else {\n              $scope.selectedAddress = {\n                postal_code: $scope.delivery.postalCode?.toUpperCase().replace(/\\s/g, ''),\n              }\n            }\n          }\n\n          // Display error message if no postal code is entered.\n\n          if (!$scope.delivery.postalCode) {\n            const errorTemplate = $scope.requireFullAddress\n              ? lang.values.deliveryFullAddressRequired\n              : lang.values.deliveryPostalCodeRequired\n            $scope.$parent.setShoppingSelectorErrorMessage(\n              SHOPPING_SELECTOR_STAGES.STORE_SELECTOR,\n              lang.template(errorTemplate, { postalCode: lang.values.postalCode })\n            )\n            $scope.loading = false\n            return false\n          }\n\n          const address = { ...$scope.selectedAddress }\n\n          $scope.isUnsupportedPostalCode = isUnsupportedPostalCode(\n            $scope.selectedAddress.postal_code\n          )\n\n          const openUnsupportedPostalCodeErrorModal = () => {\n            if (config.enableUnsupportedPostalCodeCheck && $scope.isUnsupportedPostalCode) {\n              $scope.$dismiss()\n              errorModalService.openCustom(unsupportedPostalCodeErrorModalTemplate, { lang })\n            }\n          }\n\n          const handleDeliveryUnavailable = () => {\n            $scope.showInput = false\n            $scope.delivery.postalCode = null\n            const { postal_code } = address\n            $scope.$parent.setShoppingSelectorErrorMessage(\n              SHOPPING_SELECTOR_STAGES.STORE_SELECTOR,\n              config.enableUnsupportedPostalCodeCheck && $scope.isUnsupportedPostalCode\n                ? lang.values.unsupportedPostalCodeErrorMsg\n                : lang.template(lang.values.wereSorryPostalCode, {\n                    searchedPostalCode: lang.sanitize(postal_code),\n                  })\n            )\n\n            $scope.loading = false\n            if (config.enableUnsupportedPostalCodeCheck && $scope.isUnsupportedPostalCode) {\n              openUnsupportedPostalCodeErrorModal()\n            }\n          }\n\n          const fetchStores = params => {\n            const paramsFromAddress = auth.getUrlParamsFromAddress(address)\n\n            return storesService\n              .fetch({\n                ...params,\n                ...paramsFromAddress,\n                show_delivery: true,\n              })\n              .then(stores => {\n                $scope.stores = stores\n                if (stores.length > 0) {\n                  let newStore = stores[0]\n\n                  // Associated store will be selected if there is a match with retailer_slug\n                  // of current context. Example: A user is on Spirits store type when switching\n                  // store location AND new location has Spirits as well, THEN Spirits is selected\n                  const currentShopContext = auth.getContext()\n                  if (newStore.associated_stores.length) {\n                    newStore.associated_stores.forEach(store => {\n                      if (store.store_banner.key === currentShopContext.retailer_slug) {\n                        newStore = store\n                      }\n                    })\n                  }\n                  // setting flag to indicate that store was changed for $rootScope.reloadState\n                  $rootScope.deliveryStoreChangeIsInProgress = true\n\n                  return $scope.$parent.updateDeliveryStore(newStore, address).then(() => {\n                    $scope.loading = false\n                  })\n                } else {\n                  // No stores available.\n                  handleDeliveryUnavailable()\n                }\n              })\n              .catch(err => {\n                handleDeliveryUnavailable()\n              })\n          }\n\n          const saveEnteredAddressToBook = () => {\n            // Save new address to address book when.\n            // 1. Address was entered to input and not selected from address book, in this case address does not have ID\n            // 2. It is registered user\n            // 3. Config requires to enter full address (not only ZipCode)\n            if (!address.id && auth.user.status !== 'trial' && $scope.requireFullAddress) {\n              auth.getProfile().then(({ first_name, last_name }) => {\n                // for some reasons saveAddress() expects a short code of province/state in province field\n                const { address1, city, province_short: province, postal_code } = address\n                addressList\n                  .saveAddress({\n                    address1,\n                    city,\n                    province,\n                    postal_code,\n                    first_name,\n                    last_name,\n                  })\n                  .then(address => {\n                    addressList.markAddressValidated(address.id)\n                    addressList.fetchAddresses()\n                  })\n              })\n            }\n          }\n\n          const fetchBannersThenStores = () => {\n            let deliveryAvailable = false\n\n            return storesService\n              .fetchBanners(auth.getUrlParamsFromAddress(address))\n              .then(storeBanners => {\n                if (storeBanners.is_ic_retailer === false) {\n                  deliveryAvailable = true\n                  return fetchStores()\n                } else if (storeBanners.items.length > 0) {\n                  deliveryAvailable = true\n                  if (\n                    storeBanners.items.length > 1 &&\n                    !config.multipleBanners.enableNonTabulatedView\n                  ) {\n                    $scope.$parent.setDeliveryBannersAndAddress(storeBanners.items, address)\n                    $scope.$parent.$parent.setShoppingSelectorStage(\n                      SHOPPING_SELECTOR_STAGES.BANNER_SELECTOR\n                    )\n                    $scope.loading = false\n                  } else {\n                    return fetchStores({ retailer_slug: storeBanners.items[0] })\n                  }\n                } else {\n                  // No banners available.\n                  handleDeliveryUnavailable()\n                }\n              })\n              .finally(args => {\n                if (deliveryAvailable) {\n                  saveEnteredAddressToBook()\n                }\n              })\n          }\n          return fetchBannersThenStores()\n\n          // Delivery person is just assigned the store that they are given from the backend, based on ther postal / zip code\n        }\n\n        // We pass in the zip / postal code when we are looking for store for pickup person\n\n        if ($scope.$parent.shopContextIntent === 'pickup') {\n          storesService\n            .fetch({\n              show_pickup: true,\n            })\n            .then(stores => {\n              $scope.stores = stores\n              $scope.loading = false\n            })\n        }\n        // We pass in the zip / postal code when we are looking for store for instore person\n\n        if ($scope.$parent.shopContextIntent === 'instore') {\n          storesService.fetch({}).then(stores => {\n            $scope.stores = stores\n            $scope.loading = false\n          })\n        }\n      }\n\n      if ($scope.$parent.shopContextIntent !== 'delivery') {\n        $scope.fetchStores()\n      }\n\n      $scope.setAutoCompleteOptionSelected = val => ($scope.autoCompleteOptionSelected = val)\n    }\n  )\n","import { QUEBEC_POSTAL_DISTRICT_LETTERS } from '@app/angular/constants/address'\n\n/**\n * Returns version of the stores list that puts the currently active store at\n * the top of the list\n *\n * @param {number|string} storeID\n * @param {Store[]|null} stores The list of stores (or null)\n * @returns\n */\nexport function prioritizeActiveStore(storeID, stores) {\n  // Exit early to account for stores being null\n  if (!stores || storeID === undefined || storeID === null) {\n    return stores\n  }\n\n  const strStoreID = `${storeID}`\n  const activeStoreIdx = stores.findIndex(store => {\n    return `${store.id}` === strStoreID\n  })\n\n  const shouldPreserveWhenNotInTheList = activeStoreIdx < 0\n  if (shouldPreserveWhenNotInTheList || activeStoreIdx === 0) {\n    return stores\n  }\n\n  // Construct a new array with the active store at the front and the rest of\n  // the array preserving the same order\n  return [\n    stores[activeStoreIdx],\n    ...stores.slice(0, activeStoreIdx),\n    ...stores.slice(activeStoreIdx + 1),\n  ]\n}\n\n/**\n * Checks if the given postal code is unsupported based on certain criteria.\n * Currently, this 'criteria' is used to check for Quebec postal district codes, for Costco Canada.\n *\n * @param {string} postalCode\n */\nexport function isUnsupportedPostalCode(postalCode = '') {\n  return QUEBEC_POSTAL_DISTRICT_LETTERS.includes(postalCode[0])\n}\n","import angular from 'angular'\nimport template from './views/shoppingSelectorModalHeader.html'\n\nexport default angular\n  .module('shoppingSelectorModalHeaderComponentModule', [])\n  .directive('shoppingSelectorModalHeader', function () {\n    return {\n      template,\n    }\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('MultpleBannerTabsComponentModule', [])\n  .component('multipleBannerTabs', {\n    bindings: {\n      tabsConfig: '<',\n      tabSelected: '&',\n      currentValue: '<',\n    },\n    controller() {\n      const vm = this\n      vm.tabClicked = bannerSlug => {\n        vm.tabSelected({ bannerSlug })\n      }\n    },\n    template: `\n      <div class=\"tabs\">\n        <multiple-banner-tabs-tab\n          tab-title=\"$ctrl.tabsConfig.allStores\"\n          tab-banner-slug=\"''\"\n          tab-selected=\"$ctrl.tabClicked(bannerSlug)\"\n          current-value=\"$ctrl.currentValue\"\n        ></multiple-banner-tabs-tab>\n        <multiple-banner-tabs-tab\n          ng-repeat=\"banner in $ctrl.tabsConfig.banners\"\n          tab-title=\"banner.name\"\n          tab-banner-slug=\"banner.bannerSlug\"\n          tab-selected=\"$ctrl.tabClicked(bannerSlug)\"\n          current-value=\"$ctrl.currentValue\"\n        ></multiple-banner-tabs-tab>\n      </div>\n    `,\n  })\n  .component('multipleBannerTabsTab', {\n    bindings: {\n      tabTitle: '<',\n      tabBannerSlug: '<',\n      tabSelected: '&',\n      currentValue: '<',\n    },\n    controller() {\n      Object.assign(this, {\n        tabClicked: () => this.tabSelected({ bannerSlug: this.tabBannerSlug }),\n      })\n    },\n    template: `\n      <div\n        class=\"tab\"\n        role=\"button\"\n        ng-click=\"$ctrl.tabClicked()\"\n        ng-class=\"{active: $ctrl.currentValue === $ctrl.tabBannerSlug}\"\n      >\n        <banner-image\n          ng-if=\"$ctrl.tabBannerSlug\"\n          banner-slug=\"$ctrl.tabBannerSlug\"\n        ></banner-image>\n        {{::$ctrl.tabTitle}}\n      </div>\n    `,\n  })\n","import angular from 'angular'\n\nexport default angular.module('BannerSelectorComponentModule', []).component('bannerSelector', {\n  bindings: {\n    banners: '<',\n    hideUnavailableBanners: '<',\n    availableBannerSlugs: '<',\n    selected: '<',\n    onSelect: '&',\n    onShopAnotherWay: '&',\n  },\n  controller(lang) {\n    const getFilterdBanners = () => {\n      if (this.hideUnavailableBanners) {\n        return this.banners.filter(banner => this.availableBannerSlugs.includes(banner.bannerSlug))\n      }\n      return this.banners\n    }\n\n    Object.assign(this, {\n      filteredBanners: getFilterdBanners(),\n      lang,\n      isBannerAvailable: bannerSlug => this.availableBannerSlugs?.includes(bannerSlug),\n      selectBanner: bannerSlug => this.onSelect({ bannerSlug }),\n    })\n  },\n  template: `\n      <div\n        class=\"banner-container\"\n        ng-class=\"{\n          selected: banner.bannerSlug === $ctrl.selected\n        }\"\n        ng-repeat=\"banner in $ctrl.filteredBanners track by banner.bannerSlug\"\n      >\n        <div class=\"banner-image-container\">\n          <banner-image banner-slug=\"banner.bannerSlug\"></banner-image>\n        </div>\n        <div class=\"banner-name\" ng-class=\"{'has-error': !$ctrl.isBannerAvailable(banner.bannerSlug)}\">\n          <span>{{banner.name}}</span>\n          <p class=\"selection-error-msg\" ng-if=\"!$ctrl.isBannerAvailable(banner.bannerSlug)\">\n            {{::$ctrl.lang.values.deliveryUnavailableAtZip}}\n          </p>\n        </div>\n        <div>\n          <button\n            class=\"button hollow small\"\n            type=\"button\"\n            ng-if=\"$ctrl.isBannerAvailable(banner.bannerSlug)\"\n            ng-click=\"$ctrl.selectBanner(banner.bannerSlug)\"\n          >\n            {{::$ctrl.lang.values.select}}\n          </button>\n          <button\n            class=\"button hollow small\"\n            type=\"button\"\n            ng-if=\"!$ctrl.isBannerAvailable(banner.bannerSlug) && !$ctrl.onShopAnotherWay\"\n            disabled=\"true\"\n          >\n            {{::$ctrl.lang.values.shopAnotherWay}}\n          </button>\n          <button\n            class=\"button hollow small\"\n            type=\"button\"\n            ng-if=\"!$ctrl.isBannerAvailable(banner.bannerSlug) && $ctrl.onShopAnotherWay\"\n            ng-click=\"$ctrl.onShopAnotherWay()\"\n          >\n            {{::$ctrl.lang.values.shopAnotherWay}}\n          </button>\n        </div>\n      </div>\n    `,\n})\n","import angular from 'angular'\nimport CartListTransfer from './cartListTransfer/cartListTransferState.routes.js'\nimport ShoppingSelectorConfirmation from './confirmation/shoppingSelectorConfirmationController.js'\nimport ShoppingContextItem from './contextSelector/shoppingContextItem.component.js'\nimport ContextSelector from './contextSelector/contextSelectorController.js'\nimport TimeslotSelector from './timeslotSelector/timeslotSelectorController.js'\nimport ShoppingSelectorService from './shoppingSelectorService.js'\nimport ShoppingSelectorRoutes from './shoppingSelectorRoutes.js'\nimport ParentShoppingSelectorControllerModule from './parentShoppingSelectorController.js'\nimport StoreSelectorController from './storeSelector/storeSelectorController.js'\nimport StoreSelectorMapController from './storeSelector/storeSelectorMapController.js'\nimport StoreSelectorListController from './storeSelector/storeSelectorListController.js'\nimport ShoppingSelectorModalHeader from './shoppingSelectorModalHeader.js'\nimport MultipleBannerTabsComponent from './storeSelector/multipleBannerTabs.component.js'\nimport BannerSelectorComponent from './bannerSelector.component.js'\n\nexport default angular.module('app.component.shoppingSelectorModule', [\n  CartListTransfer.name,\n  ContextSelector.name,\n  TimeslotSelector.name,\n  ShoppingSelectorConfirmation.name,\n  ShoppingContextItem.name,\n  ParentShoppingSelectorControllerModule.name,\n  ShoppingSelectorService.name,\n  ShoppingSelectorRoutes.name,\n  StoreSelectorController.name,\n  StoreSelectorMapController.name,\n  StoreSelectorListController.name,\n  ShoppingSelectorModalHeader.name,\n  MultipleBannerTabsComponent.name,\n  BannerSelectorComponent.name,\n])\n","import _ from 'lodash'\nimport angular from 'angular'\nimport { getSortOptions } from '@app/utils/cart'\nimport {\n  areAllItemsRx,\n  getSalePrice,\n  inCateringMode,\n} from '@instacart/enterprise-services/shopping-list/_common/utils'\n\nconst SIDE_CART = 'Side Cart'\n\nexport default angular\n  .module('SideCartControllerModule', [])\n  .controller(\n    'SideCartController',\n    function (\n      $controller,\n      $element,\n      $rootScope,\n      $scope,\n      $state,\n      $timeout,\n      auth,\n      cartAnalytics,\n      cartService,\n      config,\n      ebtCardService,\n      lang,\n      listPrintService,\n      mobileService,\n      oneCartService,\n      rateApp,\n      shoppingSelectorService,\n      sideCartSortModalService,\n      undoRemove,\n      utilService\n    ) {\n      $controller('CheckoutCartController', {\n        $scope,\n        // upSellProducts is a dependency for the CheckoutCartController because it is needed in the main.checkout.cart state.\n        // To satisfy the dependency it is passed in as an empty list here.\n        upsellProducts: [],\n      })\n\n      const SORT_OPTIONS = getSortOptions(lang)\n\n      $scope._ = _\n      $scope.config = config\n      $scope.mobile = mobileService\n      $scope.newCustomItem = {\n        name: '',\n      }\n      $scope.sideCartMenu = {\n        isOpen: false,\n      }\n      $scope.sortType = 'category'\n      $scope.showSortModal = false\n      $scope.listPrintService = listPrintService\n\n      $scope.setSortType = function (type) {\n        $scope.sortType = type\n      }\n      $scope.shoppingSelectorService = shoppingSelectorService\n\n      // As the user scrolls we adjust the height of the side cart, this ensures layout is correct\n      // We only need to do this to support flex in the non-one-cart desktop view\n      if (!mobileService.isMobile && !oneCartService.enabled()) {\n        $scope.sideCartPositionChange = el => {\n          const elTop = el[0].getBoundingClientRect().top\n          el.css('height', `calc(100% - ${elTop}px`)\n        }\n        $timeout(() => $scope.sideCartPositionChange($element), 100) // Initial height sync\n      }\n\n      $scope.onContinueShopping = () => {\n        if ($scope.mobile.isMobile) {\n          $scope.closeSideCart()\n        } else {\n          $scope.handleContinueShoppingClick()\n        }\n      }\n\n      $scope.closeSideCart = function () {\n        $rootScope.$broadcast('sideCart', 'close')\n      }\n\n      $scope.handleSideCartReView = function () {\n        const el = document.getElementById('side-cart-container')\n        utilService.getFocusableElements(el)[0].focus()\n      }\n\n      $scope.handleSideCartSkip = function () {\n        const el = document.getElementById('content')\n        utilService.getFocusableElements(el)[0].focus()\n        $scope.closeSideCart()\n      }\n\n      $scope.handleContinueShoppingClick = () => {\n        if (oneCartService.enabled()) {\n          $scope.closeSideCart()\n        }\n      }\n\n      $scope.auth = auth\n      Object.defineProperty($scope, 'inStoreIntent', {\n        get: () => auth.getContext().intent === 'instore',\n      })\n      Object.defineProperty($scope, 'sideCartLabel', {\n        get: () => {\n          return (\n            lang.values.sideCartTitleLabel ||\n            ($scope.inStoreIntent\n              ? config.shoppingSelector.instore.shortTitle || config.shoppingSelector.instore.title\n              : lang.values.cart)\n          )\n        },\n      })\n\n      $scope.isShowCartMinimumAlert = dataByCartType => {\n        const userHasEbtCardAndEbtItems =\n          config.ebt.enabled && ebtCardService.userHasEbtCard && cartService.cartHasEbtItem()\n\n        const isCartBelowMin = config.useMultiContextCart\n          ? // Check if there is a cart that has not reached a cart min yet (all carts need to be above the min)\n            Object.keys(dataByCartType)?.length === 0 ||\n            Object.values(dataByCartType).some(\n              cart => cart.cartMinMsg && !areAllItemsRx(cart.items)\n            )\n          : cartService.isCartBelowMin()\n\n        return (\n          isCartBelowMin && !userHasEbtCardAndEbtItems && !areAllItemsRx(cartService.cart?.items)\n        )\n      }\n\n      $scope.showOrderOnlineButton = cartService.canOrderOnline()\n\n      // check for app review\n      const cartLength = _.get(cartService, 'cart.items.length', 0)\n      const listItemsToReview = config.mobileAppRate.listItemsReviewed\n      // eslint-disable-next-line eqeqeq\n      if (listItemsToReview != -1) {\n        if (cartLength >= listItemsToReview && $scope.inStoreIntent) {\n          rateApp.promptAppReview()\n        }\n      }\n\n      $scope.checkItem = item => {\n        cartService.currentEnterpriseService.actions.updateItemChecked(item, item.checked)\n        cartService.sync()\n      }\n\n      // Handle custom items\n\n      $scope.addCustomItem = function (itemName) {\n        if (itemName.length) {\n          cartService.addItem(itemName, 1)\n          $scope.newCustomItem.name = ''\n        }\n      }\n\n      $scope.removeCustomItem = function (item) {\n        cartService.removeItem(item.pseudo_product.name)\n      }\n\n      $scope.toggleAddCustom = function (value) {\n        $scope.showAddCustom = value\n        if ($scope.showAddCustom) {\n          const customItemInput = document.querySelector('.add-custom-item > form > input')\n          customItemInput.focus()\n        } else {\n          utilService.blurAndHideKeyboard()\n        }\n      }\n\n      $scope.customItems = function () {\n        if (cartService.cart) {\n          const customItems = _.filter(cartService.cart.items, {\n            item_type: 'pseudo_product',\n          })\n          return customItems\n        }\n      }\n\n      $scope.shouldShowSidecart = () => {\n        // We do not wish to show the side cart in any of the following \"exception\" routes\n        if (mobileService.isMobile && !oneCartService.enabled()) return false\n\n        const exceptionRoutes = [\n          'main.sideCart',\n          'main.checkout',\n          'main.inStoreList.review',\n          'main.subscriptions',\n        ]\n        const inExceptionRoute = _.some(exceptionRoutes, exception => $state.includes(exception))\n        const cartHasItems = cartService.cart && cartService.cart.items.length > 0\n\n        const shouldShowSidecart =\n          !inExceptionRoute && (cartHasItems || $scope.isOneCartEnabled() || inCateringMode())\n\n        $rootScope.showingSideCart = shouldShowSidecart\n        return shouldShowSidecart\n      }\n\n      $scope.isOneCartEnabled = () => oneCartService.enabled()\n\n      $scope.isItemEbtEligible = item =>\n        item.store_product.usa_snap_eligible &&\n        ebtCardService.userHasEbtCard &&\n        auth.user.store?.ebt_enabled_in_state\n\n      $scope.overrideSalePrice = item => {\n        if (\n          config.useSalePricingForOffersInSideCartCostcoOnly &&\n          item.quantity !== 0 &&\n          cartService.itemHasOffer(item)\n        ) {\n          return getSalePrice(item)\n        }\n      }\n\n      $scope.$on('$destroy', () => {\n        $rootScope.showingSideCart = false\n      })\n\n      $scope.sortOptionNameByValue = value =>\n        SORT_OPTIONS.find(option => option.value === value)?.name\n\n      $scope.triggerSortModal = () => {\n        $scope.showSortModal = true\n        sideCartSortModalService\n          .open({\n            sortOptions: SORT_OPTIONS,\n            sort: $scope.sortType,\n          })\n          .then(\n            results => {\n              $scope.setSortType(results.sort)\n              $scope.showSortModal = false\n            },\n            () => {\n              $scope.showSortModal = false\n            }\n          )\n      }\n\n      /**\n       * Adds a given *quantity* of items to the cart\n       *\n       * @param {object} item\n       * @param {number} quantity\n       * @param {number} index - position of the item in the side cart\n       *\n       * @returns {undefined}\n       */\n      $scope.addItem = (item, quantity, index) => {\n        cartAnalytics.addItem(item.store_product, quantity, index, SIDE_CART, {})\n        cartService.incrementItem(item.store_product, quantity, item.product_config)\n      }\n\n      /**\n       * Focuses on the item remove confirmation dialog of a given item\n       * @param {object} item - selected item\n       * @param {number} index - selected item index\n       *\n       * @returns {undefined}\n       */\n      $scope.focusOnDeleteConfirmation = (item, index) => {\n        const el = document.querySelector(`#item-remove-alert-${item.id}-${index}`)\n\n        el.focus()\n        utilService.trapFocusOn(el)\n      }\n\n      /**\n       * Removes a given *quantity* of items from the cart\n       *\n       * @param {object} item\n       * @param {number} quantity\n       * @param {number} index - position of the item in the side cart\n       * @param {boolean} wasConfirmed\n       * @returns {undefined}\n       */\n      $scope.removeItem = (item, quantity, index, wasConfirmed) => {\n        cartAnalytics.removeItem(item.store_product, quantity, index, SIDE_CART, {})\n\n        const { action, result } = cartService.decrementItem(\n          item.store_product,\n          quantity,\n          item.product_config\n        )\n        if (\n          !wasConfirmed &&\n          action === cartService.updateActions.remove &&\n          mobileService.isMobile &&\n          result?.then\n        ) {\n          result.then(() => undoRemove.showToast(item))\n        }\n      }\n\n      /**\n       * Triggered when the weight is updated\n       *\n       * @param {object} item                - The product item being updated\n       * @param {number} $originalQuantity   - [Provided] The original quantity before the change\n       * @param {function} $onZeroFn         - [Provided] Callback to trigger if the new quantity is zero\n       *\n       * @returns {undefined}\n       */\n      $scope.updateQuantity = (item, $originalQuantity, $onZeroFn) => {\n        const isZero = item.quantity === 0\n        if ($onZeroFn && isZero) {\n          $onZeroFn()\n          item.quantity = $originalQuantity\n          return\n        }\n\n        const { store_product, quantity, product_config } = item\n        cartService.updateItemQuantity(store_product, quantity, product_config?.options)\n      }\n\n      $scope.hasEligibleEbtCard = () =>\n        ebtCardService.userHasEbtCard && auth.user.store?.ebt_enabled_in_state\n    }\n  )\n","import angular from 'angular'\nimport template from './sideCart.html'\nimport SideCartControllerModule from './sideCartController.js'\n\nexport default angular\n  .module('SideCartComponentModule', [SideCartControllerModule.name])\n  .config($stateProvider => {\n    $stateProvider.state('main.sideCart', {\n      url: '/side-cart',\n      views: {\n        'content@': {\n          template,\n          controller: 'SideCartController',\n        },\n      },\n    })\n  })\n  .run($templateCache => {\n    $templateCache.put('sideCartListItem.html', require('./sideCartListItem.html'))\n    $templateCache.put('sideCartListMultiContext.html', require('./sideCartListMultiContext.html'))\n    $templateCache.put('sideCartList.html', require('./sideCartList.html'))\n  })\n","import angular from 'angular'\nimport { shoppingList as shoppingListService } from '@instacart/enterprise-services'\nimport { getRemainingAmount } from '@instacart/enterprise-services/shopping-list/_common/utils'\nimport {\n  getNumCartMinCount,\n  getFirstCartMinMsgWithBanner,\n} from '@instacart/enterprise-services/shopping-list/cart/utils'\nimport template from './sideCartBottomButtons.html'\n\nconst EBT_NOTICE_ALERT_ID = 'sidecart_noEBTMinimumText'\n\nexport default angular\n  .module('SideCartBottomButtonsModule', [])\n  .component('sideCartBottomButtons', {\n    bindings: {\n      closeSideCart: '&',\n      handleCheckoutClick: '&',\n      inStoreIntent: '<',\n      showCartMinimumAlert: '<',\n      showOrderOnlineButton: '<',\n      mcoxCartData: '<',\n    },\n    template,\n    transclude: true, // Allows for child content where ng-transclude is used within this template\n    controller(\n      $filter,\n      $state,\n      auth,\n      cartService,\n      config,\n      ebtCardService,\n      lang,\n      mobileService,\n      oneCartService,\n      shoppingSelectorService\n    ) {\n      const { shoppingSelector } = config\n      const currencyFilter = $filter('currency')\n\n      Object.assign(this, {\n        EBT_NOTICE_ALERT_ID,\n        cartService,\n        config,\n        lang,\n        mobileService,\n        noEBTMinimum: lang.values.cartMinimum.noEBTMinimum,\n        shoppingSelectorService,\n      })\n\n      this.isLoggedIn = () => auth.user.status !== 'trial'\n\n      this.isEbtEnabled = () =>\n        oneCartService.enabled() && config.ebt?.enabled && auth.user.store?.ebt_enabled_in_state\n\n      this.isNotInstore = () => {\n        return (\n          !this.inStoreIntent &&\n          (shoppingSelector.delivery.exists ||\n            shoppingSelector.pickup.exists ||\n            shoppingSelector.catering.exists)\n        )\n      }\n\n      this.getMinCartAlertMessage = () => {\n        const cartMinimum = shoppingListService.commonUtils.getMinimumCartSpend() || 0\n        const cartTotals = cartService.getCartTotals()\n\n        if (config.useMultiContextCart) {\n          const cartMinCount = getNumCartMinCount(this.mcoxCartData)\n          if (cartMinCount === 1) {\n            return getFirstCartMinMsgWithBanner(this.mcoxCartData)\n          }\n          if (cartMinCount > 1) {\n            return lang.template(lang.values.cartMinimum.mcoxCartMinGenericText, {\n              amount: currencyFilter(cartMinimum),\n            })\n          }\n        }\n\n        return lang.template(lang.values.cartMinimum.miniCartAlertText, {\n          amount: currencyFilter(cartMinimum),\n          remainingAmount: currencyFilter(\n            getRemainingAmount(\n              cartMinimum,\n              cartTotals?.pre_reward_program_discount_product_total,\n              cartService?.cart?.items\n            )\n          ),\n        })\n      }\n\n      this.getCheckoutButtonMessage = () => {\n        const checkoutString = lang.values.checkoutLinkWithSubtotal || lang.values.checkoutLink\n        const cartSubtotal = config.useMultiContextCart\n          ? cartService.cart?.product_total\n          : cartService.getCartTotalForCurrentType()\n        return lang.template(checkoutString, {\n          subtotal: currencyFilter(cartSubtotal),\n        })\n      }\n\n      this.onBottomButtonActionClick = $event => {\n        if (this.showCartMinimumAlert) {\n          const { desktop, mobile } = config.continueShoppingRedirect\n          const continueShoppingRedirect = mobileService.isMobile ? mobile : desktop\n\n          $state.go(continueShoppingRedirect)\n          this.closeSideCart()\n        } else {\n          this.handleCheckoutClick({ $event })\n        }\n      }\n    },\n  })\n","import dayjs from 'dayjs'\nimport angular from 'angular'\nimport { HTTP_ERRORS } from '@app/angular/constants/httpErrors'\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\nimport { DATE_OF_BIRTH_FORMAT } from '@app/angular/constants/alcoholValidation'\nimport { FULFILLMENT_TYPES, CHECKOUT_STEPS_STATUS } from '@app/angular/constants/checkout'\nimport alcoholValidationErrorModal from '@app/angular/services/templates/alcoholValidation/alcoholValidationErrorModal.html'\n\nexport default angular\n  .module('checkoutServiceModule', [])\n  .service(\n    'checkoutService',\n    function (\n      $q,\n      $rootScope,\n      $state,\n      addressList,\n      alcoholValidation,\n      analytics,\n      auth,\n      cartService,\n      checkoutAnalytics,\n      config,\n      errorModalService,\n      lang,\n      mobileNativeHrefService,\n      promoCodeService,\n      registrationService,\n      reservationService\n    ) {\n      Object.assign(this, {\n        $q,\n        $rootScope,\n        auth,\n        config,\n        cartService,\n        error: null,\n        addressList,\n        contact: null,\n        alcoholValidation,\n        errorModalService,\n        reservationService,\n        deliveryAddress: null,\n        validateWithFees: true,\n        isCartValidated: false,\n        lastUsedPaymentInstrument: null,\n        orderDeliveryInstructions: null,\n        isBillingAddressSameAsDelivery: true,\n        fulfillmentType: auth.getContext().intent,\n        stepsStatuses: { ...CHECKOUT_STEPS_STATUS },\n      })\n\n      /**\n       * Setter for the delivery address attribute\n       * @param {object} address\n       */\n      this.setDeliveryAddress = address => {\n        this.deliveryAddress = address\n      }\n\n      /**\n       * Setter for the contact attribute\n       * @param {object} contact\n       */\n      this.setContact = contact => {\n        this.contact = contact\n      }\n\n      /**\n       * Setter for the order delivery instructions attribute\n       * @param {boolean} leaveUnattended\n       */\n      this.setOrderDeliveryInstructions = leaveUnattended => {\n        this.orderDeliveryInstructions = { leaveUnattended }\n      }\n\n      this.clearOrderDeliveryInstructions = () => {\n        this.orderDeliveryInstructions = { leaveUnattended: null }\n      }\n\n      /**\n       * Validates a given billing address object\n       *\n       * @param {object} billingAddress\n       * @returns {boolean}\n       */\n      this.isBillingAddressValid = ({ address1, city, province, postal_code }) => {\n        if (\n          this.fulfillmentType === FULFILLMENT_TYPES.DELIVERY &&\n          this.isBillingAddressSameAsDelivery\n        ) {\n          return true\n        }\n\n        return address1 && city && province && postal_code\n      }\n\n      /**\n       * Returns promise that resolves with the current selected address\n       * Addresses are saved in different places depending on if the retailer is\n       * using multiple delivery addresses or not\n       *\n       * @param { boolean } isCheckoutScreen  - set to to true if checking out\n       * @returns { Promise }\n       */\n      this.getSelectedDeliveryAddress = isCheckoutScreen => {\n        const deferred = this.$q.defer()\n        const currentContext = this.auth.getContext()\n\n        const findAddress = address => address.id === currentContext.address_id\n\n        const existingAddress = cartService.cart?.order?.delivery_address\n        if (!isCheckoutScreen && existingAddress) {\n          deferred.resolve(existingAddress)\n        } else if (this.config.enableMultipleDeliveryAddresses) {\n          if (this.addressList.addressesLoaded) {\n            deferred.resolve(this.addressList.addressItems.find(findAddress))\n          } else {\n            this.addressList.fetchAddresses().then(addresses => {\n              deferred.resolve(addresses.find(findAddress))\n            })\n          }\n        } else if (this.addressList.addressesLoaded) {\n          deferred.resolve(this.addressList.addressItems[0])\n        } else {\n          this.addressList.fetchAddresses().then(addresses => {\n            deferred.resolve(addresses[0])\n          })\n        }\n\n        return deferred.promise\n      }\n\n      this.setError = error => {\n        this.error = error ? error.message : null\n      }\n\n      /**\n       * Updates the cart and fees validation status.\n       *\n       * When the cart size has changed the next cart validation call should include the with_fees param\n       * and the validation status of the cart is set to false\n       *\n       * @param { boolean } hasChanged\n       *\n       * @returns { undefined }\n       */\n      this.handleCartCompareChange = hasChanged => {\n        this.validateWithFees = this.validateWithFees || hasChanged\n\n        if (this.isCartValidated && hasChanged) {\n          this.isCartValidated = false\n        }\n      }\n\n      this.setLastUsedPaymentInstrument = paymentInstrument => {\n        this.lastUsedPaymentInstrument = paymentInstrument\n      }\n\n      this.getLastUsedPaymentInstrument = () => {\n        return this.lastUsedPaymentInstrument\n      }\n\n      /**\n       * @private Gets and modifies order params for checkout\n       *\n       * @param { object } addressList        - addressList service\n       * @param { object } auth               - auth service\n       * @param { object } alcoholValidation  - alcoholValidation service\n       * @param { object } config             - config service\n       * @param { object } paymentObject      - The payment as acquired from the api and updated by the gateway for checkout\n       *\n       * @returns { Object }\n       */\n      this._getOrderParams = (addressList, auth, alcoholValidation, config, paymentObject) => {\n        const context = auth.getContext()\n        const ordersParams = angular.copy(paymentObject)\n\n        if (config.alcoholCompliance.enabled) {\n          ordersParams.user_birthday = alcoholValidation.getDateOfBirth()\n            ? dayjs(alcoholValidation.getDateOfBirth(), DATE_OF_BIRTH_FORMAT).toISOString()\n            : null\n        }\n\n        if (context.intent === SHOPPING_MODES.DELIVERY) {\n          ordersParams.delivery_address = { ...this.deliveryAddress }\n        }\n\n        ordersParams.contact_info = this._getContactInfo()\n\n        if (this.orderDeliveryInstructions) {\n          ordersParams.leave_unattended = Boolean(\n            // this.cart.order?.leave_unattended is defined only for modify case, otherwise...\n            this.cartService.cart.order?.leave_unattended ??\n              this.orderDeliveryInstructions.leaveUnattended\n          )\n        }\n\n        return ordersParams\n      }\n\n      /**\n       * Returns the contact information for the order payload\n       *\n       * @returns {object}\n       */\n      this._getContactInfo = () => {\n        const { intent } = this.auth.getContext()\n        const contactSource = intent === SHOPPING_MODES.PICKUP ? this.contact : this.deliveryAddress\n\n        if (!contactSource) return\n\n        const { first_name, last_name, phone_number } = contactSource\n\n        /* Avoid inserting contact info if any mandatory fields are missing,\n         * because the backend won't validate contact info unless all fields\n         * are present.\n         */\n        if ([first_name, last_name, phone_number].some(k => k == null)) {\n          return\n        }\n\n        return { first_name, last_name, phone_number }\n      }\n\n      /**\n       * Performs a checkout\n       *\n       * Order of operations:\n       * - Verify payment is ready with gateway\n       * - Set last used payment for use with IC Express (mainly for Stripe)\n       * - Update server with payment\n       * - Perform checkout order\n       * - delete cartService.dateOfBirth via alcoholValidation.clearDateOfBirth()\n       * - If vantiv: Remove non saving cards\n       *\n       * @param { object } paymentObject   - The payment as acquired from the api and updated by the gateway for checkout\n       * @param { object } gatewayService  - The gateway service\n       *\n       * @returns { Promise }\n       */\n      this.performCheckout = (paymentObject, gatewayService, additionalParams = {}) => {\n        const { addressList, auth, alcoholValidation, config } = this\n        const {\n          checkout,\n          checkoutComplete,\n          onAfterCheckoutError,\n          verifyPayment,\n          customErrorHandler,\n        } = gatewayService || {}\n        const paymentDetails = paymentObject && paymentObject[paymentObject.payment_type]\n        const { cart_id, checkoutErrorCallback, postCheckoutRoute } = additionalParams\n        let showModalOnDefaultError = false\n\n        paymentObject.cart_id = cart_id\n\n        if (paymentObject.gift_cards) {\n          // Making sure that the amount is a string. During order creation, the gift cart amount has the right type\n          // but in order modification it is being set to a number\n          paymentObject.gift_cards.forEach(\n            giftCard => (giftCard.amount = giftCard.amount.toString())\n          )\n        }\n\n        return Promise.resolve()\n          .then(() => verifyPayment && verifyPayment())\n          .then(() =>\n            this.setLastUsedPaymentInstrument(paymentDetails && paymentDetails.payment_instrument)\n          )\n          .then(() => paymentObject.put())\n          .then(response => {\n            showModalOnDefaultError = true\n            const orderParams = this._getOrderParams(\n              addressList,\n              auth,\n              alcoholValidation,\n              config,\n              paymentObject\n            )\n\n            return (\n              checkout &&\n              checkout({ ...orderParams, ...additionalParams }, { response, postCheckoutRoute })\n            )\n          })\n          .then(order => {\n            alcoholValidation.clearDateOfBirth()\n            promoCodeService.clearSuccessMessage()\n            checkoutComplete && checkoutComplete()\n            checkoutAnalytics.orderComplete({ order })\n            return order\n          })\n          .then(() => cartService.resetToPreModCart())\n          .then(() => cartService.resetToPreModContext())\n          .catch(error => {\n            this.logCheckoutErrorAnalytics(error)\n            handleCheckoutError(error, customErrorHandler, showModalOnDefaultError)\n              .then(() => onAfterCheckoutError && onAfterCheckoutError())\n              .finally(() => checkoutErrorCallback && checkoutErrorCallback())\n\n            throw error\n          })\n          .finally(() => {\n            this.$rootScope.isAppLoading = false\n          })\n      }\n\n      this.logCheckoutErrorAnalytics = error => {\n        const EVENT = 'error.modal.open'\n        const payload = {\n          state: $state?.current?.name,\n          status: error?.status,\n          error: error?.data?.error,\n          message: error?.data?.message || error?.message,\n          request_id: error?.headers?.()?.['x-event-id'],\n        }\n        analytics.logSegmentEvent(EVENT, payload)\n      }\n\n      /**\n       * Returns a payload object containing the required data for a given\n       * *fulfillmentType*\n       *\n       *\n       * @param {string} fulfillmentType\n       *\n       * @returns {object} Object containing the checkout validation payload\n       */\n      this.getValidationPayload = fulfillmentType => {\n        const { store } = this.auth.user\n        const payload = {\n          timeslot: this.reservationService?.reservation?.timeslot,\n        }\n\n        if (this.cartService.getHasAlcohol() && this.config.alcoholCompliance.enabled) {\n          payload.user_birthday = dayjs(this.cartService.dateOfBirth, DATE_OF_BIRTH_FORMAT)\n            .startOf('day')\n            .toISOString()\n        }\n\n        if (fulfillmentType === FULFILLMENT_TYPES.PICKUP) {\n          const { first_name, last_name, phone_number } = this.contact\n\n          payload.store = store\n          payload.contact_info = {\n            first_name,\n            last_name,\n            phone_number,\n          }\n        } else if (fulfillmentType === FULFILLMENT_TYPES.DELIVERY) {\n          payload.delivery_address = this.deliveryAddress\n        }\n\n        payload.cart_id = this.cartService.getCartId(this.cartService.getCurrentCartType())\n\n        return payload\n      }\n\n      this.orderPaginationStack = []\n\n      /**\n       * @private Removes Vantiv cards we do not wish to save\n       *\n       * @param { Error } error                     - The error as returned by the promise chain\n       * @param { boolean } showModalOnDefaultError - true to show a modal on a default generic error\n       *\n       * @returns { Promise }\n       */\n      function handleCheckoutError(error, customErrorHandler, showModalOnDefaultError) {\n        if (typeof customErrorHandler === 'function') {\n          return customErrorHandler(error)\n        }\n\n        return defaultErrorHandler(error, showModalOnDefaultError)\n      }\n\n      function defaultErrorHandler(error, showModalOnDefaultError) {\n        const currentState = $state.current.name\n        const { error: err, message } = error?.data || {}\n\n        switch (err) {\n          case HTTP_ERRORS.ALCOHOL_FULFILLMENT_ERROR:\n            return errorModalService.openCustom(alcoholValidationErrorModal, { lang })\n          case HTTP_ERRORS.SESSION_EXPIRED_ERROR:\n          case HTTP_ERRORS.PII_UNAUTHORIZED:\n          case HTTP_ERRORS.MISSING_CART:\n            return errorModalService\n              .open(lang.values.expiredTokenErrorMessage, 'OK', null)\n              .then(() => {\n                registrationService.promptLogin(\n                  currentState,\n                  '',\n                  '',\n                  '',\n                  lang.values.loginToContinue\n                )\n              })\n          case HTTP_ERRORS.CONNECT_ERROR:\n            if (!showModalOnDefaultError) return $q.resolve()\n            return errorModalService.open(\n              lang.values.connectErrorOverrides[message] || message || error.message,\n              lang.values.ok\n            )\n          default:\n            if (!showModalOnDefaultError) return $q.resolve()\n            return errorModalService.open(message || error.message, lang.values.ok)\n        }\n      }\n    }\n  )\n","export const METRIC_OWNER = 'cart_and_checkout'\n\nexport const DATADOG_CART_ACTIONS = {\n  SIDE_CART: {\n    CHECKOUT: 'side_cart_checkout',\n  },\n}\n","import { datadogRum } from '@datadog/browser-rum'\nimport { getCurrentShoppingMode } from '@app/utils/getCurrentShoppingMode'\nimport { auth as authService, config as configService } from '@instacart/enterprise-services'\nimport { DATADOG_CART_ACTIONS, METRIC_OWNER } from './constants'\nimport { oneCartEnabled } from '../oneCart/utils'\n\nfunction actionMetaData() {\n  const config = configService.selectors.getConfig()\n  const userContext = authService.selectors.getUserContext()\n  const user = authService.selectors.getUser()\n  const mode = getCurrentShoppingMode(userContext, config)\n  const oneCart = oneCartEnabled()\n\n  return {\n    ic_user_id: user?.ic_user_id,\n    is_one_cart: oneCart,\n    owner: METRIC_OWNER,\n    shopping_mode: mode,\n    user_id: user?.id,\n  }\n}\n\nfunction sideCartCheckoutEvent() {\n  try {\n    datadogRum.addAction(DATADOG_CART_ACTIONS.SIDE_CART.CHECKOUT, { ...actionMetaData() })\n  } catch (error) {\n    // do nothing\n  }\n}\n\nexport default {\n  sideCart: {\n    checkout: sideCartCheckoutEvent,\n  },\n}\n","import { createStyles } from '@app/react/common/hooks/createStyles'\nimport { useLang } from '@app/services/config/hooks'\n\ninterface UndoProps {\n  itemName: string\n  id?: string\n  onUndo: () => void\n}\n\nconst useStyles = createStyles(theme => ({\n  button: {\n    marginLeft: 10,\n  },\n  container: {\n    alignItems: 'center',\n    display: 'flex',\n    fontSize: theme.typography.bodyMedium2.fontSize,\n  },\n}))\n\nexport default function UndoItemRemove({ itemName, onUndo, id }: UndoProps) {\n  const lang = useLang()\n  const styles = useStyles()\n  return (\n    <div css={styles.container} {...{ id }}>\n      <div>\n        {itemName} <b>{lang.undoItemRemoveToast.removed}</b>\n      </div>\n      <button className=\"button\" type=\"button\" css={styles.button} onClick={onUndo}>\n        {lang.undoItemRemoveToast.undo}\n      </button>\n    </div>\n  )\n}\n","import { PropsWithChildren, useRef } from 'react'\nimport { useOnClickOutside } from '@instacart/ids-core'\n\nexport default function OutsideClickHandler({\n  onOutsideClick,\n  children,\n}: PropsWithChildren<{ onOutsideClick: () => void }>) {\n  const ref = useRef(null)\n  useOnClickOutside(ref, onOutsideClick)\n  return <div {...{ children, ref }} />\n}\n","import angular from 'angular'\nimport { toast } from 'react-hot-toast'\nimport UndoItemRemove from '@app/react/components/undoItemRemove/UndoItemRemove'\nimport OutsideClickHandler from '@app/react/ids/enterprise/molecules/OutsideClickHandler/OutsideClickHandler'\n\nexport const undoItemRemoveId = 'undo-item-remove-container'\n\n/**\n * @typedef {Object} _UIProductItem\n * @property {number} quantity\n * @property {StoreProduct} store_product\n * @property {boolean} showDeleteConfirm\n * @property {{options}} product_config\n */\n\nexport default angular\n  .module('undoRemoveServicesModule', [])\n  .service('undoRemove', function undoRemoveService(cartService) {\n    const service = this\n\n    /** @param {_UIProductItem} item */\n    service.showToast = item => {\n      const {\n        quantity,\n        store_product: { name: itemName },\n      } = item\n      const toastId = toast(\n        // eslint-disable-next-line react/jsx-filename-extension\n        <OutsideClickHandler\n          onOutsideClick={() => {\n            clearTimeout(timerId)\n            toast.dismiss(toastId)\n          }}\n        >\n          <UndoItemRemove\n            {...{ itemName }}\n            id={undoItemRemoveId}\n            onUndo={() => {\n              clearTimeout(timerId)\n              cartService.addItem(item.store_product, quantity).then(() => toast.dismiss(toastId))\n            }}\n          />\n        </OutsideClickHandler>,\n        toastOpts\n      )\n      const timerId = setTimeout(() => {\n        toast.dismiss(toastId)\n      }, 6000)\n    }\n\n    const toastOpts = {\n      id: 'undo-product-remove',\n      duration: Infinity, // see https://github.com/timolins/react-hot-toast/issues/128 for why we manually hide toast on timeout\n      position: 'bottom-center',\n      ariaProps: {\n        /* on purpose hiding toast for screen readers because non screen reader users can delete an item by accident with a single tap,\n        but for screen reader users it is a lot harder to do it by accident because you need to focus on remove item and double tap on it */\n        'aria-hidden': true,\n      },\n    }\n  })\n","import angular from 'angular'\nimport { isEmpty } from 'lodash'\nimport { CART_TYPES } from '@app/angular/constants/cart'\nimport { HTTP_ERRORS } from '@app/angular/constants/httpErrors'\nimport { IC_PLACEMENTS } from '@app/angular/constants/express'\nimport { LOGIN_CONTEXTS } from '@app/angular/constants/loginContexts'\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\nimport { OneCartActions } from '@app/services/oneCart/types'\nimport { getStickyHeaderHeight } from '@app/utils/getStickyHeaderHeight'\nimport { eventEmitter, EVENT_TYPES } from '@app/utils/eventEmitter'\nimport template from './sideCart.html'\nimport checkoutService from '../../services/modules/checkout.service'\nimport { auth as authService } from '@instacart/enterprise-services'\nimport { isRxProduct } from '@instacart/enterprise-services/product/utils'\nimport loadAssetImage from '@app/utils/loadAssetImage'\nimport cartMetrics from '@app/services/cart/metrics'\nimport { undoItemRemoveId } from '@app/angular/services/modules/undoRemove'\n\nconst DOCUMENT_BODY_SIDECART_OPEN = 'side-cart-is-open'\n\nexport default angular\n  .module('SideCartDirectiveModule', [])\n  .directive(\n    'sideCart',\n    function (\n      $controller,\n      $document,\n      $rootScope,\n      $timeout,\n      $uibModalStack,\n      cartService,\n      checkoutService,\n      config,\n      configurableProductService,\n      eComLightService,\n      sideCartService,\n      oneCartService\n    ) {\n      return {\n        template,\n        controller: function (\n          $attrs,\n          $element,\n          $filter,\n          $rootScope,\n          $scope,\n          $state,\n          auth,\n          cartService,\n          checkoutService,\n          config,\n          eComLightService,\n          express,\n          lang,\n          loyaltyService,\n          oneCartService,\n          registrationService,\n          reactCartLoyaltyBalanceDefaultProps\n        ) {\n          $scope.inEComLightMode = eComLightService.inEComLightMode\n          $scope.config = config\n          $scope.sideCartDropdownOpen = false\n          $scope.stickyOffset = getStickyHeaderHeight($scope.inEComLightMode)\n          $scope.currencyFilter = $filter('currency')\n\n          const setTotalRewards = () => {\n            $scope.rewards = loyaltyService.getVisibleRewards(\n              cartService.cart?.cart_totals?.[cartService.getCurrentCartType()]?.reward_discounts\n            )\n          }\n          if (config.rewards.visible.length) {\n            $scope.$watch(\n              () =>\n                cartService.cart?.cart_totals?.[cartService.getCurrentCartType()]?.reward_discounts,\n              setTotalRewards\n            )\n            setTotalRewards()\n          }\n\n          $scope.auth = auth\n          $scope.loyaltyReactProps = reactCartLoyaltyBalanceDefaultProps\n\n          $scope.areAllMultiContextCartsEmpty = () => {\n            // The first key should always have items as we delete carts without items\n            const [firstKeyMultiCart] = Object.keys($scope.dataByCartType)\n            return !$scope.dataByCartType[firstKeyMultiCart]?.items?.length\n          }\n\n          $scope.loadImg = image => loadAssetImage(`${image}`)\n\n          $scope.inCatering = auth.getCurrentShoppingMode() === SHOPPING_MODES.CATERING\n\n          $scope.isCartFullyEmpty = () =>\n            $scope.useMultiContextCart\n              ? $scope.areAllMultiContextCartsEmpty()\n              : cartService.countCustomItems() === 0 && isEmpty($scope.categorizedProducts)\n\n          $scope.handleCheckoutClick = event => {\n            // fire a datadog action\n            cartMetrics.sideCart.checkout()\n\n            event.preventDefault()\n            const { checkout, newCheckoutFlow, oneCart } = config\n\n            if (oneCartService.enabled()) {\n              if (auth.user.status === 'trial') {\n                return registrationService.open(\n                  'login',\n                  null,\n                  null,\n                  null,\n                  null,\n                  null,\n                  LOGIN_CONTEXTS.REDIRECT_ONECART_CHECKOUT\n                )\n              }\n              return authService.api.auth\n                .getOneCartCheckoutRedirect()\n                .then(resp => {\n                  oneCartService.redirectToPBI(resp.location, resp.auth_token, {\n                    action: OneCartActions.CHECKOUT,\n                  })\n                })\n                .catch(resp => {\n                  if (resp && resp.error === HTTP_ERRORS.PII_UNAUTHORIZED) {\n                    // If PII has timed out\n                    registrationService.promptLogin(\n                      $state.current.name,\n                      $state.params,\n                      '',\n                      '',\n                      lang.values.loginToContinue,\n                      LOGIN_CONTEXTS.REDIRECT_ONECART_CHECKOUT\n                    )\n                  }\n                })\n            }\n\n            const cartType =\n              eComLightService.inEComLightMode || $state.params.type === CART_TYPES.CATERING\n                ? CART_TYPES.CATERING\n                : CART_TYPES.GROCERY\n\n            if (\n              !cartService.isCartBelowMin() &&\n              checkout.sidecart.redirectToCheckout &&\n              newCheckoutFlow.checkoutPage.enabled\n            ) {\n              $state.go('main.checkout.checkoutPage', { cart_type: cartType })\n              return\n            }\n\n            $state.go('main.checkout.cart', { cart_type: cartType })\n          }\n\n          $controller('SideCartController', {\n            $scope: $scope,\n            $element: $element,\n          })\n\n          $scope.isRxProduct = isRxProduct\n\n          // Adds a CSS class to the body element to prevent scrolling when the side cart is open\n          // This prevents a double scrollbar which is very ugly\n          const bodyEl = angular.element($document[0].body)\n          $scope.$watch(\n            () => $rootScope.isSideCartOpen,\n            isSideCartOpen => {\n              if (isSideCartOpen) {\n                bodyEl.addClass(DOCUMENT_BODY_SIDECART_OPEN)\n              } else {\n                // Time should match css' .side-cart.slideInRight\n                $timeout(() => bodyEl.removeClass(DOCUMENT_BODY_SIDECART_OPEN), 750)\n              }\n            }\n          )\n\n          $scope.useMultiContextCart = config.useMultiContextCart\n\n          $scope.showIcExpressSideCart = () => {\n            return express.shouldShowDynamicPlacement(IC_PLACEMENTS.SIDECART)\n          }\n\n          $scope.dismissIcExpressSideCart = () => {\n            express.acknowledgePlacement(IC_PLACEMENTS.SIDECART)\n          }\n\n          $scope.acceptIcExpressSideCart = () => {\n            sideCartService.closeSideCart()\n            $scope.dismissIcExpressSideCart()\n            $state.go('main.icExpress')\n          }\n\n          $scope.showLoyaltySideCartPlacement = () =>\n            loyaltyService.showLoyaltyPlacement() && config.loyalty.enableLoyaltyOptIn.sideCart\n\n          // NEW STUFF HERE\n          $rootScope.$on('sideCart', (_, action) => {\n            switch (action) {\n              case 'open':\n                sideCartService.openSideCart()\n                break\n              case 'close':\n                sideCartService.closeSideCart()\n                break\n              default:\n                console.warn(`The action ${action} is not supported by the sideCart`)\n            }\n          })\n\n          // Opens the sidecart automatically\n          if (\n            $state.params.open_sidecart &&\n            auth.getCurrentShoppingMode() !== SHOPPING_MODES.INSTORE_LIST\n          ) {\n            cartService.cartFetchPromise.then(() => {\n              sideCartService.openSideCart()\n            })\n          }\n\n          eventEmitter.on(EVENT_TYPES.NAV_SIDE_CART_OPEN, () => {\n            sideCartService.goToNextStep()\n          })\n        },\n        link: function (scope, element, attrs) {\n          // Handle opening / closing the side cart on various devices\n          // This is a bit of a cluster***k because we need to handle touch devices as well\n          // and allowing tapping the cart to open, without triggering the links,\n          // as well as touching outside to close it, without triggering THOSE links\n\n          let headerTitleEl\n          let contentEl\n\n          const hover = event => {\n            /**\n             * When OneCart is enabled, we control when to add the 'hover' class to the sideCart element. The presence of the class\n             * is what controls whether the side cart is visible or not. For OneCart, the side cart should open only when the users\n             * click on the cart button in the header\n             */\n            const isHoverStateControlledManually = oneCartService.enabled()\n\n            if (event && !element.hasClass('hover')) {\n              event.preventDefault() // Make sure clicks on the side-cart content don't launch\n            }\n            $document.on('click', cancelHover) // Bind event to close when clicking outside side-cart\n            if (!isHoverStateControlledManually) {\n              sideCartService.openSideCart()\n            }\n            scope.sideCartDropdownOpen = true\n            scope.$digest()\n          }\n\n          const attachHandlers = function () {\n            if (\n              !headerTitleEl &&\n              (headerTitleEl = document.querySelector('.side-cart-header .title'))\n            ) {\n              // Toggle when clicking / touching header\n              angular.element(headerTitleEl).on('click', headerClick)\n            }\n\n            if (!contentEl && (contentEl = document.querySelector('.side-cart-content'))) {\n              // Open when clicking / touching content\n              angular.element(contentEl).on('click', hover)\n            }\n\n            if (headerTitleEl && contentEl && observer) {\n              observer.disconnect()\n            }\n          }\n\n          if (MutationObserver) {\n            var observer = new MutationObserver(attachHandlers)\n            observer.observe(element[0].closest('[ui-view=\"sideCart\"]'), {\n              childList: true,\n              subtree: true,\n            })\n          }\n\n          // Call attachHandlers at least once in case MutationObserver is not present or DOM loads first\n          attachHandlers()\n\n          let clearCartModalVisible = false\n\n          scope.configurableProductService = configurableProductService\n\n          var cancelHover = function (event) {\n            const undoRemoveToast = document.getElementById(undoItemRemoveId)\n            if (undoRemoveToast && undoRemoveToast.contains(event.target)) return // Do not collapse when user is trying to re-add item that was removed by accident\n            if (clearCartModalVisible) return // Do not collapse when the clear cart modal is shown.\n            // Do not collapse when there is a modal shown (possibly a PDP modal)\n            // Without this the cart hides when clicked inside the PDP modal.\n            if (!!$uibModalStack.getTop()) return\n\n            if (!(event.target instanceof HTMLSelectElement)) {\n              // Make sure opening select lists within the side cart don't close it in IE\n              element[0].querySelector('.side-cart-content').scrollTop = 0\n              sideCartService.closeSideCart()\n              $document.off('click', cancelHover)\n              event.preventDefault() // Make sure clicks on links in the rest of the site don't launch\n              event.stopPropagation()\n            }\n            scope.sideCartDropdownOpen = false\n            scope.$digest()\n          }\n\n          element.on('click', event => {\n            event.stopPropagation()\n          })\n\n          // Toggle on mouse enter / leave\n\n          if (!oneCartService.enabled()) {\n            element.on('mouseenter', hover)\n            element.on('mouseleave', cancelHover)\n          }\n\n          var headerClick = function (event) {\n            if (element.hasClass('hover')) {\n              cancelHover(event)\n            } else {\n              hover(event)\n            }\n          }\n\n          // The below two functions are used for keyboard-only controls where the user can tab into and out of the sidecart\n\n          scope.tabEnter = function () {\n            hover()\n          }\n\n          scope.tabExit = function () {\n            if (!element[0].contains(document.activeElement)) {\n              element[0].querySelector('.side-cart-content').scrollTop = 0\n              sideCartService.closeSideCart()\n              $document.off('click', cancelHover)\n              scope.sideCartDropdownOpen = false\n            }\n          }\n\n          scope.$on('cartService', (e, action, item) => {\n            // The triggerClearModal, clearConfirm, and clearCancel actions are done to hide the side cart\n            // dropdown menu because the ui bootstrap modal focuses on the empty cart button from this menu\n            // which breaks the style of the side cart when the modal closes.\n\n            switch (action) {\n              case 'add':\n                if (!oneCartService.enabled()) {\n                  element.addClass('bump')\n                  $timeout(() => element.removeClass('bump'), 200)\n                }\n                break\n              case 'remove':\n                if (oneCartService.enabled() && cartService.getItems().length === 0) {\n                  sideCartService.closeSideCart()\n                }\n                break\n              case 'triggerClearModal':\n                clearCartModalVisible = true\n                break\n              case 'clearConfirm':\n              case 'clearCancel':\n                clearCartModalVisible = false\n                if (oneCartService.enabled()) {\n                  sideCartService.closeSideCart()\n                }\n                break\n            }\n          })\n        },\n      }\n    }\n  )\n","import angular from 'angular'\n\nexport default angular\n  .module('SideCartDirectiveAutoFocusModule', [])\n  .directive('sideCartAutoFocus', function ($rootScope, utilService) {\n    return {\n      restrict: 'A',\n      link: (scope, element, attrs) => {\n        scope.$watch(\n          () => $rootScope.isSideCartOpen,\n          (isSideCartOpen, wasSideCartOpen) => {\n            if (isSideCartOpen && !wasSideCartOpen) {\n              utilService.trapFocusOn(element[0])\n              utilService.focusSelector(`.${attrs.sideCartAutoFocus}`)\n            }\n          }\n        )\n      },\n    }\n  })\n","import angular from 'angular'\nimport SideCart from './sideCartRoutes.js'\nimport SideCartBottomButtonsComponent from './sideCartBottomButtonsComponent.js'\nimport SideCartDirective from './sideCart.js'\nimport SideCartAutoFocusDirective from './sideCartAutoFocus.js'\n\nexport default angular.module('app.component.sideCartModule', [\n  SideCartBottomButtonsComponent.name,\n  SideCartDirective.name,\n  SideCart.name,\n  SideCartAutoFocusDirective.name,\n])\n","export const SSO_FIELDS = {\n  FACEBOOK: ['code', 'state'],\n  FOODLION_IDP: ['token'],\n  GOOGLE: ['code', 'state'],\n  INSTACART_IDP: ['code', 'state'],\n  INSTACART_LOGIN: ['code', 'state'],\n  INSTACART_LINK: ['code', 'state'],\n  TWITTER: ['oauth_token', 'oauth_verifier'],\n  WEGMANS_IDP: ['code'],\n  COSTCO_IDP: ['code|jwt'],\n  APPLE: ['code', 'state'],\n  EXTERNAL_OAUTH2_IDP: ['code', 'state'],\n}\n","import { config as configService, auth as authService } from '@instacart/enterprise-services'\nimport { windowManager } from '@instacart/enterprise-services-cordova'\nimport isMobileApp from '@app/utils/isMobileApp'\nimport { SSO_PROVIDERS } from '@app/angular/constants/ssoProviders'\nimport { eventEmitter, EVENT_TYPES } from '@app/utils/eventEmitter'\n\nexport default function handleExternalAuth(provider: SSO_PROVIDERS) {\n  return authService.promiseActions\n    .getExternalAuthUrl({ identifier_polytype: provider })\n    .then(resp => {\n      const config = configService.selectors.getConfig()\n\n      // This event is listened to by the AngularJS Redirect service\n      eventEmitter.emit(EVENT_TYPES.SET_REGISTRATION_URL)\n\n      // SSO providers that disallow SSO in the InAppBrowser\n      const { disallowedInAppSSOProviders } = config.socialSignOn\n\n      if (isMobileApp() && disallowedInAppSSOProviders.indexOf(provider) === -1) {\n        return windowManager.openAuthUrl(resp.identifier_url, {\n          closeOnHome: true,\n          shouldResolve: true,\n        })\n      }\n      window.open(resp.identifier_url, isMobileApp() ? '_system' : '_self')\n      return new Promise(() => {})\n    })\n}\n","import { registerPlugin } from '@capacitor/core'\n\ninterface ApplePlugin {\n  login(): Promise<void>\n}\n\nconst Apple = registerPlugin<ApplePlugin>('ApplePlugin')\n\nexport default Apple\n","import _ from 'lodash'\nimport { auth as authService } from '@instacart/enterprise-services'\nimport angular from 'angular'\nimport { FacebookLogin } from '@capacitor-community/facebook-login'\nimport { AUTH_ACTIONS } from '@app/angular/constants/authActions'\nimport { SSO_FIELDS } from '@app/angular/constants/ssoFields'\nimport { SSO_PROVIDERS } from '@app/angular/constants/ssoProviders'\nimport { USER_ACTIONS } from '@app/angular/constants/events'\nimport { LOGIN_CONTEXTS } from '@app/angular/constants/loginContexts'\nimport { ACTIONS } from '@app/angular/constants/recaptcha'\nimport handleExternalAuth from '@app/services/externalAuth/handleExternalAuth'\nimport { OneCartActions } from '@app/services/oneCart/types'\nimport isCapacitor from '@app/utils/isCapacitor'\nimport ApplePlugin from '@app/react/mobile/plugins/applePlugin'\nimport rxRedirectErrorModal from '@app/angular/components/rxRedirectError/rxRedirectErrorModal.html'\nimport { USER_STATUSES } from '@app/angular/constants/user'\nimport SocialSignOnLinkModalTemplate from './socialSignOnLinkModal.html'\n\nexport default angular\n  .module('SocialSignOnComponentModule', [])\n  .config($stateProvider => {\n    $stateProvider.state('socialSignOn', {\n      url:\n        '/social-redirect/:provider?access_token&code&jwt&state&oauth_token&oauth_verifier&id_token&token&error&error_description&rx_session&is_rx_session_valid',\n      onEnter(\n        $location,\n        $state,\n        $stateParams,\n        $uibModal,\n        analytics,\n        auth,\n        config,\n        errorModalService,\n        importIcAccountService,\n        rxUpSellService,\n        lang,\n        mobileService,\n        socialSignOnService\n      ) {\n        const {\n          provider = '',\n          code,\n          rx_session,\n          is_rx_session_valid,\n          error: errorCode,\n          error_description: errorDescription,\n        } = $stateParams\n\n        // Redirect to home if user is already logged in\n        if (auth.user?.status !== USER_STATUSES.TRIAL) {\n          return $state.go('main.home')\n        }\n\n        const ssoKeys = SSO_FIELDS[provider.toUpperCase()]\n\n        const redirectResponseUrl = mobileService.isMobileApp()\n          ? config.env.webUrl + $location.url()\n          : $location.$$absUrl\n\n        if (rx_session || is_rx_session_valid) {\n          analytics.logSegmentEvent('rx.sso_session', {\n            rx_session,\n            is_rx_session_valid,\n          })\n        }\n\n        if (is_rx_session_valid === 'false') {\n          analytics.logSegmentEvent('rx.sso_session_invalid', {\n            success: false,\n            rx_session,\n          })\n          return $uibModal.open({\n            template: rxRedirectErrorModal,\n            controller: [\n              '$scope',\n              '$state',\n              ($scope, $state) => {\n                $scope.continue = () => {\n                  analytics.logSegmentEvent('rx.upsell_error_continue', {})\n                  $state.go('main.home')\n                }\n              },\n            ],\n          })\n        }\n\n        if (is_rx_session_valid === 'true') {\n          // User enters from RX flow should trigger rxUpSell dialog\n          rxUpSellService.fromRxSSO(!!rx_session)\n        }\n\n        // If IC account import is enabled, do that instead of SSO flow\n        if (config.icImportAccount && provider === SSO_PROVIDERS.INSTACART_LINK) {\n          return importIcAccountService.handleSocialSignOnSuccess({\n            code,\n            redirectResponse: redirectResponseUrl,\n          })\n        }\n\n        // Check that the Redirect URI has the expected parameters of a successful token, otherwise throw error modal\n        if (ssoKeys && ssoKeys.every(key => key.split('|').some(k => !!$stateParams[k]))) {\n          return socialSignOnService.handleSocialSignOnSuccess({\n            identifier_polytype: provider,\n            identifier_data: {\n              redirect_response: redirectResponseUrl,\n            },\n          })\n        }\n\n        const authService = auth.getAuthService()\n\n        if (authService && authService.handleError) {\n          return authService.handleError({ errorCode, errorDescription })\n        }\n\n        // Generic error handling\n        const errorMessage =\n          (errorCode && lang.values.ssoErrors[errorCode]) || lang.values.defaultErrorMessage\n\n        return errorModalService.open(errorMessage, lang.values.backToHome).then(() => {\n          $state.go('main.home')\n        })\n      },\n    })\n  })\n\n  // Service to power the social sign on linking flow.\n\n  .service(\n    'socialSignOnService',\n    function socialSignOnService(\n      $injector,\n      $q,\n      $rootScope,\n      $state,\n      $uibModal,\n      $window,\n      Restangular,\n      anonymousIdService,\n      auth,\n      checkoutService,\n      config,\n      errorModalService,\n      lang,\n      localStorageService,\n      mobileNativeHrefService,\n      mobileService,\n      oneCartService,\n      redirectService,\n      registrationService,\n      userAnalytics\n    ) {\n      const service = this\n\n      const genericSdkLogin = (loginFn, provider, errorKey) => {\n        return $q((resolve, reject) => {\n          loginFn(\n            config.socialSignOn.mobileSdkParams[provider],\n            data => {\n              resolve(\n                service.handleSocialSignOnSuccess({\n                  identifier_polytype: provider,\n                  includes_access_token: true,\n                  identifier_data: data,\n                })\n              )\n            },\n            errorKey ? msg => reject(msg?.[errorKey]) : reject\n          )\n        })\n      }\n\n      const facebookSdkLogin = () => {\n        if (isCapacitor()) {\n          // Use native SDK plugin for FB login on Capacitor apps\n          return FacebookLogin.login({\n            permissions: config.socialSignOn.mobileSdkParams[SSO_PROVIDERS.FACEBOOK],\n          })\n            .then(loginResult => {\n              const accessToken =\n                loginResult && loginResult.accessToken && loginResult.accessToken.token\n              if (accessToken) {\n                // Format payload that buffet endpoint expects\n                const formattedIdentifierData = Object.assign(loginResult, {\n                  authResponse: { accessToken },\n                })\n                service.handleSocialSignOnSuccess({\n                  identifier_polytype: SSO_PROVIDERS.FACEBOOK,\n                  includes_access_token: true,\n                  identifier_data: formattedIdentifierData,\n                })\n              }\n            })\n            .catch(error => error)\n        }\n        return genericSdkLogin(\n          window.facebookConnectPlugin.login,\n          SSO_PROVIDERS.FACEBOOK,\n          'errorMessage'\n        )\n      }\n\n      const googleSdkLogin = () =>\n        genericSdkLogin(window.plugins.googleplus.login, SSO_PROVIDERS.GOOGLE)\n\n      const appleSdkLogin = () => {\n        if (isCapacitor()) {\n          // Use native SDK plugin for Apple login on Capacitor apps\n          return ApplePlugin.login().then(loginResult => {\n            service.handleSocialSignOnSuccess({\n              identifier_polytype: SSO_PROVIDERS.APPLE,\n              includes_access_token: true,\n              identifier_data: loginResult?.response,\n            })\n          })\n          // No .catch() as we are returning the promise and there is other logic to catch the error\n          // and display the error message in the login UI in sharedLogin.js\n        }\n        return genericSdkLogin(\n          window.cordova.plugins.SignInWithApple.signin,\n          SSO_PROVIDERS.APPLE,\n          'localizedDescription'\n        )\n      }\n\n      service.shouldUseNativeSdk = provider => {\n        if (!(mobileService.isMobileApp() && config.socialSignOn.mobileSdkParams[provider])) {\n          return false\n        }\n        switch (provider) {\n          case SSO_PROVIDERS.FACEBOOK:\n            return isCapacitor() ? !!FacebookLogin : !!window.facebookConnectPlugin\n          case SSO_PROVIDERS.GOOGLE:\n            return !!window.plugins.googleplus\n          case SSO_PROVIDERS.APPLE:\n            return isCapacitor() ? !!ApplePlugin : !!window.cordova.plugins.SignInWithApple\n          default:\n            return false\n        }\n      }\n\n      service.handleSocialSignOn = provider => {\n        if (service.shouldUseNativeSdk(provider)) {\n          switch (provider) {\n            case SSO_PROVIDERS.FACEBOOK:\n              return facebookSdkLogin()\n            case SSO_PROVIDERS.GOOGLE:\n              return googleSdkLogin()\n            case SSO_PROVIDERS.APPLE:\n              return appleSdkLogin()\n          }\n        } else {\n          return handleExternalAuth(provider)\n        }\n      }\n\n      service.handleSocialSignOnSuccess = payload => {\n        userAnalytics.logUserLogin()\n\n        // POST to `auth/external` will let us know if this social account needs to be registered,\n        // exists but needs link, or already linked and ready for login\n        return authService.promiseActions\n          .loginExternal(payload)\n          .then(socialSignOnData => {\n            if (socialSignOnData.action && service.socialSignOnFlows?.[socialSignOnData.action]) {\n              return service.socialSignOnFlows[socialSignOnData.action](socialSignOnData)\n            }\n          })\n          .catch(socialSignOnData => {\n            const authService = auth.getAuthService()\n            if (authService && authService.handleError) {\n              return authService.handleError({ errorDescription: socialSignOnData?.message })\n            }\n\n            // Generic error handling\n            // TODO: Handle specific error number if it's an issue with the oauth token not being in the session.\n            // Please note, if a user closes the social sign-on account linking modal, socialSignOnData will be\n            // undefined\n            errorModalService\n              .open(\n                socialSignOnData?.message || lang.values.defaultErrorMessage,\n                lang.values.backToHome\n              )\n              .finally(() => $state.go('main.home'))\n            return Promise.reject()\n          })\n          .then(() => {\n            const loginContext = localStorageService.deprecatedGet('loginContext', '')\n            return redirectService.loadRedirectUrl({ state: 'main.home' }).then(() => {\n              $rootScope.$broadcast('auth', USER_ACTIONS.POST_USER_EXTERNAL_LOGIN, loginContext)\n              // redirectToPBICheckout relies on the checkout form existing (it cannot work on the social sign-on page)\n              if (loginContext === LOGIN_CONTEXTS.REDIRECT_ONECART_CHECKOUT) {\n                $rootScope.isAppLoading = true\n                authService.api.auth.getOneCartCheckoutRedirect().then(resp => {\n                  oneCartService.redirectToPBI(resp.location, resp.auth_token, {\n                    action: OneCartActions.CHECKOUT,\n                  })\n                })\n              }\n              if (loginContext === LOGIN_CONTEXTS.REDIRECT_ONECART_ORDER_STATUS) {\n                $rootScope.isAppLoading = true\n                const icOrderId = localStorage.getItem('icOrderId')\n                const icOrderQuery = localStorageService.deprecatedGet('icOrderQuery', {})\n                authService.api.auth.getOneCartOrderRedirect(icOrderId, icOrderQuery).then(resp => {\n                  oneCartService.redirectToPBI(resp.location, resp.auth_token, {\n                    action: OneCartActions.ORDER_STATUS,\n                    orderId: icOrderId,\n                  })\n                })\n              }\n              localStorageService.deprecatedRemove('loginContext')\n              localStorage.removeItem('icOrderId')\n              localStorageService.deprecatedRemove('icOrderQuery')\n            })\n          })\n      }\n\n      service.socialSignOnFlows = {\n        registration: socialSignOnData =>\n          // Use normal registration flow, but pass socialSignOnData object, which contains `user.social_accounts` for auto-linking\n          registrationService.open('register', true, null, null, socialSignOnData),\n        link: socialSignOnData => {\n          return $uibModal.open({\n            template: SocialSignOnLinkModalTemplate,\n            controller: SocialSignOnLinkModalController,\n            controllerAs: '$ctrl',\n            keyboard: true,\n            backdrop: 'static',\n            resolve: {\n              socialSignOnData: () => socialSignOnData,\n            },\n          }).result\n        },\n        login: auth.handlePostLogin,\n        loyalty: () => registrationService.open(AUTH_ACTIONS.LOYALTY),\n      }\n      // Used in register flow to switch over to the link flow\n      service.goToSocialLinkFlow = socialSignOnData => {\n        // Set the social account's status to true before proceeding to the link flow\n        _.each(socialSignOnData.user.social_accounts, account => {\n          account.status = true\n        })\n        // return promise when link dialog close (resolve) or dismiss (reject)\n        return service.socialSignOnFlows.link(socialSignOnData)\n      }\n    }\n  )\n\nfunction SocialSignOnLinkModalController(\n  $scope,\n  $state,\n  $uibModalInstance,\n  auth,\n  config,\n  mobileService,\n  recaptchaService,\n  registrationService,\n  socialSignOnData,\n  userAnalytics\n) {\n  this.config = config\n  this.isMobile = mobileService.isMobile\n  this.socialSignOnData = socialSignOnData\n\n  this.linkFormModel = {\n    email: socialSignOnData.social_email,\n  }\n\n  const socialAccountProviderToLink = socialSignOnData.identifier_polytype\n  const socialAccountToLink = _.find(socialSignOnData.user.social_accounts, {\n    provider: socialAccountProviderToLink,\n  })\n  this.linkFormModel.socialAccount = socialAccountToLink\n  this.linkFormModel.socialAccount.status = true\n\n  this.recaptcha = {\n    enabled: recaptchaService.isEnabled(),\n    token: null,\n    action: ACTIONS.LOGIN,\n    onSuccess: recaptchaToken => {\n      $scope.$apply(() => {\n        this.recaptcha.token = recaptchaToken\n      })\n    },\n    onExpired: () => {\n      $scope.$apply(() => {\n        this.recaptcha.token = null\n      })\n    },\n  }\n\n  this.forgotPassword = () => {\n    registrationService.open('forgot')\n  }\n\n  // Social sign on account linking after `auth/social` has determined social account already exists but has not been linked\n  this.link = () => {\n    delete this.linkFormModel.errorMessage\n    this.linking = true\n\n    auth\n      .login(\n        this.linkFormModel.email,\n        this.linkFormModel.password,\n        this.linkFormModel.socialAccount,\n        LOGIN_CONTEXTS.SOCIAL_SIGN_ON_LINK_MODAL,\n        this.recaptcha.enabled\n          ? { token: this.recaptcha.token, siteKey: config.googleRecaptcha?.siteKey }\n          : null\n      )\n      .then(() => {\n        userAnalytics.logUserLoginAttempt({ success: true })\n        $uibModalInstance.close({ linked: true })\n      })\n      .catch(response => {\n        userAnalytics.logUserLoginAttempt({ success: false })\n        this.linkFormModel.errorMessage = (response.data && response.data.message) || response\n        this.recaptcha.token = null\n        recaptchaService.resetLastCheckbox()\n      })\n      .finally(() => {\n        this.linking = false\n      })\n  }\n}\n","import angular from 'angular'\nimport SocialSignOn from './socialSignOn.js'\n\nexport default angular.module('app.component.socialSignOnModule', [SocialSignOn.name])\n","import angular from 'angular'\nimport { SUBSCRIPTION_STEPS } from '@instacart/enterprise-subscription-checkout'\nimport debounce from 'lodash/debounce'\n\n/**\n * The outer most scope here is the below SubscriptionCheckout controller\n * The VantivIntegrationController inherits from that adding payment methods to the $scope\n * You may need to look in both controllers to find methods!\n */\nconst template = `\n    <div ng-controller=\"VantivIntegrationController\">\n      <react-subscription-checkout\n        cards=\"paymentInstruments\"\n        is-add-new-card=\"showAddInstrument\"\n        is-iframe-loading=\"showAddInstrumentLoader\"\n        is-purchasable=\"isPurchasable\"\n        asset-loading-function=\"(assetLoadingFunction)\"\n        on-state-change=\"(onStateChange)\"\n        route=\"$state.current.name.split('.').pop()\"\n\n        on-buy-subscription-clicked=\"(onBuySubscriptionClicked)\"\n        on-gift-subscription-clicked=\"(onGiftSubscriptionClicked)\"\n        on-selection-complete=\"(onSelectionComplete)\"\n        on-add-new-card=\"(addPaymentInstrument)\"\n        on-continue-clicked=\"(onContinueClicked)\"\n        on-delete-card=\"(reactMethods.onDeleteCard)\"\n        on-payment-iframe-rendered=\"(reactMethods.onPaymentIframeRendered)\"\n        on-purchase-complete=\"(onPurchaseComplete)\"\n        on-select-card=\"(reactMethods.onSelectCard)\"\n        on-update-card=\"(reactMethods.onUpdateCard)\"\n        selected-card-ext-id=\"reactMethods.getSelectedCard()\"\n        show-save-card-toggle=\"true\"\n      ></react-subscription-checkout>\n    </div>\n  `\n\n// Function to determine whether to allow the subscription routes to be entered\nconst canAccess = [\n  '$state',\n  '$timeout',\n  'configConstants',\n  function ($state, $timeout, configConstants) {\n    if (!configConstants.subscriptions || !configConstants.subscriptions.enabled) {\n      $timeout(() => {\n        $state.go('main.404')\n      }, 0)\n    }\n  },\n]\n\nconst controller = [\n  '$scope',\n  '$state',\n  'auth',\n  'analytics',\n  'cartService',\n  'utilService',\n  function ($scope, $state, auth, analytics, cartService, utilService) {\n    // This will be populated with other methods from the payment controller\n    $scope.reactMethods = {}\n\n    $scope.$state = $state\n    // Add analytics tracking\n    $scope.onBuySubscriptionClicked = () => {\n      // TODO: remove this event hook once analytics is ported over to react\n      analytics.logSegmentEvent('subscription.subscribe_self_click', {\n        success: true,\n      })\n    }\n    $scope.onGiftSubscriptionClicked = () => {\n      // TODO: remove this event hook once analytics is ported over to react\n      analytics.logSegmentEvent('subscription.subscribe_gift_click', {\n        success: true,\n      })\n    }\n    $scope.onSelectionComplete = ({ selectedSubscription }) => {\n      // TODO: remove this event hook once analytics is ported over to react\n      analytics.logSegmentEvent('subscription.select_subscription_type', {\n        subscription_id: selectedSubscription.id,\n        subscription_name: selectedSubscription.name,\n      })\n    }\n\n    $scope.isPurchasable = !auth.user.subscription\n    $scope.onContinueClicked = () => $state.go('main.home')\n    $scope.assetLoadingFunction = utilService.loadAssetImage\n    $scope.onPurchaseComplete = ({ selectedSubscription, path }) => {\n      // TODO: remove this event hook once analytics is ported over to react\n      analytics.logSegmentEvent('subscription.purchase_subscription', {\n        subscription_id: selectedSubscription.id,\n        subscription_name: selectedSubscription.name,\n        gift: path === 'gifting',\n        path: 'dedicated',\n        success: true,\n      })\n      cartService.removeSubscriptions()\n      $scope.reactMethods.onPurchaseComplete() // Provided by the payment controller\n      // Need to fetch user that will now include the subscription just purchased\n      auth.fetch()\n    }\n\n    // TODO \"onStateChange\" is being called multiple times for each route change.\n    // TODO This is caused by useEffect in the React component. The proper fix requires a complete\n    // TODO rethink of how to work with Angular JS routes with React.\n    $scope.onStateChange = debounce(\n      params => {\n        if ($state.current.name.split('.').pop() !== params.currentRoute) {\n          $state.go(`main.subscriptions.${params.currentRoute}`, {\n            path: params.currentPath,\n          })\n        }\n      },\n      100,\n      { leading: true }\n    )\n  },\n]\n\nexport default angular.module('subscriptionCheckoutRoutesServiceModule', []).config([\n  '$stateProvider',\n  'langProvider',\n  function ($stateProvider, langProvider) {\n    $stateProvider.state('main.subscriptions', {\n      url: '/subscriptions',\n      resolve: {\n        redirect: [\n          '$timeout',\n          '$state',\n          ($timeout, $state) => {\n            $timeout(() => {\n              if ($state.current.name === 'main.subscriptions') {\n                $state.go(`main.subscriptions.${SUBSCRIPTION_STEPS[0].key}`)\n              }\n            })\n          },\n        ],\n        title: [\n          'titleService',\n          titleService => titleService.setTitle(langProvider.values.subscriptions),\n        ],\n        canAccess,\n      },\n      views: {\n        'content@': {\n          controller,\n          template,\n        },\n      },\n    })\n    // This only exists as  the previous state won't match subscriptions with a / at the end\n    $stateProvider.state('main.subscriptionsSlash', {\n      url: '/subscriptions/',\n      resolve: {\n        redirect: [\n          '$timeout',\n          '$state',\n          ($timeout, $state) => {\n            $timeout(() => {\n              if ($state.current.name === 'main.subscriptionsSlash') {\n                $state.go(`main.subscriptions.${SUBSCRIPTION_STEPS[0].key}`)\n              }\n            })\n          },\n        ],\n      },\n    })\n\n    // eslint-disable-next-line array-callback-return\n    SUBSCRIPTION_STEPS.map(step => {\n      $stateProvider.state(`main.subscriptions.${step.key}`, {\n        url: step.urlName,\n        data: step.data,\n      })\n    })\n  },\n])\n","import angular from 'angular'\nimport SubscriptionCheckoutRoutes from './subscriptionCheckoutRoutes.js'\n\nexport default angular.module('app.component.subscriptionCheckout', [\n  SubscriptionCheckoutRoutes.name,\n])\n","import angular from 'angular'\nimport template from './profileMenu.html'\n\nexport default angular.module('unataProfileMenuModule', []).component('unataProfileMenu', {\n  bindings: {\n    showLogout: '<',\n    showIcons: '<',\n  },\n  controller(express, config) {\n    this.express = express\n    this.config = config\n  },\n  template,\n})\n","import angular from 'angular'\nimport ProfileMenu from '../nav/registrationDropdown/profileMenu'\n\nexport default angular\n  .module('WordpressMobileSideNavItemsComponentModule', [ProfileMenu.name])\n  .component('wordpressMobileSideNavItems', {\n    /**\n     * @param $scope\n     * @param auth\n     * @param {ClientConfig} config\n     * @param mobileNavService\n     * @param wordpressRestApiService\n     */\n    controller($scope, auth, config, mobileNavService, wordpressRestApiService) {\n      this.auth = auth\n      $scope.showProfileMenuIcons = config.sideNavProfileMenuShowIcons\n      if (config.dotComModule.mobileNav) {\n        wordpressRestApiService.getWordpressMenuItems().then(items => {\n          this.mobileSideNavItems = items\n        })\n      }\n      this.getMenuByAPI = api => {\n        let targetMenu\n        config.dotComModule.mobileNav.wordpressMenuItems.forEach(element => {\n          if (element.api === api) {\n            targetMenu = element\n          }\n        })\n        return targetMenu\n      }\n      this.appendProfileAfter = api => {\n        const targetMenu = this.getMenuByAPI(api)\n        return targetMenu ? targetMenu.appendProfileAfter : false\n      }\n      this.hideMobileSideNav = () => {\n        mobileNavService.hideSlideOutMenu()\n      }\n      /**\n       Urls that we get from wordpress service are always absolute because they may be reused for CMS site navigation.\n       Turn internal urls to relative to avoid leaving SPA on web and unresponsive menu for same page items on mobile app. External urls stay untouched.\n\n       Examples:\n       GIVEN config.env.webUrl = 'https://shop-uat.wegmans.com'\n         WHEN url = 'https://shop-uat.wegmans.com' THEN internalUrlToRelative(url) === '/'\n         WHEN url = 'https://shop-uat.wegmans.com/blah' THEN internalUrlToRelative(url) === '/blah'\n         WHEN url = 'https://wegmans.com/blah' THEN internalUrlToRelative(url) === 'https://wegmans.com/blah'\n       */\n      this.internalUrlToRelative = url => {\n        const domainWithProtocol = config.env.webUrl.replace(/\\/$/, '')\n        if (url.startsWith(domainWithProtocol)) {\n          return url === domainWithProtocol ? '/' : url.replace(domainWithProtocol, '')\n        }\n        return url\n      }\n    },\n    template: `<div class=\"wordpress-mobile-side-nav-items-container\">\n                <ul ng-repeat=\"menu in $ctrl.mobileSideNavItems\" class=\"{{::menu.name}}\">\n                  <li ng-repeat=\"items in menu.items\">\n                    <a ng-if=\"::!items.state\" href=\"{{::$ctrl.internalUrlToRelative(items.url)}}\" ng-click=\"$ctrl.hideMobileSideNav()\" data-test=\"side-nav-item-{{items.post_name}}\">{{::items.title}}</a>\n                  </li>\n                  <li class=\"profile-menu-wrapper\" ng-if=\"$ctrl.auth.user.status !== 'trial' && $ctrl.appendProfileAfter(menu.slug)\">\n                    <unata-profile-menu ng-class=\"{'profile-menu-with-icons': showProfileMenuIcons}\" show-icons=\"showProfileMenuIcons\" show-logout=\"false\"></unata-profile-menu>\n                  </li>\n                </ul>\n              </div>`,\n  })\n","import angular from 'angular'\nimport WordpressMobileSideNavItems from './wordpressMobileSideNavItems.js'\n\nexport default angular.module('app.component.wordpressMobileSideNavItemsModule', [\n  WordpressMobileSideNavItems.name,\n])\n","import angular from 'angular'\nimport ErrorPages from './errorPages'\nimport Account from './account'\nimport AddressValidation from './addressValidation'\nimport Alert from './alert'\nimport Carousel from './carousel'\nimport ChatIntegration from './chat'\nimport Checkout from './checkout'\nimport CheckoutSteps from './checkoutSteps'\nimport Collections from './collections'\nimport CompareCart from './compareCart'\nimport ExternalPage from './externalPage'\nimport FlyerPreview from './flyerPreview'\nimport Footer from './footer'\nimport Home from './home'\nimport IcExpress from './icExpress'\nimport IcFulfillmentBanner from './icFulfillmentBanner'\nimport ImportICAccount from './importIcAccount'\nimport InstacartCustomerLink from './instacartCustomerLink'\nimport InstoreList from './inStoreList'\nimport LoyaltyOnboarding from './loyaltyOnboarding'\nimport Maintenance from './maintenance'\nimport ModifyOrderBanner from './modifyOrderBanner'\nimport MobileOnboarding from './mobileOnboarding'\nimport Nav from './nav'\nimport NavLogoutButton from './nav-logout-button'\nimport Offers from './offers'\nimport Offline from './offline'\nimport OrderAddOn from './orderAddOn'\nimport Payments from './payments'\nimport ProductDetails from './productDetails'\nimport Recipes from './recipes'\nimport Registration from './registration'\nimport Reservation from './reservation'\nimport Search from './search'\nimport Shared from './shared'\nimport Shop from './shop'\nimport MobileAppInfo from './mobileAppInfo'\nimport ShoppingSelector from './shoppingSelector'\nimport SideCart from './sideCart'\nimport SocialSignOn from './socialSignOn'\nimport SubscriptionCheckout from './subscriptionCheckout'\nimport WordpressMobileSideNavItems from './wordpressMobileSideNavItems'\n\nexport default angular.module('app.components', [\n  ErrorPages.name,\n  Account.name,\n  AddressValidation.name,\n  Alert.name,\n  Carousel.name,\n  ChatIntegration.name,\n  Checkout.name,\n  CheckoutSteps.name,\n  Collections.name,\n  CompareCart.name,\n  ExternalPage.name,\n  FlyerPreview.name,\n  Footer.name,\n  Home.name,\n  MobileAppInfo.name,\n  IcExpress.name,\n  IcFulfillmentBanner.name,\n  ImportICAccount.name,\n  InstacartCustomerLink.name,\n  InstoreList.name,\n  LoyaltyOnboarding.name,\n  Maintenance.name,\n  ModifyOrderBanner.name,\n  MobileOnboarding.name,\n  Nav.name,\n  NavLogoutButton.name,\n  Offers.name,\n  Offline.name,\n  OrderAddOn.name,\n  Payments.name,\n  ProductDetails.name,\n  Recipes.name,\n  Registration.name,\n  Reservation.name,\n  Search.name,\n  Shared.name,\n  Shop.name,\n  ShoppingSelector.name,\n  SideCart.name,\n  SocialSignOn.name,\n  SubscriptionCheckout.name,\n  WordpressMobileSideNavItems.name,\n])\n","import angular from 'angular'\n\n// Keep constants alpha\nconst CART = 'cart'\nconst CART_PAYMENT = 'cart/payment'\nconst GEOCODE_URL = 'https://api.mapbox.com/geocoding/v5/mapbox.places'\nconst PROMO_CODES = 'promo_codes'\nconst TIME_SLOTS = 'timeslots'\n\nexport default angular\n  .module('ApiServicesModule', [])\n  .service('api', function api($http, Restangular, config) {\n    const service = this\n\n    Object.assign(service, {\n      getCartPayment: params => Restangular.one(CART_PAYMENT).get(params),\n      getCartPromoCodes: promo => Restangular.one(CART).customPOST(promo, PROMO_CODES),\n      getTimeSlotsList: opts => Restangular.all(TIME_SLOTS).getList(opts),\n    })\n\n    service.getGeocodeAddress = address => {\n      const getGeocodeURL = address => {\n        return `${GEOCODE_URL}/${address}.json?country=us,ca&access_token=${config.mapboxglAccessToken}`\n      }\n\n      return $http.get(getGeocodeURL(address))\n    }\n  })\n","import _ from 'lodash'\nimport angular from 'angular'\nimport { captureException } from '@sentry/browser'\nimport { user } from '@instacart/enterprise-services'\nimport { USER_ACTIONS, CONTEXT_ACTIONS } from '@app/angular/constants/events'\n\nexport default angular\n  .module('AddressListServicesModule', [])\n  .service(\n    'addressList',\n    function addressList(\n      $rootScope,\n      Restangular,\n      addressValidationService,\n      config,\n      localStorageService,\n      ngPromise,\n      profileService\n    ) {\n      const service = this\n\n      service.addressItems = []\n      service.icAddressItems = []\n      const ADDRESSES_ENDPOINT = 'user_addresses'\n      const validateAddressKeyPrefix = 'validated-address-id-'\n      const validateAddressExpiry = 1000 * 30 * 60 // 30 minutes\n      const getAddresses = ngPromise.wrapper(user.api.userAddresses.getAll)\n      const updateAddress = ngPromise.wrapper(user.api.userAddresses.update)\n      const createAddress = ngPromise.wrapper(user.api.userAddresses.create)\n      const removeAddress = ngPromise.wrapper(user.api.userAddresses.remove)\n      const fetchAddressActions = [\n        USER_ACTIONS.USER_UPDATED,\n        USER_ACTIONS.USER_LOGGED_IN,\n        CONTEXT_ACTIONS.CONTEXT_UPDATED,\n      ]\n\n      service.fetchAddresses = () => {\n        // piggy-back on this call to also fetch any addresses from the user's Instacart profile\n        service.fetchInstacartAddresses()\n\n        service.fetchAddressPromise = getAddresses().then(response => {\n          return profileService\n            .fetchProfile()\n            .then(profile => {\n              service.addressItems = response.items.map(address => {\n                address.phone_number = address.phone_number || profile[profile.primary_number_key]\n                return address\n              })\n              return service.addressItems\n            })\n            .catch(e => {\n              captureException(e)\n            })\n        })\n\n        return service.fetchAddressPromise\n      }\n\n      /**\n       * Fetch any addresses in user's Instacart profile. If a user does not have an\n       * Instacart profile this will return an empty array\n       */\n      service.fetchInstacartAddresses = () => {\n        // This feature is disabled\n        if (!config.icImportAddresses) {\n          return Promise.resolve([])\n        }\n\n        service.fetchInstacartAddressesPromise = Restangular.all(`${ADDRESSES_ENDPOINT}/instacart`)\n          .getList()\n          .then(response => {\n            service.icAddressItems = response.plain()\n            return service.icAddressItems\n          })\n          .catch(() => []) // Ignore any errors\n        return service.fetchInstacartAddressesPromise\n      }\n\n      /**\n       * Imports a list of addresses in user's delivery address book\n       */\n      service.batchImportInstacartAddresses = addresses =>\n        Restangular.all(`${ADDRESSES_ENDPOINT}/batch`)\n          .customPOST(addresses)\n          .then(addresses => {\n            const newAddresses = addresses.plain()\n            if (newAddresses) {\n              // save addresses fetched from Instacart in user's delivery address book\n              service.addressItems = [...service.addressItems, ...newAddresses.items]\n            }\n            return addresses\n          })\n\n      service.getAddresses = () => {\n        return service.fetchAddressPromise.then(() => {\n          return service.addressItems\n        })\n      }\n\n      service.getAddressFromId = addressId => _.find(service.addressItems, o => o.id === addressId)\n\n      const updateItemInList = address => {\n        const updatedAddress = _.omit(address, ['session_token'])\n        const currentAddress = service.getAddressFromId(address.id)\n        if (currentAddress) {\n          angular.extend(currentAddress, updatedAddress)\n        } else {\n          service.addressItems.unshift(updatedAddress)\n        }\n        return address\n      }\n\n      service.validateAddress = address => {\n        return addressValidationService.validateAddress(address).then(response => {\n          const recommendedAddresses = addressValidationService.createRecommendationsList(\n            response.suggestions,\n            address\n          )\n\n          if ((response.is_valid && recommendedAddresses.length > 0) || !response.is_valid) {\n            return addressValidationService\n              .openModal({\n                original: address,\n                recommended: recommendedAddresses,\n                isValid: response.is_valid,\n              })\n              .then(modalResult => {\n                return angular.extend(address, modalResult.delivery_address)\n              })\n          }\n          // address is valid with no recommendation, update user\n          return address\n        })\n      }\n\n      service.validateAddressAndSaveIfChanged = address => {\n        const initialAddress = angular.copy(address)\n        return service.validateAddress(address).then(address => {\n          if (addressValidationService.areAddressesSame(initialAddress, address)) {\n            return address\n          }\n          return service.saveAddress(address)\n        })\n      }\n\n      service.saveAddress = address => {\n        if (address.id) {\n          return updateAddress(address.id, address).then(response => {\n            // If addresses are sourced from IC, they are immutable.\n            // Updates will always result in a new ID.\n            // Remove the old one.\n            if (response.id !== address.id) {\n              service.addressItems = service.addressItems.filter(addr => addr.id !== address.id)\n            }\n            return updateItemInList(response)\n          })\n        }\n        return createAddress(address).then(addressResp => {\n          service.addressItems.unshift(addressResp)\n          return addressResp\n        })\n      }\n\n      service.deleteAddress = addressId => {\n        return removeAddress(addressId).then(response => {\n          const index = _.findIndex(service.addressItems, o => o.id === addressId)\n          if (index > -1) {\n            service.addressItems.splice(index, 1)\n          }\n          return response\n        })\n      }\n\n      service.isDeliveryAddressComplete = address => {\n        return (\n          address.first_name &&\n          address.last_name &&\n          address.address1 &&\n          address.city &&\n          address.province &&\n          address.postal_code &&\n          (address.phone_number || !config.collectPhoneNumbersDuringRegistration)\n        )\n      }\n\n      service.markAddressValidated = addressId => {\n        localStorageService.deprecatedSet(\n          `${validateAddressKeyPrefix}${addressId}`,\n          new Date().valueOf()\n        )\n      }\n\n      service.unMarkAddressValidated = addressId => {\n        localStorageService.deprecatedRemove(`${validateAddressKeyPrefix}${addressId}`)\n      }\n\n      service.checkAddressValidated = addressId => {\n        const timestamp = localStorageService.deprecatedGet(\n          `${validateAddressKeyPrefix}${addressId}`\n        )\n        return !!timestamp && new Date().valueOf() - timestamp < validateAddressExpiry\n      }\n\n      service.getDefault = () => {\n        return service.addressItems[0]\n      }\n\n      service.getAddressRegionString = address => {\n        if (!address) {\n          return null\n        }\n\n        return [address.city, address.province].filter(value => !!value).join(', ')\n      }\n\n      service.hasAddressItems = () => service.addressItems && service.addressItems.length > 0\n      service.hasIcAddressItems = () => service.icAddressItems && service.icAddressItems.length > 0\n\n      $rootScope.$on('auth', (_event, action) => {\n        if (fetchAddressActions.includes(action)) {\n          service.fetchAddresses()\n        }\n      })\n    }\n  )\n","import _ from 'lodash'\nimport angular from 'angular'\n\nexport default angular\n  .module('addressSearchServicesModule', [])\n  .service('addressSearchService', function addressSearchService($q, config, utilService) {\n    const service = this\n\n    const path = `https://maps.googleapis.com/maps/api/js?key=${config.googlePlacesAPIKey}&libraries=places`\n    const sdkLoadedDefer = $q.defer()\n\n    utilService\n      .loadScript(path)\n      .then(() => sdkLoadedDefer.resolve())\n      .catch(err => sdkLoadedDefer.reject(err))\n\n    // This service is hardcoded for US only.\n    const POSTAL_CODE_LENGTH = 5\n    const getTruncatedPostalCode = code => {\n      return code?.length > POSTAL_CODE_LENGTH ? code.slice(0, POSTAL_CODE_LENGTH) : code\n    }\n\n    const findFirstObject = (components, name, attr = 'long_name') => {\n      const obj = _.find(components, o => o.types.indexOf(name) > -1)\n      return obj && obj[attr]\n    }\n\n    const parseFieldsFromAutocomplete = place => {\n      const components = place.address_components\n      const address = findFirstObject(components, 'street_number')\n      return {\n        address1: `${address ? `${address} ` : ''}${findFirstObject(components, 'route')}`,\n        city:\n          findFirstObject(components, 'locality') ||\n          findFirstObject(components, 'administrative_area_level_3'),\n        province: findFirstObject(components, 'administrative_area_level_1'),\n        province_short: findFirstObject(components, 'administrative_area_level_1', 'short_name'),\n        postal_code: getTruncatedPostalCode(findFirstObject(components, 'postal_code')),\n      }\n    }\n\n    service.sdkLoaded = sdkLoadedDefer.promise\n\n    service.addAutoCompleteWidget = (input, callback) => {\n      const options = {\n        types: ['address'],\n        componentRestrictions: {\n          country: 'us',\n        },\n      }\n\n      const autocomplete = new google.maps.places.Autocomplete(input, options)\n      // Limit fields for cost optimization\n      autocomplete.setFields(['address_components', 'geometry', 'icon', 'name'])\n\n      const autocompleteListener = google.maps.event.addListener(\n        autocomplete,\n        'place_changed',\n        () => {\n          const place = autocomplete.getPlace()\n\n          if (callback) {\n            // No address found\n            if (!place.geometry || !place.geometry.location) {\n              callback({\n                address1: null,\n                city: null,\n                province: null,\n                province_short: null,\n                postal_code: null,\n              })\n            } else {\n              callback(parseFieldsFromAutocomplete(place))\n            }\n          }\n        }\n      )\n\n      return [autocomplete, autocompleteListener]\n    }\n\n    service.removeAutoCompleteWidget = (autoComplete, autoCompleteListener, pacContainer) => {\n      google.maps.event.removeListener(autoCompleteListener)\n      google.maps.event.clearInstanceListeners(autoComplete)\n      pacContainer.remove()\n    }\n  })\n","import _ from 'lodash'\nimport angular from 'angular'\n\nexport default angular\n  .module('addToCartServicesModule', [])\n  .service(\n    'addToCartService',\n    function addToCartService(\n      $rootScope,\n      analytics,\n      auth,\n      cartAnalytics,\n      cartService,\n      config,\n      lang,\n      mobileService,\n      productsService\n    ) {\n      const service = this\n\n      /*\n       * Helper functions\n       */\n      service.getCornerDistance = (element, index) => {\n        const analyticScope = cartAnalytics.findAnalyticScope(element)\n        return cartAnalytics.getCornerDistanceInScope(analyticScope, index)\n      }\n\n      service.formatQuantity = (product, quantity) => {\n        if (!quantity) return null\n\n        let newQuantity = quantity\n\n        if (product.order_by_weight) {\n          newQuantity += ` ${product.ordering_parameters.display_name}`\n        }\n\n        if (!mobileService.isMobile) {\n          newQuantity += ` ${lang.values.added}`\n        }\n\n        return newQuantity\n      }\n\n      service.tellParents = product => {\n        $rootScope.$broadcast('productAdded', product)\n      }\n\n      // Add or update product by weight\n      service.updateWeight = ({\n        // Scope\n        cartItem,\n        element,\n        product,\n        index,\n        isModal,\n        location,\n        locationValue,\n        quantity,\n        // Args\n        configuration, // arg\n        selectedQuantity, // arg\n      }) => {\n        // old args = configuration, selectedQuantity\n        const context = auth.getContext().intent\n        const updatedQuantity = selectedQuantity || quantity\n        productsService.getBeacon(product.onAddToCartBeacon)\n\n        if (!cartItem) {\n          cartAnalytics.addItem(product, updatedQuantity, index, location, locationValue, {\n            is_modal: isModal,\n            corner_distance: service.getCornerDistance(element, index),\n          })\n\n          cartService.addItem(product, updatedQuantity, configuration)\n          analytics.logFBAddToCart(product, updatedQuantity)\n\n          if (!$rootScope.modifyingOrder) {\n            analytics.logProductAddToCart(product, location, context) // GA ecom\n          }\n\n          service.tellParents(product)\n        } else {\n          /**\n           * Please, do not move this method below *updateItemQuantity*. When selecting an item weight\n           * the selected option is the final quantity - Moving it after the update method will cause\n           * analytics to lose reference of the initial item quantity in the cart\n           * */\n          cartAnalytics.updateQuantity(product, quantity, index, location, locationValue, {\n            is_modal: isModal,\n            corner_distance: service.getCornerDistance(element, index),\n          })\n\n          cartService.updateItemQuantity(product, updatedQuantity, configuration)\n\n          analytics.logEvent('add to cart weighted item update quantity', 'change')\n        }\n      }\n\n      service.appReviewCheck = rateApp => {\n        const context = auth.getContext().intent\n        const isInstoreContent = context === 'instore'\n        // if instore, and the number of items in the cart is greater than itemsAddedtoCart, then possible prompt for app review\n        const cartLength = _.get(cartService, 'cart.items.length', 0)\n        const itemsAdded = config.mobileAppRate.itemsAddedtoCart\n        if (itemsAdded !== -1) {\n          if (cartLength >= itemsAdded && isInstoreContent) {\n            rateApp.promptAppReview()\n          }\n        }\n      }\n\n      service.registerAddToCartAnalytics = (element, index) => {\n        const analyticScope = cartAnalytics.findAnalyticScope(element)\n\n        // if there's no index meaning it's not part of a collection so no need\n        // to track coordinates\n        if (index !== undefined) {\n          cartAnalytics.registerAddToCart(analyticScope, element)\n        }\n      }\n\n      service.onAdd = ({\n        element,\n        index,\n        isModal,\n        location,\n        locationValue,\n        passToCtrl,\n        product,\n        quantity,\n      }) => {\n        productsService.getBeacon(product.onAddToCartBeacon)\n\n        if (mobileService.isMobile && product.order_by_weight && passToCtrl.showPopover) {\n          passToCtrl.showPopover()\n        } else {\n          service.tellParents()\n          cartService.updateItemQuantity(product, quantity + 1)\n          service.appReviewCheck()\n          cartAnalytics.addItem(product, 1, index, location, locationValue, {\n            is_modal: isModal,\n            corner_distance: service.getCornerDistance(element, index),\n          })\n          analytics.logFBAddToCart(product)\n          if ($rootScope.modifyingOrder) {\n            analytics.logEvent(['add to cart product increment cart quantity button', 'click'])\n          }\n        }\n      }\n      service.onRemove = ({\n        element,\n        index,\n        isModal,\n        location,\n        locationValue,\n        product,\n        quantity,\n      }) => {\n        if (product.order_by_weight) {\n          cartAnalytics.removeItem(product, quantity, index, location, locationValue, {\n            is_modal: isModal,\n            corner_distance: service.getCornerDistance(element, index),\n          })\n          cartService.removeItem(product)\n          if ($rootScope.modifyingOrder) {\n            analytics.logEvent.apply(analytics.logEvent, [\n              'add to cart weighted product remove from cart button',\n              'click',\n            ])\n          }\n        } else {\n          cartService.updateItemQuantity(product, quantity - 1)\n          cartAnalytics.removeItem(product, 1, index, location, locationValue, {\n            is_modal: isModal,\n            corner_distance: service.getCornerDistance(),\n          })\n          if ($rootScope.modifyingOrder) {\n            analytics.logEvent.apply(analytics.logEvent, [\n              'add to cart product decrement cart quantity button',\n              'click',\n            ])\n          }\n        }\n      }\n    }\n  )\n","import dayjs from 'dayjs'\nimport angular from 'angular'\nimport { DATE_OF_BIRTH_FORMAT } from '@app/angular/constants/alcoholValidation'\nimport alcoholValidationModalTemplate from '../templates/alcoholValidation/alcoholValidationModal.html'\n\nexport default angular\n  .module('AlcoholValidationServicesModule', [])\n  .service('alcoholValidation', function ($state, $uibModal, auth, cartService, config, lang) {\n    const service = this\n\n    service.shouldShowModal = () => {\n      const { dateOfBirth } = cartService\n\n      return (\n        cartService.getHasAlcohol() &&\n        config.alcoholCompliance.enabled &&\n        !service.isDateOfBirthValid(dateOfBirth)\n      )\n    }\n\n    service.isDateOfBirthValid = date => {\n      if (!date) return false\n\n      return (\n        dayjs(date, DATE_OF_BIRTH_FORMAT).format(DATE_OF_BIRTH_FORMAT) === date &&\n        service.isBirthDateAlcoholEligible(date)\n      )\n    }\n\n    service.isBirthDateAlcoholEligible = date => {\n      return (\n        dayjs().diff(dayjs(date, DATE_OF_BIRTH_FORMAT), 'years', true) >=\n        config.alcoholCompliance.minAge\n      )\n    }\n\n    service.getDateOfBirth = () => {\n      return cartService.dateOfBirth\n    }\n\n    service.setDateOfBirth = date => {\n      cartService.dateOfBirth = date\n    }\n\n    service.clearDateOfBirth = () => {\n      delete cartService.dateOfBirth\n    }\n\n    service.open = (isDismissable = true) => {\n      return $uibModal.open({\n        template: alcoholValidationModalTemplate,\n        controller($scope, $uibModalInstance) {\n          Object.assign($scope, {\n            lang,\n            config,\n            service,\n            isDismissable,\n            isDateOfBirthValid: false,\n            dateOfBirth: cartService.dateOfBirth,\n          })\n\n          $scope.continue = () => {\n            service.setDateOfBirth($scope.dateOfBirth)\n            $uibModalInstance.close()\n          }\n\n          $scope.handleDismissClick = () => {\n            if ($state.current.name === 'main.checkout.checkoutPage') {\n              $state.go('main.checkout.cart')\n            }\n            $uibModalInstance.dismiss()\n          }\n        },\n        keyboard: false,\n        backdrop: 'static',\n        controllerAs: '$ctrl',\n      }).result\n    }\n  })\n","/* eslint-disable max-lines */\n\nimport _ from 'lodash'\nimport angular from 'angular'\nimport { analytics as enterpriseAnalytics } from '@instacart/enterprise-services'\nimport getHtml5Url from '@app/utils/getHtml5Url'\nimport isMobileApp from '@app/utils/isMobileApp'\nimport { SEGMENT_SPONSORED_SOURCE } from '@app/angular/services/modules/analytics/analyticsConstants'\nimport { v4 as uuidv4 } from 'uuid'\nimport { eventEmitter, EVENT_TYPES } from '@app/utils/eventEmitter'\nimport { getBannerSegmentPayload } from '@app/utils/banners'\nimport waitOneTrust from '@app/utils/waitOneTrust'\n\nconst FP_IMPRESSION_KEY = 'fp_impression'\nconst FP_IMPRESSION_EXPIRATION = 60 * 1000 * 5 // 5 minutes\n\nconst PLACEMENT_IMPRESSION_KEY = 'active_placement_impression'\nconst PLACEMENT_IMPRESSION_EXPIRATION = 1000 * 60 * 10 // 10 minutes\n\nexport default angular\n  .module('AnalyticsServicesModule', [])\n  .service(\n    'analytics',\n    function analytics(\n      $document,\n      $location,\n      $q,\n      $rootScope,\n      $state,\n      $window,\n      anonymousIdService,\n      auth,\n      config,\n      mobileService,\n      searchService,\n      unataCommService,\n      universalLinksService,\n      userService,\n      utilService\n    ) {\n      const {\n        integrations,\n        hotjarId = null,\n        googleAnalyticsID = null,\n        googleTagManagerID: googleTagManagerIDWeb = null,\n        googleTagManagerIDNativeMobile = null,\n        segmentID = null,\n        appsFlyerSDK,\n        sendAnalyticsOnStage,\n        env,\n        oneTrustSDK,\n      } = config\n\n      const service = this\n\n      service.featuredProductImpressions = {}\n      service.placementImpressions = {}\n\n      const shouldFireAnalytics = env.mode === 'prod' || sendAnalyticsOnStage === true\n      const googleTagManagerID = mobileService.isMobileApp()\n        ? googleTagManagerIDNativeMobile\n        : googleTagManagerIDWeb\n\n      const analyticsServicesMap = {\n        googleAnalytics: googleAnalyticsID,\n        googleTagManager: googleTagManagerID,\n        hotjar: hotjarId,\n        segment: segmentID,\n      }\n\n      const analyticsServicesArray = Object.entries(analyticsServicesMap)\n        .map(([name, id]) => ({ name, id }))\n        .filter(service => service.id !== null)\n\n      let previousStateName\n      $rootScope.$on('$stateChangeSuccess', (ev, to, toParams, from) => {\n        previousStateName = from.name\n      })\n\n      if (\n        isMobileApp() &&\n        appsFlyerSDK?.enabled &&\n        appsFlyerSDK?.devKey &&\n        appsFlyerSDK?.appleAppId &&\n        window?.plugins?.appsFlyer\n      ) {\n        const options = {\n          devKey: appsFlyerSDK.devKey,\n          appId: appsFlyerSDK.appleAppId,\n          onInstallConversionDataListener: true,\n          timeToWaitForAdvertiserID: 10, // https://github.com/AppsFlyerSDK/appsflyer-cordova-plugin#--setup\n        }\n\n        const appsFlyerLinkHandler = result => {\n          try {\n            const deeplinkData = JSON.parse(result)\n            const url = deeplinkData?.data?.deep_link_value\n            if (deeplinkData?.type === 'onAppOpenAttribution') {\n              if (url) {\n                universalLinksService.didLaunchAppFromLink({ url })\n              }\n            } else if (deeplinkData?.type === 'onInstallConversionDataLoaded') {\n              if (deeplinkData?.data?.is_first_launch === true) {\n                if (url) {\n                  universalLinksService.didLaunchAppFromLink({ url })\n                }\n              }\n            }\n          } catch (e) {\n            console.error(e)\n          }\n        }\n\n        // Wait for the current state change to complete before re-routing\n        $rootScope.$on('firstStateChangeSuccess', () => {\n          window.plugins.appsFlyer.initSdk(options, appsFlyerLinkHandler, err => console.error(err))\n          window.plugins.appsFlyer.registerOnAppOpenAttribution(appsFlyerLinkHandler, err =>\n            console.error(err)\n          )\n        })\n\n        analyticsServicesArray.push({\n          name: 'appsFlyerMobile',\n          id: appsFlyerSDK.devKey,\n          instance: window.plugins.appsFlyer,\n        })\n      }\n\n      const oneTrustSDKCategories = oneTrustSDK.enabled\n        ? Object.fromEntries(\n            analyticsServicesArray.map(({ name }) => {\n              const category = oneTrustSDK.categories?.[name] ?? oneTrustSDK.defaultCategory\n              return [name, category]\n            })\n          )\n        : {}\n\n      const filteredAnalyticsServicesArray = analyticsServicesArray.filter(({ id }) => id)\n      const analyticsService = enterpriseAnalytics.init(\n        filteredAnalyticsServicesArray,\n        oneTrustSDKCategories,\n        $document[0]\n      )\n\n      // Log pageviews\n      let lastTrackedPage = ''\n      service.logPageView = async (page, title, referrer) => {\n        /*  To avoid same page views being tracked multiple times on Cordova, we have to cache\n         *  and check if the page view is the same as previous one and filter them out.\n         */\n        if (isMobileApp()) {\n          // Remove \"/\" at the end of the page url\n          if (page.charAt(page.length - 1) === '/') {\n            page = page.slice(0, -1)\n          }\n\n          if (page === lastTrackedPage) {\n            return\n          }\n\n          lastTrackedPage = page\n        }\n\n        const userInfo = await getUserInfoAnalytics()\n        const unataAppVersion = config.version\n        const unataMobileAppVersion = mobileService.appVersion || ''\n        const segmentData = {\n          page,\n          title,\n          referrer,\n          userInfo,\n          unataAppVersion,\n          unataMobileAppVersion,\n        }\n        return analyticsService.log({\n          event: 'pageview',\n          data: { page, title, segmentData },\n        })\n      }\n\n      /* Generic (GA/GTM) and Segment-specific log events\n       *  Two separate functions to serve generic events calls for either GA/GTM or\n       *  Segment-specific calls. Unfortunately, due to the difference in tracking name values,\n       *  this must be separated - along with the fact that only some events are captured in\n       *  Segment and vice versa\n       */\n      service.logEvent = async (category, action, label, value) =>\n        analyticsService.log({\n          event: 'event',\n          data: { category, action, label, value },\n        })\n\n      service.logSegmentEvent = async (name, segmentArgs = {}) => {\n        const absUrl = $location.absUrl()\n        const page = isMobileApp() ? getHtml5Url(absUrl) : absUrl\n        const userInfo = await getUserInfoAnalytics()\n        const unataAppVersion = config.version\n        const unataMobileAppVersion = mobileService.appVersion || ''\n        const newArgs = {\n          ...segmentArgs,\n          unataAppVersion,\n          unataMobileAppVersion,\n        }\n        return analyticsService.log({\n          event: 'event',\n          data: {\n            segmentData: { page, segmentArgs: newArgs, userInfo },\n            segmentName: name,\n          },\n        })\n      }\n\n      eventEmitter.on(EVENT_TYPES.LOG_SEGMENT_EVENT, ({ name, segmentArgs }) => {\n        service.logSegmentEvent(name, segmentArgs)\n      })\n\n      /*\n       * Featured Product Impressions\n       */\n      service.logFeaturedProductImpression = (product, location) => {\n        const segmentProduct = service.getProductInfoAnalytics(product)\n        const impressionData = {\n          impression_id: uuidv4(),\n          page_type: location,\n        }\n        service.featuredProductImpressions[product.id] = impressionData\n\n        const segmentPayload = {\n          item_details: segmentProduct,\n          sponsored: segmentProduct.sponsored,\n          sponsored_source: segmentProduct.sponsored_source,\n          ...impressionData,\n        }\n        return service.logSegmentEvent('store.featured_product_impression', segmentPayload)\n      }\n\n      service.setFeaturedProductImpressionToStore = productId => {\n        utilService.setExpiringValueToStore(\n          FP_IMPRESSION_KEY,\n          {\n            ...utilService.getExpiringValueFromStore(FP_IMPRESSION_KEY),\n            [productId]: service.featuredProductImpressions[productId],\n          },\n          FP_IMPRESSION_EXPIRATION\n        )\n      }\n\n      service.getFeaturedProductImpression = productId => {\n        return (\n          service.featuredProductImpressions[productId] ||\n          utilService.getExpiringValueFromStore(FP_IMPRESSION_KEY)?.[productId]\n        )\n      }\n\n      /*\n       * Promoted Placement Impressions\n       */\n      service.logPlacementImpression = (placements, location, type) => {\n        if (!placements?.length) return\n\n        const key = type || placements.route\n        service.placementImpressions[key] = {\n          impression_id: uuidv4(),\n          placement_type: key,\n          page_type: location,\n        }\n\n        const segmentPayload = {\n          ...service.placementImpressions[key],\n          ...getBannerSegmentPayload(),\n          placement: placements.map((placement, index) => ({\n            id: placement.id,\n            placement_name: placement.name,\n            content_type: placement.media?.type,\n            target_action: placement.target?.type,\n            position: index,\n          })),\n        }\n\n        return service.logSegmentEvent('store.placements_impression', segmentPayload)\n      }\n\n      eventEmitter.on(EVENT_TYPES.LOG_PLACEMENT_IMPRESSION, ({ placements, location, type }) =>\n        service.logPlacementImpression(placements, location, type)\n      )\n\n      service.setActivePlacementImpressionToStore = type => {\n        service.activePlacementImpression = service.placementImpressions[type]\n        utilService.setExpiringValueToStore(\n          PLACEMENT_IMPRESSION_KEY,\n          service.placementImpressions[type],\n          PLACEMENT_IMPRESSION_EXPIRATION\n        )\n      }\n\n      service.getActivePlacementImpression = () =>\n        service.activePlacementImpression ||\n        utilService.getExpiringValueFromStore(PLACEMENT_IMPRESSION_KEY)\n\n      /* Log ecommerce events\n       *  Most of these accept a location parameter, which is a string identifying the view / section\n       *  where the product was located when the event occurred.\n       */\n\n      // Log a product being shown to a user, generally either in a product tile or a related product cell\n      service.logProductImpression = (product, location) => {\n        if (product.placement) return service.logFeaturedProductImpression(product, location)\n\n        return analyticsService.log({\n          event: 'impression',\n          subject: 'product',\n          data: { product, location },\n        })\n      }\n\n      // Log a view of a product details view\n      service.logProductDetailsView = product =>\n        analyticsService.log({ event: 'detail', subject: 'product', data: { product } })\n\n      // Log clicking on a product, via a product tile or related product cell\n      service.logProductClick = (product, location, extData) =>\n        analyticsService.log({\n          event: 'click',\n          subject: 'product',\n          data: { product, location, extData },\n        })\n\n      // Log adding a product to the cart\n      service.logProductAddToCart = (product, location, contextIntent) => {\n        const logLocation = appendListOrCartIfInFlyer(location, contextIntent)\n        analyticsService.log({\n          event: 'add',\n          subject: 'product',\n          data: { product, logLocation },\n        })\n      }\n\n      // Log removing a product from the cart\n      service.logProductRemoveFromCart = (product, location, contextIntent) => {\n        const logLocation = appendListOrCartIfInFlyer(location, contextIntent)\n        analyticsService.log({\n          event: 'remove',\n          subject: 'product',\n          data: { product, logLocation },\n        })\n      }\n\n      // Log an offer being shown to a user, generally either in an offer tile or a related offer cell\n      service.logOfferImpression = (offer, location) =>\n        analyticsService.log({ event: 'impression', subject: 'offer', data: { offer, location } })\n\n      // Log a view of an offer details view\n      service.logOfferDetailsView = offer =>\n        analyticsService.log({ event: 'detail', subject: 'offer', data: { offer } })\n\n      // Log clicking on an offer, via coupon clipper or activate button\n      service.logOfferClick = (offer, location) =>\n        analyticsService.log({ event: 'click', subject: 'offer', data: { offer, location } })\n\n      // Log checkout initiation\n      service.logBeginCheckout = async cart => {\n        analyticsService.log({\n          event: 'checkout',\n          subject: 'start',\n          data: { cart },\n        })\n      }\n\n      // Log completion of a checkout step\n      service.logCheckoutStep = (step, option, products) =>\n        analyticsService.log({\n          event: 'checkout',\n          subject: 'step',\n          data: { step, option, products },\n        })\n\n      // Log completion of a checkout option\n      service.logCheckoutOption = (step, option) =>\n        analyticsService.log({ event: 'checkout', subject: 'option', data: { step, option } })\n\n      // Log completion of checkout\n      service.logCheckoutCompletion = order => {\n        const orderPayload = { ...order }\n        delete orderPayload.billing_address\n        delete orderPayload.delivery_address\n        delete orderPayload.ext_data\n\n        analyticsService.log({\n          event: 'checkout',\n          subject: 'completion',\n          data: { order: orderPayload },\n        })\n      }\n\n      // Log viewing recipe detail\n      service.logRecipeDetailsView = recipe =>\n        analyticsService.log({ event: 'detail', subject: 'recipe', data: { recipe } })\n\n      // Log search results event\n      service.logSearch = ({ term, results }) =>\n        analyticsService.log({ event: 'search', data: { term, results } })\n\n      // Log user login event\n      service.logUserLogin = () => analyticsService.log({ event: 'login' })\n\n      // Segment functions\n      service.identify = async () => {\n        // TODO: Should this still fire if anonymousId fails?\n        const anonymousID = await anonymousIdService.getId()\n        if (anonymousID && analyticsService.segment) {\n          analyticsService.segment.identify({\n            identifiableID: `${env.shortCode}_${auth.user.id}`,\n            anonymousID,\n          })\n        }\n      }\n\n      if (config.criteoId) {\n        initCriteoAnalytics(oneTrustSDKCategories.criteo)\n      }\n\n      prepCriteoAnalytics()\n\n      if (config.elevaate?.enabled && config.elevaate?.tag) {\n        initElevaateAnalytics(oneTrustSDKCategories.elevaate)\n      }\n\n      // Configure Facebook Mobile SDK\n      prepFacebookMobileSDK()\n\n      const getUserInfoAnalytics = () => {\n        const deferred = $q.defer()\n        anonymousIdService.getId().then(anonymousId => {\n          const store = auth.user.store || {}\n          store.address = store.address || {}\n\n          const buildObject = token => ({\n            is_loyalty_user: !!userService.loyaltyCards.length,\n            is_instacart_member: auth.user.ic_linked,\n            user_id: `${env.shortCode}_${auth.user.id}`,\n            user_status: auth.user.status,\n            usersession_id: auth.getSessionId(),\n            retailer_code: env.shortCode,\n            store_id: store.id,\n            store_zip: store.address.postal_code,\n            store_city: store.address.city,\n            store_country: store.address.country,\n            store_province: store.address.province,\n            group: {\n              retailer_code: env.shortCode,\n            },\n            shopping_mode: auth.getCurrentShoppingMode(),\n            zip_code: auth.user.context && auth.user.context.deliveryPostalCode,\n            user_city: auth.user.context && auth.user.context.city,\n            user_province:\n              auth.user.context && (auth.user.context.province_short || auth.user.context.province),\n            trial_id: anonymousId,\n            visit_token: token,\n          })\n\n          // Send the analytics object even if getting the `visit_token` fails\n          enterpriseAnalytics.expiryToken\n            .getToken()\n            .then(token => deferred.resolve(buildObject(token)))\n            .catch(() => deferred.resolve(buildObject()))\n        })\n\n        return deferred.promise\n      }\n\n      // Cart events are expected to pass the cart to this service.\n      service.getCartInfoAnalytics = cart => {\n        return {\n          cart_items_count: cart.items.length,\n          pre_discount_product_total: cart.pre_discount_product_total,\n          product_total: cart.product_total,\n          cart_route: cart.route,\n          tax_total: cart.tax_total,\n          cart_total: cart.total,\n          credit_total: cart.credit_total,\n          delivery_fee: cart.delivery_fee,\n          offer_total: cart.offer_total,\n          pickup_fee: cart.pickup_fee,\n          subscription_total: cart.subscription_total,\n          tip_total: cart.tip_total,\n          tip_percent: cart.tip_percent,\n        }\n      }\n\n      service.getProductListAnalytics = (productList, options) => {\n        const product_results = []\n        productList?.forEach((product, index) => {\n          const productAnalytics = service.getProductInfoAnalytics(\n            product,\n            index,\n            null,\n            options?.slim\n          )\n          if (productAnalytics) {\n            product_results.push(productAnalytics)\n          }\n        })\n        return product_results\n      }\n\n      /**\n       * Formats a given recipe list for usage in analytics events\n       * @param {Array} recipeList An array of recipes\n       * @param {string?} searchID Optionally the search that triggered\n       */\n      service.getRecipeListAnalytics = (recipeList, searchID) => {\n        let formattedEvents = recipeList.map(service.getRecipeAnalytics)\n        if (searchID) {\n          formattedEvents = formattedEvents.map(r => {\n            return {\n              ...r,\n              snrid: searchID,\n            }\n          })\n        }\n        return formattedEvents\n      }\n\n      /**\n       * Removes special characters that prevent segment to work properly.\n       * Any text in Segment payload that contains the character % will\n       * cause the event to not trigger\n       *\n       * @param {string} text\n       * @returns {string}\n       */\n      const _sanitizeAnalyticsText = text => {\n        if (!text) return\n\n        return text.replace(/%/g, '')\n      }\n\n      const getSalePricing = store_product => {\n        const loyaltyPrice = config.enableLoyaltyPricing && store_product.loyalty_price\n        const salePrice = !config.enableLoyaltyPricing && store_product.sale_price\n\n        if (loyaltyPrice) {\n          const { loyalty_price, loyalty_end_date, loyalty_quantity } = store_product\n          return {\n            sale_price: loyalty_price,\n            sale_end_date: loyalty_end_date,\n            sale_quantity: loyalty_quantity,\n            type: 'loyalty',\n          }\n        }\n        if (salePrice) {\n          const { sale_price, sale_end_date, sale_quantity } = store_product\n          return { sale_price, sale_end_date, sale_quantity, type: 'sale' }\n        }\n        return { sale_price: null, sale_end_date: null, sale_quantity: null, type: null }\n      }\n      const getSponsoredSource = store_product => {\n        if (!store_product.placement) return undefined\n\n        if (!store_product.sponsoredBy) return SEGMENT_SPONSORED_SOURCE.DASHBOARD\n\n        return store_product.sponsoredBy === SEGMENT_SPONSORED_SOURCE.INSTACART\n          ? store_product.sponsoredBy\n          : SEGMENT_SPONSORED_SOURCE.THIRD_PARTY\n      }\n\n      const getProductSnrid = store_product => {\n        const snrid = store_product.snrid || searchService.snrid\n\n        // If we're on the search page, include snrid\n        if ($state.current.name === 'main.search') return snrid\n\n        // If we were directed to a recipe from the search page, include snrid\n        if (\n          $state.current.name === 'main.recipes.details' &&\n          previousStateName === 'main.search.recipes'\n        )\n          return snrid\n\n        // Otherwise, do not include snrid\n        return null\n      }\n\n      service.getProductInfoAnalytics = (product, index, corner_distance, slim = false) => {\n        const store_product = product?.store_product || product?.product || product\n        if (store_product?.id) {\n          // This is a workaround for recipes which returns a tags object instead of an array\n          const tags = store_product.tags?.tags || store_product.tags\n          const previous_purchase = tags?.includes('purchased') || false\n\n          const slimPayload = {\n            name: _sanitizeAnalyticsText(store_product.name),\n            id: store_product.id,\n            ic_item_id: store_product.ic_item_id,\n            is_primary_result: searchService.isPrimaryResult(store_product),\n            previous_purchase,\n            position: index || (index === 0 ? 0 : null),\n            product_type: store_product.product_type,\n            sponsored: store_product.placement,\n            sponsored_source: getSponsoredSource(store_product),\n          }\n\n          if (slim) return slimPayload\n\n          return {\n            ...slimPayload,\n            brand_name: _sanitizeAnalyticsText(store_product.brand_name),\n            ic_product_id: store_product.ic_product_id,\n            aisle: store_product.aisle,\n            base_price: store_product.base_price,\n            product_rating: store_product.product_rating,\n            price_alert: store_product.price_alert,\n            reco_rating: store_product.reco_rating,\n            snrid: getProductSnrid(store_product),\n            sale_data: getSalePricing(store_product),\n            offers: store_product.offers,\n            corner_distance,\n            config_type: store_product?.product_config?.config_type,\n          }\n        }\n        return null\n      }\n\n      /**\n       * Formats a given recipe into a format that's acceptable to analytics; in\n       * particular, this sanitizes the recipe name and converts the tags into an\n       * array of strings instead of objects (behaviour subject to change to match\n       * the categories property)\n       */\n      service.getRecipeAnalytics = (recipe, index) => {\n        let formattedProducts = {}\n\n        if (recipe.products) {\n          formattedProducts = Object.keys(recipe.products).reduce((result, category) => {\n            result[category] = service.getProductListAnalytics(recipe.products[category])\n            return result\n          }, {})\n        }\n\n        return {\n          id: recipe.id,\n          name: _sanitizeAnalyticsText(recipe.name),\n          categories: recipe.categories,\n          category: recipe.categories[0],\n          sub_categories: recipe.categories.slice(1),\n          saved_count: recipe.saved_count,\n          tags: recipe.tags?.tags?.map(tag => tag.tag_name) || [],\n          item_details: formattedProducts,\n          preparation_information: recipe.preparation_information,\n          position: index || (index === 0 ? 0 : null),\n        }\n      }\n\n      // Logs the checkout CTA button click\n      service.logCheckoutCTAClick = (category, value) =>\n        analyticsService.log({\n          event: 'event',\n          data: {\n            value,\n            category,\n            action: 'click',\n            name: 'checkout_click',\n          },\n        })\n\n      function initCriteoAnalytics(oneTrustSDKCategory) {\n        ;(function (z) {\n          const b = function (x) {\n            return document.getElementsByTagName(x)[0]\n          }\n          const c = b('head') || b('body') || b('script').parentNode\n          const d = document.createElement('script')\n          d.type = 'text/javascript'\n          d.async = 1\n          d.src = z\n          if (oneTrustSDKCategory) {\n            waitOneTrust().then(OneTrust =>\n              OneTrust.InsertScript(d.src, 'head', null, null, oneTrustSDKCategory)\n            )\n          } else {\n            c.insertBefore(d, null)\n          }\n        })(`//dynamic.criteo.com/js/ld/ld.js?a=${config.criteoId}`)\n      }\n\n      function initElevaateAnalytics(oneTrustSDKCategory) {\n        let scriptSrc = config.elevaate.tag\n        if (isMobileApp() && scriptSrc.startsWith('//')) {\n          scriptSrc = scriptSrc.replace(/^\\/\\//, 'https://')\n        }\n        ;(function (win, doc, tagName, srcPath, p, a, h) {\n          win[p] = win[p] || []\n          win[p].push({\n            event: 'elevaate',\n            start: new Date().getTime(),\n          })\n          p = `?gv=${encodeURIComponent(p)}`\n          a = doc.createElement(tagName)\n          h = doc.getElementsByTagName(tagName)[0]\n          a.async = 1\n          a.src = srcPath + p\n          if (oneTrustSDKCategory) {\n            waitOneTrust().then(OneTrust =>\n              OneTrust.InsertScript(a.src, 'body', null, null, oneTrustSDKCategory)\n            )\n          } else {\n            h.parentNode.insertBefore(a, h)\n          }\n        })(window, document, 'script', scriptSrc, 'elevaateData')\n      }\n\n      function prepCriteoAnalytics() {\n        const baseCriteoLogConstructor = async events => {\n          if (shouldFireAnalytics && window.criteo_q) {\n            const retailerVisitorId = await anonymousIdService.getId()\n\n            window.criteo_q.push(\n              { event: 'setAccount', account: config.criteoId },\n              { event: 'setCustomerId', id: auth?.user?.id },\n              { event: 'setEmail', email: auth?.user?.email || '' },\n              { event: 'setRetailerVisitorId', id: retailerVisitorId },\n              ...events\n            )\n          }\n        }\n\n        /**\n         * log Product Detail Page to Criteo\n         *\n         * @category Criteo // OneTag\n         * @param {Object} obj - Params for the logCriteoProductDetailsPage function\n         * @param {String} obj.item - The product id for the specific product being viewed. e.g.\n         * @param {String} obj.price - The current price for the displayed product e.g 475.00\n         * @param {Boolean} obj.availability - 1 if the product is in stock and 0 if it is out of stock\n         */\n        service.logCriteoProductDetailsPage = ({ item, price, availability }) => {\n          baseCriteoLogConstructor([\n            {\n              event: 'viewItem',\n              availability,\n              price,\n              item,\n            },\n          ])\n        }\n\n        /**\n         * log Order Confirmation Page to Criteo\n         *\n         * @category Criteo // OneTag\n         * @param {Object} obj - Params for the logCriteoOrderConfirmation function\n         * @param {String} obj.id - The transaction or order ID from your eCommerce system\n         * @param {Array} obj.items - The list of child product ids that are displayed on the cart page. Add a new line for each item in the basket.\n         * @param {String} obj.items[0].id - The current price for the displayed product e.g 475.00\n         * @param {String} obj.items[0].price - The current price for the displayed product e.g 475.00\n         * @param {String} obj.items[0].quantity - The current price for the displayed product e.g 475.00\n         */\n        service.logCriteoOrderConfirmation = ({ id, orderItems }) => {\n          const item = orderItems.map(order => ({\n            id: order.ext_id,\n            price: order.store_product.sale_price || order.store_product.base_price,\n            quantity: order.quantity,\n          }))\n\n          baseCriteoLogConstructor([\n            {\n              event: 'trackTransaction',\n              currency: 'USD', // TODO: This will be a big problem in the future if we ever have a CAD retailer on Criteo.\n              id,\n              item,\n            },\n          ])\n        }\n\n        service.logCriteoStoreProducts = ({ filterParams = {}, keyword, page_number, items }) => {\n          const filters = []\n\n          if (filterParams.tags) {\n            filters.push({\n              name: 'tag',\n              operator: 'eq',\n              value: filterParams.tags.sort().join(', '),\n            })\n          }\n\n          if (filterParams.brand_names) {\n            filters.push({\n              name: 'brand',\n              operator: 'eq',\n              value: filterParams.brand_names.sort().join(', '),\n            })\n          }\n\n          const category =\n            filterParams.categories && filterParams.categories[0]\n              ? filterParams.categories[0].join('>')\n              : null\n\n          baseCriteoLogConstructor([\n            {\n              event: keyword ? 'viewSearchResult' : 'viewCategory',\n              category: keyword ? undefined : category,\n              item: items.slice(0, 100),\n              page_number,\n              keyword,\n              filters,\n            },\n          ])\n        }\n      }\n\n      /**\n       * Initializes methods for publishing App Events\n       * to Facebook Analytics via the Facebook Mobile SDK.\n       */\n      function prepFacebookMobileSDK() {\n        const fbConfig = integrations.facebookMobileSDK\n\n        // Facebook Event Name Constants\n        const EVENTS = {\n          ADD_TO_CART: 'fb_mobile_add_to_cart',\n          COMPLETE_REGISTRATION: 'fb_mobile_complete_registration',\n        }\n\n        // Primary flag to ensure app events only get fired within the app\n        // and for clients that have the Facebook SDK enabled.\n        const allowFBAppEvents =\n          fbConfig &&\n          fbConfig.enabled &&\n          mobileService.isMobileApp() &&\n          $window.facebookConnectPlugin\n\n        // Set logging functions to an empty function if allowAppEvents is undefined.\n        // This will prevent errors from being thrown.\n        const defaultFBFunction = () => {}\n\n        /**\n         * Logs a custom event to the Facebook App Events API\n         * Refer to the following link for event payload structure:\n         * https://developers.facebook.com/docs/marketing-api/app-event-api/v2.8#event_structure\n         */\n        service.logFBEvent = allowFBAppEvents\n          ? (name, params, valueToSum) => {\n              $window.facebookConnectPlugin.logEvent(name, params, valueToSum)\n            }\n          : defaultFBFunction\n\n        /**\n         * Logs a \"Purchase\" event to Facebook.\n         * @param {number} value -  the amount that was purchased\n         * @param {string} currency - the currency, in ISO-4217 (http://en.wikipedia.org/wiki/ISO_4217)\n         */\n        service.logFBPurchase = allowFBAppEvents\n          ? order => {\n              const value = order.estimated_totals.total\n              $window.facebookConnectPlugin.logPurchase(value, fbConfig.currency)\n            }\n          : defaultFBFunction\n\n        /**\n         * Logs an \"Add to Cart\" event to Facebook.\n         * Uses the custom event format as the cordova-plugin-facebook4 does not\n         * expose a direct method for this particular type of event.\n         * @param {object} product - a product object structured as retrieved from the API\n         */\n        service.logFBAddToCart = allowFBAppEvents\n          ? (product, quantity = null) => {\n              const price = product.sale_price || product.base_price\n              const value = product.order_by_weight\n                ? parseFloat(price * quantity).toFixed(2)\n                : price\n\n              $window.facebookConnectPlugin.logEvent(\n                EVENTS.ADD_TO_CART,\n                {\n                  fb_currency: fbConfig.currency,\n                },\n                value\n              )\n            }\n          : defaultFBFunction\n\n        /**\n         * Logs a \"Registration Complete\" event to Facebook.\n         */\n        service.logFBUserRegistered = allowFBAppEvents\n          ? () => {\n              $window.facebookConnectPlugin.logEvent(EVENTS.COMPLETE_REGISTRATION, {}, 1)\n            }\n          : defaultFBFunction\n      }\n\n      // Log pageviews\n      // Notes:\n      // * Because this is a SPA, the document's referrer from the page's initial\n      //   load will be retained when this event is fired, regardless of whether\n      //   a value has been set or not.\n      // * On page's first load, this event will fire having newUrl == oldUrl\n      service.onLocationChangeSync = (event, newUrl, oldUrl) => {\n        let previousUrl\n        if (isMobileApp()) {\n          newUrl = getHtml5Url(newUrl)\n          oldUrl = getHtml5Url(oldUrl)\n        }\n        if (!document.referrer && oldUrl === newUrl) {\n          previousUrl = ''\n        } else {\n          // Prioritize using oldUrl when the oldUrl and newUrl received by this\n          // event actually differ. Otherwise, we can safely assume the user came\n          // from a different external referrer.\n          previousUrl = newUrl !== oldUrl ? oldUrl : document.referrer\n        }\n\n        if ($rootScope.title && !$rootScope.titlePromise) {\n          service.logPageView(newUrl, $rootScope.title, previousUrl)\n        } else {\n          $rootScope.titlePromise.promise.finally(() => {\n            // Once the page title is set, we log the pageview event\n            service.logPageView(newUrl, $rootScope.title, previousUrl)\n          })\n        }\n      }\n\n      // Log identify\n      $rootScope.$on('auth', (event, action) => {\n        if (action === 'userLoggedIn') {\n          service.identify()\n        }\n      })\n\n      const appendListOrCartIfInFlyer = (location, contextIntent) => {\n        if (location) {\n          if (location.indexOf('Flyerhomepage') === 0 || location.indexOf('Flyer') === 0) {\n            // If we're logging a product add to cart event from:\n            //  Flyerhomepage - Regular, Flyerhomepage - Preview, Flyer - Regular, or Flyer - Preview,\n            //  Log whether or not it's being added to the user's default in-store list, or the user's cart\n            const listOrCart = contextIntent === 'instore' ? 'List' : 'Cart'\n            return `${location} - ${listOrCart}`\n          }\n          // Otherwise, return the log location as is\n          return location\n        }\n      }\n\n      // Log navigations away to other domains.\n      $window.addEventListener('beforeunload', event => {\n        const anchor = event.target.activeElement?.closest('a')\n        if (!anchor) {\n          return\n        }\n\n        const { host, href } = anchor\n        if (host !== $location.host()) {\n          service.logSegmentEvent('store.navigate_away', { host, href })\n        }\n      })\n\n      // Log new tab openings.\n      $window.addEventListener('click', event => {\n        const anchor = event.target.closest('a')\n        if (!anchor) {\n          return\n        }\n\n        const { host, href, target } = anchor\n        if (target.split(/\\s+/).includes('_blank')) {\n          service.logSegmentEvent('store.new_tab', { host, href })\n        }\n      })\n    }\n  )\n\n  // Directives to provide easy access to analytics in templates\n  //\n  // Usage:     <analytics-x=\"[param1, param2]\"/>\n  // Will call: analytics.logX(param1, param2)\n  //\n  // Directive to toggle whether analytics should be sent or not, must be placed with the analytics-click directive\n  // If this directive is not specifed it will send the analytics event\n  //\n  // Usage : <div analytics-click=\"[param1, param2]\" send-analytics=\"boolean\"></div>\n  // Result: true will send the analytics, false will NOT send analytics\n\n  .directive('analyticsClick', function () {\n    return {\n      controller($scope, $element, $attrs, analytics) {\n        const sendAnalytics = $scope.$eval($attrs.sendAnalytics)\n        if (!_.isNil(sendAnalytics) && !sendAnalytics) {\n          return\n        }\n        $element.bind('click', () => {\n          analytics.logEvent.apply(analytics.logEvent, $scope.$eval($attrs.analyticsClick))\n        })\n      },\n    }\n  })\n\n  .directive('analyticsProductImpression', function (analytics) {\n    return (scope, element, attrs) => {\n      const sendAnalytics = scope.$eval(attrs.sendAnalytics)\n      if (!_.isNil(sendAnalytics) && !sendAnalytics) {\n        return\n      }\n      analytics.logProductImpression.apply(\n        analytics.logProductImpression,\n        scope.$eval(attrs.analyticsProductImpression)\n      )\n    }\n  })\n\n  .directive('analyticsProductClick', function (analytics) {\n    return (scope, element, attrs) => {\n      const sendAnalytics = scope.$eval(attrs.sendAnalytics)\n      if (!_.isNil(sendAnalytics) && !sendAnalytics) {\n        return\n      }\n      element.bind('click', () => {\n        analytics.logProductClick.apply(\n          analytics.logProductClick,\n          scope.$eval(attrs.analyticsProductClick)\n        )\n      })\n    }\n  })\n\n  .directive('analyticsOfferImpression', function (analytics) {\n    return (scope, element, attrs) => {\n      const sendAnalytics = scope.$eval(attrs.sendAnalytics)\n      if (!_.isNil(sendAnalytics) && !sendAnalytics) {\n        return\n      }\n      analytics.logOfferImpression.apply(\n        analytics.logOfferImpression,\n        scope.$eval(attrs.analyticsOfferImpression)\n      )\n    }\n  })\n\n  .directive('analyticsOfferClick', function (analytics) {\n    return (scope, element, attrs) => {\n      const sendAnalytics = scope.$eval(attrs.sendAnalytics)\n      if (!_.isNil(sendAnalytics) && !sendAnalytics) {\n        return\n      }\n      element.bind('click', () => {\n        analytics.logOfferClick.apply(\n          analytics.logOfferClick,\n          scope.$eval(attrs.analyticsOfferClick)\n        )\n      })\n    }\n  })\n\n  .directive('analyticsPlacementImpression', function (analytics) {\n    return (scope, element, attrs) => {\n      const sendAnalytics = scope.$eval(attrs.sendAnalytics)\n      if (!_.isNil(sendAnalytics) && !sendAnalytics) {\n        return\n      }\n      analytics.logPlacementImpression.apply(\n        analytics.logPlacementImpression,\n        scope.$eval(attrs.analyticsPlacementImpression)\n      )\n    }\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('anonymousIdServicesModule', [])\n\n  // Exposes the user's anonymous id and adds the ability to set and update it on the backend.\n  .service('anonymousIdService', function ($injector, $q, Restangular, config) {\n    const service = this\n    const LS_ANONYMOUS_KEY = 'una_anonymous_id'\n\n    // Initialize this service's user\n    service.anonymousUser = null\n\n    /**\n     * Initializes this service with supplied user.\n     * @param {object} user - the user/trial user as initialized by auth.\n     */\n    service.init = function (user) {\n      // The anonymousId the user has as returned by the backend\n      const currentAnonymousId = user.segment_trial_id\n      const localAnonymousId = service.getId()\n      service.anonymousUser = user\n\n      if (user.status === 'trial' || !currentAnonymousId || currentAnonymousId === 'null') {\n        // Process trial/anonymous users or users that for some reason,\n        // currently don't have an anonymousId:\n        // Always build their anonymousId and store it in localstorage.\n        service.setId(service.buildId(user))\n      } else if (!localAnonymousId || localAnonymousId !== currentAnonymousId) {\n        // Process logged-in users:\n        // Update the local anonymousId with the currentAnonymousId retrieved from user object/backend\n        // only if there isn't a local id or the local id is different.\n        // If the local id is the same as the backend id, do nothing.\n        service.setId(currentAnonymousId)\n      }\n    }\n\n    /**\n     * Builds the anonymousId for the supplied user.\n     */\n    service.buildId = function (user) {\n      return `${config.env.shortCode}_${user.id}`\n    }\n\n    /**\n     * Removes the anonymousId from localstorage.\n     */\n    service.clearId = function () {\n      localStorage.removeItem(LS_ANONYMOUS_KEY)\n      return $q.resolve()\n    }\n\n    /**\n     * Returns a promise of the anonymousId of the current user.\n     * This should not be doing any setting of the anonymousId,\n     * but its concern is with returning a non-null anonymousId.\n     * @return {Promise}\n     */\n    service.getId = function () {\n      const deferred = $q.defer()\n      let anonymousId = localStorage.getItem(LS_ANONYMOUS_KEY)\n\n      if (anonymousId && anonymousId !== 'null') {\n        // Return the anonymousId if it's valid.\n        deferred.resolve(anonymousId)\n      } else if (service.anonymousUser) {\n        // If the service user has already been initialized,\n        // use that user's information when trying to build the id.\n        anonymousId = service.buildId(service.anonymousUser)\n        deferred.resolve(anonymousId)\n      } else {\n        // Resolve null since the service is not initialized\n        deferred.resolve(null)\n      }\n\n      return deferred.promise\n    }\n\n    /**\n     * Sets the anonymousId of the current user to the supplied value.\n     * @param {string} id - the id\n     */\n    service.setId = function (id) {\n      localStorage.setItem(LS_ANONYMOUS_KEY, id)\n    }\n\n    /**\n     * Updates the user's anonymousId on the backend\n     * @return {Promise}\n     */\n    service.updateBackendId = function () {\n      // Avoid circular dependency issue using dynamic injector.\n      const auth = $injector.get('auth')\n      return service.getId().then(anonymousId => {\n        auth.update({ segment_trial_id: anonymousId })\n      })\n    }\n  })\n","import { config as configService } from '@instacart/enterprise-services'\nimport { windowManager } from '@instacart/enterprise-services-cordova'\nimport { OpenAuthBrowserOptions } from '@instacart/enterprise-services-cordova/window-manager'\nimport isMobileApp from '@app/utils/isMobileApp'\nimport { AUTH_ACTIONS } from '@app/angular/constants/authActions'\nimport { SSO_PROVIDERS } from '@app/angular/constants/ssoProviders'\nimport handleExternalAuth from '@app/services/externalAuth/handleExternalAuth'\nimport objectToQueryString from '@app/utils/objectToQueryString'\n\nexport default class ExternalOAuth2 {\n  openUrl(\n    link: string,\n    {\n      closeOnHome,\n      shouldResolve,\n    }: Partial<Pick<OpenAuthBrowserOptions, 'closeOnHome' | 'shouldResolve'>> = {}\n  ): Promise<void> {\n    if (isMobileApp()) {\n      return windowManager.openAuthUrl(link, { closeOnHome, shouldResolve })\n    }\n\n    window.open(link, '_self')\n\n    // Hold the promise chain else it continues and reloads the page.\n    return new Promise(() => {})\n  }\n\n  initLogin() {\n    return handleExternalAuth(SSO_PROVIDERS.EXTERNAL_OAUTH2_IDP)\n  }\n\n  initLogout() {\n    const config = configService.selectors.getConfig()\n    const externalOauthConfig = config.externalOAuth2?.serviceParams\n    const logoutUrl = externalOauthConfig?.logoutUrl as string\n    const clientId = externalOauthConfig?.clientId as string\n    const queryParamRedirectUriKey = externalOauthConfig?.logoutRequestParams\n      ?.postLogoutRedirectUriKey as string\n    const queryParamRedirectUriValue = externalOauthConfig?.logoutRequestParams\n      ?.postLogoutRedirectUriValue as string\n\n    // return and invoke logout URL if there are no complementary request params with it\n    if (!queryParamRedirectUriValue) {\n      return this.openUrl(logoutUrl, { closeOnHome: true, shouldResolve: true })\n    }\n\n    // construct url query and then invoke logout with appropriate request params\n    const urlQuery = objectToQueryString({\n      client_id: clientId,\n      [queryParamRedirectUriKey]: queryParamRedirectUriValue,\n    })\n    return this.openUrl(`${logoutUrl}?${urlQuery}`, { closeOnHome: true, shouldResolve: true })\n  }\n\n  init(view: AUTH_ACTIONS) {\n    switch (view) {\n      case AUTH_ACTIONS.LOGIN:\n        return this.initLogin()\n      case AUTH_ACTIONS.LOGOUT:\n        return this.initLogout()\n      default:\n        return Promise.resolve()\n    }\n  }\n}\n","/* eslint-disable max-lines */\n\nimport _ from 'lodash'\nimport angular from 'angular'\nimport { captureMessage } from '@sentry/browser'\nimport { auth as authService, auth, loading, utils } from '@instacart/enterprise-services'\nimport { AUTH_ACTIONS } from '@app/angular/constants/authActions'\nimport { USER_ACTIONS, CONTEXT_ACTIONS } from '@app/angular/constants/events'\nimport { LOGIN_CONTEXTS } from '@app/angular/constants/loginContexts'\nimport { OneCartActions } from '@app/services/oneCart/types'\n\nimport { HTTP_ERRORS } from '@app/angular/constants/httpErrors'\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\nimport { isNativeBridgePluginAvailable } from '@app/react/mobile/plugins/nativeBridgePlugin'\nimport getApiPrefix from '@app/utils/getApiPrefix'\nimport isCapacitor from '@app/utils/isCapacitor'\nimport isMobileApp from '@app/utils/isMobileApp'\nimport { getCurrentShoppingMode } from '@app/utils/getCurrentShoppingMode'\n\nimport ExternalOAuth2 from '@app/services/externalAuth/externalOAuth2'\nimport { USER_STATUSES } from '@app/angular/constants/user'\n\nconst apiPrefix = getApiPrefix()\n\nexport default angular\n  .module('authServicesModule', [])\n  .service(\n    'auth',\n    function (\n      $document,\n      $http,\n      $injector,\n      $location,\n      $q,\n      $rootScope,\n      $state,\n      $window,\n      addressList,\n      anonymousIdService,\n      config,\n      errorModalService,\n      lang,\n      localStorageService,\n      mobileService,\n      ngPromise,\n      oneCartService,\n      storesService,\n      unataCommService,\n      userService\n    ) {\n      const scope = this\n\n      scope.getAuthService = function () {\n        if (config.externalOAuth2?.enabled) {\n          return new ExternalOAuth2()\n        }\n        if (config.auth?.serviceName) {\n          // Load the service specified in the config\n          return $injector.get(config.auth.serviceName)\n        }\n        if (config.gigya?.enabled) {\n          return $injector.get('gigyaService')\n        }\n      }\n\n      loading.store.subscribe(() => {\n        // TODO: Handle 401's generically, including specific IDP auth codes\n        const unauthorizedErrors = loading.selectors.getErrorsByProperty('error', 40102)\n        const tokenExpiryErrors = loading.selectors.getErrorsByProperty('error', 40103)\n\n        // Show error modal if any `40102` unauthorized errors have been thrown\n        if (unauthorizedErrors.length) {\n          errorModalService\n            .open(\n              unauthorizedErrors[0].error.message || config.lang.defaultErrorMessage,\n              'OK',\n              null\n            )\n            .then(() => {\n              scope.logout()\n            })\n        } else if (tokenExpiryErrors.length) {\n          // Show error modal if any `40103` refresh token expiry errors have been thrown\n          errorModalService.open(config.lang.defaultErrorMessage, 'OK', null).then(() => {\n            scope.logout()\n          })\n        }\n      })\n\n      auth.store.subscribe(() => {\n        const user = auth.selectors.getUser()\n\n        // Check if the user object has changed\n        const hasUserChanged = !angular.equals(user, scope.user)\n\n        // Check if the context of the user object has changed\n        if (user && user.context && scope.user && scope.user.context) {\n          const hasContextChanged = !angular.equals(\n            _.omit(user.context, ['session_token']),\n            _.omit(scope.user.context, ['session_token'])\n          )\n          if (hasContextChanged) {\n            $rootScope.$broadcast('auth', CONTEXT_ACTIONS.CONTEXT_UPDATED)\n          }\n        }\n\n        /**\n         * When we log out, the auth service sets `auth.user` to `null`.\n         *\n         * However, when we broadcast a `null` user to the app,\n         * a bunch of errors are thrown as the app always expects a user to be present.\n         *\n         * We work around this by only broadcasting the `userUpdated` event when the user is not `null`.\n         *\n         * This works fine, as the app is reloaded soon after being logged out.\n         */\n        if (user && hasUserChanged) {\n          // Update the scoped user\n          scope.user = user\n\n          if (scope.user.context && scope.user.context.intent === 'instore') {\n            body.addClass('list-mode')\n          } else {\n            body.removeClass('list-mode')\n          }\n\n          if (scope.user.status === 'trial') {\n            localStorageService.deprecatedSet(\n              'trialCartIntent',\n              scope.getCurrentShoppingMode() || scope.user.context.intent\n            )\n          }\n\n          $rootScope.$broadcast('auth', USER_ACTIONS.USER_UPDATED, scope.user)\n\n          unataCommService.send({\n            eventType: unataCommService.EventType.USERPROFILE,\n            payload: {\n              first_name: scope.user.first_name,\n              last_name: scope.user.last_name,\n              address: scope.user.delivery_address,\n              phone: scope.user[scope.user.primary_number_key],\n              email: scope.user.email,\n            },\n          })\n        }\n      })\n\n      const body = angular.element($document[0].body)\n\n      // This is required because of circular dependencies\n      let registrationService\n      const getRegistrationService = () => {\n        return registrationService || $injector.get('registrationService')\n      }\n      scope.onlyCateringEnabled = () => {\n        return (\n          config.shoppingSelector.catering.exists &&\n          !config.shoppingSelector.delivery.exists &&\n          !config.shoppingSelector.pickup.exists &&\n          !config.shoppingSelector.instore.exists\n        )\n      }\n\n      scope.setContext = function (fields) {\n        const finalFields = { ...fields }\n\n        // Update shopping_mode if intent is set\n        if (finalFields.intent && !finalFields.shopping_mode) {\n          if (scope.onlyCateringEnabled()) {\n            finalFields.shopping_mode = SHOPPING_MODES.CATERING\n          } else {\n            finalFields.shopping_mode = finalFields.intent\n          }\n        }\n\n        if (finalFields?.intent === SHOPPING_MODES.CATERING) {\n          finalFields.intent =\n            config.shoppingSelector[finalFields.intent]?.behaveAs || SHOPPING_MODES.PICKUP\n        }\n\n        // Eager update context\n        auth.actions.updateUserLocal({ context: finalFields })\n\n        return ngPromise\n          .wrapper(auth.promiseActions.updateUserContext)(finalFields)\n          .then(() =>\n            $rootScope.$broadcast('auth', CONTEXT_ACTIONS.CONTEXT_UPDATED, auth.selectors.getUser())\n          )\n      }\n\n      /**\n       * Updates the user context *intent* (*shopping_mode* is also updated in setContext)\n       *\n       * @returns {Promise}\n       */\n      scope.setIntent = intent => {\n        return scope.setContext({ intent })\n      }\n\n      scope.getContext = auth.selectors.getUserContext\n\n      scope.getParamsFromAddress = (address, postalCodeKey) => {\n        // Context uses `deliveryPostalCode`, everything else uses `delivery_postal_code`\n        return config.enableMultipleDeliveryAddresses ||\n          config.shoppingContextProcess.delivery.requireFullAddress\n          ? {\n              address_id: address.id || '',\n              // Some address objects have deliveryPostalCode instead of postal_code\n              [postalCodeKey]: address.postal_code || address.deliveryPostalCode || '',\n              city: address.city || '',\n              province: address.province || '',\n              province_short: address.province_short || '',\n              // Some address objects have street_address instead of address1\n              street_address: address.address1 || address.street_address || '',\n            }\n          : {\n              address_id: '',\n              // Some address objects have deliveryPostalCode instead of postal_code\n              [postalCodeKey]: address.postal_code || address.deliveryPostalCode || '',\n              city: '',\n              province: '',\n              street_address: '',\n            }\n      }\n\n      scope.getContextFromAddress = address =>\n        scope.getParamsFromAddress(address, 'deliveryPostalCode')\n      scope.getUrlParamsFromAddress = address =>\n        scope.getParamsFromAddress(address, 'delivery_postal_code')\n\n      scope.isDeliveryContextInvalid = () => {\n        const context = scope.getContext()\n        // Return true if delivery mode and postal code is missing or multiple addresses and no address_id\n        return (\n          context.intent === 'delivery' &&\n          (!context.deliveryPostalCode ||\n            (config.enableMultipleDeliveryAddresses &&\n              !(context.address_id && addressList.getAddressFromId(context.address_id))))\n        )\n      }\n\n      scope.getAddressFromContext = auth.selectors.getAddressFromContext\n\n      // Skip Address Entry page if gigya profile is enabled AND\n      // context is pickup or context is delivery and multiple addresses are disabled.\n      scope.shouldUseGigyaAddressEdit = () =>\n        config.gigya.enabled &&\n        config.gigya.enableProfileEdit &&\n        (scope.user.context.intent === 'pickup' || !config.enableMultipleDeliveryAddresses)\n\n      // This will give you the previous context if the context has been updated otherwise, will return null.\n\n      // eslint-disable-next-line no-multi-assign\n      const iFns = (scope.intent = {\n        toString: () => scope.getContext().intent,\n        pickup: () => iFns.toString() === 'pickup',\n        delivery: () => iFns.toString() === 'delivery',\n        inStore: () => iFns.toString() === 'instore',\n      })\n\n      scope.getStore = auth.selectors.getStore\n      scope.userStoreSupportsPickup = auth.selectors.userStoreSupportsPickup\n      scope.userStoreSupportsDelivery = auth.selectors.userStoreSupportsDelivery\n      scope.getSessionId = auth.selectors.getSessionId\n      scope.updateUser = auth.promiseActions.updateUserLocal\n\n      /**\n       * Returns the user current shopping mode, including *catering*\n       * @returns {string}\n       */\n      scope.getCurrentShoppingMode = () => getCurrentShoppingMode(scope.getContext(), config)\n\n      // Validate an address for the chosen fulfillment type\n\n      scope.validateFulfillmentContactInfo = function (fulfillmentType, contactInfo) {\n        if (!contactInfo.delivery_address) {\n          return false\n        }\n        if (fulfillmentType === 'delivery') {\n          return (\n            contactInfo.delivery_address.first_name &&\n            contactInfo.delivery_address.last_name &&\n            contactInfo.delivery_address.address1 &&\n            contactInfo.delivery_address.city &&\n            contactInfo.delivery_address.province &&\n            contactInfo.delivery_address.postal_code &&\n            contactInfo.primary_number_key &&\n            contactInfo[contactInfo.primary_number_key]\n          )\n        }\n        if (fulfillmentType === 'pickup') {\n          return (\n            contactInfo.delivery_address.first_name &&\n            contactInfo.delivery_address.last_name &&\n            contactInfo.primary_number_key &&\n            contactInfo[contactInfo.primary_number_key] &&\n            _.find(config.deliveryAddressPhoneNumberFields, field => {\n              return field.key === contactInfo.primary_number_key\n            })\n          )\n        }\n\n        return false\n      }\n\n      // Creates a new user session\n      const createSession = () => {\n        const userSession = $q.defer()\n\n        auth.promiseActions\n          .createUserSession({\n            // eslint-disable-next-line no-useless-concat\n            binary: `${mobileService.isMobile ? 'mobile' : 'web'}-` + `ecom`,\n            binary_version: config.version,\n            is_retina: false,\n            os_version: navigator.platform,\n            pixel_density: window.devicePixelRatio.toPrecision(2),\n            push_token: '',\n            // eslint-disable-next-line no-restricted-globals\n            screen_height: screen.height,\n            // eslint-disable-next-line no-restricted-globals\n            screen_width: screen.width,\n          })\n          .then(userSession.resolve)\n\n          // Error POSTing a session\n          .catch(error => {\n            // Clear session token and retry creating a new user session if we get back a 401 error for the user_sessions POST\n            captureMessage(\n              `Error creating session. Status: \"${error?.status}\". Message: \"${\n                error?.message || error\n              }\"`\n            )\n            utils.sessionToken.getToken().then(token => {\n              if (error && error.status === 401 && token) {\n                // Clear the old token & try creating a new session\n                utils.sessionToken.removeToken().then(() => {\n                  createSession()\n                    // If the session is created succesfully after clearing the token, resolve\n                    .then(userSession.resolve)\n                    // Otherwise, reject\n                    .catch(userSession.reject)\n                })\n              } else {\n                // If the session still fails after clearing the token (401 + !sessionToken.token), or any other error is caught, reject\n                const message = `Error creating user session: ${error}`\n                console.error(message)\n                userSession.reject(message)\n              }\n            })\n          })\n\n        return userSession.promise\n      }\n\n      const createTrialUser = (payload = {}) =>\n        ngPromise\n          .wrapper(auth.promiseActions.createTrialUser)(payload)\n          .catch(error => {\n            const message = `Error creating new trial user: ${error}`\n            console.error(message)\n            throw message\n          })\n\n      // `scope.initializeUser` flow:\n      // 1. Create a user session (if that fails, retry with a new session token)\n      // 2. Fetch the user\n      //    a) If existing logged-in or trial user exists, update user with the context/store/zip overrides provided\n      //    b) If no existing user exists, create a new user with the context/store/zip overrides provided\n      // On resolve, this method promises to return a user that is ready to be used by the rest of the application\n      scope.initializeUser = getUserOverridePayload => {\n        const initializedUser = $q.defer()\n\n        createSession()\n          // User session created\n          .then(() => {\n            scope\n              .fetch()\n\n              // Existing user found, return it\n              .then(initializedUser.resolve)\n\n              // No existing user found\n              .catch(error => {\n                if (getUserOverridePayload) {\n                  // Generate override data to use while creating new trial user (will return empty payload if no overrides)\n                  getUserOverridePayload()\n                    // Create the new trial user\n                    .then(createTrialUser)\n                    .then(initializedUser.resolve)\n                    .catch(error2 => {\n                      const message = `Error creating user with overrides provided in URL: \"${error}\", \"${error2}\"`\n                      console.error(message)\n\n                      initializedUser.reject(message)\n                    })\n                } else {\n                  // Create the new trial user\n                  createTrialUser().then(initializedUser.resolve).catch(initializedUser.reject)\n                }\n              })\n          })\n\n          // User session could not be created\n          .catch(initializedUser.reject)\n\n        // Send event that the user is logged in, either as a new or returning trialUser, or as a returning logged-in user\n        return initializedUser.promise.then(scope.sendLoggedInMessage).catch(error => {\n          captureMessage(`Unable to create user session: ${error?.message || error}`)\n          errorModalService\n            .open(\n              'Your session could not be created, please reload and try again',\n              lang.values.reload,\n              null,\n              'Invalid Session'\n            )\n            .then(() => {\n              window.location.reload()\n            })\n        })\n      }\n\n      // Initialize a user or session.\n\n      scope.init = function () {\n        if (!scope.user) {\n          return scope.initializeUser()\n        }\n        return scope.fetch()\n      }\n\n      scope.getProfile = ngPromise.wrapper(auth.promiseActions.getUserProfile)\n\n      // Log in a user\n      scope.isLoggingInDuringCheckout = false\n      scope.login = function (identifier, password, socialAccount, loginContext, recaptcha) {\n        // Record the trial user information before dispatching Login action because\n        // auth.store.subscribe will proactively update scope.user\n        const trialUserStore = scope.user.store\n        const trialUserIntent = scope.user.context.intent\n        const trialUserShoppingMode = scope.user.context.shopping_mode\n        // Set isLoggingInDuringCheckout flag so we don't update the user's cart to a wrong state\n        // during checkout due to USER_UPDATED events broadcasted to cart service. Instead, fetch\n        // the cart after context and store_id is settled and based on USER_LOGGED_IN event\n        if ($state.includes('main.checkout')) {\n          scope.isLoggingInDuringCheckout = true\n        }\n        return auth.promiseActions\n          .login(identifier, password, socialAccount, recaptcha)\n          .then(\n            // Handle a successful login\n            () =>\n              scope.handlePostLogin(\n                !!socialAccount,\n                loginContext,\n                trialUserStore,\n                trialUserIntent,\n                trialUserShoppingMode\n              ),\n            // Handle a login error\n            error => {\n              let errorMessage = config.lang.defaultErrorMessage\n\n              if (error) {\n                errorMessage = lang.getErrorMessage(error.error) || error.message\n              }\n\n              return $q.reject(errorMessage)\n            }\n          )\n          .finally(() => {\n            scope.isLoggingInDuringCheckout = false\n          })\n      }\n\n      scope.handlePostLogin = (\n        socialAccount,\n        loginContext,\n        trialUserStore,\n        trialUserIntent,\n        trialUserShoppingMode\n      ) => {\n        return auth.promiseActions\n          .getUser()\n          .then(user => {\n            // If logged in user does not have context intent then either use the non-logged in intent or the default.\n            if (_.isNil(user.context.intent) && !$state.includes('main.checkout')) {\n              const contextIntent = trialUserIntent || config.defaultShoppingContext\n\n              return scope.setContext({ intent: contextIntent })\n            }\n            if ($state.includes('main.checkout')) {\n              // When a user is in checkout section, once they are logged in, we do\n              // not want their context to change or their selected store.\n              // Additionally, we want to maintain their trial users cart.\n              // Just sending the context will set the store to the default... so\n              // don't do an unnecessary store update if the trialUserStore is default.\n              // Only works if a config defaultStoreID is set.\n              if (trialUserStore.id !== config.defaultStoreID) {\n                return scope\n                  .update({ store_id: trialUserStore.id })\n                  .then(updatedUser => {\n                    // Eagerly update store\n                    auth.actions.updateUserLocal({ store: updatedUser.store })\n                  })\n                  .then(() => {\n                    return scope.setContext({\n                      intent: trialUserIntent,\n                      shopping_mode: trialUserShoppingMode,\n                      storeNumber: trialUserStore.id,\n                    })\n                  })\n              }\n              return scope.setContext({\n                intent: trialUserIntent,\n                shopping_mode: trialUserShoppingMode,\n              })\n            }\n            scope.updateUser(user)\n            if ($state.current.name === 'main.changePassword') {\n              return $state.go('main.home')\n            }\n            return $q.resolve(user)\n          })\n          .then(anonymousIdService.updateBackendId)\n          .then(() => {\n            $rootScope.$broadcast('auth', USER_ACTIONS.USER_LOGGED_IN)\n            scope.sendLoggedInMessage(scope.user)\n          })\n          .then(() => {\n            // ReloadState only if previousState was set. Prevents loops for ry PII\n            // It will only be undefined when initial state loading was interrupted\n            // Additionally check that the user is not logging in from a Social Sign On link\n            if ($rootScope.previousState !== undefined && !socialAccount) {\n              $rootScope\n                .reloadState()\n                .then(() => {\n                  $rootScope.$broadcast(\n                    'auth',\n                    USER_ACTIONS.POST_USER_LOGGED_IN_STATE_RELOAD,\n                    loginContext\n                  )\n                })\n                .catch(() => {\n                  // There are cases where we transition to another state while we\n                  // perform the state reload, therefore, catch it and broadcast\n                  // the user has been logged in but no state reload was performed.\n                  $rootScope.$broadcast(\n                    'auth',\n                    USER_ACTIONS.POST_USER_LOGGED_IN_NO_STATE_RELOAD,\n                    loginContext\n                  )\n                })\n            }\n          })\n      }\n\n      scope.initializeContext = () => {\n        return ngPromise\n          .wrapper(auth.promiseActions.getUserContext)()\n          .then(fetchedContext => {\n            if (this.onlyCateringEnabled()) {\n              fetchedContext = {\n                ...fetchedContext,\n                shopping_mode: SHOPPING_MODES.CATERING,\n                intent: SHOPPING_MODES.PICKUP,\n              }\n            }\n            auth.actions.updateUserLocal({ context: fetchedContext })\n            $rootScope.$broadcast('auth', CONTEXT_ACTIONS.CONTEXT_UPDATED, auth.selectors.getUser())\n          })\n      }\n\n      // Log out a user\n      const postLogoutReload = ({ logoutFailed } = {}) => {\n        if (!logoutFailed && config.singleSignOn && config.singleSignOn.enabled) {\n          if (mobileService.isMobileApp()) {\n            const browserTab = $window.open(\n              config.singleSignOn.slsEndpoint,\n              'Logout',\n              'transitionstyle=crossdissolve,zoom=no'\n            )\n            browserTab.show()\n          } else {\n            $window.location.assign(config.singleSignOn.slsEndpoint)\n          }\n        } else if (config.returnToHomeOnLogout) {\n          if (!$location.$$html5) {\n            $window.location.assign($state.href('main.home'))\n          } else {\n            $window.history.pushState({}, '', $state.href('main.home'))\n          }\n          $window.location.reload()\n        } else {\n          $window.location.reload()\n        }\n      }\n\n      const oneCartLogout = function () {\n        // oneCart logout flow is a little different from the regular logout flow\n        // the difference is that oneCart flow redirects to PBI as an end-result\n        // documentation about this flow could be found at https://docs.google.com/document/d/1svNSjPgaUM3DL5TRu67mj3nzsQXTxgsgc4bm8ZD4SGk/edit\n        // this is a WIP document.\n        // Please add any new/missing functionality to this doc\n\n        return authService.api.auth.getOneCartSignoutLink().then(response => {\n          auth.promiseActions\n            .logout()\n            .then(() => anonymousIdService.clearId())\n            .then(() => {\n              const payload = {\n                authenticated: false,\n              }\n              unataCommService.send({\n                eventType: unataCommService.EventType.LOGGEDOUT,\n                payload,\n              })\n            })\n            // This will return a promise that will resolve only on cordova.\n            // On non-cordova it will redirect to OneCart.\n            .then(_ =>\n              oneCartService.redirectToPBI(`${response.location}`, '', {\n                action: OneCartActions.LOGOUT,\n                method: 'GET',\n              })\n            )\n            // Log the user out from the IAB if Native OneCart is enabled. When Native OneCart is enabled\n            // the `redirectToPBI` will not log the user out from the InAppBrowser Single Sign-On session.\n            .then(\n              () =>\n                config.oneCart.nativeOneCartEnabled &&\n                isCapacitor() &&\n                isNativeBridgePluginAvailable() &&\n                getRegistrationService().hasOptionalAuthService() &&\n                getRegistrationService().open(AUTH_ACTIONS.LOGOUT)\n            )\n            .then(options => !options?.skipPostLogoutReload && isMobileApp() && postLogoutReload())\n            .catch(responseOrError => {\n              const proceedWithReload = responseOrError?.status.toString()[0] !== '5' // Prevent infinite reloads when server goes down\n              if (proceedWithReload) {\n                postLogoutReload({ logoutFailed: true })\n              }\n            })\n            .finally(() => {\n              if ($window.analytics) {\n                $window.analytics.reset()\n              }\n            })\n        })\n      }\n\n      scope.logout = () => {\n        // Broadcast before actually logging out so we still have user data\n        $rootScope.$broadcast('auth', 'userLoggingOut')\n        if (oneCartService.enabled()) return oneCartLogout()\n\n        return auth.promiseActions\n          .logout()\n          .then(() => anonymousIdService.clearId())\n          .then(() => {\n            const payload = {\n              authenticated: false,\n            }\n\n            unataCommService.send({\n              eventType: unataCommService.EventType.LOGGEDOUT,\n              payload,\n            })\n          })\n          .then(\n            () =>\n              getRegistrationService().hasOptionalAuthService() &&\n              getRegistrationService().open(AUTH_ACTIONS.LOGOUT)\n          )\n          .then(options => !options?.skipPostLogoutReload && postLogoutReload())\n          .catch(responseOrError => {\n            const proceedWithReload = responseOrError?.status.toString()[0] !== '5' // Prevent infinite reloads when server goes down\n            if (proceedWithReload) {\n              postLogoutReload({ logoutFailed: true })\n            }\n          })\n          .finally(() => {\n            if ($window.analytics) {\n              $window.analytics.reset()\n            }\n          })\n      }\n\n      // Fetch updated user data from the api\n      scope.fetch = ngPromise.wrapper(auth.promiseActions.getUser)\n\n      // Update the logged in user\n      scope.update = ngPromise.wrapper(auth.promiseActions.updateUser)\n\n      // Update the logged in user's PII\n      scope.updateProfile = ngPromise.wrapper(auth.promiseActions.updateUserProfile)\n\n      scope.reloadIfUserChanged = () => {\n        const currentAuth = scope.user && scope.user.status\n        auth.promiseActions.getUser().then(user => {\n          const newAuth = user && user.status\n          if (currentAuth !== newAuth) {\n            anonymousIdService\n              .updateBackendId()\n              .then(() => {\n                $rootScope.$broadcast('auth', USER_ACTIONS.USER_LOGGED_IN)\n                scope.sendLoggedInMessage(scope.user)\n              })\n              .then($rootScope.reloadState)\n          }\n        })\n      }\n\n      // Listen for a 'logout' message from unataComm to logout of a user's session\n      unataCommService.listen(unataCommService.EventType.LOGOUT, () => {\n        scope.logout()\n      })\n\n      // Listen for a 'authenticated-user' message from unataComm to retrieve the authenticated user\n      unataCommService.listen(unataCommService.EventType.AUTHENTICATEDUSER, () => {\n        scope.sendLoggedInMessage(scope.user)\n      })\n\n      // Listening for a 'set-catering-context' message from client (this is a temporary fix until deep linking is complete)\n      // This will only be used from Sprouts synced footer\n      unataCommService.listen(unataCommService.EventType.SETCATERINGCONTEXT, () => {\n        scope.setContext({ intent: 'pickup' }).then(() => {\n          $state.go('main.home', null, { reload: true })\n        })\n      })\n\n      // Listening for a 'unata-available-store-contexts' message from client\n      unataCommService.listen(unataCommService.EventType.GETAVAILABLESTORECONTEXTS, () => {\n        scope.sendAvailableStoreContexts(scope.user)\n      })\n\n      // Listening for a 'unata-get-shopping-context' message from client\n      unataCommService.listen(unataCommService.EventType.GETSHOPPINGCONTEXT, () => {\n        scope.sendCurrentShoppingContext(scope.user)\n      })\n\n      // Listening for a 'unata-get-user-profile' message from client\n      unataCommService.listen(unataCommService.EventType.GETUSERPROFILE, () => {\n        scope.sendUserProfile()\n      })\n\n      // Determine the users primary loyaltyCard and sends a notification message regarding newly authenticated user.\n      // This function is also used to provide updated user info so this event may be fired at any time.\n      scope.sendLoggedInMessage = user => {\n        userService.getLoyaltyCards().then(() => {\n          user = user || scope.user\n          if (!user) return\n\n          const primaryCard = userService.getPrimaryLoyaltyCard()\n          const payload = {\n            authenticated: user.status !== 'trial',\n            userId: user.id,\n            firstName: user.status === 'trial' ? 'Trial User' : user.first_name || '',\n            primaryLoyaltyCard: primaryCard || null,\n            loyaltyCards: userService.loyaltyCards,\n            store: storesService.simplifyStoreDetails(user.store),\n          }\n\n          unataCommService.send({ eventType: unataCommService.EventType.LOGGEDIN, payload })\n        })\n\n        return user\n      }\n\n      scope.sendAvailableStoreContexts = user => {\n        const payload = {\n          has_delivery: user.store.has_delivery && user.store.show_delivery,\n          has_pickup: user.store.has_pickup && user.store.show_pickup,\n        }\n\n        unataCommService.send({\n          eventType: unataCommService.EventType.AVAILABLESTORECONTEXTS,\n          payload,\n        })\n      }\n\n      scope.sendCurrentShoppingContext = user => {\n        if (!user) return\n\n        const payload = {\n          shopping_context: user.context && user.context.intent,\n        }\n\n        unataCommService.send({\n          eventType: unataCommService.EventType.SHOPPINGCONTEXT,\n          payload,\n        })\n      }\n\n      // Listen for the UPDATESTORE event from the unataComm service\n      unataCommService.listen(unataCommService.EventType.UPDATESTORE, event => {\n        storesService.fetch().then(mystores => {\n          let store\n\n          if (event.data.payload.store_id) {\n            store = _.find(mystores, { id: `${event.data.payload.store_id}` })\n          } else {\n            store = _.find(mystores, { ext_id: `${event.data.payload.ext_id}` })\n          }\n\n          if (store) {\n            // Update the users store and send an event when successful\n            scope.update({ store_id: store.id }).then(() => {\n              scope.sendLoggedInMessage(scope.user)\n            })\n          }\n        })\n      })\n\n      // Sends a Unata Comm message that the user has updated their store.\n      scope.sendUserUpdatedStore = user => {\n        const payload = {\n          store: storesService.simplifyStoreDetails(user.store),\n        }\n\n        unataCommService.send({\n          eventType: unataCommService.EventType.USERUPDATEDSTORE,\n          payload,\n        })\n      }\n\n      // Determine the profile info for an authenticated user\n      scope.sendUserProfile = () => {\n        this.getProfile().then(user => {\n          let payload\n          if (user.status === 'trial') {\n            payload = {\n              error: 'This is a trial user, therefore no profile information is available',\n            }\n          } else {\n            payload = {\n              first_name: user.first_name,\n              last_name: user.last_name,\n              address: user.delivery_address,\n              phone: user.mobile_phone_number,\n              email: user.email,\n            }\n          }\n          unataCommService.send({ eventType: unataCommService.EventType.USERPROFILE, payload })\n        })\n      }\n\n      scope.getUserFullName = () => {\n        if (scope.user.first_name || scope.user.last_name) {\n          return [scope.user.first_name, scope.user.last_name].filter(value => !!value).join(' ')\n        }\n\n        return null\n      }\n    }\n  )\n\n  .run(\n    (\n      $rootScope,\n      $state,\n      Restangular,\n      anonymousIdService,\n      auth,\n      config,\n      errorModalService,\n      importIcAccountService,\n      lang,\n      localStorageService,\n      registrationService,\n      userAnalytics\n    ) => {\n      $rootScope.$on(\n        '$stateChangeError',\n        (_event, toState, toParams, fromState, fromParams, error = {}) => {\n          const errorData = error.data || error\n          if (errorData.error === 40304) {\n            // If trying to access PII after session timeout, force user to login\n            registrationService.promptLogin(\n              toState.name,\n              toParams,\n              fromState.name,\n              fromParams,\n              lang.values.loginToContinue\n            )\n          } else if (error.status === 500) {\n            // Prevent loop of contant repeated requests because of server errors.\n            errorModalService\n              .open(errorData.message || config.lang.defaultErrorMessage, 'Reload', 'Back To Home')\n              .then(() => {\n                window.location.reload()\n              })\n          }\n        }\n      )\n\n      // Prevent route changes for unregistered users on state change\n\n      $rootScope.$on('$stateChangeStart', (event, state, params, previousState, previousParams) => {\n        // Check if state requires registration and user is not registered\n\n        // Temporary code for onecart manually handling a deeplink is not something we should be doing\n        // See https://instacart.atlassian.net/browse/ENT-30964 for long term solution\n        const isOneCartOrderLookup = state.name === 'main.account.orderic'\n        if (isOneCartOrderLookup) {\n          localStorage.setItem('icOrderId', params.id)\n          localStorageService.deprecatedSet(\n            'icOrderQuery',\n            params.add_to_order ? { add_to_order: '' } : {}\n          )\n        }\n\n        if (state.data?.requireRegistered && auth.user?.status === USER_STATUSES.TRIAL) {\n          event.preventDefault() // Stop the state change for now\n\n          // Open login / registration modal\n          // setTimeout to let the event.preventDefault() change the location url back\n          setTimeout(() => {\n            const loginContext = isOneCartOrderLookup\n              ? LOGIN_CONTEXTS.REDIRECT_ONECART_ORDER_STATUS\n              : LOGIN_CONTEXTS.UNREGISTERED_ROUTE_CHANGE\n\n            registrationService\n              .open('login', null, null, null, null, params.subscription_code, loginContext)\n              .then(() => {\n                if (state.data.requireICAccountLink) {\n                  $rootScope.$broadcast(\n                    'auth',\n                    'requiredLink',\n                    state,\n                    params,\n                    previousState,\n                    previousParams\n                  )\n                } else {\n                  handleNewLogin(state, params)\n                }\n              })\n              .catch(() => {\n                // Cancelled login / registration, return home if not on a valid state\n                if (!$state.current.name) {\n                  $state.go('main.home')\n                }\n              })\n              .finally(() => {\n                // Remove loading indicator\n                $rootScope.isAppLoading = false\n              })\n          }, 1)\n        }\n      })\n\n      const handleNewLogin = (state, params) => {\n        anonymousIdService.updateBackendId().then(() => {\n          // Redirect trial users that login to the review cart page, as their cart may have changed.\n          if ($state.includes('main.checkout')) {\n            $state.go('main.checkout.cart')\n          } else {\n            // Successfully logged in / registered, continue to requested state\n            $state.go(state.name, params).then(() => {\n              importIcAccountService.openModal(LOGIN_CONTEXTS.UNREGISTERED_ROUTE_CHANGE)\n            })\n          }\n        })\n      }\n\n      Restangular.setErrorInterceptor(response => {\n        // Handle session expiration causing a 401 error\n        if (response.status === HTTP_ERRORS.UNAUTHORIZED) {\n          switch (response.data.error) {\n            case HTTP_ERRORS.SESSION_EXPIRED_ERROR:\n              errorModalService\n                .open(\n                  response.message || response.data\n                    ? response.data.message\n                    : null || config.lang.defaultErrorMessage,\n                  'OK',\n                  null\n                )\n                .then(() => {\n                  userAnalytics.logUserForcedLogout({\n                    type: 'expired_session',\n                  })\n                  auth.logout()\n                })\n              break\n            case HTTP_ERRORS.REFRESH_TOKEN_ERROR:\n              errorModalService.open(config.lang.expiredTokenErrorMessage, 'OK', null).then(() => {\n                userAnalytics.logUserForcedLogout({\n                  type: 'refresh_token',\n                })\n                auth.logout()\n              })\n              break\n          }\n        }\n      })\n    }\n  )\n\n  // Intercept HTTP requests\n\n  .factory('JWTInterceptor', function () {\n    return {\n      request: cfg => {\n        // Add authorization header if session token should be used\n        // and is a require to our api\n        if (utils.sessionToken.shouldUseToken() && cfg.url.indexOf(apiPrefix) !== -1) {\n          return utils.sessionToken.getToken().then(token => {\n            if (token) {\n              cfg.headers.Authorization = `Bearer ${token}`\n            }\n\n            return cfg\n          })\n        }\n\n        return cfg\n      },\n    }\n  })\n\n  .config($httpProvider => {\n    $httpProvider.interceptors.push('JWTInterceptor')\n  })\n","import angular from 'angular'\n\nconst backButtonListener = () => {\n  // This is used for disabling the back button. Adding an event listener disables the\n  // default handling of the event.\n  // eslint-disable-next-line no-console\n  console.log(\n    'Back button was pressed. Back button is currently disabled by adding an event listener'\n  )\n}\n\nconst addBackButtonEventListener = () => {\n  // This event is only valid on Android.\n  document.addEventListener('backbutton', backButtonListener)\n}\n\nconst removeBackButtonEventListener = () => {\n  document.removeEventListener('backbutton', backButtonListener)\n}\n\nexport default angular\n  .module('barcodeScannerServicesModule', [])\n  .service(\n    'barcodeScanner',\n    function barcodeScanner(\n      $document,\n      $state,\n      $timeout,\n      Restangular,\n      errorModalService,\n      mobileService\n    ) {\n      const service = this\n      const SCANNING_SUPPORTED = window.cordova && window.cordova.plugins.barcodeScanner\n\n      $document[0].body.className += ` ${SCANNING_SUPPORTED ? '' : 'no-'}barcode-scanner`\n\n      service.isSupported = function () {\n        return SCANNING_SUPPORTED\n      }\n\n      service.scan = function (callback, errorback) {\n        const pluginOptions = {\n          resultDisplayDuration: 0,\n        }\n        const openScanner = function () {\n          if (window.navigator.notification && window.navigator.notification.beep) {\n            // a11y - let user know barcode scanner open with audible beep notification\n            setTimeout(() => {\n              // no explicit callback available for when the barcode camera opened with this cordova plugin, so we rely on a timeout to attempt to sync beep with camera open\n              window.navigator.notification.beep(1)\n            }, 1700)\n          }\n          window.cordova.plugins.barcodeScanner.scan(callback, errorback, pluginOptions)\n        }\n\n        if (SCANNING_SUPPORTED) {\n          openScanner()\n        } else {\n          errorback('Barcode scanning is not supported on this device.')\n        }\n      }\n\n      service.search = function () {\n        // Pressing the backbutton on android can sometimes trigger a back event twice here.\n        // This is not an issue with the gesture back. Adding an event listener disables the\n        // default handling of the event. So we add it here and remove it some time after the\n        // home route is transitioned to if the scanning is cancelled else we remove it immediately\n        addBackButtonEventListener()\n        service.scan(\n          result => {\n            // result contains:\n            // result.text - the code\n            // result.format - the type of code (UPC_A, QR, etc..)\n            // result.cancelled - the user backed out and didn't scan anything (True/False)\n            if (!result.cancelled) {\n              removeBackButtonEventListener()\n              Restangular.one('storeproduct_scans')\n                .customPOST({ upc: result.text })\n                .then(response => {\n                  if (response.store_product && response.store_product.id) {\n                    $state.go('main.product', { id: response.store_product.id })\n                  } else {\n                    $state.go('main.barcodeNotFound')\n                  }\n                })\n            } else {\n              $state\n                .go('main.home')\n                .then(() => {\n                  $timeout(removeBackButtonEventListener, 250)\n                })\n                .catch(removeBackButtonEventListener)\n            }\n          },\n          error => {\n            removeBackButtonEventListener()\n\n            let errorTitle = 'Scanning failed'\n            let errorBody = error\n\n            if (error === 'Illegal access') {\n              errorTitle = 'Access Required'\n              errorBody = `To scan barcodes, please allow ${mobileService.appName} permission to take pictures and record video.`\n            }\n\n            errorModalService.open(errorBody, 'Ok', null, errorTitle).then(() => {\n              $state.go('main.home')\n            })\n          }\n        )\n      }\n    }\n  )\n","import angular from 'angular'\nimport getApiPrefix from '@app/utils/getApiPrefix'\nimport urlParser from '@app/utils/urlParser'\n\nconst apiPrefix = getApiPrefix()\n\nexport default angular\n  .module('canvasServicesModule', [])\n  .service('canvas', function canvas($http, Restangular) {\n    const service = this\n\n    // Log interaction for user_events\n    service.logInteraction = function (content) {\n      if (content._links && content._links.interaction) {\n        $http.post(apiPrefix + content._links.interaction.href, content._links.interaction.data)\n      }\n    }\n    // Log impression for user_events\n    service.logImpression = function (content) {\n      if (content && content._links && content._links.impression) {\n        $http.post(apiPrefix + content._links.impression.href, content._links.impression.data)\n      }\n    }\n    // Log pageviews of a page specified\n    service.logPageView = function (endpoint) {\n      return Restangular.all('user_events').all(endpoint).post({})\n    }\n  })\n  .directive('contentHref', function () {\n    return {\n      scope: {\n        contentHref: '=',\n      },\n      controller($scope, $element, $state, config, mobileService, utilService) {\n        const unwatch = $scope.$watch('contentHref', value => {\n          if (value && $scope.contentHref && $scope.contentHref.target) {\n            const isExternalLink = !utilService.isLinkInternal($scope.contentHref.target.url)\n\n            if ($scope.contentHref.target.type === 'url') {\n              if (isExternalLink) {\n                $element.attr('href', $scope.contentHref.target.url)\n              } else {\n                const parsedUrlParams = urlParser($scope.contentHref.target.url)\n                $element.attr(\n                  'href',\n                  utilService.getPrependHashIfNeeded(\n                    parsedUrlParams.pathname + parsedUrlParams.search\n                  )\n                )\n              }\n              if (config.openExternalLinksNewTab && isExternalLink) {\n                $element.attr('target', '_blank')\n              }\n            } else {\n              switch ($scope.contentHref.target.type) {\n                case 'collection':\n                  $element.attr(\n                    'href',\n                    $state.href('main.shop.collection', {\n                      collection_id: $scope.contentHref.target.collection.id,\n                    })\n                  )\n                  break\n\n                case 'product':\n                  $element.attr(\n                    'href',\n                    $state.href('main.product', { id: $scope.contentHref.target.product.id })\n                  )\n                  break\n              }\n            }\n\n            unwatch()\n          }\n        })\n      },\n    }\n  })\n  .directive('contentAlt', function () {\n    return {\n      scope: {\n        contentAlt: '=',\n      },\n      controller($scope, $element) {\n        // a11y - used to update the alt attribute for linked images to indicate\n        // to screenreader users the purpose of the image link\n        const unwatch = $scope.$watch('contentAlt', value => {\n          const target = value && $scope.contentAlt && $scope.contentAlt.target\n          if (target) {\n            switch (target.type) {\n              case 'collection':\n                if (target.collection.description) {\n                  $element.attr('alt', target.collection.description)\n                }\n                break\n              case 'product':\n                if (target.product.description) {\n                  $element.attr('alt', target.product.description)\n                }\n                break\n            }\n\n            unwatch()\n          }\n        })\n      },\n    }\n  })\n","import { box, randomBytes } from 'tweetnacl'\nimport naclUtil from 'tweetnacl-util'\n\nfunction toUTF8Array(str) {\n  const utf8 = []\n  for (let i = 0; i < str.length; i += 1) {\n    let charcode = str.charCodeAt(i)\n    if (charcode < 0x80) utf8.push(charcode)\n    else if (charcode < 0x800) {\n      utf8.push(0xc0 | (charcode >> 6), 0x80 | (charcode & 0x3f))\n    } else if (charcode < 0xd800 || charcode >= 0xe000) {\n      utf8.push(0xe0 | (charcode >> 12), 0x80 | ((charcode >> 6) & 0x3f), 0x80 | (charcode & 0x3f))\n    }\n    // surrogate pair\n    else {\n      i += 1\n      // UTF-16 encodes 0x10000-0x10FFFF by\n      // subtracting 0x10000 and splitting the\n      // 20 bits of 0x0-0xFFFFF into two halves\n      charcode = 0x10000 + (((charcode & 0x3ff) << 10) | (str.charCodeAt(i) & 0x3ff))\n      utf8.push(\n        0xf0 | (charcode >> 18),\n        0x80 | ((charcode >> 12) & 0x3f),\n        0x80 | ((charcode >> 6) & 0x3f),\n        0x80 | (charcode & 0x3f)\n      )\n    }\n  }\n  const u8 = new Uint8Array(utf8.length)\n  utf8.forEach((charCode, index) => (u8[index] = charCode))\n\n  return u8\n}\n\nfunction convertUint8ArrayToBinaryString(u8Array) {\n  let i\n  const len = u8Array.length\n  let b_str = ''\n  for (i = 0; i < len; i += 1) {\n    b_str += String.fromCharCode(u8Array[i])\n  }\n  return b_str\n}\n\nfunction convertBinaryStringToUint8Array(bStr) {\n  let i\n  const len = bStr.length\n  const u8_array = new Uint8Array(len)\n  for (i = 0; i < len; i += 1) {\n    u8_array[i] = bStr.charCodeAt(i)\n  }\n  return u8_array\n}\n\nconst encryptorFactory = () => {\n  const keyPair = box.keyPair()\n  const publicKeyBinaryString = convertUint8ArrayToBinaryString(keyPair.publicKey)\n\n  class Encryptor {\n    constructor() {\n      this.externalKey = undefined\n    }\n\n    get publicKey() {\n      // Base64 encoded public key\n      return btoa(publicKeyBinaryString)\n    }\n\n    setExternalKey(externalBase64BinaryStringPublicKey) {\n      const externalBinaryStringPublicKey = atob(externalBase64BinaryStringPublicKey)\n      this.externalKey = convertBinaryStringToUint8Array(externalBinaryStringPublicKey)\n    }\n\n    decrypt(message) {\n      const formattedValidBase64Message = message.replace(/_/g, '/').replace(/-/g, '+')\n      const combinedMessageNonce = atob(formattedValidBase64Message)\n      const u8Nonce = convertBinaryStringToUint8Array(combinedMessageNonce.slice(0, 24))\n      const u8Message = convertBinaryStringToUint8Array(combinedMessageNonce).slice(24)\n      const uint8Message = box.open(u8Message, u8Nonce, this.externalKey, keyPair.secretKey)\n      return naclUtil.encodeUTF8(uint8Message)\n    }\n\n    encrypt(message) {\n      const u8Nonce = randomBytes(box.nonceLength)\n      const u8Message = toUTF8Array(message)\n      const u8EncryptedMessage = box(u8Message, u8Nonce, this.externalKey, keyPair.secretKey)\n      const binaryNonce = convertUint8ArrayToBinaryString(u8Nonce)\n      const binaryMessage = convertUint8ArrayToBinaryString(u8EncryptedMessage)\n      return btoa(binaryNonce + binaryMessage)\n    }\n  }\n\n  return Encryptor\n}\n\nexport default encryptorFactory\n","import request from '@app/utils/request'\nimport { GetRxDetailsParams, GetRxDetailsResponse } from './types'\n\nexport const getRxDetails = (body: GetRxDetailsParams) =>\n  request<GetRxDetailsResponse>(`/cart/rx/rx_item_details`, { body, method: 'POST' })\n","import { ShoppingListItem } from '@app/types/shoppingList'\nimport EncryptorFactory from '@app/utils/rx/encryptorFactory'\nimport { getRxDetails } from './api'\nimport { DecryptedRxMessage, GetRxDetailsResponse } from './types'\n\nexport const parseDetails = (details: DecryptedRxMessage) => {\n  const parsedDetail: Record<string, string> = {}\n  Object.keys(details)?.forEach((key: string) => {\n    parsedDetail[key] = details[key].name\n  })\n\n  return parsedDetail\n}\n\nexport const obfuscationHelper = async (rx_items: ShoppingListItem[]) => {\n  const Encryptor = EncryptorFactory()\n  const messageEncryptor = new Encryptor()\n\n  const payload = {\n    k: messageEncryptor.publicKey,\n    rx_item_id_mapping: rx_items.map(rx_item => {\n      return {\n        ic_item_id: rx_item.store_product.id,\n        prescription_id: rx_item.ext_data?.prescription_id ?? '',\n      }\n    }),\n  }\n\n  const rx_details: GetRxDetailsResponse = await getRxDetails(payload)\n\n  if (!rx_details) {\n    return {}\n  }\n\n  const { message, external_public_key } = rx_details\n\n  if (message && external_public_key) {\n    messageEncryptor.setExternalKey(external_public_key)\n    const jsonMessage = messageEncryptor.decrypt(message)\n    const details: DecryptedRxMessage = JSON.parse(jsonMessage)\n    return parseDetails(details)\n  }\n\n  return {}\n}\n","import angular from 'angular'\n\nexport default angular\n  .module('InvalidCartItemsDisplayControllerModule', [])\n  .controller('invalidCartItemsDisplayController', function ($scope, validateResponse) {\n    $scope.validateResponse = validateResponse\n  })\n","import angular from 'angular'\nimport { eventEmitter, EVENT_TYPES } from '@app/utils/eventEmitter'\nimport policyTemplate from './views/policy.html'\n\nexport default angular\n  .module('PolicyServiceModule', [])\n  .service(\n    'policyService',\n    function policyService(\n      $injector,\n      $rootScope,\n      $state,\n      $uibModal,\n      $window,\n      auth,\n      config,\n      lang,\n      legacyModalService\n    ) {\n      'ngInject'\n\n      const service = this\n\n      service.open = function () {\n        legacyModalService.closeOpenModals()\n\n        const modal = $uibModal.open({\n          template: policyTemplate,\n          controller() {},\n          controllerAs: '$ctrl',\n          keyboard: true,\n          backdrop: 'static',\n        })\n\n        return modal.result\n      }\n\n      // Listen for events outside of Angular app\n      // We need a better way to do this\n      // Going to avoid rewriting/introducing more code for now\n      eventEmitter.on(EVENT_TYPES.MODAL_OPEN_POLICY, ({ tab }) => {\n        service.open(tab)\n      })\n    }\n  )\n","import angular from 'angular'\n\nexport default angular\n  .module('IwsRegulationAlertModalServiceModule', [])\n  .service(\n    'iwsRegulationAlertModalService',\n    function iwsRegulationAlertModalService($uibModal, $window, auth, config, localStorageService) {\n      const service = this\n\n      service.open = function (product) {\n        auth.user.status === 'trial'\n          ? $window.sessionStorage.setItem('firstIWSAlcoholicProductAdded', true)\n          : localStorageService.setItem('firstIWSAlcoholicProductAdded', true)\n        return $uibModal.open({\n          template:\n            '<react-iws-regulation-alert-modal on-cancel=\"(cancel)\" on-continue=\"(continue)\" store-product=\"product\" />',\n          controller: [\n            '$scope',\n            'cartService',\n            ($scope, cartService) => {\n              $scope.continue = () => {\n                $scope.$close()\n              }\n              $scope.cancel = () => {\n                cartService.updateItemQuantity(product, 0)\n                $scope.$close()\n              }\n              $scope.product = product\n            },\n          ],\n          backdrop: 'static',\n          keyboard: true,\n        }).result\n      }\n    }\n  )\n","/* eslint-disable max-lines */\n\nimport _ from 'lodash'\nimport angular from 'angular'\nimport { captureException } from '@sentry/browser'\n\nimport {\n  cart as enterpriseCartService,\n  list as enterpriseListService,\n  product as enterpriseProductService,\n  shoppingList as shoppingListService,\n} from '@instacart/enterprise-services'\nimport { eventEmitter, EVENT_TYPES } from '@app/utils/eventEmitter'\nimport { CART_TYPES } from '@app/angular/constants/cart'\nimport { HTTP_ERRORS } from '@app/angular/constants/httpErrors'\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\nimport {\n  ANALYTICS,\n  EVENTS,\n  SOURCES,\n} from '@app/angular/services/modules/analytics/analyticsConstants'\nimport alcoholValidationErrorModalTemplate from '@app/angular/services/templates/alcoholValidation/alcoholValidationErrorModal.html'\nimport { isRxProduct } from '@instacart/enterprise-services/product/utils'\nimport {\n  getRxItemsList,\n  getItemDisplayName,\n} from '@instacart/enterprise-services/shopping-list/_common/utils'\nimport { getProductFulfillmentRetailer } from '@app/utils/banners'\nimport { obfuscationHelper } from '@app/services/rx/utils'\nimport InvalidCartItemsDisplayTemplate from '../../components/shared/invalidCartItemsDisplay/invalidCartItemsDisplay.html'\nimport InvalidCartItemsDisplayControllerModule from '../../components/shared/invalidCartItemsDisplay/invalidCartItemsDisplay.controller'\nimport CatalogCategoriesServiceComponentModule from '../../components/shop/services/catalogCategoriesService'\nimport RegistrationServiceModule from '../../components/registration/registrationService'\nimport PolicyServiceModule from '../../components/policy/policyService'\nimport IwsRegulationAlertModalServiceModule from '../../components/iwsRegulationAlertModal/iwsRegulationAlertModalService'\n\nexport default angular\n  .module('cartServiceModule', [\n    InvalidCartItemsDisplayControllerModule.name,\n    CatalogCategoriesServiceComponentModule.name,\n    RegistrationServiceModule.name,\n    PolicyServiceModule.name,\n    IwsRegulationAlertModalServiceModule.name,\n  ])\n  .service(\n    'cartService',\n    function cartService(\n      $q,\n      $rootScope,\n      $state,\n      $uibModal,\n      $uibModalStack,\n      $window,\n      Restangular,\n      analytics,\n      analyticsHelper,\n      auth,\n      catalogCategoriesService,\n      config,\n      configurableProductService,\n      eComLightService,\n      ebtCardService,\n      errorModalService,\n      instacartCustomerLinkModalService,\n      iwsRegulationAlertModalService,\n      lang,\n      localStorageService,\n      policyService,\n      productDetailsModal,\n      rateApp,\n      registrationService,\n      reservationService,\n      rxUpSellService,\n      shoppingListCache,\n      shoppingSelectorService,\n      unataCommService\n    ) {\n      const service = this\n      let endpoint\n      service.currentEnterpriseService = null\n\n      service.TIMESLOT_UNAVAILABLE_ERROR = new Error('The selected timeslot is no longer available')\n\n      /**\n       * Creates an object that will hold cart items grouped by cart type:\n       *\n       * {\n       *   grocery: [],\n       *   catering: [],\n       *   ...\n       * }\n       */\n      service.itemsGroupedByCartType = Object.values(CART_TYPES).reduce((obj, cartType) => {\n        obj[cartType] = []\n        return obj\n      }, {})\n\n      /**\n       * This attribute was created to hold the cart total returned by the\n       * cart validate call. It's currently being used by the *getCartFinalTotal* method\n       */\n      service.cartFinalTotal = null\n\n      service.finalTaxTotal = null\n\n      service.updateMessage = null\n\n      service.isSubstitutionNotesOpen = false\n\n      service.obfuscatedRxItems = {}\n\n      // Map cart types to category strings for displaying items based on cart type.\n      service.cartTypeToCategoryMapping = {\n        [CART_TYPES.GROCERY]: [],\n        [CART_TYPES.CATERING]: [],\n      }\n\n      service.isInstacartOrder = cart => {\n        return Boolean(cart.order?.ext_data?.instacart_order_url)\n      }\n\n      // Listening for every time the user context intent changes and changing the API endpoint if the user switches between instore list mode\n      // and not instore list mode (cart mode). Changing endpoint between cart and user-list.\n      const updatePreviewTimeslots = notifyOnError => {\n        const cartId = service.getCartId(service.getCurrentCartType())\n        reservationService.updateTimeslotPreview(cartId, notifyOnError)\n      }\n\n      $rootScope.$on('auth', (event, action, user) => {\n        if (action === 'userUpdated' && !auth.isLoggingInDuringCheckout) {\n          const oldEndpoint = endpoint\n\n          if (user && user.context && user.context.intent === SHOPPING_MODES.INSTORE_LIST) {\n            endpoint = '/user_lists/default'\n            service.currentEnterpriseService = enterpriseListService\n          } else {\n            endpoint = '/cart'\n            service.currentEnterpriseService = enterpriseCartService\n          }\n\n          // If endpoint has changed, fetch the cart.\n          if ((oldEndpoint !== endpoint && oldEndpoint !== undefined) || !service.cart) {\n            service.fetch().then(() => updatePreviewTimeslots(false))\n          }\n        } else if (action === 'userLoggedIn') {\n          service\n            .fetch()\n            .then(() => updatePreviewTimeslots(false))\n            .then(() => {\n              // check for if rx upsell should be open on redirected sso cart call\n              if (rxUpSellService.rxSSO && service.cartHasRxItem()) {\n                analytics.logSegmentEvent('rx.upsell_user_loggedin', {\n                  hasRxItem: service.cartHasRxItem(),\n                  fromSSO: rxUpSellService.rxSSO,\n                })\n\n                rxUpSellService.open(\n                  service.removeRxItems,\n                  service.fetch,\n                  getRxItemsList(service.cart?.items)[0].rx_deliverable_context\n                )\n              }\n            })\n        } else if (action === 'contextUpdated') {\n          updatePreviewTimeslots(false)\n        }\n      })\n\n      // Provide a more efficient way to watch for changes\n      // to the cart elsewhere in the app\n      service.updateTimestamp = function () {\n        service.lastUpdated = new Date().getTime()\n      }\n\n      // Saves cart into service and updates timestamp\n      const updateCart = newCart => {\n        service.cart = newCart\n        service.updateTimestamp()\n        service.sendUnataCommCartMessage()\n\n        service.getCategorizedProductsAndCategories().then(categorizedProductsAndCategories => {\n          shoppingListCache.setCache({\n            cart: service.cart,\n            categorizedProductsAndCategories,\n          })\n        })\n      }\n\n      // Checks if trial cart intent changed after logging in\n      // and shows the shopping context selector if so.\n      service.showSelectorIfTrialCartIntentChanged = () => {\n        const trialCartIntent = localStorageService.deprecatedGet('trialCartIntent')\n\n        if (auth.user.status === 'trial' || trialCartIntent === null) {\n          return\n        }\n\n        const currentIntent = auth.getCurrentShoppingMode() || auth.getContext().intent\n        const userCartIntent = localStorageService.deprecatedGet('userCartIntent')\n\n        if (currentIntent !== trialCartIntent || userCartIntent !== trialCartIntent) {\n          shoppingSelectorService.open('shoppingContext')\n        }\n\n        localStorageService.deprecatedRemove('userCartIntent')\n        localStorageService.deprecatedRemove('trialCartIntent')\n      }\n\n      // Fetches trialCartInstance if not in a trial session and logs both the\n      // trial and current cart identifiers.\n      service.logCartMergeAnalytics = function (cart) {\n        const trialCartInstance = localStorageService.deprecatedGet('trialCartInstance')\n        if (auth.user.status === 'trial' || trialCartInstance == null) {\n          return\n        }\n\n        const defaults = {\n          [SOURCES.SUCCESS]: true,\n          [SOURCES.USER]: auth.user || null,\n          [SOURCES.CART]: cart,\n        }\n\n        const helperPayload = analyticsHelper.createPayload(defaults, [ANALYTICS.CART.ITEM_DETAILS])\n\n        const payload = {\n          source_cart_id: trialCartInstance,\n          target_cart_id: cart.cart_instance_id,\n          result_cart_items: helperPayload.item_details,\n          success: helperPayload.success,\n        }\n\n        analytics.logSegmentEvent(EVENTS.CART.CART_MERGE, payload)\n        localStorageService.deprecatedRemove('trialCartInstance')\n      }\n\n      // Retrieve the cart from the backend\n      // Will avoid duplicate calls to the API by checking service.isFetching\n      service.fetch = function () {\n        if (!service.isFetching) {\n          service.isFetching = true\n\n          service.cartFetchPromise = service.currentEnterpriseService.actions\n            .getShoppingList()\n            .then(cart => {\n              service.showSelectorIfTrialCartIntentChanged()\n\n              // Log a cart merge event, if cart merge occurred.\n              service.logCartMergeAnalytics(cart)\n\n              // Initialize RX obfuscation here\n              service.setObfuscatedRxItems(cart)\n\n              updateCart(cart)\n              $rootScope.modifyingOrder = Boolean(cart.order)\n              $rootScope.modifyingInstacartOrder = Boolean(\n                cart.order && service.isInstacartOrder(cart)\n              )\n              return cart\n            })\n            .finally(() => {\n              service.isFetching = false\n            })\n        }\n\n        return service.cartFetchPromise\n      }\n\n      // Get the offer_progress from the cart for a given offerID\n      service.getOfferProgress = offerID =>\n        _.find(service.cart && service.cart.offer_progress, { id: offerID })\n\n      // Get all the offers from the cart with a type === 'cart'\n      service.getAllCartTypeOffers = () =>\n        _.filter(\n          service.cart && service.cart.offer_progress,\n          item => item.condition.type === 'cart'\n        )\n\n      /**\n       * Returns a list of item ids that have offers from offer progress.\n       * Memoized to be called repeatedly in views.\n       *\n       * @param {array} offerProgress - Offer progresses\n       */\n      service.getCartItemIdsFromOffers = _.memoize(offerProgress =>\n        (offerProgress || []).reduce(\n          (cartIds, offer) => [...Object.keys(offer.product_discounts || {}), ...cartIds],\n          []\n        )\n      )\n\n      /**\n       * Checks whether an offer exists for a given item.\n       *\n       * @param {object} item - Cart item to check for offer\n       */\n      service.itemHasOffer = item =>\n        service.getCartItemIdsFromOffers(service.cart?.offer_progress).includes(item.id)\n\n      // Fetch a cart or user-list item for the given product from the redux state.\n      service.getItem = (product, selectedConfiguration) =>\n        service.currentEnterpriseService.selectors.getItem(\n          product.store_product || product,\n          selectedConfiguration\n        )\n\n      // Fetch all items in the cart or user-list.\n      service.getItems = () => service.currentEnterpriseService.selectors.getItems()\n\n      // Remove an item\n      service.removeItem = function (product, selectedConfiguration, doNotSync) {\n        // For prep_style configurable product, set selectedConfiguration to null\n        // since they can be added from the product cell without a selected configuration.\n        if (selectedConfiguration && !selectedConfiguration[0]) {\n          selectedConfiguration = null\n        }\n        // Update the item quantity in redux state\n        service.currentEnterpriseService.actions.updateItemQuantity(\n          product.store_product || product,\n          0,\n          selectedConfiguration\n        )\n        // Update the angular cart object with updated item quantities.\n        service.cart.items = service.getItems()\n        const item = service.getItem(product.store_product || product, selectedConfiguration)\n        let promise\n        if (item) {\n          if (doNotSync !== true) {\n            service.updateTimestamp()\n            promise = service.sync().then(() => {\n              service.sendUnataCommCartMessage()\n              $rootScope.$broadcast('cartService', 'remove', item)\n            })\n          } else {\n            service.sendUnataCommCartMessage()\n            $rootScope.$broadcast('cartService', 'remove', item)\n          }\n\n          return promise\n        }\n      }\n\n      eventEmitter.on(EVENT_TYPES.REMOVE_ITEM_FROM_CART, (product, config) => {\n        service.removeItem(product, config)\n      })\n\n      service.removeItems = products => {\n        _.each(products, product => {\n          service.removeItem(\n            product,\n            product.product_config && product.product_config.options,\n            true\n          )\n        })\n        const promise = service.sync()\n        service.updateTimestamp()\n        return promise\n      }\n\n      // Add one to the quantity of an item\n      service.incrementItem = function (product, quantity, configuration) {\n        let selectedConfiguration\n\n        if (configuration) {\n          selectedConfiguration = configuration.options\n        }\n\n        const updatedQuantity =\n          service.getItem(product, selectedConfiguration).quantity + (quantity || 1)\n\n        service.updateItemQuantity(product, updatedQuantity, selectedConfiguration)\n      }\n\n      // Subtract one from the quantity of an item\n      service.decrementItem = function (product, quantity, configuration) {\n        let selectedConfiguration\n\n        if (configuration) {\n          selectedConfiguration = configuration.options\n        }\n\n        const updatedQuantity =\n          service.getItem(product, selectedConfiguration).quantity - (quantity || 1)\n\n        return service.updateItemQuantity(product, updatedQuantity, selectedConfiguration)\n      }\n\n      // Update the quantity of an item\n      service.updateItemQuantity = function (product, quantity, configuration) {\n        if (quantity < product.ordering_parameters.min) {\n          return {\n            action: service.updateActions.remove,\n            result: service.removeItem(product, configuration),\n          }\n        }\n        return {\n          action: service.updateActions.add,\n          result: service.addItem(product, quantity, configuration),\n        }\n      }\n\n      service.updateActions = {\n        add: 'add',\n        remove: 'remove',\n      }\n\n      eventEmitter.on(EVENT_TYPES.UPDATE_ITEM_QUANTITY, (product, quantity, config) => {\n        service.updateItemQuantity(product, quantity, config)\n      })\n\n      // Add a new item to the cart or user-list.\n      service.addItem = function (product, quantity, selectedConfiguration) {\n        // For prep_style configurable product, set selectedConfiguration to null\n        // since they can be added from the product cell without a selected configuration.\n        if (\n          selectedConfiguration &&\n          selectedConfiguration.length > 0 &&\n          !selectedConfiguration[0]\n        ) {\n          selectedConfiguration = null\n        }\n        // Update the item quantity in redux state\n        service.currentEnterpriseService.actions.updateItemQuantity(\n          product,\n          quantity,\n          selectedConfiguration\n        )\n        // Update the angular cart object with updated item quantities.\n        service.cart.items = service.getItems()\n\n        // If an iws product is added to cart, remember the initial time to show the iwsRegulationAlertModal. This modal should be shown once per cart for users\n        // Note: using localStorage for loggedin users and sessionStorage for else\n        if (\n          config.iwsRegulatedStates?.includes(auth.user.store.address.province) &&\n          !!getProductFulfillmentRetailer(\n            product,\n            auth.user?.store.store_banner?.ext_id,\n            config.multipleBanners\n          )\n        ) {\n          if (auth.user.status !== 'trial') {\n            localStorageService.getItem('firstIWSAlcoholicProductAdded').then(hasShownModal => {\n              if (!hasShownModal) iwsRegulationAlertModalService.open(product)\n            })\n          } else if (\n            auth.user.status === 'trial' &&\n            !$window.sessionStorage.getItem('firstIWSAlcoholicProductAdded')\n          ) {\n            iwsRegulationAlertModalService.open(product)\n          }\n        }\n\n        // Updated item from the redux state\n        const updatedItem = service.getItem(product.store_product || product, selectedConfiguration)\n        service.updateTimestamp()\n        const promiseResult = service.sync().then(() => {\n          service.sendUnataCommCartMessage()\n          // Broadcast the adding of this item to the nav cart controller so we can show the dropdown\n          $rootScope.$broadcast('cartService', 'add', updatedItem, quantity)\n        })\n\n        return promiseResult\n      }\n\n      eventEmitter.on(EVENT_TYPES.ADD_ITEM_TO_CART, (product, quantity, config) => {\n        service.addItem(product, quantity, config)\n      })\n\n      service.addItemConfigurable = function (product, quantity, selectedConfiguration) {\n        service.addItem(product, quantity, selectedConfiguration)\n        if ($uibModalStack.getTop()) {\n          $uibModalStack.dismissAll()\n        } else if ($rootScope.previousState && Boolean($rootScope.previousState.length)) {\n          $state.go($rootScope.previousState)\n        }\n      }\n\n      // Empty the cart by setting the quantity of all items to zero\n      service.clear = function () {\n        $rootScope.$broadcast('cartService', 'triggerClearModal')\n        errorModalService\n          .open('Are you sure you want to remove all items?', 'OK', 'Cancel', 'Confirm')\n          .then(\n            () => {\n              $rootScope.$broadcast('cartService', 'clearConfirm')\n\n              service.clearItems()\n            },\n            () => {\n              $rootScope.$broadcast('cartService', 'clearCancel')\n            }\n          )\n      }\n\n      service.clearItems = () => {\n        return service.currentEnterpriseService.actions\n          .removeShoppingList()\n          .then(updateCart)\n          .then(service.sync)\n          .then(() => service.sendUnataCommCartMessage())\n      }\n\n      // Delete checked items\n      service.deleteCheckedItems = () => {\n        $rootScope.$broadcast('cartService', 'triggerClearModal')\n        errorModalService\n          .open(\n            lang.values.removeCheckedItemsConfirmation,\n            lang.values.ok,\n            lang.values.cancel,\n            lang.values.confirm\n          )\n          .then(\n            () => {\n              $rootScope.$broadcast('cartService', 'clearConfirm')\n              const itemsToRemove = service.cart.items.filter(item => item.checked)\n              service.removeItems(itemsToRemove)\n            },\n            () => {\n              $rootScope.$broadcast('cartService', 'clearCancel')\n            }\n          )\n      }\n\n      // Uncheck all items\n      service.uncheckAllItems = () => {\n        service.currentEnterpriseService.actions.uncheckAllItems()\n        updateCart(service.currentEnterpriseService.selectors.getShoppingList())\n        service.sync()\n      }\n\n      /**\n       * Updates the context with fulfillment type and delivery address if needed\n       * (isTemporaryModify would usually appear in the context, but in some environments it\n       *  doesn't seem to stick, so we place it into local storage to be sure)\n       *\n       * @param { string } fulfillmentType\n       * @param { object } deliveryAddress\n       * @param { string } store_id\n       * @param { string | null } [isTemporaryModify] - String of the route, exit modify when outside of route\n       */\n      const updateContext = (\n        fulfillmentType,\n        deliveryAddress,\n        store_id,\n        isTemporaryModify = null\n      ) => {\n        let payload = {\n          intent: fulfillmentType,\n          storeNumber: store_id,\n        }\n\n        if (fulfillmentType === SHOPPING_MODES.DELIVERY) {\n          payload = { ...payload, ...auth.getContextFromAddress(deliveryAddress) }\n        }\n\n        localStorageService.deprecatedSet('isTemporaryModify', isTemporaryModify)\n\n        return auth.setContext(payload)\n      }\n\n      /**\n       * Updates the modify order status in the rootScope for a given *cart* object\n       * @param {object} cart\n       */\n      const updateModifyOrderStatus = cart => {\n        $rootScope.modifyingOrder = true\n        if (service.isInstacartOrder(cart)) {\n          $rootScope.modifyingInstacartOrder = true\n        }\n      }\n\n      /**\n       * Enters user into order modify mode\n       *\n       * @param {number} order - The order object\n       * @param {boolean} [goToCart] - True to redirect to the cart, or false if you intend custom\n       * @param {string | null} [isTemporaryModify] - String of the route, exit modify when outside of route\n       *\n       * Note: Generally goTOCart will be set to false when isTemporaryModify is set to true.\n       *       These flags are used in a process to jump to a specific section in checkout for modify.\n       */\n      service.enterModifyState = (order, goToCart = true, isTemporaryModify = null) => {\n        $rootScope.isAppLoading = true\n        localStorageService.deprecatedSet('preModifyContext', auth.getContext())\n        localStorageService.deprecatedSet('preModifyCartItems', service.cart.items)\n\n        return Restangular.one('/cart')\n          .one('modify_order')\n          .customPOST({ order })\n          .then(newCart => {\n            const { fulfillment_type, delivery_address, store_id } = order\n\n            return auth\n              .update({ store_id })\n              .then(() =>\n                updateContext(fulfillment_type, delivery_address, store_id, isTemporaryModify)\n              )\n              .then(() => updateCart(newCart))\n              .then(() => updateModifyOrderStatus(newCart))\n              .then(reservationService.fetch)\n              .then(() => goToCart && $state.go('main.checkout.cart'))\n          })\n          .catch(response => {\n            if (response?.data?.error === HTTP_ERRORS.PII_UNAUTHORIZED) {\n              // If PII has timed out\n              registrationService.promptLogin(\n                $state.current.name,\n                $state.params,\n                '',\n                '',\n                lang.values.loginToContinue\n              )\n            } else {\n              errorModalService.open(response?.data?.message, 'OK')\n            }\n          })\n          .finally(() => {\n            $rootScope.isAppLoading = false\n          })\n      }\n\n      // Modify an order\n      service.modifyOrder = order => {\n        errorModalService\n          .open(lang.values.modifyCartAlert, 'OK', 'Cancel', 'Confirm')\n          .then(() => service.enterModifyState(order))\n      }\n\n      /**\n       * Cancel modifying an order\n       *\n       * @param {string} [postRoute]   - Optional: If specified, go to a custom route\n       */\n      service.cancelOrderModification = (postRoute = 'main.account.orderHistory.order') => {\n        if (service.isCancellingOrderModification) return // Prevent double requests\n\n        const orderId = this.cart?.order?.id\n\n        // This no-id situation could occur if a cancel is requested after modification expired or\n        // two redirects occur simultaneously (i.e. triggered by a modal etc)\n        if (!orderId) {\n          // If no longer modifying and if temporary modify flag is set:\n          // Remove the flag to stop the triggering of repeated cancels\n          // (isTemporaryModify would usually appear in the context, but in some environments it\n          // doesn't seem to stick, so we place it into local storage to be sure)\n          const context = auth.getContext()\n          if (context.isTemporaryModify) {\n            localStorageService.deprecatedSet('isTemporaryModify', null)\n            return auth.setContext({ ...context, isTemporaryModify: null })\n          }\n\n          return $q.resolve()\n        }\n\n        $rootScope.isAppLoading = true\n        service.isCancellingOrderModification = true\n\n        return service\n          .resetToPreModContext()\n          .then(() => Restangular.one('/cart').one('modify_order').remove())\n          .then(newCart => updateCart(newCart))\n          .then(() => service.fetch())\n          .then(() => reservationService.fetch())\n          .then(() => service.resetToPreModCart())\n          .then(() => {\n            $rootScope.modifyingOrder = false\n            $rootScope.modifyingInstacartOrder = false\n            localStorageService.deprecatedSet('isTemporaryModify', null)\n\n            return $state.go(postRoute, { id: orderId }, { reload: true })\n          })\n          .finally(() => {\n            $rootScope.isAppLoading = false\n            service.isCancellingOrderModification = false\n          })\n      }\n\n      eventEmitter.on(EVENT_TYPES.CANCEL_ORDER_MODIFICATION, route => {\n        service.cancelOrderModification(route)\n      })\n\n      /**\n       * Put the cached cart items back into the cart and clear the cache.\n       * Should only be run when there is a cached cart\n       *\n       */\n      service.resetToPreModCart = () => {\n        const preModifyCartItems = localStorageService.deprecatedGet('preModifyCartItems')\n        if (preModifyCartItems) {\n          return service\n            .clearItems()\n            .then(() => service.loadListToCart(preModifyCartItems))\n            .finally(() => {\n              localStorageService.deprecatedSet('preModifyCartItems', null)\n            })\n        }\n        return Promise.resolve()\n      }\n\n      /**\n       * Put the cached context back to the current context\n       * Will try the context on the order if the cached copy is not there\n       *\n       */\n      service.resetToPreModContext = () => {\n        const preModifyContext = localStorageService.deprecatedGet('preModifyContext')\n        const { delivery_address, fulfillment_type, store_id } = this.cart?.order || {}\n\n        if (preModifyContext) {\n          return updateContext(\n            preModifyContext.intent,\n            preModifyContext,\n            preModifyContext.storeNumber,\n            null\n          ).finally(() => {\n            localStorageService.deprecatedSet('preModifyContext', null)\n          })\n        }\n        if (fulfillment_type && delivery_address && store_id) {\n          return updateContext(fulfillment_type, delivery_address, store_id, null)\n        }\n\n        return Promise.resolve()\n      }\n\n      service.loadListToCart = function (list) {\n        // list means this: [item1, item2], NOT our unata list object\n        $rootScope.isAppLoading = true\n\n        const invalidProducts = []\n\n        _.each(list, (item = {}) => {\n          const { actual_quantity, product_config, quantity, store_product } = item\n          const options = product_config && product_config.options\n\n          let configuration = null\n          if (product_config) {\n            configuration = configurableProductService.formatConfigForCart(store_product, options)\n          }\n\n          const existing = service.getItem(store_product, configuration)\n          if (existing) {\n            service.incrementItem(store_product, actual_quantity || quantity, product_config)\n          } else if (!product_config && store_product.product_config) {\n            invalidProducts.push(item)\n          } else if (store_product.status !== false) {\n            service.addItem(store_product, quantity || actual_quantity, options)\n          }\n        })\n\n        // If there are any invalid products in the list, users will have to add them manually\n        if (invalidProducts.length) {\n          invalidProducts.forEach(product =>\n            productDetailsModal.open(product.id, {\n              message: {\n                type: 'warn-light',\n                content: lang.values.productMissingInformationAlertMessage,\n              },\n            })\n          )\n        }\n\n        // The incrementItem & addItem calls above would have triggered a sync,\n        //  we can use the promise returned to detect when that sync is completed\n        return service\n          .sync()\n          .then(service.fetch)\n          .finally(() => {\n            $rootScope.isAppLoading = false\n            // prompt for app rating\n            if (\n              auth.getContext().intent !== 'instore' &&\n              config.mobileAppRate.callOnReOrderFromHistory\n            ) {\n              rateApp.promptAppReview()\n            }\n          })\n      }\n\n      service.isValidatingCart = null\n      const resetValidationPromise = (result, optError) => {\n        if (result) {\n          service.isValidatingCart.resolve(result)\n        } else {\n          service.isValidatingCart.reject(optError || result)\n        }\n        service.isValidatingCart = null\n      }\n\n      const _handleTimeslotExpirationError = response => {\n        errorModalService\n          .open(response.data?.message || response.message, 'OK', undefined, undefined, true)\n          .closed.then(() => resetValidationPromise(false, service.TIMESLOT_UNAVAILABLE_ERROR))\n      }\n\n      const _handleExternalFulfillmentProviderError = response => {\n        $uibModal\n          .open({\n            resolve: {\n              validateResponse: () => response,\n            },\n            controller: 'invalidCartItemsDisplayController',\n            template: InvalidCartItemsDisplayTemplate,\n            keyboard: false,\n            backdrop: 'static',\n          })\n          .closed.then(() => resetValidationPromise(false))\n      }\n\n      const _handleExternalAuthError = payload => {\n        instacartCustomerLinkModalService\n          .openModal()\n          .then(() => service.validateCart(payload))\n          .catch(() => $state.go('main.checkout.cart'))\n          .finally(() => resetValidationPromise(false))\n      }\n\n      const _handleAlcoholFulfillmentError = () => {\n        errorModalService\n          .openCustom(alcoholValidationErrorModalTemplate, { lang })\n          .closed.then(() => resetValidationPromise(false))\n      }\n\n      const _handleGenericErrors = response => {\n        errorModalService\n          .open(response.data?.message || response.message, 'OK', undefined, undefined, true)\n          .closed.then(() => resetValidationPromise(false))\n      }\n\n      const _handleCartValidateErrors = (response, payload) => {\n        if (\n          response.error === HTTP_ERRORS.EXT_FULFILLMENT_PROVIDER_ERROR &&\n          response.unavailable_item_ids?.length\n        ) {\n          _handleExternalFulfillmentProviderError(response)\n        } else if (\n          response.error === HTTP_ERRORS.EXTERNAL_AUTH_ERROR &&\n          config.instacart.enableAccountLinking\n        ) {\n          _handleExternalAuthError(payload)\n        } else if (response.error === HTTP_ERRORS.ALCOHOL_FULFILLMENT_ERROR) {\n          _handleAlcoholFulfillmentError(response)\n        } else if (response.error === HTTP_ERRORS.TIMESLOT_EXPIRATION_ERROR) {\n          _handleTimeslotExpirationError(response)\n        } else {\n          _handleGenericErrors(response)\n        }\n      }\n\n      const _handleValidateSuccess = cart => {\n        service.setCartFinalTotal(cart.total)\n        service.setFinalTaxTotal(cart.tax_total)\n        updateCart(cart)\n        resetValidationPromise(true)\n      }\n\n      service.validateCart = (payload = null) => {\n        if (service.isValidatingCart) {\n          return service.isValidatingCart.promise\n        }\n\n        service.isValidatingCart = $q.defer()\n\n        enterpriseCartService.promiseActions\n          .validateCart(payload)\n          .then(_handleValidateSuccess)\n          .catch(response => _handleCartValidateErrors(response, payload))\n\n        return service.isValidatingCart.promise\n      }\n\n      /**\n       * Updates the cart to reflect changes to the local state, and then appropriately\n       * updates the items in local state according to the data in the response\n       *\n       * @param {boolean} validate - wether it should trigger a cart validation after sync\n       * @param {object} validatePayload - cart validation payload\n       *\n       * @returns {Promise} - a promise which resolves when the api request has finished.\n       */\n      service.sync = ({ validate = false, validatePayload } = {}) => {\n        service.syncing = true\n        service.updateTimestamp()\n        return service.currentEnterpriseService.actions\n          .updateShoppingList(service.cart)\n          .then(remoteCart => {\n            try {\n              // Add new items added remotely\n              service.cart = remoteCart\n              service.cart.items = service.currentEnterpriseService.selectors.getItems()\n\n              // Populate obfuscated rx item state\n              service.setObfuscatedRxItems(service.cart)\n              service.updateTimestamp()\n\n              $rootScope.modifyingOrder = Boolean(remoteCart.order)\n              $rootScope.modifyingInstacartOrder = Boolean(\n                remoteCart.order && service.isInstacartOrder(remoteCart)\n              )\n\n              if (auth.user.status === 'trial') {\n                localStorageService.deprecatedSet(\n                  'trialCartInstance',\n                  service.cart.cart_instance_id\n                )\n              }\n\n              service\n                .getCategorizedProductsAndCategories()\n                .then(categorizedProductsAndCategories => {\n                  shoppingListCache.setCache({\n                    cart: service.cart,\n                    categorizedProductsAndCategories,\n                  })\n                })\n\n              return service.cart\n            } finally {\n              service.syncing = false\n              service.itemsAtLastSync = service.countItems()\n              service.itemsAtLastSyncForCartType = service.countItems(service.getCurrentCartType())\n            }\n          })\n          .then(() => {\n            validate && service.validateCart(validatePayload)\n          })\n          .catch(e => {\n            service.syncing = false\n            service.itemsAtLastSync = service.countItems()\n            service.itemsAtLastSyncForCartType = service.countItems(service.getCurrentCartType())\n\n            captureException(e)\n\n            errorModalService.open(\n              config.lang.defaultErrorMessage + config.lang.tryAgainPolite,\n              lang.values.ok,\n              null\n            )\n          })\n      }\n\n      service.setObfuscatedRxItems = cart => {\n        const rxItems = getRxItemsList(cart.items)\n\n        const requiresObfuscation = rxItems?.filter(\n          item =>\n            !Object.prototype.hasOwnProperty.call(service.obfuscatedRxItems, item.store_product.id)\n        )\n        if (requiresObfuscation.length > 0) {\n          obfuscationHelper(requiresObfuscation).then(obfuscatedMap => {\n            // merge existing state with new items\n            service.obfuscatedRxItems = { ...service.obfuscatedRxItems, ...obfuscatedMap }\n          })\n        }\n      }\n\n      // Count the number of items in the cart, ignoring subscriptions\n      service.countItems = function (type = null) {\n        const getItemQuantity = item => {\n          if (\n            item.store_product &&\n            (!item.store_product.product_type ||\n              item.store_product.product_type !== 'subscription') &&\n            enterpriseProductService.utils.isProductAvailable(item.store_product)\n          ) {\n            // When the item is a weighted product, just count the number of items to 1.\n            return item.store_product.order_by_weight\n              ? 1\n              : item.quantity / item.store_product.ordering_parameters.increment\n          }\n          return 0\n        }\n\n        const items = type\n          ? service.getCartTypeToItemsMap()[type]\n          : service.getCartTypeToItemsMap()[service.getCurrentCartType()]\n\n        if (!items) return 0\n\n        return items.reduce((count, item) => count + getItemQuantity(item), 0)\n      }\n\n      service.countCustomItems = () => service.getCustomItems().length\n\n      service.getCustomItems = () =>\n        _.filter(service.cart && service.cart.items, { item_type: 'pseudo_product' })\n\n      service.getNonCustomItems = () =>\n        _.reject(service.cart && service.cart.items, { item_type: 'pseudo_product' })\n\n      service.getCheckedItemsCount = () => {\n        return service?.cart?.items?.filter(item => item.checked)?.length\n      }\n\n      // Get list of all cart products, [] otherwise\n      // (and that are not pseudo/custom products - since pseudo products don't have a `store_product` key)\n      service.getAllStoreProductsInCart = () => {\n        return _.filter(\n          config.useMultiContextCart\n            ? // We should return all the items for MCOX because the products are relevant in every context now\n              service.cart?.items\n            : service.getCartTypeToItemsMap()[service.getCurrentCartType()],\n          item => item.store_product\n        )\n      }\n\n      // Get object with all categorized cart products grouped by associated category keys, UNCATEGORIZED otherwise\n      service.getAllStoreProductsByCategory = () =>\n        service\n          .getAllStoreProductsInCart()\n          .filter(item => item.store_product.product_type !== 'subscription')\n          .reduce((out, item) => {\n            const category = !enterpriseProductService.utils.isProductAvailable(item.store_product)\n              ? lang.values.currentlyUnavailable\n              : item.store_product?.categories?.[0]?.name || lang.values.uncategorizedCategory\n            return { ...out, [category]: [...(out[category] || []), item] }\n          }, {})\n\n      // Returns categorized, uncategorized products and those categories in sorted order\n      service.getCategorizedProductsAndCategories = () =>\n        catalogCategoriesService.fetchCategories().then(() => {\n          const { currentlyUnavailable, uncategorizedCategory, prescription } = lang.values\n          const rootCategories = _.map(catalogCategoriesService.rootCategories(), 'name')\n          rootCategories.unshift(uncategorizedCategory)\n          rootCategories.push(currentlyUnavailable)\n          rootCategories.push(prescription)\n\n          const productsByCategory = service.getAllStoreProductsByCategory()\n          const productCategories = _.keys(productsByCategory)\n\n          // Sorted categorized product categories by order of root categories\n          const orderedCategories = _.filter(\n            rootCategories,\n            rootCategory =>\n              _.findIndex(productCategories, productCategory => productCategory === rootCategory) >\n              -1\n          )\n\n          return { productsByCategory, orderedCategories }\n        })\n\n      // Get object with all cart products grouped by associated aisle, {} otherwise\n      // (excluding pseudo/custom products - since pseudo products don't have a `store_product` key)\n      service.getAllProductsByAisle = () => {\n        return _.groupBy(service.getNonCustomItems(), item => {\n          // Set aisle label to \"Aisle Unknown\" (or as defined in retailer config) if aisle is null\n          return item.store_product && item.store_product.aisle\n            ? item.store_product.aisle\n            : config.unknownAisleText\n        })\n      }\n\n      // Keep the trial user cart and use it to replace the logged in user's cart.\n      // When the user logs in, the cart is automatically merged on the backend.\n      // If we get here, we need to remove items that were not originally in\n      // the trial users cart.\n      service.sendUnataCommCartMessage = () => {\n        unataCommService.send({\n          eventType: unataCommService.EventType.CART,\n          payload: service.unataCommCartPayload(service.cart),\n        })\n      }\n\n      service.unataCommCartPayload = cart => {\n        const cartTotalNumber = Number(parseFloat(cart.product_total).toFixed(2))\n        const cartTotalCount = service.countItems()\n        return { cart: { total: cartTotalNumber, count: cartTotalCount } }\n      }\n\n      // Listening for a 'unata-get-cart' message from client\n      unataCommService.listen(unataCommService.EventType.GETCART, () =>\n        service.sendUnataCommCartMessage()\n      )\n\n      service.isCartBelowMin = () => {\n        const userHasEbtCardAndEbtItems =\n          config.ebt.enabled && ebtCardService.userHasEbtCard && service.cartHasEbtItem()\n        const cartMinimum = shoppingListService.commonUtils.getMinimumCartSpend()\n        const cartTotals = service.getCartTotals()\n\n        if (userHasEbtCardAndEbtItems) return true\n\n        return (\n          cartMinimum &&\n          cartTotals &&\n          cartTotals.pre_reward_program_discount_product_total < cartMinimum\n        )\n      }\n\n      service.getPlaceOrderButtonText = () => {\n        if ($rootScope.modifyingOrder) {\n          return lang.values.updateOrder\n        }\n        return service.getCurrentCartType() === CART_TYPES.CATERING\n          ? lang.values.checkoutSubmitInCatering\n          : lang.values.checkoutSubmit\n      }\n\n      // get the cart summary text by shopping context/cart type.\n      service.getCartSummaryTitleText = () => {\n        if (service.getCurrentCartType() === CART_TYPES.CATERING) {\n          return lang.values.pickupInStoreCatering\n        }\n\n        if (service.getCurrentCartType() === CART_TYPES.GROCERY) {\n          if (auth.getCurrentShoppingMode() === SHOPPING_MODES.PICKUP) {\n            return lang.values.pickupInstore\n          }\n\n          return lang.values.delivery\n        }\n      }\n\n      service.getUpSellProductsInCart = upsellProducts => {\n        const { items } = service.cart\n        if (!items.length) return []\n\n        const cartItemIds = items.map(item => item.id)\n        return analytics\n          .getProductListAnalytics(upsellProducts)\n          .filter(product => cartItemIds.includes(product.id))\n      }\n\n      /**\n       * Returns the *cart_id* for a given *cartType*\n       *\n       * @returns {Number}\n       */\n      service.getCartId = cartType => {\n        return this.cart?.ids?.[cartType] || this.cart?.id\n      }\n\n      /**\n       * Returns the *has_alcohol* for a given *cartType*\n       *\n       * @returns {Number}\n       */\n      service.getHasAlcohol = (cartType = '') => {\n        const alcoholFromCartType = this.cart?.carts?.[cartType || this.getCurrentCartType()]\n          ?.has_alcohol\n        return alcoholFromCartType ?? this.cart?.has_alcohol\n      }\n\n      /**\n       * Returns an array of all unique cart types the user has\n       *\n       * @returns {String[]}\n       */\n      service.getCartTypes = () => {\n        return Array.from(\n          new Set(\n            this.cart.items.reduce((items, item) => {\n              items.push(item.cart_type)\n              return items\n            }, [])\n          )\n        )\n      }\n\n      /**\n       * Returns an object of cart items grouped by cartType\n       *\n       * @returns {Object}\n       */\n      service.getCartTypeToItemsMap = () => {\n        /**\n         * Empty all cart type items while keeping the object reference in memory.\n         * Initially, this method was supposed to generate immutable data structures, but unfortunately\n         * Angular doesn't play too well with it.\n         *\n         * This was a way i've found to avoid the `10 $digest() iterations reached. Aborting!` while\n         * looping through items in the view depending on the user current cart type\n         */\n        Object.values(CART_TYPES).forEach(cartType => {\n          service.itemsGroupedByCartType[cartType].splice(\n            0,\n            service.itemsGroupedByCartType[cartType].length\n          )\n        })\n\n        if (service.cart) {\n          service.cart.items.forEach(item => {\n            if (item.cart_type) {\n              service.itemsGroupedByCartType[item.cart_type].push(item)\n            }\n          })\n        }\n\n        return service.itemsGroupedByCartType\n      }\n\n      /**\n       * Returns the *has_alcohol* for a given *cartType*\n       *\n       * @returns {Number}\n       */\n      service.getHasAlcohol = (cartType = '') => {\n        const alcoholFromCartType = this.cart?.carts?.[cartType || this.getCurrentCartType()]\n          ?.has_alcohol\n        return alcoholFromCartType ?? this.cart?.has_alcohol\n      }\n\n      /**\n       * Removes the rx items in the cart\n       *\n       * @returns {Promise}\n       */\n      service.removeRxItems = () => {\n        return service.removeItems(service.cart.items.filter(cartItem => isRxProduct(cartItem)))\n      }\n\n      /**\n       * Returns the user current cart type by checking the query param in the URL\n       * or the eComLight status\n       *\n       * @returns {string}\n       */\n      service.getCurrentCartType = () => {\n        if (!eComLightService.inEComLightMode) {\n          return CART_TYPES.GROCERY\n        }\n\n        const { shopping_mode } = auth.user.context\n\n        return shopping_mode === SHOPPING_MODES.CATERING ? CART_TYPES.CATERING : CART_TYPES.GROCERY\n      }\n\n      /**\n       * Returns whether a user can order online\n       *\n       * It will be true if at least one non-eComLight mode is available.\n       *\n       * @returns {Boolean}\n       */\n      service.canOrderOnline = () => {\n        const availableModes = [SHOPPING_MODES.DELIVERY, SHOPPING_MODES.PICKUP].filter(modeName => {\n          return config.shoppingSelector[modeName]?.exists\n        })\n\n        // Require both delivery and pickup to be enabled, since one of them is being used for eComLight\n        if (config.eComLight.enabled) {\n          return availableModes.length > 1\n        }\n\n        return availableModes.length > 0\n      }\n\n      /**\n       * Returns an object which maps categories to their corresponding cart type\n       *\n       * @returns {Object}\n       */\n      service.createCartTypeToCategoryMapping = () => {\n        let firstProductInCategory = null\n        const categorizedProducts = service.getAllStoreProductsByCategory()\n\n        Object.keys(categorizedProducts).forEach(function (category) {\n          firstProductInCategory = categorizedProducts[category][0]\n          if (firstProductInCategory) {\n            if (firstProductInCategory.cart_type === CART_TYPES.CATERING) {\n              service.cartTypeToCategoryMapping.catering.push(category)\n            } else {\n              service.cartTypeToCategoryMapping.grocery.push(category)\n            }\n          }\n        })\n      }\n\n      /**\n       * Returns whether or not the given category corresponds to the current cart type\n       *\n       * @param { string } category\n       *\n       * @returns {Boolean}\n       */\n      service.isCategoryForCurrentCartType = category => {\n        return service.cartTypeToCategoryMapping[service.getCurrentCartType()].includes(category)\n      }\n\n      /**\n       * Returns an object that contains the cart totals depending on the\n       * user current cart type\n       *\n       * @returns {Object}\n       */\n      service.getCartTotals = () => {\n        return service.cart?.cart_totals?.[service.getCurrentCartType()] || service.cart\n      }\n\n      /**\n       * Returns the product total for a specific cart type\n       *\n       * @returns {string}\n       */\n      service.getCartTotalForCurrentType = () => {\n        const total = service.getCartTotals()\n        return total?.product_total || 0\n      }\n\n      /**\n       * Returns the cart final total\n       *\n       * @returns {string}\n       */\n      service.getCartFinalTotal = () => {\n        return service.cartFinalTotal || service.getCartTotalForCurrentType()\n      }\n\n      /**\n       * Returns the final tax total\n       *\n       * @returns {string}\n       */\n      service.getFinalTaxTotal = () => {\n        return service.finalTaxTotal\n      }\n\n      /**\n       * Setter for the cart final total\n       *\n       * @param {string}\n       * @returns {undefined}\n       */\n      service.setCartFinalTotal = total => {\n        service.cartFinalTotal = total\n      }\n\n      /**\n       * Setter for the final tax total\n       *\n       * @param {string}\n       * @returns {undefined}\n       */\n      service.setFinalTaxTotal = total => {\n        service.finalTaxTotal = total\n      }\n\n      /**\n       * Determines if tipping is enabled or not\n       *\n       * @returns {Boolean}\n       */\n      service.isTippingEnabled = () => {\n        const { store } = auth.user\n        return Boolean(store[`tipping_${auth.getCurrentShoppingMode()}`])\n      }\n\n      /**\n       * Sets the cart tip to a percentage or absolute value\n       *\n       * @param { number } percentage\n       * @param { number } absolute\n       *\n       * @returns {Promise}\n       */\n      service.setTip = ({ percentage = null, absolute = null } = {}) => {\n        // eslint-disable-next-line no-restricted-globals\n        // eslint-disable-next-line no-restricted-globals\n        const isValidTipValue = val => val && !isNaN(parseFloat(val)) && isFinite(val)\n        if (service.isTippingEnabled()) {\n          service.cart.tip_percent = isValidTipValue(percentage)\n            ? percentage\n            : service.cart.tip_percent\n          service.cart.tip_total = isValidTipValue(absolute) ? absolute : service.cart.tip_total\n          return $q.resolve()\n        }\n        return $q.reject()\n      }\n\n      /**\n       * Determines if the cart has an EBT item\n       *\n       * @returns {Boolean}\n       */\n      service.cartHasEbtItem = () => {\n        return service.cart?.items.some(item => item.store_product?.usa_snap_eligible)\n      }\n\n      /**\n       * Determines if the cart has an RX item\n       *\n       * @returns {Boolean}\n       */\n      service.cartHasRxItem = () => {\n        return service.cart?.items.some(item => isRxProduct(item))\n      }\n\n      /**\n       * Removes all the subscriptions in the cart\n       *\n       * @returns {Promise}\n       */\n      service.removeSubscriptions = () => {\n        return service.removeItems(\n          service.cart.items.filter(\n            cartItem => cartItem.store_product.product_type === 'subscription'\n          )\n        )\n      }\n\n      service.getItemDescription = item => {\n        if (isRxProduct(item)) {\n          return service.obfuscatedRxItems[item.store_product.id] || item.store_product.name\n        }\n        return getItemDisplayName(item, config.hideSizeStringSideCart)\n      }\n\n      /**\n       * Returns the authorization amount of the user current cart.\n       * If the authorization amount is not present, it falls back to the FE calculation\n       *\n       * @returns {number}\n       */\n      service.getAuthorizationAmount = () => {\n        const { authBuffer } = config\n        const currentCartType = service.getCurrentCartType()\n        const { cart } = service\n\n        return (\n          cart.carts?.[currentCartType]?.authorization_amount ||\n          cart.authorization_amount ||\n          (cart.cart_totals?.[currentCartType]?.total || cart.total) * authBuffer\n        )\n      }\n\n      /**\n       * Returns the user cart instance ID\n       *\n       * @returns {string} - UUID for the cart_instance_id\n       */\n      service.getCartInstanceId = () => {\n        const currentCartType = service.getCurrentCartType()\n        const { cart } = service\n\n        return cart.carts?.[currentCartType]?.cart_instance_id || cart.cart_instance_id\n      }\n\n      service.removeSubscriptions = () => {\n        const subscriptions = []\n        service.cart.items.forEach(item => {\n          if (item.store_product.product_type === 'subscription') {\n            subscriptions.push(item)\n          }\n        })\n        return service.removeItems(subscriptions)\n      }\n\n      /**\n       * Gets the order delivery instructions from all possible sources\n       *\n       * @returns {{comment: string?, leaveUnattended: boolean?}}\n       */\n      service.getOrderDeliveryInstruction = () => {\n        const { carts, comment, leave_unattended, order } = service.cart\n\n        /*\n         * order?.leave_unattended comes from: GET cart modify\n         * cart.leave_unattended comes from: GET validate\n         * carts?.grocery?.leave_unattended comes from: GET/PUT cart\n         */\n        const leaveUnattended = order?.leave_unattended\n          ? order?.leave_unattended // Always go with the set value on modify\n          : !service.getHasAlcohol() && (leave_unattended ?? carts?.grocery?.leave_unattended)\n\n        return { comment, leaveUnattended }\n      }\n\n      /**\n       * Gets the order delivery instructions for order modification case only\n       *\n       * @returns {{comment: string?, leaveUnattended: boolean?}}\n       */\n      service.getModifyOrderDeliveryInstruction = () => {\n        const { comment, order } = service.cart\n        const leaveUnattended = Boolean(order?.leave_unattended) // GET cart modify\n        return { comment, leaveUnattended }\n      }\n\n      /**\n       * Synchronizes new values for delivery instructions into the cart\n       * @param {string}  comment\n       * @param {boolean} leaveUnattended\n       * @returns {Promise}\n       */\n      service.updateOrderDeliveryInstruction = (comment, leaveUnattended) => {\n        Object.assign(service.cart, {\n          comment,\n          leave_unattended: Boolean(!service.getHasAlcohol() && leaveUnattended),\n        })\n\n        return service.sync()\n      }\n\n      $rootScope.$on('cartRefresh', (_, onAfterFetch) => {\n        this.fetch().finally(() => {\n          onAfterFetch && onAfterFetch()\n        })\n      })\n    }\n  )\n  .run(\n    (\n      $location,\n      $rootScope,\n      $state,\n      $timeout,\n      Restangular,\n      auth,\n      cartService,\n      config,\n      errorModalService,\n      instacartService,\n      lang,\n      localStorageService\n    ) => {\n      const addToCart = () => {\n        const productId = $location.search().addToCart\n        if (productId) {\n          Restangular.one('store_products', productId)\n            .get()\n            .then(product => cartService.addItem(product))\n        }\n      }\n\n      let orderModificationModal = null\n\n      const checkModifyOrderStatus = () => {\n        if (\n          $rootScope.modifyingOrder &&\n          !cartService.cart?.order?.can_modify &&\n          !orderModificationModal\n        ) {\n          const {\n            orderModifyUnavailable,\n            ok,\n            error,\n            instacart: { viewOrderProgress },\n          } = lang.values\n          const cancelButton = cartService.isInstacartOrder(cartService.cart)\n            ? viewOrderProgress\n            : null\n\n          orderModificationModal = errorModalService.open(\n            orderModifyUnavailable,\n            ok,\n            cancelButton,\n            error,\n            true\n          )\n          orderModificationModal.result\n            .catch(() =>\n              instacartService.goToInstacartLink(cartService.cart.order.ext_data.pickup_status_url)\n            )\n            .finally(() => {\n              cartService.cancelOrderModification()\n              orderModificationModal = null\n            })\n        }\n      }\n\n      $rootScope.$on('$stateChangeSuccess', () => {\n        const currentStateName = $state.current?.name\n        const isCheckoutConfirmation = currentStateName === 'main.checkout.confirmation'\n        const context = auth.getContext()\n\n        // TODO: ENT-39451 - Do a proper fix, more details in the ticket\n        // This is here as $state.current?.name is undefined on the onEnter and resolve functions of the route\n        if (currentStateName === 'main.checkout') {\n          $state.go('main.checkout.cart')\n        }\n\n        // If this gets set to true, when the modify banner shows it will auto-cancel the modify\n        // We wait for the modify banner to ensure the cart/order state has been updated fully\n        // (isTemporaryModify would usually appear in the context, but in some environments it\n        // doesn't seem to stick, so we place it into local storage to be sure)\n        const isTemporaryModify = context.isTemporaryModify\n          ? context.isTemporaryModify\n          : localStorageService.deprecatedGet('isTemporaryModify')\n\n        $rootScope.isTemporaryModifyExpired =\n          isTemporaryModify &&\n          !isCheckoutConfirmation &&\n          !currentStateName.includes(isTemporaryModify)\n\n        addToCart()\n        // This timeout exists to prevent the modal from being dismissed automatically due to a state change,\n        // cancelling the order modification without notifying the user\n        if (!isCheckoutConfirmation) {\n          $timeout(() => checkModifyOrderStatus(), 1000)\n        }\n      })\n    }\n  )\n","import _ from 'lodash'\nimport angular from 'angular'\nimport { v4 as uuidv4 } from 'uuid'\n\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\nimport { ITEM_QUANTITY_IDENTIFIER } from '@app/angular/services/modules/analytics/analyticsConstants'\n\n// Exported for use if someone does not want to use the buffer - They can use cartAnalytics.itemChange\nexport const ACTIONS = {\n  ADD: 'ADD',\n  REMOVE: 'REMOVE',\n}\n\nconst PRODUCT_CONFIG_TYPES = {\n  PREP_STYLE: 'prep_style',\n}\n\nconst EVENTS = {\n  [ACTIONS.ADD]: 'store.add_to_cart',\n  [ACTIONS.REMOVE]: 'store.remove_from_cart',\n}\n\nconst BUFFER_FLUSH_TIMEOUT = 2000 // Flush the cart change buffer after this ms\n\n/* This html attribute is to indicate the root DOM element where the collection of\n   add-to-cart buttons are grouped together for calculating corner distance\n   purposes. */\nconst ANALYTIC_SCOPE_ATTR = 'data-analytic-scope'\n\n/**\n * The addItem and removeItem methods will buffer events and flush them when:\n *  1. A different product is added/removed\n *  2. The same product is added/removed instead of removed/added\n *  3. After 2 seconds of not adding or removing\n */\nexport default angular\n  .module('CartAnalyticsServiceModule', [])\n  .service('cartAnalytics', function ($timeout, analytics, auth, cartService) {\n    const service = this\n    let buffer = null\n\n    const analyticScopes = {}\n\n    service.createNewAnalyticScope = () => {\n      const scope = uuidv4()\n      analyticScopes[scope] = []\n      return scope\n    }\n\n    service.destroyAnalyticScope = scope => {\n      if (!analyticScopes) {\n        return\n      }\n      delete analyticScopes[scope]\n    }\n\n    /**\n     * Traverse up in the DOM tree until finding an element with an attr same as the value\n     * in ANALYTIC_SCOPE_ATTR. The element with this attr contains a grid of add-to-cart\n     * buttons that we want to track as a grid.\n     *\n     * @param {object} element    - The DOM element to start the traversal\n     *\n     * @returns {string}          - The scope identifier to find coordinates later\n     */\n    service.findAnalyticScope = element => {\n      while (element && element.hasAttribute && !element.hasAttribute(ANALYTIC_SCOPE_ATTR)) {\n        element = element.parentElement\n      }\n      if (element && element.hasAttribute(ANALYTIC_SCOPE_ATTR)) {\n        return element.getAttribute(ANALYTIC_SCOPE_ATTR)\n      }\n      return null\n    }\n\n    service.registerAddToCart = (scope, atc) => {\n      if (!scope || !analyticScopes[scope] || !analyticScopes[scope].push) {\n        return\n      }\n      analyticScopes[scope].push(atc)\n    }\n\n    /**\n     * Finds the coordinates of the clicked item within a collection. For example, clicking\n     * the forth item on the second row of the search results would return {x:3, y:1, corner:4}.\n     * The coordinates are 0-based. Corner is the manhattan distance to the origin.\n     *\n     * @param {string} scope      - The scope id generated by the createNewAnalyticScope above\n     * @param {number} index      - The index of the item clicked in the scope\n     *\n     * @returns {object}          - An object with properties \"x\", \"y\" and \"corner\". Returned\n     *                              undefined if index is undefined or scope not setup properly\n     */\n    service.getCornerDistanceInScope = (scope, index) => {\n      const cells = analyticScopes[scope]\n      if (!scope || !cells || index === undefined || !cells.length) {\n        return\n      }\n\n      /* This algorithm iterate through the add-to-cart buttons in the\n         pre-scanned scope, if the top property has not changed, we\n         assume the button is on the same row and increment the col.\n         If the top property increases, we increment row and reset col.\n      */\n      let i = 1\n      let lastTop = cells[0].getBoundingClientRect().top\n      let row = 0\n      let col = 0\n      while (i <= index && i < cells.length) {\n        const current = cells[i]\n        const { top } = current.getBoundingClientRect()\n        if (lastTop < top) {\n          row += 1\n          col = 0\n          lastTop = top\n        } else {\n          col += 1\n        }\n        i += 1\n      }\n      return { x: col, y: row }\n    }\n\n    /**\n     * @Private\n     * Buffers the current dataset so that the delta will be combined\n     *\n     * @param {object} [info]     - Object containing \"product, index, etc etc\" information\n     *                              (The action and quantity must not be contained here!)\n     * @param {*} action          - The action (add or remove) via constants\n     * @param {number} quantity   - Quantity of the item added to the cart\n     *\n     * If info is nullish, it will result in a buffer flush if the buffer is present\n     *\n     * @returns {undefined}\n     */\n    const _writeToBuffer = (info = null, action = null, quantity = 0) => {\n      if (!buffer) {\n        buffer = { info, action, quantity }\n      } else if (_.isEqual(buffer.info, info) && buffer.action === action) {\n        buffer.quantity += quantity\n      } else {\n        $timeout.cancel(buffer._timer)\n        this.itemChange({ ...buffer, ...buffer.info })\n        buffer = info ? { info, action, quantity } : null\n      }\n\n      if (buffer) {\n        $timeout.cancel(buffer._timer)\n        buffer._timer = $timeout(() => _writeToBuffer(), BUFFER_FLUSH_TIMEOUT)\n      }\n    }\n\n    /**\n     * @Private\n     * Calculates cart event quantities\n     *\n     * @param {object} cart     - Cart from the CartService\n     * @param {object} product  - The product that was actioned to the cart\n     * @param {number} quantity - Quantity of the item actioned to the cart\n     * @param {number} action   - The action constant\n     *\n     * @returns {undefined}\n     */\n    const _getCartQuantityDelta = (prevCart, prevCartItem, product, quantity, action) => {\n      const cartItem = cartService.getItem(product)\n      const isOrderedByWeight = product.order_by_weight\n      const deltaSign = action === ACTIONS.ADD ? '+' : '-'\n\n      // Weight selection is not incremental - *quantity* is the final quantity\n      if (isOrderedByWeight && cartItem) {\n        const isPrepStyle = product.product_config?.config_type === PRODUCT_CONFIG_TYPES.PREP_STYLE\n        let previousQuantity = prevCartItem?.quantity || 0\n        let delta = quantity\n\n        if (isPrepStyle) {\n          previousQuantity = prevCart.items\n            .filter(item => item.id === product.id)\n            .reduce((quantity, item) => item.quantity + quantity, 0)\n        } else if (previousQuantity !== 0 && quantity !== previousQuantity) {\n          delta = Math.abs(quantity - previousQuantity)\n        }\n\n        return {\n          delta: `${deltaSign}${delta}`,\n        }\n      }\n\n      const delta = `${deltaSign}${quantity}`\n\n      return {\n        delta,\n      }\n    }\n\n    /**\n     * @Private\n     * Generates the analytics payload\n     *\n     * @param {object} product       - The product that was added to the cart\n     * @param {number} quantity      - Quantity of the item added to the cart\n     * @param {number} index         - Position in in the list from where the product was added\n     * @param {string} location      - The originating location\n     * @param {object} locationValue - Info about the item involved in the location\n     * @param {number} action        - The action constant\n     *\n     * @returns {object}\n     */\n    const _getAnalyticsPayload = ({\n      product,\n      quantity,\n      prevCart,\n      prevCartItem,\n      index,\n      location,\n      locationValue,\n      action,\n      extraData,\n    }) => {\n      const { corner_distance } = extraData || {}\n      const { cart } = cartService\n      const { delta } = _getCartQuantityDelta(prevCart, prevCartItem, product, quantity, action)\n      const previousQuantity = prevCartItem?.quantity || 0\n      const default_uom = product.order_by_weight\n        ? ITEM_QUANTITY_IDENTIFIER.WEIGHTED_LB\n        : ITEM_QUANTITY_IDENTIFIER.UNWEIGHTED\n      const uom = product.display_uom ? product.display_uom : default_uom\n\n      const analyticsPayload = {\n        cart_id:\n          auth.getContext().intent !== SHOPPING_MODES.INSTORE_LIST && cart.cart_instance_id\n            ? cart.cart_instance_id\n            : cart.id,\n        uom,\n        source: location,\n        source_value: locationValue,\n        ...analytics.getProductInfoAnalytics(product, index, corner_distance),\n        ...extraData,\n      }\n\n      if (\n        uom === ITEM_QUANTITY_IDENTIFIER.WEIGHTED_LB ||\n        uom === ITEM_QUANTITY_IDENTIFIER.WEIGHTED_KG\n      ) {\n        analyticsPayload.delta_weight = delta\n        analyticsPayload.previous_weight = previousQuantity\n      } else {\n        analyticsPayload.delta = delta\n        analyticsPayload.previous_quantity = previousQuantity\n      }\n\n      let impressionData = {}\n      if (action === ACTIONS.ADD) {\n        // `cart_is_empty` is true if the cart was empty prior to adding the current product.\n        analyticsPayload.cart_is_empty = cart.items.length === 1 && cart.items[0].quantity === 1\n\n        // Include relevant Impression data\n        const placementImpression = analytics.getActivePlacementImpression()\n        const featuredProductImpression = analytics.getFeaturedProductImpression(product.id)\n        impressionData = {\n          ...placementImpression,\n          ...featuredProductImpression,\n          impression_id:\n            featuredProductImpression?.impression_id || placementImpression?.impression_id,\n        }\n      }\n\n      return { ...analyticsPayload, ...impressionData }\n    }\n\n    /**\n     * BATCHES analytics for *adding* an item to the cart\n     *\n     * @param {object} product       - The product that was added to the cart\n     * @param {number} quantity      - Quantity of the item added to the cart\n     * @param {number} index         - Position in in the list from where the product was added\n     * @param {string} location      - The originating location\n     * @param {object} locationValue - Info about the item involved in the location\n     *\n     * @returns {undefined}\n     */\n    service.addItem = (product, quantity, index, location, locationValue, extraData = {}) => {\n      const { cart } = cartService\n      const prevCartItem = { ...cartService.getItem(product) }\n      _writeToBuffer(\n        { product, index, prevCart: cart, prevCartItem, location, locationValue, extraData },\n        ACTIONS.ADD,\n        quantity\n      )\n    }\n\n    /**\n     * BATCHES analytics for *removing* an item from the cart\n     *\n     * @param {object} product       - The product that was added to the cart\n     * @param {number} quantity      - Quantity of the item added to the cart\n     * @param {number} index         - Position in in the list from where the product was added\n     * @param {string} location      - The originating location\n     * @param {object} locationValue - Info about the item involved in the location\n     *\n     * @returns {undefined}\n     */\n    service.removeItem = (product, quantity, index, location, locationValue, extraData = {}) => {\n      const { cart } = cartService\n      const prevCartItem = { ...cartService.getItem(product) }\n      _writeToBuffer(\n        { product, index, prevCart: cart, prevCartItem, location, locationValue, extraData },\n        ACTIONS.REMOVE,\n        quantity\n      )\n    }\n\n    /**\n     * Handle cart update quantity analytics. Internally this method calls\n     * *addItem* and *removeItem* depending if the new *quantity* is greater or\n     * less than the previous quantity of the item inside the cart\n     *\n     * @param {array} args  - Args passed to updateQuantity:\n     *                        [0] {object} product       - The product that was removed to the cart\n     *                        [1] {number} quantity      - Quantity of the item removed from the cart\n     *                        [2] {number} index         - Position in in the list from where the product was removed\n     *                        [3] {string} location      - The originating location\n     *                        [4] {object} locationValue - Info about the item involved in the location\n     */\n    service.updateQuantity = (...args) => {\n      const [product, quantity] = args\n      const cartItem = cartService.getItem(product)\n      const cartQuantity = cartItem?.quantity\n      const isAdding = quantity > cartQuantity\n\n      if (isAdding) {\n        this.addItem.apply(this, args)\n        return\n      }\n\n      this.removeItem.apply(this, args)\n    }\n\n    /**\n     * @Optional\n     * Triggers analytics for an item to the cart\n     *\n     * @param {object} details - Object of information:\n     *                          {object} product       - The product that was removed to the cart\n     *                          {number} quantity      - Quantity of the item removed from the cart\n     *                          {number} index         - Position in in the list from where the product was removed\n     *                          {string} location      - The originating location\n     *                          {object} locationValue - Info about the item involved in the location\n     * @returns {undefined}\n     */\n    service.itemChange = details => {\n      analytics.logSegmentEvent(EVENTS[details.action], {\n        ..._getAnalyticsPayload(details),\n        ...(details.action === ACTIONS.ADD &&\n          analytics.getFeaturedProductImpression(details.product.id)),\n      })\n      if (details.action === ACTIONS.ADD) {\n        analytics.logProductAddToCart(details.product, details.location, auth.getContext().intent)\n      } else if (details.action === ACTIONS.REMOVE) {\n        analytics.logProductRemoveFromCart(\n          details.product,\n          details.location,\n          auth.getContext().intent\n        )\n      }\n    }\n  })\n","import _ from 'lodash'\nimport angular from 'angular'\n\nexport default angular\n  .module('cartListTransferServiceModule', [])\n  .service(\n    'cartListTransferService',\n    function cartListTransferService($q, $state, $stateParams, Restangular, redirectService) {\n      const service = this\n\n      // eslint-disable-next-line eqeqeq\n      const shouldRedirectToDotCom = $state.current.name == 'cartListTransfer'\n      service.redirectToDotCom = () => {\n        redirectService.goToRedirectUrl(\n          { href: $stateParams && $stateParams.redirect },\n          { state: 'cartListTransfer' }\n        )\n      }\n\n      service.initializeTransfer = ({ initialContext, updatedContext, transferData }) => {\n        const deferred = $q.defer()\n\n        service.initialContext = initialContext\n        service.updatedContext = updatedContext\n        service.transferData = transferData\n        service.transferStatus = { inProgress: false }\n\n        // Callback methods for cartListTransferController to tell contextSelectorController.js if the user completed or cancelled the context switch\n        service.completeContextSwitch = () => {\n          service.transferStatus.inProgress = true\n          deferred.resolve()\n\n          if (shouldRedirectToDotCom) {\n            service.redirectToDotCom()\n          }\n        }\n        service.cancelContextSwitch = () => {\n          deferred.reject()\n\n          if (shouldRedirectToDotCom) {\n            service.redirectToDotCom()\n          }\n        }\n\n        return deferred.promise\n      }\n\n      service.transferItems = (redirectRoute = null) => {\n        service.transferStatus.inProgress = true\n\n        const transferEndpoints = {}\n\n        if (service.updatedContext === 'instore') {\n          transferEndpoints.from = 'cart'\n          transferEndpoints.to = 'user_lists/default'\n        } else {\n          transferEndpoints.from = 'user_lists/default'\n          transferEndpoints.to = 'cart'\n        }\n\n        const { transferableProducts } = service.transferData\n        const clearTransferredProducts = _.map(transferableProducts, product =>\n          _.assign({}, product, { quantity: 0 })\n        )\n\n        return $q\n          .all([\n            // Transfer cart/list items to the list/cart\n            Restangular.one(transferEndpoints.to).customPUT({ items: transferableProducts }),\n            // Remove items that we transferred to list/cart from the cart/list\n            Restangular.one(transferEndpoints.from).customPUT({ items: clearTransferredProducts }),\n          ])\n          .then(() => redirectRoute && $state.go(redirectRoute))\n          .then(() => {\n            service.completeContextSwitch()\n          })\n      }\n    }\n  )\n","import angular from 'angular'\nimport {\n  ANALYTICS,\n  CHECKOUT_STEPS,\n  EVENTS,\n  SOURCES,\n} from '@app/angular/services/modules/analytics/analyticsConstants'\n\n/*\n * To understand how checkout events work, please read the instructions here: _Analytics.service.md\n * The constants exist here: analyticsConstants.js\n */\n\nexport const REFRESH_MS = 500\nexport const CHECKOUT_UUID_STORE = 'checkout_UUID'\n\nexport default angular\n  .module('checkoutAnalyticsModule', [])\n  .service(\n    'checkoutAnalytics',\n    function (\n      $location,\n      $state,\n      $timeout,\n      analytics,\n      analyticsHelper,\n      auth,\n      cartService,\n      config,\n      localStorageService,\n      reservationService,\n      utilService\n    ) {\n      const service = this\n\n      Object.assign(service, {\n        $state,\n        $timeout,\n        analytics,\n        analyticsHelper,\n        config,\n        localStorageService,\n        utilService,\n        checkoutUUID: null,\n        checkoutEntered: 0,\n        information: {\n          $location,\n          auth,\n          cartService,\n          reservationService,\n        },\n      })\n\n      /**\n       * Get default reused information as an object - that way no need to require dependencies all over the project\n       * WARNING: !!! Only include easy to access information in here !!!\n       *                 Ideally this should have a light footprint\n       *\n       * @return {object}\n       */\n      service.DEFAULTS = function () {\n        const { $location, auth, cartService, reservationService } = service.information\n\n        return {\n          [SOURCES.ANALYTICS_SERVICE]: service.analytics,\n          [SOURCES.CART]: cartService.cart || null,\n          [SOURCES.USER]: auth.user || null,\n          [SOURCES.TIMESLOT]: reservationService.reservation?.timeslot || null,\n          [SOURCES.CHECKOUT_ID]: service.checkoutUUID,\n          [SOURCES.URL_SLUG]: $location.path() || null,\n        }\n      }\n\n      /**\n       * Private: Helper method to get analytic payloads (default sources and \"success\" requirement both auto added)\n       *\n       * @param {object} source - Object of data to be used to generate analytic payloads\n       * @param {array} requiredInfo - Array of constants defined above\n       *\n       * @returns {object|null}\n       */\n      service._createPayload = function (source = {}, requiredInfo = []) {\n        return service.analyticsHelper.createPayload(\n          { ...service.DEFAULTS(), ...source },\n          requiredInfo\n        )\n      }\n\n      /**\n       * Track the entering/exiting of the checkout flow (including cart) - The tracking survives refreshes\n       * @param {boolean} isEnter - true if entering, false if exiting\n       */\n      service.isInNewCheckoutFlow = analyticsHelper.persistentStateFactory(\n        CHECKOUT_UUID_STORE,\n        () => service.checkoutUUID,\n        newValue => (service.checkoutUUID = newValue)\n      )\n\n      // --- CART ANALYTIC METHODS --- //\n\n      /**\n       * Triggers analytics for the cart review page\n       *\n       * @param {object} [sources] - An object with the following information (auto included: checkoutAnalytics.DEFAULTS¹):\n       *                             * {object} analytics¹     - The analytics service\n       *                             * {object} cart¹          - The user cart object\n       *                             * {string} checkoutUUID¹  - The UUID representing this checkout session\n       *                             * {object} timeslot¹      - Reservation timeslot\n       *                             * {string} urlSlug¹       - $location.path()\n       *                             * {object} user¹          - Current user\n       * @returns {undefined}\n       */\n      service.cartView = function (sources = {}) {\n        const analyticsPayload = service._createPayload(sources, [\n          ANALYTICS.CART.CART_ID,\n          ANALYTICS.CART.INFO_ANALYTICS,\n          ANALYTICS.CART.INTENT,\n          ANALYTICS.CART.ITEM_DETAILS,\n          ANALYTICS.FLOW.INSTANCE,\n          ANALYTICS.FLOW.SOURCE_TYPE,\n          ANALYTICS.TIMESLOT.TIMESLOT_DETAILS,\n        ])\n        service.analytics.logCheckoutStep(\n          CHECKOUT_STEPS[EVENTS.CART.VIEW],\n          null,\n          service.DEFAULTS().cart.items\n        )\n        service.analyticsHelper.logAnalytics(EVENTS.CART.VIEW, analyticsPayload, {\n          display_name: 'Review Cart',\n          success: true,\n        })\n      }\n\n      /**\n       * Triggers analytics for editing cart items quantity\n       *\n       * @param {object} sources - An object with the following information (auto included: checkoutAnalytics.DEFAULTS¹):\n       *                           * {object}  analytics¹    - The analytics service\n       *                           * {object}  cart¹         - user cart\n       *                           * {string}  checkoutUUID¹ - The UUID representing this checkout session\n       *                           * {boolean} success       - has edited item quantity with success\n       * @returns {undefined}\n       */\n      service.cartEditQuantity = function (sources) {\n        const analyticsPayload = service._createPayload(sources, [\n          ANALYTICS.CART.CART_ID,\n          ANALYTICS.CART.INFO_ANALYTICS,\n          ANALYTICS.FLOW.INSTANCE,\n        ])\n        service.analyticsHelper.logAnalytics(EVENTS.CART.EDIT_QUANTITY, analyticsPayload)\n      }\n\n      /**\n       * Triggers analytics for adding promo code\n       *\n       * @param {object} sources - An object with the following information (auto included: checkoutAnalytics.DEFAULTS¹):\n       *                           * {object}  cart¹          - The user cart object\n       *                           * {string}  checkoutUUID¹  - The UUID representing this checkout session\n       *                           * {object}  offer          - The current offers for the cart\n       *                           * {string}  promoCode      - The promo code entered\n       *                           * {boolean} success        - Whether it was added or not\n       * @returns {undefined}\n       */\n      service.addPromo = function (sources) {\n        const analyticsPayload = service._createPayload(\n          // Offers is optional, so set to null to avoid createPayload validation\n          { offer: null, ...sources },\n          [ANALYTICS.CART.CART_ID, ANALYTICS.FLOW.INSTANCE, ANALYTICS.OFFER.OFFER_DETAILS]\n        )\n\n        service.analyticsHelper.logAnalytics(EVENTS.CART.ADD_PROMO, analyticsPayload, {\n          promo_code: sources.promoCode.promo_code || sources.promoCode,\n        })\n      }\n\n      /**\n       * Triggers analytics for cart notes editing (auto included: checkoutAnalytics.DEFAULTS¹)\n       *\n       * @param {object} sources - An object with the following information:\n       *                           * {object}  cart¹          - The user cart object\n       *                           * {string}  checkoutUUID¹  - The UUID representing this checkout session\n       *                           * {string}  note           - The note\n       *                           * {boolean} success        - Succesfully edited card notes\n       *\n       * @returns {undefined}\n       */\n      service.modifyNote = function (sources) {\n        const analyticsPayload = service._createPayload(sources, [\n          ANALYTICS.CART.CART_ID,\n          ANALYTICS.FLOW.INSTANCE,\n        ])\n        service.analyticsHelper.logAnalytics(EVENTS.CART.MODIFY_NOTE, analyticsPayload, {\n          note: sources.note,\n        })\n      }\n\n      /**\n       * Triggers analytics for the cart review checkout click button\n       *\n       * @param {object} [sources] - An object with the following information (auto included: checkoutAnalytics.DEFAULTS¹):\n       *                             * {object} cart¹          - The user cart object\n       *                             * {string} checkoutUUID¹  - The UUID representing this checkout session\n       *                             * {object} timeslot¹      - Reservation timeslot\n       *                             * {object} user¹          - Current user\n       * @returns {undefined}\n       */\n      service.checkoutClick = function (sources = {}) {\n        const analyticsPayload = service._createPayload(sources, [\n          ANALYTICS.CART.CART_ID,\n          ANALYTICS.CART.INTENT,\n          ANALYTICS.FLOW.INSTANCE,\n          ANALYTICS.TIMESLOT.TIMESLOT_DETAILS,\n        ])\n        service.analyticsHelper.logAnalytics(EVENTS.CART.CHECKOUT_CLICK, analyticsPayload, {\n          success: true,\n        })\n      }\n\n      /**\n       * Triggers analytics for entering the checkout pages\n       *\n       * @param {object} [sources] - An object with the following information (auto included: checkoutAnalytics.DEFAULTS¹):\n       *                             * {object}  cart¹          - The user cart object\n       *                             * {string}  checkoutUUID¹  - The UUID representing this checkout session\n       *                             * {object}  timeslot¹      - Reservation timeslot\n       *                             * {object}  user¹          - Current user\n       * @returns {undefined}\n       */\n      service.enterCheckoutFlow = function (sources = {}) {\n        if (typeof service.isInNewCheckoutFlow === 'function') {\n          service.isInNewCheckoutFlow(true)\n        }\n\n        if (!service.checkoutEntered) {\n          const analyticsPayload = service._createPayload(sources, [\n            ANALYTICS.CART.CART_ID,\n            ANALYTICS.CART.INTENT,\n            ANALYTICS.FLOW.INSTANCE,\n            ANALYTICS.TIMESLOT.TIMESLOT_DETAILS,\n          ])\n          service.analyticsHelper.logAnalytics(EVENTS.CHECKOUT.ENTER_CHECKOUT, analyticsPayload, {\n            success: true,\n          })\n        }\n\n        service.checkoutEntered = 1\n      }\n\n      /**\n       * Triggers analytics for exiting the checkout pages\n       *\n       * @param {object} [sources] - An object with the following information (auto included: checkoutAnalytics.DEFAULTS¹):\n       *                             * {object}  cart¹          - The user cart object\n       *                             * {string}  checkoutUUID¹  - The UUID representing this checkout session\n       *                             * {string}  urlSlug¹       - $location.path()\n       * @returns {undefined}\n       */\n      service.exitCheckoutFlow = function (sources = {}, sendImmediately = false) {\n        if (sendImmediately) {\n          service._logExitCheckoutEvent(sources)\n        } else if (service.checkoutEntered) {\n          // eslint-disable-next-line no-plusplus\n          service.checkoutEntered++\n\n          service.$timeout(() => {\n            if (service.checkoutEntered > 1) {\n              service._logExitCheckoutEvent(sources)\n              service.checkoutEntered = 0\n            }\n          }, REFRESH_MS)\n        }\n      }\n\n      service._logExitCheckoutEvent = function (sources) {\n        const analyticsPayload = service._createPayload(sources, [\n          ANALYTICS.CART.CART_ID,\n          ANALYTICS.FLOW.INSTANCE,\n          ANALYTICS.FLOW.SOURCE_TYPE,\n          ANALYTICS.FLOW.SOURCE_VALUE,\n        ])\n        service.analyticsHelper.logAnalytics(EVENTS.CHECKOUT.EXIT_CHECKOUT, analyticsPayload, {\n          success: true,\n        })\n      }\n\n      /**\n       * Triggers analytics for entering upsell\n       *\n       * @param {object} [sources] - An object with the following information (auto included: checkoutAnalytics.DEFAULTS¹):\n       *                             * {object}  analytics¹       - The analytics service\n       *                             * {object}  cart¹            - The user cart object\n       *                             * {string}  checkoutUUID¹    - The UUID representing this checkout session\n       *                             * {object}  timeslot¹        - Reservation timeslot\n       *                             * {object}  upsellProducts¹  - The upsell product source\n       * @returns {undefined}\n       */\n      service.enterCheckoutUpsell = function (sources = {}) {\n        const analyticsPayload = service._createPayload(sources, [\n          ANALYTICS.CART.CART_ID,\n          ANALYTICS.CART.ITEM_DETAILS,\n          ANALYTICS.CHECKOUT.UPSELL_ITEMS,\n          ANALYTICS.FLOW.INSTANCE,\n          ANALYTICS.TIMESLOT.TIMESLOT_DETAILS,\n        ])\n        service.analytics.logCheckoutStep(\n          CHECKOUT_STEPS[EVENTS.CHECKOUT.ENTER_UPSELL],\n          null,\n          service.DEFAULTS().cart.items\n        )\n        service.analyticsHelper.logAnalytics(EVENTS.CHECKOUT.ENTER_UPSELL, analyticsPayload, {\n          success: true,\n        })\n      }\n\n      /**\n       * Triggers analytics for exiting upsell\n       *\n       * @param {object} [sources] - An object with the following information (auto included: checkoutAnalytics.DEFAULTS¹):\n       *                             * {object}  analytics¹       - The analytics service\n       *                             * {object}  cart¹            - The user cart object\n       *                             * {string}  checkoutUUID¹    - The UUID representing this checkout session\n       *                             * {object}  timeslot¹        - Reservation timeslot\n       *                             * {object}  upsellProducts¹  - The upsell product source\n       * @returns {undefined}\n       */\n\n      service.exitCheckoutUpsell = function (sources = {}) {\n        const analyticsPayload = service._createPayload(sources, [\n          ANALYTICS.CART.CART_ID,\n          ANALYTICS.CART.ITEM_DETAILS,\n          ANALYTICS.CHECKOUT.UPSELL_ITEMS,\n          ANALYTICS.FLOW.INSTANCE,\n          ANALYTICS.TIMESLOT.TIMESLOT_DETAILS,\n        ])\n        service.analyticsHelper.logAnalytics(EVENTS.CHECKOUT.COMPLETE_UPSELL, analyticsPayload, {\n          success: true,\n        })\n      }\n\n      /**\n       * Triggers analytics for entering the review of checkout page (new checkout flow)\n       *\n       * @param {object} [sources] - An object with the following information (auto included: checkoutAnalytics.DEFAULTS¹):\n       *                             * {object}  cart¹            - The user cart object\n       *                             * {string}  checkoutUUID¹    - The UUID representing this checkout session\n       * @returns {undefined}\n       */\n      service.enterCheckoutReview = function (sources = {}) {\n        const analyticsPayload = service._createPayload(sources, [\n          ANALYTICS.CART.CART_ID,\n          ANALYTICS.FLOW.INSTANCE,\n        ])\n        service.analytics.logCheckoutStep(\n          CHECKOUT_STEPS[EVENTS.CHECKOUT.ENTER_REVIEW],\n          null,\n          service.DEFAULTS().cart.items\n        )\n        service.analyticsHelper.logAnalytics(EVENTS.CHECKOUT.ENTER_REVIEW, analyticsPayload, {\n          success: true,\n        })\n      }\n\n      /**\n       * Triggers analytics for clicking edit cart\n       *\n       * @param {object} [sources] - An object with the following information (auto included: checkoutAnalytics.DEFAULTS¹):\n       *                             * {object}  cart¹            - The user cart object\n       *                             * {string}  checkoutUUID¹    - The UUID representing this checkout session\n       * @returns {undefined}\n       */\n      service.clickEditCart = function (sources = {}) {\n        const analyticsPayload = service._createPayload(sources, [\n          ANALYTICS.CART.CART_ID,\n          ANALYTICS.FLOW.INSTANCE,\n        ])\n        service.analyticsHelper.logAnalytics(EVENTS.CHECKOUT.CLICK_EDIT_CART, analyticsPayload, {\n          success: true,\n        })\n      }\n\n      /**\n       * Triggers analytics for viewing fulfillment options\n       *\n       * @param {object} [sources] - An object with the following information (auto included: checkoutAnalytics.DEFAULTS¹):\n       *                             * {object} cart¹             - The user cart object\n       *                             * {string} checkoutUUID¹     - The UUID representing this checkout session\n       *                             * {object} user¹             - Current user\n       * @returns {undefined}\n       */\n      service.viewFulfillmentOptions = function (sources = {}) {\n        const analyticsPayload = service._createPayload(sources, [\n          ANALYTICS.CART.CART_ID,\n          ANALYTICS.CART.INTENT,\n          ANALYTICS.CHECKOUT.CONTEXT,\n          ANALYTICS.CHECKOUT.SHOP,\n          ANALYTICS.FLOW.INSTANCE,\n        ])\n\n        // This is needed as this was a step in the old checkout flow and in the new checkout it is an option\n        service.config.newCheckoutFlow.checkoutPage.enabled\n          ? service.analytics.logCheckoutOption(\n              CHECKOUT_STEPS[EVENTS.CHECKOUT.ENTER_REVIEW],\n              EVENTS.CHECKOUT.VIEW_FULFILLMENT\n            )\n          : service.analytics.logCheckoutStep(\n              CHECKOUT_STEPS[EVENTS.CHECKOUT.VIEW_FULFILLMENT],\n              null,\n              service.DEFAULTS().cart.items\n            )\n\n        service.analyticsHelper.logAnalytics(EVENTS.CHECKOUT.VIEW_FULFILLMENT, analyticsPayload, {\n          success: true,\n        })\n      }\n\n      /**\n       * Triggers analytics for saving fulfillment options\n       *\n       * @param {object} [sources] - An object with the following information (auto included: checkoutAnalytics.DEFAULTS¹):\n       *                             * {object}  cart¹            - The user cart object\n       *                             * {string}  checkoutUUID¹    - The UUID representing this checkout session\n       *                             * {object}  user¹            - Current user\n       *                             * {boolean} success          - Whether the update was successful or not\n       * @returns {undefined}\n       */\n      service.editFulfillmentOptions = function (sources = {}) {\n        const analyticsPayload = service._createPayload(sources, [\n          ANALYTICS.CART.CART_ID,\n          ANALYTICS.CART.INTENT,\n          ANALYTICS.CHECKOUT.CONTEXT,\n          ANALYTICS.CHECKOUT.SHOP,\n          ANALYTICS.FLOW.INSTANCE,\n        ])\n        service.analyticsHelper.logAnalytics(EVENTS.CHECKOUT.EDIT_FULFILLMENT, analyticsPayload)\n      }\n\n      /**\n       * Triggers analytics for viewing confirm fulfillment options page in the old checkout flow\n       *\n       * TODO: this can be removed if the old checkout flow becomes obsolete\n       */\n      service.confirmFulfillmentOptions = function () {\n        service.analytics.logCheckoutStep(\n          CHECKOUT_STEPS[EVENTS.CHECKOUT.CONFIRM_FULFILLMENT],\n          null,\n          service.DEFAULTS().cart.items\n        )\n      }\n\n      /**\n       * Triggers analytics for viewing timeslot options\n       *\n       * @param {object} [sources] - An object with the following information (auto included: checkoutAnalytics.DEFAULTS¹):\n       *                             * {object}  cart¹            - The user cart object\n       *                             * {string}  checkoutUUID¹    - The UUID representing this checkout session\n       *                             * {object}  timeslot¹        - Reservation timeslot\n       *                             * {boolean} success\n       * @returns {undefined}\n       */\n      service.viewTimeslotOptions = function (sources = {}) {\n        const analyticsPayload = service._createPayload(sources, [\n          ANALYTICS.CART.CART_ID,\n          ANALYTICS.FLOW.INSTANCE,\n          ANALYTICS.TIMESLOT.TIMESLOT_DETAILS,\n        ])\n        service.analyticsHelper.logAnalytics(EVENTS.CHECKOUT.VIEW_TIMESLOTS, analyticsPayload)\n      }\n\n      /**\n       * Triggers analytics for saving timeslot options\n       *\n       * @param {object} [sources] - An object with the following information (auto included: checkoutAnalytics.DEFAULTS¹):\n       *                             * {object}  cart¹            - The user cart object\n       *                             * {string}  checkoutUUID¹    - The UUID representing this checkout session\n       *                             * {boolean} success          - Timeslot succesfully saved or not\n       *                             * {object}  timeslot¹        - Reservation timeslot\n       * @returns {undefined}\n       */\n      service.editTimeslotOptions = function (sources = {}) {\n        const analyticsPayload = service._createPayload(sources, [\n          ANALYTICS.CART.CART_ID,\n          ANALYTICS.FLOW.INSTANCE,\n          ANALYTICS.TIMESLOT.TIMESLOT_DETAILS,\n          ANALYTICS.RESERVATION.FULFILLMENT_DATE,\n        ])\n        service.analyticsHelper.logAnalytics(EVENTS.CHECKOUT.SELECT_TIMESLOT, analyticsPayload)\n      }\n\n      /**\n       * Triggers analytics for viewing contact options\n       *\n       * @param {object} [sources] - An object with the following information (auto included: checkoutAnalytics.DEFAULTS¹):\n       *                             * {object}  cart¹            - The user cart object\n       *                             * {string}  checkoutUUID¹    - The UUID representing this checkout session\n       *                             * {object}  contact          - The currently selected contact info\n       * @returns {undefined}\n       */\n      service.viewContactOptions = function (sources = {}) {\n        const analyticsPayload = service._createPayload(sources, [\n          ANALYTICS.CART.CART_ID,\n          ANALYTICS.FLOW.INSTANCE,\n        ])\n        service.analyticsHelper.logAnalytics(EVENTS.CHECKOUT.VIEW_CONTACT, analyticsPayload, {\n          success: true,\n        })\n      }\n\n      /**\n       * Triggers analytics for saving contact options\n       *\n       * @param {object} [sources] - An object with the following information (auto included: checkoutAnalytics.DEFAULTS¹):\n       *                             * {object}  cart¹            - The user cart object\n       *                             * {string}  checkoutUUID¹    - The UUID representing this checkout session\n       *                             * {object}  contact          - The currently selected contact info\n       *                             * {boolean} success          - Whether the update was successful or not\n       * @returns {undefined}\n       */\n      service.editContactOptions = function (sources = {}) {\n        const analyticsPayload = service._createPayload(sources, [\n          ANALYTICS.CART.CART_ID,\n          ANALYTICS.FLOW.INSTANCE,\n        ])\n        service.analyticsHelper.logAnalytics(EVENTS.CHECKOUT.EDIT_CONTACT, analyticsPayload)\n      }\n\n      /**\n       * Triggers analytics for editing payment options\n       *\n       * @param {object} [sources] - An object with the following information (auto included: checkoutAnalytics.DEFAULTS¹):\n       *                             * {object}  cart¹            - The user cart object\n       *                             * {string}  checkoutUUID¹    - The UUID representing this checkout session\n       *                             * {object}  payment          - The currently payment info\n       *                             * {string}  user_action      - The way in which a payment was added\n       *\n       * @returns {undefined}\n       */\n      service.editPaymentOptions = function (sources = {}) {\n        const analyticsPayload = service._createPayload(sources, [\n          ANALYTICS.CART.CART_ID,\n          ANALYTICS.CHECKOUT.PAYMENT,\n          ANALYTICS.FLOW.INSTANCE,\n        ])\n        service.analyticsHelper.logAnalytics(EVENTS.CHECKOUT.EDIT_PAYMENT, analyticsPayload, {\n          paymentLabel: sources.paymentLabel,\n          success: true,\n          user_action: sources.user_action,\n        })\n      }\n\n      /**\n       * Triggers analytics for the add new card iframe load\n       *\n       * @param {object} [sources] - An object with the following information (auto included: checkoutAnalytics.DEFAULTS¹):\n       *                             * {object}  cart¹            - The user cart object\n       *                             * {string}  checkoutUUID¹    - The UUID representing this checkout session\n       * @returns {undefined}\n       */\n      service.addCreditCardOpen = function (sources = {}) {\n        const analyticsPayload = service._createPayload(sources, [\n          ANALYTICS.CART.CART_ID,\n          ANALYTICS.FLOW.INSTANCE,\n        ])\n\n        service.analyticsHelper.logAnalytics(EVENTS.CHECKOUT.ADD_CREDIT_CARD_OPEN, analyticsPayload)\n      }\n\n      /**\n       * Triggers analytics for adding a new card or a new gift card\n       *\n       * @param {object} [sources] - An object with the following information (auto included: checkoutAnalytics.DEFAULTS¹):\n       *                             * {object}  cart¹            - The user cart object\n       *                             * {string}  checkoutUUID¹    - The UUID representing this checkout session\n       *                             * {object}  payment          - The current payment info\n       *                             * {object}  success          - Whether added successfully\n       *                             * {string}  user_action      - The way in which a payment was added\n       * @returns {undefined}\n       *\n       * TODO There is no global hook for monitoring adding cards - this needs to be added into each provider\n       * TODO Wull be done as a seperate task since it touches every payment provider\n       */\n      service.addPaymentOption = function (sources = {}) {\n        const analyticsPayload = service._createPayload(sources, [\n          ANALYTICS.CART.CART_ID,\n          ANALYTICS.CHECKOUT.PAYMENT,\n          ANALYTICS.FLOW.INSTANCE,\n        ])\n\n        service.analyticsHelper.logAnalytics(EVENTS.CHECKOUT.ADD_PAYMENT, analyticsPayload, {\n          user_action: sources.user_action,\n        })\n      }\n\n      /**\n       * Triggers analytics for viewing payment options\n       *\n       * @param {object} [sources] - An object with the following information (auto included: checkoutAnalytics.DEFAULTS¹):\n       *                             * {object}  cart¹            - The user cart object\n       *                             * {string}  checkoutUUID¹    - The UUID representing this checkout session\n       *                             * {object}  contact          - The currently selected contact info\n       * @returns {undefined}\n       */\n      service.viewPaymentOptions = function (sources = {}) {\n        const analyticsPayload = service._createPayload(sources, [\n          ANALYTICS.CART.CART_ID,\n          ANALYTICS.CHECKOUT.PAYMENT,\n          ANALYTICS.FLOW.INSTANCE,\n        ])\n        // This is needed as this was a step in the old checkout flow and in the new checkout it is an option\n        service.config.newCheckoutFlow.checkoutPage.enabled\n          ? service.analytics.logCheckoutOption(\n              CHECKOUT_STEPS[EVENTS.CHECKOUT.ENTER_REVIEW],\n              EVENTS.CHECKOUT.VIEW_PAYMENT\n            )\n          : service.analytics.logCheckoutStep(\n              CHECKOUT_STEPS[EVENTS.CHECKOUT.VIEW_PAYMENT],\n              null,\n              service.DEFAULTS().cart.items\n            )\n\n        service.analyticsHelper.logAnalytics(EVENTS.CHECKOUT.VIEW_PAYMENT, analyticsPayload, {\n          success: true,\n        })\n      }\n\n      /**\n       * Triggers analytics for viewing tip options\n       *\n       * @param {object} [sources] - An object with the following information (auto included: checkoutAnalytics.DEFAULTS¹):\n       *                             * {object}  cart¹            - The user cart object\n       *                             * {string}  checkoutUUID¹    - The UUID representing this checkout session\n       *                             * {object}  tip              - The currently tip info\n       * @returns {undefined}\n       */\n      service.viewTipOptions = function (sources = {}) {\n        const analyticsPayload = service._createPayload(sources, [\n          ANALYTICS.CART.CART_ID,\n          ANALYTICS.FLOW.INSTANCE,\n        ])\n        service.analyticsHelper.logAnalytics(EVENTS.CHECKOUT.VIEW_TIP, analyticsPayload, {\n          success: true,\n          tip: sources.tip,\n        })\n      }\n\n      /**\n       * Triggers analytics for saving tip options\n       *\n       * @param {object} [sources] - An object with the following information (auto included: checkoutAnalytics.DEFAULTS¹):\n       *                             * {object}  cart¹            - The user cart object\n       *                             * {string}  checkoutUUID¹    - The UUID representing this checkout session\n       *                             * {boolean} success          - Whether the update was successful or not\n       *                             * {object}  tip              - The currently tip info\n       * @returns {undefined}\n       */\n      service.editTipOptions = function (sources = {}) {\n        const analyticsPayload = service._createPayload(sources, [\n          ANALYTICS.CART.CART_ID,\n          ANALYTICS.CHECKOUT.TIP,\n          ANALYTICS.FLOW.INSTANCE,\n        ])\n        service.analyticsHelper.logAnalytics(EVENTS.CHECKOUT.EDIT_TIP, analyticsPayload)\n      }\n\n      /**\n       * Triggers analytics for clicking place order\n       *\n       * @param {object} [sources] - An object with the following information (auto included: checkoutAnalytics.DEFAULTS¹):\n       *                             * {object} analytics¹     - The analytics service\n       *                             * {object} cart¹          - The user cart object\n       *                             * {string} checkoutUUID¹  - The UUID representing this checkout session\n       *                             * {object} order          - The user order object\n       *                             * {object} timeslot¹      - Reservation timeslot\n       *                             * {string} urlSlug¹       - $location.path()\n       *                             * {object} user¹          - Current user\n       * @returns {undefined}\n       */\n      service.placeOrderClick = function (sources = {}) {\n        const analyticsPayload = service._createPayload(sources, [\n          ANALYTICS.CART.CART_ID,\n          ANALYTICS.CART.INFO_ANALYTICS,\n          ANALYTICS.CART.INTENT,\n          ANALYTICS.CART.ITEM_DETAILS,\n          ANALYTICS.CHECKOUT.ORDER,\n          ANALYTICS.FLOW.INSTANCE,\n          ANALYTICS.TIMESLOT.TIMESLOT_DETAILS,\n        ])\n        service.analyticsHelper.logAnalytics(EVENTS.CHECKOUT.CLICK_PLACE_ORDER, analyticsPayload, {\n          success: true,\n        })\n      }\n\n      /**\n       * Triggers analytics for checkout completion\n       *\n       * @param {object} [sources] - An object with the following information (auto included: checkoutAnalytics.DEFAULTS¹):\n       *                           * {object} analytics¹     - The analytics service\n       *                           * {string} checkoutUUID¹  - The UUID representing this checkout session\n       *                           * {object} cart¹          - The user cart object\n       *                           * {object} order          - The user order object\n       *                           * {object} timeslot¹      - Reservation timeslot\n       *                           * {string} urlSlug¹       - $location.path()\n       *                           * {object} user¹          - Current user\n       * @returns {undefined}\n       */\n      service.orderComplete = function (sources = {}) {\n        const analyticsPayload = service._createPayload(sources, [\n          ANALYTICS.CART.CART_ID,\n          ANALYTICS.CART.INFO_ANALYTICS,\n          ANALYTICS.CART.INTENT,\n          ANALYTICS.CART.ITEM_DETAILS,\n          ANALYTICS.CHECKOUT.ORDER,\n          ANALYTICS.FLOW.INSTANCE,\n          ANALYTICS.TIMESLOT.TIMESLOT_DETAILS,\n        ])\n\n        service.analyticsHelper.logAnalytics(EVENTS.CHECKOUT.PLACE_ORDER_COMPLETE, analyticsPayload)\n      }\n    }\n  )\n","import angular from 'angular'\nimport isCordova from '@app/utils/isCordova'\n\nexport default angular.module('codePushServicesModule', []).run(() => {\n  if (isCordova()) {\n    let isDownloadingUpdate = false\n\n    const handleError = () => {\n      isDownloadingUpdate = false\n    }\n\n    const downloadUpdate = function () {\n      if (window.codePush) {\n        if (isDownloadingUpdate) {\n          return\n        }\n\n        isDownloadingUpdate = true\n\n        window.codePush.checkForUpdate(remotePackage => {\n          if (remotePackage) {\n            remotePackage.download(localPackage => {\n              localPackage.install(\n                () => {\n                  isDownloadingUpdate = false\n                },\n                handleError,\n                {\n                  // eslint-disable-next-line no-undef\n                  installMode: InstallMode.ON_NEXT_RESTART,\n                }\n              )\n            }, handleError)\n          } else {\n            isDownloadingUpdate = false\n          }\n        }, handleError)\n      }\n    }\n\n    document.addEventListener('deviceready', () => {\n      downloadUpdate()\n    })\n\n    document.addEventListener('resume', () => {\n      downloadUpdate()\n    })\n  }\n})\n","import angular from 'angular'\nimport { COLLECTION_CONSTANTS } from '@app/angular/constants/collections'\n\nexport default angular\n  .module('collectionsServicesModule', [])\n  .service('collectionsService', function collectionsService(Restangular) {\n    /**\n     * The collections endpoint does some filtering AFTER slicing the product list to the given limit.\n     * This leads to scenarios where less than 5 products are returned from the collections endpoint.\n     * Making changes in the BE to perform the filtering BEFORE slicing may lead to unexpected performance implications\n     * and is too big of a change for now.\n     *\n     * So, temporarily, we'll request double the products from the collections endpoint (which should reduce the number of times that less than 5 products are returned)\n     * and then slice to the limit on the FE.\n     *\n     * Once the BE collections code has been fixed to appropriately respect the given limit, we can remove this logic.\n     *\n     * ref: ENT-24463\n     */\n    const COLLECTION_LIMIT_MULTIPLIER = 2\n    const service = this\n\n    const cachedCollections = {}\n\n    // Function to fetch a collection by ID - will return the cahced collection\n    // if one already exists for the given identifier\n    service.getCollection = (id, limit, refresh) => {\n      const collectionIdentifier = `${id}_${limit}`\n      if (cachedCollections[collectionIdentifier] && !refresh) {\n        return cachedCollections[collectionIdentifier]\n      }\n      cachedCollections[collectionIdentifier] = Restangular.one('collections', id)\n        .get({ limit: limit * COLLECTION_LIMIT_MULTIPLIER })\n        .then(collectionData => {\n          if (collectionData.items) {\n            const items = collectionData.items.slice(0, limit)\n            collectionData.items = items\n          }\n          return collectionData\n        })\n        .catch(() => [])\n      return cachedCollections[collectionIdentifier]\n    }\n\n    // Function to fetch a set of collections from an arrary of collection ID's\n    // Returns an array of collection objects\n    service.getCollectionsFromSet = collectionsArray => {\n      const collections = []\n      const promises = collectionsArray.map(collectionID => {\n        return new Promise(resolve => {\n          service\n            .getCollection(collectionID, COLLECTION_CONSTANTS.PRODUCT_LIMIT)\n            .then(collection => {\n              collections.push(collection)\n              resolve(collection)\n            })\n        })\n      })\n\n      return Promise.all(promises)\n    }\n  })\n","import angular from 'angular'\nimport template from '../templates/confirmationModal/confirmationModal.html'\n\nexport default angular\n  .module('confirmationModalServiceModule', [])\n  .service('confirmationModal', function ($uibModal, lang) {\n    const service = this\n\n    service.open = ({ title, message, confirm, cancel } = {}, templateOverride) => {\n      const promise = new Promise(resolve => {\n        const finalTemplate = templateOverride || template\n        $uibModal.open({\n          template: finalTemplate,\n          controller($scope) {\n            Object.assign($scope, {\n              lang,\n              resolve,\n              title,\n              message,\n              confirm,\n              cancel,\n            })\n          },\n          keyboard: false,\n          backdrop: 'static',\n          controllerAs: '$ctrl',\n        })\n      })\n\n      return promise\n    }\n  })\n","import angular from 'angular'\nimport { config as configService } from '@instacart/enterprise-services'\nimport { mergeConfigs } from '@instacart/enterprise-config-utils'\nimport { store } from '@app/services/store'\nimport { fetchConfig } from '@app/services/config/slice'\n\n// This service allows you to fetch and override the client runtime\n// configuration via remote fetch where needed\n// (intended as our stopgap A/B solution)\nexport default angular\n  .module('configServiceModule', [])\n  .service('config', function configurationService($rootScope) {\n    // WARNING: THIS IS A COMPLETE HACK TO WORKAROUND HOW WE READ CONFIGS\n\n    // Configs arriving from Redux are frozen. However, the angular app\n    // sometimes modifies some properties. This function will create an\n    // \"unfrozen\" copy of the frozen Redux Config object\n    const unfrozenCopy = obj => JSON.parse(JSON.stringify(obj))\n\n    // storeConfig is stored so that we can compare changes later\n    let storeConfig = configService.selectors.getConfig()\n\n    // First, we make a deep copy of the current config so that it can later be\n    // mutated when or if new configs are set or fetched\n    const config = unfrozenCopy(storeConfig)\n\n    // This function does a deep-merge on the above config instance and the\n    // latest configs in the service. A deep-merge is required due to that\n    // the original configs have already been returned by this function\n    const updateConfig = () => {\n      const newConfig = unfrozenCopy(configService.selectors.getConfig())\n      mergeConfigs(config, newConfig)\n    }\n\n    store.subscribe(() => {\n      const latestConfig = configService.selectors.getConfig()\n\n      // If config didn't change, no need to do anything\n      if (latestConfig === storeConfig) {\n        return\n      }\n\n      // If config did change in the main store,\n      // we update the local config as well as the reference\n      updateConfig()\n      storeConfig = latestConfig\n    })\n\n    // Re-fetch the configs when user becomes logged in. We do this to ensure\n    // any A/B test custom configs can be loaded for logged in users\n    $rootScope.$on('auth', (_event, action) => {\n      if (action === 'userLoggedIn') {\n        store.dispatch(fetchConfig()).then(updateConfig)\n      }\n    })\n\n    // This function will return the original config immediately. To update\n    // the config we must mutate the original object\n    return config\n  })\n","import angular from 'angular'\nimport dayjs from 'dayjs'\nimport { CLIENT } from '../../../rootConfig'\n\nexport default angular\n  .module('debugServicesModule', [])\n\n  .run(($rootScope, config, utilService) => {\n    // Expose some debug information\n\n    if (config.env.mode !== 'prod') {\n      window.unata = {\n        config,\n        scopes: {\n          RootScope: $rootScope,\n        },\n      }\n    }\n\n    utilService.log('app version:', config.version)\n\n    // If the environment sets a hash for the version, also log the tag\n    if (config.env.tag) {\n      utilService.log('app tag:', config.env.tag)\n    }\n\n    // If this is using enterprise configs, log the version so you don't need to dig in the config object\n    // TODO - update this with bucket config version\n    if (config.$enterpriseConfigVersion) {\n      utilService.log('config version:', config.$enterpriseConfigVersion)\n    }\n\n    utilService.log('build time:', dayjs(config.timestamp).format('MMM D YYYY HH:mm:ss'))\n\n    if (config.env.mode !== 'prod') {\n      utilService.log('config:', config)\n    }\n\n    if (config.env.mode !== 'prod') {\n      $rootScope.$on(\n        '$stateChangeError',\n        (event, toState, toParams, fromState, fromParams, error) => {\n          utilService.log(\n            '$stateChangeError: ',\n            event,\n            toState,\n            toParams,\n            fromState,\n            fromParams,\n            error\n          )\n        }\n      )\n    }\n    /*\n     * This block introduces a new window object which can be used for debugging.\n     * Although duplicated from the above, it removes the dependency on moded.\n     * This is currently being used by cypress.\n     *\n     * TODO - refactor the above to remove the dependency on mode.\n     * This would require some infra changes.\n     */\n    if (config.env.debug) {\n      window.__UNATA_DEBUG__ = window.__UNATA_DEBUG__ || {}\n      window.__UNATA_DEBUG__.config = config\n      window.__UNATA_DEBUG__.CLIENT = CLIENT\n    }\n  })\n\n  // Automatically generate references to all controller scopes for debugging\n\n  .decorator('$controller', [\n    '$delegate',\n    'config',\n    function ($delegate, config) {\n      return function (constructor, locals) {\n        const controller = $delegate.apply(null, arguments)\n\n        return angular.extend(() => {\n          if (config.env.mode !== 'prod' && typeof constructor === 'string' && locals.$scope) {\n            window.unata.scopes[constructor] = locals.$scope\n          }\n\n          return controller()\n        }, controller)\n      }\n    },\n  ])\n\n  // Bypath OAuth on the dev server\n\n  .factory('OAuthInterceptor', function (configConstants) {\n    const appConfig = configConstants\n\n    return {\n      request(config) {\n        if (appConfig.env.mode !== 'prod') {\n          config.headers['X-Unata-Dev-Auth'] = 'qel9kOMmmVQNaD8u'\n        }\n\n        return config\n      },\n    }\n  })\n\n  .config([\n    '$httpProvider',\n    function ($httpProvider) {\n      $httpProvider.interceptors.push('OAuthInterceptor')\n    },\n  ])\n","/**\n * These constants are here for PCI Compliance\n * All iframe and js urls should be kept in this constants file which is bundled into the final\n * build. Please do not put any payment gateway url constants into a config - as we need to be able\n * to demonstrate that these urls cannot be changed post build!\n */\nexport const PROD = 'PROD'\nexport const NON_PROD = 'NON_PROD'\n\n/**\n * Validates urls for providers that require a transactionSetupId\n * @param {string} url                  - The payment iframe/js url\n * @param {string} transactionSetupId   - The UUID (allowed characters a-f, A-F, 0-9 and -\n * @returns {string}                    - The complete url with transactionSetupId\n * @throws {Error}                      - Throws an error if the transactionSetupId is invalid\n */\nconst createValidatedPaymentUrl = (url, transactionSetupId) => {\n  const isValidTransactionSetupId = !transactionSetupId.match(/[^a-fA-F0-9-]/)\n  if (!isValidTransactionSetupId) {\n    throw new Error(`Illegal transaction_setup_id passed: ${transactionSetupId}`)\n  }\n  return url + transactionSetupId\n}\n\nconst AUTHORIZE_NET_TEST = 'test.authorize.net'\nconst AUTHORIZE_NET_LIVE = 'accept.authorize.net'\nexport const AUTHORIZE_NET = {\n  FORM_ACTION_FN: ({ isProd, isEdit }) => {\n    const url = isProd ? AUTHORIZE_NET_LIVE : AUTHORIZE_NET_TEST\n    const mode = isEdit ? 'edit' : 'add'\n    return `https://${url}/customer/${mode}Payment`\n  },\n}\n\nexport const BRAINTREE = {\n  JS_FILE: 'https://js.braintreegateway.com/js/braintree-2.32.1.min.js',\n}\n\nexport const FIRSTDATA_V2 = {\n  JS_FILE_FN: ({ isProd }) =>\n    `https://docs.paymentjs.firstdata.com/lib/${isProd ? 'prod' : 'uat'}/client-2.0.0.js`,\n}\n\nexport const STRIPE = {\n  JS_FILE: 'https://js.stripe.com/v3/',\n}\n\nexport const WEGPAY = {\n  JQUERY_SRC: 'https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js',\n  MIN_JQUERY_VERSION: '1.4.2',\n}\n\nconst VANTIV_TEST = 'certtransaction.hostedpayments.com'\nconst VANTIV_LIVE = 'transaction.hostedpayments.com'\nexport const VANTIV = {\n  IFRAME_FN: ({ isProd, transactionSetupId }) => {\n    const url = `https://${isProd ? VANTIV_LIVE : VANTIV_TEST}/?TransactionSetupID=`\n    return createValidatedPaymentUrl(url, transactionSetupId)\n  },\n  URL:\n    '/vantiv?HostedPaymentStatus&TransactionID&TransactionSetupID&ServicesID&ExpressResponseCode&ExpressResponseMessage&PaymentAccountID&LastFour&ValidationCode&CardLogo&args&CVVResponseCode&AVSResponseCode',\n}\n\n// These are the response codes related to cvv for Vantiv taken from here page 4 of the following document\n// https://drive.google.com/file/d/1pogaWz_iO9IwRs2UYzri6IZRm_0pKfpZ/view\nconst VANTIV_CVV_RESPONSES = {\n  NOT_PROCESSED: 'P',\n  MATCH: 'M',\n  NO_MATCH: 'N',\n  CVV_IS_NOT_PRESENT: 'S',\n  NOT_CERTIFIED: 'U',\n}\n\nexport const VANTIV_CVV_SUCCESS_RESPONSES = [\n  VANTIV_CVV_RESPONSES.MATCH,\n  VANTIV_CVV_RESPONSES.CVV_IS_NOT_PRESENT,\n]\n\nconst VANTIV_AVS_RESPONSES = {\n  ONLY_ADDR_MATCHES_NOT_ZIP: 'A',\n  GLOBAL_NON_AVS_PARTICIPANT: 'G',\n  NO_MATCH: 'N',\n  RETRY_SYSTEM_TIMED_OUT: 'R',\n  ISSUER_DOES_NOT_SUPPORT_AVS: 'S',\n  UNAVAILABLE: 'U',\n  NINE_DIGIT_ONLY_ZIP_MATCHES_NOT_ADDR: 'W',\n  NINE_DIGIT_MATCH: 'X',\n  FIVE_DIGIT_MATCH: 'Y',\n  FIVE_DIGIT_ONLY_ZIP_MATCHES_NOT_ADDR: 'Z',\n  ADDR_INFO_NOT_VERIFIED: 'I',\n  AVS_SERVICE_NOT_SUPPORTED: 'E',\n  INTERNATIONAL_MATCH: 'M',\n  INTERNATIONAL_MATCH_TWO: 'D',\n  ZIP_MATCH_ADDR_INCOMPATIBLE: 'P',\n}\n\nexport const VANTIV_AVS_SUCCESS_RESPONSES = [\n  VANTIV_AVS_RESPONSES.GLOBAL_NON_AVS_PARTICIPANT,\n  VANTIV_AVS_RESPONSES.ISSUER_DOES_NOT_SUPPORT_AVS,\n  VANTIV_AVS_RESPONSES.UNAVAILABLE,\n  VANTIV_AVS_RESPONSES.NINE_DIGIT_ONLY_ZIP_MATCHES_NOT_ADDR,\n  VANTIV_AVS_RESPONSES.NINE_DIGIT_MATCH,\n  VANTIV_AVS_RESPONSES.FIVE_DIGIT_MATCH,\n  VANTIV_AVS_RESPONSES.FIVE_DIGIT_ONLY_ZIP_MATCHES_NOT_ADDR,\n  VANTIV_AVS_RESPONSES.ADDR_INFO_NOT_VERIFIED,\n  VANTIV_AVS_RESPONSES.AVS_SERVICE_NOT_SUPPORTED,\n  VANTIV_AVS_RESPONSES.INTERNATIONAL_MATCH,\n  VANTIV_AVS_RESPONSES.INTERNATIONAL_MATCH_TWO,\n  VANTIV_AVS_RESPONSES.ZIP_MATCH_ADDR_INCOMPATIBLE,\n]\n\nexport const GET_PAY_SECURE_URL = function (isProd) {\n  return !isProd ? 'https://test.paysecure.acculynk.net' : 'https://api.paysecure.acculynk.net'\n}\n","import angular from 'angular'\nimport { user } from '@instacart/enterprise-services'\nimport { GET_PAY_SECURE_URL } from '@app/angular/constants/paymentGateway'\nimport { USER_ACTIONS } from '../../constants/events'\n\nexport default angular\n  .module('ebtCardModule', [])\n  .service(\n    'ebtCardService',\n    function ebtCardService($rootScope, config, oneCartService, userAnalytics, utilService) {\n      this.userHasEbtCard = false\n      this.lastFourEbtDigits = null\n      this.instrumentId = null\n\n      const clearEbtCard = () => {\n        this.userHasEbtCard = false\n        this.lastFourEbtDigits = null\n        this.instrumentId = null\n      }\n\n      const serializeEbtCardState = () => {\n        return {\n          userHasEbtCard: this.userHasEbtCard,\n          lastFourEbtDigits: this.lastFourEbtDigits,\n          instrumentId: this.instrumentId,\n        }\n      }\n\n      const setEbtCard = (userHasEbtCard, lastFourEbtDigits, instrumentId) => {\n        this.userHasEbtCard = userHasEbtCard\n        this.lastFourEbtDigits = lastFourEbtDigits\n        this.instrumentId = instrumentId\n      }\n\n      // Fetch the user's EBT Card on changes to the auth object.\n      $rootScope.$on('auth', (event, action) => {\n        if (action !== USER_ACTIONS.USER_LOGGING_OUT && oneCartService.enabled()) {\n          this.getEbtCard()\n        }\n      })\n\n      /**\n       * Fetches the current user EBT card\n       * @return {Promise}\n       * {\n       *   card_last_four: string\n       *   instrument_id: integer\n       *   label: string\n       * }\n       */\n      this.getEbtCard = () => {\n        return user.api.user.getUserEbtCard().then(card => {\n          if (card.card_last_four) {\n            setEbtCard(true, card.card_last_four, card.instrument_id)\n            // Broadcast the event for listeners to update EBT card details.\n            $rootScope.$broadcast('ebtCard', serializeEbtCardState())\n          }\n        })\n      }\n\n      /**\n       * Removes the current user EBT card\n       * @returns {Promise}\n       * {}\n       */\n      this.removeEbtCard = () => {\n        return user.api.user.deactivateEbtCard({ ebt_card_id: this.instrumentId }).then(() => {\n          clearEbtCard()\n          $rootScope.$broadcast('ebtCard', serializeEbtCardState())\n        })\n      }\n\n      /**\n       * Creates a new EBT card\n       * @param {string} cardNumber - the EBT card number\n       * @param {function} successCallback - optional success callback\n       *\n       * @returns {Promise}\n       * {\n       *   card_last_four: string\n       *   instrument_id: integer\n       *   label: string\n       * }\n       */\n      this.addCard = cardNumber => {\n        return user.api.user\n          .getEbtSessionToken()\n          .then(tokenResponse => {\n            return tokenResponse.ebt_session_id\n          })\n          .then(sessionId => {\n            return user.api.user\n              .clientTokenizeCard(\n                {\n                  SessionId: sessionId,\n                  CardNumber: cardNumber,\n                  Expiration: '1223', // Any 4 digits\n                },\n                `${GET_PAY_SECURE_URL(utilService.isProd())}/ClientTokenizeCard`\n              )\n              .then(tokenizedResponse => {\n                // eslint-disable-next-line eqeqeq\n                if (tokenizedResponse.ErrorMessage == 'Success') {\n                  return sessionId\n                }\n                userAnalytics.logUserEbtClientTokenizeFailed({\n                  error_code: tokenizedResponse.ErrorCode,\n                })\n              })\n          })\n          .then(sessionId => {\n            return user.api.user.createCardToken({\n              ebt_session_id: sessionId,\n            })\n          })\n          .then(createCardResponse => {\n            userAnalytics.logUserAddEbtCard()\n            setEbtCard(true, createCardResponse.card_last_four, createCardResponse.instrument_id)\n          })\n      }\n    }\n  )\n","import { createAction } from 'typesafe-actions'\nimport { FulfillmentType } from '@app/types/config'\nimport { ShoppingMode, ShoppingContextState } from './types'\nimport * as Constants from './constants'\n\n/*\n * @deprecated use setShoppingContext instead\n */\nexport const setFulfillmentType = createAction(\n  Constants.SET_FULFILLMENT_TYPE,\n  (fulfillmentType: FulfillmentType) => fulfillmentType\n)()\n\n/*\n * @deprecated use setShoppingContext instead\n */\nexport const setShoppingMode = createAction(\n  Constants.SET_SHOPPING_MODE,\n  (mode: ShoppingMode) => mode\n)()\n\nexport const setShoppingContext = createAction(\n  Constants.SET_SHOPPING_CONTEXT,\n  (modeAndContext: ShoppingContextState) => modeAndContext\n)()\n","import _ from 'lodash'\nimport angular from 'angular'\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\nimport { store } from '@app/services/store'\nimport { setShoppingMode } from '@app/services/shoppingContext/actions'\nimport { ShoppingMode } from '@app/types/config'\n\nexport default angular\n  .module('eComLightServiceModule', [])\n  .service('eComLightService', function eComLightService($rootScope, $stateParams, auth, config) {\n    this.requiresRedirect = false\n\n    this.setMode = value => {\n      store.dispatch(setShoppingMode(value ? ShoppingMode.Catering : ShoppingMode.InStore))\n      this.inEComLightMode = value\n    }\n\n    this.enableEComLight = () => {\n      if (config.eComLight?.enabled && auth?.user?.context) {\n        const { intent, shopping_mode } = auth.user.context\n\n        const enableEComLight =\n          intent === config.eComLight.fulfillmentType &&\n          (shopping_mode === SHOPPING_MODES.CATERING || !config.shoppingSelector.catering?.exists)\n\n        this.setMode(enableEComLight)\n\n        // Sets the appropriate icon to show for the header link to/from e-com light mode\n        this.eComLightLinkIcon =\n          this.inEComLightMode && config.shoppingSelector[SHOPPING_MODES.INSTORE_LIST].exists\n            ? 'icon-list'\n            : this.inEComLightMode && config.shoppingSelector[SHOPPING_MODES.PICKUP].exists\n            ? 'icon-pickup'\n            : `icon-catering`\n      }\n    }\n\n    this.isNonEComLightCategory = category => {\n      return config.eComLight.enabled && config.isDedicatedCateringExperienceSupported\n        ? category.id !== config.eComLight?.homeRedirect?.params?.category_id\n        : true\n    }\n\n    if (!config.eComLight.enabled) {\n      this.setMode(false)\n    } else {\n      this.eComLightCategory = config.eComLight?.homeRedirect?.params?.category_id\n\n      const fetchAllChildrenCategoryIds = category => {\n        let categoryIds = [category.id]\n        if (category.children && category.children.length > 0) {\n          const childrenIds = _.flatMap(category.children, childCategory =>\n            fetchAllChildrenCategoryIds(childCategory)\n          )\n          categoryIds = categoryIds.concat(childrenIds)\n        }\n        return categoryIds\n      }\n\n      // Set the only categories that we want to show users in eCom Light mode\n      this.setEComLightCategories = eComLightCategory => {\n        if (eComLightCategory) {\n          this.eComLightCategoryIds = fetchAllChildrenCategoryIds(eComLightCategory)\n        }\n      }\n\n      // Pages we don't want to show in eCom Light mode\n      const nonEComLightStates = [\n        'main.home',\n        'main.shop',\n        'main.shop.categories',\n        'main.shop.flyer.collection',\n      ]\n\n      // Returns boolean indicating if the state and params given indicate a state that the user cannot enter in eCom Light mode\n      this.isForbiddenState = (state, stateParams) => {\n        // Check if the state in question is a category page, and if that category is not part of the list we can show in eCom Light mode\n        let isNonEComLightCategory\n        // We can only check for isNonEComLightCategory if the categories have been loaded from the API and set through `setEComLightCategories`\n        if (\n          this.eComLightCategoryIds &&\n          state === 'main.shop.category' &&\n          stateParams.category_id\n        ) {\n          isNonEComLightCategory = !_.includes(this.eComLightCategoryIds, stateParams.category_id)\n        }\n\n        // Check if the state in question is one of the pages we cannot show users in eCom Light mode\n        const isNonEComLightState = _.includes(nonEComLightStates, state)\n\n        return isNonEComLightCategory || isNonEComLightState\n      }\n\n      const initializeInEComLightMode = () => {\n        const previousState = this.inEComLightMode\n\n        this.enableEComLight()\n\n        // Handles the scenario where eComLight is turned to true after one-time bindings first evaluation\n        if (previousState !== this.inEComLightMode && this.inEComLightMode) {\n          $rootScope.reloadState()\n        }\n      }\n\n      initializeInEComLightMode()\n\n      $rootScope.$on('auth', (event, action) => {\n        if (action === 'contextUpdated' || action === 'userUpdated') {\n          this.enableEComLight()\n        }\n      })\n    }\n  })\n","import angular from 'angular'\nimport { addErrorInterceptor } from '@app/utils/request'\n\nexport default angular\n  .module('errorInspectorServicesModule', [])\n  .run(($rootScope, $state, Restangular, analytics, config, errorModalService, lang) => {\n    let connectionModal\n\n    const handleError = (status, url, requestId, message) => {\n      const whiteListRoutes = ['/placements', '/user_events', '/facets', '/auth/external']\n\n      // Handle any 5XX errors, except 503 which is handled by the maintenance module\n      if ((status.toString()[0] === '5' && status !== 503) || status === 405) {\n        // Check if the route URL contains any of the whitelisted routes, if so\n        // simply return true (essentially don't break the promise chain, so the\n        // caller can implement a .catch() if needed.)\n        if (whiteListRoutes.some(route => url.includes(route))) {\n          analytics.logEvent('unhandled', 'whitelisted backend error', status)\n          return true\n        }\n        analytics.logEvent('unhandled', 'backend error', status)\n\n        const meta = {}\n\n        if (config.enableErrorRequestID || !['prod', 'production'].includes(process.env.NODE_ENV)) {\n          meta.requestId = requestId\n        }\n\n        errorModalService\n          .open(\n            message || config.lang.defaultErrorMessage,\n            lang.values.reload,\n            lang.values.backToHome,\n            undefined,\n            undefined,\n            meta\n          )\n          .then(\n            () => {\n              window.location.reload()\n            },\n            () => {\n              $state.go('main.home')\n            }\n          )\n      }\n\n      // Handle no response from the server\n\n      if (status === 0 && !connectionModal) {\n        analytics.logEvent('unhandled', 'backend error', status)\n        connectionModal = errorModalService.open(\n          'Connection lost...',\n          'Retry',\n          null,\n          'Connection Lost',\n          true\n        )\n\n        connectionModal.result.then(() => {\n          connectionModal = null\n          $rootScope.reloadState()\n        })\n      }\n    }\n\n    addErrorInterceptor(response => {\n      response\n        .json()\n        .then(res => {\n          const requestId = response.headers.get('x-event-id')\n          handleError(res.status, response.url, requestId, res.message)\n        })\n        .catch(() => {\n          handleError(response.status, response.url)\n        })\n    })\n\n    Restangular.setErrorInterceptor(response => {\n      const { status, config, headers, message } = response\n      handleError(status, config.url, headers()['x-event-id'], message)\n    })\n  })\n","import angular from 'angular'\nimport { eventEmitter, EVENT_TYPES } from '@app/utils/eventEmitter'\nimport { getBannerSegmentPayload } from '@app/utils/banners'\nimport { parse } from '@app/utils/json'\n\nexport const BANNER_FETCH_EVENT = 'headerBanners:fetch'\n\nexport default angular\n  .module('placementsServicesModule', [])\n  .service(\n    'placementsService',\n    function placementsService(\n      $location,\n      $rootScope,\n      Restangular,\n      analytics,\n      canvas,\n      collectionModal,\n      mobileService,\n      utilService,\n      videoModalService\n    ) {\n      const service = this\n\n      service.logPromotedPlacement = (placement, location, position) => {\n        canvas.logInteraction(placement)\n        analytics.logEvent(`${location} placement`, 'click')\n\n        const type = placement.route\n        analytics.setActivePlacementImpressionToStore(type)\n\n        if (!placement || !placement.id) return\n\n        const segmentPayload = {\n          ...analytics.getActivePlacementImpression(),\n          ...getBannerSegmentPayload(),\n          id: placement.id,\n          placement_name: placement.name,\n          content_type: placement.media.type,\n          target_action: placement.target.type,\n          position,\n        }\n        analytics.logSegmentEvent('store.click_promoted_placement', segmentPayload)\n      }\n\n      // Listen for events outside of Angular app\n      eventEmitter.on(EVENT_TYPES.LOG_PROMOTED_PLACEMENT, ({ placement, location, position }) =>\n        service.logPromotedPlacement(placement, location, position)\n      )\n\n      /**\n       * Handles the behaviour of when a placement is clicked and where it should be navigated to\n       *\n       * @param {object} placement - Obj that contains placement target and information\n       * @returns undefined\n       */\n      service.handleImagePlacementClick = (placement, location, position) => {\n        service.logPromotedPlacement(placement, location, position)\n\n        if (placement.target) {\n          const {\n            target: { url, openIn, product, offer, collection },\n          } = placement\n\n          if (url) {\n            if (videoModalService.isVideoURL(url)) return videoModalService.open(url)\n            if (utilService.isLinkInternal(url)) return utilService.openInternalUrl(url)\n            if (openIn === 'new_tab') return window.open(url, '_blank')\n            return (window.location = url)\n          }\n\n          if (product) return $location.path(`/product/${product.id}`)\n          if (offer) return $location.path(`/offers/${offer.id}`)\n          if (collection) return collectionModal.open(`collections/${collection.id}`)\n        }\n      }\n\n      eventEmitter.on(EVENT_TYPES.LOG_IMAGE_PLACEMENT, ({ placement, location }) =>\n        service.handleImagePlacementClick(placement, location)\n      )\n\n      service.getHeroContent = isMobile => {\n        const endpoint = isMobile ? 'mobile_homepage_hero' : 'homepage_hero'\n        return Restangular.all('placements')\n          .all(endpoint)\n          .getList()\n          .catch(() => [])\n      }\n\n      service.getBannerContent = () =>\n        Restangular.all('placements')\n          .all('homepage_banners')\n          .getList()\n          .catch(() => [])\n\n      service.getOrderConfirmationPlacement = isMobile =>\n        Restangular.all('placements')\n          .all(isMobile ? 'mobile_order_confirmation' : 'order_confirmation')\n          .getList()\n          .catch(() => [])\n\n      service.getHomePageCollections = () =>\n        Restangular.all('placements')\n          .all('homepage_collections')\n          .getList()\n          .catch(() => [])\n\n      // Function to fetch catalog banners. Will return a cached result past the\n      // first request unless given a truthy value for 'refresh'\n      service.getCatalogBanners = refresh => {\n        if (!refresh && service.catalog_banners) {\n          return service.catalog_banners\n        }\n        service.catalog_banners = Restangular.all('placements')\n          .all('catalog_banners')\n          .getList()\n          .catch(() => [])\n        return service.catalog_banners\n      }\n\n      // Function to fetch catalog collections. Will return a cached result past\n      // the first request unless given a truthy value for 'refresh'\n      service.getCatalogCollections = refresh => {\n        if (!refresh && service.catalog_collections) {\n          return service.catalog_collections\n        }\n        service.catalog_collections = Restangular.all('placements')\n          .all('catalog_collections')\n          .getList()\n          .catch(() => [])\n        return service.catalog_collections\n      }\n\n      service.getHeaderBanners = () =>\n        Restangular.all('placements')\n          .all(`${mobileService.isMobile ? 'mobile_' : ''}header_banner`)\n          .getList()\n          .then(list => $rootScope.$emit(BANNER_FETCH_EVENT, list) && list)\n          .catch(() => [])\n\n      service.getFeaturedDepartmentById = (featuredDepartmentId, queryStringCollectionList) =>\n        Restangular.all('placements')\n          .one('featured_department', featuredDepartmentId)\n          .get()\n          .then(featuredDepartment => {\n            if (queryStringCollectionList === undefined) {\n              return featuredDepartment.item\n            }\n            const fetchedFeaturedDepartment = featuredDepartment.item\n            fetchedFeaturedDepartment.target.collection_list = queryStringCollectionList\n            return fetchedFeaturedDepartment\n          })\n          .catch(() => [])\n\n      // Function to fetch featured departments. Will return a cached result past\n      // the first request unless given a truthy value for 'refresh'\n      service.getFeaturedDepartments = refresh => {\n        if (!refresh && service.featured_departments) {\n          return service.featured_departments\n        }\n        service.featured_departments = Restangular.all('placements')\n          .all('featured_department')\n          .getList()\n          .catch(() => [])\n        return service.featured_departments\n      }\n\n      // Parsing Query String for CollectionID List Passed as Query Parameter Functionality\n      service.getURLPassedCollectionsList = stateParams => {\n        return Array.isArray(parse(`${stateParams.collections}`))\n          ? JSON.parse(`${stateParams.collections}`)\n          : []\n      }\n    }\n  )\n","import angular from 'angular'\nimport dayjs from 'dayjs'\nimport _ from 'lodash'\nimport * as expressSelectors from '@app/services/express/selectors'\nimport {\n  getEligibleSubscriptionPlans as getEligibleSubscriptionPlansThunk,\n  getCurrentSubscription as getCurrentSubscriptionThunk,\n  createSubscription as createSubscriptionThunk,\n  updateSubscription as updateSubscriptionThunk,\n} from '@app/services/express/thunks'\n\nimport {\n  getMembershipStatus,\n  isPlacementConfigEnabled,\n  getStickyHeaderBanner,\n  collapsePromoAndNonPromoPlans,\n  getConfigByRule,\n  shouldShowDynamicPlacement,\n  getExpressLocalStorageKey,\n  acknowledgePlacement,\n} from '@app/services/express/utils'\n\nimport {\n  FIRST_ORDER_KEY,\n  IC_PLACEMENTS,\n  MESSAGE_TYPES,\n  HTML_TEMPLATES,\n  MESSAGE_PLACEMENTS,\n  MEMBERSHIP_STATUSES,\n  EXPRESS_APPLICABLE_STATUSES,\n  EXPRESS_PAYMENT_PROVIDER,\n  EXPRESS_SUBSCRIPTION_STEPS,\n  EXPRESS_SUBSCRIPTION_PLAN_TERMS,\n} from '@app/angular/constants/express'\n\nimport { PAYMENT_PROVIDERS } from '@app/angular/constants/payments'\n\nimport { BANNER_FETCH_EVENT } from '@app/angular/services/modules/placements.service'\n\n/**\n *\n * This service manages implements IC Express related HTTP calls\n * and also stores relevant subscription data that is used across the\n * application\n *\n */\nexport default angular\n  .module('ExpressServicesModule', [])\n  .service(\n    'express',\n    function express(\n      $ngRedux,\n      $q,\n      $rootScope,\n      $timeout,\n      Restangular,\n      auth,\n      config,\n      eComLightService,\n      icExpressModalService,\n      lang,\n      localStorageService\n    ) {\n      const service = this\n\n      const mapStateToService = state => ({\n        userCurrentSubscription: expressSelectors.currentSubscriptionSelector(state),\n        eligibleSubscriptionPlans: expressSelectors.eligibleSubscriptionsSelector(state),\n        expressUserConfigContext: expressSelectors.expressUserConfigContextSelector(state),\n      })\n\n      $ngRedux.connect(mapStateToService, {\n        getEligibleSubscriptionPlansThunk,\n        getCurrentSubscriptionThunk,\n        createSubscriptionThunk,\n        updateSubscriptionThunk,\n      })(service)\n\n      const { icExpress } = config\n      let promise = null\n      const subscriptionPlanIdToPlanId = {}\n\n      Object.assign(service, {\n        hasLoaded: false,\n        planUpdateMessage: null,\n        topMessage: null,\n        paymentMessage: null,\n        membershipMessage: null,\n        isIcExpressOptedIn: false,\n      })\n\n      service.shouldCreateSubscriptionAtCheckout = () => {\n        const { optionalComponents } = config\n\n        return optionalComponents.includes(PAYMENT_PROVIDERS) && optionalComponents.length === 1\n      }\n\n      service.init = () => {\n        if (config.icExpress.enabled && auth.user?.ic_linked && auth.user?.status !== 'trial') {\n          service\n            .getCurrentSubscription()\n            .then(service.fetchEligibleSubscriptionPlans)\n            .then(() => {\n              service.hasLoaded = true\n              if (\n                service.shouldShowDynamicPlacement(IC_PLACEMENTS.FIRST_ORDER) &&\n                localStorageService.deprecatedGet(FIRST_ORDER_KEY)\n              ) {\n                icExpressModalService.open()\n                service.acknowledgePlacement(IC_PLACEMENTS.FIRST_ORDER)\n              } else if (service.shouldShowDynamicPlacement(IC_PLACEMENTS.FIRST_LOGIN)) {\n                icExpressModalService.open()\n                service.acknowledgePlacement(IC_PLACEMENTS.FIRST_LOGIN)\n              }\n\n              /*\n               * Add listener for top banner insertion\n               * When banners are fetched, add our custom header banner to the list\n               */\n              if (service.isPlacementConfigEnabled(IC_PLACEMENTS.STICKER_HEADER)) {\n                const idx = config.icExpress.placements.stickyHeader.bannerInsertionIndex\n                $rootScope.$on(BANNER_FETCH_EVENT, (event, list) => {\n                  const headerBanner = getStickyHeaderBanner({\n                    placementConfigEnabled: true,\n                    icExpress,\n                    currentSubscription: service.userCurrentSubscription,\n                    expressUserConfigContext: service.expressUserConfigContext,\n                  })\n\n                  return list.splice(Math.min(idx, list.length), 0, headerBanner)\n                })\n              }\n            })\n        }\n      }\n\n      service.trialOpt = value => {\n        service.isIcExpressOptedIn = value\n      }\n\n      service.getPlanIds = plan => {\n        if (subscriptionPlanIdToPlanId[plan]) {\n          return Promise.resolve(subscriptionPlanIdToPlanId[plan])\n        }\n        return this.fetchEligibleSubscriptionPlans().then(subscriptionPlans => {\n          subscriptionPlans.forEach(eligiblePlan => {\n            if (eligiblePlan.term_length) {\n              subscriptionPlanIdToPlanId[eligiblePlan.term_length] = eligiblePlan.id\n            } else {\n              subscriptionPlanIdToPlanId[EXPRESS_SUBSCRIPTION_PLAN_TERMS.TRIAL] = eligiblePlan.id\n            }\n          })\n          return subscriptionPlanIdToPlanId[plan]\n        })\n      }\n\n      /**\n       * Triggers loadUserCurrentSubscriptionPlan with a forced reload, returning the previous operation's result\n       *\n       * @returns {Promise<object>}\n       */\n      service.reloadUserCurrentSubscriptionPlan = previousResult => {\n        return service.getCurrentSubscription(true).then(() => previousResult)\n      }\n\n      /**\n       * Fetches all express subscription plans that the user qualifies for:\n       *\n       * @returns { Promise }\n       *\n       * @example Promise resolves to:\n       *\n       * {\n       *  \"subscription_plans\": [\n       *    {\n       *      \"id\":1,\n       *        \"description\": \"Trial - 14 day\",\n       *        \"price\": '0.00',\n       *        \"currency\": \"USD\",\n       *        \"polytype\": \"trial\",\n       *        \"term_length\": null,\n       *        \"value_propositions\":[\n       *          \"Free delivery on all orders over $35 USD\",\n       *          \"Cancel anytime within the next 14 days at no cost\",\n       *          \"$99 USD/yr after your trial ends\"\n       *        ],\n       *        \"disclaimers\":[\n       *          \"By signing up, you agree to the Instacart Express Terms and authorize us to charge any active payment method on file after your free trial. Cancel anytime in Your Account. Other fees, taxes, and/or tips may apply.\"\n       *        ],\n       *        \"link_to_terms\":\"http://web.instacart.customers-stg.stg.pika.ac//terms/#terms-express\"\n       *    },\n       *    {\n       *      ...\n       *    }\n       *  ]\n       * }\n       */\n      service.fetchEligibleSubscriptionPlans = async (\n        forceRefresh = false,\n        ignorePromoPlans = false\n      ) => {\n        if (!service.eligibleSubscriptionPlans || forceRefresh) {\n          await service.getEligibleSubscriptionPlansThunk()\n        }\n\n        return collapsePromoAndNonPromoPlans(service.eligibleSubscriptionPlans, ignorePromoPlans)\n      }\n\n      /**\n       * Fetches the user current express plan. When the user isn't subscribed to any plan.\n       *\n       * @param { boolean } [forceReload] Force the reloading of the current subscription\n       *\n       * @returns { Promise }\n       *\n       * @example When the user isn't subscribed to any plan the promise resolves to:\n       *\n       * {\n       *   \"eligible_for_trial\": false,\n       *   \"was_express_member\": true\n       * }\n       */\n      service.fetchCurrentSubscriptionPlan = () => {\n        return service.getCurrentSubscriptionThunk().then(({ payload }) => {\n          return payload\n        })\n      }\n\n      /**\n       * Returns a promise with the user current express plan.\n       *\n       * @param {boolean} forceRefresh - when set to *true*, it will always fetch the user subscription\n       *\n       * @returns {Promise}\n       */\n      service.getCurrentSubscription = (forceRefresh = false) => {\n        if (service.userCurrentSubscription && !forceRefresh) {\n          return $q.resolve(service.userCurrentSubscription)\n        }\n\n        if (!forceRefresh && promise) {\n          return promise\n        }\n\n        promise = service\n          .fetchCurrentSubscriptionPlan(forceRefresh)\n          .finally(() => (promise = undefined))\n\n        return promise\n      }\n\n      /**\n       * Subscribes the user to an Express plan\n       *\n       * @param { object } data\n       *\n       * @example data:\n       *\n       * {\n       *   \"subscription_plan_id\": 1,\n       *   \"credit_card_id\": 1234 // Optional if subscribing to trial\n       * }\n       *\n       * @returns { Promise }\n       *\n       * @example promise resolves to:\n       *\n       * {\n       *   \"eligible_for_trial\":false,\n       *   \"was_express_member\":true,\n       *   \"current_subscription\": { ... }\n       * }\n       */\n      service.subscribe = data => {\n        return service.createSubscriptionThunk(data).then(service.reloadUserCurrentSubscriptionPlan)\n      }\n\n      /**\n       * Handles the flow for subscribing the user to an Express plan\n       *\n       * @param { object }   [paymentInstrument]   - A reference to the payment instrument used during checkout (Optional)\n       * @param { function } [callback]            - A callback that is triggered no matter what (Optional)\n       *                                             (The user could take many actions, hence the rationale for this)\n       *\n       * @returns { Promise }                      - Promise resolves if subscribed, or rejects if not\n       */\n      service.handleSubscribe = (paymentInstrument = null, orderId = null, callback) => {\n        const isTrialEligible = this.getMembershipStatus() === MEMBERSHIP_STATUSES.TRIAL_ELIGIBLE\n        const isAllowedPaymentProvider = config.optionalComponents.includes(\n          EXPRESS_PAYMENT_PROVIDER\n        )\n        const modalInitialState = isTrialEligible\n          ? EXPRESS_SUBSCRIPTION_STEPS.FORM\n          : EXPRESS_SUBSCRIPTION_STEPS.AD\n        const finish = () =>\n          callback &&\n          this.getCurrentSubscription()\n            .then(callback)\n            .catch(() => callback(null))\n\n        if (isTrialEligible && isAllowedPaymentProvider && paymentInstrument?.id) {\n          return this.fetchEligibleSubscriptionPlans()\n            .then(subscriptionPlans => subscriptionPlans.find(x => x.term_length === null))\n            .then(trialPlan =>\n              this.subscribe({\n                order_id: orderId,\n                subscription_plan_id: trialPlan.id,\n                credit_card_id: paymentInstrument.id,\n              })\n            )\n            .catch(() => icExpressModalService.open(modalInitialState))\n            .finally(finish)\n        }\n        // Open sign up modal for manual input of credit card information\n        return icExpressModalService.open(modalInitialState).finally(finish)\n      }\n\n      /**\n       * Updates the user current Express subscription\n       *\n       * @param { object } data\n       *\n       * @example data:\n       *\n       * {\n       *   \"subscription_plan_id\": 50,\n       *   \"credit_card_id\": 12324, //optional\n       *   \"next_subscription_plan_id\": 12, // optional\n       *   \"cancel\": true, //optional\n       *   \"autorenew\": true, // optional\n       *   \"send_reminder_email\": 'true', // has to be a string for some reason\n       * }\n       *\n       * @returns { Promise }\n       *\n       * @example promise returns to:\n       * {\n       *   \"eligible_for_trial\":false,\n       *   \"was_express_member\":true,\n       *   \"current_subscription\": { ... }\n       * }\n       */\n      service.updateSubscription = data => {\n        return service.updateSubscriptionThunk(data).then(service.reloadUserCurrentSubscriptionPlan)\n      }\n\n      /**\n       *\n       * Toggles the users reminder on/off.\n       * Will flip from on to off or off to on if 'toggle' is not passed\n       * Will get the subscription id from the current subscription if no\n       * subscription id is passed\n       *\n       * @param { string } id, optional, the subscription id\n       * @param { boolean } toggle, optional, whether to turn it on or off\n       *\n       * @returns { Promise<Subscription> }\n       *\n       * @example promise subscription object:\n       */\n      service.toggleReminder = (id, toggle) => {\n        const payload = {\n          subscription_id: id || service?.userCurrentSubscription?.subscription?.id,\n        }\n        if (toggle === false || toggle === true) {\n          payload.send_reminder_email = toggle.toString()\n        } else if (service.userCurrentSubscription.subscription.send_reminder_on) {\n          payload.send_reminder_email = 'false'\n        } else {\n          payload.send_reminder_email = 'true'\n        }\n\n        return service.updateSubscription(payload)\n      }\n\n      service.getReminderDate = () => {\n        return dayjs(service.userCurrentSubscription?.subscription?.send_reminder_on)\n      }\n\n      /**\n       * Tells us if the user is eligible for a trial or not\n       *\n       * @returns {boolean} trial eligibility\n       */\n      // TODO IN THE FUTURE, THIS CAN PROBABLY BE REPLACED WITH:\n      // `service.getMembershipStatus() === MEMBERSHIP_STATUSES.TRIAL_ELIGIBLE`\n      service.isEligibleForTrial = () => {\n        return service\n          .getCurrentSubscription()\n          .then(() => service.userCurrentSubscription?.eligible_for_trial)\n      }\n\n      /**\n       * Tells us if the user has an expired membership\n       *\n       * @returns {boolean} expired membership\n       */\n      service.isExpiredMembership = () => {\n        return service\n          .getCurrentSubscription()\n          .then(\n            () =>\n              !service.userCurrentSubscription?.eligible_for_trial &&\n              service.userCurrentSubscription?.was_express_member &&\n              _.isEmpty(service.userCurrentSubscription?.subscription)\n          )\n      }\n\n      /**\n       * Determines if a placement is configured to be enabled\n       *\n       * @param { string } placement string\n       * @returns { boolean } true means config is enabled\n       */\n      service.isPlacementConfigEnabled = placement => {\n        return isPlacementConfigEnabled({\n          placement,\n          isInEcomLightMode: eComLightService.inEComLightMode,\n          icExpress,\n          intent: auth.getContext().intent,\n          userConfigContext: service.expressUserConfigContext,\n        })\n      }\n\n      /**\n       * Determines if a placement should be shown based off the following:\n       * - Is enabled in the config\n       * - Has not be acknowledged by the user\n       * - The user is not already an IC express member\n       * This should be used for placements that can be acknowledged\n       *\n       * @param { string } placement string\n       * @returns { boolean } true means visible\n       */\n      service.shouldShowDynamicPlacement = placement => {\n        return shouldShowDynamicPlacement({\n          placement,\n          intent: auth.getContext().intent,\n          userStatus: auth.user?.status,\n          isPlacementConfigEnabled: service.isPlacementConfigEnabled(placement),\n          currentSubscription: service.userCurrentSubscription,\n        })\n      }\n\n      /**\n       * Returns the localStorage key for a given Express *placement*\n       * for the user current shopping mode\n       *\n       * @param { string } placement - Express placement identifier\n       *\n       * @returns { string }\n       */\n      service.getLocalStorageKey = placement =>\n        getExpressLocalStorageKey(placement, auth.getContext().intent)\n\n      /**\n       * Saves to the local storage that a placement is acknowledged\n       *\n       * @param { string } placement string\n       * @returns { undefined }\n       */\n      service.acknowledgePlacement = placement => {\n        acknowledgePlacement(placement, auth.getContext().intent)\n      }\n\n      /**\n       * Returns a membership status based on the user current subscription plan\n       *\n       * @returns {string}\n       */\n      service.getMembershipStatus = () => getMembershipStatus(this.userCurrentSubscription)\n\n      /**\n       * Returns true if the user has signed up to express\n       *\n       * @returns {boolean}\n       */\n      service.hasSubscription = () => {\n        return !!this.userCurrentSubscription?.subscription?.subscription_plan\n      }\n\n      /**\n       * Returns the number of remaining days of the user current subscription plan\n       *\n       * @returns { Number }\n       */\n      service.getMembershipRemainingDays = () => {\n        if (!service.userCurrentSubscription) return 0\n\n        return Math.floor(\n          dayjs(service.userCurrentSubscription.subscription.end_date).diff(dayjs(), 'days')\n        )\n      }\n\n      /**\n       * Returns the string representing the remaining duration of the user's current subscription plan\n       *\n       * @returns { string }\n       */\n      service.getMembershipRemainingString = () => {\n        return dayjs.duration(service.getMembershipRemainingDays(), 'days').humanize()\n      }\n\n      service.getMembershipEndDate = () => {\n        if (\n          service.getMembershipStatus() === MEMBERSHIP_STATUSES.TRIAL_ELIGIBLE ||\n          !service.userCurrentSubscription\n        ) {\n          return dayjs().add(config.icExpress.trialDays, 'days')\n        }\n\n        return dayjs(service.userCurrentSubscription?.subscription?.end_date)\n      }\n\n      service.dismissMessage = position => {\n        service[`${position}Message`] = null\n      }\n\n      service.setMessage = (message, title, type, position = MESSAGE_PLACEMENTS.TOP) => {\n        service.clearMessages()\n        service[`${position}Message`] = _generateMessage(message, title, type)\n      }\n\n      service.clearMessages = () => {\n        service[`${MESSAGE_PLACEMENTS.TOP}Message`] = null\n        service[`${MESSAGE_PLACEMENTS.PAYMENT}Message`] = null\n        service[`${MESSAGE_PLACEMENTS.MEMBERSHIP}Message`] = null\n      }\n\n      service.isExpressApplicable = () => {\n        return EXPRESS_APPLICABLE_STATUSES.includes(service.getMembershipStatus())\n      }\n\n      service.isTrial = () => service.getMembershipStatus() === MEMBERSHIP_STATUSES.TRIAL\n      service.isCoupon = () => service.getMembershipStatus() === MEMBERSHIP_STATUSES.COUPON\n\n      service.isTrialEligible = () =>\n        service.getMembershipStatus() === MEMBERSHIP_STATUSES.TRIAL_ELIGIBLE\n\n      service.isMember = () => service.getMembershipStatus() === MEMBERSHIP_STATUSES.MEMBERSHIP\n\n      service.isMembershipEligible = () =>\n        service.getMembershipStatus() === MEMBERSHIP_STATUSES.MEMBERSHIP_ELIGIBLE\n\n      service.isYearlyMember = async () => {\n        const planID =\n          service.userCurrentSubscription &&\n          service.userCurrentSubscription.subscription &&\n          service.userCurrentSubscription.subscription.subscription_plan &&\n          service.userCurrentSubscription.subscription.subscription_plan.id\n\n        return (\n          service.isMembershipEligible() &&\n          planID === (await this.getPlanIds(EXPRESS_SUBSCRIPTION_PLAN_TERMS.YEARLY))\n        )\n      }\n\n      service.isMonthlyMember = async () => {\n        const planID =\n          service.userCurrentSubscription &&\n          service.userCurrentSubscription.subscription &&\n          service.userCurrentSubscription.subscription.subscription_plan &&\n          service.userCurrentSubscription.subscription.subscription_plan.id\n\n        return (\n          service.isMembershipEligible() &&\n          planID === (await this.getPlanIds(EXPRESS_SUBSCRIPTION_PLAN_TERMS.MONTHLY))\n        )\n      }\n\n      service.isRefundEligible = () =>\n        service.isMember() && service.userCurrentSubscription.subscription.refund_eligible\n\n      service.getNextPlan = () => {\n        return (\n          (service.userCurrentSubscription.subscription &&\n            service.userCurrentSubscription.subscription.next_subscription_plan) ||\n          {}\n        )\n      }\n\n      service.getPlanType = () => {\n        if (service.isTrial()) {\n          return lang.values.icExpress.trial\n        }\n\n        if (service.isMember()) {\n          return lang.values.icExpress.membership\n        }\n\n        return ''\n      }\n\n      service.getAdList = async () => {\n        const { trial, monthly, yearly } = config.icExpress.ad.valuePropositions\n        const valuePropositionsVariants = config.icExpress.ad.valuePropositionsVariants\n\n        const valuePropositionsVariant = getConfigByRule(\n          service.expressUserConfigContext,\n          valuePropositionsVariants\n        )\n\n        const isYearlyMember = await service.isYearlyMember()\n        const isMonthlyMember = await service.isMonthlyMember()\n\n        if (valuePropositionsVariant) {\n          return valuePropositionsVariant\n        }\n\n        if (service.isTrial() || service.isTrialEligible()) {\n          return trial\n        }\n\n        if (isYearlyMember || service.isMembershipEligible()) {\n          return yearly\n        }\n\n        if (isMonthlyMember) {\n          return monthly\n        }\n\n        return []\n      }\n\n      /**\n       * Returns the terms and conditions text based on the user status\n       *\n       * @returns { string }\n       */\n      service.getTermsAndConditions = () => {\n        const { icExpress } = config\n        const { label, url } = icExpress.termsAndConditions\n        const { TRIAL_ELIGIBLE, TRIAL } = MEMBERSHIP_STATUSES\n        const membershipStatus = service.getMembershipStatus()\n        const termsAndConditions = HTML_TEMPLATES.TERMS(url, label)\n        const { trialText, membershipText } = icExpress.termsAndConditions\n        const { name: express, minimumOrderAmount: minOrderAmount, trialDays } = icExpress\n\n        return lang.template(\n          [TRIAL_ELIGIBLE, TRIAL].includes(membershipStatus) ? trialText : membershipText,\n          {\n            express,\n            trialDays,\n            minOrderAmount,\n            termsAndConditions,\n            yearlyPrice: icExpress.plans.yearly.price,\n          }\n        )\n      }\n\n      /**\n       *\n       * @param { string } message\n       * @param { string } title\n       * @param { string } type\n       *\n       * @returns { Object }\n       */\n      function _generateMessage(title, message, type = MESSAGE_TYPES.SUCCESS) {\n        return {\n          type,\n          title,\n          message,\n        }\n      }\n\n      /**\n       * Updates the user Express membership plan.\n       * If the current plan is *trial*, it will set *next_subscription_plan_id*.\n       * Otherwise, it will set *subscription_plan_id*\n       *\n       * @param {number} planId - Express plan ID\n       *\n       * @returns {Promise}\n       */\n      service.updateMembershipPlan = planId => {\n        const currentSubscription = service.userCurrentSubscription?.subscription\n        const { ext_payer_id, ext_instrument_id: ext_id } = currentSubscription\n        const payload = {\n          ext_id,\n          ext_payer_id,\n          subscription_id: currentSubscription?.id,\n        }\n\n        payload.next_subscription_plan_id = planId\n\n        return service.updateSubscription(payload)\n      }\n    }\n  )\n","import angular from 'angular'\nimport template from '../../components/shared/facetedFilterModal/facetedFilterModal.html'\n\nexport default angular\n  .module('facetedFilterModalServicesModule', [])\n  .service(\n    'facetedFilterModalService',\n    function facetedFilterModalService($uibModal, uibModalAriaLabelService) {\n      /**\n       * Opens a faceted filter modal dialog.\n       * @param {FilterOptions} options Options to pass to modal\n       * @return {Promise<FilterResults>} The new filter options to be used\n       */\n      this.open = function (options) {\n        return $uibModal.open({\n          resolve: {\n            filterModalOptions() {\n              return options\n            },\n            ariaLabel: () => {\n              uibModalAriaLabelService.setLabel('Filters')\n            },\n          },\n          controller: 'facetedFilterModalController',\n          template,\n        }).result\n      }\n\n      return this\n    }\n  )\n","import _ from 'lodash'\nimport angular from 'angular'\n\nexport default angular\n  .module('facetedSearchServicesModule', [])\n  .service(\n    'facetedSearchService',\n    function facetedSearchService(\n      $q,\n      $state,\n      $stateParams,\n      Restangular,\n      config,\n      tagsService,\n      utilService\n    ) {\n      const service = this\n\n      service.categorizedFacetsObject = {}\n\n      service.hideFacets = true\n\n      // Not quite breadcrumbs, but keeps track of tags for each facet currently being filtered,\n      // allowing users to delete per tag or reset fully in the \"tag crumbs\" component in the UI\n      service.tagCrumbsArray = []\n      service.tagGroupDisplayNameArray = []\n\n      // We need to pass `group_display_name` for all queries that have the `tags` query param\n      service.setGroupDisplayName = (selected, selectedTagGroupDisplayName) => {\n        const selectedGroupDisplayNameIndex = service.tagGroupDisplayNameArray.indexOf(\n          selectedTagGroupDisplayName\n        )\n\n        if (selected && selectedGroupDisplayNameIndex < 0) {\n          service.tagGroupDisplayNameArray.push(selectedTagGroupDisplayName)\n        } else if (!selected && selectedGroupDisplayNameIndex > -1) {\n          service.tagGroupDisplayNameArray.splice(selectedGroupDisplayNameIndex, 1)\n        }\n\n        return service.tagGroupDisplayNameArray\n      }\n\n      service.setTagCrumbs = (selected, tag, tagType) => {\n        if ($stateParams.tags || $stateParams.brand_name || $stateParams.brand_names) {\n          const selectedTagCrumb = {\n            type: tagType,\n            name: tag,\n            display_name: tagsService.byVal(tag) ? tagsService.byVal(tag).name : tag,\n          }\n\n          const selectedTagCrumbIndex = _.findIndex(service.tagCrumbsArray, selectedTagCrumb)\n\n          if (selected && selectedTagCrumbIndex < 0) {\n            service.tagCrumbsArray.push(selectedTagCrumb)\n          } else if (!selected && selectedTagCrumbIndex > -1) {\n            service.tagCrumbsArray.splice(selectedTagCrumbIndex, 1)\n          }\n\n          // // Remove any tags or brands that are not in $stateParams\n          const cloneArray = angular.copy(service.tagCrumbsArray)\n          service.tagCrumbsArray = _.remove(cloneArray, tagCrumb => {\n            return (\n              _.includes($stateParams.tags, tagCrumb.name) ||\n              _.includes($stateParams.brand_name, tagCrumb.name) ||\n              _.includes($stateParams.brand_names, tagCrumb.name)\n            )\n          })\n\n          return service.tagCrumbsArray\n        }\n      }\n\n      service.generateTagCrumbsQueryParams = () => {\n        const brandNamesQueryParams = _.filter(service.tagCrumbsArray, tagCrumb => {\n          return tagCrumb.type === 'brand_name'\n        }).map(tag => tag.name)\n\n        const tagsQueryParams = _.filter(service.tagCrumbsArray, tagCrumb => {\n          return tagCrumb.type === 'tags'\n        }).map(tag => tag.name)\n\n        return {\n          brandNames: brandNamesQueryParams,\n          tags: tagsQueryParams,\n        }\n      }\n\n      service.removeTagCrumbByIndex = index => {\n        service.tagGroupDisplayNameArray.splice(index, 1)\n        service.tagCrumbsArray.splice(index, 1)\n        return service.tagCrumbsArray\n      }\n\n      service.resetTagCrumbs = () => {\n        service.tagGroupDisplayNameArray = []\n        return (service.tagCrumbsArray = [])\n      }\n\n      service.categorizeFacets = facetsArray => {\n        // Exclude any filters defined in the facets config\n        const filteredFacetsArray = facetsArray.filter(\n          facet =>\n            !config.facets.excludeSideFiltersByGroupDisplayName.includes(facet.group_display_name)\n        )\n\n        const brands = _.filter(filteredFacetsArray, facet => {\n          return facet.group_display_name === 'Brands'\n        })[0]\n        const categories = _.filter(filteredFacetsArray, facet => {\n          return facet.group_display_name === 'Categories'\n        })[0]\n        const sideFilters = _.filter(filteredFacetsArray, facet => {\n          return facet.group_priority >= 1\n        })\n\n        const allowedBrands = config.facets.allowedBrands\n        if (allowedBrands) {\n          brands.items = brands.items.filter(item => allowedBrands.includes(item.name))\n        }\n\n        return {\n          brands,\n          categories,\n          sideFilters,\n        }\n      }\n\n      service.getAllFacets = params => {\n        // The facets call was originally intended to take a list of category_ids, this\n        // may still be implemented in future. For now, map the single category_id value\n        // to category_ids and send that instead.\n        params.category_ids = params.category_id\n\n        const facetedParams = _.omit(params, ['category_id'])\n\n        // If facets is disabled or user is searching through a collection, kick out of this function.\n        if (!config.enableFacetedSearchFilters && !config.enableICSearch) {\n          return $q.resolve()\n        }\n        return Restangular.all('store_products')\n          .all('facets')\n          .getList(facetedParams)\n          .then(results => {\n            const hideFacets = results.default\n            const facets = results.plain()\n\n            const sortedFacets = facets.sort((a, b) => {\n              const priorityA = a.group_priority || 0\n              const priorityB = b.group_priority || 0\n\n              if (priorityA < priorityB) {\n                return -1\n              }\n              if (priorityA > priorityB) {\n                return 1\n              }\n              return 0\n            })\n            service.categorizedFacetsObject = service.categorizeFacets(sortedFacets)\n            // Hide facets on flyer categories, otherwise depend on the results of the call above.\n            service.hideFacets =\n              $state.current.name === 'main.shop.flyer.category' ? true : hideFacets\n\n            // Baseline facet groups should always be sorted by priority\n            return { sortedFacets, hideFacets: service.hideFacets }\n          })\n      }\n\n      service.getFacetDisplayName = name => {\n        const result = utilService.getObjects(service.categorizedFacetsObject.sideFilters, '', name)\n        return result[0]?.display_name || name\n      }\n\n      service.getTagName = tag => {\n        const tagTag = tagsService.byVal(tag)\n        if (config.enableFacetedSearchFilters || config.enableICSearch) {\n          const facetTag = service.getFacetDisplayName(tag)\n          if (facetTag !== tag) {\n            return facetTag\n          }\n          return tagTag?.name || tag\n        }\n        return tagTag?.name || tag\n      }\n    }\n  )\n","import _ from 'lodash'\nimport angular from 'angular'\nimport dayjs from 'dayjs'\n\nexport default angular\n  .module('flyerPreviewServicesModule', [])\n  .service('flyerPreviewService', function flyerPreviewService($q, Restangular, config) {\n    const emptyFlyerData = {\n      current: null,\n      previews: [],\n    }\n\n    this.flyerData = {} // Store flyer data against store id keys\n\n    this.fetchFlyerData = storeId => {\n      this.currentStoreId = storeId || 'noId' // If for whatever reason no store id is provided, store it against this.flyerData.noId\n\n      if (this.flyerData[this.currentStoreId]) {\n        return $q.resolve(this.flyerData[this.currentStoreId])\n      }\n      return Restangular.one('flyer/preview')\n        .get()\n        .then(flyerData => {\n          this.flyerData[this.currentStoreId] = {\n            current: flyerData.current || emptyFlyerData.current,\n            previews: !_.isNull(flyerData.preview) ? [flyerData.preview] : emptyFlyerData.previews,\n          }\n\n          // If config'd to do so, show user the first available flyer preview (if it exists) every time we fetchFlyerData\n          if (config.showPreviewFlyerAsDefault) {\n            this.setFirstAvailablePreviewToken()\n          }\n\n          return this.flyerData[this.currentStoreId]\n        })\n        .catch(\n          () =>\n            // Set and return this.flyerData\n            (this.flyerData[this.currentStoreId] = emptyFlyerData)\n        )\n    }\n\n    // If a preview timestamp was passed in on app init, flyerData will not have been fetched, so return empty flyer data\n    this.getFlyerData = () =>\n      this.previewTimestamp ? emptyFlyerData : this.flyerData[this.currentStoreId]\n\n    this.hasPreviewFlyers = flyerData =>\n      flyerData && flyerData.previews && flyerData.previews.length > 0\n\n    this.getPreviewTimestampDate = () =>\n      this.previewTimestamp ? dayjs(this.previewTimestamp).format('D MMMM, YYYY') : ''\n\n    this.getPreviewTimestamp = () => this.previewTimestamp\n\n    this.setPreviewTimestamp = previewTimestamp => {\n      this.previewTimestamp = previewTimestamp\n    }\n\n    this.getPreviewToken = () => this.previewToken\n\n    this.setPreviewToken = previewToken => {\n      this.previewToken = previewToken\n    }\n\n    this.setFirstAvailablePreviewToken = () => {\n      if (this.hasPreviewFlyers(this.flyerData[this.currentStoreId])) {\n        this.previewToken = this.flyerData[this.currentStoreId].previews[0].preview_token\n      } else {\n        // Clear preview token if the current store does not have a preview flyer\n        this.previewToken = null\n      }\n    }\n\n    this.getPreviewFlyerIndexBeingViewed = () => {\n      if (this.previewToken) {\n        return _.findIndex(this.flyerData[this.currentStoreId].previews, {\n          preview_token: this.previewToken,\n        })\n      }\n      return -1\n    }\n  })\n","import angular from 'angular'\nimport template from '../../components/shared/giftCardModal/giftCardModal.html'\n\nexport default angular\n  .module('giftCardModalServicesModule', [])\n  .service('giftCardModalService', function giftCardModalService($uibModal) {\n    /**\n     * Opens a gift card modal dialog.\n     * */\n    this.open = options => {\n      return $uibModal.open({\n        resolve: {\n          giftCardOptions: () => options,\n        },\n        controller: 'giftCardModalController',\n        template,\n      }).result\n    }\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('headerFooterServicesModule', [])\n  .run(($location, headerFooterSyncService) => {\n    const searchUrlParams = $location.search()\n    if (searchUrlParams?.['test-header']) {\n      headerFooterSyncService.testHeaderFile = searchUrlParams['test-header']\n    }\n    if (searchUrlParams?.['test-footer']) {\n      headerFooterSyncService.testFooterFile = searchUrlParams['test-footer']\n    }\n  })\n  .service(\n    'headerFooterSyncService',\n    function headerFooterSyncService(\n      $templateRequest,\n      $q,\n      config,\n      mobileService,\n      unataCommService\n    ) {\n      const service = this\n      // let testUrlParam;\n      const getHeaderSyncUrl = () => {\n        let headerSyncUrl\n        let defaultFileName\n        if (mobileService.isMobileApp()) {\n          // Return header for mobile app\n          headerSyncUrl = config.dotComModule.headerSyncUrl.mobileApp\n          defaultFileName = 'mobile-app-header.html'\n        } else if (!mobileService.isMobileApp() && mobileService.isMobile) {\n          // Return header for mobile web\n          headerSyncUrl = config.dotComModule.headerSyncUrl.mobileWeb\n          defaultFileName = 'mobile-web-header.html'\n        } else {\n          //Return header for desktop\n          headerSyncUrl = config.dotComModule.headerSyncUrl.desktop\n          defaultFileName = 'desktop-header.html'\n        }\n\n        if (service.testHeaderFile) {\n          headerSyncUrl =\n            headerSyncUrl.substring(0, headerSyncUrl.lastIndexOf('/') + 1) + service.testHeaderFile\n        } else if (headerSyncUrl.endsWith('/')) {\n          headerSyncUrl = headerSyncUrl + service.defaultFileName\n        }\n\n        if (headerSyncUrl && !headerSyncUrl.endsWith('.html')) {\n          headerSyncUrl = headerSyncUrl + '.html'\n        }\n\n        return headerSyncUrl\n      }\n\n      service.fetchHeader = () => {\n        const templateUrl = getHeaderSyncUrl()\n        if (templateUrl) {\n          return $templateRequest(templateUrl + '?ignoreCache=' + Date.now())\n        } else {\n          return $q.reject()\n        }\n      }\n\n      service.fetchFooter = () => {\n        let footerSyncUrl = config.dotComModule.footerSyncUrl\n        if (service.testFooterFile) {\n          footerSyncUrl =\n            footerSyncUrl.substring(0, footerSyncUrl.lastIndexOf('/') + 1) + service.testFooterFile\n        } else if (footerSyncUrl.endsWith('/')) {\n          footerSyncUrl = footerSyncUrl + 'desktop-footer.html'\n        }\n        if (footerSyncUrl && !footerSyncUrl.endsWith('.html')) {\n          footerSyncUrl = footerSyncUrl + '.html'\n        }\n        if (footerSyncUrl) {\n          return $templateRequest(footerSyncUrl + '?ignoreCache=' + Date.now())\n        } else {\n          return $q.reject()\n        }\n      }\n\n      service.afterHeaderLoaded = root => {\n        unataCommService.send({\n          eventType: unataCommService.EventType.HEADERLOADED,\n          payload: {\n            root,\n          },\n        })\n      }\n\n      service.afterFooterLoaded = root => {\n        unataCommService.send({\n          eventType: unataCommService.EventType.FOOTERLOADED,\n          payload: {\n            root,\n          },\n        })\n      }\n    }\n  )\n","import angular from 'angular'\n\nimport { isRxProduct } from '@instacart/enterprise-services/product/utils'\n\nexport default angular\n  .module('imageURLServicesModule', [])\n  .service('imageURLService', function imageURLService(utilService) {\n    const service = this\n\n    service.getProductImageURL = (product, size) => {\n      if (isRxProduct(product)) {\n        return require('static/images/rx-default-image.png')\n      }\n      // We need this here incase we get a cart item or a store product\n      const storeProduct = product?.store_product ? product.store_product : product\n      if (storeProduct) {\n        if (storeProduct.images.tile[size] === null) {\n          return require('static/images/no-product-image.jpg')\n        }\n        return utilService.escapeImageUrl(storeProduct.images.tile[size])\n      }\n    }\n\n    // TODO - Deprecate getProductImageURL function or make the images property configurable.\n    // This is for multiple product images\n    service.getProductImageURLFromArray = (product = {}, size) => {\n      if (product.tile && product.tile[size]) {\n        return utilService.escapeImageUrl(product.tile[size])\n      }\n      return require('static/images/no-product-image.jpg')\n    }\n\n    const getDefaultRecipeImageURL = shape => {\n      if (shape === 'square') {\n        return require('static/images/no-recipe-image-square.png')\n      }\n      if (shape === 'rectangle') {\n        return require('static/images/no-recipe-image-rectangle.png')\n      }\n      return null\n    }\n\n    service.getRecipeImageURL = (recipe, shape) => {\n      const recipeImageURL =\n        recipe &&\n        recipe.media &&\n        recipe.media[0] &&\n        recipe.media[0].image &&\n        recipe.media[0].image.header\n\n      return recipeImageURL\n        ? utilService.escapeImageUrl(recipeImageURL)\n        : getDefaultRecipeImageURL(shape)\n    }\n\n    service.getRecipeCategoryImageURL = recipeCategory => {\n      const recipeCategoryImageURL =\n        recipeCategory &&\n        recipeCategory.images &&\n        recipeCategory.images.tile &&\n        recipeCategory.images.tile.medium\n\n      return recipeCategoryImageURL\n        ? utilService.escapeImageUrl(recipeCategoryImageURL)\n        : getDefaultRecipeImageURL('square')\n    }\n\n    service.getSearchImageUrl = () => {\n      return require('static/images/no-product-image.jpg')\n    }\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('instacartServicesModule', [])\n  .service('instacartService', function instacartService($window) {\n    const service = this\n\n    service.goToInstacartLink = url => {\n      $window.open(url, '_blank')\n    }\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('icExpressModalServicesModule', [])\n  .service('icExpressModalService', function icExpressModalService($uibModal) {\n    /**\n     * Opens a ic express modal dialog.\n     * */\n    this.open = initialStep => {\n      return $uibModal.open({\n        template: `\n          <div id=\"icExpressModal\" class=\"modal-container ic-express-modal-container\">\n            <!--The modal header is needed so that on mobile the close button is visible-->\n            <div class=\"modal-header ic-express-modal-header\"></div>\n            <div class=\"modal-content\">\n              <button class=\"close\" ng-click=\"$ctrl.dismiss()\" aria-label=\"{{::config.lang.aria.modalClose}}\" auto-focus=\"true\">\n                <span class=\"icon-delete\" aria-hidden=\"true\"></span>\n              </button>\n              <ic-express-entry\n                initial-step=\"$ctrl.initialStep\"\n                on-success-redirect=\"$ctrl.dismiss()\"\n              ></ic-express-entry>\n            </div>\n          </div>\n          `,\n        controller($uibModalInstance) {\n          const $ctrl = this\n          $ctrl.dismiss = $uibModalInstance.dismiss\n          $ctrl.initialStep = initialStep\n        },\n        controllerAs: '$ctrl',\n      }).result\n    }\n  })\n","import _ from 'lodash'\nimport angular from 'angular'\nimport isMobileDevice from '@app/utils/isMobile'\n\nexport default angular\n  .module('langServicesModule', [])\n  .provider('lang', function lang(configConstants) {\n    const provider = this\n\n    provider.values = configConstants.lang // TODO: Handle multiple languages\n    provider.aria = configConstants.langAria\n    provider.errorMessages = configConstants.langErrorMessages\n\n    provider.$get = [\n      '$interpolate',\n      '$sanitize',\n      '$sce',\n      'config',\n      function ($interpolate, $sanitize, $sce, config) {\n        const service = this\n\n        service.values = angular.copy(provider.values)\n        service.aria = _.assign(angular.copy(provider.values), angular.copy(provider.aria))\n        service.errorMessages = angular.copy(provider.errorMessages)\n\n        service.safe = function (value) {\n          return $sce.trustAsHtml(value)\n        }\n\n        service.getValue = function (key) {\n          return key.split('.').reduce((prev, curr) => {\n            return prev ? prev[curr] : undefined\n          }, configConstants.lang)\n        }\n\n        /**\n         * TODO:\n         * Memoize\n         * Default to template as string\n         */\n\n        service.template = function (str, values) {\n          return $sce.trustAsHtml(service.templateAsString(str, values))\n        }\n\n        service.pluralize = (key, count) => {\n          const keyPlural = `${key}Plural`\n\n          if (count === 1) {\n            return key\n          }\n\n          if (keyPlural in service.values) {\n            return service.values[keyPlural]\n          }\n\n          return service.values[key]\n        }\n\n        service.templateAsString = function (str, values) {\n          // Replace ES6-style formatted strings with angular expressions\n          const expStr = str ? str.replace(/\\$\\{([^}]+)\\}/g, '{{$1}}') : ''\n\n          // Interpolate with the provided values, allowing HTML injection\n          const exp = $interpolate(expStr)\n\n          return exp(values)\n        }\n\n        service.sanitize = $sanitize\n\n        service.getErrorMessage = code => {\n          // Make sure it's a string\n          const errorKey = `${code}`\n          const { errorMessages } = service\n          return (\n            (isMobileDevice(config) && errorMessages?.mobile?.[errorKey]) ||\n            errorMessages?.default?.[errorKey]\n          )\n        }\n\n        return service\n      },\n    ]\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('LegacyModalModule', [])\n  .service('legacyModalService', function legacyModalService($uibModalStack) {\n    const service = this\n\n    service.closeOpenModals = () => {\n      if ($uibModalStack.getTop()) {\n        $uibModalStack.dismissAll()\n      }\n    }\n  })\n","import _ from 'lodash'\nimport fp from 'lodash/fp'\nimport angular from 'angular'\nimport * as userListSelectors from '@app/services/userList/selectors'\nimport * as userListThunks from '@app/services/userList/thunks'\nimport {\n  findIndexOfItemInList,\n  findItemInList,\n  findItemsInList,\n  findItemsInSomeList,\n} from '@app/services/userList/utils'\n\nexport default angular\n  .module('ListServicesModule', [])\n  .service(\n    'list',\n    function list(\n      $ngRedux,\n      $q,\n      $rootScope,\n      auth,\n      cartService,\n      config,\n      configurableProductService,\n      errorModalService\n    ) {\n      const service = this\n      service.lists = []\n\n      const mapStateToService = state => {\n        // Careful not to assign anything directly to service.lists or that will break all the pointers\n        service.lists.length = 0\n        userListSelectors.userListsSelector(state).forEach(list => {\n          service.lists.push(angular.copy(list))\n        })\n\n        return {}\n      }\n      $ngRedux.connect(mapStateToService, {\n        ...userListThunks,\n      })(service)\n\n      service.refresh = () => service.fetchUserLists()\n\n      service.getList = (listId, requirePricing) =>\n        service.fetchUserList({ listId, requirePricing })\n\n      service.formatListItem = function (item, configuration) {\n        if (item.store_product) {\n          const wrapped = _.clone(item)\n          wrapped.order_by_weight = item.store_product.order_by_weight\n          return wrapped\n        }\n        let selectedConfiguration\n        if (configuration) {\n          selectedConfiguration = angular.copy(item.product_config)\n          selectedConfiguration.options = configuration\n        }\n\n        return {\n          item_type: 'store_product',\n          store_product: item,\n          order_by_weight: item.order_by_weight,\n          quantity: item.ordering_parameters.min,\n          product_config: selectedConfiguration || null,\n        }\n      }\n\n      // If configuration is provided, we assume it is a selected configuration from the PDP and that items is therefore of length 1\n      service.create = function (name, items, configuration) {\n        const wrappedList = []\n\n        if (items) {\n          _.each(items, item => {\n            wrappedList.push(service.formatListItem(item, configuration))\n          })\n        }\n\n        if (name) {\n          return service\n            .createUserList({\n              items: wrappedList,\n              name,\n            })\n            .catch(response => {\n              const errorMsg = response.data ? response.data.message : response.message\n              return errorModalService.open(errorMsg, 'OK')\n            })\n        }\n        return $q.reject()\n      }\n\n      service.remove = function (list) {\n        const deferred = $q.defer()\n\n        if (list) {\n          errorModalService\n            .open('Are you sure you want to delete this list?', 'OK', 'Cancel', 'Confirm')\n            .then(() => {\n              service.removeUserList(list).then(() => {\n                deferred.resolve()\n              })\n            })\n        }\n\n        return deferred.promise\n      }\n\n      service.update = list => {\n        const deferred = $q.defer()\n\n        service.updateUserList(list).then(() => {\n          deferred.resolve()\n        })\n\n        return deferred.promise\n      }\n\n      // If configuration is provided, we assume it's a selected configuration from the PDP\n      service.itemInList = (item, list, configuration, shouldReturnIndex) => {\n        let itemIndexInList\n        let sanitizedSelectedItemConfiguration\n        const itemProductId = service.formatListItem(item).store_product.id\n\n        if (item.product_config && item.product_config.options) {\n          if (configuration) {\n            // We're checking to see if a selected configuration in the PDP is in the given list\n            sanitizedSelectedItemConfiguration = configurableProductService.formatConfigForComparison(\n              configuration\n            )\n          } else {\n            // We're checking to see if an item (from the cart, from a list) is in the given list\n            sanitizedSelectedItemConfiguration = configurableProductService.formatConfigForComparison(\n              item.product_config.options\n            )\n          }\n\n          itemIndexInList = _.findIndex(list.items, listItem => {\n            if (listItem.product_config && listItem.product_config.options) {\n              // eslint-disable-next-line eqeqeq\n              const hasSameProductId = listItem.store_product.id == itemProductId\n              const sanitizedListItemConfiguration = configurableProductService.formatConfigForComparison(\n                listItem.product_config.options\n              )\n              return (\n                hasSameProductId &&\n                configurableProductService.areProductConfigsAndOptionsEqual(\n                  sanitizedSelectedItemConfiguration,\n                  sanitizedListItemConfiguration\n                )\n              )\n            }\n            return false\n          })\n        } else {\n          itemIndexInList = _.findIndex(\n            list.items,\n            // eslint-disable-next-line eqeqeq\n            listItem => listItem.store_product.id == itemProductId\n          )\n        }\n\n        return shouldReturnIndex ? itemIndexInList : itemIndexInList !== -1\n      }\n\n      service.itemInList = (item, list, configuration, shouldReturnIndex) =>\n        shouldReturnIndex\n          ? findIndexOfItemInList(item, list, configuration)\n          : findItemInList(item, list, configuration)\n\n      // If configuration is provided, we assume it is a selected configuration from the PDP and that items is therefore of length 1\n      service.itemsInList = (items, list, configuration) =>\n        findItemsInList(items, list, configuration)\n\n      // If configuration is provided, we assume it is a selected configuration from the PDP and that items is therefore of length 1\n      service.itemsInOneList = (items, configuration) =>\n        findItemsInSomeList(items, service.lists, configuration)\n\n      const updateList = (currentList, updatedList) =>\n        service\n          .updateUserList(updatedList)\n          .then(response => {\n            currentList.items = angular.copy(response.payload.items)\n          })\n          .finally(() => {\n            currentList.isSyncing = false\n          })\n\n      // If configuration is provided, we assume it is a selected configuration from the PDP and that items is therefore of length 1\n      service.addItems = (items, list, configuration) => {\n        list.isSyncing = true\n\n        const listItemsToAdd = fp.flow(\n          fp.filter(item => !service.itemInList(item, list, configuration)),\n          fp.map(item => service.formatListItem(item, configuration))\n        )(items)\n\n        if (listItemsToAdd.length > 0) {\n          const updatedList = angular.copy(list)\n          updatedList.items = list.items.concat(listItemsToAdd)\n\n          return updateList(list, updatedList)\n        }\n        list.isSyncing = false\n        return $q.resolve()\n      }\n\n      // If configuration is provided, we assume it is a selected configuration from the PDP and that items is therefore of length 1\n      service.removeItems = (items, list, configuration, requirePricing = true) => {\n        list.isSyncing = true\n\n        const updatedList = angular.copy(list)\n        updatedList.items = angular.copy(list.items)\n\n        let hasItemsToRemove = false\n        _.each(items, itemToRemove => {\n          const itemToRemoveIndexInList = service.itemInList(\n            itemToRemove,\n            list,\n            configuration,\n            true\n          )\n\n          if (itemToRemoveIndexInList !== -1) {\n            updatedList.items[itemToRemoveIndexInList].quantity = 0\n            hasItemsToRemove = true\n          }\n        })\n\n        if (hasItemsToRemove) {\n          return updateList(list, { ...updatedList, require_pricing: requirePricing })\n        }\n        list.isSyncing = false\n        return $q.resolve()\n      }\n\n      service.loadListToCart = cartService.loadListToCart\n\n      $rootScope.$on('auth', (event, action) => {\n        if (action === 'userLoggedIn') {\n          service.refresh()\n        }\n      })\n    }\n  )\n","import _ from 'lodash'\nimport angular from 'angular'\n\nexport default angular\n  .module('ListPrintServicesModule', [])\n  .service(\n    'listPrintService',\n    function listPrintService(\n      $compile,\n      $rootScope,\n      $templateCache,\n      $timeout,\n      auth,\n      configurableProductService\n    ) {\n      const service = this\n\n      // Print a given list / cart\n      service.printList = function (list, title) {\n        // Categorize products, making sure no subscriptions or other products\n        // without categories end up in the list\n\n        const items = _.filter(list, item => {\n          if (item.store_product && item.store_product.product_config) {\n            // Create a configuration string if product has configurations\n            item.configString = configurableProductService.configsString(item)\n          }\n          return (\n            item.store_product &&\n            item.store_product.categories &&\n            item.store_product.categories.length > 0\n          )\n        })\n\n        const categorizedItems = _.groupBy(items, item => {\n          return item.store_product.categories[0]\n            ? item.store_product.categories[0].name\n            : 'Uncategorized'\n        })\n\n        const customItems = _.filter(list, { item_type: 'pseudo_product' })\n\n        if (customItems.length) {\n          categorizedItems['Custom Items'] = customItems\n        }\n\n        const templateScope = $rootScope.$new()\n        templateScope.categorizedItems = categorizedItems\n        templateScope.title = title\n        // Add the store details.\n        templateScope.store = auth.user.store\n\n        const template = $templateCache.get('printInStoreList.html')\n        const templateEl = $compile(template)(templateScope)[0]\n\n        const printWindow = window.open()\n        printWindow.addEventListener('beforeunload', () => {\n          templateScope.$destroy()\n        })\n\n        // TODO: This is a very hacky way to get the proper css in the print template\n        // a better solution would be to completely isolate out the css for this template\n        const inlineStyles = [\n          ...Array.prototype.slice.call(angular.element(document.querySelectorAll('head > style'))),\n        ]\n          .map(style => `${style.outerHTML}`)\n          .join(' ')\n        const linkedStyles = [\n          ...Array.prototype.slice.call(\n            angular.element(document.querySelectorAll('head > [rel=\"stylesheet\"]'))\n          ),\n        ]\n          .map(style => `<link href=\"${style.href}\" rel=\"stylesheet\">`)\n          .join(' ')\n\n        // Wait for digest to allow $compile to do its thing with templateEl\n        $timeout(() => {\n          printWindow.document.write(`\n          <html>\n            <head>\n              <title>${title}</title>\n              ${inlineStyles}\n              ${linkedStyles}\n            </head>\n            <body onload=\"setTimeout(function() { window.print();setTimeout(function() { window.close(); }, 0)}, 250);\">${templateEl.outerHTML}</body>\n          </html>\n        `)\n          printWindow.document.close()\n          printWindow.focus()\n        })\n      }\n    }\n  )\n  .run($templateCache => {\n    $templateCache.put(\n      'printInStoreList.html',\n      require('../../components/shared/util/printInStoreList.html')\n    )\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('loyaltyServicesModule', [])\n  .service(\n    'loyaltyService',\n    function loyaltyService($state, auth, cartService, config, lang, userService) {\n      const service = this\n\n      service.showLoyaltyPlacement = () =>\n        config.enableLoyaltyPricing &&\n        (!userService.loyaltyCards.length || auth.user.status === 'trial')\n\n      /**\n       * This method accepts a rewards *source* object. It iterates over it and returns\n       * only the visible ones\n       *\n       * @param {object} - source\n       * @returns {object[]}\n       */\n      service.getVisibleRewards = (source = {}) => {\n        const { rewards } = config\n\n        const rewardsMap = rewards.visible.map(rewardKey => {\n          const rewardLang = lang.values.rewards[rewardKey]\n          const { altLabel, error, label, primaryInfo, secondaryInfo } = rewardLang || {}\n          const rewardBase = {\n            id: rewardKey,\n            label: label || rewardKey,\n            altLabel: altLabel || rewardKey,\n          }\n          const sourceReward = source[rewardKey]\n          let amount\n          let visible\n\n          // if the reward value is an object\n          if (sourceReward && typeof sourceReward === 'object') {\n            amount = sourceReward.amount\n            visible = sourceReward.visible\n          }\n\n          // if the reward value is a string\n          if (typeof sourceReward === 'string') {\n            amount = sourceReward\n            visible = true\n          }\n\n          const rewardAmount = -Math.abs(parseFloat(amount))\n\n          return Object.keys(source).includes(rewardKey)\n            ? {\n                ...rewardBase,\n                amount: rewardAmount,\n                primaryInfo,\n                visible,\n                secondaryInfo: lang.template(secondaryInfo, {\n                  link: $state.href(rewards?.details?.[rewardKey]?.state, {}),\n                }),\n              }\n            : { ...rewardBase, amount: 0, primaryInfo: error, secondaryInfo: '', visible: true } // show error\n        })\n\n        return rewardsMap.filter(reward => reward.visible)\n      }\n    }\n  )\n","import angular from 'angular'\n\nexport default angular\n  .module('manualUpsellServicesModule', [])\n  .service('manualUpsellService', function manualUpsellService(Restangular, auth, config) {\n    const service = this\n\n    service.manualUpsellProducts = null\n\n    service.getUpsellProducts = (forceReload = false) => {\n      if (!forceReload && service.manualUpsellProducts) {\n        return service.manualUpsellProducts\n      }\n      const authMode = auth.user.status === 'trial' ? 'trial' : 'loggedIn'\n      const sort = config.defaultSort[authMode] ? config.defaultSort[authMode].shop : 'score'\n\n      return Restangular.all('cart')\n        .all(`manual_upsell?sort=${sort}`)\n        .getList()\n        .then(products => (service.manualUpsellProducts = products))\n        .catch(() => (service.manualUpsellProducts = []))\n    }\n  })\n","import _ from 'lodash'\nimport angular from 'angular'\n\nexport default angular\n  .module('masterServicesModule', [])\n  .service('master', function master($rootScope) {\n    const service = this\n\n    let slaveWindows = []\n    const messageListeners = []\n\n    // Registers a callback that is called when a message from another window is received\n    // eslint-disable-next-line no-multi-assign\n    const addMessageListener = (service.addMessageListener = function addMessageListener(callback) {\n      messageListeners.push(callback)\n    })\n\n    // Receives messages from other windows\n    window.addEventListener('message', event => {\n      if (event.data) {\n        let msg\n        try {\n          msg = JSON.parse(event.data)\n        } catch (e) {} // ignore non-JSON messages\n\n        // if we received a valid JSON message, notify everyone\n        if (msg) {\n          messageListeners.forEach(callback => {\n            callback(msg, event)\n          })\n\n          $rootScope.$apply()\n        }\n      }\n    })\n\n    // Send a message to another window.\n    // If `targetWindow` is not specified, send it to all registered slaves\n    service.postMessage = function postMessage(msg, targetWindow) {\n      if (!targetWindow) {\n        slaveWindows.forEach(slaveWindow => {\n          if (!slaveWindow.closed) {\n            slaveWindow.postMessage(JSON.stringify(msg), window.location.origin || '*')\n          } else {\n            slaveWindows = _.without(slaveWindows, slaveWindow)\n          }\n        })\n      } else if (!targetWindow.closed) {\n        targetWindow.postMessage(JSON.stringify(msg), '*')\n      }\n    }\n\n    // Listen for messages from slave windows\n    addMessageListener((msg, event) => {\n      if (msg.module === 'slave') {\n        switch (msg.method) {\n          case 'register':\n            slaveWindows = _.union(slaveWindows, [event.source])\n            break\n        }\n      }\n    })\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('masterCartServicesModule', [])\n  .run(($rootScope, cartService, master) => {\n    // Listen for cart message from other windows\n    master.addMessageListener((msg, event) => {\n      if (msg) {\n        if (msg.module === 'cartService') {\n          switch (msg.method) {\n            case 'getItem':\n              msg.method += '.result'\n              msg.result = cartService.getItem(msg.args[0])\n              master.postMessage(msg, event.source)\n              break\n            case 'addItem':\n              cartService.addItem(msg.args[0], msg.args[1])\n              break\n            case 'removeItem':\n              cartService.removeItem(msg.args[0])\n              break\n            case 'fetch': {\n              let { cart } = cartService\n              if (typeof cart.plain === 'function') {\n                cart = cart.plain()\n              }\n              msg.method += '.result'\n              msg.result = cart\n              master.postMessage(msg, event.source)\n              break\n            }\n          }\n        }\n      }\n    })\n\n    // When items are added/removed from cart, notify slave windows\n    $rootScope.$on('cartService', (event, action, item, quantity) => {\n      switch (action) {\n        case 'add':\n          master.postMessage({\n            module: 'cartService',\n            method: 'addItem',\n            args: [item.store_product, quantity],\n          })\n          break\n\n        case 'remove':\n          master.postMessage({\n            module: 'cartService',\n            method: 'removeItem',\n            args: [item.store_product],\n          })\n          break\n      }\n    })\n  })\n","import angular from 'angular'\nimport { windowManager } from '@instacart/enterprise-services-cordova'\nimport { UnataComm, EventType } from '@instacart/enterprise-services-unata-comm'\n\nexport default angular\n  .module('mobileNativeHrefServicesModule', [])\n  .service(\n    'mobileNativeHrefService',\n    function mobileNativeHrefService($injector, $location, $rootScope, auth) {\n      const service = this\n\n      const unataComm = new UnataComm()\n\n      /**\n       * Public Methods\n       */\n\n      service.openAuthUrl = windowManager.openAuthUrl\n\n      service.waitForBrowserClose = windowManager.waitForBrowserClose\n\n      // This was added in because FirstDataV2 JS SDK does not work correctly inside cordova.\n      // This loads the checkout page inside the InAppBrowser and injects the script which reloads\n      // the page when it's no longer inside the checkout flow.\n      // https://instacart.quip.com/wGX6AC58bxuT/FirstData-V2-Javascript-Issue\n      service.openCheckoutInInappBrowser = urlPath => {\n        windowManager.openPlatformPath(urlPath, {\n          closeOnReload: true,\n          code: `(\n          function() {\n            setTimeout(\n              function() {\n                var states = [\n                  'main.checkout.cart',\n                  'main.checkout.cartV2',\n                  'main.checkout.manualUpsell',\n                  'main.checkout.reservation',\n                  'main.checkout.reservation.address',\n                  'main.checkout.reservation.confirmation',\n                  'main.checkout.payment',\n                  'main.checkout.confirmation',\n                  'main.checkout.customUpsell',\n                  'main.checkout.checkoutPage'\n                ];\n                var rootScope = angular.element(document.body)\n                  .injector()\n                  .get('$rootScope');\n                window.inAppBrowser = true;\n                rootScope.$on('$locationChangeSuccess', function(a) {\n                  var state = angular.element(document.body).injector().get('$state');\n                  if (states.indexOf(state.current.name) === -1) {\n                    window.location.reload();\n                  }\n                });\n              }, 250\n            )\n            return true;\n          })()\n        `,\n          onClose: () => {\n            // Fetch the cart again after the checkout flow closes\n            // eslint-disable-next-line no-unused-expressions\n            $injector.get('cartService')?.fetch()\n          },\n        })\n      }\n\n      /**\n       * Private Methods\n       */\n\n      const onNavigateToUrl = event => {\n        $location.url(event.data.payload.url)\n\n        // $apply only if not already in $apply.\n        if (!$rootScope.$$phase) {\n          $rootScope.$apply()\n        }\n      }\n\n      const onReloadUser = _event => {\n        auth.reloadIfUserChanged()\n      }\n\n      /**\n       * Event Listeners\n       */\n\n      // Important! Sets up global listeners for clicks, window opens, and comms\n      windowManager.listen()\n\n      unataComm.listen(EventType.NAVIGATETOURL, onNavigateToUrl)\n\n      unataComm.listen(EventType.RELOADUSER, onReloadUser)\n\n      unataComm.listen(EventType.OPENSIDECART, () => {\n        $rootScope.$broadcast('sideCart', 'open')\n      })\n\n      $rootScope.$on('$locationChangeStart', (_event, newUrl, oldUrl) => {\n        const payload = {\n          old_url: oldUrl,\n          new_url: newUrl,\n          platform: 'mobile-app',\n        }\n\n        unataComm.send({\n          eventType: EventType.LOCATIONCHANGE,\n          payload,\n        })\n      })\n    }\n  )\n","import angular from 'angular'\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\nimport { eventEmitter, EVENT_TYPES } from '@app/utils/eventEmitter'\nimport { actions as searchActions } from '@app/services/search/slice'\n\nexport default angular\n  .module('mobileNavServicesModule', [])\n  .service('mobileNavService', function mobileNavService($ngRedux, $rootScope, utilService) {\n    const service = this\n    let removeTrapFocus = () => {}\n\n    // bind searchActions to this(service)\n    $ngRedux.connect(null, { ...searchActions })(service)\n\n    service.handleEscKeyDown = event => {\n      if (event.keyCode === 27 && service.slideOutMenuIsVisible) {\n        service.hideSlideOutMenu()\n        // Force angular to re-render\n        $rootScope.$apply()\n      }\n    }\n\n    service.slideOutMenuIsVisible = false\n\n    service.hideSlideOutMenu = () => {\n      service.slideOutMenuIsVisible = false\n      removeTrapFocus()\n      // eslint-disable-next-line no-unused-expressions\n      document.querySelector('button.menu-toggle')?.focus()\n      document.removeEventListener('keydown', service.handleEscKeyDown)\n    }\n\n    service.showSlideOutMenu = () => {\n      service.slideOutMenuIsVisible = true\n      const el = document.querySelector('#mobile-side-nav')\n\n      if (el) {\n        removeTrapFocus = utilService.trapFocusOn(el, true)\n        document.addEventListener('keydown', service.handleEscKeyDown)\n      }\n    }\n\n    service.setSlideOutMenu = val => {\n      if (val) {\n        service.showSlideOutMenu()\n      } else {\n        service.hideSlideOutMenu()\n      }\n    }\n\n    service.toggleSlideOutMenu = () => {\n      if (service.slideOutMenuIsVisible) {\n        service.hideSlideOutMenu()\n      } else {\n        service.showSlideOutMenu()\n      }\n    }\n\n    // TODO: Removal of event emitter after sideout menu conversion\n    eventEmitter.on(EVENT_TYPES.TOGGLE_SLIDEOUT_MENU, () => {\n      service.toggleSlideOutMenu()\n      $rootScope.$apply()\n    })\n  })\n  .service('navService', function navService(auth, config, lang) {\n    const service = this\n\n    service.getCartListReviewItems = () => {\n      const shoppingMode = auth.getCurrentShoppingMode()\n      const { navigation } = config.cartReview\n      const { params } = config.eComLight.homeRedirect || {}\n      const navItemsConfig = navigation[shoppingMode] || navigation.default\n\n      return navItemsConfig.map(item => {\n        const itemParams =\n          shoppingMode === SHOPPING_MODES.CATERING && item.state ? { ...params } : {}\n\n        return {\n          ...item,\n          params: itemParams,\n          label: lang.values[item.langKey] || item.langKey,\n        }\n      })\n    }\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('modalOptionsServiceModule', [])\n  .service('modalOptions', function modalOptions() {\n    const service = this\n    const DEFAULT_OPTIONS = {\n      showCloseButton: true,\n      showBackButton: true,\n      showTimeslotSelectLaterLink: true,\n    }\n\n    service.options = { ...DEFAULT_OPTIONS }\n\n    service.setOptions = newOptions => {\n      service.options = {\n        ...service.options,\n        ...newOptions,\n      }\n\n      return service\n    }\n\n    service.reset = () => {\n      service.options = { ...DEFAULT_OPTIONS }\n\n      return service\n    }\n\n    service.isBackButtonVisible = () => {\n      return service.options.showBackButton\n    }\n\n    service.isCloseButtonVisible = () => {\n      return service.options.showCloseButton\n    }\n\n    service.isTimeslotSelectLaterLinkVisible = () => {\n      return service.options.showTimeslotSelectLaterLink\n    }\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('NativeMobileBrightnessServiceServicesModule', [])\n  .service('nativeMobileBrightnessService', function nativeMobileBrightnessService(mobileService) {\n    const service = this\n\n    const maxBrightness = 1\n    let brightnessPlugin\n    let savedBrightness = null\n    let brightnessIsPaused = false\n\n    service.pauseFullBrightnessMode = () => {\n      if (savedBrightness !== null) {\n        service.setBrightness(savedBrightness)\n        brightnessIsPaused = true\n      }\n    }\n\n    service.resumeFullBrightnessMode = () => {\n      if (brightnessIsPaused) {\n        service.setBrightnessToMax()\n        brightnessIsPaused = false\n      }\n    }\n\n    service.enableFullBrightnessMode = () => {\n      service.backupCurrentBrightness(service.setBrightnessToMax)\n    }\n\n    service.resetBrightnessMode = () => {\n      service.setBrightness(savedBrightness, () => {\n        savedBrightness = null\n        brightnessIsPaused = false\n      })\n    }\n\n    service.backupCurrentBrightness = (callback, fail) => {\n      brightnessPlugin &&\n        brightnessPlugin.getBrightness(brightness => {\n          if (savedBrightness === null) {\n            savedBrightness = brightness\n          }\n          callback && callback()\n        }, fail)\n    }\n\n    service.setBrightness = (brightness, callback, fail) => {\n      brightnessPlugin &&\n        brightness !== null &&\n        brightnessPlugin.setBrightness(brightness, callback, fail)\n    }\n\n    service.setBrightnessToMax = () => {\n      brightnessPlugin && brightnessPlugin.setBrightness(maxBrightness)\n    }\n\n    document.addEventListener('deviceready', () => {\n      brightnessPlugin = mobileService.isMobileApp() && window.cordova.plugins.brightness\n    })\n    document.addEventListener('pause', service.pauseFullBrightnessMode, false)\n    document.addEventListener('resume', service.resumeFullBrightnessMode, false)\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('NavMenuCallbacksServicesModule', [])\n  .service('navMenuCallbacksService', function navMenuCallbacksService() {\n    const service = this\n\n    service.callbacks = {}\n\n    service.getCallbacks = () => service.callbacks\n\n    service.setCallbacks = callbacks => {\n      angular.copy(callbacks, service.callbacks)\n    }\n  })\n","export default (q, fn) => (...args) => q((resolve, reject) => fn(...args).then(resolve, reject))\n","import angular from 'angular'\n\nimport promiseWrapper from '@app/utils/promiseWrapper'\n\nexport default angular.module('NgPromiseModule', []).service('ngPromise', function ngPromise($q) {\n  const service = this\n\n  // Helper function to get es6 promises working with angular\n  service.wrapper = fn => promiseWrapper($q, fn)\n})\n","import _ from 'lodash'\nimport angular from 'angular'\n\nimport {\n  CONDITION_TYPES,\n  OFFER_TYPES,\n  DISCOUNT_AND_REWARD_TYPES,\n  ITEM_CONDITION_TYPES,\n} from '../../constants/offers'\n\nconst ADD_LOYALTY_CARD = 'Please add your loyalty card to proceed.'\n\n/*\n * OFFER TYPES\n */\nexport default angular\n  .module('offersServicesModule', [])\n  .service(\n    'offersService',\n    function offersService(\n      $filter,\n      $q,\n      $rootScope,\n      $state,\n      Restangular,\n      cartService,\n      config,\n      errorModalService,\n      lang,\n      unataCommService\n    ) {\n      const service = this\n\n      /*\n       * Language constants\n       */\n      const {\n        itemConditionType,\n        cartConditionType,\n        rewardType,\n        complete,\n        reward,\n      } = lang.values.offersContent\n      const { spendMoreToQualify, addItemsToQualify, addMoreToQualify } = itemConditionType\n      const {\n        spendMoreToComplete,\n        buy: buyLang,\n        one: oneLang,\n        all: allLang,\n        any: anyLang,\n      } = cartConditionType\n      const { multipleItemsForReward, singleItemForReward } = rewardType\n      const { clipThisCoupon, offerCompleted, offerTimes } = complete\n      const { getOffEach, getEachFor, getFor, free: freeLang, off: offLang } = reward\n\n      /*\n       * OFFER LABELS\n       */\n      const cachePromiseById = {}\n      service.cachedOffers = {}\n\n      // should probably have cart broadcast on rootscope that it changed\n      const localScope = $rootScope.$new()\n      localScope.cartService = cartService\n\n      // eslint-disable-next-line complexity\n      const labelOffer = function (offer) {\n        const { offer_progress } = offer\n        const offerProgressCondition = offer_progress.condition\n\n        // Do some math with the offer progress conditions\n        const offerConditionType = offer.condition.type\n        const offerCondition = offer.condition[offerConditionType]\n        const offerProgressDifference =\n          offerProgressCondition.max_value - offerProgressCondition.current_value\n\n        // Show how many products need to be added to qualify for offer\n        if (\n          ITEM_CONDITION_TYPES.includes(offerProgressCondition.type) &&\n          offerProgressDifference > 0\n        ) {\n          if (offerCondition?.min_spend) {\n            const offerProgressDifference = (\n              offerCondition.min_spend - offerProgressCondition.current_value\n            ).toFixed(2)\n            offer_progress.label = lang.template(spendMoreToQualify, {\n              conditionDifference: offerProgressDifference,\n            })\n          } else {\n            const { min_weight } = offerCondition\n            const minWeightStr = min_weight ? `(${min_weight}${offerCondition.uom})` : ''\n            const itemTitle = $filter('pluralize')('item', offerProgressDifference)\n            offer_progress.label = lang.template(addMoreToQualify, {\n              conditionDifference: offerProgressDifference,\n              itemTitle,\n              minWeightStr,\n            })\n          }\n        }\n\n        // Show how much needs to be spent to qualify for the offer\n        if (offerProgressCondition.type === CONDITION_TYPES.CART && offerProgressDifference > 0) {\n          const conditionDifference = offerProgressDifference.toFixed(2)\n          offer_progress.label = lang.template(spendMoreToComplete, { conditionDifference })\n        }\n\n        // Detect collection missing condition data\n        if (\n          offerProgressCondition.type === CONDITION_TYPES.COLLECTION &&\n          offerProgressCondition.current_value === 0\n        ) {\n          offer_progress.label = addItemsToQualify\n        }\n\n        // Check if offer condition has been met\n        if (offerConditionType !== CONDITION_TYPES.NONE && offerProgressDifference <= 0) {\n          const { reward } = offer_progress\n          // Show how many reward products need to be added to redeem the offer\n          const remaining = reward.max_value - reward.current_value\n\n          offer_progress.label =\n            remaining > 1\n              ? lang.template(multipleItemsForReward, { rewardDifference: remaining })\n              : singleItemForReward\n        }\n\n        // Label offers as completed, with an optional count if completed more than once\n        if (offerConditionType === CONDITION_TYPES.NONE || offer_progress.completion_count > 0) {\n          if (offer.offer_type === OFFER_TYPES.COUPON && offer.clipped === false) {\n            offer_progress.label = clipThisCoupon\n          } else {\n            const count = offer_progress.completion_count\n            const text = count > 1 ? `${count} ${offerTimes}` : ''\n            offer_progress.label = lang.template(offerCompleted, { text })\n          }\n        }\n\n        // Generate titles for product collections\n        // We only need titles where the condition / reward involves products\n        if (offerConditionType === CONDITION_TYPES.PRODUCT) {\n          const { products } = offer.condition\n\n          const endSentence =\n            products.quantity === 1\n              ? oneLang\n              : products.all_products\n              ? `${allLang} ${products.products.length}`\n              : `${anyLang} ${products.quantity}`\n\n          offerProgressCondition.collection_title = `${buyLang} ${endSentence}`\n        }\n\n        const offerRewardType = offer.reward.type\n        if (offerRewardType === OFFER_TYPES.DISCOUNT) {\n          const { discount } = offer.reward\n          let value = $filter('currency')(discount.value)\n          let str = ''\n\n          if (discount.type === DISCOUNT_AND_REWARD_TYPES.AMOUNT) {\n            str = getOffEach\n          } else if (discount.type === DISCOUNT_AND_REWARD_TYPES.PERCENT) {\n            value = `${Math.floor(discount.value)}%`\n            str = getOffEach\n          } else if (discount.type === DISCOUNT_AND_REWARD_TYPES.SET_PRICE) {\n            str = getEachFor\n          }\n\n          offerProgressCondition.collection_title += lang.template(str, { value })\n        } else if (offerRewardType === OFFER_TYPES.PRODUCT) {\n          const { type, value, quantity } = offer.reward.products\n          const progressReward = offer_progress.reward\n          let str = ' '\n\n          progressReward.collection_title = lang.template(getFor, { quantity })\n\n          if (\n            (type === DISCOUNT_AND_REWARD_TYPES.PERCENT && value === 100) ||\n            (type === DISCOUNT_AND_REWARD_TYPES.SET_PRICE && value === 0)\n          ) {\n            str += freeLang\n          } else if (type === DISCOUNT_AND_REWARD_TYPES.AMOUNT) {\n            str += `${$filter('currency')(value)} ${offLang}`\n          } else if (type === DISCOUNT_AND_REWARD_TYPES.PERCENT) {\n            str += `${Math.floor(value)}% ${offLang}`\n          } else if (type === DISCOUNT_AND_REWARD_TYPES.SET_PRICE) {\n            str += $filter('currency')(value)\n          }\n\n          progressReward.collection_title += str\n        }\n\n        // If the offer isn't activated the quantities will be 0.\n        if (\n          offer.offer_type === OFFER_TYPES.CONTINUITY &&\n          offer.continuity.offer_activated === false\n        ) {\n          offerProgressCondition.collection_title = config.continuityOffers.qualifyingProducts\n        }\n\n        // Apply overrides for the product collection titles, if available from the offer\n        if (offer.cdn_collection_title) {\n          offerProgressCondition.collection_title = offer.cdn_collection_title\n        }\n\n        if (offer.rwd_collection_title) {\n          offer_progress.reward.collection_title = offer.rwd_collection_title\n        }\n      }\n\n      // If we want to make sure something happens after we perform an update to the offer state,\n      //  we can assign the promise that updates the state as a property inside this object\n      //  and then perform whatever needs to happen after by resolving it after this promise by using .then or\n      //  (REMINDER: If any of the promises in the chain should fail, the subsequent promises will not execute)\n      service.updatingOfferStatePromise = {}\n\n      service.updateClippedState = offer =>\n        (service.updatingOfferStatePromise[offer.id] = Restangular.one('offers', offer.id)\n          .customPUT({ clipped: offer.clipped })\n          .then(response => {\n            cartService.fetch()\n            if (service.cachedOffers[offer.id]) {\n              service.cachedOffers[offer.id].clipped = response.clipped\n            }\n            $rootScope.$broadcast('couponOfferClippedStateUpdated')\n          })\n          .catch(response => {\n            offer.clipped = !offer.clipped\n            const message = (response.data && response.data.message) || response.message\n\n            if (\n              message === ADD_LOYALTY_CARD &&\n              config.hasLoyalty &&\n              !config.disableLoyaltyWhenAccountless\n            ) {\n              errorModalService\n                .open(message, lang.values.addLoyaltyCard, lang.values.close)\n                .then(() => {\n                  $state.go('main.account.loyalty')\n                })\n            } else {\n              errorModalService.open(message, 'OK')\n            }\n          }))\n\n      const getOffer = offerId => {\n        if (service.cachedOffers[offerId]) {\n          service.updateOffer(service.cachedOffers[offerId])\n          return $q.resolve(service.cachedOffers[offerId])\n        }\n        if (cachePromiseById[offerId]) {\n          return cachePromiseById[offerId]\n        }\n        cachePromiseById[offerId] = Restangular.one('offers', offerId)\n          .get()\n          .then(offer => {\n            service.updateOffer(offer)\n            return offer\n          })\n\n        return cachePromiseById[offerId]\n      }\n\n      service.getOffer = offerId => {\n        // If the clipped state of the offer is being updated, only get the offer after that's done\n        if (service.updatingOfferStatePromise[offerId]) {\n          return service.updatingOfferStatePromise[offerId].then(() =>\n            getOffer(offerId).finally(() => {\n              cachePromiseById[offerId] = null\n            })\n          )\n        }\n        return getOffer(offerId).finally(() => {\n          cachePromiseById[offerId] = null\n        })\n      }\n\n      service.fetchContinuityOffers = () => {\n        if (config.enableContinuityOffers) {\n          return Restangular.all('offers').getList({\n            type: 'continuity',\n            include_inactionable: true,\n          })\n        }\n        return $q.resolve(null)\n      }\n\n      service.fetchPersonalizedOffers = () => {\n        return Restangular.all('offers').getList(config.offersAndCoupons.queries.offers)\n      }\n\n      // Function to update offer progress data for non-cart API offers\n      const updateOfferProgress = offerToUpdate => {\n        // Stub out offer progress for those that haven't been started\n        offerToUpdate.offer_progress = {\n          completion_count: 0,\n        }\n\n        const offerUpdateType = offerToUpdate.condition.type\n        if ([...ITEM_CONDITION_TYPES, CONDITION_TYPES.CART].includes(offerUpdateType)) {\n          offerToUpdate.offer_progress.condition = {\n            type: offerUpdateType,\n            current_value: 0,\n            max_value:\n              offerUpdateType === CONDITION_TYPES.CART\n                ? offerToUpdate.condition.cart.min_spend\n                : ITEM_CONDITION_TYPES.includes(offerUpdateType)\n                ? offerToUpdate.condition[offerUpdateType].quantity\n                : 0,\n          }\n        } else {\n          // No condition\n          offerToUpdate.offer_progress.condition = {\n            type: null,\n            current_value: 0,\n            max_value: 0,\n          }\n        }\n\n        if (offerToUpdate.reward.type !== DISCOUNT_AND_REWARD_TYPES.NONE) {\n          offerToUpdate.offer_progress.reward = {\n            type: offerToUpdate.reward.type,\n            current_value: 0, // Don't really use these anyway as offer\n            max_value: 0, // would need to be in cart at this point\n          }\n        } else {\n          // No reward\n          offerToUpdate.offer_progress.reward = {\n            type: null,\n            current_value: 0,\n            max_value: 0,\n          }\n        }\n      }\n\n      // Update a single offer that is passed in\n      service.updateOffer = function (offer) {\n        const offerInCart = _.find(cartService.cart && cartService.cart.offer_progress, {\n          id: offer.id,\n        })\n\n        if (offerInCart) {\n          offer.offer_progress = {\n            condition: offerInCart.condition,\n            reward: offerInCart.reward,\n            completion_count: offerInCart.completion_count,\n          }\n\n          service.cachedOffers[offerInCart.id] = offer\n        } else {\n          updateOfferProgress(offer)\n          service.cachedOffers[offer.id] = offer\n        }\n\n        labelOffer(offer)\n      }\n\n      // Used to generate offer data for offerDetails and the offerTile. These contexts only have a partial offer object.\n      // If user_cart_offer is true, the offer associated with the cart (if it exists) will be returned. Otherwise a call to\n      // the api will be made\n      service.getOfferData = function (id, use_cart_offer = true) {\n        const cartOffer = cartService.getOfferProgress(id)\n        const deferred = $q.defer()\n\n        // If the offer doesn't yet exist in the cart, we're going to want to fetch\n        // & build it directly.\n        if (!cartOffer || !use_cart_offer) {\n          service.getOffer(id).then(result => {\n            const offerModel = {\n              clipped: result.clipped,\n              completion_count: result.offer_progress ? result.offer_progress.completion_count : 0,\n              condition: result.offer_progress ? result.offer_progress.condition : {},\n              id: result.id,\n              offer: result,\n              reward: result.offer_progress ? result.offer_progress.reward : {},\n            }\n\n            deferred.resolve(offerModel)\n          })\n        } else {\n          deferred.resolve(cartOffer)\n        }\n        return deferred.promise\n      }\n\n      // Determine the users continutity offers\n      // This function is also used to provide updated continuity offers info so this event may be fired at any time.\n      service.sendContinuityOffersMessage = () => {\n        service.fetchContinuityOffers().then(offers => {\n          // Map the API response to a simplified object\n          const continuityOffers = offers.map(o => ({\n            offer_activated: o.continuity.offer_activated,\n            name: o.name,\n            start_date: o.start_date,\n            end_date: o.end_date,\n            id: o.id,\n            ext_id: o.ext_id,\n          }))\n\n          const payload = {\n            continuityOffers,\n          }\n\n          unataCommService.send({\n            eventType: unataCommService.EventType.CONTINUTIYOFFERS,\n            payload,\n          })\n        })\n      }\n\n      // Listening for a 'unata-get-continuity-offers' message from client\n      unataCommService.listen(\n        unataCommService.EventType.GETCONTINUTIYOFFERS,\n        service.sendContinuityOffersMessage\n      )\n\n      // Determine the users offers\n      service.sendOffersMessage = () => {\n        localScope.$watch('cartService.lastUpdated', () => {\n          // Map the API response to a simplified object\n          const offers = cartService.cart.offer_progress.map(o => ({\n            offer_type: o.offer.offer_type,\n            clipped: o.clipped,\n            description: o.offer.description,\n            id: o.id,\n            ext_id: o.offer.ext_id,\n            start_date: o.offer.start_date,\n            end_date: o.offer.end_date,\n          }))\n\n          const payload = {\n            offers,\n          }\n\n          unataCommService.send({ eventType: unataCommService.EventType.OFFERS, payload })\n        })\n      }\n\n      // Listening for a 'unata-get-offers' message from client\n      unataCommService.listen(unataCommService.EventType.GETOFFERS, service.sendOffersMessage)\n\n      service.sendPersonalizedOffersMessage = () => {\n        service.fetchPersonalizedOffers().then(offers => {\n          // Map the API response to a simplified object\n          const personalizedOffers = offers.map(o => ({\n            offerType: o.offer_type,\n            clipped: o.clipped,\n            description: o.description,\n            id: o.id,\n            ext_id: o.ext_id,\n            start_date: o.start_date,\n            end_date: o.end_date,\n          }))\n\n          const payload = {\n            total: personalizedOffers.length,\n            offers: personalizedOffers,\n          }\n\n          unataCommService.send({\n            eventType: unataCommService.EventType.PERSONALIZEDOFFERS,\n            payload,\n          })\n        })\n      }\n\n      unataCommService.listen(\n        unataCommService.EventType.GETPERSONALIZEDOFFERS,\n        service.sendPersonalizedOffersMessage\n      )\n    }\n  )\n","import angular from 'angular'\nimport {\n  ANALYTICS,\n  EVENTS,\n  SOURCES,\n} from '@app/angular/services/modules/analytics/analyticsConstants'\n\n/*\n * To understand how checkout events work, please read the instructions here: _Analytics.service.md\n * The constants exist here: analyticsConstants.js\n */\n\nexport default angular\n  .module('offerAnalyticsModule', [])\n  .service(\n    'offerAnalytics',\n    function (analytics, analyticsHelper, auth, cartService, reservationService) {\n      const service = this\n\n      Object.assign(service, {\n        auth,\n        analytics,\n        analyticsHelper,\n        cartService,\n        reservationService,\n      })\n\n      /**\n       * Get default reused information as an object - that way no need to require dependencies all over the project\n       * WARNING: !!! Only include easy to access information in here !!!\n       *                 Ideally this should have a light footprint\n       *\n       * @return {object}\n       */\n      service.DEFAULTS = function () {\n        const { analytics, auth, cartService, reservationService } = service\n\n        return {\n          [SOURCES.ANALYTICS_SERVICE]: analytics,\n          [SOURCES.CART]: cartService.cart || null,\n          [SOURCES.USER]: auth.user || null,\n          [SOURCES.TIMESLOT]: reservationService.reservation?.timeslot || null,\n        }\n      }\n\n      /**\n       * Private: Helper method to get analytic payloads (default sources and \"success\" requirement both auto added)\n       *\n       * @param {object} source - Object of data to be used to generate analytic payloads\n       * @param {array} requiredInfo - Array of constants defined above\n       *\n       * @returns {object|null}\n       */\n      service._createPayload = function (source = {}, requiredInfo = []) {\n        return service.analyticsHelper.createPayload(\n          { ...service.DEFAULTS(), ...source },\n          requiredInfo\n        )\n      }\n\n      // --- CART ANALYTIC METHODS --- //\n\n      /**\n       * Triggers analytics for viewing offers\n       *\n       * @param {object} [sources] - An object with the following information (auto included: checkoutAnalytics.DEFAULTS¹):\n       *                             * {object}  analytics¹    - The analytics service\n       *                             * {object}  cart¹         - The user cart object\n       *                             * {object}  offers        - The current offers for the cart\n       *                             * {object}  offerOrigin   - Information about the product through which the offer was viewed\n       *                             * {object}  offerPageMeta - Information about the current page being viewed\n       *                             * {boolean} is_modal      - Whether this offer is being viewed via a modal\n       * @returns {undefined}\n       */\n      service.viewOffers = function (sources = {}) {\n        sources.cart = service.cartService.cart\n\n        const analyticsPayload = service._createPayload(sources, [\n          ANALYTICS.CART.CART_ID,\n          ANALYTICS.OFFER.OFFER_DETAILS,\n          ANALYTICS.OFFER.OFFER_ORIGIN,\n        ])\n\n        service.analyticsHelper.logAnalytics(EVENTS.STORE.VIEW_OFFERS, analyticsPayload, {\n          offerPageMeta: sources.offerPageMeta,\n          is_modal: !!sources.is_modal,\n        })\n      }\n\n      /**\n       * Triggers analytics for adding an offer\n       *\n       * @param {object} [sources] - An object with the following information (auto included: checkoutAnalytics.DEFAULTS¹):\n       *                             * {object}  analytics¹    - The analytics service\n       *                             * {object}  cart¹         - The user cart object\n       *                             * {object}  offer         - The current offers for the cart\n       * @returns {undefined}\n       */\n      service.addOffer = function (sources = {}) {\n        sources.cart = service.cartService.cart\n\n        const analyticsPayload = service._createPayload(sources, [\n          ANALYTICS.CART.CART_ID,\n          ANALYTICS.OFFER.OFFER_DETAILS,\n        ])\n\n        service.analyticsHelper.logAnalytics(EVENTS.STORE.ADD_OFFER, analyticsPayload)\n      }\n    }\n  )\n","import angular from 'angular'\nimport { redirectToPBI, oneCartEnabled } from '@app/services/oneCart/utils'\nimport { OneCartActions } from '@app/services/oneCart/types'\n\nexport default angular\n  .module('oneCartModule', [])\n  .service('oneCartService', function oneCartService($rootScope, addressList, mobileService) {\n    /**\n     * This code fixes an issue with Safari mobile that renders cached pages when users click on the back button.\n     * While this provides a better experience for users, it becomes a problem with dynamic pages.\n     *\n     * This event is only triggered when the page is loaded, that means the callback won't execute when users press\n     * the back button inside the app\n     *\n     * Fix was taken from https://stackoverflow.com/questions/8788802/prevent-safari-loading-from-cache-when-back-button-is-clicked/13123626#13123626\n     */\n    const refreshOnBackButton = () => {\n      if (mobileService.isMobile && !mobileService.isMobileApp()) {\n        window.onpageshow = function (event) {\n          if (event.persisted) {\n            $rootScope.reloadState()\n          }\n        }\n      }\n    }\n\n    // TODO: we can't completely refactor this as we need the $rootscope and address list refactored out\n    this.redirectToPBI = (\n      location,\n      auth_token = '',\n      { action = OneCartActions.CHECKOUT, method = 'POST', orderId }\n    ) => {\n      const postCloseRefresh = () => {\n        $rootScope.isAppLoading = true\n\n        // Refetch the delivery addresses in case they were modified while checking out.\n        addressList.fetchAddresses()\n\n        $rootScope.$broadcast('cartRefresh', () => {\n          if (mobileService.isMobileApp()) $rootScope.isAppLoading = false\n        })\n      }\n\n      const result = redirectToPBI(location, auth_token, { action, method, orderId })\n        .then(response => {\n          refreshOnBackButton()\n          return response\n        })\n        .then(action === OneCartActions.LOGOUT ? x => x : postCloseRefresh)\n\n      // Hide cart after the InAppBrowser shows.\n      $rootScope.$broadcast('sideCart', 'close')\n\n      return result\n    }\n\n    // this should just use the one cart hook when react refactor is done (est. completion 2025)\n    this.enabled = () => oneCartEnabled()\n  })\n","import angular from 'angular'\nimport { FULFILLMENT_TYPES } from '@app/angular/constants/checkout'\n\nimport { HTTP_ERRORS } from '@app/angular/constants/httpErrors'\nimport { LOGIN_CONTEXTS } from '@app/angular/constants/loginContexts'\nimport { ORDER_TYPES } from '@app/angular/constants/orders'\nimport { OneCartActions } from '@app/services/oneCart/types'\n\nimport { auth as authService } from '@instacart/enterprise-services'\n\nexport default angular\n  .module('OrderServicesModule', [])\n  .service(\n    'orderService',\n    function orderService(\n      $rootScope,\n      $state,\n      checkoutService,\n      config,\n      lang,\n      localStorageService,\n      oneCartService,\n      registrationService\n    ) {\n      const service = this\n      const labelMap = {\n        [FULFILLMENT_TYPES.PICKUP]: lang.values.pickupFee,\n        [FULFILLMENT_TYPES.DELIVERY]: lang.values.deliveryFee,\n      }\n\n      service.fulfillmentLabel = (fee, type) => {\n        if (fee.meta && fee.meta.isFulfillmentFee) {\n          return labelMap[type]\n        }\n      }\n\n      service.handleViewOrderClick = order => {\n        const isIcFulfilled = config.shoppingSelector[order.fulfillment_type]?.fulfilledByInstacart\n\n        // For in-store orders, we take users to the Unata purchase page\n        if (order.type === ORDER_TYPES.INSTORE) {\n          return $state.go('main.account.orderHistory.purchase', {\n            id: order.id,\n          })\n        }\n\n        if (isIcFulfilled && oneCartService.enabled() && order.ic_order_redirect_id) {\n          // OneCart order\n          $rootScope.isAppLoading = true\n          return authService.api.auth\n            .getOneCartOrderRedirect(order.ic_order_redirect_id, {}, order.order_reference)\n            .then(resp =>\n              oneCartService.redirectToPBI(resp.location, resp.auth_token, {\n                action: OneCartActions.ORDER_STATUS,\n                orderId: order.ic_order_id,\n              })\n            )\n            .catch(resp => {\n              $rootScope.isAppLoading = false\n\n              if (resp && resp.error === HTTP_ERRORS.PII_UNAUTHORIZED) {\n                // If PII has timed out\n                localStorage.setItem('icOrderId', JSON.stringify(`${order.ic_order_redirect_id}`))\n                registrationService.promptLogin(\n                  $state.current.name,\n                  $state.params,\n                  '',\n                  '',\n                  lang.values.loginToContinue,\n                  LOGIN_CONTEXTS.REDIRECT_ONECART_ORDER_STATUS\n                )\n              }\n            })\n        }\n\n        // For in-store purchases and online orders with OneCart disabled, display the order details on Unata\n        $state.go('main.account.orderHistory.order', {\n          id: order.id,\n        })\n      }\n    }\n  )\n","import angular from 'angular'\nimport { product, user } from '@instacart/enterprise-services'\n\nexport default angular\n  .module('priceAlertsServicesModule', [])\n  .service('priceAlertsService', function priceAlertsService($rootScope, ngPromise) {\n    const service = this\n\n    service.deletePriceAlert = productId => product.api.product.removePriceAlertById(productId)\n\n    service.addPriceAlert = productId => product.api.product.createPriceAlertById(productId)\n\n    service.getAllPriceAlerts = () => user.api.user.getPriceAlerts().then(({ items }) => items)\n\n    service.togglePriceAlert = product => {\n      if (product.price_alert === null) {\n        const addPriceAlert = ngPromise.wrapper(service.addPriceAlert)\n\n        addPriceAlert(product.id).then(priceAlert => {\n          $rootScope.$emit('priceAlertChange', {\n            productId: product.id,\n            priceAlert,\n          })\n        })\n      } else {\n        const deletePriceAlert = ngPromise.wrapper(service.deletePriceAlert)\n\n        deletePriceAlert(product.price_alert.id).then(() => {\n          $rootScope.$emit('priceAlertChange', { productId: product.id, priceAlert: null })\n        })\n      }\n    }\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('productsServicesModule', [])\n  .service(\n    'productsService',\n    function productsService($document, $filter, $state, Restangular, productDetailsModal) {\n      const service = this\n\n      service.getBeacon = beacon => {\n        if (beacon) {\n          return Restangular.one(beacon).get()\n        }\n\n        // Resolve rather than throwing an error since this is an optional request\n        return new Promise(resolve => {\n          resolve()\n        })\n      }\n\n      service.cellOnClick = ({ location, locationValue, product, modal, placement = {} }) => {\n        service.getBeacon(product.onClickBeacon)\n\n        if (modal) {\n          productDetailsModal.open(product.id, { location, locationValue }, placement)\n        } else {\n          $state.go('main.product', {\n            id: product.id,\n            placement,\n            name: $filter('slugify')(product.name),\n          })\n        }\n      }\n\n      service.trackViewPort = ($element, $scope, product) => {\n        if (!product.sponsored || !('IntersectionObserver' in window)) {\n          return\n        }\n\n        if (!$scope.pxViewportObserver && !$scope.viewportObserver) {\n          const sideCart = $document[0].querySelector('[side-cart]')\n          const sideCartPeekWidth =\n            sideCart && getComputedStyle(sideCart).getPropertyValue('--peek-width')\n          const rightMargin = sideCartPeekWidth ? `-${sideCartPeekWidth.trim()}` : '0px'\n\n          $scope.viewPortBeaconTimeouts = {}\n          const getObserver = (getBeaconURL, options = {}, timeout = 0) =>\n            new IntersectionObserver(\n              (entries, observer) => {\n                entries.forEach(({ isIntersecting, target }) => {\n                  const url = getBeaconURL(target)\n\n                  if (!isIntersecting) {\n                    clearTimeout($scope.viewPortBeaconTimeouts[url])\n                    return\n                  }\n\n                  $scope.viewPortBeaconTimeouts[url] = setTimeout(() => {\n                    observer.unobserve(target)\n                    service.getBeacon(url)\n                  }, timeout)\n                })\n              },\n              {\n                rootMargin: `0px ${rightMargin} 0px 0px`,\n                ...options,\n              }\n            )\n\n          $scope.pxViewportObserver = getObserver(({ dataset }) => dataset.on1pxViewportBeacon)\n          $scope.viewportObserver = getObserver(\n            ({ dataset }) => dataset.onViewportBeacon,\n            { threshold: 0.5 },\n            1_000\n          )\n        }\n\n        const element = $element[0]\n        const { on1pxViewportBeacon, onViewportBeacon } = product\n        if (on1pxViewportBeacon) {\n          element.dataset.on1pxViewportBeacon = on1pxViewportBeacon\n          $scope.pxViewportObserver.observe(element)\n        }\n        if (onViewportBeacon) {\n          element.dataset.onViewportBeacon = onViewportBeacon\n          $scope.viewportObserver.observe(element)\n        }\n      }\n    }\n  )\n","import angular from 'angular'\nimport { captureMessage } from '@sentry/browser'\nimport { user } from '@instacart/enterprise-services'\n\nexport default angular\n  .module('profileServicesModule', [])\n  .service('profileService', function (ngPromise) {\n    const service = this\n    const getProfile = ngPromise.wrapper(user.api.user.getProfile)\n\n    service.profile = {}\n\n    /**\n     * This service provides a way to cache profile object as angular service\n     * to reduce redundant call to /profile endpoint\n     */\n    service.fetchProfile = function () {\n      service.fetchProfilePromise = getProfile()\n        .then(profile => {\n          service.profile = profile || {}\n\n          return service.profile\n        })\n        .catch(error => {\n          captureMessage(\n            `Error fetching profile. Status: \"${error?.status}\". Message: \"${\n              error?.message || error\n            }\"`\n          )\n        })\n\n      return service.fetchProfilePromise\n    }\n\n    service.getProfile = () => {\n      return service.fetchProfilePromise || service.fetchProfile()\n    }\n  })\n","import angular from 'angular'\nimport template from '../../components/shared/promoCodeModal/promoCodeModal.html'\n\nexport default angular\n  .module('promoCodeServicesModule', [])\n  .service('promoCodeService', function promoCodeService($uibModal, uibModalAriaLabelService) {\n    const service = this\n\n    service.successMessage = ''\n\n    service.setSuccessMessage = message => {\n      this.successMessage = message\n    }\n\n    service.clearSuccessMessage = () => {\n      this.successMessage = ''\n    }\n\n    /**\n     * Opens a promo code modal dialog.\n     * */\n    this.open = (options = {}) => {\n      const modalInstance = $uibModal.open({\n        resolve: {\n          ariaLabel: () => {\n            uibModalAriaLabelService.setLabel('Promo Code')\n          },\n          promoCodeOptions() {\n            return { ...options, setSuccessMessage: service.setSuccessMessage }\n          },\n        },\n        controller: 'PromoCodeModalController',\n        template,\n      })\n      return modalInstance.result\n    }\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('promoCodeValidationServicesModule', [])\n  .service('promoCodeValidationService', function promoCodeValidationService(Restangular) {\n    const service = this\n\n    service.checkIfValidPromoCode = promo => {\n      // Use the provided promoCode to make an API call trying to unlock an offer.\n      if (promo.promo_code.length) {\n        return Restangular.one('cart').customPOST(promo, 'promo_codes')\n      }\n    }\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('QualitricsServiceModule', [])\n  .service('qualitricsService', function qualitrics($timeout, config) {\n    const service = this\n    const qualitricsId = config.qualitricsScript?.id\n\n    // The adding of a div with a configured id was part of the instructions provided by our client.\n    const addRootElemntToDom = () => {\n      const elem = document.createElement('div')\n      elem.setAttribute('id', qualitricsId)\n      document.body.appendChild(elem)\n    }\n    service.initQualitrics = () => {\n      addRootElemntToDom()\n      $timeout(() => {\n        // The following 3rd party script was provided by one of our clients see - https://instacart.atlassian.net/browse/ENT-26216\n        /* eslint-disable */\n        ;(function () {\n          const g = function (e, h, f, g) {\n            this.get = function (a) {\n              for (\n                var a = `${a}=`, c = document.cookie.split(';'), b = 0, e = c.length;\n                b < e;\n                b++\n              ) {\n                for (var d = c[b]; d.charAt(0) == ' '; ) d = d.substring(1, d.length)\n                if (d.indexOf(a) == 0) return d.substring(a.length, d.length)\n              }\n              return null\n            }\n            this.set = function (a, c) {\n              var b = ''\n              var b = new Date()\n              b.setTime(b.getTime() + 6048e5)\n              b = `; expires=${b.toGMTString()}`\n              document.cookie = `${a}=${c}${b}; path=/; `\n            }\n            this.check = function () {\n              let a = this.get(f)\n              if (a) a = a.split(':')\n              else if (e != 100)\n                h == 'v' && (e = Math.random() >= e / 100 ? 0 : 100),\n                  (a = [h, e, 0]),\n                  this.set(f, a.join(':'))\n              else return !0\n              let c = a[1]\n              if (c == 100) return !0\n              switch (a[0]) {\n                case 'v':\n                  return !1\n                case 'r':\n                  return (c = a[2] % Math.floor(100 / c)), a[2]++, this.set(f, a.join(':')), !c\n              }\n              return !0\n            }\n            this.go = function () {\n              if (this.check()) {\n                const a = document.createElement('script')\n                a.type = 'text/javascript'\n                a.src = g\n                document.body && document.body.appendChild(a)\n              }\n            }\n            this.start = function () {\n              const t = this\n              document.readyState !== 'complete'\n                ? window.addEventListener\n                  ? window.addEventListener(\n                      'load',\n                      function () {\n                        t.go()\n                      },\n                      !1\n                    )\n                  : window.attachEvent &&\n                    window.attachEvent('onload', function () {\n                      t.go()\n                    })\n                : t.go()\n            }\n          }\n          try {\n            new g(\n              100,\n              'r',\n              `QSI_S_${qualitricsId}`,\n              `https://zn6h8yalijmhacfoh-qsleo.siteintercept.qualtrics.com/SIE/?Q_ZID=${qualitricsId}`\n            ).start()\n          } catch (i) {}\n        })()\n        /* eslint-enable */\n      })\n    }\n  })\n","import { registerPlugin } from '@capacitor/core'\n\ninterface AppRatePlugin {\n  promptForRating(): void\n}\n\nconst AppRate = registerPlugin<AppRatePlugin>('AppRatePlugin')\n\nexport default AppRate\n","import angular from 'angular'\nimport AppRatePlugin from '@app/react/mobile/plugins/appRatePlugin'\nimport isCapacitor from '@app/utils/isCapacitor'\n\nexport default angular\n  .module('rateAppServicesModule', [])\n  .service(\n    'rateApp',\n    function mobileService($window, config, localStorageService, mobileService, utilService) {\n      const service = this\n\n      const LOCAL_STORAGE_RATE_APP = 'rateapp'\n\n      const isMobileApp = mobileService.isMobileApp()\n\n      let rateAppLocalStorage = {\n        remindagain: null,\n        rated: null,\n      }\n\n      const mobileRateAppAvailable = () => {\n        return (\n          isMobileApp &&\n          window.AppRate !== undefined &&\n          config.mobileAppRate &&\n          config.mobileAppRate.enabled\n        )\n      }\n\n      const getRateAppLocalStorage = () => {\n        if (localStorageService.deprecatedGet(LOCAL_STORAGE_RATE_APP)) {\n          rateAppLocalStorage =\n            localStorageService.deprecatedGet(LOCAL_STORAGE_RATE_APP) || rateAppLocalStorage\n        }\n      }\n\n      const checkRemindAgain = () => {\n        getRateAppLocalStorage()\n        const remindAgain = new Date(rateAppLocalStorage.remindagain) || null\n        const nowDate = new Date()\n        return remindAgain < nowDate\n      }\n\n      const remindAgain = () => {\n        // set localstorage with todays date + configured number of days\n        const remindAgain = utilService.addDays(new Date(), config.mobileAppRate.remindAgain)\n        rateAppLocalStorage.remindagain = remindAgain\n        localStorageService.deprecatedSet(LOCAL_STORAGE_RATE_APP, rateAppLocalStorage)\n      }\n\n      const setupAppReview = () => {\n        // configure App Rate plugin\n        window.AppRate.preferences = {\n          displayAppName: config.mobileAppRate.displayAppName,\n          usesUntilPrompt: config.mobileAppRate.usesUntilPrompt,\n          promptAgainForEachNewVersion: config.mobileAppRate.promptAgainForEachNewVersion,\n          inAppReview: config.mobileAppRate.inAppReview,\n          simpleMode: config.mobileAppRate.simpleMode,\n          storeAppURL: {\n            ios: config.mobileAppRate.appleAppId,\n            android: `market://details?id=${config.mobileAppRate.androidPackageName}`,\n          },\n          customLocale: {\n            title: config.mobileAppRate.customLocale.title,\n            message: config.mobileAppRate.customLocale.message,\n            cancelButtonLabel: config.mobileAppRate.customLocale.cancelButtonLabel,\n            laterButtonLabel: config.mobileAppRate.customLocale.laterButtonLabel,\n            rateButtonLabel: config.mobileAppRate.customLocale.rateButtonLabel,\n            yesButtonLabel: config.mobileAppRate.customLocale.yesButtonLabel,\n            noButtonLabel: config.mobileAppRate.customLocale.noButtonLabel,\n            appRatePromptTitle: config.mobileAppRate.customLocale.appRatePromptTitle,\n            feedbackPromptTitle: config.mobileAppRate.customLocale.feedbackPromptTitle,\n          },\n          // callbacks are currently required in this version of apprate or it will throw errors.\n          callbacks: {\n            handleNegativeFeedback() {\n              // should maybe have the option to do something with this. send an email, etc.\n            },\n            onRateDialogShow(_callback) {\n              // currently this is not working in the installed version of the plugin\n              // callback(1) // cause immediate click on 'Rate Now' button\n            },\n            onButtonClicked(buttonIndex) {\n              switch (buttonIndex) {\n                case 2:\n                  // remind me later\n                  remindAgain()\n                  break\n              }\n            },\n          },\n        }\n      }\n\n      document.addEventListener('deviceready', () => {\n        if (mobileRateAppAvailable()) {\n          setupAppReview()\n        }\n      })\n\n      // prompt for the app review\n      service.promptAppReview = () => {\n        if (checkRemindAgain()) {\n          if (isCapacitor()) {\n            AppRatePlugin.promptForRating()\n            // Call `remindAgain` to set a localStorage val to prevent requesting a review too soon.\n            remindAgain()\n          } else if (mobileRateAppAvailable()) {\n            // don't call the prompt until after the 'remind me again' date\n            window.AppRate.promptForRating(config.mobileAppRate.callRateDialogImmediately)\n          }\n        }\n      }\n    }\n  )\n","import angular from 'angular'\nimport { getAppHistory } from '@app/react/history'\n\n/**\n * Listens to changes to AngularJS $location as well as React history\n * Keeps both instances in sync when change occurs on the other\n */\nexport default angular\n  .module('reactRouterHistoryModule', [])\n  .service('reactRouterHistory', function reactRouterHistory($location, $rootScope, analytics) {\n    const history = getAppHistory()\n\n    const scope = this\n\n    let skipAngularLocationUpdate = false\n    let shouldLogPageview = true\n\n    scope.listen = () => {\n      // When the angular location changes, this updates the react router history to keep it in sync\n      const removeLocationListener = $rootScope.$on(\n        '$locationChangeSuccess',\n        (event, newUrl, oldUrl) => {\n          if (shouldLogPageview) {\n            analytics.onLocationChangeSync(event, newUrl, oldUrl)\n            shouldLogPageview = false\n          }\n\n          if (history.location.pathname === $location.path()) {\n            shouldLogPageview = true\n            return\n          }\n\n          // Set flag so that the history listener can skip this change\n          skipAngularLocationUpdate = true\n\n          history.push($location.url())\n        }\n      )\n\n      // When the react router history changes we update the angular location to keep it in sync\n      let currentPath\n      const removeHistoryListener = history.listen(({ pathname, search, hash }) => {\n        if (skipAngularLocationUpdate) {\n          skipAngularLocationUpdate = false\n          return\n        }\n\n        /* Setting shouldLogPageview to true when removing history listener at all times, as it \n        breaks mobile tracking with the isSetAlready check below */\n        shouldLogPageview = true\n\n        const targetPath = `${pathname}${search}${hash}`\n        currentPath = pathname\n        // TODO what about query parameters? They usually are treated as different path by browsers\n        const isSetAlready = $location.path() === pathname\n        if (isSetAlready) {\n          return\n        }\n\n        $rootScope.$applyAsync(() => {\n          /* event.preventDefault will toggle path back for angular-ui-router\n          (for example when user is not logged in),\n          async action needs help to detect when this happens so we avoid\n          flipping back and forth between paths */\n          const pathChangedSince = currentPath !== pathname\n          if (pathChangedSince) {\n            return\n          }\n\n          $location.url(targetPath)\n        })\n      })\n\n      return () => {\n        removeLocationListener()\n        removeHistoryListener()\n      }\n    }\n  })\n","import angular from 'angular'\nimport { recaptcha } from '@instacart/enterprise-services'\nimport recaptchaModal from '../templates/recaptcha/recaptchaModal.html'\n\nexport default angular\n  .module('recaptchaServiceModule', [])\n  .service(\n    'recaptchaService',\n    function recaptchaService($q, config, errorModalService, utilService) {\n      const service = this\n      const recaptchaSdkLoaded = $q.defer()\n\n      // Service API\n      service.isEnabled = () => Boolean(config.googleRecaptcha?.enabled && !window.Cypress)\n      service.isPaymentsEnabled = () => Boolean(config.googleRecaptcha?.paymentsEnabled)\n\n      service.renderCheckbox = id => {\n        return recaptchaSdkLoaded.promise\n          .then(() => service.getClientSignature())\n          .then(response => {\n            window.grecaptcha.enterprise.render(id, { s: response.client_signature })\n          })\n          .catch(err => {\n            errorModalService.open(err.message || config.lang.recaptchaLoadError, config.lang.ok)\n          })\n      }\n\n      service.getClientSignature = () => {\n        const successCallback = window.onRecaptchaCheckboxSuccess.toString()\n        const callbackBody = successCallback\n          // Remove the function signature\n          .substring(successCallback.indexOf('{') + 1, successCallback.lastIndexOf('}'))\n          // Remove all whitespace\n          .replace(/\\s+/g, '')\n        return recaptcha.api.createClientSignature(window.location.href, callbackBody)\n      }\n\n      service.resetLastCheckbox = () => {\n        return recaptchaSdkLoaded.promise\n          .then(() => {\n            window.grecaptcha.enterprise.reset()\n          })\n          .catch(err => {\n            errorModalService.open(err.message || config.lang.recaptchaLoadError, config.lang.ok)\n          })\n      }\n\n      // Service Run Block\n      if (service.isEnabled()) {\n        window.recaptchaOnLoad = () => {\n          recaptchaSdkLoaded.resolve()\n        }\n\n        utilService\n          .loadScript(config.googleRecaptcha?.url)\n          .catch(err => recaptchaSdkLoaded.reject(err))\n      }\n\n      /**\n       * Shows reCaptcha in a popup modal window. It should contain attribs as needed, specified in:\n       *   app/angular/components/shared/recaptcha/recaptchaCheckbox.component.js\n       *\n       * @param {object} reCaptchaSetup  - Obejct of attribs\n       *\n       * @returns {Promise}  - Resolves if the recaptcha passes, rejects if the modal is closed\n       */\n      let modal = null\n\n      service.openRecaptchaInModal = reCaptchaSetup => {\n        modal = errorModalService.openCustom(recaptchaModal, { reCaptchaSetup })\n        return modal.result\n      }\n\n      service.closeRecaptchaInModal = () => {\n        if (modal) {\n          modal.$dismiss()\n          modal = null\n        }\n      }\n    }\n  )\n","import angular from 'angular'\nimport isMobileContainerUrl from '@app/utils/isMobileContainerUrl'\nimport urlParser from '@app/utils/urlParser'\nimport { eventEmitter, EVENT_TYPES } from '@app/utils/eventEmitter'\n\nexport default angular\n  .module('redirectServicesModule', [])\n  .service(\n    'redirectService',\n    function canvas(\n      $http,\n      $location,\n      $state,\n      $stateParams,\n      $window,\n      config,\n      localStorageService,\n      mobileService,\n      utilService\n    ) {\n      const isDotComHostname = hostname =>\n        config.dotComModule.url && urlParser(config.dotComModule.url).hostname === hostname\n\n      // Only allow redirecting to the CMS/DotCom urls.\n      const isRedirectUrlValid = url => {\n        const { protocol, hostname } = urlParser(url)\n        return protocol === 'https:' && config.dotComModule?.enable && isDotComHostname(hostname)\n      }\n\n      // Save url or app state for redirect back from third party site\n      this.saveRedirectUrl = (\n        url,\n        { state, stateParams } = { state: $state, stateParams: $stateParams }\n      ) => {\n        const redirectUrl = {}\n\n        if (url && isRedirectUrlValid(url)) {\n          redirectUrl.href = url\n        } else {\n          redirectUrl.state = state?.name || state?.current?.name\n          redirectUrl.params = stateParams\n        }\n\n        localStorageService.deprecatedSet('redirectUrl', redirectUrl)\n      }\n\n      this.loadRedirectUrl = defaultState => {\n        const redirectUrl = localStorageService.deprecatedGet('redirectUrl')\n        localStorageService.deprecatedRemove('redirectUrl')\n        return this.goToRedirectUrl(redirectUrl, defaultState)\n      }\n\n      this.goToRedirectUrl = (redirectUrl, defaultState) => {\n        if (redirectUrl && redirectUrl.href && isRedirectUrlValid(redirectUrl.href)) {\n          if (mobileService.isMobileApp() && isMobileContainerUrl(redirectUrl)) {\n            utilService.openExtLink(redirectUrl.href)\n          } else {\n            $window.open(redirectUrl.href, '_self')\n          }\n          return Promise.resolve()\n        }\n        if (redirectUrl && redirectUrl.state) {\n          return $state.go(redirectUrl.state, redirectUrl.params, { reload: true })\n        }\n        if (defaultState && defaultState.state) {\n          return $state.go(defaultState.state, defaultState.params, { reload: true })\n        }\n        return false\n      }\n\n      this.hasValidRedirectUrl = () => {\n        const redirectUrl = localStorageService.deprecatedGet('redirectUrl')\n        return !!(redirectUrl && redirectUrl.href && isRedirectUrlValid(redirectUrl.href))\n      }\n\n      eventEmitter.on(EVENT_TYPES.SET_REGISTRATION_URL, this.saveRedirectUrl)\n    }\n  )\n","import angular from 'angular'\nimport dayjs from 'dayjs'\nimport * as reservationSelectors from '@app/services/reservation/selectors'\nimport * as thunks from '@app/services/reservation/thunks'\nimport { actions } from '@app/services/reservation/slice'\n\nexport default angular\n  .module('ReservationServicesModule', [])\n\n  .service(\n    'reservationService',\n    function reservationService(\n      $ngRedux,\n      $rootScope,\n      Restangular,\n      auth,\n      config,\n      oneCartService,\n      timeslotService\n    ) {\n      const service = this\n\n      const mapStateToService = state => ({\n        previewTimeslot: reservationSelectors.defaultReservationSelector(state),\n        reservation: reservationSelectors.selectedReservationSelector(state),\n        displayReservation: reservationSelectors.currentReservationSelector(state),\n      })\n\n      $ngRedux.connect(mapStateToService, {\n        ...actions,\n        ...thunks,\n      })(service)\n\n      // Listening for every time the user context intent or store changes\n      // and deleting the reservation when necessary\n      // (even if we do not have one stored in this service, it may not be synced with what is stored in\n      //  the backend and we still need to signal it to be deleted on the backend until they can do this themselves)\n      let currentContext\n      let currentUserStoreId\n      let currentDeliveryPostalCode\n\n      $rootScope.$on('auth', (event, action, user) => {\n        if (action === 'contextUpdated' || action === 'userUpdated') {\n          // Check for context, user store change or deliveryPostalCode change.\n          const oldContext = currentContext\n          const oldUserStoreId = currentUserStoreId\n          const oldDeliveryPostalCode = currentDeliveryPostalCode\n          currentContext = user && user.context && user.context.intent\n          currentUserStoreId = user && user.store && user.store.id\n          currentDeliveryPostalCode = user && user.context && user.context.deliveryPostalCode\n\n          // If the context changes to a new non-'in-store list' context, or store changes, delete reservation\n          // (we ignore if oldContext, oldUserStoreId or oldDeliveryPostalCode is undefined, means app is loading up)\n          if (\n            oldDeliveryPostalCode &&\n            currentDeliveryPostalCode &&\n            currentDeliveryPostalCode !== oldDeliveryPostalCode\n          ) {\n            service.deleteReservation() // Always delete on a postal code change for safety.\n          } else if (\n            (oldContext &&\n              currentContext &&\n              currentContext !== 'instore' &&\n              oldContext !== currentContext) ||\n            (oldUserStoreId && currentUserStoreId && currentUserStoreId !== oldUserStoreId)\n          ) {\n            service.fetch()\n          }\n        }\n      })\n\n      service.updateTimeslotPreview = (cartId, notifyOnError) => {\n        // Don't update the timeslot preview if a reservation already exists\n        if (service.reservation) return\n\n        const currentContext = auth.getContext()\n        if (\n          currentContext &&\n          currentContext.intent &&\n          config.shoppingContextProcess[auth.getCurrentShoppingMode()]\n            ?.timeslotSelectionAtCheckoutOnly\n        ) {\n          timeslotService.getPreviewTimeslot(cartId, notifyOnError).then(timeslot => {\n            service.setDefaultReservation(timeslot)\n          })\n        } else {\n          service.setDefaultReservation(undefined)\n        }\n      }\n\n      service.fetch = function (querystring = {}) {\n        // reservations not needed for one cart\n        if (oneCartService.enabled()) return Promise.resolve(null)\n\n        return service.fetchReservation({\n          userIntent: auth.user?.context?.intent,\n          querystring,\n        })\n      }\n\n      service.fetchWithCart = cartId => {\n        service.fetch({ cart_id: cartId })\n      }\n\n      service.makeReservation = function (reservation) {\n        return service.createReservation(reservation)\n      }\n\n      // Check to see if there is a reservation and if the reservation time is inside of the lead_time window.\n\n      service.shouldShowLeadTimeAlert = function (product) {\n        let formattedReservationFromTime\n        let leadTimeEndTime\n\n        if (service.reservation) {\n          formattedReservationFromTime = `${service.reservation.fulfillment_date.split('T')[0]}T${\n            service.reservation.timeslot.from_time\n          }`\n          leadTimeEndTime = dayjs().add(product.product_config.lead_time, 'minutes')\n        }\n\n        return (\n          config.showLeadTimeAlert &&\n          service.reservation &&\n          dayjs(formattedReservationFromTime).diff(leadTimeEndTime.toLocaleString(), 'seconds') <= 0\n        )\n      }\n    }\n  )\n\n  .run(($interval, $rootScope, cartService, config, errorModalService, reservationService) => {\n    if (config.enableExpiredTimeslotErrorModal) {\n      // Watch for reservations to expire\n\n      $interval(() => {\n        if (reservationService.reservation) {\n          const seconds = dayjs\n            .utc(reservationService.reservation.expiration)\n            .diff(dayjs().utc(), 'seconds')\n          if (seconds <= 0 && !cartService.cart.order) {\n            reservationService.deleteReservation()\n            errorModalService\n              .open(\n                config.lang.expiredTimeslotReservationCompleteError,\n                'Ok',\n                '',\n                config.lang.expiredReservationError\n              )\n              .finally(() => $rootScope.$broadcast('reservationExpired'))\n          }\n        }\n      }, 30000)\n    }\n  })\n","import _ from 'lodash'\nimport angular from 'angular'\nimport { CART_TYPES } from '@app/angular/constants/cart'\nimport getApiPrefix from '@app/utils/getApiPrefix'\nimport { utils } from '@instacart/enterprise-services'\n\nconst apiPrefix = getApiPrefix()\n\nexport default angular\n  .module('restangularServicesModule', [])\n  .config(RestangularProvider => {\n    RestangularProvider.setBaseUrl(apiPrefix)\n\n    RestangularProvider.addResponseInterceptor((data, operation) => {\n      if (operation === 'getList') {\n        const meta = _.omit(data, 'items')\n        data = data.items || []\n        _.each(meta, (item, key) => {\n          data[key] = item\n        })\n\n        angular.forEach(data, item => {\n          if (item.href) {\n            item.href = apiPrefix + item.href\n          }\n        })\n      }\n\n      if (data && data.href) {\n        data.href = apiPrefix + data.href\n      }\n\n      return data\n    })\n  })\n  .run(($q, Restangular, auth, configConstants, eComLightService) => {\n    Restangular.addFullRequestInterceptor(\n      (element, operation, _what, url, headers, params, httpConfig) => {\n        const debugMode = localStorage?.getItem('DEBUG')?.includes('logRestangular=1')\n        // useful to find what code initiated a request\n        if (debugMode) {\n          console.trace(url)\n        }\n        if (auth.user && auth.user.store && auth.user.store.id) {\n          const headerObj = {\n            StoreId: auth.user.store.id,\n            FulfillmentType: auth.getContext().intent,\n          }\n          if (auth.getContext() && auth.getContext().deliveryPostalCode) {\n            _.assign(headerObj, { DeliveryPostalCode: auth.getContext().deliveryPostalCode })\n          }\n          const headerObjJsonStrB64 = btoa(JSON.stringify(headerObj))\n          headers['User-Context'] = headerObjJsonStrB64\n        }\n        if (configConstants.includeRequestSource) {\n          headers['X-Unata-Request-Source'] = 'platform'\n        }\n\n        // Send cookies for api requests when session token usage is disabled\n        if (!utils.sessionToken.shouldUseToken() && url.indexOf(apiPrefix) !== -1) {\n          angular.extend(httpConfig, { withCredentials: true })\n        }\n\n        // Include the `X-Unata-Mode` header in all but Wordpress API calls since\n        // the Wordpress API does not CORS whitelist this header.\n        if (!url.includes('wp-json')) {\n          headers['X-Unata-Mode'] = eComLightService.inEComLightMode\n            ? CART_TYPES.CATERING\n            : CART_TYPES.GROCERY\n        }\n\n        // set content-type for compatibility with the backend\n        headers['Content-Type'] = 'application/json'\n      }\n    )\n  })\n","/* eslint-disable max-lines */\n\nimport _ from 'lodash'\nimport angular from 'angular'\nimport { CHECKOUT_ROUTES_FACTORY } from '@app/angular/constants/checkout'\nimport { order } from '@instacart/enterprise-services'\nimport { OneCartActions } from '@app/services/oneCart/types'\n\nlet newCheckoutExitTimer = null\n\nconst oneCartCheckoutRedirectFunc = [\n  '$rootScope',\n  '$state',\n  '$timeout',\n  'auth',\n  'config',\n  'oneCartService',\n  ($rootScope, $state, $timeout, auth, config, oneCartService) => {\n    $timeout(() => {\n      /**\n       * When OneCart is enabled, and the user is trying to access the v2 or v1 cart review page,\n       * we redirect them back to the main page with the sidecart open\n       */\n      if (oneCartService.enabled()) {\n        const isDeepLinking = typeof $rootScope.previousState === 'undefined'\n        const params = isDeepLinking ? { open_sidecart: true } : null\n\n        $state.go('main.home', params, {\n          reload: true,\n        })\n\n        if (!isDeepLinking) {\n          $rootScope.$broadcast('sideCart', 'open')\n        }\n      }\n    })\n  },\n]\n\nexport default angular\n  .module('checkoutRoutesServiceModule', [])\n  .service('checkoutRoutes', function ($state, configConstants, lang, runtimeRoutes) {\n    const newCheckoutConfig = configConstants.newCheckoutFlow\n    const CHECKOUT_ROUTES = CHECKOUT_ROUTES_FACTORY(newCheckoutConfig)\n    const service = this\n\n    service.init = () => {\n      // Main\n      runtimeRoutes.addState('main.checkout', {\n        url: '/checkout',\n        data: {},\n        views: {\n          'content@': {\n            template: '<div ui-view=\"checkout\" class=\"checkout view\"></div>',\n            controller: [\n              '$scope',\n              'progressSegments',\n              function ($scope, progressSegments) {\n                $scope.showCartTotals = true\n                $scope.loadCartUpsell = true // Make sure we only load upsell products in the cart view, not the side cart\n                $scope.progressSegments = progressSegments\n              },\n            ],\n          },\n        },\n        resolve: {\n          oneCartCheckoutRedirect: oneCartCheckoutRedirectFunc,\n          upsellProducts: [\n            'manualUpsellService',\n            manualUpsellService =>\n              configConstants.enableCheckoutManualUpsell ||\n              configConstants.newCheckoutFlow?.upsellPage?.enabled\n                ? manualUpsellService.getUpsellProducts()\n                : [],\n          ],\n          progressSegments: [\n            'lang',\n            'upsellProducts',\n            (lang, upsellProducts) => {\n              const segments = [\n                {\n                  id: 'checkout-cart',\n                  label: lang.values.checkoutProgress.reviewCart,\n                  sref: 'main.checkout.cart',\n                },\n              ]\n\n              if (upsellProducts.length > 0) {\n                segments.push({\n                  id: 'checkout-manual-upsell',\n                  label: lang.values.checkoutProgress.manualUpsell,\n                  sref: 'main.checkout.manualUpsell',\n                })\n              }\n\n              segments.push(\n                {\n                  id: 'checkout-reservation',\n                  label: lang.values.checkoutProgress.reservation,\n                  sref: 'main.checkout.reservation.confirmation',\n                },\n                {\n                  id: 'checkout-payment',\n                  label: lang.values.checkoutProgress.payment,\n                }, // This page cannot be navigated to in progress indicator\n                {\n                  id: 'checkout-confirmation',\n                  label: lang.values.checkoutProgress.confirmation,\n                } // This page cannot be navigated to in progress indicator\n              )\n\n              return segments\n            },\n          ],\n\n          cart: [\n            'cartService',\n            function (cartService) {\n              if (!cartService.syncing) {\n                return cartService.fetch()\n              }\n            },\n          ],\n        },\n        onEnter: [\n          '$rootScope',\n          '$state',\n          '$timeout',\n          'auth',\n          'cartService',\n          'config',\n          'checkoutAnalytics',\n          'checkoutService',\n          'oneCartCheckoutRedirect',\n          'oneCartService',\n          'utilService',\n          'unataCommService',\n          (\n            $rootScope,\n            $state,\n            $timeout,\n            auth,\n            cartService,\n            config,\n            checkoutAnalytics,\n            checkoutService,\n            oneCartCheckoutRedirect,\n            oneCartService,\n            utilService,\n            unataCommService\n          ) => {\n            const redirect = oneCartCheckoutRedirect\n            if (redirect?.location) {\n              oneCartService.redirectToPBI(redirect.location, redirect.auth_token, {\n                action: OneCartActions.CHECKOUT,\n              })\n            }\n\n            // If a user goes into a checkout state in instore mode, send them to list review.\n            if (auth.getContext().intent === 'instore') {\n              $timeout(() => {\n                const lastState = utilService.getLastState()\n                const lastStateName = lastState && lastState.name\n                $state.go(\n                  !lastStateName || !lastStateName.match('main.inStoreList')\n                    ? 'main.inStoreList.review'\n                    : 'main.home'\n                )\n              })\n            }\n\n            $timeout.cancel(newCheckoutExitTimer)\n\n            // Force clear one-time unata comm cached listeners so that when\n            // later returning to the shop and loading the dotcom header, the\n            // one-time events fire again\n            unataCommService.clearGlobalCachedListeners()\n          },\n        ],\n        onExit: [\n          '$timeout',\n          'checkoutAnalytics',\n          ($timeout, checkoutAnalytics) => {\n            // We use a delay for exit because if there's a quick exit and enter (e.g. a popover), we don't want to exit!\n            newCheckoutExitTimer = $timeout(() => {\n              checkoutAnalytics.isInNewCheckoutFlow = false\n              checkoutAnalytics.exitCheckoutFlow()\n            })\n          },\n        ],\n      })\n\n      // Cart\n      runtimeRoutes.addState('main.checkout.cart', {\n        url: CHECKOUT_ROUTES.V1.CART,\n        views: {\n          checkout: {\n            template: require('@app/angular/components/checkout/views/checkoutCart.html'),\n            controller: 'CheckoutCartController',\n          },\n        },\n        resolve: {\n          oneCartCheckoutRedirect: oneCartCheckoutRedirectFunc,\n          title: ['titleService', titleService => titleService.setTitle(lang.values.reviewCart)],\n        },\n        onEnter: [\n          '$timeout',\n          'analytics',\n          'cartService',\n          'checkoutAnalytics',\n          'configConstants',\n          '$rootScope',\n          '$state',\n          (\n            $timeout,\n            analytics,\n            cartService,\n            checkoutAnalytics,\n            configConstants,\n            $rootScope,\n            $state\n          ) => {\n            if (newCheckoutConfig.cartReviewPage.enabled) {\n              $timeout(() => $state.go('main.checkout.cartV2', null, { location: 'replace' }))\n            } else if (!$rootScope.modifyingOrder) {\n              _viewCartAnalytics({ $rootScope, $timeout, checkoutAnalytics })\n            }\n          },\n        ],\n      })\n\n      // Cart v2, This needs to be seperate as we need the v1 state to exist so that it can redirect\n      // or else we will always be redirected to the 404 as the v1 state won't exist before we can go to the right state.\n      runtimeRoutes.addState('main.checkout.cartV2', {\n        url: CHECKOUT_ROUTES.V2.CART,\n        views: {\n          checkout: {\n            template: require('@app/angular/components/checkout/views/checkoutCart.html'),\n            controller: 'CheckoutCartController',\n          },\n        },\n        resolve: {\n          oneCartCheckoutRedirect: oneCartCheckoutRedirectFunc,\n          title: ['titleService', titleService => titleService.setTitle(lang.values.reviewCart)],\n        },\n        onEnter: [\n          '$timeout',\n          'analytics',\n          'cartService',\n          'checkoutAnalytics',\n          'configConstants',\n          '$rootScope',\n          '$state',\n          (\n            $timeout,\n            analytics,\n            cartService,\n            checkoutAnalytics,\n            configConstants,\n            $rootScope,\n            $state\n          ) => {\n            if (!newCheckoutConfig.cartReviewPage.enabled) {\n              $timeout(() => $state.go('main.checkout.cart', null, { location: 'replace' }))\n            } else if (!$rootScope.modifyingOrder) {\n              _viewCartAnalytics({ $rootScope, $timeout, checkoutAnalytics })\n            }\n          },\n        ],\n      })\n\n      // Manual Upsell\n      runtimeRoutes.addState('main.checkout.manualUpsell', {\n        url: CHECKOUT_ROUTES.V1.UPSELL,\n        data: {\n          requireRegistered: true,\n        },\n        views: {\n          checkout: {\n            template: require('@app/angular/components/checkout/views/checkoutManualUpsell.html'),\n            controller: 'CheckoutManualUpsellController',\n          },\n        },\n        resolve: {\n          oneCartCheckoutRedirect: oneCartCheckoutRedirectFunc,\n          title: [\n            'titleService',\n            function (titleService) {\n              return titleService.setTitle(lang.values.upsellTitle)\n            },\n          ],\n        },\n        onEnter: [\n          'analytics',\n          'cartService',\n          'checkoutAnalytics',\n          '$rootScope',\n          'upsellProducts',\n          (analytics, cartService, checkoutAnalytics, $rootScope, upsellProducts) => {\n            if (!$rootScope.modifyingOrder) {\n              checkoutAnalytics.enterCheckoutFlow()\n              checkoutAnalytics.enterCheckoutUpsell({ upsellProducts })\n            }\n          },\n        ],\n        onExit: [\n          'cartService',\n          'checkoutAnalytics',\n          'upsellProducts',\n          (cartService, checkoutAnalytics, upsellProducts) => {\n            const upsellProductsInCart = cartService.getUpSellProductsInCart(upsellProducts)\n            checkoutAnalytics.exitCheckoutUpsell({ upsellProducts: upsellProductsInCart })\n          },\n        ],\n      })\n\n      // Reservation\n      runtimeRoutes.addState('main.checkout.reservation', {\n        url: '/reservation',\n        data: {\n          requireRegistered: true,\n          requireICAccountLink: true,\n        },\n        views: {\n          checkout: {\n            template: require('@app/angular/components/checkout/views/checkoutReservation.html'), // This is the only line that differs from reservationRoutes\n            controller: 'ReservationController',\n          },\n        },\n        resolve: {\n          oneCartCheckoutRedirect: oneCartCheckoutRedirectFunc,\n          title: [\n            'titleService',\n            function (titleService) {\n              return titleService.setTitle(lang.values.schedule)\n            },\n          ],\n        },\n        onEnter: [\n          'analytics',\n          'cartService',\n          'checkoutAnalytics',\n          '$rootScope',\n          (analytics, cartService, checkoutAnalytics, $rootScope) => {\n            if (!$rootScope.modifyingOrder) {\n              checkoutAnalytics.enterCheckoutFlow()\n            }\n          },\n        ],\n      })\n\n      // Address step\n      runtimeRoutes.addState('main.checkout.reservation.address', {\n        url: '/address',\n        views: {\n          reservation: {\n            template: require('@app/angular/components/reservation/views/fulfillmentAddress.html'),\n            controller: 'FulfillmentAddressController',\n          },\n        },\n        data: {\n          requireRegistered: true,\n          requireICAccountLink: true,\n        },\n        resolve: {\n          oneCartCheckoutRedirect: oneCartCheckoutRedirectFunc,\n          userProfile: [\n            'auth',\n            function (auth) {\n              return auth.getProfile()\n            },\n          ],\n        },\n        onEnter: [\n          '$state',\n          '$timeout',\n          'analytics',\n          'auth',\n          'checkoutAnalytics',\n          'cartService',\n          '$rootScope',\n          function ($state, $timeout, analytics, auth, checkoutAnalytics, cartService, $rootScope) {\n            if (!$rootScope.modifyingOrder) {\n              checkoutAnalytics.enterCheckoutFlow()\n              checkoutAnalytics.viewFulfillmentOptions()\n            }\n            $timeout(() => {\n              if (auth.shouldUseGigyaAddressEdit()) {\n                $state.go('main.checkout.reservation.confirmation')\n              }\n            })\n          },\n        ],\n      })\n\n      // Reservation confirmation\n      runtimeRoutes.addState('main.checkout.reservation.confirmation', {\n        url: '/confirmation',\n        views: {\n          reservation: {\n            template: require('@app/angular/components/reservation/views/reservationConfirmation.html'),\n            controller: 'ReservationConfirmationController',\n          },\n        },\n        data: {\n          requireRegistered: true,\n          requireICAccountLink: true,\n        },\n        resolve: {\n          oneCartCheckoutRedirect: oneCartCheckoutRedirectFunc,\n          userProfile: [\n            'auth',\n            function (auth) {\n              return auth.getProfile()\n            },\n          ],\n        },\n        onEnter: [\n          '$rootScope',\n          '$state',\n          '$timeout',\n          'analytics',\n          'auth',\n          'cartService',\n          'checkoutAnalytics',\n          function ($rootScope, $state, $timeout, analytics, auth, cartService, checkoutAnalytics) {\n            $timeout(() => {\n              if (auth.isDeliveryContextInvalid()) {\n                $state.go('main.checkout.reservation.address')\n              } else if (!$rootScope.modifyingOrder) {\n                checkoutAnalytics.enterCheckoutFlow()\n                checkoutAnalytics.confirmFulfillmentOptions()\n              }\n            })\n          },\n        ],\n      })\n\n      // Payment\n      runtimeRoutes.addState('main.checkout.payment', {\n        url: '/payment',\n        views: {\n          checkout: {\n            template: require('@app/angular/components/checkout/views/checkoutPayment.html'),\n            controller: 'CheckoutPaymentController',\n          },\n        },\n        data: {\n          requireRegistered: true,\n          requireICAccountLink: true,\n        },\n        resolve: {\n          oneCartCheckoutRedirect: oneCartCheckoutRedirectFunc,\n          payment: [\n            '$q',\n            'Restangular',\n            function ($q, Restangular) {\n              const deferred = $q.defer()\n              Restangular.one('cart/payment')\n                .get()\n                .then(\n                  payment => {\n                    deferred.resolve(payment)\n                  },\n                  () => {\n                    deferred.resolve({}) // Handle 404 when no payment present\n                  }\n                )\n              return deferred.promise\n            },\n          ],\n          title: [\n            'titleService',\n            function (titleService) {\n              return titleService.setTitle(lang.values.pay)\n            },\n          ],\n          userProfile: [\n            'auth',\n            function (auth) {\n              return auth.getProfile()\n            },\n          ],\n        },\n        onEnter: [\n          '$state',\n          '$timeout',\n          'analytics',\n          'auth',\n          'cartService',\n          'checkoutAnalytics',\n          'reservationService',\n          '$rootScope',\n          function (\n            $state,\n            $timeout,\n            analytics,\n            auth,\n            cartService,\n            checkoutAnalytics,\n            reservationService,\n            $rootScope\n          ) {\n            $timeout(() => {\n              // Fetch and reload state if cart hasn't loaded yet. Edge case if window is refreshed.;\n              if (!cartService.cart) {\n                cartService.fetch().then(() => $state.reload())\n              } else if (!cartService.cart.items.length) {\n                $state.go('main.checkout.cart')\n                // Redirect to address/reservation page if no timeslot or delivery mode but invalid state.\n              } else if (!reservationService.reservation || auth.isDeliveryContextInvalid()) {\n                $state.go('main.checkout.reservation.address')\n              } else if (!$rootScope.modifyingOrder) {\n                checkoutAnalytics.enterCheckoutFlow()\n                checkoutAnalytics.viewPaymentOptions({ payment: {} })\n              }\n            })\n          },\n        ],\n      })\n\n      // Confirmation\n      runtimeRoutes.addState('main.checkout.confirmation', {\n        url: '/confirmation/:orderId',\n        views: {\n          checkout: {\n            template: require('@app/angular/components/checkout/views/checkoutConfirmation.html'),\n            controller: 'CheckoutConfirmationController',\n          },\n        },\n        data: {\n          requireRegistered: true,\n          requireICAccountLink: true,\n        },\n        resolve: {\n          oneCartCheckoutRedirect: oneCartCheckoutRedirectFunc,\n          order: [\n            '$stateParams',\n            'Restangular',\n            function ($stateParams, Restangular) {\n              return Restangular.one('orders', $stateParams.orderId).get()\n            },\n          ],\n          // We don't want any of the progress segments to be clickable/linkable on the checkout confirmation page\n          modifiedProgressSegments: [\n            'progressSegments',\n            progressSegments => _.map(progressSegments, segment => ({ ...segment, sref: null })),\n          ],\n          title: [\n            'titleService',\n            function (titleService) {\n              return titleService.setTitle(lang.values.orderComplete)\n            },\n          ],\n        },\n        onEnter: [\n          'checkoutAnalytics',\n          'order',\n          function (checkoutAnalytics) {\n            checkoutAnalytics.exitCheckoutFlow({}, true)\n          },\n        ],\n      })\n\n      // Upsell v2\n      runtimeRoutes.addState('main.checkout.customUpsell', {\n        url: CHECKOUT_ROUTES.V2.UPSELL,\n        data: {\n          requireRegistered: true,\n        },\n        resolve: {\n          oneCartCheckoutRedirect: oneCartCheckoutRedirectFunc,\n          title: [\n            'titleService',\n            titleService => {\n              return titleService.setTitle(lang.values.upsellTitle)\n            },\n          ],\n        },\n        views: {\n          'fixed-content@': {\n            template: require('@app/angular/components/checkout/views/customUpsell.html'),\n            controller: 'CheckoutManualUpsellController',\n          },\n        },\n        onEnter: [\n          '$timeout',\n          'checkoutAnalytics',\n          'upsellProducts',\n          ($timeout, checkoutAnalytics, upsellProducts) => {\n            checkoutAnalytics.enterCheckoutFlow()\n            checkoutAnalytics.enterCheckoutUpsell({ upsellProducts })\n          },\n        ],\n        onExit: [\n          'cartService',\n          'checkoutAnalytics',\n          'upsellProducts',\n          (cartService, checkoutAnalytics, upsellProducts) => {\n            const upsellProductsInCart = cartService.getUpSellProductsInCart(upsellProducts)\n            checkoutAnalytics.exitCheckoutUpsell({ upsellProducts: upsellProductsInCart })\n          },\n        ],\n      })\n\n      // Checkout v2 Page\n      runtimeRoutes.addState('main.checkout.checkoutPage', {\n        url: CHECKOUT_ROUTES.V2.CHECKOUT_REVIEW,\n        data: {\n          requireRegistered: true,\n        },\n        params: {\n          initialStep: null,\n        },\n        resolve: {\n          oneCartCheckoutRedirect: oneCartCheckoutRedirectFunc,\n          initialStep: ['$stateParams', $stateParams => $stateParams.initialStep],\n          title: ['titleService', titleService => titleService.setTitle(lang.values.checkout)],\n          // Make sure PII session hasn't expired, will cause a stateChangeError if so.\n          userProfile: ['auth', auth => auth.getProfile()],\n        },\n        views: {\n          'fixed-content@': {\n            template: require('@app/angular/components/checkout/views/checkoutPage.html'),\n            controller: 'CheckoutPageController',\n          },\n        },\n        onEnter: [\n          '$state',\n          '$timeout',\n          'analytics',\n          'cartService',\n          'checkoutAnalytics',\n          function ($state, $timeout, analytics, cartService, checkoutAnalytics) {\n            $timeout(() => {\n              // Fetch and reload state if cart hasn't loaded yet. Edge case if window is refreshed.\n              if (!cartService.cart) {\n                cartService.fetch().then(() => $state.reload())\n              } else if (!cartService.cart.items.length) {\n                $state.go('main.checkout.cart')\n              } else {\n                checkoutAnalytics.enterCheckoutFlow()\n                checkoutAnalytics.enterCheckoutReview()\n              }\n            })\n          },\n        ],\n        onExit: [\n          'checkoutService',\n          checkoutService => {\n            checkoutService.isCartValidated = false\n          },\n        ],\n      })\n\n      runtimeRoutes.addState('main.checkout.icExpressOrderConfirmation', {\n        url: '/order/{orderId}/subscription',\n        resolve: {\n          title: [\n            'titleService',\n            titleService => {\n              return titleService.setTitle(lang.values.icExpress.postCheckoutPage.title)\n            },\n          ],\n\n          order: [\n            '$stateParams',\n            'oneCartService',\n            function ($stateParams, oneCartService) {\n              return order.api.orders.get($stateParams.orderId, {\n                one_cart_enabled: oneCartService.enabled(),\n                user_timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,\n              })\n            },\n          ],\n        },\n        views: {\n          'fixed-content@': {\n            template: require('@app/angular/components/icExpress/views/postCheckoutCreditCardPage.html'),\n            controller: 'IcExpressPostCheckoutCreditCardPageController',\n            controllerAs: '$ctrl',\n          },\n        },\n      })\n    }\n\n    const _viewCartAnalytics = ({ $rootScope, $timeout, checkoutAnalytics }) => {\n      // This timeout is needed to resolve a race condition, the value of '$rootScope.previousState'\n      // will update after the if statement is evaluated if there is no delay. So in the case of going\n      // from the home page then to the cart this will evalute with an empty string even though the\n      // previous state was the home page\n      $timeout(() => {\n        /**\n         * Empty string here means that the application was reloaded by calling *$rootScope.reloadState*,\n         * in this case, there's no need to trigger the cart.view event again. So we should not trigger the cart view event.\n         * */\n        if (!['', 'main.checkout.cartV2'].includes($rootScope.previousState)) {\n          checkoutAnalytics.cartView()\n        }\n        checkoutAnalytics.exitCheckoutFlow()\n      }, 10)\n    }\n  })\n","import angular from 'angular'\nimport CheckoutRoutes from './routes/checkoutRoutes'\n\nexport default angular\n  .module('RoutingServiceModule', [CheckoutRoutes.name])\n  .service('routingService', function (checkoutRoutes) {\n    const routingServices = [checkoutRoutes]\n\n    routingServices.forEach(route => route.init())\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('runtimeRoutesServicesModule', [])\n  .provider('runtimeRoutes', function runtimeRoutes($stateProvider) {\n    const provider = this\n\n    // runtimeRoutes.addState will allow you to inject new states to ui-router's stateProvider\n    // inside of runtime code (ie - to help in keeping API configs out of Angular .config() blocks)\n    provider.$get = function () {\n      return {\n        addState(name, state) {\n          $stateProvider.state(name, state)\n        },\n      }\n    }\n  })\n","import angular from 'angular'\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\nimport * as shoppingContextActions from '@app/services/shoppingContext/actions'\nimport * as shoppingContextSelectors from '@app/services/shoppingContext/selectors'\n\nexport default angular\n  .module('shoppingContextServiceModule', [])\n  .service('shoppingContextService', function ($ngRedux, auth, config, eComLightService) {\n    const service = this\n\n    const mapStateToService = state => ({\n      selectedFulfillmentType: shoppingContextSelectors.currentFulfillmentType(state),\n    })\n\n    $ngRedux.connect(mapStateToService, {\n      ...shoppingContextActions,\n      // For compatibility with existing method name\n      setSelectedFulfillmentType: shoppingContextActions.setFulfillmentType,\n    })(service)\n\n    service.getShoppingModeTitle = shoppingMode => {\n      const shoppingModeConfig = eComLightService.inEComLightMode\n        ? config.shoppingSelector[SHOPPING_MODES.CATERING]\n        : config.shoppingSelector[shoppingMode || auth.getContext()?.intent]\n\n      const { shortTitle, title } = shoppingModeConfig || {}\n\n      return shortTitle || title\n    }\n\n    /**\n     * Returns the user current fulfillment type\n     *\n     * @returns {string}\n     */\n    service.getIntentFromContext = () => {\n      const { intent, shopping_mode } = auth.getContext() || {}\n\n      if (\n        config.eComLight?.enabled &&\n        intent === config.eComLight.fulfillmentType &&\n        shopping_mode === SHOPPING_MODES.CATERING\n      ) {\n        return SHOPPING_MODES.CATERING\n      }\n\n      return intent\n    }\n  })\n","import _ from 'lodash'\nimport angular from 'angular'\nimport dayjs from 'dayjs'\n\nimport * as storage from '@app/utils/storage'\n\nconst SHOPPING_LIST_CACHE_KEYS = {\n  CACHED_SHOPPING_LIST: 'cached-shopping-list',\n}\n\nconst DEFAULT_PRODUCT_IMAGE = require('static/images/no-product-image.jpg')\nconst DEFAULT_HEADER_IMAGE = require('assets/images/footer-logo.svg')\n\n/**\n *\n * This service manages implements the local caching of the shopping list\n * This has all the function needed from the cart service for the shopping list\n *\n */\nexport default angular\n  .module('ShoppingListCacheModule', [])\n  .service(\n    'shoppingListCache',\n    function shoppingListCache(\n      $q,\n      $timeout,\n      Restangular,\n      config,\n      configurableProductService,\n      utilService\n    ) {\n      // eslint-disable-next-line import/no-named-as-default-member\n      const storageService = storage.getInstance()\n\n      const service = this\n      service.cache = null\n      service.cart = null\n      service.cachePayloadList = []\n\n      /**\n       * This will get the cache object\n       *\n       * @returns { Object } The cache object, the cache object consists of the following values\n       *\n       * {\n       *  cart - {Object} Representing the cart ,\n       *  categorizedProductsAndCategories - {Object} Representing the categories of the products,\n       *  defaultProductImage - {String} Representing the base64 image of the default product image,\n       *  lastModifiedOffline - {String} Representing an ISO formatted datetime,\n       * }\n       *\n       */\n      service.getCache = () => {\n        if (service.cache) {\n          return $q.resolve(service.cache)\n        }\n        return storageService\n          .getItem(SHOPPING_LIST_CACHE_KEYS.CACHED_SHOPPING_LIST)\n          .then(cachedShoppingList => {\n            if (cachedShoppingList) {\n              service.cache = cachedShoppingList\n              service.cart = service.cache.cart\n              return service.cache\n            }\n          })\n      }\n      /**\n       * This is needed to mimic the cartservice\n       */\n      service.fetch = () => service.getCache().then(cache => cache && cache.cart)\n\n      /**\n       * This will update the cache. The cache should only be updated directly through this function\n       *\n       * @param { Object } [cache] An object that will be added to cache NOT overwritten\n       *\n       * @returns { Object } The cache object, the cache object consists of the following values\n       *\n       * {\n       *  cart - {Object} Representing the cart ,\n       *  categorizedProductsAndCategories - {Object} Representing the categories of the products,\n       *  defaultProductImage - {String} Representing the base64 image of the default product image,\n       *  lastModifiedOffline - {String} Representing an ISO formatted datetime,\n       * }\n       *\n       */\n      service.setCache = cache => {\n        // Buffer the cache payloads to prevent multiple overriding saves to cache.\n        service.cachePayloadList.push(cache)\n\n        $timeout(() => {\n          if (!service.cachePayloadList.length) return\n          const newCache = service.cachePayloadList.reduce((result, current) => {\n            return Object.assign(result, current)\n          }, {})\n          service.cachePayloadList = []\n          // This is needed to remove any functions on the object\n          // TODO: maybe move this to the service, how will it affect performance\n          const cleanObject = obj => JSON.parse(JSON.stringify(obj))\n          return storageService\n            .setItem(SHOPPING_LIST_CACHE_KEYS.CACHED_SHOPPING_LIST, cleanObject(newCache))\n            .then(updatedCache => {\n              service.cache = updatedCache\n              service.cart = service.cache.cart\n              return service.cache\n            })\n        }, 1000)\n      }\n\n      /**\n       * This will save the default product image to the storageservice as base64 image\n       */\n      const cacheDefaultImages = () => {\n        service.getCache().then(cache => {\n          if (!cache?.defaultProductImage) {\n            utilService.getBase64Image(DEFAULT_PRODUCT_IMAGE).then(noImage64 => {\n              service.setCache({ defaultProductImage: noImage64 })\n            })\n          }\n          if (!cache?.defaultHeaderImage) {\n            utilService.getBase64Image(DEFAULT_HEADER_IMAGE).then(noHeaderImage64 => {\n              service.setCache({ defaultHeaderImage: noHeaderImage64 })\n            })\n          }\n        })\n      }\n      cacheDefaultImages()\n\n      /**\n       * This will compare the last modification on the online version and\n       * compare it to last modification of the offline version. If the offline versions\n       * last modification was after the last modification of the online version then we\n       * overwrite with the offline version.\n       *\n       * @returns { Promise } Promise with a base64 image as the response\n       *\n       */\n      service.putCacheToCart = () => {\n        const getCachedCartModifiedPromise = service\n          .getCache()\n          .then(({ lastModifiedOffline }) => lastModifiedOffline)\n        const userlistEndpoint = Restangular.one('/user_lists/default')\n        const getOnlineCartModifiedPromise = userlistEndpoint.get()\n        return $q\n          .all([getCachedCartModifiedPromise, getOnlineCartModifiedPromise])\n          .then(([modifiedOffline, onlineCart]) => {\n            if (dayjs(modifiedOffline).isAfter(dayjs(onlineCart.modified))) {\n              return userlistEndpoint.customPUT({ items: service.cart.items })\n            }\n          })\n      }\n\n      /**\n       * This will set the cart object and the total count of the item to\n       * be stored for offline use. We must get the non unique count sent from\n       * the cart service so that we are not duplicating the count calculation.\n       *\n       * @param { Object } [cart] to be saved using the storage service\n       * @param { Number } [count] the total count of items in the cart\n       *\n       * @returns { Object } The cart object that was saved\n       *\n       */\n      service.setCart = cart => {\n        return service.setCache({ cart })\n      }\n\n      /**\n       * This will update the offline cache and update the time of the last made change\n       * on the offline cache. All offline modifications should go through this function\n       *\n       * @param { Object } [cart] to be saved using the storage service\n       *\n       * @returns { Object } The cart object that was saved\n       *\n       */\n      const setOfflineCache = cache => {\n        return service.setCache({ ...cache, lastModifiedOffline: dayjs().toISOString() })\n      }\n\n      /**\n       * To be able to view the category information offline we need to store it\n       *\n       * @param { Object } [categories] to be saved using the storage service\n       *\n       * @returns { Promise } that the categories were saved\n       *\n       */\n      service.setCategories = categorizedProductsAndCategories => {\n        return service.setCache({ categorizedProductsAndCategories })\n      }\n\n      /**\n       * This mimics the 'getCategorizedProductsAndCategories' call from cart service\n       *\n       * @returns { Promise } with th categories\n       *\n       */\n      service.getCategorizedProductsAndCategories = () => {\n        return service.getCache().then(cache => cache && cache.categorizedProductsAndCategories)\n      }\n\n      // These function are taken directly from the cart service.\n      service.getCustomItems = () =>\n        _.filter(service.cart && service.cart.items, { item_type: 'pseudo_product' })\n\n      service.getNonCustomItems = () =>\n        _.reject(service.cart && service.cart.items, { item_type: 'pseudo_product' })\n\n      service.getAllProductsByAisle = () => {\n        return _.groupBy(service.getNonCustomItems(), item => {\n          // Set aisle label to \"Aisle Unknown\" (or as defined in retailer config) if aisle is null\n          return item.store_product && item.store_product.aisle\n            ? item.store_product.aisle\n            : config.unknownAisleText\n        })\n      }\n\n      /**\n       * This is taken from the update dirty items function in the cart service\n       * This is mostly handling the product equality check\n       * TODO: product equality should not be handled here and should probably be\n       * in some product service\n       *\n       * @param { Object } [item] the cart item to look for\n       *\n       * @returns { Number } the index of the product in the cart.items array\n       *\n       */\n      const getProductIndex = (item, list) => {\n        const isRegularProductEqual = (itemA, itemB) =>\n          itemA.store_product &&\n          itemB.store_product &&\n          // eslint-disable-next-line eqeqeq\n          itemB.store_product.id == itemA.store_product.id\n        const isConfigurableProductEqual = (itemA, itemB) =>\n          itemA.product_config &&\n          itemA.store_product &&\n          itemB.product_config &&\n          itemB.store_product &&\n          itemA.store_product.id === itemB.store_product.id &&\n          configurableProductService.isConfigEqual(\n            itemA.product_config.options,\n            itemB.product_config.options\n          )\n        // We currently only compare an exact string match, in the future we might want to make it case insensitive\n        const isCustomProductEqual = (itemA, itemB) =>\n          itemA.pseudo_product &&\n          itemB.pseudo_product &&\n          itemA.pseudo_product.name === itemB.pseudo_product.name\n        return list.findIndex(listItem => {\n          return (\n            isRegularProductEqual(item, listItem) ||\n            isConfigurableProductEqual(item, listItem) ||\n            isCustomProductEqual(item, listItem)\n          )\n        })\n      }\n\n      /**\n       * Counts total number of items in the cached cart. This was taken from the cart service\n       * TODO: write this as a function so it can be reused\n       *\n       * @param {Object} cart     - A cart object with a items array\n       * @return {Promise}        - A promise with the total number of items in a cart\n       */\n      service.itemCount = () => {\n        return service.getCache().then(cache => {\n          let itemCount = 0\n          cache &&\n            cache.cart &&\n            cache.cart.items.forEach(item => {\n              if (\n                item.store_product &&\n                (!item.store_product.product_type ||\n                  item.store_product.product_type !== 'subscription')\n              ) {\n                // When the item is a weighted product, just count the number of items to 1.\n                if (item.store_product.order_by_weight) {\n                  itemCount += 1\n                } else {\n                  itemCount += item.quantity / item.store_product.ordering_parameters.increment\n                }\n              }\n            })\n          return itemCount\n        })\n      }\n\n      /**\n       * This will update an array of existing items. This will make all the updates\n       * then set it to the cache. I did it this way to prevent multiple calls to set\n       * cache which might have a negative performance impact.\n       *\n       * @param { Object } [items] An array of items to update\n       *\n       * @returns { Object } the updated cache\n       *\n       */\n      service.updateItems = items => {\n        // This is needed as we save the items in the categorizedProductsAndCategories cache also\n        // so they need to be updated there also. I am not sure why but we get the products sorted\n        // from the backend and that is the response we are caching, so it creates redundant data\n        // so both have to be updated for it to be reflected properley in the ui\n        const updateItemInObject = (obj, item) => {\n          Object.keys(obj).forEach(key => {\n            const productIndex = getProductIndex(item, obj[key])\n            if (productIndex > -1) {\n              obj[key][productIndex] = item\n            }\n          })\n          return obj\n        }\n\n        // This will get the cart and categorizedProductsAndCategories and update the item in both\n        // then it will set it to the cache\n        return service.getCache().then(({ cart, categorizedProductsAndCategories }) => {\n          // eslint-disable-next-line no-restricted-syntax\n          for (const item of items) {\n            // Replace the item in the cart items arrays if it already exists\n            // otherwise add it to the list\n            const itemIndex = getProductIndex(item, cart.items)\n            if (itemIndex > -1) {\n              cart.items[itemIndex] = item\n            } else {\n              cart.items.push(item)\n            }\n            // Replace the item in the categorizedProductsAndCategories.productsByCategory object\n            categorizedProductsAndCategories.productsByCategory = updateItemInObject(\n              categorizedProductsAndCategories.productsByCategory,\n              item\n            )\n          }\n          // Set the updated cart and categorizedProductsAndCategories to the cache\n          return setOfflineCache({\n            cart,\n            categorizedProductsAndCategories,\n          })\n        })\n      }\n\n      /**\n       * This will update an already existing item\n       *\n       * @param { Object } [item] the item to update\n       *\n       * @returns { Object } the updated cache\n       *\n       */\n      service.updateItem = item => service.updateItems([item])\n\n      /**\n       * This will remove the items from the cart\n       *\n       * @param items[] { [object] } The array of items to remove, this will default to the service.cart\n       *\n       * @returns { Object } the promise that the update has been saved to the cache\n       *\n       */\n      service.removeItems = items => {\n        return service\n          .updateItems(\n            (items || service.cart.items).map(item => {\n              return { ...item, quantity: 0 }\n            })\n          )\n          .then(() => {\n            // This is needed to mimic the BE response which would update the fields to zero\n            service.cart.item_count = 0\n            service.cart.discount_total = '0.0'\n            service.cart.points.awarded = '0'\n            service.cart.product_total = '0.0'\n          })\n      }\n\n      service.notYetSupported = () => console.warn('This feature is not yet supported')\n\n      service.getItemDescription = item =>\n        `${item.store_product.name} ${item.store_product.size_string || ''}`\n\n      // These are all the functions used from the cart service that update the cart\n      service.clear = () => service.notYetSupported\n      service.sync = () => service.notYetSupported\n    }\n  )\n","import angular from 'angular'\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\n\nexport default angular\n  .module('sideCartServiceModule', [])\n  .service(\n    'sideCartService',\n    function sideCartService($rootScope, $state, $timeout, auth, config, oneCartService) {\n      const service = this\n\n      service.openSideCart = () => ($rootScope.isSideCartOpen = true)\n      service.closeSideCart = () => ($rootScope.isSideCartOpen = false)\n\n      service.goToNextStep = () => {\n        const { intent } = auth.getContext()\n        const isCartMode = intent !== SHOPPING_MODES.INSTORE_LIST\n        const state = isCartMode ? 'main.checkout.cart' : 'main.inStoreList.review'\n\n        if (oneCartService.enabled() && isCartMode) {\n          // Timeout because the event could be triggered by React, and we need a $rootScope refresh\n          $timeout(service.openSideCart)\n          return\n        }\n\n        // When OneCart is disabled or the user is in-store list mode, take the user to the review page\n        $state.go(state)\n      }\n    }\n  )\n","import _ from 'lodash'\nimport angular from 'angular'\nimport distance from '@turf/distance'\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\n\nimport { prioritizeActiveStore } from '../../components/shoppingSelector/storeSelector/helpers'\n\nexport default angular\n  .module('storeServicesModule', [])\n  .service(\n    'storesService',\n    function storesService($filter, $http, $q, Restangular, config, unataCommService) {\n      const service = this\n\n      service.distanceUnits = config.useKMForStoreSelectorUnits ? 'kilometers' : 'miles'\n\n      service.storeDistanceReferenceMap = {}\n\n      service.preferredFulfillmentType = 'pickup'\n\n      // Fetch a list of stores which are valid for our current configuration\n\n      service.fetch = function (params) {\n        params = params === undefined ? {} : params\n\n        if (config.banner) {\n          params.banner = config.banner\n        }\n\n        if (config.showEcommerce) {\n          params.show_ecommerce = config.showEcommerce\n        }\n\n        const promise = Restangular.all('stores').getList(params)\n\n        promise.then(stores => {\n          service.stores = stores\n\n          // TODO: Remove this when Integration step ensures this never happens.\n          // Mutate store objects to ensure if `has_pickup` is `false`, that `show_pickup` is also `false`.\n          // (This is important as the FE now only ever uses/checks `show_pickup` to determine if a store should be available in pickup or not.)\n          // (Same applies to `has_delivery` and `show_delivery`.)\n          _.forEach(service.stores, store => {\n            if (!store.has_pickup && store.show_pickup) {\n              store.show_pickup = false\n            }\n            if (!store.has_delivery && store.show_delivery) {\n              store.show_delivery = false\n            }\n          })\n        })\n\n        return promise\n      }\n\n      service.fetchBanners = params => {\n        return Restangular.one('stores/retailer_slugs').get(params)\n      }\n\n      /**\n       * Validates the delivery for a given postal code\n       *\n       * @param { string } postalCode - The delivery postal code\n       * @returns { Promise } - Promise that resolves to a errorObject with the following structure:\n       *  {\n       *    isValid: boolean,\n       *    errorType?: string\n       *  }\n       */\n      service.validateDelivery = (postalCode, userStoreId) => {\n        const storesPayload = {\n          delivery_postal_code: postalCode,\n          show_delivery: true,\n        }\n\n        return service.fetch(storesPayload).then(stores => {\n          // No stores available for the given postal code\n          if (stores.length === 0) {\n            return {\n              isValid: false,\n              errorType: 'NO_STORES_FOUND',\n            }\n          }\n\n          const isStoreFound = !!_.find(stores, { id: userStoreId })\n\n          if (isStoreFound) {\n            return {\n              isValid: true,\n            }\n          }\n\n          return {\n            isValid: false,\n            errorType: 'STORE_NOT_IN_THE_LIST',\n          }\n        })\n      }\n\n      // Listening for a 'unata-get-stores' message from client\n      unataCommService.listen(unataCommService.EventType.GETSTORES, () => {\n        service.fetch().then(stores => {\n          const simplifiedStores = stores.plain().map(store => service.simplifyStoreDetails(store))\n\n          const payload = {\n            stores: simplifiedStores,\n          }\n\n          unataCommService.send({ eventType: unataCommService.EventType.STORES, payload })\n        })\n      })\n\n      // Listening for a 'unata-get-store' message from client\n      unataCommService.listen(unataCommService.EventType.GETSTORE, event => {\n        service.fetch().then(stores => {\n          let store\n\n          // External store id?\n          if (event.data.payload.ext_id) {\n            store = stores.plain().find(store => {\n              return parseInt(store.ext_id, 10) === parseInt(event.data.payload.ext_id, 10)\n            })\n          }\n\n          // Internal store id?\n          if (event.data.payload.id) {\n            store = stores.plain().find(store => {\n              return parseInt(store.id, 10) === parseInt(event.data.payload.id, 10)\n            })\n          }\n\n          // Set store and redirect if found\n          if (store) {\n            const payload = this.simplifyStoreDetails(store)\n            unataCommService.send({ eventType: unataCommService.EventType.STORE, payload })\n          }\n        })\n      })\n\n      // Simplify the store details\n      service.simplifyStoreDetails = store => {\n        const fields = [\n          'id',\n          'ext_id',\n          'href',\n          'name',\n          'phone_number',\n          'address',\n          'location',\n          'retailer_store_id',\n          'store_hours',\n          'external_url',\n        ]\n        return _.pick(store, fields)\n      }\n\n      const createPoint = coordinates => ({\n        type: 'Feature',\n        geometry: {\n          type: 'Point',\n          coordinates,\n        },\n      })\n\n      const distanceBetween = (a, b) => {\n        const pointA = createPoint([Number(a.longitude), Number(a.latitude)])\n        const pointB = createPoint([Number(b.longitude), Number(b.latitude)])\n\n        return distance(pointB, pointA, { units: service.distanceUnits })\n      }\n\n      service.getStoresWithinRange = ({ stores, location, range } = {}) => {\n        const storesInRange = []\n\n        stores.forEach(store => {\n          const distance = distanceBetween(store.location, location)\n\n          service.storeDistanceReferenceMap[store.id] = distance\n\n          if (distance >= 10 || distance === 0) {\n            store.distance = distance.toFixed(0)\n          } else {\n            store.distance = distance.toFixed(1)\n          }\n\n          // Only list stores within a specific range\n          if (distance <= range) {\n            storesInRange.push(store)\n          }\n        })\n\n        return storesInRange\n      }\n\n      const MATCHED_STORE_TYPES = {\n        DEFAULT: 'DEFAULT',\n        LOCATION_BASED: 'LOCATION_BASED',\n        SEARCH_BASED: 'SEARCH_BASED',\n      }\n      service.MATCHED_STORE_TYPES = MATCHED_STORE_TYPES\n\n      /**\n       * This method filters a given array of stores using multiple params\n       * @param {object} location - contains a latitude and longitude attributes\n       * @param {array} allStores - stores to be filtered\n       * @param {string} searchTerm - user search text\n       * @param {string} intent - user current shopping intent\n       * @param {string} storeID\n       * @param {string} returnMatchedFor - would you like to center on default store or on store closest to user, ...\n       *\n       * @returns {object}\n       *   contains an array of filtered *stores*\n       *   and a *matchedStore* object\n       */\n      service.filterStores = ({\n        location,\n        allStores,\n        searchTerm,\n        intent,\n        storeID,\n        returnMatchedFor = MATCHED_STORE_TYPES.DEFAULT,\n      }) => {\n        let stores = []\n\n        stores = allStores.filter(store => {\n          // I know this is confusing, why do you match all when location exists? What does it prove?\n          // For now this is just an optimization of previous code that is pointless (you can check history)\n          let match = !!location\n\n          // Include stores which match search term\n          if (!searchTerm || $filter('filter')([store], searchTerm).length) {\n            match = true\n          }\n\n          return match\n        })\n\n        // First, sort by distance\n        let closestStore = null\n        if (location) {\n          stores = service.getStoresWithinRange({\n            stores: allStores,\n            location,\n            range: config.storeSearchRange,\n          })\n\n          stores = _.sortBy(stores, store => {\n            return service.storeDistanceReferenceMap[store.id]\n          })\n          closestStore = stores[0]\n        }\n\n        // Second, prioritize exact search matches\n        stores = _.sortBy(stores, store => {\n          return $filter('filter')([store], searchTerm).length ? 0 : 1\n        })\n        const matchBySearch = stores[0]\n\n        // Third, prioritize stores that support pickup\n        if (intent === SHOPPING_MODES.PICKUP) {\n          stores = _.sortBy(stores, store => {\n            return store.show_pickup ? 0 : 1\n          })\n        }\n\n        // Lastly, prioritize stores that the user has previously shopped at\n        stores = _.sortBy(stores, store => {\n          return store.last_purchased === null ? 1 : 0\n        })\n\n        let matchedStore\n        if (returnMatchedFor === MATCHED_STORE_TYPES.LOCATION_BASED) {\n          matchedStore = closestStore\n        } else if (returnMatchedFor === MATCHED_STORE_TYPES.SEARCH_BASED) {\n          matchedStore = matchBySearch\n        } else {\n          matchedStore = stores[0]\n        }\n\n        stores = prioritizeActiveStore(storeID, stores)\n\n        return {\n          stores,\n          matchedStore,\n        }\n      }\n\n      service.getAddressCoordinates = address => {\n        const deferred = $q.defer()\n        $http\n          .get(\n            `https://api.mapbox.com/geocoding/v5/mapbox.places/${address}.json?country=us,ca&access_token=${config.mapboxglAccessToken}`\n          )\n          .then(response => {\n            let location = {}\n            if (response.data.features.length > 0) {\n              location = {\n                latitude: response.data.features[0].center[1],\n                longitude: response.data.features[0].center[0],\n              }\n            }\n            deferred.resolve(location)\n          })\n          .catch(err => {\n            deferred.reject(err)\n          })\n\n        return deferred.promise\n      }\n    }\n  )\n","import angular from 'angular'\n\nexport default angular\n  .module('subscriptionsServicesModule', [])\n\n  .service('subscriptionsService', function subscriptionsService($q, Restangular, config) {\n    const service = this\n\n    service.fetch = function () {\n      return config.hasSubscriptions\n        ? Restangular.all('store_products').getList({ type: 'subscription' })\n        : $q.resolve([])\n    }\n  })\n","import angular from 'angular'\nimport { subscriptions } from '@instacart/enterprise-services'\nimport promiseWrapper from '@app/utils/promiseWrapper'\n\nexport default angular\n  .module('subscriptionCheckoutServiceModule', [])\n  .service('subscriptionCheckoutService', function () {\n    this.data = {}\n\n    this.setData = newData => {\n      this.data = { ...this.data, ...newData }\n      return this.data\n    }\n\n    this.getData = () => {\n      return this.data\n    }\n\n    this.getStoreSubscriptions = promiseWrapper(subscriptions.promiseActions.getStoreSubscriptions)\n  })\n","import angular from 'angular'\nimport isMobileApp from '@app/utils/isMobileApp'\n\nimport { LOGIN_CONTEXTS } from '@app/angular/constants/loginContexts'\n\nexport default angular\n  .module('tagsServicesModule', [])\n\n  .service(\n    'tagsService',\n    function tagsService(\n      $rootScope,\n      $state,\n      auth,\n      config,\n      mobileService,\n      oneCartService,\n      registrationService\n    ) {\n      const service = this\n\n      service.filterBarTags = []\n      service.quickshopTags = []\n      service.offerTags = []\n      service.couponTags = []\n\n      // Return a list of all product tags, removing those\n      // that shouldn't be shown to the current user\n      service.tags = function (reject) {\n        const allTags = config.tags\n\n        let hasOverrideIndex = false\n\n        // Start off with all tags, optionally remove specified tags\n        const filteredTags = allTags.filter(tag => {\n          if (Array.isArray(reject)) {\n            return reject.find(rejectValue => rejectValue === tag.value)\n          }\n          if (reject) {\n            return tag.value !== reject.value\n          }\n          // Check if customTag has an index override\n          if (!tag.index) {\n            hasOverrideIndex = true\n          }\n          return tag\n        })\n\n        // Checks if filteredTags has an explicit index and rearranges array to reflect preferred order\n        if (hasOverrideIndex) {\n          return sortTags(filteredTags)\n        }\n\n        return filteredTags\n      }\n\n      // Returns an array of tags that have the 'requireRegistered' flag set to true\n      service.requireRegisteredTags = function (activeFilters, allFilters) {\n        let filterTag = {}\n        const tags = []\n\n        if (Array.isArray(activeFilters)) {\n          activeFilters.forEach(tag => {\n            filterTag = allFilters.find(filter => filter.id === tag) || {}\n            if (filterTag.requireRegistered) {\n              tags.push(tag)\n            }\n          })\n        } else if (angular.isObject(activeFilters)) {\n          angular.forEach(activeFilters, (value, tag) => {\n            filterTag = allFilters.find(filter => filter.id === tag)\n            if (value && filterTag.requireRegistered) {\n              tags.push(tag)\n            }\n          })\n        } else if (angular.isString(activeFilters)) {\n          filterTag = allFilters.find(filter => filter === activeFilters) || {}\n          if (filterTag.requireRegistered) {\n            tags.push(activeFilters)\n          }\n        }\n\n        return tags\n      }\n\n      // Opens a login modal. If user fails to login, removes any registerOnlyFilters. Supports callbacks\n      service.checkRegistrationRequired = function (options) {\n        const tagsRequiringRegistration = service.requireRegisteredTags(\n          options.activeTags,\n          options.allTags\n        )\n        if (auth.user.status === 'trial' && tagsRequiringRegistration.length > 0) {\n          const removeRequiredTags = () => {\n            if (Array.isArray(options.activeTags)) {\n              angular.forEach(tagsRequiringRegistration, value => {\n                const indexOfTag = options.activeTags.indexOf(value)\n                if (indexOfTag > -1) {\n                  options.activeTags.splice(indexOfTag, 1)\n                }\n              })\n            } else if (angular.isObject(options.activeTags)) {\n              angular.forEach(tagsRequiringRegistration, value => {\n                // eslint-disable-next-line no-prototype-builtins\n                if (options.activeTags.hasOwnProperty(value)) {\n                  delete options.activeTags[value]\n                }\n              })\n            }\n          }\n          // Opening login doesn't work properly on mobile navtive since it open it in an InAppBrowser\n          // Which are closed when the states change.\n          if (isMobileApp() && registrationService.hasOptionalAuthService) {\n            removeRequiredTags()\n            const promise = options.failure()\n            return (\n              promise &&\n              promise.then(() => {\n                return registrationService.open(\n                  'login',\n                  null,\n                  null,\n                  null,\n                  null,\n                  null,\n                  LOGIN_CONTEXTS.TAG_LOGIN\n                )\n              })\n            )\n          }\n          return registrationService\n            .open('login', null, null, null, null, null, LOGIN_CONTEXTS.TAG_LOGIN)\n            .then(\n              () => {\n                // If user logs in/registers, call success callback\n                if (angular.isFunction(options.success)) {\n                  // FRN-951: hack so we can tell the difference between successfully logging in and not needing to login/already logged in\n                  options.success(true) // Login was required and was successful\n                }\n              },\n              () => {\n                // If user fails to login/register, uncheck all registerOnlyFilters, call failure callback\n                $rootScope.isAppLoading = false\n                removeRequiredTags()\n                if (angular.isFunction(options.failure)) {\n                  options.failure() // Login was required but failed\n                }\n              }\n            )\n        }\n        if (angular.isFunction(options.success)) {\n          // If user is logged in, call success callback right away\n          options.success(false) // Login was either not required or the user is already logged in\n        }\n      }\n\n      service.getSelectedFilters = (tags, brands) => {\n        const selectedFilters = tags\n          .map(filter => {\n            const { name } = (filter && service.byVal(filter)) || {}\n            return name || filter || null\n          })\n          .filter(filter => filter !== null)\n\n        if (brands && brands.length > 0 && brands[0]) {\n          Array.isArray(brands) ? selectedFilters.push(...brands) : selectedFilters.push(brands)\n        }\n        return selectedFilters.length > 0 ? selectedFilters.join(', ') : ''\n      }\n\n      // TODO should be in config\n      // Helper functions to hide/show filters and whether or not to use facets\n      const nonFacetedRoutes = [\n        'main.shop.offers',\n        'main.shop.coupons',\n        'main.shop.flyer',\n        'main.shop.flyer.category',\n        'main.shop.recipes',\n        'main.shop.recipes.category',\n        'main.shop.recipes.saved',\n        'main.shop.departments.featured',\n        'main.shop.collections',\n        'main.shop.collection',\n        'main.shop.collection.category',\n      ]\n\n      service.useFacetedFilters = () =>\n        (config.enableFacetedSearchFilters || config.enableICSearch) &&\n        !nonFacetedRoutes.map(route => $state.is(route)).includes(true)\n      service.hideFilters = () => $state.params.collection_id === 'specials'\n\n      // tags filtered by location Eg return all quickshop tags\n      const getTagsForLocation = location => {\n        const tags = adjustTags(filterTags(config.tags, location), location)\n        return sortTags(tags)\n      }\n\n      // tags not filtered by location. Location is used to get the overrides\n      service.getTags = location => {\n        const tags = adjustTags(config.tags, location)\n        return sortTags(tags)\n      }\n\n      // filter tags by location.\n      const filterTags = (tags, location) => tags.filter(tag => tag.locations?.[location])\n\n      // sort tags by optional index attribute on the tags config\n      // since not all tags can have an index we splice the tag into the expected\n      // index\n      const sortTags = tags => {\n        tags.forEach((tag, index) => {\n          if (tag.index) {\n            tags.splice(tag.index, 0, tags.splice(index, 1)[0])\n          }\n        })\n        return tags\n      }\n\n      // consolidate tag with location overrides\n      const adjustTag = (tag, location) => {\n        const { isMobile } = mobileService\n        return cleanTag({\n          ...tag,\n          ...(tag.overrides && tag.overrides[location]),\n          ...(isMobile && tag?.overrides?.[location]?.mobile),\n        })\n      }\n\n      const adjustTags = (tags, location) => tags.map(tag => cleanTag(adjustTag(tag, location)))\n\n      // remove uneeded objects from the tag\n      const cleanTag = tag => {\n        if (!tag) return\n        const clonedTag = { ...tag }\n        delete clonedTag.locations\n        delete clonedTag.overrides\n        delete clonedTag.mobile\n        return clonedTag\n      }\n\n      // retrieve the tag config values by tag value/id\n      service.byVal = (tagVal, location) => {\n        const tag = service.tags().find(tag => tag.id === tagVal)\n        if (!tag) return\n        return adjustTag(tag, location)\n      }\n\n      // accepts tags and returns only those tags that have matching config tags\n      // eg use on the pdp we do not want to show tags that arent configured\n      service.getTagsMatchingConfigTags = (tagKeys, location) => {\n        if (!tagKeys) return []\n        return tagKeys.filter(tagKey => {\n          const configTag = config.tags.find(ctag => ctag.id === tagKey)\n\n          if (location) {\n            return configTag?.locations?.[location] ?? configTag\n          }\n          return configTag\n        })\n      }\n\n      // Some tags have dynamic visibility conditions, so we use this function\n      // to check the conditions at time of use rather than service instantiation.\n      service.filterDynamicTags = tags =>\n        tags?.filter(tag => {\n          if (tag.id === 'usa_snap_eligible') {\n            return (\n              config.ebt?.enabled &&\n              oneCartService.enabled() &&\n              auth.user?.store?.ebt_enabled_in_state &&\n              auth.user?.status !== 'trial'\n            )\n          }\n\n          return true\n        })\n\n      // Build the static filterBar and quickshop tags when this service instantiates\n      ;(() => {\n        service.filterBarTags = getTagsForLocation('filters')\n        service.quickshopTags = getTagsForLocation('quickshop')\n        service.offerTags = getTagsForLocation('offers')\n        service.couponTags = getTagsForLocation('coupons')\n      })()\n    }\n  )\n","import _ from 'lodash'\nimport angular from 'angular'\nimport { HTTP_ERRORS } from '@app/angular/constants/httpErrors'\n\nexport default angular\n  .module('timeslotServicesModule', [])\n  .service(\n    'timeslotService',\n    function timeslotService(\n      $q,\n      $state,\n      Restangular,\n      auth,\n      config,\n      errorModalService,\n      instacartCustomerLinkModalService,\n      lang,\n      shoppingContextService,\n      shoppingSelectorService\n    ) {\n      const service = this\n\n      service.getTimeslots = (intent, cartId, notifyOnError = true) => {\n        const above_threshold = $state.current.name !== 'main.checkout.checkoutPage'\n\n        return Restangular.all('timeslots')\n          .getList({\n            fulfillment_type: intent,\n            above_threshold,\n            cart_id: cartId,\n            user_timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,\n          })\n          .catch(response => {\n            if (\n              config.instacart.enableAccountLinking &&\n              response.data?.error === HTTP_ERRORS.EXTERNAL_AUTH_ERROR\n            ) {\n              instacartCustomerLinkModalService\n                .openModal()\n                .then(\n                  () => service.areTimeslotsSelectable() && shoppingSelectorService.open('timeslot')\n                )\n                .catch(() => {\n                  if ($state.current.name === 'main.checkout.checkoutPage') {\n                    $state.go('main.checkout.cart')\n                  }\n                })\n            } else if (notifyOnError) {\n              errorModalService\n                .open(lang.values.cantLoadTimeslots, lang.values.reload, lang.values.backToHome)\n                .then($state.reload, () => $state.go('main.home'))\n            } else {\n              console.error(lang.values.cantLoadTimeslots, response)\n            }\n          })\n      }\n\n      service.getPreviewTimeslot = (cartId, notifyOnError) => {\n        return service\n          .getTimeslots(auth.user.context.intent, cartId, notifyOnError)\n          .then(response => {\n            if (!response?.length) {\n              return null\n            }\n            const immediate_timeslots = _.sortBy(\n              _.filter(\n                response,\n                t => t.timeslot.polytype === 'immediate' && !t.timeslot.unavailable\n              ),\n              ['fulfillment_date', 'timeslot.within_hours']\n            )\n            if (immediate_timeslots.length) {\n              return immediate_timeslots[0].plain()\n            }\n\n            const scheduled_timeslots = _.orderBy(response, [\n              'fulfillment_date',\n              'timeslot.from_time',\n            ])\n\n            return scheduled_timeslots[0].plain()\n          })\n      }\n\n      service.areTimeslotsSelectableAtCheckoutOnly = () => {\n        return config.shoppingContextProcess[shoppingContextService.getIntentFromContext()]\n          ?.timeslotSelectionAtCheckoutOnly\n      }\n\n      service.areTimeslotsSelectable = () => {\n        if (!service.areTimeslotsSelectableAtCheckoutOnly()) return true\n\n        return [\n          'main.checkout.payment',\n          'main.checkout.checkoutPage',\n          'main.checkout.reservation.confirmation',\n        ].includes($state.current.name)\n      }\n    }\n  )\n","import angular from 'angular'\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\nimport { eventEmitter, EVENT_TYPES } from '@app/utils/eventEmitter'\n\nexport default angular\n  .module('toggleEComLightServicesModule', [])\n  .service(\n    'toggleEComLightService',\n    function eComLightService(\n      $rootScope,\n      $state,\n      auth,\n      cartListTransferService,\n      cartService,\n      config,\n      eComLightService,\n      shoppingContextService,\n      shoppingSelectorService\n    ) {\n      if (config.eComLight.enabled) {\n        const eComLightFulfillmentType = config.eComLight.fulfillmentType\n\n        // toggleEComLightMode mirrors some of the logic in contextSelectorController and compareCartService,\n        //  but is simplified to allow a more efficient switch for a user to/from eComLight mode,\n        //  in addition to allowing the \"deep-linking\" behaviour straight to the cartToListMigration screen that is desired\n        this.toggleEComLightMode = () => {\n          const initialContext = auth.getContext().intent\n          const updatedContext =\n            eComLightService.inEComLightMode &&\n            config.shoppingSelector[SHOPPING_MODES.INSTORE_LIST].exists\n              ? SHOPPING_MODES.INSTORE_LIST\n              : eComLightService.inEComLightMode &&\n                config.shoppingSelector[SHOPPING_MODES.PICKUP].exists\n              ? SHOPPING_MODES.PICKUP\n              : SHOPPING_MODES.CATERING\n\n          // Current number of categorized products in user's list/cart (this will exclude custom and uncategorized products)\n          const categorizedProducts = cartService.getAllStoreProductsInCart()\n          const numCategorized = categorizedProducts.length\n          const numCustom = cartService.countCustomItems()\n          const numTotal = numCategorized + numCustom\n\n          const transferData = {\n            numCustom,\n            numTotal,\n            numTransferable: 0, // We assume numTransferable is 0 and transferableProducts is [] for eComLight mode\n            transferableProducts: [],\n          }\n\n          const switchContextAndRedirectIfNecessary = () =>\n            auth.setContext({ intent: updatedContext }).then(() => {\n              const { redirectTo, redirectParams } = config.shoppingSelector.catering\n              if (updatedContext === SHOPPING_MODES.CATERING) {\n                $state.go(redirectTo, redirectParams, { reload: true })\n              } else {\n                $state.go('main.home', {}, { reload: true })\n              }\n            })\n\n          if (numTotal === 0) {\n            // Skip the cartToListMigration if they have no products to migrate\n            return switchContextAndRedirectIfNecessary()\n          }\n          shoppingSelectorService.open('cartToListMigration')\n          shoppingContextService.setSelectedFulfillmentType(\n            updatedContext === eComLightFulfillmentType ? SHOPPING_MODES.CATERING : updatedContext\n          )\n\n          // Use cartListTransferService to toggle between eComLight mode\n          return cartListTransferService\n            .initializeTransfer({\n              initialContext,\n              updatedContext,\n              transferData,\n            })\n            .then(switchContextAndRedirectIfNecessary)\n            .catch(() => {\n              // User \"cancelled\" context change during cart compare or transfer modal; close the context selector modal.\n              shoppingSelectorService.closeModal()\n            })\n        }\n\n        eventEmitter.on(EVENT_TYPES.TOGGLE_CATERING_MODE, this.toggleEComLightMode)\n      }\n    }\n  )\n","import angular from 'angular'\nimport { EventType, UnataComm } from '@instacart/enterprise-services-unata-comm'\n\n/**\n * Make Unata Comm globally available for retailer to communicate with our platform.\n * This replaces the need for retailers to include UnataCommSimple.js in their\n * headerSync scripts.\n */\nwindow.UnataComm = UnataComm\nwindow.EventType = EventType\n\nexport default angular\n  .module('unataCommServicesModule', [])\n  .service('unataCommService', function unataCommService($rootScope) {\n    const service = this\n    this.comm = new UnataComm()\n\n    /**\n     * Send a window message.\n     * @property {UnataEvent} unataEvent   - The event and the payload to send\n     */\n    service.send = (...params) => this.comm.send(...params)\n\n    /**\n     * Creates an event listener for the desired Unata event.\n     *\n     * @property {string} eventType   - The desired event to be listened for\n     * @property {function} callback  - A function to be executed when the event is observed\n     * @return {void}\n     */\n    service.listen = (...params) => this.comm.listen(...params)\n\n    /**\n     * All the possible event types that the widgets fires or watches for.\n     */\n    service.EventType = EventType\n\n    /**\n     * This clears global cached listeners for one-time events. Use this method\n     * to reset the listener cache and force them to be fired again the next\n     * time they occur. This is useful in situations like if the dotcom header\n     * unmounts then later re-mounts and expects the one-time header loaded\n     * event to fire again.\n     */\n    service.clearGlobalCachedListeners = () => this.comm.clearGlobalCachedListeners()\n\n    /**\n     * When the app state is reloaded we need to clear all cache single\n     * subscription event listeners as references in their wrapped callbacks\n     * may be out of date.\n     */\n    $rootScope.$on('reloadState', () => {\n      this.comm.clearGlobalCachedListeners()\n    })\n  })\n","/**\n * Provides a service that listens for UnataComm events in the background wherever\n * and executes any callbacks specified for that event.\n * This service is useful for attaching handlers for any UnataComm events without requiring\n * any components to be on the page.\n */\nimport angular from 'angular'\n\nexport default angular\n  .module('UnataCommInterceptorServicesModule', [])\n  .service(\n    'unataCommInterceptorService',\n    function ($filter, $window, auth, config, reservationService, unataCommService) {\n      const service = this\n\n      // Define handlers\n      service.sendAdditionalContextDetails = () => {\n        const { user } = auth\n\n        const shoppingContext = user?.context?.intent || 'instore'\n        const storeName = user?.store?.name\n\n        if (shoppingContext === 'delivery' || shoppingContext === 'pickup') {\n          const reservation = reservationService.displayReservation\n\n          if (!reservation) {\n            const errorPayload = {\n              message: 'Error encountered while retrieving the reservation',\n              detail: 'Reservation not found',\n            }\n            const payload = {\n              context: shoppingContext,\n              error: errorPayload,\n            }\n\n            unataCommService.send({\n              eventType: unataCommService.EventType.ADDITIONALCONTEXTDETAILS,\n              payload,\n            })\n          } else {\n            // return an object with the required details\n            let detailString\n            // eslint-disable-next-line eqeqeq\n            if (shoppingContext == 'delivery') {\n              detailString = `${$filter('time')(reservation.timeslot.from_time)}-${$filter('time')(\n                reservation.timeslot.to_time\n              )}`\n            } else {\n              detailString = `${$filter('date')(\n                reservation.fulfillment_date,\n                'MMM D',\n                config.apiDateFormat\n              )}, ${$filter('time')(reservation.timeslot.from_time)}-${$filter('time')(\n                reservation.timeslot.to_time\n              )}`\n            }\n\n            const payload = {\n              context: shoppingContext,\n              details: {\n                full_datetime: reservation.fulfillment_date,\n                date: `${$filter('date')(\n                  reservation.fulfillment_date,\n                  'YYYY-MM-DD',\n                  config.apiDateFormat\n                )}`,\n                from_time: reservation.timeslot.from_time,\n                to_time: reservation.timeslot.to_time,\n                detail_string: detailString,\n              },\n            }\n            unataCommService.send({\n              eventType: unataCommService.EventType.ADDITIONALCONTEXTDETAILS,\n              payload,\n            })\n          }\n        } else {\n          const payload = {\n            context: shoppingContext,\n            details: {\n              store: storeName,\n              detail_string: storeName ? `${config.lang.atStore} ${storeName}` : '',\n            },\n          }\n          unataCommService.send({\n            eventType: unataCommService.EventType.ADDITIONALCONTEXTDETAILS,\n            payload,\n          })\n        }\n      }\n\n      // Handles debug toggle events. Use browser local storage to align with cms-widgets\n      service.handleDebugEvents = event => {\n        const debugMode = event.data.payload\n        const DEBUG_STORAGE_KEY = 'DEBUG_UNATA_COMM'\n\n        if (debugMode) {\n          $window.localStorage.setItem(DEBUG_STORAGE_KEY, debugMode)\n          return\n        }\n\n        $window.localStorage.removeItem(DEBUG_STORAGE_KEY)\n      }\n    }\n  )\n","import angular from 'angular'\nimport isCordova from '@app/utils/isCordova'\nimport urlParser from '@app/utils/urlParser'\n\nexport default angular\n  .module('universalLinksServicesModule', [])\n\n  .service('universalLinksService', function universalLinksService($location, $rootScope) {\n    const service = this\n\n    // Application Constructor\n    service.initialize = function () {\n      service.bindEvents()\n    }\n\n    // Bind Event Listeners\n    service.bindEvents = function () {\n      document.addEventListener('deviceready', service.onDeviceReady, false)\n    }\n\n    // deviceready Event Handler\n    service.onDeviceReady = function () {\n      if (window.universalLinks) {\n        window.universalLinks.subscribe('urlDeepLinkCapture', service.didLaunchAppFromLink)\n      }\n    }\n\n    // Strips the local path from the URL of the event and changes the window's location to it.\n    // For a Hash URL, this takes everything after the '#'.\n    // For a HTML5 URL, this takes the path & query.\n    service.didLaunchAppFromLink = function (eventData) {\n      // Opt out and let AppsFlyer SDK handle OneLink\n      if (eventData?.host?.endsWith?.('onelink.me')) {\n        return\n      }\n\n      const urlParts = urlParser(eventData.url)\n      let cleanURL\n\n      if (urlParts.hash && (urlParts.hash[1] === '/' || urlParts.hash[1] === '?')) {\n        cleanURL = urlParts.hash.slice(1)\n      } else {\n        cleanURL = urlParts.pathname + urlParts.search\n      }\n\n      // Search parameters are sometimes ignored on cordova\n      // location.replace('#' + cleanURL);\n      $location.url(cleanURL)\n      $rootScope.$apply()\n    }\n  })\n\n  .run(($location, $rootScope, universalLinksService) => {\n    if (isCordova()) {\n      universalLinksService.initialize()\n    }\n  })\n","// Check for updates to the app in non-cordova environments\n// Cordova updates are handled by the codePush module\n\nimport angular from 'angular'\n\nexport default angular.module('updatesServicesModule', [])\n// .run(function($document, $http, $window, config, errorModalService, mobileService) {\n//   var lastCheck;\n\n//   var check = function() {\n//     lastCheck = (new Date()).getTime();\n//     var path = 'assets/js/version.json?_nocache=' + (new Date()).getTime();\n\n//     $http.get(path).then(function(response) {\n//       var versionMatches = !response.data.version || response.data.version === config.version;\n//       var timestampMatches = !response.data.timestamp || response.data.timestamp === config.timestamp;\n\n//       if (!versionMatches || !timestampMatches) {\n//         errorModalService.open(\n//           'We\\'ve made some updates to enhance your experience.',\n//           'OK',\n//           null,\n//           'Update'\n//         ).then(function() {\n//           $window.location.reload();\n//         });\n//       }\n//     });\n//   };\n\n//   if (!mobileService.isMobileApp()) {\n//     check(); // First time check\n\n//     $document.on('click', function() {\n//       var now = (new Date()).getTime();\n//       if (now - lastCheck >= config.checkVersionTimeout) {\n//         check();\n//       }\n//     });\n//   }\n// });\n","import angular from 'angular'\nimport { getUrbanAirshipChannelId } from '@app/utils/getUrbanAirshipChannelId'\nimport { DEVICE_TYPES } from './mobile'\n\nexport default angular\n  .module('urbanAirServicesModule', [])\n  .run(($rootScope, Restangular, config, mobileService, universalLinksService) => {\n    function handleDeepLink() {\n      window.UAirship.getDeepLink(true, link => {\n        if (link) {\n          let decodedLink = link\n          // Deep links from Urban Airship are URL encoded\n          try {\n            decodedLink = decodeURIComponent(link)\n          } catch (error) {\n            decodedLink = link\n          }\n          universalLinksService.didLaunchAppFromLink({ url: decodedLink })\n        }\n      })\n    }\n\n    function initializeUAirship() {\n      if (!window.UAirship) return\n\n      // Wait for the current state change to complete before re-routing\n      $rootScope.$on('firstStateChangeSuccess', () => {\n        handleDeepLink()\n      })\n    }\n\n    function resumeUAirship() {\n      if (!window.UAirship) return\n\n      window.UAirship.resetBadge()\n      initializeUAirship()\n    }\n\n    function updateChannelID(channelID) {\n      const deviceType = mobileService.getMobileOs() || DEVICE_TYPES.UNKNOWN\n      Restangular.one('user_sessions').customPUT({\n        device: { channel_id: channelID, device_type: deviceType },\n      })\n    }\n\n    if (config.urbanAirshipEnabled && mobileService.isMobileApp()) {\n      document.addEventListener('deviceready', initializeUAirship, false)\n      document.addEventListener('resume', resumeUAirship, false)\n      document.addEventListener(\n        'urbanairship.deep_link',\n        () => {\n          if ($rootScope.previousState !== undefined) {\n            handleDeepLink()\n          }\n        },\n        false\n      )\n\n      $rootScope.$on('auth', (event, action) => {\n        if (action === 'userUpdated') {\n          getUrbanAirshipChannelId(updateChannelID)\n        }\n      })\n    }\n  })\n","import angular from 'angular'\nimport { EVENTS } from '@app/angular/services/modules/analytics/analyticsConstants'\n\nexport default angular\n  .module('userAnalyticsModule', [])\n  .service('userAnalytics', function UserAnalytics($rootScope, analytics, auth) {\n    const service = this\n\n    const logUserSegmentEvent = (event, metaData = {}) => {\n      const [category, action] = event.split('.')\n      // eslint-disable-next-line no-restricted-globals\n      const userId = isNaN(auth.user?.ext_id) ? null : parseInt(auth.user?.ext_id, 10)\n\n      // Log to GTM w. category, action, and userId\n      analytics.logEvent(category, action, null, userId)\n\n      // Log to Segment with the full event name & including extra metaData if provided\n      analytics.logSegmentEvent(event, metaData)\n    }\n\n    service.logUserChangePassword = () => logUserSegmentEvent(EVENTS.USER.CHANGE_PASSWORD)\n    service.logUserLinkLoyaltyCard = () => logUserSegmentEvent(EVENTS.USER.LINK_LOYALTY_CARD)\n    service.logUserLogin = () => {\n      logUserSegmentEvent(EVENTS.USER.LOGIN)\n      analytics.logUserLogin()\n    }\n    service.logUserLoginAttempt = data => logUserSegmentEvent(EVENTS.USER.LOGIN_ATTEMPT, data)\n    service.logUserLoginStart = data => logUserSegmentEvent(EVENTS.USER.LOGIN_START, data)\n    service.logUserLogout = () => logUserSegmentEvent(EVENTS.USER.LOGOUT)\n    service.logUserRegistrationAttempt = data =>\n      logUserSegmentEvent(EVENTS.USER.REGISTRATION_ATTEMPT, data)\n    service.logUserRegistrationExit = () => logUserSegmentEvent(EVENTS.USER.REGISTRATION_EXIT)\n    service.logUserRegistrationStart = data =>\n      logUserSegmentEvent(EVENTS.USER.REGISTRATION_START, data)\n    service.logUserUpdateProfile = () => logUserSegmentEvent(EVENTS.USER.UPDATE_PROFILE)\n    service.logUserLoyaltyOnboardingStart = () =>\n      logUserSegmentEvent(EVENTS.USER.LOYALTY_ONBOARDING_START)\n    service.logUserLoyaltyOnboardingExit = data =>\n      logUserSegmentEvent(EVENTS.USER.LOYALTY_ONBOARDING_EXIT, data)\n    service.logUserLoyaltyOnboardingForgotPassword = () =>\n      logUserSegmentEvent(EVENTS.USER.LOYALTY_ONBOARDING_FORGOT_PASSWORD)\n    service.logUserLoyaltyOnboardingSocialSignOn = data =>\n      logUserSegmentEvent(EVENTS.USER.LOYALTY_ONBOARDING_SOCIAL_SIGN_ON, data)\n    service.logUserLoyaltyOnboardingThankyouCTAClick = data =>\n      logUserSegmentEvent(EVENTS.USER.LOYALTY_ONBOARDING_THANKYOU_CTA_CLICK, data)\n    service.logUserLoyaltyOnboardingThankyouStart = () =>\n      logUserSegmentEvent(EVENTS.USER.LOYALTY_ONBOARDING_THANKYOU_START)\n    service.logUserAddEbtCard = () => logUserSegmentEvent(EVENTS.USER.EBT_ADD_CARD)\n    service.logUserRemoveEbtCard = () => logUserSegmentEvent(EVENTS.USER.EBT_REMOVE_CARD)\n    service.logUserEbtClientTokenizeFailed = data =>\n      logUserSegmentEvent(EVENTS.USER.EBT_CLIENT_TOKENIZE_FAILED, data)\n    service.logUserSSORedirect = () => logUserSegmentEvent(EVENTS.USER.SSO_REDIRECT)\n    service.logUserForcedLogout = data => logUserSegmentEvent(EVENTS.USER.FORCED_LOGOUT, data)\n\n    // Cannot add this to auth because of circular dependencies.\n    $rootScope.$on('auth', (event, action) => {\n      if (action === 'userLoggedIn') {\n        service.logUserLogin()\n      } else if (action === 'userLoggingOut') {\n        service.logUserLogout()\n      }\n    })\n  })\n","import _ from 'lodash'\nimport fp from 'lodash/fp'\nimport angular from 'angular'\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\nimport { SHOPPING_SELECTOR_STAGES } from '@app/angular/constants/shoppingSelectorStages'\n\nimport { hasRxItem } from '@instacart/enterprise-services/shopping-list/_common/utils'\n\nexport default angular\n  .module('userOverridesServicesModule', [])\n  .service(\n    'userOverridesService',\n    function userOverridesService(\n      $q,\n      $rootScope,\n      Restangular,\n      auth,\n      cartService,\n      catalogCategoriesService,\n      compareCartService,\n      config,\n      eComLightService,\n      shoppingContextService,\n      shoppingSelectorService,\n      unataCommService\n    ) {\n      const service = this\n\n      // User can be forced into a certain store/context through URL \"override\" params or a config.\n      // This service is used to handle these overrides.\n\n      // service.hideCartCompareBeforeOverride\n      // service.openToStoreSelectorStep\n      // service.userOverrideStateParams\n      service.listOfOverrideParams = [\n        'b2b_store',\n        'delivery_zip',\n        'hide_cart_compare_on_arrival',\n        'shopping_context',\n        'store',\n        'store_id',\n        'confirm_context',\n        'enter_location',\n      ]\n\n      const overrideData = {}\n\n      service.getIntent = context =>\n        context === SHOPPING_MODES.CATERING ? SHOPPING_MODES.PICKUP : context\n\n      service.getContext = intent => ({ intent: service.getIntent(intent), shopping_mode: intent })\n\n      service.parseOverrideParams = stateParams => {\n        // Parse config and URL params provided into user override data\n\n        service.userOverrideStateParams = fp.flow(\n          fp.pick(service.listOfOverrideParams),\n          fp.omitBy(_.isNil)\n        )(stateParams)\n\n        service.hideCartCompareBeforeOverride = stateParams.hide_cart_compare_on_arrival\n\n        // If true, open the contextSelector modal with the context highlighted.\n        // Note. if confirmContext and enterLocation are both true, confirmContext takes precedence.\n        service.confirmContext = stateParams.confirm_context === 'true'\n\n        if (service.confirmContext) {\n          unataCommService.send({\n            eventType: unataCommService.EventType.CONFIRMCONTEXT,\n            payload: undefined,\n          })\n        }\n\n        // If true, this will force the storeSelector to show\n        service.enterLocation = stateParams.enter_location === 'true'\n        // User context overrides\n        overrideData.newContext = service.userOverrideStateParams.shopping_context\n\n        // User store overrides - they have the following priority order:\n\n        // External Store override\n        // User will be placed into a store with the provided external store id (ONLY IF A NEW TRIAL USER IS BEING CREATED)\n        overrideData.newExternalStoreId = service.userOverrideStateParams.store\n\n        // Store override\n        const forcedStoreId = config.forceStoreId\n        if (forcedStoreId) {\n          overrideData.newStoreId = forcedStoreId\n        } else if (service.userOverrideStateParams.b2b_store) {\n          overrideData.newStoreId = service.userOverrideStateParams.b2b_store\n        } else if (service.userOverrideStateParams.store_id) {\n          overrideData.newStoreId = service.userOverrideStateParams.store_id\n        }\n\n        // Zip override\n        overrideData.newZip = service.userOverrideStateParams.delivery_zip\n      }\n\n      const generateSuccessfulOverridePayload = ({\n        newContext,\n        newStoreId,\n        newZip,\n        currentContext,\n        currentStoreId,\n        currentZip,\n        currentShoppingMode,\n      }) => {\n        const overridePayload = {}\n        const addContextToPayload =\n          (newContext === SHOPPING_MODES.CATERING && newContext !== currentContext) ||\n          newContext !== currentShoppingMode\n\n        const addStoreIdToPayload = newStoreId && newStoreId !== currentStoreId\n        const addZipToPayload = newZip && newZip !== currentZip\n\n        if (addContextToPayload || addZipToPayload) {\n          overridePayload.context = {}\n\n          if (addContextToPayload) {\n            overridePayload.context = service.getContext(newContext)\n          }\n\n          if (addZipToPayload) {\n            overridePayload.context.deliveryPostalCode = newZip\n          }\n        }\n\n        if (addStoreIdToPayload) {\n          overridePayload.store_id = newStoreId\n        }\n\n        return overridePayload\n      }\n\n      // overridePayload is what is needed while creating or updating the user to set the overrides\n      // shoppingSelectorStep is the unified shopping selector screen to redirect the user to (if necessary) after the auth call\n      // eslint-disable-next-line complexity\n      const determineOverridePayloadAndShoppingSelectorStep = (\n        { newContext, newStoreId, newZip },\n        currentUser\n      ) => {\n        const payloadAndSelectorStep = $q.defer()\n\n        let currentContext\n        let currentStoreId\n        let currentZip\n        let currentShoppingMode\n\n        if (currentUser) {\n          if (currentUser.store) {\n            currentStoreId = currentUser.store.id\n          }\n\n          if (currentUser.context) {\n            currentContext = currentUser.context.intent\n            currentZip =\n              currentUser.context.deliveryPostalCode ?? currentUser.store.address.postal_code\n            currentZip = currentZip.includes('-') ? currentZip.substring(0, 5) : currentZip\n            currentShoppingMode = currentUser.context.shopping_mode\n          }\n        }\n\n        const shouldUpdateContext = context => {\n          if (!context) return false\n\n          if (\n            context === SHOPPING_MODES.CATERING &&\n            currentShoppingMode !== SHOPPING_MODES.CATERING\n          ) {\n            return true\n          }\n\n          if (context !== currentShoppingMode) {\n            return true\n          }\n\n          return false\n        }\n\n        // If the shopping_context override was passed as e.g. catering, but catering isn't enabled,\n        // override the parameter with the mode's behaveAs, if any. This allows us to support fourth\n        // mode catering alongside the legacy \"pickup as catering\" mode without requiring retailers\n        // to alter the links in their email engagement, etc.\n        if (\n          !config.shoppingSelector?.[newContext]?.exists &&\n          config.shoppingSelector?.[newContext]?.behaveAs\n        ) {\n          newContext = config.shoppingSelector[newContext].behaveAs\n        }\n\n        if (\n          // Don't allow zip override if no delivery override is specified\n          (newZip && newContext !== SHOPPING_MODES.DELIVERY) ||\n          (newContext &&\n            // Don't allow invalid context override\n            (!Object.values(SHOPPING_MODES).includes(newContext) ||\n              // Don't allow context overrides for shopping contexts that are not enabled\n              !(config.shoppingSelector[newContext] && config.shoppingSelector[newContext].exists)))\n        ) {\n          payloadAndSelectorStep.reject()\n        } else if (\n          shouldUpdateContext(newContext) ||\n          (newStoreId && newStoreId !== currentStoreId) ||\n          (newZip && newZip !== currentZip)\n        ) {\n          const destinationContext = newContext || currentContext\n          const destinationStoreId = newStoreId || currentStoreId\n          const destinationZip =\n            destinationContext === SHOPPING_MODES.DELIVERY ? newZip || currentZip : null\n\n          // We want to make sure that the mix of existing (if any) context/store/zip and new context/store/zip is valid\n          //  (e.g. that the resulting user store supports the resulting shopping context, etc).\n          // If the combination is supported, we provide the required user call payload to make that combination happen.\n          // If this is combination is not supported, we provide the user call payload for the overrides that can be performed (if any)\n          //  and which Unified Shopping Selector step to then place the user into so they can put themselves in a valid state\n          //  given the desired override parameters specified in the URL.\n\n          // If there are no issues with the overrides, this will be the payload\n          const successfulOverridePayload = generateSuccessfulOverridePayload({\n            newContext,\n            newStoreId,\n            newZip,\n            currentContext,\n            currentStoreId,\n            currentZip,\n            currentShoppingMode,\n          })\n\n          if (destinationStoreId && !destinationZip) {\n            // If the user has a destination store and zipcodes are not part of the equation,\n            //  fetch that specific store and make sure it supports the user's destination context\n            Restangular.one('stores', destinationStoreId)\n              .get()\n              .then(store => {\n                // Store exists\n\n                if (\n                  (destinationContext === SHOPPING_MODES.PICKUP && !store.show_pickup) ||\n                  (destinationContext === SHOPPING_MODES.DELIVERY && !store.show_delivery) ||\n                  (destinationContext === SHOPPING_MODES.CATERING && !store.show_catering)\n                ) {\n                  // If the store does NOT support the context the user will end up in\n\n                  if (!newContext && newStoreId) {\n                    // If only store id override was given, and that store exists, process override but make the user changes context\n                    // (\"Clean\" override failed because user's old context did not support store override)\n                    payloadAndSelectorStep.resolve({\n                      overridePayload: { context: { intent: null }, store_id: newStoreId },\n                      shoppingSelectorStep: 'shoppingContext',\n                    })\n                  } else if (!newStoreId && newContext) {\n                    // If only context override was given, and that context exists, process override but make the user change stores\n                    // (\"Clean\" override failed because user's old store did not support context override)\n                    payloadAndSelectorStep.resolve({\n                      overridePayload: {\n                        context: service.getContext(newContext),\n                        store_id: null,\n                      },\n                      shoppingSelectorStep: 'storeSelector',\n                    })\n                  } else {\n                    // Otherwise, no overrides are possible\n                    payloadAndSelectorStep.reject()\n                  }\n                } else {\n                  // If the store supports the context the user will end up in (or if no contexts are set),\n                  //  process override for context, store, or both\n\n                  let shoppingSelectorStep\n                  // Send the user to the zip input in the Unified Shopping Selector if they end up in delivery (since they'll need a zipcode)\n                  if (newContext === SHOPPING_MODES.DELIVERY) {\n                    shoppingSelectorStep = 'storeSelector'\n                  }\n\n                  payloadAndSelectorStep.resolve({\n                    overridePayload: successfulOverridePayload,\n                    shoppingSelectorStep,\n                  })\n                }\n              })\n              .catch(() => {\n                // Store does not exist - overrides are not possible\n                payloadAndSelectorStep.reject()\n              })\n          } else {\n            // Otherwise, fetch all stores filtered by the destination zipcode and context,\n            // and make sure it supports the user's destination store\n            const storesRequestPayload = {}\n\n            if (destinationContext === SHOPPING_MODES.PICKUP) {\n              storesRequestPayload.show_pickup = true\n            } else if (destinationContext === SHOPPING_MODES.DELIVERY) {\n              storesRequestPayload.show_delivery = true\n\n              if (destinationZip) {\n                storesRequestPayload.delivery_postal_code = destinationZip\n              }\n            } else if (destinationContext === SHOPPING_MODES.CATERING) {\n              storesRequestPayload.show_catering = true\n            }\n\n            Restangular.all('stores')\n              .getList(storesRequestPayload)\n              .then(stores => {\n                let supportedStores = stores\n\n                if (destinationStoreId) {\n                  supportedStores = _.filter(supportedStores, { id: destinationStoreId })\n                }\n\n                if (supportedStores.length > 0) {\n                  // Found a store for the user's destination state, process overrides\n                  const overridePayloadToReturn = { ...successfulOverridePayload }\n\n                  if (!destinationStoreId && newContext === SHOPPING_MODES.DELIVERY && newZip) {\n                    // If a delivery context and zipcode override has been provided without a store assigned to the user, or\n                    //  without a store override, place the user in the first available store that supports delivery in the provided zip\n                    overridePayloadToReturn.store_id = supportedStores[0].id\n                  }\n                  payloadAndSelectorStep.resolve({ overridePayload: overridePayloadToReturn })\n                } else {\n                  // If not, deal with some edge cases to try and process some overrides and send user to a Unified Shopping Selector screen\n                  // (We only want to process overrides if they are all potentially valid - so if a retailer tries the override the user with a\n                  //  store and context, and the store does not support that context, we don't try and do one of the overrides, we do neither.)\n\n                  // eslint-disable-next-line no-lonely-if\n                  if (newContext) {\n                    if (newContext !== SHOPPING_MODES.DELIVERY || (!newStoreId && !newZip)) {\n                      // If only context override was given, and that context exists, process override but make the user change stores\n                      // (\"Clean\" override failed because user's old store did not support context override)\n                      payloadAndSelectorStep.resolve({\n                        overridePayload: {\n                          context: service.getContext(newContext),\n                          store_id: null,\n                        },\n                        shoppingSelectorStep: 'storeSelector',\n                      })\n                    } else {\n                      // if (newContext === 'delivery' && (newStoreId || newZip))\n\n                      // eslint-disable-next-line no-lonely-if\n                      if (newStoreId && newZip) {\n                        // If all 3 overrides (with newContext === 'delivery) were provided - reject\n                        payloadAndSelectorStep.reject()\n                      } else if (newStoreId && currentZip) {\n                        // only newContext === 'delivery' & newStoreId overrides were provided\n\n                        // see if the override store supports delivery (i.e. try again without user's old zip) - otherwise, reject\n                        const fakeCurrentUser = {\n                          context: { intent: currentContext },\n                          store: { id: currentStoreId },\n                        }\n                        determineOverridePayloadAndShoppingSelectorStep(\n                          { newContext, newStoreId, newZip },\n                          fakeCurrentUser\n                        )\n                          .then(() => {\n                            // If this resolves, then we've proven our theory that the user's old zip was preventing the overrides\n                            // Clear the user's zip and send them to the zip input in the Unified Shopping Selector after the override\n                            payloadAndSelectorStep.resolve({\n                              // Return whatever the override payload would've been but with the zipcode as `null` to clear it\n                              overridePayload: {\n                                ...successfulOverridePayload,\n                                context: {\n                                  ...successfulOverridePayload.context,\n                                  deliveryPostalCode: null,\n                                },\n                              },\n                              shoppingSelectorStep: 'storeSelector',\n                            })\n                          })\n                          .catch(() => {\n                            payloadAndSelectorStep.reject()\n                          })\n                      } else if (newZip && currentStoreId) {\n                        // only newContext === 'delivery' & newZip overrides were provided\n\n                        // see if there are any stores that support delivery with the override zip (i.e. try again without user's old store) - otherwise, reject\n                        const fakeCurrentUser = {\n                          context: { intent: currentContext, deliveryPostalCode: currentZip },\n                        }\n                        determineOverridePayloadAndShoppingSelectorStep(\n                          { newContext, newStoreId, newZip },\n                          fakeCurrentUser\n                        )\n                          .then(({ overridePayload, shoppingSelectorStep }) => {\n                            // If this resolves cleanly, then we've proven our theory that the user's old store was preventing the overrides\n                            // The override generated from this call will provide us with the first available store that supports \"delivery\" for newZip\n                            // We should redirect the user to this store for this case (where the old user store was preventing the overrides) as well\n\n                            // Clear the user's store and send them to the store selector in the Unified Shopping Selector after the override\n                            if (!shoppingSelectorStep) {\n                              payloadAndSelectorStep.resolve({\n                                // Return whatever the override payload would've been but including the first available store that supports newZip\n                                overridePayload: {\n                                  ...successfulOverridePayload,\n                                  store_id: overridePayload.store_id,\n                                },\n                              })\n                            } else {\n                              payloadAndSelectorStep.reject()\n                            }\n                          })\n                          .catch(() => {\n                            payloadAndSelectorStep.reject()\n                          })\n                      } else {\n                        // There is no currentStoreId or currentZip that could've gotten in the way of the override - reject\n                        payloadAndSelectorStep.reject()\n                      }\n                    }\n                  } else {\n                    // if (newStoreId && !newContext && !newZip && currentContext === 'delivery')\n\n                    // see if the override store exists (i.e. try again with empty user) - otherwise reject\n                    determineOverridePayloadAndShoppingSelectorStep(\n                      { newContext, newStoreId, newZip },\n                      {}\n                    )\n                      .then(({ shoppingSelectorStep }) => {\n                        // If this resolves cleanly (unless no existing user zip exists), then we've proven our theory that the user's\n                        //  old delivery context or zip was preventing the override\n                        // Since the user is unlikely to want to change their zipcode, we should make the user change context\n                        if (!currentZip || (currentZip && !shoppingSelectorStep)) {\n                          payloadAndSelectorStep.resolve({\n                            // Return whatever the override payload would've been but with user context as `null` to clear it\n                            overridePayload: {\n                              ...successfulOverridePayload,\n                              context: { ...successfulOverridePayload.context, intent: null },\n                            },\n                            shoppingSelectorStep: 'shoppingContext',\n                          })\n                        } else {\n                          payloadAndSelectorStep.reject()\n                        }\n                      })\n                      .catch(() => {\n                        payloadAndSelectorStep.reject()\n                      })\n                  }\n                }\n              })\n              .catch(() => {\n                // Call to `/stores` failed for some reason, no overrides are possible\n                payloadAndSelectorStep.reject()\n              })\n          }\n        } else {\n          // No overrides needed\n          payloadAndSelectorStep.resolve({ overridePayload: {} })\n        }\n\n        return payloadAndSelectorStep.promise.then(({ overridePayload, shoppingSelectorStep }) => {\n          // Any existing user zip must be included in the payload's context since PATCHes to /user\n          //  will clear the existing deliveryPostalCode if not included with it\n          if (\n            currentZip &&\n            overridePayload.context &&\n            !overridePayload.context.deliveryPostalCode &&\n            overridePayload.context.deliveryPostalCode !== null\n          ) {\n            overridePayload.context.deliveryPostalCode = currentZip\n          }\n          return { overridePayload, shoppingSelectorStep }\n        })\n      }\n      // For Unit Test\n      service._determineOverridePayloadAndShoppingSelectorStep_ = determineOverridePayloadAndShoppingSelectorStep\n\n      // This can be called to get the required API call payload to set the user in those desired \"overrides\",\n      service.getUserOverridePayload = () => {\n        // If currentUser is undefined, it means we are creating a new trial user\n\n        const userOverridePayload = $q.defer()\n\n        const currentUser = auth.user\n\n        if (!currentUser && overrideData.newExternalStoreId) {\n          userOverridePayload.resolve({ ext_store_id: overrideData.newExternalStoreId })\n        } else {\n          determineOverridePayloadAndShoppingSelectorStep(overrideData, currentUser)\n            .then(({ overridePayload, shoppingSelectorStep }) => {\n              // If either confirm_context or enter_location is present, these take precendence over the\n              // modals set by shoppingSelectorStep below. Therefore, only set the openToStoreSelectorStep if both\n              // deeplinks are not present\n              if (!service.confirmContext && !service.enterLocation) {\n                service.openToStoreSelectorStep = shoppingSelectorStep\n              } else {\n                service.openToStoreSelectorStep = null\n              }\n\n              userOverridePayload.resolve(overridePayload)\n            })\n            .catch(() => {\n              // Overrides are not possible\n              console.error('None of the user overrides provided in URL could be performed.')\n              userOverridePayload.resolve({})\n            })\n        }\n\n        return userOverridePayload.promise\n      }\n\n      // Sometimes after a user override we need to open the store selector\n      //  because we couldn't place them in all of the provided overrides\n      service.openShoppingSelectorAfterOverride = () => {\n        shoppingSelectorService.open(service.openToStoreSelectorStep)\n        service.openToStoreSelectorStep = null\n      }\n\n      service.handleContextModalDeepLinks = () => {\n        if (\n          // Exit if none of the parameters are present\n          (!service.confirmContext && !service.enterLocation) ||\n          // Exit if trying to enter pickup with rx items\n          (overrideData.newContext === SHOPPING_MODES.PICKUP && hasRxItem(cartService?.cart?.items))\n        ) {\n          return\n        }\n\n        shoppingContextService.setSelectedFulfillmentType(overrideData.newContext)\n\n        if (overrideData.newContext === SHOPPING_MODES.CATERING) {\n          eComLightService.setMode(true)\n        }\n        if (service.confirmContext) {\n          shoppingSelectorService.open(SHOPPING_SELECTOR_STAGES.SHOPPING_CONTEXT)\n        } else if (service.enterLocation) {\n          shoppingSelectorService.open(SHOPPING_SELECTOR_STAGES.STORE_SELECTOR)\n        }\n        service.confirmContext = null\n        service.enterLocation = null\n      }\n\n      service.updateExistingUserWithOverrides = () => {\n        const deferred = $q.defer()\n        service.getUserOverridePayload().then(userOverridePayload => {\n          if (!_.isEmpty(userOverridePayload)) {\n            // If there are any user overrides to perform on the existing user\n\n            const cartComparePayload = _.omitBy(\n              {\n                store_id: userOverridePayload.store_id,\n                fulfillment_type:\n                  (userOverridePayload.context && userOverridePayload.context.intent) || null,\n              },\n              _.isNil\n            )\n\n            const updateUserWithOverrides = () =>\n              auth\n                .update(userOverridePayload)\n                .then($rootScope.reloadState)\n                // Available categories may change, so refresh them.\n                .then(() => catalogCategoriesService.fetchCategories(true))\n                .then(deferred.resolve)\n                .catch(error => {\n                  console.error('Error updating user with overrides provided in URL:', error)\n                  deferred.reject()\n                })\n\n            if (service.hideCartCompareBeforeOverride || _.isEmpty(cartComparePayload)) {\n              // Skip the cart compare and go ahead with the user update\n              updateUserWithOverrides()\n            } else {\n              // Call cart compare and if the user agrees, continue with the user update; otherwise don't update user with overrides\n              // LAWRENCE TODO: Check to see if this cart call is required\n              cartService\n                .fetch()\n                .then(() => compareCartService.compareCart(true, 'store', cartComparePayload))\n                .then(updateUserWithOverrides)\n            }\n          } else if (userOverridesService.openToStoreSelectorStep) {\n            // If no overrides need to be performed, check if we've indicated that the shopping selector should be opened\n            service.openShoppingSelectorAfterOverride()\n            deferred.resolve()\n          } else {\n            deferred.resolve()\n          }\n        })\n        return deferred.promise\n      }\n    }\n  )\n","import angular from 'angular'\nimport { loyalty } from '@instacart/enterprise-services'\n\nimport { USER_ACTIONS } from '../../constants/events'\n\nexport default angular\n  .module('userServicesModule', [])\n  .service('userService', function ($rootScope, config, localStorageService, ngPromise) {\n    const service = this\n\n    const PRIMARY_CARD_KEY = 'primary-card'\n\n    service.loyaltyCards = []\n    service.loyaltyPasses = []\n\n    $rootScope.$on('auth', (event, action) => {\n      if (action === USER_ACTIONS.USER_LOGGED_IN) {\n        service.fetchLoyaltyCards()\n        service.fetchLoyaltyPasses()\n      }\n    })\n\n    $rootScope.$on('registered', () => {\n      service.fetchLoyaltyCards()\n      service.fetchLoyaltyPasses()\n    })\n\n    /**\n     * Retrieves the user's loyalty card from localStorage if available.\n     * Otherwise, tries to fetch the card from the user object.\n     */\n    service.getLoyaltyCard = function () {\n      const card = localStorageService.deprecatedGet(PRIMARY_CARD_KEY)\n      if (card) {\n        return card\n      }\n\n      const primaryCard = service.getPrimaryLoyaltyCard()\n      return primaryCard?.card_number ? primaryCard : ''\n    }\n\n    const getCards = ngPromise.wrapper(loyalty.api.loyaltyCards.getAll)\n    service.fetchLoyaltyCards = () => {\n      service.loyaltyCardsPromise = getCards().then(loyaltyCards => {\n        service.loyaltyCards = loyaltyCards.loyalty_cards || []\n\n        const loyaltyPointsMultiplier = config.loyaltyPointsMultiplier || 1\n        service.loyaltyCards.forEach(loyaltyCard => {\n          loyaltyCard.points_balance *= loyaltyPointsMultiplier\n        })\n\n        // Fetch and store the loyalty card\n        const primaryCard = service.getPrimaryLoyaltyCard()\n        if (primaryCard) {\n          localStorageService.deprecatedSet(PRIMARY_CARD_KEY, primaryCard)\n        } else {\n          localStorageService.deprecatedRemove(PRIMARY_CARD_KEY)\n        }\n        return loyaltyCards\n      })\n\n      return service.loyaltyCardsPromise\n    }\n\n    service.getLoyaltyCards = () => service.loyaltyCardsPromise || service.fetchLoyaltyCards()\n\n    const updateCards = ngPromise.wrapper(loyalty.api.loyaltyCards.updateAll)\n    service.updateLoyaltyCards = cards => {\n      return updateCards(cards).then(service.fetchLoyaltyCards)\n    }\n\n    // Loyalty Passes are used for adding to mobile wallet\n    const getPasses = ngPromise.wrapper(loyalty.api.loyaltyPasses.getAll)\n    service.fetchLoyaltyPasses = () => {\n      service.loyaltyPassesPromise = getPasses().then(response => {\n        service.loyaltyPasses = response.items || []\n        return service.loyaltyPasses\n      })\n\n      return service.loyaltyPassesPromise\n    }\n\n    service.getLoyaltyPasses = () => service.loyaltyPassesPromise || service.fetchLoyaltyPasses()\n\n    const createPass = ngPromise.wrapper(loyalty.api.loyaltyPasses.create)\n    service.createLoyaltyPass = () => {\n      return createPass()\n    }\n\n    // Returns the primary loyaltyCard for the currently authenticated user.\n    service.getPrimaryLoyaltyCard = () => service.loyaltyCards.find(c => c.primary_card)\n\n    service.getNonPrimaryLoyaltyCard = () => service.loyaltyCards.filter(c => !c.primary_card)\n  })\n","/* eslint-disable max-lines */\n\nimport _ from 'lodash'\nimport angular from 'angular'\nimport { CONTENT_ELEMENT } from '@app/angular/constants/elementSelectors'\nimport { COUNTRIES, COUNTRY_DIAL_CODES } from '@app/angular/constants/address'\nimport urlParser from '@app/utils/urlParser'\nimport ConfigurableProductServiceModule from '../../components/productDetails/configurableProduct/configurableProduct.service'\nimport { DEVICE_TYPES } from './mobile'\n\nconst LOCAL_STORE_MAX_AGE_MS = 1000 * 60 * 10 // 10 minutes maximum age\n\nexport default angular\n  .module('utilServicesModule', [ConfigurableProductServiceModule.name])\n  // https://stackoverflow.com/questions/29892353/angular-ui-router-resolve-state-from-url/30926025#30926025\n  // Needed for getStateFromPath below.\n  .config($stateProvider => {\n    $stateProvider.decorator('parent', (internalStateObj, parentFn) => {\n      // This fn is called by StateBuilder each time a state is registered\n\n      // The first arg is the internal state. Capture it and add an accessor to public state object.\n      internalStateObj.self.$$state = function () {\n        return internalStateObj\n      }\n\n      // pass through to default .parent() function\n      return parentFn(internalStateObj)\n    })\n  })\n  .service(\n    'utilService',\n    function utilService(\n      $controller,\n      $document,\n      $injector,\n      $interval,\n      $location,\n      $ocLazyLoad,\n      $q,\n      $rootScope,\n      $state,\n      $stateParams,\n      $timeout,\n      $window,\n      config,\n      localStorageService,\n      mobileService,\n      promoCodeService\n    ) {\n      const service = this\n\n      // Methods for determining the environment\n      const { mode } = config.env\n      service.isProd = () => mode === 'prod' || mode === 'prd'\n      service.isUat = () => mode === 'uat'\n      service.isDev = () => mode === 'dev'\n\n      // Analytics helper functions\n      const wrapArray = val => {\n        return Array.isArray(val) ? val : val ? [val] : undefined\n      }\n\n      const normalizeName = str => {\n        if (typeof str === 'string') {\n          return str.toLowerCase()\n        }\n\n        return str\n      }\n\n      service.filterParams = (categoryNameFromId, { tags, category_ids, brand_names }) => {\n        let categories = wrapArray(category_ids)\n        if (categories) {\n          // Transform this into normalized category names\n          categories = categories.map(categoryNameFromId).map(normalizeName)\n        }\n\n        tags = wrapArray(tags)\n        if (tags) {\n          tags = tags.map(normalizeName)\n        }\n\n        brand_names = wrapArray(brand_names)\n        if (brand_names) {\n          brand_names = brand_names.map(normalizeName)\n        }\n\n        return {\n          tags,\n          categories,\n          brand_names,\n        }\n      }\n\n      // Scroll the page to a given position\n      service.scrollToPosition = function (position) {\n        if (mobileService.isMobile) {\n          // Scroll the `content` element if mobile\n          const content = $document[0].querySelector(CONTENT_ELEMENT)\n          if (content) {\n            content.scrollTop = position\n          }\n        } else {\n          // Otherwise, scroll the body\n          $document[0].body.scrollTop = position\n          $document[0].documentElement.scrollTop = position\n        }\n\n        $timeout(() => $rootScope.$broadcast('scrollPositionChanged'))\n      }\n\n      // Scroll the page back to the top\n\n      service.scrollToTop = function () {\n        service.scrollToPosition(0)\n      }\n\n      // Scroll a given element to the top\n\n      service.scrollElementToTop = function (targetElement) {\n        if (!targetElement) {\n          return\n        }\n\n        targetElement.scrollTop = 0\n      }\n\n      /**\n       * Loads files from the `frontend-config/<CLIENT>/static` folder, or\n       * app/static/images if it does not exist\n       * @param { string } path - the image path\n       */\n      service.loadAssetImage = function (path) {\n        try {\n          // eslint-disable-next-line import/no-dynamic-require\n          return require(`assets/${path}`)\n        } catch {\n          // Fall back to the app/static/images folder if image didn't exist\n          return service.loadStaticImage(path.replace(/^(images\\/)/, ''))\n        }\n      }\n\n      /**\n       * Loads images in the `app/static/images` folder\n       * @param { string } path - the image path\n       */\n      service.loadStaticImage = path => {\n        // eslint-disable-next-line import/no-dynamic-require\n        return require(`static/images/${path}`)\n      }\n\n      service.loadInternalExternalAssets = path => {\n        if (path.match(/^(\\/\\/|https?).*/)) {\n          return path\n        }\n\n        return service.loadAssetImage(path)\n      }\n\n      service.getLogoFromBannerSlug = bannerSlug => {\n        const banner =\n          config.multipleBanners &&\n          config.multipleBanners.banners &&\n          config.multipleBanners.banners.find(b => b.bannerSlug === bannerSlug)\n        const imageUrl = banner && banner.logoImageUrl\n        return imageUrl ? service.loadAssetImage(imageUrl) : null\n      }\n\n      // Scroll specified element into view\n      service.scrollIntoView = function (targetElement, containerSelector) {\n        if (!targetElement) {\n          return\n        }\n\n        let position = targetElement.offsetTop\n\n        // If on mobile where we scroll a `content` element and if the target\n        // element matches the content element, set the scroll to position to 0\n        if (mobileService.isMobile) {\n          const contentElement = document.querySelector(CONTENT_ELEMENT)\n\n          if (contentElement === targetElement) {\n            position = 0\n          }\n        }\n\n        if (containerSelector) {\n          // If a container selector is provided, scroll to that\n          const containerElement = document.querySelector(containerSelector)\n\n          if (containerElement) {\n            containerElement.scrollTop = position\n          }\n        } else {\n          // Otherwise scroll app to the top\n          service.scrollToPosition(position)\n        }\n      }\n\n      // This is needed here to prevent circular imports\n      service.isMobileApp = () => {\n        return mobileService.isMobileApp()\n      }\n\n      service.getPrependHashIfNeeded = function (value) {\n        // Prepend '#' when html5 mode isn't enabled (cordova)\n        if (value && value.startsWith('/') && !$location.$$html5) {\n          return `#${value}`\n        }\n        return value\n      }\n\n      // check that link is an internal url\n      service.isLinkInternal = function (url) {\n        if (!url) {\n          return true\n        }\n\n        const urlHost = urlParser(url).host\n        return (\n          !urlHost ||\n          urlHost === $window.location.host ||\n          (service.isMobileApp() &&\n            config.env.webUrl &&\n            urlHost === urlParser(config.env.webUrl).host)\n        )\n      }\n\n      service.isLinkCurrentPageByUrl = (windowContext, link) => {\n        if (windowContext.location.href === link) {\n          return true\n        }\n        if (\n          service.isLinkInternal(link) &&\n          urlParser(windowContext.location.href).pathname === link\n        ) {\n          return true\n        }\n        return false\n      }\n\n      // open link outside of the app\n      service.openExtLink = function (link) {\n        // handle special condition where URL is to a video sharing site\n        const videoModalService = $injector.get('videoModalService')\n        if (videoModalService && videoModalService.isVideoURL(link)) {\n          videoModalService.open(link)\n        } else {\n          window.open(link, '_blank')\n        }\n      }\n\n      function LoadScriptError(message = 'LoadScriptError', info = {}) {\n        Object.assign(this, { message }, info)\n        this.name = 'LoadScriptError'\n        this.stack = new Error().stack\n      }\n      LoadScriptError.prototype = new Error()\n\n      service.scriptLoaded = {}\n\n      service.loadScript = (path, opts = {}, timeout = 30000) => {\n        // Prevent loading duplicate script\n        if (service.scriptLoaded[path]) {\n          return Promise.resolve()\n        }\n\n        return new Promise((resolve, reject) => {\n          const script = document.createElement('script')\n\n          Object.assign(script, opts)\n\n          script.type = 'text/javascript'\n          script.src = path\n          script.async = true\n          script.onload = () => {\n            service.scriptLoaded[path] = true\n            resolve()\n          }\n          script.onreadystatechange = () => {\n            service.scriptLoaded[path] = true\n            resolve()\n          }\n          script.onerror = () =>\n            reject(new LoadScriptError('Script failed to load', { path, opts }))\n          $document[0].body.appendChild(script)\n\n          if (timeout) {\n            $timeout(() => reject(new LoadScriptError('Script timed out', { path, opts })), timeout)\n          }\n        })\n      }\n\n      const STRIP_OUT_LEADING_ZEROS_REGEXP = /(\\.0+)+$/\n      service.semVerDifference = (a, b) => {\n        let i\n        let diff\n        const segmentsA = a.replace(STRIP_OUT_LEADING_ZEROS_REGEXP, '').split('.')\n        const segmentsB = b.replace(STRIP_OUT_LEADING_ZEROS_REGEXP, '').split('.')\n        const l = Math.min(segmentsA.length, segmentsB.length)\n\n        // eslint-disable-next-line no-plusplus\n        for (i = 0; i < l; i++) {\n          diff = parseInt(segmentsA[i], 10) - parseInt(segmentsB[i], 10)\n          if (diff) {\n            return diff\n          }\n        }\n        return segmentsA.length - segmentsB.length\n      }\n\n      // FIXME: This is a terrible hack\n\n      service.repaint = function () {\n        $timeout(() => {\n          document.body.style.display = 'none'\n          // eslint-disable-next-line no-unused-expressions\n          document.body.offsetHeight // jshint ignore:line\n          document.body.style.display = 'block'\n        }, 100)\n      }\n\n      // Safe wrapper for console.log\n\n      service.log = function (...args) {\n        // eslint-disable-next-line no-console\n        if (console && console.log) {\n          // eslint-disable-next-line no-console\n          console.log(...args)\n        }\n      }\n\n      // Focus elements matched by the given selector\n\n      service.focusSelector = function (selector, element) {\n        const parent = element || document\n        const els = parent.querySelectorAll(selector)\n        $timeout(() => {\n          _.each(els, el => {\n            el.focus()\n          })\n        })\n      }\n\n      service.focusNodeWhenInDOM = function (selector, element, maxTries = 10) {\n        const parent = element || document\n        const waitFocus = $interval(\n          () => {\n            const els = parent.querySelectorAll(selector)\n            if (els.length) {\n              // focus on first element\n              els[0].focus()\n            }\n          },\n          100,\n          maxTries\n        ).then(function () {\n          // destory interval after max tries\n          $interval.cancel(waitFocus)\n        })\n      }\n\n      // Collapse the keyboard on mobile devices by blurring the in-focus element\n\n      service.blurAndHideKeyboard = function (isBlurOfIframe) {\n        if (isBlurOfIframe && mobileService.getMobileOs() === DEVICE_TYPES.IOS) {\n          // Cannot blur a text input in an iframe - have to create a new input and blur it to force\n          // a blur event to occur, which then hides the keyboard\n          const focusable = document.createElement('input')\n          focusable.setAttribute('type', 'text')\n          focusable.setAttribute('class', 'ios-focusable-input-fix')\n          document.body.appendChild(focusable)\n          focusable.onblur = () => document.body.removeChild(focusable)\n          focusable.onfocus = () => focusable.blur()\n          focusable.focus()\n        } else {\n          document.activeElement.blur()\n        }\n      }\n\n      // Escape image urls to prevent issues with spaces and other\n      // special characters (additionally using regex to replace parentheses if `escapeParentheses` is true)\n      // Typically, `escapeParentheses` would be required for background-image URLs\n      service.escapeImageUrl = function (path, escapeParentheses) {\n        let escaped = ''\n        if (escapeParentheses) {\n          escaped = encodeURI(path).replace(/(?=[()])/g, '\\\\')\n        } else {\n          escaped = encodeURI(path).replace(\"'\", \"\\\\'\")\n        }\n\n        return escaped\n      }\n\n      // Less finicky version of $state.is, which ignores\n      // parameters which are present in the current state\n      // but aren't provided in `params`\n\n      // Uses $state.current by default, or compareState if\n      // one is provided.\n\n      service.stateIs = function (stateName, params, compareStateName, compareParams) {\n        let match = true\n        if (!compareStateName) {\n          compareStateName = $state.current.name\n        }\n        if (!compareParams) {\n          compareParams = $stateParams\n        }\n        // eslint-disable-next-line eqeqeq\n        if (compareStateName != stateName) {\n          match = false\n        }\n        _.each(params, (param, key) => {\n          // eslint-disable-next-line eqeqeq\n          if (param && compareParams[key] != param) {\n            match = false\n          }\n        })\n        return match\n      }\n\n      // Make sure pagination and brand filters doesn't transfer between states\n      // FIXME: Find a more general way of doing this throughout the app\n\n      service.withoutPage = function (params) {\n        if (params) {\n          params = angular.copy(params)\n          params.page = null\n          params.brand_name = null\n        } else {\n          params = {\n            page: null,\n            brand_name: null,\n          }\n        }\n        return params\n      }\n\n      // FIXME\n\n      service.cleanShopParams = function (params) {\n        if (params) {\n          params = angular.copy(params)\n          params.page = null\n          params.brand_name = null\n          params.sort = null\n        } else {\n          params = {\n            page: null,\n            brand_name: null,\n            sort: null,\n          }\n        }\n        return params\n      }\n\n      // Go back to previous state or home if there is none\n\n      const previousStates = []\n      let lastState = null\n      let wentBack = false\n      $rootScope.$on('$stateChangeStart', () => {\n        const previousState = {\n          name: $state.current.name,\n          params: $state.params,\n        }\n        lastState = previousState\n        if (!wentBack) {\n          previousStates.push(previousState)\n        }\n        wentBack = false\n      })\n\n      service.goBack = function () {\n        const previousState = previousStates.pop()\n        if (previousState && previousState.name) {\n          wentBack = true\n          $state.go(previousState.name, previousState.params)\n        } else {\n          $state.go('main.home')\n        }\n      }\n\n      service.getLastState = () => lastState\n\n      // Fetch the provided image and return a base64 encoded representation\n\n      service.getBase64Image = function (src) {\n        const deferred = $q.defer()\n\n        const img = new Image()\n        img.crossOrigin = 'Anonymous'\n\n        img.onload = function () {\n          const canvas = document.createElement('CANVAS')\n          const ctx = canvas.getContext('2d')\n          canvas.height = this.height\n          canvas.width = this.width\n          ctx.drawImage(this, 0, 0)\n          const dataURL = canvas.toDataURL('image/png')\n          deferred.resolve(dataURL)\n        }\n\n        img.src = src\n\n        if (img.complete || img.complete === undefined) {\n          img.src = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=='\n          img.src = src\n        }\n\n        img.onerror = deferred.reject.bind(deferred)\n        return deferred.promise\n      }\n\n      // Returns an arbitrary array of the provided length.\n      service.getArrayOfSpecificLength = num => {\n        return new Array(num)\n      }\n\n      // deep search for javascript objects\n      // return an array of objects according to key, value, or key and value matching\n      // https://gist.github.com/YagoLopez/1c2fe87d255fc64d5f1bf6a920b67484\n      service.getObjects = (obj, key, val) => {\n        let objects = []\n        // eslint-disable-next-line no-restricted-syntax\n        for (const i in obj) {\n          // eslint-disable-next-line no-prototype-builtins, no-continue\n          if (!obj.hasOwnProperty(i)) continue\n          if (typeof obj[i] === 'object') {\n            objects = objects.concat(service.getObjects(obj[i], key, val))\n            // eslint-disable-next-line eqeqeq\n          } else if ((i == key && obj[i] == val) || (i == key && val == '')) {\n            //\n            objects.push(obj)\n            // eslint-disable-next-line eqeqeq\n          } else if (obj[i] == val && key == '') {\n            // only add if the object is not already in the array\n            // eslint-disable-next-line eqeqeq\n            if (objects.lastIndexOf(obj) == -1) {\n              objects.push(obj)\n            }\n          }\n        }\n        return objects\n      }\n\n      service.parseQueryParams = queryString => {\n        if (!queryString) {\n          return {}\n        }\n        const params = {}\n        const kvs =\n          queryString.indexOf('?') === 0 ? queryString.slice(1).split('&') : queryString.split('&')\n        // eslint-disable-next-line no-plusplus\n        for (let i = 0; i < kvs.length; i++) {\n          const pair = kvs[i].split('=')\n          params[decodeURIComponent(pair[0])] =\n            pair.length > 1 ? decodeURIComponent(pair[1] || '') : true\n        }\n        return params\n      }\n\n      service.openInternalUrl = url => {\n        const { pathname, search } = urlParser(url)\n        $location.url(pathname + search)\n        // $apply only if not already in $apply.\n        if (!$rootScope.$$phase) {\n          $rootScope.$apply()\n        }\n      }\n\n      service.getStateFromPath = path => {\n        // eslint-disable-next-line no-restricted-syntax\n        for (const state of $state.get()) {\n          if (state.$$state) {\n            const privatePortion = state.$$state()\n            const match = privatePortion.url.exec(path)\n            if (match && !state.abstract) {\n              return [state.name, match]\n            }\n          }\n        }\n      }\n\n      service.getStateFromUrl = url => {\n        const params = urlParser(url)\n        if (params.host && params.host === urlParser(config.env.webUrl).host && !params.search) {\n          return service.getStateFromPath(params.pathname)\n        }\n      }\n\n      service.generateUrlQuery = data => {\n        const parts = []\n        // eslint-disable-next-line no-restricted-syntax, guard-for-in\n        for (const d in data) {\n          parts.push(`${encodeURIComponent(d)}=${encodeURIComponent(data[d])}`)\n        }\n        return parts.join('&')\n      }\n\n      // Example usage:\n      // const addFooterPrefixedIdsToLinks = utilService.generateAddIdToSrefLinkWithPrefix('footer');\n      // links = links_.map(footerLinks, addFooterIdTagsToLinks);\n      service.generateAddIdToSrefLinkWithPrefix = (prefix = '') => link => {\n        if (link.sref) {\n          return {\n            ...link,\n            id: `${prefix ? `${prefix}-` : ''}${link.sref.replace(/\\./g, '-')}`,\n          }\n        }\n        return link\n      }\n\n      service.addDays = (startDate, numberOfDays) => {\n        // function to add days to a given date.\n        const returnDate = new Date(\n          startDate.getFullYear(),\n          startDate.getMonth(),\n          startDate.getDate() + numberOfDays,\n          startDate.getHours(),\n          startDate.getMinutes(),\n          startDate.getSeconds()\n        )\n        return returnDate\n      }\n\n      // Removes `paramsToRemove` from `toParams` and `$location.search()`, replaces current state in history\n      // And goes to `toState` without changing the location (so params not specified in `toState` are retained)\n      service.removeSearchParametersGoToState = (toState, toParams, paramsToRemove, goOptions) => {\n        $location.search(_.omit($location.search(), paramsToRemove))\n        $location.replace()\n        $state.go(toState, _.omit(toParams, paramsToRemove), goOptions)\n      }\n\n      service.openPromoCodeModal = (\n        onClose,\n        newVersion = false,\n        disableOfferModal,\n        onSuccess = () => {}\n      ) => {\n        promoCodeService.open({\n          isUserLoggedIn: false,\n          onClose: () => {\n            const params = $stateParams\n            params.enterPromoCode = null\n            $state.go($state.current.name, params, { notify: false })\n            if (typeof onClose === 'function') {\n              onClose()\n            }\n          },\n          onSuccess,\n          newVersion,\n          disableOfferModal,\n        })\n      }\n\n      service.isIE = () => !!window.MSInputMethodContext && !!document.documentMode\n\n      // For address validation, function takes in two objects of string values and checks for differences\n      // then outputs an object that contains values of the expected spelling\n      service.stringDiff = (inputStrings, expectedStrings) => {\n        const diff = _.mapValues(expectedStrings, (expectedString, key) => {\n          const stringA = expectedString\n            ? expectedString.toLocaleLowerCase().replace(/\\./g, '')\n            : null\n          const stringB = inputStrings[key]\n            ? inputStrings[key].toLocaleLowerCase().replace(/\\./g, '')\n            : null\n\n          return {\n            value: expectedString,\n            changed: stringA !== stringB,\n          }\n        })\n\n        return diff\n      }\n\n      // Checks if browser is compatible with `IntersectionObserver` API\n      service.hasIntersectionObserver = () =>\n        'IntersectionObserver' in window &&\n        'IntersectionObserverEntry' in window &&\n        'intersectionRatio' in window.IntersectionObserverEntry.prototype &&\n        'isIntersecting' in window.IntersectionObserverEntry.prototype\n\n      /* alphanum.js (C) Brian Huisman\n       * Based on the Alphanum Algorithm by David Koelle\n       * The Alphanum Algorithm is discussed at http://www.DaveKoelle.com\n       *\n       * Distributed under same license as original\n       *\n       * Released under the MIT License - https://opensource.org/licenses/MIT\n       *\n       * Permission is hereby granted, free of charge, to any person obtaining\n       * a copy of this software and associated documentation files (the \"Software\"),\n       * to deal in the Software without restriction, including without limitation\n       * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n       * and/or sell copies of the Software, and to permit persons to whom the\n       * Software is furnished to do so, subject to the following conditions:\n       *\n       * The above copyright notice and this permission notice shall be included\n       * in all copies or substantial portions of the Software.\n       *\n       * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n       * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n       * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\n       * IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n       * DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n       * OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n       * USE OR OTHER DEALINGS IN THE SOFTWARE.\n       */\n\n      /* ********************************************************************\n       * Alphanum sort() function version - case sensitive\n       * Taken from http://www.davekoelle.com/files/alphanum.js with some es6 changes\n       */\n      service.naturalSortFunc = (a, b) => {\n        const chunkify = t => {\n          const tz = []\n          let x = 0\n          let y = -1\n          let n = 0\n          let i\n          let j\n\n          // eslint-disable-next-line no-cond-assign, no-plusplus\n          while ((i = (j = t.charAt(x++)).charCodeAt(0))) {\n            // eslint-disable-next-line eqeqeq\n            const m = i == 46 || (i >= 48 && i <= 57)\n            if (m !== n) {\n              // eslint-disable-next-line no-plusplus\n              tz[++y] = ''\n              n = m\n            }\n            tz[y] += j\n          }\n          return tz\n        }\n\n        const aa = chunkify(a)\n        const bb = chunkify(b)\n\n        // eslint-disable-next-line no-plusplus\n        for (let x = 0; aa[x] && bb[x]; x++) {\n          if (aa[x] !== bb[x]) {\n            const c = Number(aa[x])\n            const d = Number(bb[x])\n            // eslint-disable-next-line eqeqeq\n            if (c == aa[x] && d == bb[x]) {\n              return c - d\n            }\n            return aa[x] > bb[x] ? 1 : -1\n          }\n        }\n        return aa.length - bb.length\n      }\n\n      /**\n       * Gets a value from LocalStore if the value isn't considered expired - usually: LOCAL_STORE_MAX_AGE_MS\n       * The contents stored should be of the format: \"{ value: <anything>, time: <int:getTime()>, maxAge: <[int]> }\"\n       *\n       * @param {string} storeKey - The store key to get the data from\n       *\n       * @returns {*|undefined}\n       */\n      service.getExpiringValueFromStore = storeKey => {\n        try {\n          const payload = localStorageService.deprecatedGet(storeKey)\n          if (\n            payload &&\n            (payload.maxAge === null || new Date().getTime() - payload.time <= payload.maxAge)\n          ) {\n            return payload.value\n          }\n        } catch (e) {\n          console.warn(e, { storeKey })\n        }\n      }\n\n      /**\n       * Sets a value to LocalStore, including an expiry time along with it - default: LOCAL_STORE_MAX_AGE_MS\n       * The contents stored should be of the format: \"{ value: <anything>, time: <int:getTime()>, maxAge: <[int]> }\"\n       * If the value is null, the key will be removed from the store\n       *\n       * @param {string}   storeKey - The store key to get the data from\n       * @param {*|null}   value    - The value to store, or null to delete\n       * @param {int|null} [maxAge] - The maximum age of the data in ms, or null for no expiry\n       *\n       * @returns {undefined}\n       */\n      service.setExpiringValueToStore = (storeKey, value, maxAge = LOCAL_STORE_MAX_AGE_MS) => {\n        try {\n          if (value !== null) {\n            localStorageService.deprecatedSet(\n              storeKey,\n              JSON.stringify({ value, maxAge, time: new Date().getTime() })\n            )\n          } else {\n            localStorageService.deprecatedRemove(storeKey)\n          }\n        } catch (e) {\n          console.warn(e)\n        }\n      }\n\n      /**\n       * Whether fee is zero or not\n       *\n       * @param {Object} fee      - A fee config object\n       * @return {Boolean}        - True if is zero\n       */\n      service.isZero = fee => {\n        const value = parseFloat(fee.value)\n        // eslint-disable-next-line no-restricted-globals\n        return !isNaN(value) && value === 0\n      }\n\n      /**\n       * Whether fee is above zero\n       *\n       * @param {Object} fee      - A fee config object\n       * @return {Boolean}        - True if is > 0\n       */\n      service.isNonZero = fee => {\n        const value = parseFloat(fee.value)\n        // eslint-disable-next-line no-restricted-globals\n        return !isNaN(value) && value > 0\n      }\n\n      /**\n       * Returns if the dotCom header is present on mobile\n       * @returns {boolean}\n       */\n      service.isMobileDotComHeaderPresent = () => {\n        const dotComConfig = config.dotComModule\n        const { isMobile, isMobileApp } = mobileService\n        const isMobileNative = isMobile && isMobileApp()\n        const isDotComEnabled = dotComConfig.enable && dotComConfig.enableHeaderFooterSync\n\n        return (\n          isDotComEnabled &&\n          ((isMobileNative && dotComConfig.headerSyncUrl.mobileApp) ||\n            (isMobile && dotComConfig.headerSyncUrl.mobileWeb) ||\n            (!isMobile && dotComConfig.headerSyncUrl.desktop))\n        )\n      }\n\n      /**\n       * This method traps the browser focus inside a given *element*.\n       * While the focus trap is active, the user won't be able to exit\n       * the targeted element using keyboard navigation.\n       *\n       * @param { HTMLElement } element\n       *\n       * @returns { Function } - *handleTabNavigation* function - required for a\n       * possible future removeEventListener call\n       */\n      service.trapFocusOn = (element, initialFocus) => {\n        if (element && element.addEventListener) {\n          if (initialFocus) {\n            // Optionally set focus on the first element in target\n            const initialFocusableElements = service.getFocusableElements(element)\n            const { 0: firstFocusElement } = initialFocusableElements\n            if (firstFocusElement && firstFocusElement.focus) {\n              firstFocusElement.focus()\n            }\n          }\n\n          const handleTabNavigation = event => {\n            // get focusableElements and remove any that have tabindex=-1 added dynamically\n            const focusableElements = service.getFocusableElements(element)\n            const focusableElementsArray = Array.from(focusableElements).filter(\n              el => el.tabIndex !== -1\n            )\n            const {\n              0: firstElement,\n              [focusableElementsArray.length - 1]: lastElement,\n            } = focusableElementsArray\n            const isTabPressed = event.which === 9 || [event.code, event.key].includes('Tab')\n\n            if (!isTabPressed) return\n\n            if (event.target === lastElement && !event.shiftKey) {\n              if (firstElement && firstElement.focus) firstElement.focus()\n              event.preventDefault()\n              event.stopPropagation()\n              return\n            }\n\n            if (event.target === firstElement && event.shiftKey) {\n              if (lastElement && lastElement.focus) lastElement.focus()\n              event.preventDefault()\n              event.stopPropagation()\n            }\n          }\n\n          element.addEventListener('keydown', handleTabNavigation)\n\n          // The only known way to make elements outside of the target element unfocusable with\n          // TalkBack is to add `aria-hidden=\"true\"` to them. The code below leaves the target\n          // element and its parents unaffected, but adds `aria-hidden=\"true\"` to all other elements\n          // on the page.\n          const previousAriaHiddenValues = []\n          const excludedElements = []\n          let parentElement = element\n          while (parentElement && parentElement !== document.body) {\n            excludedElements.push(parentElement)\n            parentElement = parentElement.parentElement\n          }\n\n          const elementQueue = []\n          let currentElement = document.body\n          while (currentElement) {\n            if (currentElement !== document.body && !excludedElements.includes(currentElement)) {\n              previousAriaHiddenValues.push([\n                currentElement,\n                currentElement.getAttribute('aria-hidden'),\n              ])\n              currentElement.setAttribute('aria-hidden', 'true')\n            } else {\n              ;[...currentElement.children]\n                .filter(child => child.tagName !== 'SCRIPT' && child !== element)\n                .forEach(element => elementQueue.push(element))\n            }\n            currentElement = elementQueue.shift()\n          }\n\n          return () => {\n            element.removeEventListener('keydown', handleTabNavigation)\n\n            previousAriaHiddenValues.forEach(([element, value]) => {\n              if (value) {\n                element.setAttribute('aria-hidden', value)\n              } else {\n                element.removeAttribute('aria-hidden')\n              }\n            })\n          }\n        }\n      }\n\n      /**\n       * Returns a list of focusable elements in a given DOM *element*\n       *\n       * @param { HTMLElement } element\n       * @returns { HTMLElement[] }\n       */\n      service.getFocusableElements = element =>\n        element.querySelectorAll(`\n        [href],\n        button:not([disabled]),\n        input:not([disabled]):not(readonly),\n        select:not([disabled]):not(readonly),\n        textarea:not([disabled]):not(readonly),\n        [tabindex]:not([tabindex=\"-1\"])\n      `)\n\n      /**\n       * This method is used to focus within a given *element*\n       * An *index* can be provided, or it will default to the last index within the *element* (i.e. in most cases, the previous element)\n       *\n       * @param { HTMLElement } element\n       * @param { number } index\n       */\n      service.focusWithin = (element, index) => {\n        const focusableElements = service.getFocusableElements(element)\n        const focusIndex = typeof index !== 'undefined' ? index : focusableElements?.length - 1\n        focusableElements[focusIndex].focus()\n      }\n\n      /*\n       * Returns if the current application $state is using a fixed layout\n       *\n       * @returns { Boolean }\n       */\n      service.isFixedLayout = () => Object.keys($state.$current.views).includes('fixed-content@')\n\n      /**\n       * Returns a phone number with the global code\n       *\n       * @param { string } phoneNumber\n       * @param { string} country\n       *\n       * @returns { string }\n       */\n      service.getInternationalPhoneNumber = (phoneNumber, country = COUNTRIES.USA) => {\n        if (!phoneNumber) return ''\n\n        return `${COUNTRY_DIAL_CODES[country]}${phoneNumber}`\n      }\n\n      /**\n       * Helper function to lazy load angular js controllers!\n       * Use it in routers to load controllers beforehand. Will only load them if not already loaded.\n       *\n       * @example\n       *  resolve: {\n       *    // Load dependencies\n       *    $lazyLoadControllers: function(utilService) {\n       *      return utilService.lazyLoadControllers({\n       *        MyController: () =>  // NOTE: Key matches expected controller name\n       *          import(  // NOTE: Import inside a function so it can be called only as needed\n       *            /* webpackChunkName: \"myController\", webpackPrefetch: true *<remove this>/ './myController'\n       *          ),\n       *        // etc\n       *      })\n       *    },\n       *  }\n       *\n       * @param {object} moduleFnsMap  - An object: Keys as controller names, values as functions\n       *                                 calling import statements which return module promises\n       * @returns {Promise<T>}         - Promise once controllers are loaded\n       */\n      service.lazyLoadControllers = moduleFnsMap => {\n        return Promise.all(\n          Object.entries(moduleFnsMap)\n            .map(([controllerName, moduleFn]) =>\n              !isController(controllerName) ? moduleFn() : null\n            )\n            .filter(promise => promise !== null)\n        )\n          .then(\n            modules => modules.length > 0 && $ocLazyLoad.load(modules.map(module => module.default))\n          )\n          .catch(err => {\n            throw new Error(`Ooops, something went wrong, ${err}`)\n          })\n      }\n\n      /** @private Helper function to check if a controller is already loaded in Angular JS */\n      function isController(controllerName) {\n        try {\n          if (typeof window[controllerName] === 'function') return true\n          return !!$controller(controllerName)\n        } catch (error) {\n          return !(error instanceof TypeError)\n        }\n      }\n    }\n  )\n  .run(($rootScope, $timeout, $uibModalStack) => {\n    /*\n     * This is a fix for modals overlapping each other - https://instacart.atlassian.net/browse/ECOM-337\n     */\n    $rootScope.$watch($uibModalStack.getTop, (newWin, oldWin) => {\n      // Only if there is a new window and an old window - we need to fix the backdrop z-index!\n      if (newWin && oldWin && newWin.value && newWin.value.modalDomEl) {\n        $timeout(() => {\n          const children = newWin.value.modalDomEl.children()\n          const topWindowZIndexStr = children.length && children[0].style.zIndex\n          const [modalBackdrop] = document.getElementsByClassName('modal-backdrop') || []\n\n          // eslint-disable-next-line no-restricted-globals\n          if (!isNaN(topWindowZIndexStr) && modalBackdrop) {\n            modalBackdrop.style.zIndex = parseInt(topWindowZIndexStr, 10) - 1\n          }\n        })\n      }\n    })\n  })\n","import angular from 'angular'\nimport { wordpress } from '@instacart/enterprise-services'\n\nexport default angular\n  .module('wordpressRestApiServicesModule', [])\n  .service(\n    'wordpressRestApiService',\n    function wordpressRestApiService($q, $rootScope, Restangular, auth, config, mobileService) {\n      const service = this\n\n      let loggedInStatus = null\n\n      service.getMobileMenuItem = menuSlug => {\n        return wordpress.fetchWpMenu(menuSlug)\n      }\n\n      service.getCategories = () => {\n        return Restangular.oneUrl(\n          'main.search',\n          `${config.dotComModule.url}/wp-json/wp/v2/categories`\n        ).get()\n      }\n\n      service.getTags = () => {\n        return Restangular.oneUrl(\n          'main.search',\n          `${config.dotComModule.url}/wp-json/wp/v2/tags`\n        ).get()\n      }\n\n      service.searchPages = searchTerm => {\n        return Restangular.oneUrl(\n          'main.search',\n          `${config.dotComModule.url}/wp-json/wp/v2/pages?search=${searchTerm}`\n        ).get()\n      }\n\n      // Wordpress mobile menus\n      service.mobileSideNavItems = []\n      service.mobileSideNavItemsPromiseArray = []\n\n      const arrayOfPromisesOfMenuApiCalls = () => {\n        let filteredWordpressMenuItems\n\n        // Reset the mobile nav items array if run again to prevent double nav\n        // This function should only run on page load or login status change\n        service.mobileSideNavItemsPromiseArray = []\n\n        // If in cordova mode, filter out wordpress menu items not to be shown for native, if in web mode, filter out items not to be shown for web.\n        if (mobileService.isMobileApp()) {\n          filteredWordpressMenuItems = config.dotComModule.mobileNav.wordpressMenuItems.filter(\n            item => item.showNative\n          )\n        } else {\n          filteredWordpressMenuItems = config.dotComModule.mobileNav.wordpressMenuItems.filter(\n            item => item.showWeb\n          )\n        }\n\n        // Create array wordpress menu\n\n        filteredWordpressMenuItems.forEach(item => {\n          // Only add non-secure menu items to the array if the user is in trial mode\n          if (auth.user.status === 'trial') {\n            if (!config.dotComModule.mobileNav.secureWordpressMenus.includes(item.api)) {\n              service.mobileSideNavItemsPromiseArray.push(service.getMobileMenuItem(item.api))\n            }\n          } else {\n            // Add all menu items to the array if the user is logged in\n            service.mobileSideNavItemsPromiseArray.push(service.getMobileMenuItem(item.api))\n          }\n        })\n\n        return $q.all(service.mobileSideNavItemsPromiseArray)\n      }\n\n      const showInstacartDeliveryLink = store => {\n        if (store.amenities && store.amenities !== null) {\n          if (store.amenities.includes(config.dotComModule.mobileNav.amenities)) {\n            // eslint-disable-next-line no-unused-expressions\n            service.mobileSideNavItems\n          } else {\n            service.mobileSideNavItems = service.mobileSideNavItems.filter(\n              item => item.name !== 'sidenav-mobile-amenities'\n            )\n          }\n        } else {\n          service.mobileSideNavItems = service.mobileSideNavItems.filter(\n            item => item.name !== 'sidenav-mobile-amenities'\n          )\n        }\n      }\n\n      service.getWordpressMenuItems = () => {\n        // Memoing this call as its very expensive, but re-run if logged in status changes\n        if (!service.memoGetWordpressMenuItems || auth.user.status !== loggedInStatus) {\n          loggedInStatus = auth.user.status\n          service.memoGetWordpressMenuItems = $q((resolve, reject) => {\n            arrayOfPromisesOfMenuApiCalls()\n              .then(menuItems => {\n                service.mobileSideNavItems = menuItems\n                showInstacartDeliveryLink(auth.user.store)\n              })\n              .then(() => {\n                if (service.mobileSideNavItems.length > 0) {\n                  resolve(service.mobileSideNavItems)\n                } else {\n                  $rootScope.$broadcast('sidenav:fallback')\n                  reject('Error, no Menus Provided')\n                }\n              })\n              .catch(() => {\n                reject('Error resolving Wordpress menus')\n              })\n          })\n        }\n        return service.memoGetWordpressMenuItems\n      }\n    }\n  )\n","import angular from 'angular'\nimport Cookies from 'js-cookie'\nimport searchSession from '@app/services/search/session'\n\nexport default angular\n  .module('searchServiceModule', [])\n  .service('searchService', function searchService(config, lang, mobileService) {\n    const TAB_PRODUCTS = { label: lang.values.searchTabs.products, state: 'main.search' }\n    const TAB_RECIPES = { label: lang.values.searchTabs.recipes, state: 'main.search.recipes' }\n    const TAB_CONTENT = { label: lang.values.searchTabs.content, state: 'main.search.types' }\n\n    this.getTypes = () => {\n      const tabs = [TAB_PRODUCTS]\n\n      if (this.isRecipesEnabled()) {\n        tabs.push(TAB_RECIPES)\n      }\n\n      if (this.isDotComEnabled()) {\n        tabs.push(TAB_CONTENT)\n      }\n\n      return tabs\n    }\n\n    this.startNewSearchSession = () => {\n      this.snrid = searchSession.startNewSession()\n      return this.snrid\n    }\n\n    // Used for sharing snrid from Dotcom user navigating to web platform via search widget.\n    this.createSnridFromDotcomCookie = () => {\n      this.snrid = Cookies.get('dotcomSearchId')\n      searchSession.startNewSession(this.snrid)\n      Cookies.remove('dotcomSearchId')\n    }\n\n    this.getSnrid = () => {\n      // When the user refreshes the search results page, the id would be lost\n      if (!this.snrid) {\n        if (Cookies.get('dotcomSearchId')) {\n          this.createSnridFromDotcomCookie()\n        } else {\n          this.startNewSearchSession()\n        }\n      }\n      return this.snrid\n    }\n\n    this.getTypeBy = (value, attr = 'label') => this.getTypes().find(type => type[attr] === value)\n\n    this.hasMultipleTypes = () => this.getTypes().length > 1\n\n    this.isDotComEnabled = () =>\n      (config.dotComModule.enableSearch && !mobileService.isMobileApp()) ||\n      (config.dotComModule.enableSearchNativeMobile && mobileService.isMobileApp())\n\n    this.isRecipesEnabled = () => config.enableRecipeSearch\n\n    this.isPrimaryResult = item => item?.search_result?.result_set === 0 || item?.placement\n  })\n","import angular from 'angular'\nimport * as storage from '@app/utils/storage'\nimport { legacyStorage } from '@instacart/enterprise-services'\n\nexport default angular\n  .module('LocalStorageModule', [])\n  .service('localStorageService', function localStorage() {\n    const storageService = storage.getInstance()\n    const legacyStorageService = legacyStorage()\n\n    // Preferred - Use storage service and are async APIs that return promises\n    this.getItem = storageService.getItem\n    this.setItem = storageService.setItem\n    this.removeItem = storageService.removeItem\n    this.clear = storageService.clear\n    this.keys = storageService.keys\n\n    // Avoid - Use legacyStorage service and are synchronous API\n    this.deprecatedGet = legacyStorageService.getItem\n    this.deprecatedSet = legacyStorageService.setItem\n    this.deprecatedRemove = legacyStorageService.removeItem\n    this.deprecatedClear = legacyStorageService.clear\n    this.deprecatedKeys = legacyStorageService.keys\n  })\n","import angular from 'angular'\nimport template from '../templates/cartListTransferModal/cartListTransferModal.html'\n\nexport default angular\n  .module('cartListTransferModalModule', [])\n  .service('cartListTransferModalService', function cartListTransferModalService($uibModal) {\n    this.open = ({ initialContext, updatedContext, itemCount }) =>\n      $uibModal.open({\n        template,\n        controller(lang, initialContext, updatedContext, itemCount) {\n          const $ctrl = this\n\n          $ctrl.lang = lang\n          $ctrl.itemCount = itemCount\n          $ctrl.initialContext = initialContext\n          $ctrl.updatedContext = updatedContext\n        },\n        resolve: {\n          initialContext: () => initialContext,\n          updatedContext: () => updatedContext,\n          itemCount: () => itemCount,\n        },\n        controllerAs: '$ctrl',\n      }).result\n  })\n","import angular from 'angular'\n\nexport default angular\n  .module('orderFeesModule', [])\n  .service('orderFeesService', function orderFeesService(cartService, config, lang, utilService) {\n    const service = this\n\n    service.feeConfigs = angular.copy(config.additionalFees)\n    service.feeConfigs.forEach(fee => {\n      fee.sourceKeys = fee.key\n      fee.key = fee.key.join(',')\n    })\n\n    /**\n     * Returns a list of formatted fees for the totals line items component\n     * @param {Array<Object | Function>} sources - An array of objects or function\n     * @param {string} shoppingIntent            - The shopping intent\n     * @return {[<Object>]}                      - An array of formatted fee objects\n     */\n    service.formattedFees = (sources, shoppingIntent) =>\n      service.feesWithValues(sources).reduce((formattedFees, fee) => {\n        if (!service.isSubfee(fee) && service.shouldShowFee(fee)) {\n          const feeValue = parseFloat(fee.value)\n          const originalFeeValue = parseFloat(fee.originalFeeValue)\n          const subFees = service\n            .getSubfees(fee)\n            .filter(subFee => service.shouldShowFee(subFee))\n            .map(subFee => ({\n              label: service.getLabel(subFee, shoppingIntent),\n              value: parseFloat(subFee.value),\n              description: lang.values[subFee.descriptionReference],\n            }))\n\n          return [\n            ...formattedFees,\n            {\n              type: 'value',\n              label: service.getLabel(fee, shoppingIntent),\n              value: feeValue,\n              tooltip: fee.tooltipReference && lang.values[fee.tooltipReference],\n              previousValue:\n                originalFeeValue > 0 && originalFeeValue > fee.value ? originalFeeValue : undefined,\n              showFreeIfZero: true,\n              subItems: subFees,\n            },\n          ]\n        }\n\n        return formattedFees\n      }, [])\n\n    /**\n     * Returns a list of showable fees\n     * @param {Array<Object | Function>} sources - An array of objects or function\n     * @return {[<Object>]}                      - An array of fee objects\n     */\n    service.feesWithValues = sources => {\n      const { feeConfigs } = service\n      const serverFees = reduceServerFees(sources)\n\n      feeConfigs.forEach(fee => {\n        fee.value = getValue(fee, serverFees)\n\n        const originalFeeKey = fee.meta?.originalFeeKey\n\n        // Add \"original fee\" (fee before free or discount) if it exists\n        if (originalFeeKey && serverFees[originalFeeKey]) {\n          fee.originalFeeValue = serverFees[originalFeeKey]\n        }\n      })\n\n      return feeConfigs.filter(fee => fee.key !== 'pickup_fee' || !config.disablePickFees)\n    }\n\n    /**\n     * Checks if the fee is a subfee for some other fee\n     *\n     * @param {Object} fee     - A fee config object\n     * @return {Boolean}    - True if part of another fee\n     */\n    service.isSubfee = fee => {\n      const { feeConfigs } = service\n\n      return !!feeConfigs.find(parentFee => parentFee.subfees?.includes(fee.key))\n    }\n\n    /**\n     * Gets the list of subfees as fee config objects\n     *\n     * @param {Object} fee     - A fee config object\n     * @return {[Object]}    - An array of fee objects\n     */\n    service.getSubfees = fee => {\n      if (!fee.subfees) return []\n      return service.feeConfigs.filter(subfee => fee.subfees.includes(subfee.key))\n    }\n\n    /**\n     * Generate a custom label if the labelFn was provided\n     *\n     * @param {Object} fee             - A fee config object\n     * @param {String} shoppingIntent  - The shopping intent\n     * @return {String}                - The custom label (or the default if none returned).\n     */\n    service.getLabel = (fee, shoppingIntent) => {\n      const { labelFn } = service\n      const { labelReference, labelReferenceOverrides } = fee\n\n      const isIcFulfilled = config.shoppingSelector[shoppingIntent]?.fulfilledByInstacart\n      const labelRefKey = `${isIcFulfilled ? 'ic:' : ''}${shoppingIntent}`\n      const labelRef = labelReferenceOverrides?.[labelRefKey] || labelReference\n\n      return (labelFn && labelFn(fee)) || lang.values[labelRef] || fee.key\n    }\n\n    /**\n     * Whether fee is free or not\n     *\n     * @param {Object} fee      - A fee config object\n     * @return {Boolean}        - True if free\n     */\n    service.isFree = fee => {\n      const { whenZero } = fee.free || {}\n      return whenZero && utilService.isZero(fee)\n    }\n\n    /**\n     * Determines whether the a fee is waived by the selected subscription\n     *\n     * @param {Object} fee      - A fee config object\n     * @return {Boolean}        - True if waived by subscription\n     */\n    service.doesSubscriptionWaiveFee = fee => {\n      return service.cartService?.selectedSubscription?.waiving_fee_types.includes(fee.key)\n    }\n\n    /**\n     * Whether or not the fee should be displayed\n     *\n     * @param {Object} fee      - A fee config object\n     * @return {Boolean}        - True if should display\n     */\n    service.shouldShowFee = fee => {\n      return (\n        fee.value !== null &&\n        (utilService.isNonZero(fee) || service.isFree(fee) || fee.originalFeeValue)\n      )\n    }\n  })\n\n/**\n * Takes in array of source objects, or functions returning objects, and spits out one single object with a summary of\n * different fees.\n *\n * @param {Array<Object | Function>} sources      - An array of objects or function\n *\n * @return {Object}                               - A single object with source keys mapped to values\n *\n * @example (sourceKeys = ['pick_fee', 'other_fee'])\n *  IN:  [ () => { pick_fee: 2 }, { etc: true }, { pick_fee: 1, other_fee: 3 }]\n *  OUT: { pick_fee: 2, other_fee: 3 }\n *\n * @future: The sources should be cached, if there's no change, return the previous result\n */\nfunction reduceServerFees(sources) {\n  if (!sources) return {}\n\n  // This works by doing the following:\n  //    0. If a source is a function, execute to get the source\n  //    1. Get the entry set (array) for each source object\n  //    2. Implicitly flatten the entry sets (up to 1 depth) to one array\n  //    3. Implicitly reverse the array\n  //    4. Reduce the array to an object, taking note of keys if defined\n  return sources\n    .map(source => (typeof source === 'function' ? source() : source))\n    .flatMap(source => Object.entries(source || {}))\n    .reduceRight((map, [key, val]) => Object.assign(map, { [key]: val }), {})\n}\n\n/**\n * The value of a fee\n *\n * @param {Object} fee        - A fee config object as returned by the array of fee configs\n * @param {Object} feeSource  - The source of reduced fees as returned by the server\n *\n * @return {Float | null}  - A fee value, or null if not found\n */\nfunction getValue(fee, feeSource) {\n  const mapKeyToVal = key => {\n    // If its a composed fee, calculate the value based on the subfees if they are present\n    fee.isComposed = fee.subfees?.length && fee.subfees.every(subfee => subfee in feeSource)\n\n    if (fee.isComposed)\n      return fee.subfees.reduce((total, subkey) => total + Number(feeSource[subkey]), 0)\n\n    return feeSource[key]\n  }\n\n  const value = fee.sourceKeys\n    .map(mapKeyToVal)\n    .filter(x => x !== undefined && x !== null)\n    .sort()\n    .pop()\n\n  return value !== undefined ? value : null\n}\n","import angular from 'angular'\nimport { eventEmitter, EVENT_TYPES } from '@app/utils/eventEmitter'\nimport { storeSupportsContext } from '@app/utils/storeSupportsContext'\nimport { multiShoppingContextsAvailableSelector } from '@app/services/shoppingContext/selectors'\nimport { getBannerConfig, hasBannerImage } from '@app/utils/banners'\nimport bannerSwitchingTabTemplate from '../../components/nav/views/bannerSwitchingTabTemplate.mobile.html'\n\nexport default angular\n  .module('contextSelectorButtonServiceModule', [])\n  .service(\n    'contextSelectorButtonService',\n    function (\n      $rootScope,\n      $state,\n      $uibModal,\n      analytics,\n      auth,\n      catalogCategoriesService,\n      config,\n      lang,\n      modalOptions,\n      reservationService,\n      shoppingSelectorService,\n      uibModalAriaLabelService\n    ) {\n      /**\n       * This handles the button clicks within the context selector. This is a short term measure to support the new\n       * react context-selector component.\n       *\n       * TODO: This should be refactored into the new selector modal enterprise service when that gets built. Context,\n       * type and config should all be handled within the new service.\n       *\n       * @param {string} type - Button type clicked on within context selector\n       *\n       * @returns {undefined}\n       */\n\n      eventEmitter.removeAllListeners(EVENT_TYPES.CONTEXT_SELECTOR_BUTTON_CLICK)\n\n      this.triageSelectorButtonClicks = type => {\n        switch (type) {\n          case 'icon':\n            openShoppingSummary(config.defaultSelectorService.desktopHomeIcon)\n            break\n          case 'context':\n            openShoppingSummary(config.defaultSelectorService.desktopHomeContext)\n            break\n          case 'store':\n            if (auth.user.context.intent === 'delivery') {\n              openShoppingSummary(config.defaultSelectorService.desktopHomeDelivery)\n            } else {\n              openShoppingSummary(config.defaultSelectorService.desktopHomeStore)\n            }\n            break\n          case 'reservation':\n            if (reservationService.displayReservation) {\n              openShoppingSummary(config.defaultSelectorService.desktopHomeReservation)\n            } else {\n              handleReserveTimeslotClick()\n            }\n        }\n      }\n\n      const openShoppingSummary = shoppingSelectorRoute => {\n        modalOptions.reset()\n        shoppingSelectorService.open(shoppingSelectorRoute)\n      }\n\n      const handleReserveTimeslotClick = () => {\n        modalOptions.reset()\n        modalOptions.setOptions({ showBackButton: false })\n        openTimeslotSelector()\n      }\n\n      const openTimeslotSelector = () => shoppingSelectorService.open('timeslot')\n\n      const getBannerNameTitle = store_banner => {\n        const { name } = config.multipleBanners.banners.find(\n          banner => banner.bannerExtId === store_banner.ext_id\n        )\n\n        return name\n      }\n\n      const openBannerSwitchingModal = () => {\n        $uibModal.open({\n          template: bannerSwitchingTabTemplate,\n          controller: function bannerSwitchingModalController(\n            $ngRedux,\n            $scope,\n            auth,\n            config,\n            lang,\n            shoppingSelectorService\n          ) {\n            $scope.auth = auth\n            $scope.config = config\n            $scope.lang = lang\n            $scope.userStore = auth.user.store\n            $scope.shoppingSelectorService = shoppingSelectorService\n            $scope.currentContext = auth.user.context.intent\n            $scope.storeSupportsContext = storeSupportsContext\n            $scope.hasBannerImage = hasBannerImage()\n            $scope.getBannerNameTitle = getBannerNameTitle\n            $scope.selectedLoading = false\n\n            const mapStateToService = state => ({\n              multiShoppingContextsAvailable: multiShoppingContextsAvailableSelector(state),\n            })\n            $ngRedux.connect(mapStateToService)($scope)\n\n            $scope.updateStore = store => {\n              auth.update({ store_id: store.id }).then(() =>\n                auth\n                  .setContext({\n                    storeNumber: store.id,\n                    retailer_slug: store.store_banner?.key,\n                    intent: auth.getContext().intent,\n                  })\n                  .then(() =>\n                    // Available categories may change, so refresh them.\n                    catalogCategoriesService\n                      .fetchCategories(true)\n                      .then(() =>\n                        $state.go('main.home').then($scope.$close).then($rootScope.reloadState)\n                      )\n                  )\n                  .then(() => auth.sendUserUpdatedStore(auth.user))\n              )\n            }\n\n            $scope.selectAssociatedStore = store => {\n              $scope.selectedLoading = true\n\n              const banner = getBannerConfig(store.store_banner?.key)\n              const isAlcoholBanner = Boolean(banner?.alcoholExclusive)\n\n              const eventName = isAlcoholBanner\n                ? 'store.click_alcohol_storefront'\n                : 'store.click_grocery_storefront'\n\n              analytics.logSegmentEvent(eventName, {})\n              $scope.updateStore(store)\n            }\n          },\n          resolve: {\n            ariaLabel: () => {\n              uibModalAriaLabelService.setLabel(lang.values.pleaseSelect)\n            },\n          },\n        })\n      }\n\n      this.openMobileContextSelector = () => {\n        config.multipleBanners.enableNonTabulatedView\n          ? openBannerSwitchingModal()\n          : shoppingSelectorService.open(config.defaultSelectorService.mobileNavTopBar)\n      }\n\n      // Enable the react header to open angular context selector modals\n      // TODO: Move modal logic into context selector button react component\n      // once the modals are available there.\n      eventEmitter.on(EVENT_TYPES.CONTEXT_SELECTOR_BUTTON_CLICK, this.triageSelectorButtonClicks)\n      eventEmitter.on(EVENT_TYPES.MOBILE_CONTEXT_SELECTOR, this.openMobileContextSelector)\n    }\n  )\n","import angular from 'angular'\nimport rxUpsellModal from '@app/angular/components/rxUpsell/rxUpsellModal.html'\nimport { HTTP_ERRORS } from '@app/angular/constants/httpErrors'\nimport { LOGIN_CONTEXTS } from '@app/angular/constants/loginContexts'\nimport { OneCartActions } from '@app/services/oneCart/types'\nimport { auth as authService } from '@instacart/enterprise-services'\n\nexport default angular\n  .module('rxUpSellServiceModule', [])\n  .service(\n    'rxUpSellService',\n    function rxUpSellService(\n      $rootScope,\n      $state,\n      $uibModal,\n      $window,\n      analytics,\n      auth,\n      catalogCategoriesService,\n      config,\n      confirmationModal,\n      lang,\n      oneCartService,\n      registrationService\n    ) {\n      const service = this\n      // determine if its from RX SSO flow\n      service.rxSSO = false\n\n      service.open = (removeRxItemsFromCart, cartServiceFetch, rxDeliverableContext) => {\n        analytics.logSegmentEvent('rx.upsell_modal_triggered', {\n          is_rx_sso: service.rxSSO,\n          upsell_modal_enabled: config.enableRxUpsellModal,\n        })\n        if (config.enableRxUpsellModal && service.rxSSO) {\n          // reset the flag\n          service.fromRxSSO(false)\n\n          return $uibModal.open({\n            template: rxUpsellModal,\n            controller: [\n              '$scope',\n              $scope => {\n                $scope.close = () => {\n                  analytics.logSegmentEvent('rx.upsell_groceries_continue', { success: true })\n                  // changes zip code to match with Rx item\n                  auth\n                    .setContext(rxDeliverableContext)\n                    .then(() =>\n                      auth.update({\n                        store_id: rxDeliverableContext.storeNumber,\n                        has_changed_store: true,\n                      })\n                    )\n                    .then(() => cartServiceFetch())\n                    .then(() => auth.sendUserUpdatedStore(auth.user))\n                    .then(() => catalogCategoriesService.fetchCategories(true))\n                  $scope.$close()\n                }\n                $scope.continue = () => {\n                  analytics.logSegmentEvent('rx.upsell_checkout_continue', { success: true })\n                  return authService.api.auth\n                    .getOneCartCheckoutRedirect()\n                    .then(resp => {\n                      oneCartService.redirectToPBI(resp.location, resp.auth_token, {\n                        action: OneCartActions.CHECKOUT,\n                      })\n                    })\n                    .catch(resp => {\n                      if (resp && resp.error === HTTP_ERRORS.PII_UNAUTHORIZED) {\n                        $scope.$close()\n                        // If PII has timed out\n                        registrationService.promptLogin(\n                          $state.current.name,\n                          $state.params,\n                          '',\n                          '',\n                          lang.values.loginToContinue,\n                          LOGIN_CONTEXTS.REDIRECT_ONECART_CHECKOUT\n                        )\n                      }\n                    })\n                }\n              },\n            ],\n            backdrop: 'static',\n            keyboard: true,\n          }).result\n        }\n\n        return Promise.resolve()\n      }\n\n      service.fromRxSSO = sso => (service.rxSSO = sso)\n    }\n  )\n","import angular from 'angular'\nimport fullfillmentNotAvailableModal from '@app/angular/components/fulfillmentNotAvailableModal/fulfillmentNotAvailableModal.html'\nimport { SHOPPING_SELECTOR_STAGES } from '@app/angular/constants/shoppingSelectorStages'\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\nimport { eventEmitter, EVENT_TYPES } from '@app/utils/eventEmitter'\n\nexport default angular\n  .module('fulfillmentNotAvailableModalModule', [])\n  .service(\n    'fulfillmentNotAvailableModalService',\n    function fulfillmentNotAvailableModalService($uibModal, legacyModalService) {\n      const service = this\n\n      service.open = () => {\n        legacyModalService.closeOpenModals()\n        return $uibModal.open({\n          template: fullfillmentNotAvailableModal,\n          controller: [\n            '$scope',\n            'auth',\n            'shoppingContextService',\n            'shoppingSelectorService',\n            ($scope, auth, shoppingContextService, shoppingSelectorService) => {\n              $scope.close = () => $scope.$close()\n              $scope.continue = () => {\n                $scope.$close()\n                auth\n                  .setIntent(SHOPPING_MODES.DELIVERY)\n                  .then(() =>\n                    shoppingContextService.setSelectedFulfillmentType(SHOPPING_MODES.DELIVERY)\n                  )\n                  .then(() => shoppingSelectorService.open(SHOPPING_SELECTOR_STAGES.STORE_SELECTOR))\n              }\n            },\n          ],\n          controllerAs: '$ctrl',\n        }).result\n      }\n\n      eventEmitter.on(EVENT_TYPES.OPEN_FULFILLMENT_NOT_AVAILABLE_MODAL, () => {\n        service.open()\n      })\n    }\n  )\n","import angular from 'angular'\n\nimport UndoRemove from '@app/angular/services/modules/undoRemove'\nimport Api from './modules/api'\nimport AddressList from './modules/addressList'\nimport AddressSearch from './modules/addressSearch.service'\nimport AddToCart from './modules/addToCart.service'\nimport AlcoholValidation from './modules/alcoholValidation.service'\nimport Analytics from './modules/analytics/analytics'\nimport AnalyticsHelper from './modules/analytics/analyticsHelper.service'\nimport AnonymousIdService from './modules/anonymousId.service'\nimport Auth from './modules/auth'\nimport BarcodeScanner from './modules/barcodeScanner'\nimport Canvas from './modules/canvas'\nimport Cart from './modules/cart'\nimport CartAnalytics from './modules/cartAnalytics.service'\nimport CartListTransfer from './modules/cartListTransfer.service'\nimport CheckoutAnalytics from './modules/analytics/checkoutAnalytics.service'\nimport CheckoutService from './modules/checkout.service'\nimport CodePush from './modules/codePush'\nimport Collections from './modules/collections.service'\nimport ConfirmationModal from './modules/confirmationModal'\nimport ConfigService from './modules/clientConfiguration.service'\nimport Debug from './modules/debug'\nimport EbtCard from './modules/ebtCard.js'\nimport EcomLight from './modules/eComLight.service.js'\nimport ErrorInterceptor from './modules/errorInterceptor'\nimport Express from './modules/express'\nimport FacetedFilterModal from './modules/facetedFilterModal'\nimport FacetedSearchService from './modules/facetedSearchService'\nimport FlyerPreview from './modules/flyerPreview.service'\nimport GiftCardModalService from './modules/giftCardModalService'\nimport HeaderFooterSync from './modules/headerFooterSync'\nimport ImageURL from './modules/imageURL.service'\nimport Instacart from './modules/instacart'\nimport IcExpressModalService from './modules/icExpressModalService'\nimport Lang from './modules/lang'\nimport LegacyModal from './modules/legacy/modal.service'\nimport List from './modules/list'\nimport ListPrintServices from './modules/listPrint.service'\nimport LoyaltyService from './modules/loyalty'\nimport ManualUpsell from './modules/manualUpsell'\nimport Master from './modules/master'\nimport MasterCart from './modules/masterCart'\nimport Mobile from './modules/mobile'\nimport MobileNativeHref from './modules/mobileNativeHref.service'\nimport MobileNav from './modules/mobileNav.service'\nimport ModalOptionsService from './modules/modalOptions.service'\nimport NativeMobileBrightnessService from './modules/nativeMobileBrightnessService'\nimport NavMenuCallbacks from './modules/navMenuCallbacks'\nimport NgPromise from './modules/ngPromise'\nimport Offers from './modules/offers'\nimport OfferAnalytics from './modules/analytics/offerAnalytics.service'\nimport OneCart from './modules/oneCart'\nimport OrderService from './modules/order.service'\nimport Placements from './modules/placements.service'\nimport PriceAlerts from './modules/priceAlerts'\nimport Products from './modules/products'\nimport Profile from './modules/profile.service'\nimport promoCodeService from './modules/promoCode.service'\nimport PromoCodeValidationService from './modules/promoCodeValidationService'\nimport QualitricsService from './modules/qualitricsService'\nimport RateApp from './modules/rateApp'\nimport ReactRouterHistory from './modules/reactRouterHistory'\nimport Recaptcha from './modules/recaptcha.service'\nimport Redirect from './modules/redirect.service'\nimport Reservation from './modules/reservation'\nimport Restangular from './modules/restangular'\nimport Routing from './modules/routing'\nimport RuntimeRoutes from './modules/runtimeRoutes'\nimport ShoppingContext from './modules/shoppingContext.service'\nimport ShoppingListCache from './modules/shoppingListCache'\nimport SideCartService from './modules/sideCart.service'\nimport Stores from './modules/stores'\nimport Subscriptions from './modules/subscriptions'\nimport SubscriptionCheckoutService from './modules/subscriptionCheckout.service'\nimport Tags from './modules/tags'\nimport TimeSlot from './modules/timeslot.service'\nimport ToggleEcomLight from './modules/toggleEComLight.service'\nimport UnataCommService from './modules/unataCommService'\nimport UnataCommInterceptorService from './modules/unataCommInterceptorService'\nimport UniversalLinks from './modules/universalLinks'\nimport Update from './modules/update'\nimport UrbanAirship from './modules/urbanairship'\nimport UserAnalytics from './modules/analytics/userAnalytics.service'\nimport UserOverrides from './modules/userOverrides.service'\nimport UserOverridesV2 from './modules/userOverridesV2.service'\nimport UserService from './modules/user.service'\nimport Util from './modules/util'\nimport WordpressRestApi from './modules/wordpressRestApi'\nimport Search from './modules/search.service'\nimport LocalStorage from './modules/localStorage'\nimport CartListTransferModal from './modules/cartListTransferModal'\nimport OrderFees from './modules/orderFees.service'\nimport ContextSelectorButtonService from './modules/contextSelectorButton'\nimport RxUpSellService from './modules/rxUpSellService'\nimport FulfillmentNotAvailableModal from './modules/fulfillmentNotAvailableModal'\n\nexport default angular.module('app.service', [\n  AddressSearch.name,\n  AddressList.name,\n  AddToCart.name,\n  AlcoholValidation.name,\n  Analytics.name,\n  AnalyticsHelper.name,\n  AnonymousIdService.name,\n  Api.name,\n  Auth.name,\n  BarcodeScanner.name,\n  Canvas.name,\n  Cart.name,\n  CartAnalytics.name,\n  CartListTransfer.name,\n  CartListTransferModal.name,\n  CheckoutAnalytics.name,\n  CheckoutService.name,\n  ContextSelectorButtonService.name,\n  CodePush.name,\n  Collections.name,\n  ConfirmationModal.name,\n  ConfigService.name,\n  Debug.name,\n  EbtCard.name,\n  EcomLight.name,\n  ErrorInterceptor.name,\n  Express.name,\n  FacetedFilterModal.name,\n  FacetedSearchService.name,\n  FlyerPreview.name,\n  FulfillmentNotAvailableModal.name,\n  GiftCardModalService.name,\n  HeaderFooterSync.name,\n  ImageURL.name,\n  Instacart.name,\n  IcExpressModalService.name,\n  Lang.name,\n  LegacyModal.name,\n  List.name,\n  ListPrintServices.name,\n  LoyaltyService.name,\n  ManualUpsell.name,\n  Master.name,\n  MasterCart.name,\n  Mobile.name,\n  MobileNativeHref.name,\n  MobileNav.name,\n  ModalOptionsService.name,\n  NativeMobileBrightnessService.name,\n  NavMenuCallbacks.name,\n  NgPromise.name,\n  Offers.name,\n  OfferAnalytics.name,\n  OneCart.name,\n  OrderService.name,\n  Placements.name,\n  PriceAlerts.name,\n  Products.name,\n  Profile.name,\n  promoCodeService.name,\n  PromoCodeValidationService.name,\n  QualitricsService.name,\n  RateApp.name,\n  ReactRouterHistory.name,\n  Recaptcha.name,\n  Redirect.name,\n  Reservation.name,\n  Restangular.name,\n  Routing.name,\n  RxUpSellService.name,\n  RuntimeRoutes.name,\n  ShoppingContext.name,\n  ShoppingListCache.name,\n  SideCartService.name,\n  Stores.name,\n  Subscriptions.name,\n  SubscriptionCheckoutService.name,\n  Tags.name,\n  TimeSlot.name,\n  ToggleEcomLight.name,\n  UnataCommService.name,\n  UnataCommInterceptorService.name,\n  UndoRemove.name,\n  UniversalLinks.name,\n  Update.name,\n  UrbanAirship.name,\n  UserAnalytics.name,\n  UserOverrides.name,\n  UserOverridesV2.name,\n  UserService.name,\n  Util.name,\n  WordpressRestApi.name,\n  Search.name,\n  LocalStorage.name,\n  OrderFees.name,\n])\n","import angular from 'angular'\nimport template from './authorizeNetIntegration.html'\n\nexport default angular\n  .module('authorizeNetPaymentServiceModule', [])\n  .config(paymentGatewayProvider => {\n    paymentGatewayProvider.registerGateway({\n      name: 'Authorize.net',\n      key: 'auth_capture',\n      template,\n      serviceName: 'authorizeNetPayment',\n      newCheckoutCssClass: 'provider-generic_styling',\n    })\n  })\n\n  .service('authorizeNetPayment', function authorizeNetPayment($q, defaultPayments) {\n    const service = this\n\n    service.status = {}\n\n    service.checkout = defaultPayments.checkout\n  })\n","import _ from 'lodash'\nimport { AUTHORIZE_NET } from '@app/angular/constants/paymentGateway'\nimport angular from 'angular'\n\nconst { FORM_ACTION_FN } = AUTHORIZE_NET\nconst AUTHORIZE_NEW_CALLBACK = 'authorizeNetCallback'\nconst ACTIONS = {\n  ADD_PAYMENT: 'addPayment',\n  EDIT_PAYMENT: 'editPayment',\n}\nconst EVENTS = {\n  RESIZE_WINDOW: 'resizeWindow',\n  CANCEL: 'cancel',\n  SUCCESSFUL_SAVE: 'successfulSave',\n}\n\nexport default angular\n  .module('AuthorizeNetIntegrationControllerModule', [])\n  .controller(\n    'AuthorizeNetIntegrationController',\n    function ($scope, $timeout, Restangular, authorizeNetPayment, config, utilService) {\n      const onShowCardForm = $scope.onShowCardForm || $scope.$parent.onShowCardForm\n      const checkoutNewCreditCard =\n        $scope.checkoutNewCreditCard || $scope.$parent.checkoutNewCreditCard\n      const setCreditCard = () => $scope.doSave && $scope.doSave()\n\n      const iframe = document.querySelector('#iframeAuthorizeNet')\n\n      const authCaptureEvent = function (options) {\n        const form = document.forms.formAuthorizeNet\n        form.action = FORM_ACTION_FN({\n          isProd: utilService.isProd(),\n          isEdit: options.action === ACTIONS.EDIT_PAYMENT,\n        })\n\n        if (form.elements.PaymentProfileId) {\n          form.elements.PaymentProfileId.value = options.paymentProfileId\n            ? options.paymentProfileId\n            : ''\n        }\n\n        form.submit()\n        iframe.scrollIntoView()\n        if (onShowCardForm) {\n          onShowCardForm()\n        }\n      }\n\n      $scope.isIframeVisible = false\n\n      if ($scope.toggleIsShowingAddCard) {\n        $scope.toggleIsShowingAddCard(false)\n      }\n\n      /**\n       * Loads the credit card list\n       *\n       * @param {boolean} select        - Causes a credit card to be selected as determined by this function\n       */\n      $scope.getPaymentInstruments = function (select = true) {\n        Restangular.one('user')\n          .one('payment')\n          .get({ payment_type: 'auth_capture' })\n          .then(response => {\n            const instruments = response.auth_capture.payment_instruments\n            const firstInstrument = instruments && instruments.length && instruments[0]\n            let newCard = null\n\n            if ($scope.paymentInstruments && instruments) {\n              const previousList = $scope.paymentInstruments.map(instrument => instrument.ext_id)\n              newCard = instruments.find(instrument => !previousList.includes(instrument.ext_id))\n            }\n\n            $scope.paymentInstruments = instruments\n            authorizeNetPayment.status.loaded = true\n\n            if ($scope.paymentInstruments.length) {\n              if (newCard) {\n                $scope.paymentInstrumentId = newCard.ext_id\n              } else if (!$scope.paymentInstrumentId) {\n                // If nothing chosen, select first one by default\n                $scope.paymentInstrumentId = firstInstrument && firstInstrument.ext_id\n              } else {\n                // Make sure previously choice still exists\n                const stillExists = !!_.find($scope.paymentInstruments, {\n                  ext_id: $scope.paymentInstrumentId,\n                })\n                if (!stillExists) {\n                  // Default for first one if not\n                  $scope.paymentInstrumentId = $scope.paymentInstruments[0].ext_id\n                }\n              }\n\n              if (select) {\n                $timeout(setCreditCard)\n              }\n            } else {\n              // Handle no payment methods existing\n              $scope.paymentInstrumentId = null\n            }\n          })\n      }\n\n      $scope.paymentInstrumentId = $scope.payment?.auth_capture?.ext_id\n      $scope.getPaymentInstruments() // Fetch initially\n\n      $scope.getAuthToken = function () {\n        Restangular.one('cart')\n          .one('payment')\n          .customPUT({ payment_type: 'auth_capture' })\n          .then(response => ($scope.auth_token = response.auth_capture.payer_token))\n\n        // Fetch a new auth token every 15 minutes\n        if ($scope.authTokenTimeout) {\n          $timeout.cancel($scope.authTokenTimeout)\n        }\n\n        $scope.authTokenTimeout = $timeout($scope.getAuthToken, 15 * 60 * 1000)\n      }\n\n      $scope.getAuthToken() // Fetch initially\n\n      $scope.authCaptureAddCard = function () {\n        $scope.isIframeVisible = true\n\n        if ($scope.toggleIsShowingAddCard) {\n          $scope.toggleIsShowingAddCard(true)\n        }\n\n        authCaptureEvent({\n          action: ACTIONS.ADD_PAYMENT,\n          paymentProfileId: 'new',\n        })\n      }\n\n      $scope.authCaptureEditCard = function (card) {\n        authCaptureEvent({\n          action: ACTIONS.EDIT_PAYMENT,\n          paymentProfileId: card.ext_id,\n        })\n      }\n\n      // Expose callback used by the authorize.net IFrameCommunicator\n      window.addEventListener(\n        'message',\n        msg => {\n          if (msg.data.type === AUTHORIZE_NEW_CALLBACK && msg.data.action) {\n            switch (msg.data.action) {\n              case EVENTS.RESIZE_WINDOW:\n                iframe.width = msg.data.width\n                iframe.height = msg.data.height\n                $scope.isIframeVisible = true\n\n                if ($scope.toggleIsShowingAddCard) {\n                  $scope.toggleIsShowingAddCard(true)\n                }\n\n                break\n\n              case EVENTS.CANCEL:\n                iframe.width = 0\n                iframe.height = 0\n                $scope.getPaymentInstruments(false)\n                utilService.blurAndHideKeyboard()\n                $scope.isIframeVisible = false\n\n                if ($scope.toggleIsShowingAddCard) {\n                  $scope.toggleIsShowingAddCard(false)\n                }\n\n                break\n\n              case EVENTS.SUCCESSFUL_SAVE:\n                iframe.width = 0\n                iframe.height = 0\n                $scope.getPaymentInstruments()\n                utilService.blurAndHideKeyboard()\n                $scope.isIframeVisible = false\n\n                if ($scope.toggleIsShowingAddCard) {\n                  $scope.toggleIsShowingAddCard(false)\n                }\n\n                if (checkoutNewCreditCard) {\n                  checkoutNewCreditCard(true)\n                }\n\n                break\n            }\n          }\n        },\n        false\n      )\n\n      // Allow user to proceed once a payment instrument has been selected\n      $scope.$watch('paymentInstrumentId', () => {\n        $scope.payment.auth_capture = {\n          payment_instrument: {\n            ext_id: $scope.paymentInstrumentId,\n          },\n        }\n        authorizeNetPayment.status.ready = !!$scope.paymentInstrumentId\n      })\n    }\n  )\n","import angular from 'angular'\nimport AuthorizeNetService from './authorizeNetPaymentService.js'\nimport AuthorizeNetController from './authorizeNetIntegrationController.js'\n\nexport default angular.module('app.optionalComponents.AuthorizeNet', [\n  AuthorizeNetService.name,\n  AuthorizeNetController.name,\n])\n","/**\n * A factory that returns a function that wraps the original function. It calls the original function once, but then\n * returns the same returned result (in a promise) every subsequent time, regardless of args or changes.\n *\n * If the original function returns a promise that fails, the original function will be called again on next call\n *\n * @param {function} fn                    - The original function (preferably returning a promise)\n * @returns {function}                     - Wrapped function with promise memoisation\n *\n * You can call wrapperFn.resetPromiseable() to forcefully remove the cached promise so that on next call the original\n * function will be called again.\n *\n * @example\n *   promiseable(\n *     async (arg1, arg2) => {\n *        return doSomeCodeStuff(arg1, arg2);\n *     }\n *   );\n */\nexport default fn => {\n  const wrapper = (...args) => {\n    if (fn._result) return fn._result\n\n    try {\n      fn._result = Promise.resolve(fn(...args)).catch(e => resetAndReject(e, fn))\n      return fn._result\n    } catch (e) {\n      return resetAndReject(e, fn)\n    }\n  }\n\n  wrapper.resetPromiseable = () => resetAndReject(null, fn)\n\n  return wrapper\n}\n\nfunction resetAndReject(e, fn) {\n  fn._result = null\n  return Promise.reject(e)\n}\n","import { BRAINTREE } from '@app/angular/constants/paymentGateway'\nimport angular from 'angular'\nimport promiseable from '@app/utils/promiseable'\n\nexport default angular\n  .module('BraintreeIntegrationControllerModule', [])\n  .controller(\n    'BraintreeIntegrationController',\n    function ($rootScope, $scope, $timeout, Restangular, braintreePayment, lang, utilService) {\n      const onShowCardForm = $scope.onShowCardForm || $scope.$parent.onShowCardForm\n\n      const getDependencies = promiseable(async () => {\n        const hasBrainTree = typeof window.braintree !== 'undefined'\n        if (!hasBrainTree) {\n          await utilService.loadScript(BRAINTREE.JS_FILE)\n        }\n      })\n\n      const setCreditCard = () => $scope.doSave && $scope.doSave()\n\n      $scope.lang = lang\n      $scope.hasCard = false\n      $scope.brainTreeIsReady = false\n      braintreePayment.status.ready = false\n\n      $scope.getAuthToken = function () {\n        return Restangular.one('cart')\n          .one('payment')\n          .customPUT({ payment_type: 'auth_capture' })\n          .then(response => {\n            $scope.auth_token = response.auth_capture.token\n            $scope.hasCard = response.auth_capture.has_cards\n\n            if ($scope.hasCard) {\n              $timeout(setCreditCard)\n            }\n          })\n      }\n\n      const paymentMethodReceived = nonce => {\n        $scope.$apply(() => {\n          $scope.payment.auth_capture = {\n            payment_instrument: {\n              ext_id: nonce,\n            },\n          }\n\n          // Remove Add Card button when nonce has been received\n          if (!$scope.hasCard) {\n            $timeout(setCreditCard)\n            $scope.hasCard = true\n          }\n\n          braintreePayment.verifiedPayment()\n        })\n      }\n\n      getDependencies()\n        .then($scope.getAuthToken)\n        .then(() => {\n          window.braintree.setup($scope.auth_token, 'dropin', {\n            container: 'iframeBraintree',\n\n            onPaymentMethodReceived(payment_nonce) {\n              paymentMethodReceived(payment_nonce.nonce)\n            },\n\n            paymentMethodNonceReceived(_, payment_nonce) {\n              paymentMethodReceived(payment_nonce)\n            },\n\n            onReady() {\n              $scope.brainTreeIsReady = true\n              braintreePayment.status.ready = !!$scope.hasCard\n\n              if (onShowCardForm) {\n                onShowCardForm()\n              }\n            },\n          })\n        })\n\n      $scope.$watchGroup(['hasCard', 'brainTreeIsReady'], ([hasCard, brainTreeIsReady]) => {\n        braintreePayment.status.ready = !!hasCard && brainTreeIsReady\n\n        if ($scope.toggleIsShowingAddCard) {\n          $scope.toggleIsShowingAddCard(!hasCard)\n        }\n      })\n    }\n  )\n","import angular from 'angular'\nimport template from './braintreeIntegration.html'\n\nexport default angular\n  .module('BraintreePaymentServiceModule', [])\n  .config(paymentGatewayProvider => {\n    paymentGatewayProvider.registerGateway({\n      name: 'Braintree',\n      key: 'auth_capture',\n      template,\n      serviceName: 'braintreePayment',\n      newCheckoutCssClass: 'provider-braintree_styling',\n    })\n  })\n\n  .service(\n    'braintreePayment',\n    function braintreePayment($q, $rootScope, $timeout, defaultPayments) {\n      const service = this\n\n      service.status = { loaded: true }\n\n      service.checkout = defaultPayments.checkout\n      service.onAfterCheckoutError = () => {\n        $rootScope.reloadState()\n      }\n\n      // Called by BraintreeIntegrationController to indicate that payment has been verified\n      service.verifiedPayment = () => {}\n\n      service.verifyPayment = () => {\n        return new Promise((resolve, reject) => {\n          // $timeout ensures that Angular gets to handle the events so that Angular doesn't cry a river of errors\n          $timeout(() => {\n            const formBrainTree = document.getElementById('formBrainTree')\n            if (formBrainTree) {\n              service.verifiedPayment = resolve\n\n              // To verify without a button:\n              // https://developers.braintreepayments.com/reference/client-reference/javascript/v2/best-practices#bypass-submit-handlers\n              const e = document.createEvent('Event')\n              e.initEvent('submit', true, true)\n              formBrainTree.dispatchEvent(e)\n            } else {\n              // eslint-disable-next-line prefer-promise-reject-errors\n              reject('#formBrainTree is missing!')\n            }\n          })\n        })\n      }\n    }\n  )\n","import angular from 'angular'\nimport BrainTreeController from './braintreeIntegrationController.js'\nimport BrainTreeService from './braintreePaymentService.js'\n\nexport default angular.module('app.optionalComponents.Braintree', [\n  BrainTreeController.name,\n  BrainTreeService.name,\n])\n","import angular from 'angular'\n\nexport const configurablePayeezy = config => {\n  function identify(e) {\n    var t = {\n      visa: /^4[0-9]*$/,\n      mastercard: /^(?:5[1-5]|2[2-7])[0-9]*$/,\n      'American Express': /^3[47][0-9]*$/,\n      diners: /^3(?:0[0-5]|[68][0-9])[0-9]*$/,\n      discover: /^6(?:011|5[0-9]{2})[0-9]*$/,\n      jcb: /^(?:2131|1800|35\\d{3})\\d*$/,\n    }\n    for (var n in t) {\n      if (t[n].test(e)) {\n        return n\n      }\n    }\n  }\n\n  function t() {\n    var e = []\n    var t = document.getElementsByTagName('input')\n    var n = document.getElementsByTagName('select')\n    for (var i = 0; i < t.length; i++) {\n      var r = t[i]\n      var s = r.getAttribute('payeezy-data')\n      if (s) {\n        e[s] = r.value\n      }\n    }\n    for (var i = 0; i < n.length; i++) {\n      var r = n[i]\n      var s = r.getAttribute('payeezy-data')\n      if (s) {\n        e[s] = r.value\n      }\n    }\n    return e\n  }\n  return {\n    identify: identify,\n    createToken: function (e) {\n      this['clientCallback'] = e\n      var r = t()\n      var i = 0\n      var s = {}\n      var o = 0\n      var u = []\n      if (!this.apikey) {\n        i = 400\n        u[o] = {\n          description: 'Please set the API Key',\n        }\n        o++\n      }\n      if (!this.js_security_key) {\n        i = 400\n        u[o] = {\n          description: 'Please set the js_security_key',\n        }\n      }\n      if (!this.ta_token) {\n        i = 400\n        u[o] = {\n          description: 'Please set the ta_token',\n        }\n      }\n      if (!this.auth) {\n        i = 400\n        u[o] = {\n          description: 'Please set auth value',\n        }\n      }\n      if (u.length > 0) {\n        s['error'] = {\n          messages: u,\n        }\n        e(i, s)\n        return false\n      }\n      if (config.env.mode == 'prod') {\n        var a =\n          'https://' +\n          config.firstData.url +\n          '/v1/securitytokens?apikey=' +\n          this.apikey +\n          '&js_security_key=' +\n          this.js_security_key +\n          '&callback=Payeezy.callback&auth=' +\n          this.auth +\n          '&ta_token=' +\n          this.ta_token +\n          '&type=FDToken&credit_card.type=' +\n          this.clean(r['card_type']) +\n          '&credit_card.cardholder_name=' +\n          r['cardholder_name'] +\n          '&credit_card.card_number=' +\n          r['cc_number'] +\n          '&credit_card.exp_date=' +\n          this.clean(r['exp_month']) +\n          this.clean(r['exp_year']) +\n          '&credit_card.cvv=' +\n          r['cvv_code'] +\n          '&billing_address.zip_postal_code=' +\n          r['zip_postal_code']\n      } else {\n        var a =\n          'https://' +\n          config.firstData.url +\n          '/v1/securitytokens?apikey=' +\n          this.apikey +\n          '&js_security_key=' +\n          this.js_security_key +\n          '&callback=Payeezy.callback&auth=' +\n          this.auth +\n          '&ta_token=' +\n          this.ta_token +\n          '&type=FDToken&credit_card.type=' +\n          this.clean(r['card_type']) +\n          '&credit_card.cardholder_name=' +\n          r['cardholder_name'] +\n          '&credit_card.card_number=' +\n          r['cc_number'] +\n          '&credit_card.exp_date=' +\n          this.clean(r['exp_month']) +\n          this.clean(r['exp_year']) +\n          '&credit_card.cvv=' +\n          r['cvv_code'] +\n          '&billing_address.zip_postal_code=' +\n          r['zip_postal_code']\n      }\n      var f = document.createElement('script')\n      f.src = a\n      document.getElementsByTagName('head')[0].appendChild(f)\n    },\n    setApiKey: function (e) {\n      this['apikey'] = e\n    },\n    setJs_Security_Key: function (e) {\n      this['js_security_key'] = e\n    },\n    setTa_token: function (e) {\n      this['ta_token'] = e\n    },\n    setAuth: function (e) {\n      this['auth'] = e\n    },\n    callback: function (e) {\n      this['clientCallback'](e.status, e.results)\n    },\n    clean: function (e) {\n      let cleaned = e.split(':')\n      if (cleaned[1]) {\n        return cleaned[1]\n      } else {\n        return e\n      }\n    },\n  }\n}\n","import _ from 'lodash'\nimport angular from 'angular'\nimport dayjs from 'dayjs'\nimport { PAYMENT_POLYTYPES } from '@app/angular/constants/payments'\nimport { configurablePayeezy } from './payeezy.js'\n\nexport default angular\n  .module('FirstDataIntegrationControllerModule', [])\n  .controller(\n    'FirstDataIntegrationController',\n    function (\n      $filter,\n      $rootScope,\n      $scope,\n      $timeout,\n      Restangular,\n      config,\n      errorModalService,\n      firstDataPayment,\n      lang\n    ) {\n      const checkoutNewCreditCard =\n        $scope.checkoutNewCreditCard || $scope.$parent.checkoutNewCreditCard\n      const setCreditCard = () => $scope.doSave && $scope.doSave()\n\n      const Payeezy = configurablePayeezy(config)\n      window.Payeezy = Payeezy\n\n      $scope.expiryMonth = [\n        { name: 'January', value: '01' },\n        { name: 'February', value: '02' },\n        { name: 'March', value: '03' },\n        { name: 'April', value: '04' },\n        { name: 'May', value: '05' },\n        { name: 'June', value: '06' },\n        { name: 'July', value: '07' },\n        { name: 'August', value: '08' },\n        { name: 'September', value: '09' },\n        { name: 'October', value: '10' },\n        { name: 'November', value: '11' },\n        { name: 'December', value: '12' },\n      ]\n\n      $scope.expiryYear = []\n\n      // eslint-disable-next-line no-plusplus\n      for (let i = 0; i <= 15; i++) {\n        $scope.expiryYear.push({\n          name: dayjs().add(i, 'years').format('YYYY'),\n          value: dayjs().add(i, 'years').format('YY'),\n        })\n      }\n\n      $scope.creditCards = [\n        { id: 'mastercard', name: 'Master Card', logo: 'mastercard.svg' },\n        { id: 'visa', name: 'Visa', logo: 'visa.svg' },\n        { id: 'American Express', name: 'American Express', logo: 'american_express.svg' },\n        { id: 'discover', name: 'Discover', logo: 'discover.svg' },\n      ]\n\n      function resetForm() {\n        $scope.showFirstDataForm = false\n        $scope.hideAddCardButton = false\n\n        if ($scope.toggleIsShowingAddCard) {\n          $scope.toggleIsShowingAddCard(false)\n        }\n\n        $scope.error = ''\n      }\n\n      function clearCardData() {\n        $scope.cardType = null\n        $scope.ccNumber = ''\n        $scope.cardDescription = ''\n        $scope.zipPostalCode = ''\n      }\n\n      clearCardData() // initalize card data\n\n      $scope.showAddCardForm = () => {\n        $scope.showFirstDataForm = true\n        $scope.hideAddCardButton = true\n\n        if ($scope.toggleIsShowingAddCard) {\n          $scope.toggleIsShowingAddCard(true)\n        }\n      }\n\n      $scope.getPaymentInstruments = function (initCall) {\n        return Restangular.one('user')\n          .one('payment')\n          .get({ payment_type: 'auth_capture' })\n          .then(response => {\n            const instruments = response.auth_capture.payment_instruments\n            const firstInstrument = instruments && instruments.length && instruments[0]\n\n            $scope.paymentInstruments = $filter('orderBy')(\n              response.auth_capture.payment_instruments,\n              'id',\n              true\n            )\n\n            firstDataPayment.status.loaded = true\n\n            if ($scope.paymentInstruments.length) {\n              if (!$scope.selectedCard) {\n                // If nothing chosen, select first one by default\n                $scope.selectedCard = firstInstrument\n              } else {\n                // Make sure previously choice still exists\n                const existing = _.find($scope.paymentInstruments, {\n                  id: $scope.selectedCard.ext_id,\n                })\n                if (!existing) {\n                  // Default for first one if not\n                  $scope.selectedCard = $scope.paymentInstruments[0]\n                } else {\n                  $scope.selectedCard = existing\n                }\n              }\n\n              if (initCall) {\n                $timeout(() => setCreditCard())\n              }\n            } else {\n              // Handle no payment methods existing\n              $scope.selectedCard = null\n              $scope.showFirstDataForm = true\n              $scope.hideAddCardButton = true\n\n              if ($scope.toggleIsShowingAddCard) {\n                $scope.toggleIsShowingAddCard(true)\n              }\n            }\n          })\n      }\n\n      $scope.selectedCard = $scope.payment?.auth_capture\n      $scope.getPaymentInstruments(true) // Fetch initially\n\n      $scope.addCard = function () {\n        const responseHandler = function (status, response) {\n          // eslint-disable-next-line eqeqeq\n          if (status != 201) {\n            $scope.$apply(() => {\n              const { messages } = (response && response.Error) || {}\n              $scope.error =\n                (messages && messages[0] && messages[0].description) ||\n                lang.values.defaultErrorMessage\n            })\n\n            if (checkoutNewCreditCard) {\n              checkoutNewCreditCard(false)\n            }\n          } else {\n            const tokenValue = response.token.value\n            const cardholderName = response.token.cardholder_name\n            const expiryMonth = response.token.exp_date.slice(0, 2)\n            const expiryYear = response.token.exp_date.slice(-2)\n            const provider = response.token.type\n            const last_four_digits = tokenValue.slice(-4)\n\n            // Object to be sent to backend\n            $scope.customerToken = {\n              expiry_date: `20${expiryYear}-${expiryMonth}-01`,\n              provider,\n              last_four_digits,\n              holder_name: cardholderName,\n              postal_code: $scope.zipPostalCode,\n              ext_id: tokenValue,\n              polytype: PAYMENT_POLYTYPES.CREDIT_CARD,\n              name: $scope.cardDescription,\n            }\n\n            Restangular.one('user', 'payment')\n              .customPOST($scope.customerToken)\n              .then(resetForm)\n              .then(clearCardData)\n              .then(() => $scope.getPaymentInstruments(false))\n              .then(() => {\n                $scope.selectedCard = $scope.paymentInstruments[0] // Select most recent card added to wallet\n\n                if (checkoutNewCreditCard) {\n                  checkoutNewCreditCard(true)\n                }\n\n                $timeout(setCreditCard)\n              })\n              .catch(err => {\n                $scope.error = err?.data?.message || err?.message\n\n                if (checkoutNewCreditCard) {\n                  checkoutNewCreditCard(false)\n                }\n              })\n          }\n        }\n\n        // Get Auth token\n        const auth = document.getElementById('auth')\n\n        Payeezy.setApiKey(config.firstData.apiKey)\n        Payeezy.setJs_Security_Key(config.firstData.jsSecurityKey)\n        Payeezy.setTa_token(config.firstData.taToken)\n        Payeezy.setAuth(auth.value)\n        Payeezy.createToken(responseHandler)\n      }\n\n      $scope.cancelAddCard = function () {\n        $scope.showFirstDataForm = false\n        $scope.hideAddCardButton = false\n        $scope.error = false\n\n        if ($scope.toggleIsShowingAddCard) {\n          $scope.toggleIsShowingAddCard(false)\n        }\n\n        clearCardData()\n      }\n\n      // Delete Credit Card\n      $scope.deleteCard = function (card) {\n        const errorServiceModalPromise = errorModalService.open(\n          `${lang.template(lang.values.deleteCardMessage, {\n            cardName: card.name,\n            cardNumber: card.last_four_digits,\n          })}`,\n          lang.values.confirm,\n          lang.values.cancel,\n          lang.values.deleteCard\n        )\n\n        errorServiceModalPromise\n          .then(() => Restangular.one('user/payment', card.id).remove())\n          .then(() => $scope.getPaymentInstruments(false))\n      }\n\n      // Allow user to proceed once a payment instrument has been selected\n      $scope.$watch('selectedCard', () => {\n        if ($scope.selectedCard) {\n          $scope.payment.auth_capture = {\n            payment_instrument: $scope.selectedCard,\n          }\n        }\n        firstDataPayment.status.ready = !!$scope.selectedCard\n      })\n\n      $scope.$watch('ccNumber', () => ($scope.cardType = Payeezy.identify($scope.ccNumber)))\n\n      $scope.$watchGroup(['cardType', 'ccNumber'], () => {\n        const identifiedType = Payeezy.identify($scope.ccNumber)\n        $scope.valid =\n          !!$scope.cardType &&\n          !!$scope.ccNumber &&\n          (identifiedType || identifiedType === $scope.cardType)\n      })\n    }\n  )\n","import angular from 'angular'\n\nexport default angular\n  .module('FirstDataPaymentServiceModule', [])\n\n  .config(paymentGatewayProvider => {\n    paymentGatewayProvider.registerGateway({\n      name: 'FirstData',\n      key: 'auth_capture',\n      template: require('./firstDataIntegration.html'),\n      serviceName: 'firstDataPayment',\n      newCheckoutCssClass: 'provider-generic_styling',\n    })\n  })\n\n  .service('firstDataPayment', function firstDataPayment($q, config, defaultPayments) {\n    const service = this\n\n    service.status = {}\n\n    service.checkout = defaultPayments.checkout\n  })\n","import angular from 'angular'\nimport FirstDataController from './firstDataIntegrationController.js'\nimport FirstDataService from './firstDataPaymentService.js'\n\nexport default angular.module('app.optionalComponents.FirstData', [\n  FirstDataController.name,\n  FirstDataService.name,\n])\n","export const FIRST_DATA_CSS_CLASSES = {\n  EMPTY: 'firstdata-injected-empty',\n  FOCUS: 'firstdata-injected-focus',\n  INVALID: 'firstdata-injected-invalid',\n  VALID: 'firstdata-injected-valid',\n}\n\nexport const FIRST_DATA_SELECTORS = {\n  CARD: '[data-cc-card]',\n  CVV: '[data-cc-cvv]',\n  EXP: '[data-cc-exp]',\n  NAME: '[data-cc-name]',\n}\n\nexport const FIRST_DATA_ERROR_TYPES = {\n  VALIDATION: 'VALIDATION',\n  SUBMISSION: 'SUBMISSION',\n  AUTHENTICATION: 'AUTHENTICATION',\n}\n\nexport const CARD_INPUT_ID = 'cc-card'\nexport const DESCRIPTION_INPUT_ID = 'cc-description'\nexport const ZIP_INPUT_ID = 'cc-zip'\n","import { FIRSTDATA_V2 } from '@app/angular/constants/paymentGateway'\nimport angular from 'angular'\nimport promiseable from '@app/utils/promiseable'\nimport {\n  FIRST_DATA_CSS_CLASSES,\n  FIRST_DATA_SELECTORS,\n  FIRST_DATA_ERROR_TYPES,\n  CARD_INPUT_ID,\n  DESCRIPTION_INPUT_ID,\n  ZIP_INPUT_ID,\n} from '@app/angular/constants/firstDatav2'\nimport { HTTP_ERRORS } from '@app/angular/constants/httpErrors'\n\nexport default angular\n  .module('FirstDataIntegrationV2ControllerModule', [])\n  .controller(\n    'FirstDataIntegrationV2Controller',\n    function (\n      $filter,\n      $q,\n      $rootScope,\n      $scope,\n      $timeout,\n      Restangular,\n      config,\n      errorModalService,\n      firstDataV2Payment,\n      lang,\n      utilService\n    ) {\n      const vm = this\n      let payeezyCallback\n\n      const getDependencies = promiseable(async () => {\n        const hasFirstDataJs = typeof window.firstdata !== 'undefined'\n        if (!hasFirstDataJs) {\n          await utilService.loadScript(FIRSTDATA_V2.JS_FILE_FN({ isProd: utilService.isProd() }))\n        }\n      })\n\n      const onShowCardForm = $scope.onShowCardForm || $scope.$parent.onShowCardForm\n      const checkoutNewCreditCard =\n        $scope.checkoutNewCreditCard || $scope.$parent.checkoutNewCreditCard\n      const { toggleIsShowingAddCard } = $scope\n      const setCreditCard = () => $scope.doSave && $scope.doSave()\n\n      vm.uiState = {\n        selectedCard: null,\n      }\n\n      vm.error = ''\n      vm.showAddCardForm = async () => {\n        vm.error = ''\n        vm.firstDataFormReady = false\n        vm.showFirstDataForm = true\n        vm.hideAddCardButton = true\n\n        if (toggleIsShowingAddCard) toggleIsShowingAddCard(true)\n\n        try {\n          await Restangular.one('cart').one('payment').customPUT({ payment_type: 'auth_capture' })\n\n          const { ext_data = {} } = await Restangular.one('payment').one('session').post()\n\n          const { clientToken, publicKeyBase64 } = ext_data\n\n          if (!clientToken || !publicKeyBase64) {\n            throw new Error('Missing clientToken or publicKeyBase64!')\n          }\n\n          await $q.resolve(getDependencies())\n\n          // Check that form is present before trying to show form\n          // Happens if there is a redirect away from the page whilst resolving dependencies\n          if (!_getDescriptionField() || !_getZipField()) {\n            console.warn('No description field!')\n            return\n          }\n\n          payeezyCallback = await initiateFirstData(\n            lang.values.creditCardFields,\n            clientToken,\n            publicKeyBase64\n          )\n\n          if (onShowCardForm) {\n            onShowCardForm()\n          }\n\n          $timeout(() => (vm.firstDataFormReady = true))\n        } catch (error) {\n          console.error('FirstData - Initialize error', error)\n          vm.cancelAddCard()\n          errorModalService.open(lang.values.defaultErrorMessage, lang.values.ok)\n        }\n      }\n\n      /**\n       * Fetches the payment instruments for v2\n       *\n       * @param {boolean} isNewOrUpdate - True if this is called due to a new card or updated card\n       * @param {boolean} initialCall   - True if this is the initial call to getPaymentInstruments\n       * @return {Object}               - Returns the selected payment instrument\n       */\n      vm.getPaymentInstruments = function ({ isNewOrUpdate = false, initialCall = false } = {}) {\n        return Restangular.one('user')\n          .one('payment')\n          .get({ payment_type: firstDataV2Payment.information.key })\n          .then(response => {\n            const oldLength = vm.paymentInstruments?.length\n            const instruments = response.auth_capture.payment_instruments\n            const firstInstrument = instruments && instruments.length && instruments[0]\n            vm.paymentInstruments = $filter('orderBy')(instruments, 'id', true)\n            firstDataV2Payment.status.loaded = true\n\n            const newLength = vm.paymentInstruments.length\n\n            if (isNewOrUpdate) {\n              vm.uiState.selectedCard = null\n\n              if (newLength > oldLength) {\n                vm.uiState.selectedCard = instruments.reduce((latest, instrument) => {\n                  return new Date(latest.modified) - new Date(instrument.modified) < 0\n                    ? instrument\n                    : latest\n                })\n              }\n            } else if (newLength > 0) {\n              if (!vm.uiState.selectedCard) {\n                // If nothing chosen, select first one by default\n                vm.uiState.selectedCard = firstInstrument\n              } else {\n                // Make sure previously choice still exists\n                const existing = vm.paymentInstruments.find(\n                  instrument => instrument.id === vm.uiState.selectedCard?.ext_id\n                )\n\n                vm.uiState.selectedCard = existing || vm.paymentInstruments[0]\n              }\n\n              if (initialCall) {\n                $timeout(() => setCreditCard())\n              }\n            } else {\n              // Handle no payment methods existing\n              vm.uiState.selectedCard = null\n              vm.showAddCardForm()\n            }\n\n            return vm.uiState.selectedCard\n          })\n      }\n\n      vm.uiState.selectedCard = $scope.payment?.auth_capture || null\n      vm.getPaymentInstruments({ initialCall: true })\n\n      vm.addCard = async function () {\n        let success = null\n        vm.error = ''\n        vm.firstDataFormReady = false\n\n        try {\n          await payeezyCallback(validateDescriptionAndZip)\n\n          vm.paymentListRefresh = true\n          const { cardDescription: name, zipPostalCode: postal_code } = vm\n\n          const instrument = await vm.getPaymentInstruments({ isNewOrUpdate: true })\n\n          if (!instrument) {\n            throw new Error('No new instrument was found for FirstDataV2')\n          }\n\n          instrument.name = name\n          vm.paymentListRefresh = false\n\n          const { id } = instrument\n          await Restangular.one('user').one('payment', id).customPUT({ id, name, postal_code })\n\n          success = true\n        } catch (error) {\n          if (error.status === HTTP_ERRORS.TOO_MANY_REQUESTS) {\n            vm.error = lang.values.tooManyRetriesError\n          } else if (error.FIRST_DATA_ERROR_TYPE === FIRST_DATA_ERROR_TYPES.VALIDATION) {\n            vm.error = lang.values.creditCardFields.error\n          } else {\n            console.error('FirstData - Add card error', error)\n            errorModalService.open(lang.values.firstDataV2.defaultErrorMessage, lang.values.ok)\n\n            success = false\n          }\n        } finally {\n          vm.firstDataFormReady = true\n\n          if (success !== null) {\n            vm.cancelAddCard()\n\n            if (checkoutNewCreditCard) {\n              checkoutNewCreditCard(success)\n            }\n\n            if (success) {\n              $timeout(setCreditCard)\n            } else {\n              vm.getPaymentInstruments()\n            }\n          }\n        }\n      }\n\n      vm.cancelAddCard = function () {\n        vm.showFirstDataForm = false\n        vm.hideAddCardButton = false\n        vm.paymentListRefresh = false\n        vm.cardDescription = ''\n        vm.zipPostalCode = ''\n        vm.error = ''\n\n        if (toggleIsShowingAddCard) toggleIsShowingAddCard(false)\n      }\n\n      // Delete Credit Card\n      vm.deleteCard = function (card) {\n        const { confirm, cancel, deleteCard } = lang.values\n        const errorServiceModalPromise = errorModalService.open(\n          lang.templateAsString(lang.values.deleteCardMessage, {\n            cardName: card.name,\n            cardNumber: card.last_four_digits,\n          }),\n          confirm,\n          cancel,\n          deleteCard\n        )\n\n        vm.cancelAddCard()\n\n        errorServiceModalPromise\n          .then(() => Restangular.one('user/payment', card.id).remove())\n          .then(() => vm.getPaymentInstruments())\n      }\n\n      // Allow user to proceed once a payment instrument has been selected\n      $scope.$watch(\n        () => vm.uiState.selectedCard,\n        () => {\n          if (vm.uiState.selectedCard) {\n            $scope.payment[firstDataV2Payment.information.key] = {\n              payment_instrument: vm.uiState.selectedCard,\n            }\n          }\n          firstDataV2Payment.status.ready = !!vm.uiState.selectedCard\n        }\n      )\n    }\n  )\n\n/**\n * Triggers the injection of iframes into appropriate fields.\n * For this to work, the following must be true:\n *  1. The appropriate div's with ids must be present: https://docs.paymentjs.firstdata.com/#library\n *  2. The `clientToken` and `publicKeyBase64` must be requested via the API to Payment JS\n *  3. The returned `onSubmitFn` should be captured and used when submitting the iframes\n *\n *\n * @param {Object} langStrings        - Object of lang strings: { cardHolderName, cardNumber, cvvCode, expiryDate, zipCode }\n * @param {String} clientToken        - Client token string\n * @param {String} publicKeyBase64    - Public key string\n *\n * @return {Promise<Function>}        - Promise resolving to a callback function, to be triggered\n *                                      when the submit button is pressed\n */\nfunction initiateFirstData(langStrings, clientToken, publicKeyBase64) {\n  // Create FirstData formConfig\n  const { cardHolderName, cardNumber, cvvCode, expiryDateSingleField } = langStrings\n  const { fontFamily, fontSize } = getComputedStyle(_getCardField()) || {}\n\n  const formConfig = {\n    styles: {\n      input: {\n        'font-family': fontFamily,\n        'font-size': fontSize,\n      },\n    },\n\n    classes: {\n      empty: FIRST_DATA_CSS_CLASSES.EMPTY,\n      focus: FIRST_DATA_CSS_CLASSES.FOCUS,\n      invalid: FIRST_DATA_CSS_CLASSES.INVALID,\n      valid: FIRST_DATA_CSS_CLASSES.VALID,\n    },\n\n    fields: {\n      card: {\n        selector: FIRST_DATA_SELECTORS.CARD,\n        placeholder: cardNumber,\n      },\n      cvv: {\n        selector: FIRST_DATA_SELECTORS.CVV,\n        placeholder: cvvCode,\n      },\n      exp: {\n        selector: FIRST_DATA_SELECTORS.EXP,\n        placeholder: expiryDateSingleField,\n      },\n      name: {\n        selector: FIRST_DATA_SELECTORS.NAME,\n        placeholder: cardHolderName,\n      },\n    },\n  }\n\n  /**\n   * Initialize FirstData form\n   *\n   * Returns a promise that resolves with a function which can be called to submit the FirstData\n   * form. The function can be called with a preValidateFn to perform some pre-validation before\n   * the payment form is submitted.\n   */\n  return new Promise((resolve, reject) => {\n    const preFlowHook = providerFn => providerFn({ clientToken, publicKeyBase64 })\n    const onReady = form => resolve(preValidateFn => _onSubmit(form, preValidateFn))\n\n    try {\n      window.firstdata.createPaymentForm(formConfig, { preFlowHook }, onReady)\n    } catch (error) {\n      reject(error)\n    }\n  })\n}\n\n/**\n * @private\n * Performs the iframe payeezy submission\n *\n * @param {Object} paymentForm        - The payeezy interface through which to submit the iframes\n * @param {Function} preValidateFn    - A pre-validation method\n *\n * @return {Promise<any>}\n */\nfunction _onSubmit(paymentForm, preValidateFn) {\n  return new Promise((resolve, reject) => {\n    const validationError = error => {\n      error.FIRST_DATA_ERROR_TYPE = FIRST_DATA_ERROR_TYPES.VALIDATION\n      reject(error)\n    }\n\n    try {\n      const isPreValid = preValidateFn()\n\n      paymentForm.validate(() => {\n        if (!isPreValid) {\n          validationError(new Error('missing description / zip'))\n          return\n        }\n\n        paymentForm.authenticate(\n          auth => {\n            paymentForm.submit(auth, resolve, error => {\n              error.FIRST_DATA_ERROR_TYPE = FIRST_DATA_ERROR_TYPES.SUBMISSION\n              reject(error)\n            })\n          },\n          error => {\n            error.FIRST_DATA_ERROR_TYPE = FIRST_DATA_ERROR_TYPES.AUTHENTICATION\n            reject(error)\n          }\n        )\n      }, validationError)\n    } catch (error) {\n      reject(error)\n    }\n  })\n}\n\nfunction validateDescriptionAndZip() {\n  // Validate the separate boxes\n  const descriptionInput = _getDescriptionField()\n  const zipInput = _getZipField()\n  descriptionInput.focus()\n  descriptionInput.blur()\n  zipInput.focus()\n  zipInput.blur()\n  return descriptionInput.value !== '' && zipInput.value !== ''\n}\n\nfunction _getDescriptionField() {\n  return document.getElementById(DESCRIPTION_INPUT_ID)\n}\nfunction _getZipField() {\n  return document.getElementById(ZIP_INPUT_ID)\n}\nfunction _getCardField() {\n  return document.getElementById(CARD_INPUT_ID)\n}\n","import angular from 'angular'\n\nconst FIRST_DATA_INFORMATION = {\n  name: 'FirstDataV2',\n  key: 'auth_capture',\n  serviceName: 'firstDataV2Payment',\n  newCheckoutCssClass: 'provider-generic_styling',\n}\n\nexport default angular\n  .module('FirstDataPaymentV2ServiceModule', [])\n\n  .config(paymentGatewayProvider => {\n    paymentGatewayProvider.registerGateway({\n      template: require('./firstDataIntegration.html'),\n      ...FIRST_DATA_INFORMATION,\n    })\n  })\n\n  .service('firstDataV2Payment', function firstDataV2Payment($q, config, defaultPayments) {\n    const service = this\n\n    service.information = FIRST_DATA_INFORMATION\n    service.status = {}\n    service.checkout = defaultPayments.checkout\n  })\n","import angular from 'angular'\nimport FirstDataV2Controller from './firstDataIntegrationController.js'\nimport FirstDataV2Service from './firstDataPaymentService.js'\n\nexport default angular.module('app.optionalComponents.FirstDataV2', [\n  FirstDataV2Controller.name,\n  FirstDataV2Service.name,\n])\n","import _ from 'lodash'\nimport angular from 'angular'\nimport { AUTH_ACTIONS } from '@app/angular/constants/authActions'\nimport { auth as authService } from '@instacart/enterprise-services'\n\nexport default angular\n  .module('GigyaServiceModule', [])\n  .service(\n    'gigyaService',\n    function gigyaService(\n      $q,\n      $rootScope,\n      $state,\n      $uibModalStack,\n      $window,\n      anonymousIdService,\n      auth,\n      config,\n      errorModalService,\n      mobileService\n    ) {\n      const service = this\n      const isMobileApp = mobileService.isMobileApp()\n      const sdkLoadedDefer = $q.defer()\n      service.sdkLoaded = sdkLoadedDefer.promise\n\n      // Run Block is executed after all of the services have been configured and the injector has been created\n      // https://docs.angularjs.org/guide/module#run-blocks\n      if (config.gigya && config.gigya.enabled && !isMobileApp) {\n        const script = document.createElement('script')\n        script.type = 'text/javascript'\n        script.src = config.gigya.src + config.gigya.APIKey\n        document.body.appendChild(script)\n\n        if (script.readyState) {\n          // IE\n          script.onreadystatechange = () => {\n            // eslint-disable-next-line eqeqeq\n            // eslint-disable-next-line eqeqeq\n            if (script.readyState == 'loaded' || script.readyState == 'complete') {\n              script.onreadystatechange = null\n              $window.gigya = window.gigya\n              sdkLoadedDefer.resolve()\n            }\n          }\n        } else {\n          script.onload = function () {\n            $window.gigya = window.gigya\n            sdkLoadedDefer.resolve()\n          }\n        }\n      }\n\n      const handleCheckoutAddressUpdate = (_gigyaResponse, userPromise) => {\n        // Patching the profile busts the cache on the backend\n        return auth.updateProfile({}).then(user => {\n          userPromise.resolve(user)\n          return $state.reload()\n        })\n      }\n\n      const handleGigyaSubmit = (gigyaResponse, userPromise) => {\n        // For some reason the plugin is returning the gigyaResponse.resonse as a string\n        // so we have to parse it\n        if (isMobileApp) {\n          gigyaResponse.response = JSON.parse(gigyaResponse.response)\n        }\n\n        const isLoginScreen = gigyaResponse.screen === 'gigya-login-screen'\n        const isRegistrationScreen = gigyaResponse.screen === 'gigya-register-screen'\n\n        const validLoginRegisterResponse =\n          gigyaResponse.response.errorCode === 0 &&\n          gigyaResponse.response.UID &&\n          gigyaResponse.response.UIDSignature &&\n          gigyaResponse.response.signatureTimestamp\n\n        // Check if a user is submitting a Forgot/Reset Password request, in which case do not attempt a login/register with `auth/external`\n        if (gigyaResponse.screen === 'update-delivery-address') {\n          return handleCheckoutAddressUpdate(gigyaResponse, userPromise)\n        }\n        if (\n          gigyaResponse.screen === 'gigya-forgot-password-screen' ||\n          gigyaResponse.screen === 'gigya-reset-password-screen'\n        ) {\n          if ($uibModalStack.getTop()) {\n            $uibModalStack.dismissAll()\n          }\n          return userPromise.resolve()\n        }\n        if (\n          gigyaResponse.screen === 'gigya-change-password-screen' &&\n          gigyaResponse.response.errorCode === 0\n        ) {\n          // Close screen-set and show success message after this is complete\n          if (!isMobileApp) {\n            gigya.accounts.hideScreenSet({\n              screenSet: config.gigya.screenSets.ProfileUpdate,\n            })\n          }\n\n          userPromise.resolve()\n          return errorModalService.open(\n            'Password changed successfully.',\n            null,\n            config.lang.close,\n            'Success'\n          )\n        }\n        if (\n          gigyaResponse.screen === 'gigya-update-profile-screen' &&\n          gigyaResponse.response.errorCode === 0\n        ) {\n          // Patching the profile busts the cache on the backend\n          return auth\n            .updateProfile({})\n            .then(user => {\n              userPromise.resolve(user)\n              return errorModalService.open(\n                'Profile updated successfully.',\n                config.lang.close,\n                null,\n                'Success'\n              )\n            })\n            .then(() => {\n              // If it's native, go to the home page after editing is done.\n              if (isMobileApp) {\n                $state.go('main.home')\n              }\n            })\n        }\n        if (\n          validLoginRegisterResponse &&\n          (isLoginScreen ||\n            (isRegistrationScreen && config.gigya.enableRegistrationLogsIn === true))\n        ) {\n          let submitAction = ''\n\n          if (isLoginScreen) {\n            submitAction = 'login'\n          } else if (isRegistrationScreen) {\n            submitAction = 'registration'\n          }\n\n          const loginPayload = {\n            identifier_polytype: 'gigya',\n            identifier_data: {\n              uid: gigyaResponse.response.UID,\n              uid_signature: gigyaResponse.response.UIDSignature,\n              signature_timestamp: gigyaResponse.response.signatureTimestamp,\n              action: submitAction,\n            },\n          }\n\n          $rootScope.$apply(rootScope => (rootScope.isAppLoading = true))\n          return authService.promiseActions\n            .loginExternal(loginPayload)\n            .then(\n              () => auth.handlePostLogin().then(user => userPromise.resolve(user)),\n              () => {\n                // Do nothing. This is to prevent two modals from showing.\n              }\n            )\n            .catch(loginResponse => {\n              return errorModalService.open(\n                loginResponse.message || config.lang.defaultErrorMessage,\n                'Back To Home'\n              )\n            })\n            .finally(() => {\n              $rootScope.isAppLoading = false\n              if ($uibModalStack.getTop()) {\n                $uibModalStack.dismissAll()\n              }\n            })\n        }\n      }\n\n      const handleGigyaHide = hideResponse => {\n        // Redirect user to homepage if user is `trial` and there is either no current state or state `data.requireRegistered`\n        if (\n          hideResponse.reason === 'canceled' &&\n          // eslint-disable-next-line eqeqeq\n          auth.user.status == 'trial' &&\n          ($state.current.name === '' || $state.data.requireRegistered)\n        ) {\n          $state.go('main.home')\n        }\n      }\n\n      service.gigyaLogin = () => {\n        const userPromise = $q.defer()\n\n        if (isMobileApp) {\n          gigyaClient.showPlugin(\n            'accounts.screenSet',\n            {\n              screenSet: config.gigya.screenSets.registrationLogin,\n            },\n            {\n              onAfterSubmit: gigyaResponse => handleGigyaSubmit(gigyaResponse, userPromise),\n              onDismiss: handleGigyaHide,\n            }\n          )\n        } else {\n          gigya.accounts.showScreenSet({\n            screenSet: config.gigya.screenSets.registrationLogin,\n            onAfterSubmit: gigyaResponse => handleGigyaSubmit(gigyaResponse, userPromise),\n            onHide: handleGigyaHide,\n          })\n        }\n\n        return userPromise.promise.then(user => {\n          $rootScope.$broadcast('auth', 'userLoggedIn')\n          auth.sendLoggedInMessage(user)\n        })\n      }\n\n      service.gigyaRegister = () => {\n        const userPromise = $q.defer()\n\n        const registrationParams = {\n          screenSet: config.gigya.screenSets.registrationLogin,\n          startScreen: 'gigya-register-screen',\n        }\n\n        if (config.gigya.sendRefererOnRegistration) {\n          registrationParams.regSource = document.referrer\n        }\n\n        if (isMobileApp) {\n          gigyaClient.showPlugin('accounts.screenSet', registrationParams, {\n            onAfterSubmit: gigyaResponse => handleGigyaSubmit(gigyaResponse, userPromise),\n          })\n        } else {\n          registrationParams.onAfterSubmit = gigyaResponse =>\n            handleGigyaSubmit(gigyaResponse, userPromise)\n          gigya.accounts.showScreenSet(registrationParams)\n        }\n\n        return userPromise.promise.then(() => {\n          $rootScope.$broadcast('registered')\n        })\n      }\n\n      service.gigyaResetPassword = passwordResetToken => {\n        const userPromise = $q.defer()\n\n        if (isMobileApp) {\n          gigyaClient.showPlugin(\n            'accounts.screenSet',\n            {\n              screenSet: config.gigya.screenSets.registrationLogin,\n              startScreen: 'gigya-reset-password-screen',\n              passwordResetToken,\n            },\n            { onAfterSubmit: gigyaResponse => handleGigyaSubmit(gigyaResponse, userPromise) }\n          )\n        } else {\n          gigya.accounts.showScreenSet({\n            screenSet: config.gigya.screenSets.registrationLogin,\n            startScreen: 'gigya-reset-password-screen',\n            onAfterSubmit: gigyaResponse => handleGigyaSubmit(gigyaResponse, userPromise),\n            passwordResetToken,\n          })\n        }\n\n        return userPromise.promise\n      }\n\n      service.gigyaChangePassword = () => {\n        const userPromise = $q.defer()\n\n        if (isMobileApp) {\n          gigyaClient.showPlugin(\n            'accounts.screenSet',\n            {\n              screenSet: config.gigya.screenSets.profileUpdate,\n              startScreen: 'gigya-change-password-screen',\n            },\n            { onAfterSubmit: gigyaResponse => handleGigyaSubmit(gigyaResponse, userPromise) }\n          )\n        } else {\n          gigya.accounts.showScreenSet({\n            screenSet: config.gigya.screenSets.profileUpdate,\n            startScreen: 'gigya-change-password-screen',\n            onAfterSubmit: gigyaResponse => handleGigyaSubmit(gigyaResponse, userPromise),\n          })\n        }\n\n        return userPromise.promise\n      }\n\n      service.gigyaForgotPassword = () => {\n        if (isMobileApp) {\n          gigyaClient.showPlugin('accounts.screenSet', {\n            screenSet: config.gigya.screenSets.registrationLogin,\n            startScreen: 'gigya-forgot-password-screen',\n          })\n        } else {\n          gigya.accounts.showScreenSet({\n            screenSet: config.gigya.screenSets.registrationLogin,\n            startScreen: 'gigya-forgot-password-screen',\n          })\n        }\n      }\n\n      service.gigyaProfile = () => {\n        const userPromise = $q.defer()\n\n        if (isMobileApp) {\n          gigyaClient.showPlugin(\n            'accounts.screenSet',\n            {\n              screenSet: config.gigya.screenSets.profileUpdate,\n              startScreen: 'gigya-update-profile-screen',\n              containerID: 'unata-gigya-profile-edit',\n            },\n            {\n              onAfterSubmit: gigyaResponse => handleGigyaSubmit(gigyaResponse, userPromise),\n              onDismiss: () => $state.go('main.home'),\n            }\n          )\n        } else {\n          gigya.accounts.showScreenSet({\n            screenSet: config.gigya.screenSets.profileUpdate,\n            startScreen: 'gigya-update-profile-screen',\n            onAfterSubmit: gigyaResponse => handleGigyaSubmit(gigyaResponse, userPromise),\n            containerID: 'unata-gigya-profile-edit',\n          })\n        }\n\n        return userPromise.promise\n      }\n\n      service.gigyaCheckoutAddress = () => {\n        const userPromise = $q.defer()\n\n        if (isMobileApp) {\n          gigyaClient.showPlugin(\n            'accounts.screenSet',\n            {\n              screenSet: config.gigya.screenSets.profileUpdate,\n              startScreen: 'update-delivery-address',\n            },\n            { onAfterSubmit: gigyaResponse => handleGigyaSubmit(gigyaResponse, userPromise) }\n          )\n        } else {\n          gigya.accounts.showScreenSet({\n            screenSet: config.gigya.screenSets.profileUpdate,\n            startScreen: 'update-delivery-address',\n            onAfterSubmit: gigyaResponse => handleGigyaSubmit(gigyaResponse, userPromise),\n          })\n        }\n\n        return userPromise.promise\n      }\n\n      service.gigyaInit = (view, passwordResetToken) => {\n        // Checks the type of view requested (login/register/forgot/change) and executes the appropriate gigya.accounts method\n        return service.sdkLoaded.then(() => {\n          switch (view) {\n            case 'login':\n              return service.gigyaLogin()\n            case 'register':\n              return service.gigyaRegister()\n            case 'reset':\n              return service.gigyaResetPassword(passwordResetToken)\n            case 'change':\n              return service.gigyaChangePassword()\n            case 'forgot':\n              return service.gigyaForgotPassword()\n            case 'profile':\n              return service.gigyaProfile()\n            case AUTH_ACTIONS.LOGOUT:\n              return (config.gigya.syncLogout || isMobileApp) && service.logout()\n          }\n        })\n      }\n\n      // For consistency across differen auth services.\n      service.init = service.gigyaInit\n\n      /**\n       * Returns promise that resolves into user gigya login information\n       *\n       * @returns { Promise }\n       */\n      service.getAccountInfo = () => {\n        const defer = $q.defer()\n        const handleAccountInfoResponse = response => {\n          const { status, statusReason, UID, UIDSignature, signatureTimestamp } = response\n          if (status === 'OK' || statusReason === 'OK') {\n            const gigyaUser = {\n              uid: UID,\n              uid_signature: UIDSignature,\n              signature_timestamp: signatureTimestamp,\n            }\n\n            defer.resolve(gigyaUser)\n          } else {\n            defer.reject(status)\n          }\n        }\n        const accountInfoPayload = {\n          callback: handleAccountInfoResponse,\n        }\n\n        if (isMobileApp) {\n          gigyaClient\n            .sendRequest('accounts.getAccountInfo')\n            .then(({ data }) => handleAccountInfoResponse(data))\n            .catch(({ data }) => defer.reject(data))\n        } else {\n          service.sdkLoaded.then(() => {\n            gigya.accounts.getAccountInfo(accountInfoPayload)\n          })\n        }\n\n        return defer.promise\n      }\n\n      /**\n       * Syncs the platform session with Gigya by automatically logging the user in\n       */\n      service.syncLogin = () => {\n        return service.getAccountInfo().then(service.authenticateGigyaUser)\n      }\n\n      /**\n       * Authenticates Gigya users on the platform\n       * @param { Object } gigyaUser - The Gigya user object\n       *\n       * @returns { Promise }\n       */\n      service.authenticateGigyaUser = ({ uid, uid_signature, signature_timestamp }) => {\n        const loginPayload = {\n          identifier_polytype: 'gigya',\n          identifier_data: {\n            uid,\n            uid_signature,\n            signature_timestamp,\n            action: 'login',\n          },\n        }\n\n        const handleAuthSuccess = () => {\n          return authService.promiseActions.getUser().then(user => {\n            // If logged in user does not have context intent then either use the non-logged in intent or the default.\n            if (_.isNil(user.context.intent)) {\n              auth.setContext({ intent: config.defaultShoppingContext })\n            } else {\n              // If user.context.intent was nil, auth.setContext eventually calls auth.updateUser\n              auth.updateUser(user)\n            }\n\n            // Update the user's anonymousId on the backend as they are now logged in.\n            anonymousIdService.updateBackendId()\n          })\n        }\n\n        const handleAuthError = loginResponse => {\n          return errorModalService.open(\n            loginResponse.message || config.lang.defaultErrorMessage,\n            'Back To Home'\n          )\n        }\n\n        return authService.promiseActions\n          .loginExternal(loginPayload)\n          .then(\n            handleAuthSuccess,\n            () => {} // Do nothing. This is to prevent two modals from showing.\n          )\n          .catch(handleAuthError)\n          .finally(() => {\n            if ($uibModalStack.getTop()) {\n              $uibModalStack.dismissAll()\n            }\n          })\n      }\n\n      /**\n       * Destroys Gigya session\n       *\n       * @returns { Promise }\n       */\n      service.logout = () => {\n        const defer = $q.defer()\n        const handleAccountInfoSuccess = response => {\n          response.status === 'OK' || response.statusReason === 'OK'\n            ? defer.resolve(response)\n            : defer.reject(response)\n        }\n\n        service.getAccountInfo().then(({ uid }) => {\n          const logoutPayload = {\n            UID: uid,\n            callback: handleAccountInfoSuccess,\n          }\n\n          if (isMobileApp) {\n            gigyaClient\n              .sendRequest('accounts.logout')\n              .then(({ data }) => handleAccountInfoSuccess(data))\n              .catch(({ data }) => defer.reject(data))\n          } else {\n            $window.gigya.accounts.logout(logoutPayload)\n          }\n        })\n\n        return defer.promise\n      }\n\n      document.addEventListener('deviceready', function () {\n        if (isMobileApp && config.gigya && config.gigya.enabled && window.gigyaClient) {\n          $window.gigya = gigyaClient\n          gigyaClient.init(config.gigya.APIKey, 'us1.gigya.com')\n          gigyaClient.addEventListener(gigyaClient.Event.LOGIN, this.gigyaLogin)\n          sdkLoadedDefer.resolve()\n        }\n      })\n\n      return service\n    }\n  )\n","import angular from 'angular'\nimport GigyaService from './gigya.js'\n\nexport default angular.module('app.optionalComponents.Gigya', [GigyaService.name])\n","import angular from 'angular'\nimport { AUTH_TYPES, PAYMENT_TYPES } from '@app/angular/constants/payments'\nimport { HTTP_ERRORS } from '@app/angular/constants/httpErrors'\nimport template from './stripePaymentForm.html'\n\nconst RENDER_DELAY = 200\n\nexport default angular\n  .module('StripePaymentFormComponentModule', [])\n\n  .component('stripePaymentForm', {\n    bindings: {\n      additionalFormInfo: '@?',\n      addCardLabel: '@?',\n      enableGiftCards: '<',\n      showCreditCardSelectButton: '<?',\n      hideTitle: '<?',\n      useIcTheme: '<?',\n      authType: '<?', // auth_capture | external_auth\n      styleAddCardAsLink: '<?',\n      createCreditCardLabel: '@?',\n      enableCancelFormButton: '<?',\n      enableCreditCardListBackground: '<?',\n      enableCreditCardSelectButton: '<?',\n      onCreditCardSelect: '&?',\n      onCancelFormClick: '&?',\n      fullWidthButtons: '<?',\n      squaredButtons: '<?',\n      enableFormBackground: '<?',\n      enableCreditCardSelectAfterAdd: '<?',\n      requestUserPaymentOnFirstFetch: '<?',\n      showSaveCreditCardCheckbox: '<?',\n    },\n    controller(\n      $scope,\n      $timeout,\n      confirmationModal,\n      giftCardModalService,\n      lang,\n      mobileService,\n      Restangular,\n      stripe,\n      stripePayment,\n      errorModalService\n    ) {\n      const vm = this\n      const onShowCardForm = $scope.$parent?.onShowCardForm\n      const checkoutNewCreditCard = $scope.$parent?.checkoutNewCreditCard\n\n      vm.lang = lang\n      vm.isMobile = mobileService.isMobile\n      vm.authType = vm.authType || AUTH_TYPES.CAPTURE\n      vm.checkoutSave = $scope.$parent?.checkoutSave\n      vm.paymentContext = $scope.$parent?.paymentContext\n\n      const deletePaymentInstrument = id => {\n        return Restangular.one('user')\n          .one('payment', id)\n          .remove({ service_type: vm.paymentContext })\n      }\n\n      vm.handleDeleteClick = creditCard => {\n        const message = vm.lang.template(vm.lang.values.deleteCreditCardMessage, {\n          digits: creditCard.last_four_digits,\n        })\n\n        confirmationModal.open({ message }).then(proceed => {\n          if (proceed) {\n            deletePaymentInstrument(creditCard.id)\n              .then(() => {\n                vm.paymentInstruments = vm.paymentInstruments.filter(pi => pi.id !== creditCard.id)\n                if (!vm.paymentInstruments.length) {\n                  vm.showStripeForm()\n                }\n              })\n              .catch(() => {\n                const { defaultErrorMessage, ok } = vm.lang.values\n\n                errorModalService.open(defaultErrorMessage, ok)\n              })\n          }\n        })\n      }\n\n      /**\n       * Shows the stripe form\n       * @returns { undefined }\n       */\n      vm.showStripeForm = () => {\n        vm.shouldShowStripeForm = true\n\n        if ($scope.$parent?.toggleIsShowingAddCard) {\n          // eslint-disable-next-line no-unused-expressions\n          $scope.$parent?.toggleIsShowingAddCard(true)\n        }\n\n        if (onShowCardForm) {\n          onShowCardForm()\n        }\n      }\n\n      /**\n       * Opens a gift cards modal\n       *\n       * @returns { undefined }\n       */\n      vm.openGiftCardsModal = () => {\n        const { payment } = $scope.$parent\n\n        giftCardModalService.open({ payment })\n      }\n\n      /**\n       * Hides the stripe form\n       * @returns { undefined }\n       */\n      vm.hideStripeForm = () => {\n        vm.shouldShowStripeForm = false\n\n        if ($scope.$parent?.toggleIsShowingAddCard) {\n          // eslint-disable-next-line no-unused-expressions\n          $scope.$parent?.toggleIsShowingAddCard(false)\n        }\n      }\n\n      /**\n       * Fetch and set user\n       */\n      const fetchPaymentInstruments = existingExtId =>\n        Restangular.one('user')\n          .one('payment')\n          .get({\n            payment_type: vm.authType,\n            service_type: vm.paymentContext,\n          })\n          .then(response => {\n            // Save payment instruments and show or hide Stripe form as appropriate\n            const instruments = response[vm.authType].payment_instruments.filter(pi => pi.id)\n            const firstInstrument = instruments[0]\n\n            vm.paymentInstruments = instruments.sort((a, b) => a.source.localeCompare(b.source))\n\n            stripePayment.status.loaded = true\n\n            if (vm.paymentInstruments.length) {\n              vm.hideStripeForm()\n\n              // Selects the last used or first credit card if there's no credit card selected\n              if (!vm.selectedCard) {\n                vm.selectedCard =\n                  (existingExtId && instruments.find(({ ext_id }) => ext_id === existingExtId)) ||\n                  firstInstrument\n              }\n\n              if (vm.enableCreditCardSelectAfterAdd) {\n                $timeout(vm.setCreditCard)\n              }\n            } else {\n              // BE says customer has no payment instruments / previously added credit cards\n              vm.showStripeForm()\n            }\n\n            return vm.paymentInstruments\n          })\n\n      $scope.$watch('$ctrl.selectedCard', () => {\n        // Allow user to proceed only if a payment instrument has been selected\n        const hasSelectedCard = !!vm.selectedCard\n\n        if (hasSelectedCard) {\n          // $scope.$parent.payment lives in the CheckoutPaymentController\n          if ($scope.$parent.payment) {\n            $scope.$parent.payment[vm.authType] = { payment_instrument: vm.selectedCard }\n          }\n        }\n        stripePayment.status.ready = hasSelectedCard\n      })\n\n      /**\n       * Handles the cancel click event\n       * @returns { undefined }\n       */\n      vm.handleCancelClick = () => {\n        const { paymentInstruments } = vm\n\n        if (paymentInstruments.length > 0) {\n          vm.hideStripeForm()\n          return\n        }\n\n        if (paymentInstruments.length === 0 && vm.enableCancelFormButton) {\n          vm.onCancelFormClick()\n        }\n      }\n\n      /**\n       * Executes when a credit card is successfully added\n       * @param { object } card\n       * @returns { undefined }\n       */\n      vm.handleCreditCardAdd = card => {\n        vm.hideStripeForm()\n        vm.paymentInstruments.push(card)\n        vm.selectedCard = card\n\n        if ($scope.$parent.payment) {\n          $scope.$parent.payment[vm.authType] = { payment_instrument: card }\n        }\n\n        if (vm.enableCreditCardSelectAfterAdd) {\n          $timeout(vm.setCreditCard, RENDER_DELAY)\n\n          if (checkoutNewCreditCard) {\n            checkoutNewCreditCard(true)\n          }\n        }\n      }\n\n      /**\n       * Executes when a credit card add call fails\n       * @returns { undefined }\n       */\n      vm.handleCreditCardAddError = (e = {}) => {\n        let errorMessage = e.data?.message || e?.message || vm.lang.values.defaultErrorMessage\n        if (e.status === HTTP_ERRORS.TOO_MANY_REQUESTS) {\n          errorMessage = lang.values.tooManyRetriesError\n        }\n        errorModalService.open(errorMessage, vm.lang.values.ok)\n\n        if (checkoutNewCreditCard) {\n          checkoutNewCreditCard(false)\n        }\n      }\n\n      vm.setCreditCard = creditCard => {\n        vm.onCreditCardSelect && vm.onCreditCardSelect({ creditCard })\n      }\n\n      // Load payment instruments\n      const firstFetch = () => {\n        const paymentExtIdOfCurrentAuthType = $scope.$parent?.payment?.[vm.authType]?.ext_id\n        const paymentExtIdOfExternalAuthType =\n          $scope.$parent?.payment?.[PAYMENT_TYPES.EXTERNAL_AUTH]?.ext_id\n\n        // If the payment id isn't found and the current type is auth_capture, use potential id from\n        // external_auth type if it exists. This is to set the credit card correctly when modifying an\n        // order that used OnePayment, which changes auth_capture to external_auth.\n        const paymentExtId =\n          !paymentExtIdOfCurrentAuthType && vm.authType === PAYMENT_TYPES.AUTH_CAPTURE\n            ? paymentExtIdOfExternalAuthType\n            : undefined\n\n        return fetchPaymentInstruments(paymentExtId).catch(() => {\n          const { defaultErrorMessage, ok } = vm.lang.values\n          errorModalService.open(defaultErrorMessage, ok)\n        })\n      }\n\n      if (vm.requestUserPaymentOnFirstFetch) {\n        Restangular.one('user')\n          .post('payer', {\n            payment_type: vm.authType,\n            service_type: vm.paymentContext,\n            auth_capture: {},\n          })\n          .then(firstFetch)\n      } else {\n        firstFetch()\n      }\n    },\n    template,\n  })\n","import { STRIPE } from '@app/angular/constants/paymentGateway'\nimport angular from 'angular'\nimport template from './stripeIntegration.html'\n\nexport default angular\n  .module('StripePaymentServiceModule', [])\n\n  .run(utilService => {\n    utilService.loadScript(STRIPE.JS_FILE)\n  })\n\n  .config((configConstants, paymentGatewayProvider, stripeProvider) => {\n    stripeProvider.setAPIKey(configConstants.stripe.apiKey)\n\n    /**\n     * Stripe can be used as an *external_auth* and *auth_capture* payment type\n     */\n    paymentGatewayProvider.registerGateway({\n      name: 'stripe',\n      key: 'auth_capture',\n      template: template,\n      serviceName: 'stripePayment',\n      newCheckoutCssClass: 'provider-generic_styling',\n      hideSaveButton: true,\n      hideGiftCardLink: true,\n    })\n\n    paymentGatewayProvider.registerGateway({\n      name: 'stripe',\n      key: 'external_auth',\n      template: template,\n      serviceName: 'stripePayment',\n      newCheckoutCssClass: 'provider-generic_styling',\n      hideSaveButton: true,\n      hideGiftCardLink: true,\n    })\n  })\n\n  .service('stripePayment', function stripePayment($q, defaultPayments) {\n    const service = this\n    service.status = {}\n    service.checkout = defaultPayments.checkout\n  })\n\n  // Forked from https://github.com/kareniel/angularjs-stripe-elements\n  .provider('stripe', function stripeProvider() {\n    // Global variable: Stripe\n\n    this.apiKey = null\n\n    this.setAPIKey = function (apiKey) {\n      this.apiKey = apiKey\n    }\n\n    this.$get = function () {\n      return Stripe(this.apiKey)\n    }\n  })\n\n  .directive('stripeElementDecorator', function () {\n    return {\n      restrict: 'A',\n      link: link,\n    }\n\n    function link($scope, $element) {\n      const $ctrl = $scope.$ctrl\n\n      $scope.$on('$destroy', () => {\n        $ctrl.instance.destroy()\n      })\n\n      $ctrl.instance.mount($element[0])\n    }\n  })\n\n  .component('stripeElement', {\n    template: '<div ng-class=\"{ \\'ic-theme\\': $ctrl.useIcTheme }\" stripe-element-decorator></div>',\n    controller: function () {},\n    bindings: {\n      instance: '<',\n      useIcTheme: '<',\n    },\n  })\n","import angular from 'angular'\nimport StripeController from './stripePaymentForm.controller.js'\nimport StripeService from './stripeIntegration.js'\n\nexport default angular.module('app.optionalComponents.Stripe', [\n  StripeController.name,\n  StripeService.name,\n])\n","import _ from 'lodash'\nimport {\n  VANTIV,\n  VANTIV_CVV_SUCCESS_RESPONSES,\n  VANTIV_AVS_SUCCESS_RESPONSES,\n} from '@app/angular/constants/paymentGateway'\nimport angular from 'angular'\nimport { PAYMENT_POLYTYPES } from '@app/angular/constants/payments'\nimport { HTTP_ERRORS } from '@app/angular/constants/httpErrors'\nimport template from './vantivReturn.html'\n\nconst COMPLETE = 'Complete'\nconst CANCELLED = 'Cancelled'\nconst ERROR = 'Error'\nconst VANTIV_LOST_CONNECTION = 'Connection between Vantiv lost'\nconst CONNECTION_TIMEOUT_STATUS = -1\n\nexport default angular\n  .module('VantivIntegrationControllerModule', [])\n\n  .config($stateProvider => {\n    $stateProvider.state('vantiv', {\n      url: VANTIV.URL,\n      data: {},\n      views: {\n        'content@': {\n          template,\n          controller($window, $stateParams) {\n            $window.parent.postMessage($stateParams, '*')\n          },\n        },\n      },\n    })\n  })\n  .controller(\n    'VantivIntegrationController',\n    function (\n      $location,\n      $q,\n      $scope,\n      $timeout,\n      $window,\n      Restangular,\n      config,\n      errorModalService,\n      lang,\n      recaptchaService,\n      utilService,\n      vantivPayment\n    ) {\n      const onShowCardForm = $scope.onShowCardForm || $scope.$parent.onShowCardForm\n      const checkoutNewCreditCard =\n        $scope.checkoutNewCreditCard || $scope.$parent.checkoutNewCreditCard\n      const setCreditCard = () => $scope.doSave && $scope.doSave()\n\n      let iframe = getIframe()\n      let existingPaymentInstruments = []\n\n      $scope.showAddInstrument = false\n\n      if ($scope.toggleIsShowingAddCard) {\n        $scope.toggleIsShowingAddCard(false)\n      }\n\n      $scope.showAddInstrumentLoader = false\n\n      /**\n       * Gets the transaction_setup_id for the payment\n       *\n       * @param {object} [recaptcha]   - Optional: If recaptcha is switched on, a recaptcha object to\n       *                                            send on the PUT request to validate non-robot usage\n       * @returns {Promise}\n       */\n      $scope.getAuthToken = function (recaptcha = {}) {\n        let baseUrl = `${$location.$$protocol}://${$location.$$host}`\n        if ($location.$$port) {\n          baseUrl += `:${$location.$$port}`\n        }\n        return Restangular.one('cart')\n          .one('payment')\n          .customPUT({\n            payment_type: 'auth_capture',\n            auth_capture: { web_url: baseUrl },\n            recaptcha,\n          })\n          .then(response => ($scope.auth_token = response.auth_capture.transaction_setup_id))\n      }\n\n      $scope.clearVantivIframe = function () {\n        iframe.src = ''\n      }\n\n      $scope.loadVantivIframe = function (transactionSetupId) {\n        iframe.src = VANTIV.IFRAME_FN({ isProd: utilService.isProd(), transactionSetupId })\n      }\n\n      $scope.toggleAddInstrumentLoader = function (isShow) {\n        $scope.showAddInstrumentLoader = !!isShow\n      }\n\n      $scope.getPaymentInstruments = function (initCall, selectExtId) {\n        return Restangular.one('user')\n          .one('payment')\n          .get({ payment_type: 'auth_capture' })\n          .then(response => {\n            vantivPayment.status.loaded = true\n\n            if (initCall) {\n              // set an existing object to compare with newly added payment instruments in this state load\n              existingPaymentInstruments = JSON.parse(\n                angular.toJson(response.auth_capture.payment_instruments)\n              )\n              $scope.paymentInstruments = response.auth_capture.payment_instruments\n            } else {\n              // apply an `isNew` property to any newly added payment instruments\n              const sanitizedExistingPaymentInstruments = JSON.parse(\n                angular.toJson(existingPaymentInstruments)\n              )\n\n              $scope.paymentInstruments = _.map(\n                response.auth_capture.payment_instruments,\n                paymentInstrument => {\n                  paymentInstrument.isNew = !_.find(\n                    sanitizedExistingPaymentInstruments,\n                    existingPaymentInstrument => {\n                      return existingPaymentInstrument.id === paymentInstrument.id\n                    }\n                  )\n\n                  if (\n                    paymentInstrument.isNew &&\n                    typeof paymentInstrument.shouldSave !== 'boolean'\n                  ) {\n                    paymentInstrument.shouldSave = true\n                  }\n\n                  return paymentInstrument\n                }\n              )\n            }\n\n            if ($scope.paymentInstruments.length) {\n              const instrument =\n                selectExtId &&\n                $scope.paymentInstruments.find(instrument => instrument.ext_id === selectExtId)\n\n              if (instrument) {\n                $scope.paymentInstrumentId = instrument.id\n              } else if (!$scope.paymentInstrumentId) {\n                $scope.paymentInstrumentId = $scope.paymentInstruments[0].id\n              } else {\n                const stillExists = !!_.find($scope.paymentInstruments, {\n                  id: $scope.paymentInstrumentId,\n                })\n                if (!stillExists) {\n                  $scope.paymentInstrumentId = $scope.paymentInstruments[0].id\n                }\n              }\n\n              if (initCall) {\n                $timeout(setCreditCard)\n              }\n            } else {\n              $scope.paymentInstrumentId = null\n            }\n\n            // Save paymentInstruments and the state of their `isNew` and `shouldSave` properties for further processing at Order Submit\n            vantivPayment.paymentInstruments = $scope.paymentInstruments\n\n            // If no credit cards, open add new card immediately\n            if (!$scope.paymentInstruments?.length) {\n              $scope.addPaymentInstrument()\n            }\n          })\n      }\n\n      const loadInitial = () => $scope.getPaymentInstruments(true, $scope.payment?.auth_capture)\n\n      if (iframe) {\n        loadInitial()\n      }\n\n      $scope.addPaymentInstrument = function (isRetry) {\n        $scope.clearVantivIframe()\n        $scope.recaptcha = {}\n        $scope.isRecaptchaReady = false\n        $scope.showAddInstrument = true\n\n        if ($scope.toggleIsShowingAddCard) {\n          $scope.toggleIsShowingAddCard(true)\n        }\n\n        $scope.toggleAddInstrumentLoader(true)\n\n        reloadPaymentInfo(isRetry)\n          .then(() => {\n            if (!getIframe()) throw CANCELLED\n            // Upon render, $scope.onRecaptchaReady will get triggered\n            return vantivPayment.initializeRecaptcha(\n              // If $scope.reactMethods is defined, we want to show a popup for recaptcha\n              !$scope.reactMethods ? $scope.recaptcha : recaptchaService.openRecaptchaInModal\n            )\n          })\n          .then(recaptchaResponse => {\n            $scope.recaptcha = { complete: true }\n            $scope.isRecaptchaReady = false\n            $scope.toggleAddInstrumentLoader(true)\n            return $scope.getAuthToken(recaptchaResponse)\n          })\n          .then($scope.loadVantivIframe) // Passes in authToken as the first argument\n          .then(() => {\n            $scope.toggleAddInstrumentLoader(false)\n            if (onShowCardForm) {\n              onShowCardForm()\n            }\n          })\n          .then(addVantivHandlerAndWait)\n          .then(ext_id => $scope.getPaymentInstruments(false, ext_id))\n          .then(() => $timeout(setCreditCard))\n          .then(() => {\n            if (checkoutNewCreditCard) {\n              checkoutNewCreditCard(true)\n            }\n          })\n          .catch(err => {\n            addCardFailed(!err.isRecaptchaError && isRetry, err.isRecaptchaAbort ? CANCELLED : err)\n          })\n          .finally(() => {\n            $scope.recaptcha = {}\n            $scope.isRecaptchaReady = false\n          })\n      }\n\n      $scope.onRecaptchaReady = () => {\n        // It's a lie, it's not really ready for another ~1s!\n        // This is to prevent flicker of the captcha\n        $timeout(() => {\n          $scope.toggleAddInstrumentLoader(false)\n          $scope.isRecaptchaReady = true\n        }, 1000)\n      }\n\n      function getIframe() {\n        return document.querySelector('#iframeVantiv')\n      }\n\n      function reloadPaymentInfo(isRetry) {\n        return Restangular.one('user')\n          .one('payment')\n          .get({ payment_type: 'auth_capture', UI_isRetry: isRetry })\n      }\n\n      function addVantivHandlerAndWait() {\n        return new Promise((resolve, reject) => {\n          if (!$window.addEventListener) {\n            $window.attachEvent('onmessage', e => vantivReturnHandler(e, resolve, reject))\n          } else {\n            $window.addEventListener('message', e => vantivReturnHandler(e, resolve, reject), false)\n          }\n        })\n      }\n\n      $scope.backToCardView = () => {\n        $scope.showAddInstrument = false\n        $scope.isRecaptchaReady = false\n        $scope.recaptcha = {}\n\n        if ($scope.toggleIsShowingAddCard) {\n          $scope.toggleIsShowingAddCard(false)\n        }\n\n        $scope.toggleAddInstrumentLoader(false)\n        $scope.clearVantivIframe()\n      }\n\n      function addCardFailed(isRetry, err) {\n        $scope.backToCardView()\n\n        if (err === CANCELLED) return\n\n        if (!isRetry) {\n          $scope.addPaymentInstrument(true)\n        } else {\n          let errorMessage = err.data?.message || lang.values.defaultErrorMessage\n          if (VANTIV_LOST_CONNECTION || err.status === CONNECTION_TIMEOUT_STATUS) {\n            errorMessage = `${lang.values.timedout} ${lang.values.tryAgainPolite}.`\n          } else if (err.status === HTTP_ERRORS.TOO_MANY_REQUESTS) {\n            errorMessage = lang.values.tooManyRetriesError\n          }\n\n          errorModalService.open(errorMessage, lang.values.ok)\n\n          if (checkoutNewCreditCard) {\n            checkoutNewCreditCard(false)\n          }\n        }\n      }\n      // The vantiv return handler gets called multiple times sometimes,\n      // This is  needed to keep a record of transaction so we don't have more than one modal\n      $scope.prevTransactionId = null\n      function vantivReturnHandler(e, resolve, reject) {\n        const status = e.data.HostedPaymentStatus\n        switch (status) {\n          case CANCELLED:\n            return reject(CANCELLED)\n          case ERROR:\n            return reject(e)\n\n          // vantivReturnHandler is triggered multiple times, most of the times are nonsense, so we ignore by returning\n          default:\n            if (status !== COMPLETE) return\n        }\n\n        const { CVVResponseCode, AVSResponseCode } = e.data || {}\n        const isCvvResponseOk =\n          CVVResponseCode && VANTIV_CVV_SUCCESS_RESPONSES.includes(CVVResponseCode)\n        const isAvsResponseOk =\n          AVSResponseCode && VANTIV_AVS_SUCCESS_RESPONSES.includes(AVSResponseCode)\n\n        if (!isCvvResponseOk || !isAvsResponseOk) {\n          // This is needed to ensure we don't display multiple modals as this function can be called multiple times\n          if (e.data.TransactionID === $scope.prevTransactionId) {\n            return reject(e)\n          }\n\n          $scope.prevTransactionId = e.data.TransactionID\n          errorModalService.open(\n            lang.values[!isCvvResponseOk ? 'cvvError' : 'avsError'],\n            lang.values.ok\n          )\n          return reject(e)\n        }\n\n        $scope.showAddInstrument = false\n\n        if ($scope.toggleIsShowingAddCard) {\n          $scope.toggleIsShowingAddCard(false)\n        }\n\n        $scope.clearVantivIframe()\n\n        const paymentInstrument = {\n          polytype: PAYMENT_POLYTYPES.CREDIT_CARD,\n          last_four_digits: e.data.LastFour,\n          ext_id: e.data.PaymentAccountID,\n          expiry_date: '3000-01-01',\n          provider: e.data.CardLogo,\n          holder_name: null,\n          name: 'card',\n          ext_data: { transaction_id: e.data.TransactionID },\n        }\n\n        $window.removeEventListener('message', vantivReturnHandler, false)\n\n        return Restangular.one('user')\n          .one('payment')\n          .customPOST(paymentInstrument)\n          .then(response => ($scope.auth_token = response.ext_id))\n          .then(resolve)\n          .catch(reject)\n      }\n\n      $scope.deleteCard = function (card) {\n        errorModalService\n          .open(\n            `${lang.template(lang.values.deleteCardMessage, {\n              cardName: card.name,\n              cardNumber: card.last_four_digits,\n            })}`,\n            lang.values.confirm,\n            lang.values.cancel,\n            lang.values.deleteCard\n          )\n          .then(() => Restangular.one('user/payment', card.id).remove())\n          .then(() => $scope.getPaymentInstruments())\n      }\n\n      $scope.$watch('paymentInstrumentId', () => {\n        if ($scope.payment) {\n          $scope.payment.auth_capture = {\n            payment_instrument: {\n              id: $scope.paymentInstrumentId,\n            },\n          }\n        }\n        vantivPayment.status.ready = !!$scope.paymentInstrumentId\n      })\n\n      $scope.$watch(\n        () => $scope.lastEditMode,\n        isLastEditMode =>\n          isLastEditMode && $scope.showAddInstrument && $scope.toggleIsShowingAddCard(true)\n      )\n\n      const findCard = extId => $scope.paymentInstruments?.find(card => card.ext_id === extId)\n\n      /**\n       * React JS supporting methods for payments\n       *\n       * If there is a parent controller present `$scope.reactMethods` can be defined, to allow\n       * these methods to be accessed by the parent scope. This is because objects are passed by\n       * reference, not by value.\n       */\n      if ($scope.reactMethods) {\n        Object.assign($scope.reactMethods, {\n          onDeleteCard: extId => $scope.deleteCard(findCard(extId)),\n          onUpdateCard: (extId, { saveInProfile }) => {\n            $scope.$apply(() => {\n              $scope.paymentInstruments = $scope.paymentInstruments.map(card => {\n                const shouldSave = card.ext_id === extId ? saveInProfile : card.saveInProfile\n                return { ...card, shouldSave }\n              })\n              vantivPayment.paymentInstruments = $scope.paymentInstruments\n            })\n          },\n          onPaymentIframeRendered: renderedIframe => {\n            iframe = renderedIframe\n            loadInitial()\n          },\n          onPurchaseComplete: () => vantivPayment.checkoutComplete(),\n          onSelectCard: extId => $scope.$apply(() => ($scope.paymentInstrumentId = extId)),\n          getSelectedCard: () => {\n            const { paymentInstrumentId: idOrExtId, paymentInstruments: cards } = $scope\n            if (cards) {\n              const found = cards.find(({ id, ext_id }) => id === idOrExtId || ext_id === idOrExtId)\n              return found?.ext_id\n            }\n          },\n        })\n      }\n    }\n  )\n","import angular from 'angular'\nimport template from './vantivIntegration.html'\n\nexport default angular\n  .module('VantivPaymentServiceModule', [])\n  .config(paymentGatewayProvider => {\n    paymentGatewayProvider.registerGateway({\n      name: 'Vantiv',\n      key: 'auth_capture',\n      template,\n      serviceName: 'vantivPayment',\n      newCheckoutCssClass: 'provider-generic_styling',\n    })\n  })\n\n  .service('vantivPayment', function vantivPayment($q, Restangular, defaultPayments) {\n    const service = this\n\n    service.status = {}\n\n    service.checkout = defaultPayments.checkout\n    service.checkoutComplete = () => {\n      service.paymentInstruments.forEach(({ id, isNew, shouldSave }) => {\n        // Payment instrument saved by default - set to false for those we're not saving and PUT this to server\n        if (isNew === true && !shouldSave) {\n          Restangular.one('user').one('payment', id).customPUT({ id, status: false })\n        }\n      })\n    }\n\n    service.initializeRecaptcha = defaultPayments.initializeRecaptcha\n\n    service.paymentInstruments = []\n  })\n","import angular from 'angular'\nimport VantiveController from './vantivIntegrationController.js'\nimport VantiveService from './vantivPaymentService.js'\n\nexport default angular.module('app.optionalComponents.Vantiv', [\n  VantiveController.name,\n  VantiveService.name,\n])\n","export const WEGPAY_SUCCESS = '870'\n\n// The string values need to match to lang.wegpay.returnCodeLangMap keys\nexport const WEGPAY_ERROR_TYPES = {\n  VALIDATION: 'VALIDATION',\n  SYSTEM: 'SYSTEM',\n  SOFT_DECLINE: 'SOFT_DECLINE',\n  HARD_DECLINE: 'HARD_DELCINE',\n}\n\n// prettier-ignore\nexport const WEGPAY_RETURN_CODES = {\n  870: WEGPAY_SUCCESS,                    // Success\n  871: WEGPAY_ERROR_TYPES.VALIDATION,     // Account Number not Mod10\n  872: WEGPAY_ERROR_TYPES.VALIDATION,     // Account Number too short\n  873: WEGPAY_ERROR_TYPES.VALIDATION,     // Account Number too long\n  874: WEGPAY_ERROR_TYPES.VALIDATION,     // Account Number not numeric\n  875: WEGPAY_ERROR_TYPES.SYSTEM,         // Unable to encrypt field\n  876: WEGPAY_ERROR_TYPES.VALIDATION,     // Account number invalid\n  881: WEGPAY_ERROR_TYPES.VALIDATION,     // Card Validation number not numeric\n  882: WEGPAY_ERROR_TYPES.VALIDATION,     // Card Validation number too short\n  883: WEGPAY_ERROR_TYPES.VALIDATION,     // Card Validation number too long\n  884: WEGPAY_ERROR_TYPES.SYSTEM,         // eProtect iFrame HTML failed to load\n  885: WEGPAY_ERROR_TYPES.SYSTEM,         // eProtect iFrame CSS failed load - <number>\n  889: WEGPAY_ERROR_TYPES.SYSTEM,         // Failure\n  826: WEGPAY_ERROR_TYPES.SOFT_DECLINE,   // Checkout ID was invalid\n  827: WEGPAY_ERROR_TYPES.SOFT_DECLINE,   // Checkout ID was not found\n  828: WEGPAY_ERROR_TYPES.SOFT_DECLINE,   // Generic Checkout ID error\n  877: WEGPAY_ERROR_TYPES.HARD_DECLINE,   // Invalid PayPage Registration ID\n  878: WEGPAY_ERROR_TYPES.HARD_DECLINE,   // Expired PayPage Registration ID\n  879: WEGPAY_ERROR_TYPES.HARD_DECLINE,   // Merchant is not authorized for PayPage\n}\n\nexport const WEGPAY_MASKS = {\n  cardHolder: /^[A-Za-z\\-.' ]{1,70}/, // Name on card\n  zipCode: /^\\d{5}(-\\d{4}|\\d{4})?$|^[ABCEGHJKLMNPRSTVXY][0-9][ABCEGHJKLMNPRSTVWXYZ] ?[0-9][ABCEGHJKLMNPRSTVWXYZ][0-9]$/, // Limited to US/Canada\n}\n\nexport const WEGPAY_CARD_TYPE_CODES = {\n  AX: 'AmericanExpress',\n  DI: 'Discover',\n  MC: 'MasterCard',\n  VI: 'Visa',\n}\n","import angular from 'angular'\nimport { WEGPAY_SUCCESS } from '@app/angular/constants/wegpay'\nimport template from './wegpayIntegration.html'\n\nexport default angular\n  .module('WegpayPaymentServiceModule', [])\n  .config(paymentGatewayProvider => {\n    paymentGatewayProvider.registerGateway({\n      name: 'Wegpay',\n      key: 'auth_capture',\n      template,\n      serviceName: 'WegpayPayment',\n      newCheckoutCssClass: 'provider-generic_styling',\n      hideSaveButton: true,\n    })\n  })\n  .service('WegpayPayment', function WegpayPayment($q, defaultPayments) {\n    const service = this\n\n    service.isReady = false\n    service.status = {}\n    service.checkout = defaultPayments.checkout\n    service.paymentInstruments = []\n  })\n\n/**\n * TODO ENSURE THAT NOTHING ANGULAR APPEARS BELOW THIS LINE\n *      This code is to make upgrading in the future easier!\n */\n\n/**\n * This imports the wegpay dependencies (jquery and the javascript file)\n * You can call this multiple times but it will only load the resources if they are missing\n *\n * Upon subsequent calls it will return a cached promise, as per the \"promiseable\" util\n *\n * @param {object} utilService       - The util service containing \"loadScript\", \"semVerDifference\" methods\n * @param {string} iFrameJSsrc       - The string of the iframe javascript src\n * @param {string} minJQueryVersion  - The version string for the minimum supported jQuery version for Wegpay\n * @param {string} jQuerySrc         - The jQuery source file to load if jQuery is not present already\n *\n * @returns {Promise}            - Resolves if successful\n *\n */\nexport const importWegpayDependencies = async (\n  { loadScript, semVerDifference },\n  iFrameJSsrc,\n  minJQueryVersion,\n  jQuerySrc\n) => {\n  const hasJquery = typeof window.jQuery !== 'undefined'\n  const hasWegpay = typeof window.EprotectIframeClient !== 'undefined'\n\n  if (hasJquery && semVerDifference(window.jQuery.fn.jquery, minJQueryVersion) < 0) {\n    throw new Error(\n      `Wegpay requires jQuery ${minJQueryVersion}+, but you have ${window.jQuery.fn.jquery}`\n    )\n  }\n\n  if (!hasJquery) await loadScript(jQuerySrc)\n  if (!hasWegpay) await loadScript(iFrameJSsrc)\n}\n\n/**\n * Use this method to trigger the wegpay iframe to load, to get an iframe submitting function and to collect results\n *\n * 1. Calls submitFnGetter that you passed - giving you a submitting function that you can use to submit the iframe\n * 2. Triggers the load of the wegman's iframe in the passed targetDomId\n * 3. Return you a promise that will resolve/reject with the result from Wegpay\n * 4. Once the aforementioned submit function is called and the iframe submits, the returned promise will resolve/reject\n *\n * @param   {string}   targetDomId            - The DOM Id to inject the iframe into\n * @param   {object}   wegpayConfig           - An object containing wegpay config as returned by wegpay themselves\n * @param   {object}   lang                   - An object containing lang strings for wegpay\n * @param   {string}   transactionId          - The transaction Id (unique)\n * @param   {string}   orderId                - The order Id (unique)\n * @param   {boolean}  autoAdjustHeight       - If true, causes the iframe to adjust height automatically\n * @param   {function} submitFnGetter         - A function that is called to pass the submit function, to submit the iframe\n *\n * @return {Promise} callbackPromise           - Resolves to: res\n *  @resolves {Object} callbackPromise --> res    ✔ Response from Wegmans\n *  @rejects  {Error}  callbackPromise --> error  ✘ An error as reported by Wegman's\n */\nexport const showWegpayIframe = (\n  targetDomId,\n  wegpayConfig,\n  lang,\n  transactionId,\n  orderId,\n  autoAdjustHeight,\n  submitFnGetter\n) => {\n  if (typeof window.jQuery === 'undefined' || typeof window.EprotectIframeClient === 'undefined') {\n    // eslint-disable-next-line prefer-promise-reject-errors\n    return Promise.reject(\n      'Missing jQuery and/or Wegpay client js file. Call \"importWegpayDependencies\"!'\n    )\n  }\n\n  let eProtectIframeClient = null\n  let promiseFns = null\n\n  submitFnGetter((isDoSubmit, iframeOpts = null) => {\n    const opts = iframeOpts || {\n      id: transactionId,\n      orderId,\n      pciNonSensitive: false,\n    }\n\n    if (isDoSubmit === false) {\n      return promiseFns && promiseFns.reject(new Error('Add card was cancelled'))\n    }\n\n    eProtectIframeClient.getPaypageRegistrationId(opts)\n  })\n\n  return new Promise((resolve, reject) => {\n    const config = {\n      div: targetDomId,\n      paypageId: wegpayConfig.payPageId,\n      reportGroup: wegpayConfig.payPageReportGroup,\n      showCvv: true,\n      style: wegpayConfig.iFrameStyleSheet,\n      timeout: 15000, // Recommended by Wegpay, 15 seconds\n      htmlTimeout: 60000,\n      numYears: 10, // Expiry needs '20' at the front when using Wegpay 'numYears' option\n      tabIndex: {\n        accountNumber: 1,\n        cvv: 2,\n        expMonth: 3,\n        expYear: 4,\n      },\n      callback: res => (res && res.response === WEGPAY_SUCCESS ? resolve(res) : reject(res)),\n      ...lang,\n      ...(!autoAdjustHeight ? { height: '100%' } : {}),\n    }\n\n    eProtectIframeClient = new window.EprotectIframeClient(config)\n\n    if (autoAdjustHeight) {\n      eProtectIframeClient.autoAdjustHeight()\n    }\n\n    promiseFns = { resolve, reject }\n  }).then(res => {\n    if (!res || !res.paypageRegistrationId) {\n      throw new Error('Wegpay response is missing or missing ext_id (paypageRegistrationId)')\n    }\n\n    return res\n  })\n}\n","import { WEGPAY } from '@app/angular/constants/paymentGateway'\nimport angular from 'angular'\nimport short from 'short-uuid'\nimport promiseable from '@app/utils/promiseable'\nimport { PAYMENT_POLYTYPES } from '@app/angular/constants/payments'\nimport {\n  WEGPAY_ERROR_TYPES,\n  WEGPAY_RETURN_CODES,\n  WEGPAY_MASKS,\n  WEGPAY_CARD_TYPE_CODES,\n} from '@app/angular/constants/wegpay'\nimport { HTTP_ERRORS } from '@app/angular/constants/httpErrors'\nimport { importWegpayDependencies, showWegpayIframe } from './wegpayPaymentService'\nimport wegpayPaymentForm from './wegpayPaymentForm.html'\n\nconst shortUUid = short(short.constants.flickrBase58).generate\n\nconst TARGET_DOM_ID = 'divWegpay'\nconst CREDIT_CARD_TYPE = 'auth_capture'\n\nexport default angular\n  .module('WegpayIntegrationControllerModule', [])\n  .run($templateCache => $templateCache.put('wegpayPaymentForm.html', wegpayPaymentForm))\n  .controller(\n    'WegpayIntegrationController',\n    function (\n      $location,\n      $q,\n      $scope,\n      $timeout,\n      $window,\n      Restangular,\n      WegpayPayment,\n      config,\n      errorModalService,\n      lang,\n      utilService\n    ) {\n      const vm = this\n      const services = {\n        $location,\n        $q,\n        $scope,\n        $timeout,\n        $window,\n        config,\n        errorModalService,\n        lang,\n        Restangular,\n        WegpayPayment,\n        utilService,\n      }\n\n      /**\n       * Initialize basic state\n       */\n      const { disableDelete } = config.wegpay\n      let wegpayConfig = {}\n      let wegpayCallback = null\n      vm.cardName = null\n      vm.cardZip = null\n      vm.cardShouldSave = false\n      vm.showAddInstrument = false\n      vm.showAddInstrumentLoader = false\n      vm.disableDelete = disableDelete\n      vm.paymentInstruments = []\n      vm.paymentInstrument = null\n\n      /**\n       * Define basic methods\n       */\n      const onShowCardForm = vm.onShowCardForm || $scope.$parent.onShowCardForm\n      const notifyNewCreditCardFunction =\n        vm.checkoutNewCreditCard || $scope.$parent.checkoutNewCreditCard\n      const notifyNewCreditCard = val =>\n        notifyNewCreditCardFunction && notifyNewCreditCardFunction(val)\n      const notifyIsShowingAddCard = val =>\n        $scope.toggleIsShowingAddCard && $scope.toggleIsShowingAddCard(val)\n      vm.setCreditCard = () => $scope.doSave && $scope.doSave()\n\n      const getDependencies = promiseable(async () => {\n        wegpayConfig = await Restangular.one('payment')\n          .one('config')\n          .get({ service_type: $scope.paymentContext })\n\n        const { iFrameJavaScript } = wegpayConfig || {}\n\n        if (!iFrameJavaScript) {\n          throw new Error('No iFrameJavaScript url was present - cannot load Wegpay!')\n        }\n\n        await importWegpayDependencies(\n          utilService,\n          wegpayConfig.iFrameJavaScript,\n          WEGPAY.MIN_JQUERY_VERSION,\n          WEGPAY.JQUERY_SRC\n        )\n      })\n\n      /**\n       * Triggers the process to load new cards\n       */\n      vm.loadCards = async () => {\n        let hasInstruments = false\n\n        try {\n          vm.showCardLoader = true\n\n          const { instruments, lastInstrument } = await _processPaymentInstruments(\n            services,\n            vm.paymentInstrument || $scope.payment?.[CREDIT_CARD_TYPE],\n            !vm.paymentInstrument\n          )\n\n          if (instruments.length === 0) {\n            vm.addPaymentInstrument()\n          } else {\n            hasInstruments = true\n            instruments.forEach(instrument => vm.paymentInstruments.push(instrument))\n            $timeout(vm.setCreditCard)\n          }\n\n          vm.paymentInstrument = lastInstrument\n          return instruments\n        } catch (e) {\n          console.error('Could not load card list', e)\n          vm.addPaymentInstrument()\n        } finally {\n          vm.showCardLoader = false\n          if (hasInstruments) {\n            $timeout(vm.setCreditCard)\n          }\n        }\n      }\n\n      /**\n       * Triggers the process to add a card instrument from end to end\n       */\n      vm.addPaymentInstrument = async () => {\n        let isError = false\n        let payload = null\n\n        // Indicate card is being added\n        clearWegpayIframe()\n        vm.showAddInstrument = true\n        vm.showAddInstrumentLoader = true\n        notifyIsShowingAddCard(true)\n\n        try {\n          // Initiate credit card adding process\n          vm.auth_token = await putCreditCardType(services) // Indicate the credit card type \"auth_capture\"\n          await getDependencies() // Ensure that the javascript assets are 100% loaded before continuing\n          const iframePromise = showWegpayIframe(\n            TARGET_DOM_ID,\n            wegpayConfig,\n            lang.values.wegpay,\n            shortUUid(),\n            shortUUid(),\n            false,\n            fn => (wegpayCallback = fn)\n          )\n\n          // Wait for iframe to be submitted\n          if (onShowCardForm) {\n            onShowCardForm()\n          }\n          vm.showAddInstrumentLoader = false\n          const wegPayResponse = await iframePromise\n          vm.showAddInstrumentLoader = true\n\n          // Add new credit card\n          payload = newCreditCardPayload({\n            paymentInfo: wegPayResponse,\n            name: vm.cardName,\n            zip: vm.cardZip,\n            saveOnFile: vm.cardShouldSave,\n          })\n\n          const newCreditCard = await postNewCreditCard(services, payload, vm.cardShouldSave)\n          vm.paymentInstruments.push(newCreditCard)\n          _sortPaymentListById(vm.paymentInstruments)\n          vm.paymentInstrument = newCreditCard\n          WegpayPayment.status.ready = true\n          $timeout(vm.setCreditCard) // Collapse payment section to read only\n        } catch (err) {\n          // If non-validation, will collapse section, otherwise reopen after current digest\n          isError = true\n          const isValidationError = addCardFailed(services, err, payload)\n          if (isValidationError) {\n            $timeout(() => vm.addPaymentInstrument())\n          }\n        } finally {\n          // Clean up of current adding session\n          vm.showAddInstrument = false\n          vm.showAddInstrumentLoader = false\n          notifyNewCreditCard(!isError)\n          notifyIsShowingAddCard(false)\n          clearWegpayIframe()\n\n          if (!isError) {\n            vm.cardName = null\n            vm.cardZip = null\n            vm.cardShouldSave = false\n          }\n        }\n      }\n\n      /**\n       * Called when the add new card button is clicked\n       */\n      vm.submit = () => {\n        if (\n          !vm.cardName ||\n          !WEGPAY_MASKS.cardHolder.test(vm.cardName) ||\n          !vm.cardZip ||\n          !WEGPAY_MASKS.zipCode.test(vm.cardZip)\n        ) {\n          errorModalService.open(lang.values.wegpay.returnCodeLangMap.NAME_OR_ZIP, lang.values.ok)\n          return\n        }\n\n        utilService.blurAndHideKeyboard(true)\n        wegpayCallback() // Set dynamically above by Wegpay (see the addPaymentInstrument function)\n      }\n\n      /**\n       * Called when the cancel new card button is clicked\n       */\n      vm.cancel = () => {\n        vm.showAddInstrument = false\n        vm.showAddInstrumentLoader = false\n        notifyNewCreditCard(false)\n        notifyIsShowingAddCard(false)\n        clearWegpayIframe()\n        utilService.blurAndHideKeyboard(true)\n      }\n\n      /**\n       * Called when the delete link is clicked on a card\n       */\n      vm.deleteCard = async card => {\n        try {\n          // Show confirmation modal\n          await errorModalService.open(\n            `${lang.template(lang.values.deleteCardMessage, {\n              cardName: card.name,\n              cardNumber: card.last_four_digits,\n            })}`,\n            lang.values.confirm,\n            lang.values.cancel,\n            lang.values.deleteCard\n          )\n\n          // Issue delete to server\n          vm.showCardLoader = true\n          if (card.save_on_file !== false) {\n            await Restangular.one('user/payment', card.id).remove({\n              service_type: $scope.paymentContext,\n            })\n          }\n\n          // Remove the card for the payment instruments list\n          const cardIdx = vm.paymentInstruments.findIndex(\n            instrument => instrument.ext_id === card.ext_id\n          )\n\n          if (cardIdx > -1) {\n            vm.paymentInstruments.splice(cardIdx, 1)\n          }\n\n          const lastSelected = vm.paymentInstrument\n          const deletedIsLast = lastSelected && lastSelected.ext_id === card.ext_id\n          $timeout(() => {\n            vm.showCardLoader = false\n            vm.paymentInstrument = deletedIsLast ? vm.paymentInstruments[0] : lastSelected\n          })\n        } catch (e) {\n          console.error('Could not delete card', e)\n          $timeout(() => (vm.showCardLoader = false))\n        }\n      }\n\n      /**\n       * Watches \"paymentInstrument\" and updates \"$scope.payment\" so that the rest of the app knows\n       * which payment method is selected\n       */\n      $scope.$watch(\n        () => vm.paymentInstrument,\n        () => {\n          if ($scope.payment) {\n            $scope.payment[CREDIT_CARD_TYPE] = {\n              payment_instrument: vm.paymentInstrument,\n            }\n          }\n\n          WegpayPayment.status.ready = !!vm.paymentInstrument\n        }\n      )\n\n      /**\n       * Trigger basic state updates\n       */\n      notifyIsShowingAddCard(false)\n      getDependencies().catch(e => console.error('Could not preload dependencies', e))\n      vm.loadCards()\n    }\n  )\n\n/**\n * @public\n * Removes the Wegpay iframe from the DOM\n */\nfunction clearWegpayIframe() {\n  document.getElementById(TARGET_DOM_ID).innerHTML = ''\n}\n\n/**\n * @private\n * Retrieves a list of payment instruments from the server and processes them based on the passed correct state\n *\n * @param {Object} services                - An object of services (must include Restangular)\n * @param {Object} paymentInstrument       - The payment instrument last used (may not be original object!)\n * @param {boolean} initialCall            - Whether this is the initial call, or a subsequent call\n *\n * @return {Promise<{instruments, instrumentId}>}\n */\nasync function _processPaymentInstruments(\n  { $scope, Restangular, WegpayPayment },\n  paymentInstrument,\n  initialCall\n) {\n  const out = { instruments: null, instrumentId: null }\n\n  const response = await Restangular.one('user')\n    .one('payment')\n    .get({ payment_type: CREDIT_CARD_TYPE, service_type: $scope.paymentContext })\n\n  const instruments = response[CREDIT_CARD_TYPE].payment_instruments || []\n\n  Object.assign(out, { instruments })\n\n  const firstInstrument = instruments[0]\n  _sortPaymentListById(instruments)\n\n  const { ext_id: lastExtId } = paymentInstrument || {}\n  const stillExists = instruments.find(({ ext_id }) => ext_id === lastExtId)\n  const notSavedToProfile = initialCall && paymentInstrument && !stillExists\n\n  if (notSavedToProfile) {\n    const { provider } = paymentInstrument\n    paymentInstrument.provider = WEGPAY_CARD_TYPE_CODES[provider] || provider\n    instruments.push(paymentInstrument)\n    out.lastInstrument = paymentInstrument\n  } else {\n    out.lastInstrument = stillExists || firstInstrument\n  }\n\n  // Save paymentInstruments and the state of their `isNew` and `shouldSave` properties for further processing at Order Submit\n  WegpayPayment.paymentInstruments = instruments\n\n  return out\n}\n\n/**\n * @private\n * Sorts a payment list by id\n *\n * @param {Object[]} paymentList   - An array of payment objects\n\n *\n * @return undefined\n */\nfunction _sortPaymentListById(paymentList) {\n  paymentList.sort((a, b) => a.id - b.id)\n}\n\n/**\n * @public\n * Puts the credit card type to the server\n *\n * @param {Object<Restangular, $location>} services   - An object of services that must include Restangular and $location\n *\n * @return {Promise<String>}                          - transaction_setup_id\n */\nasync function putCreditCardType({ $scope, Restangular, $location }) {\n  const response = await Restangular.one('cart')\n    .one('payment')\n    .customPUT({\n      service_type: $scope.paymentContext,\n      payment_type: CREDIT_CARD_TYPE,\n      [CREDIT_CARD_TYPE]: {\n        web_url: `${$location.$$protocol}://${$location.$$host}${\n          $location.$$port ? `:${$location.$$port}` : ''\n        }`,\n      },\n    })\n\n  return response[CREDIT_CARD_TYPE].transaction_setup_id\n}\n\n/**\n * @public\n * Creates a payload object based on all the information, that can later be sent to the API\n *\n * @param {Object} paymentInfo             - An object to be sent for the payment info\n * @param {String} name                    - The card holder name\n * @param {String} zip                     - The zip associated with the card\n * @param {Boolean} saveOnFile             - True to ensure the card is saved on file\n *\n * @return {Object}                        - The structured payload sendable to the API\n */\nfunction newCreditCardPayload({ paymentInfo, name, zip, saveOnFile }) {\n  const {\n    bin,\n    expMonth,\n    expYear,\n    firstSix,\n    id,\n    invokeMerchantCallback,\n    lastFour,\n    message,\n    orderId,\n    paypageRegistrationId,\n    reportGroup,\n    response,\n    responseTime,\n    targetServer,\n    type,\n    vantivTxnId,\n  } = paymentInfo\n\n  return {\n    ext_id: paypageRegistrationId,\n    expiry_date: `20${expYear}-${expMonth}-01`, // Needs '20' at the front when using Wegpay 'numYears' option\n    holder_name: name,\n    last_four_digits: lastFour,\n    polytype: PAYMENT_POLYTYPES.CREDIT_CARD,\n    postal_code: zip,\n    provider: type,\n    ext_data: {\n      save_on_file: saveOnFile,\n      uiGenerated: {\n        id,\n        orderId,\n      },\n      wegpayBin: bin,\n      // Wegpay sometimes returns bin as the string 'undef', which is truthy.\n      bin: bin && bin !== 'undef' ? bin : firstSix,\n      firstSix,\n      invokeMerchantCallback,\n      message,\n      reportGroup,\n      response,\n      responseTime,\n      targetServer,\n      type,\n      vantivTxnId,\n    },\n  }\n}\n\n/**\n * @public\n * Post the new credit card to the API\n *\n * @param {Object<Restangular>} services   - An object of services that must include Restangular\n * @param {Object} payload                 - An object to be sent for the payment info\n * @param {Boolean} saveOnFile             - Wether to save the card on file or not (used to know if a card id deleteable)\n *\n * @return {Promise<String>}                          - transaction_setup_id\n */\nasync function postNewCreditCard({ $scope, Restangular }, payload, saveOnFile) {\n  const newCardResponse = await Restangular.one('user')\n    .one('payment')\n    .customPOST({\n      ...payload,\n      service_type: $scope.paymentContext,\n    })\n\n  const newCreditCard = newCardResponse.plain()\n  const { provider } = newCreditCard\n  newCreditCard.provider = WEGPAY_CARD_TYPE_CODES[provider] || provider\n  newCreditCard.save_on_file = saveOnFile\n\n  return newCreditCard\n}\n\n/**\n * @public\n * Called when a credit card fails to add\n *\n * @param {Object} services                           - An object of services that must include Restangular and $location\n * @param {Error} err                                 - The error that caused the failed card add\n * @param {Object | null} [payload]                   - OPTIONAL: A payload associated in causing the error\n *\n * @return {boolean}                                  - true if the error was only validation, false if it was unrecoverable\n */\nfunction addCardFailed({ errorModalService, lang }, err, payload = null) {\n  let errorType = null\n  let message = lang.values.wegpay.defaultErrorMessage\n\n  // eslint-disable-next-line no-restricted-globals, radix\n  if (!isNaN(parseInt(err.response))) {\n    errorType = WEGPAY_RETURN_CODES[err.response]\n\n    if (errorType) {\n      message =\n        lang.values.wegpay.returnCodeLangMap[errorType] || lang.values.wegpay.defaultErrorMessage\n    }\n  }\n\n  if (err.status === HTTP_ERRORS.TOO_MANY_REQUESTS) {\n    message = lang.values.tooManyRetriesError\n  }\n\n  console.error('Add new card could not complete', err)\n  if (payload) console.error('(Associated request CC payload)', payload)\n\n  errorModalService.open(message, lang.values.ok)\n  return errorType === WEGPAY_ERROR_TYPES.VALIDATION\n}\n","import angular from 'angular'\nimport WegpayController from './wegpayIntegrationController.js'\nimport WegpayService from './wegpayPaymentService.js'\n\nexport default angular.module('app.optionalComponents.Wegpay', [\n  WegpayController.name,\n  WegpayService.name,\n])\n","/* eslint-disable no-console */\n\nimport angular from 'angular'\n\n/*\n * See here for new checkout integration status:\n * https://instacart.atlassian.net/wiki/spaces/ENG/pages/995098979/Payment+Providers+and+new+checkout+styling\n */\nimport Authorize from './authorize.net'\nimport Braintree from './braintree'\nimport FirstData from './firstData/v1'\nimport FirstDataV2 from './firstData/v2'\nimport Gigya from './gigya'\nimport Stripe from './stripe'\nimport Vantiv from './vantiv'\nimport Wegpay from './wegpay'\n\nimport { getBuildConfig } from '../../rootConfig'\n\nconst OPTIONAL_COMPONENTS = {\n  Authorize: Authorize.name,\n  Braintree: Braintree.name,\n  FirstData: FirstData.name,\n  FirstDataV2: FirstDataV2.name,\n  Gigya: Gigya.name,\n  Stripe: Stripe.name,\n  Vantiv: Vantiv.name,\n  Wegpay: Wegpay.name,\n}\n\nconst FEATURE_SUPPORT = {\n  Authorize: {},\n  Braintree: {},\n  FirstData: {},\n  FirstDataV2: {},\n  Gigya: {},\n  Stripe: {},\n  Vantiv: { googleRecaptcha: true },\n  Wegpay: {},\n}\n\nconst buildConfig = getBuildConfig()\n\nconst exportableModules = buildConfig.optionalComponents\n  .map(name => OPTIONAL_COMPONENTS[name])\n  .filter(Boolean)\n\nconst foundPaymentFeatureMaps = buildConfig.optionalComponents\n  .map(name => FEATURE_SUPPORT[name])\n  .filter(Boolean)\n\nexport default angular.module('app.optionalComponents', exportableModules).run(config => {\n  const optionalComponents = config.optionalComponents || []\n  const original = buildConfig.optionalComponents || []\n\n  if (optionalComponents.join(',') !== original.join(',')) {\n    _grabAttentionInConsole(`\n      DO NOT USE \"optionalComponents\" IN THE DASHBOARD - IT WILL NOT WORK!\n    `)\n  }\n\n  if (\n    config.googleRecaptcha?.paymentsEnabled &&\n    !foundPaymentFeatureMaps.every(featureMap => Boolean(featureMap.googleRecaptcha))\n  ) {\n    _grabAttentionInConsole(`\n      GOOGLE RECAPTCHA IS SWITCHED ON FOR PAYMENTS BUT NOT ALL PAYMENT\n      PROVIDERS LISTED IN \"optionalComponents\" SUPPORT RECAPTCHA!️\n    `)\n  }\n})\n\nfunction _grabAttentionInConsole(errorMessage) {\n  console.log('%cSTOP:', '-webkit-text-stroke: 2px red; color: black; font-size: 50px;')\n  console.log(`%c${errorMessage}`, 'color: red; font-size: 14px;')\n}\n","export default ['onContinue', 'onClose']\n","import React from 'react'\nimport { CSSObject } from '@emotion/core'\nimport { LoadingDots } from '@instacart/cocktail'\n\nexport interface Props {\n  color?: string\n  height?: number | string\n  inline?: boolean\n}\n\nconst container = ({ height, inline }: Pick<Props, 'height' | 'inline'>): CSSObject => ({\n  alignItems: 'center',\n  display: inline ? 'inline-flex' : 'flex',\n  height: height ?? '100%',\n  justifyContent: 'center',\n  minHeight: '1.5em',\n  opacity: '0.5',\n})\n\nconst LazyLoadingIndicator = ({ color, height, inline }: Props) => (\n  <LoadingDots css={container({ height, inline })} dotColor={color ?? 'currentColor'} />\n)\n\nexport default LazyLoadingIndicator\n","import React from 'react'\n\n/*\n * HOC - ngIgnore\n * This is a custom HOC to wrap all components implemented in angular.\n * It removes the text \"ng-ignore\" from all props.\n * This is required to work around the issue of prop names being treated as direcdtives.\n * Usage:\n *   Angular - <react-component ng-ignore-on-click={...} />\n *   React - <react-component onClick={...} />\n */\n\n// eslint-disable-next-line no-unused-vars\nconst ngIgnore = BaseComponent => {\n  // eslint-disable-next-line react/prefer-stateless-function\n  class HOC extends React.Component {\n    render() {\n      const filteredProps = this.props\n\n      const newProps = Object.keys(filteredProps).reduce((acc, key) => {\n        let newKey = key.match(/^ngIgnore/i) ? key.replace(/^ngIgnore/i, '') : key\n        newKey = newKey.charAt(0).toLowerCase() + newKey.slice(1)\n\n        return {\n          ...acc,\n          [newKey]: filteredProps[key],\n        }\n      }, {})\n\n      return <BaseComponent {...newProps} />\n    }\n  }\n\n  return HOC\n}\n\nexport default ngIgnore\n","import React, { ComponentType, Suspense } from 'react'\nimport { DeepPartial } from 'utility-types'\nimport { Tokens } from '@instacart/cocktail-design-tokens/tokens'\nimport { ErrorBoundary } from '@instacart/enterprise-ui-common'\nimport AppProvider from '@app/react/AppProvider'\nimport LazyLoadingIndicator, {\n  Props as LazyLoadingIndicatorProps,\n} from './lazyLoadingIndicator/LazyLoadingIndicator'\nimport ngIgnore from './ngIgnore'\n\ntype Component = ComponentType<{\n  $document: [Document]\n  theme: DeepPartial<Tokens>\n}>\n\nconst reactWrapper = (\n  BaseComponent: ComponentType,\n  indicatorProps?: LazyLoadingIndicatorProps\n): Component => {\n  const Component = ngIgnore(BaseComponent)\n  return ({ $document, theme, ...rest }) => (\n    <AppProvider document={$document[0]} tokens={theme}>\n      <ErrorBoundary fallback={<span className=\"icon-error\" aria-hidden=\"true\" />}>\n        <Suspense fallback={<LazyLoadingIndicator {...indicatorProps} />}>\n          <Component {...rest} />\n        </Suspense>\n      </ErrorBoundary>\n    </AppProvider>\n  )\n}\n\nexport default reactWrapper\n","import angular from 'angular'\nimport { react2angular } from 'react2angular'\nimport { lazy } from 'react'\n\n/*\n * React Component Props\n *\n * Each component should define an array of prop names that correspond with the\n * react component's props. ex. ['onClick', 'variant', 'size']\n *\n * For organization, each props mapping should be in a separate file.\n *\n * Example:\n * import ProductCellProps from './productCell';\n */\nimport ProductRatingProps from './productRating'\nimport CheckboxProps from './checkbox'\nimport ImageTileProps from './imageTile'\nimport UserReviewsProps from './userReviews'\nimport AddToCartButtonProps from './addToCartButton'\nimport ProductCellProps from './productCell'\nimport NutritionProps from './nutrition'\nimport ProductPriceProps from './productPrice'\nimport CartLoyaltyBalanceProps, { CartLoyaltyBalanceDefaultProps } from './cartLoyaltyBalance'\nimport SubscriptionCheckoutProps from './subscriptionCheckout'\nimport CartCheckoutSubscriptionSelectProps from './cartCheckoutSubscriptionSelect'\nimport SubscriptionPageProps from './subscriptionPage'\nimport TimeSlotsProps from './timeSlots'\nimport ErrorWindowProps from './errorWindow'\nimport LoyaltyBarcodeProps from './loyaltyBarcode'\nimport ProfilePageProps from './profilePage'\nimport AccountImportModalProps from './accountImportModal'\nimport AccountImportSuccessModalProps from './accountImportSuccessModal'\nimport AccountImportErrorModalProps from './accountImportErrorModal'\nimport ContextSelectorProps from './contextSelector'\nimport UserMenuProps from './userMenu'\nimport UserMenuLinksProps from './userMenuLinks'\nimport CartButtonProps from './cartButton'\nimport CartIconButtonProps from './cartIconButton'\nimport OrderTrackProps from './orderTrack'\nimport OrderTotalsProps from './orderTotals'\nimport AddressAutocompleteProps from './addressAutocomplete'\nimport PricingDisclosureProps from './pricingDisclosure'\nimport {\n  ExpressPlanModalProps,\n  ExpressPlansProps,\n  ExpressSignupModalProps,\n  ExpressGiftCardRedeemModalProps,\n  ExpressPoweredByProps,\n  ExpressFooterProps,\n  ExpressCountDownProps,\n  ExpressPromoPlanChangeProps,\n  ExpressPromoPlanChangeModalProps,\n  MobileMenuWithExpressPopoverProps,\n} from './icExpress'\nimport RxUpsellModalProps from './rxUpsellModal'\nimport RxRedirectErrorModalProps from './rxRedirectErrorModal'\nimport FulfillmentNotAvailableModalProps from './fullfillmentNotAvailableModal'\nimport ItemTileProps from './itemTile'\nimport PolicyModalProps from './policyModal'\nimport HomepageBannersProps from './homepageBanners'\nimport ProductUnavailableDisclaimerProps from './productUnavailableDisclaimer'\nimport FulfillmentBannerProps from './fulfillmentBanner'\nimport MiniCartListProps from './miniCartList'\nimport ProductCollectionProps from './productCollection'\nimport IwsRegulationAlertModalProps from './iwsRegulationAlertModal'\nimport ProductImageCarouselProps from './ProductImageCarousel'\n\n/**\n * reactWrapper helper to provide design tokens to React components\n */\nimport reactWrapper from './reactWrapper'\n\n/*\n * React Component Imports\n *\n * Import your React components from Cocktail, etc here.\n */\n/* eslint-disable import/order */\nimport Checkbox from '@instacart/cocktail/deprecated/Checkbox'\nimport { CartButton, CartIconButton } from '@instacart/enterprise-cart-button'\nimport { ContextSelector } from '@instacart/enterprise-context-selector'\nimport LazyLoadingIndicator from './lazyLoadingIndicator/LazyLoadingIndicator'\n/* eslint-enable import/order */\n\nconst ProductRating = lazy(async () => {\n  const { RatingWithCount } = await import('@instacart/enterprise-user-reviews')\n  return { default: RatingWithCount }\n})\n\nconst ImageTile = lazy(async () => {\n  const { ImageTile } = await import('@instacart/enterprise-ui-image-tile')\n  return { default: ImageTile }\n})\n\nconst AddToCartButton = lazy(() => import('@instacart/enterprise-ui-add-button'))\n\nconst UserReviews = lazy(async () => {\n  const { App } = await import('@instacart/enterprise-user-reviews')\n  return { default: App }\n})\n\nconst Nutrition = lazy(() => import('@instacart/enterprise-ui-nutrition'))\n\nconst ProductPrice = lazy(async () => {\n  const { ProductPrice } = await import('@instacart/enterprise-ui-product-price')\n  return { default: ProductPrice }\n})\n\nconst CartLoyaltyBalance = lazy(async () => {\n  const { CartRewardsTile } = await import('@instacart/enterprise-cart-checkout')\n  return { default: CartRewardsTile }\n})\n\nconst CartCheckoutSubscriptionSelect = lazy(async () => {\n  const { CartCheckoutSubscriptionSelect } = await import(\n    '@instacart/enterprise-subscription-checkout'\n  )\n  return { default: CartCheckoutSubscriptionSelect }\n})\n\nconst ProductCell = lazy(async () => {\n  const { ProductCell } = await import('@instacart/enterprise-product-cell')\n  return { default: ProductCell }\n})\n\nconst SubscriptionPage = lazy(async () => {\n  const { SubscriptionPage } = await import('@instacart/enterprise-account-pages')\n  return { default: SubscriptionPage }\n})\n\nconst LoyaltyBarcode = lazy(async () => {\n  const { LoyaltyBarcode } = await import('@instacart/enterprise-loyalty-barcode')\n  return { default: LoyaltyBarcode }\n})\n\nconst LoyaltyTransactions = lazy(async () => {\n  const { LoyaltyTransactions } = await import('@instacart/enterprise-account-pages')\n  return { default: LoyaltyTransactions }\n})\n\nconst SubscriptionCheckout = lazy(() => import('@instacart/enterprise-subscription-checkout'))\n\nconst TimeSlots = lazy(async () => {\n  const { TimeSlots } = await import('@instacart/enterprise-timeslots')\n  return { default: TimeSlots }\n})\n\nconst ErrorWindow = lazy(() => import('@instacart/enterprise-ui-error-window'))\n\nconst ProfilePage = lazy(async () => {\n  const { ProfilePage } = await import('@instacart/enterprise-account-pages')\n  return { default: ProfilePage }\n})\n\nconst AccountImportModal = lazy(async () => {\n  const { AccountImportModal } = await import('@instacart/enterprise-account-import')\n  return { default: AccountImportModal }\n})\n\nconst AccountImportSuccessModal = lazy(async () => {\n  const { AccountImportSuccessModal } = await import('@instacart/enterprise-account-import')\n  return { default: AccountImportSuccessModal }\n})\n\nconst AccountImportErrorModal = lazy(async () => {\n  const { AccountImportErrorModal } = await import('@instacart/enterprise-account-import')\n  return { default: AccountImportErrorModal }\n})\n\nconst UserMenu = lazy(async () => {\n  const { UserMenu } = await import('@instacart/enterprise-user-menu')\n  return { default: UserMenu }\n})\n\nconst UserMenuLinks = lazy(async () => {\n  const { UserMenuLinks } = await import('@instacart/enterprise-user-menu')\n  return { default: UserMenuLinks }\n})\n\nconst MobileListNav = lazy(() => import('@app/react/components/mobileListNav/MobileListNav'))\n\nconst OrderTrack = lazy(() => import('@instacart/enterprise-order-tracking'))\n\nconst OrderTotals = lazy(() => import('@instacart/enterprise-ui-order-totals'))\n\nconst AddressAutocomplete = lazy(async () => {\n  const { AddressAutocomplete } = await import('@instacart/enterprise-ui-address-autocomplete')\n  return { default: AddressAutocomplete }\n})\n\nconst ExpressPlanModal = lazy(() => import('@app/react/components/icExpress/ExpressPlanModal'))\nconst ExpressPlans = lazy(() => import('@app/react/components/icExpress/ExpressPlans'))\nconst ExpressSignupModal = lazy(() => import('@app/react/components/icExpress/ExpressSignupModal'))\nconst ExpressGiftCardRedeemModal = lazy(() =>\n  import('@app/react/components/icExpress/ExpressGiftCardRedeemModal/ExpressGiftCardRedeemModal')\n)\nconst ExpressPoweredBy = lazy(() => import('@app/react/components/icExpress/ExpressPoweredBy'))\nconst ExpressFooter = lazy(() => import('@app/react/components/icExpress/ExpressFooter'))\nconst ExpressCountDown = lazy(() =>\n  import('@app/react/components/icExpress/ExpressCountDown/ExpressCountDown')\n)\nconst ExpressPromoPlanChange = lazy(() =>\n  import('@app/react/components/icExpress/ExpressPromoPlanChange/ExpressPromoPlanChange')\n)\n\nconst ExpressPromoPlanChangeModal = lazy(() =>\n  import('@app/react/components/icExpress/ExpressPromoPlanChange/ExpressPromoPlanChangeModal')\n)\n\nconst MobileMenuWithExpressPopover = lazy(() =>\n  import('@app/react/components/icExpress/MobileMenuWithExpressPopover')\n)\n\nconst RxRedirectErrorModal = lazy(() =>\n  import('@app/react/components/rxRedirectErrorModal/RxRedirectErrorModal')\n)\n\nconst RxUpsellModal = lazy(() => import('@app/react/components/rxUpsellModal/RxUpsellModal'))\n\nconst FulfillmentNotAvailableModal = lazy(() =>\n  import('@app/react/components/fulfillmentNotAvailableModal/FulfillmentNotAvailableModal')\n)\n\nconst ItemTile = lazy(async () => {\n  const { ItemTileContainer } = await import(\n    '@app/react/components/itemTileContainer/ItemTileContainer'\n  )\n  return { default: ItemTileContainer }\n})\n\nconst PolicyModal = lazy(() => import('@app/react/components/policyModal/PolicyModal'))\n\nconst HeroBanner = lazy(() => import('@app/react/components/heroBanner/HeroBanner'))\nconst HomepageBanners = lazy(() => import('@app/react/components/homepageBanners/HomepageBanners'))\nconst PricingDisclosure = lazy(() => import('@app/react/components/pdp/PricingDisclosure'))\n\nconst ProductUnavailableDisclaimer = lazy(() =>\n  import('@app/react/components/productDetailsPage/ProductUnavailableDisclaimer')\n)\n\nconst FulfillmentBanner = lazy(() =>\n  import('@app/react/components/multipleBanners/FulfillmentBanner')\n)\n\nconst ProductCollection = lazy(() => import('@app/react/common/collection/ProductCollection'))\n\nconst IwsRegulationAlertModal = lazy(() =>\n  import('@app/react/components/iwsRegulationAlertModal/IwsRegulationAlertModal')\n)\n\nconst MiniCartList = lazy(() => import('@app/react/components/miniCart/MiniCartList'))\nconst QuickLinks = lazy(() => import('@app/react/components/quickLinks/QuickLinks'))\n\nconst ProductImageCarousel = lazy(async () => {\n  const { ProductImageCarousel } = await import(\n    '@app/react/ids/enterprise/molecules/ProductImageCarousel'\n  )\n  return { default: ProductImageCarousel }\n})\n\nconst dependencies = ['$document', 'theme']\n\n/**\n * Define all react2angular components here.\n * Prefix with `react` to avoid conflicts.\n *\n * Example:\n * .component('reactProductCell', react2angular(ProductCell, ProductCellProps));\n *\n * Usage:\n * <react-product-cell on-click=\"$scope.onClick\" />\n *\n * Note:\n * - React components are PascalCase,\n * - Angular components (including props) are kebab-case\n */\nexport default angular\n  .module('app.component.reactComponents', [])\n  .component(\n    'reactRating',\n    react2angular(reactWrapper(ProductRating), ProductRatingProps, dependencies)\n  )\n  .component('reactCheckbox', react2angular(reactWrapper(Checkbox), CheckboxProps, dependencies))\n  .component('reactImageTile', react2angular(reactWrapper(ImageTile), ImageTileProps, dependencies))\n  .component(\n    'reactAddToCartButton',\n    react2angular(reactWrapper(AddToCartButton), AddToCartButtonProps, dependencies)\n  )\n  .component(\n    'reactUserReviews',\n    react2angular(reactWrapper(UserReviews), UserReviewsProps, dependencies)\n  )\n  .component('reactNutrition', react2angular(reactWrapper(Nutrition), NutritionProps, dependencies))\n  .component(\n    'reactProductPrice',\n    react2angular(reactWrapper(ProductPrice), ProductPriceProps, dependencies)\n  )\n  .component(\n    'reactCartLoyaltyBalance',\n    react2angular(reactWrapper(CartLoyaltyBalance), CartLoyaltyBalanceProps, dependencies)\n  )\n  .component(\n    'reactCartCheckoutSubscriptionSelect',\n    react2angular(\n      reactWrapper(CartCheckoutSubscriptionSelect),\n      CartCheckoutSubscriptionSelectProps,\n      dependencies\n    )\n  )\n  .component(\n    'reactProductCell',\n    react2angular(reactWrapper(ProductCell), ProductCellProps, dependencies)\n  )\n  .component(\n    'reactPricingDisclosure',\n    react2angular(reactWrapper(PricingDisclosure), PricingDisclosureProps, dependencies)\n  )\n  .component(\n    'reactSubscriptionPage',\n    react2angular(reactWrapper(SubscriptionPage), SubscriptionPageProps, dependencies)\n  )\n  .component(\n    'reactLoyaltyBarcode',\n    react2angular(reactWrapper(LoyaltyBarcode), LoyaltyBarcodeProps, dependencies)\n  )\n  .component(\n    'reactLoyaltyTransactions',\n    react2angular(reactWrapper(LoyaltyTransactions), [], dependencies)\n  )\n  .factory('reactCartLoyaltyBalanceDefaultProps', CartLoyaltyBalanceDefaultProps)\n  .component(\n    'reactSubscriptionCheckout',\n    react2angular(reactWrapper(SubscriptionCheckout), SubscriptionCheckoutProps, dependencies)\n  )\n  .component('reactTimeSlots', react2angular(reactWrapper(TimeSlots), TimeSlotsProps, dependencies))\n  .component(\n    'reactErrorWindow',\n    react2angular(reactWrapper(ErrorWindow), ErrorWindowProps, dependencies)\n  )\n  .component(\n    'reactProfilePage',\n    react2angular(reactWrapper(ProfilePage), ProfilePageProps, dependencies)\n  )\n  .component(\n    'reactAccountImportModal',\n    react2angular(reactWrapper(AccountImportModal), AccountImportModalProps, dependencies)\n  )\n  .component(\n    'reactAccountImportSuccessModal',\n    react2angular(\n      reactWrapper(AccountImportSuccessModal),\n      AccountImportSuccessModalProps,\n      dependencies\n    )\n  )\n  .component(\n    'reactAccountImportErrorModal',\n    react2angular(reactWrapper(AccountImportErrorModal), AccountImportErrorModalProps, dependencies)\n  )\n  .component('reactUserMenu', react2angular(reactWrapper(UserMenu), UserMenuProps, dependencies))\n  .component(\n    'reactUserMenuLinks',\n    react2angular(reactWrapper(UserMenuLinks), UserMenuLinksProps, dependencies)\n  )\n  .component('reactMobileListNav', react2angular(reactWrapper(MobileListNav), [], dependencies))\n  .component(\n    'reactCartButton',\n    react2angular(reactWrapper(CartButton, { inline: true }), CartButtonProps, dependencies)\n  )\n  .component(\n    'reactCartIconButton',\n    react2angular(reactWrapper(CartIconButton), CartIconButtonProps, dependencies)\n  )\n  .component(\n    'reactContextSelector',\n    react2angular(reactWrapper(ContextSelector), ContextSelectorProps, dependencies)\n  )\n  .component(\n    'reactOrderTrack',\n    react2angular(reactWrapper(OrderTrack), OrderTrackProps, dependencies)\n  )\n  .component(\n    'reactOrderTotals',\n    react2angular(reactWrapper(OrderTotals), OrderTotalsProps, dependencies)\n  )\n  .component(\n    'reactAddressAutocomplete',\n    react2angular(reactWrapper(AddressAutocomplete), AddressAutocompleteProps, dependencies)\n  )\n  .component('reactLazyLoadingIndicator', react2angular(reactWrapper(LazyLoadingIndicator)))\n  .component(\n    'reactExpressPlanModal',\n    react2angular(reactWrapper(ExpressPlanModal), ExpressPlanModalProps, dependencies)\n  )\n  .component(\n    'reactExpressPlans',\n    react2angular(reactWrapper(ExpressPlans), ExpressPlansProps, dependencies)\n  )\n  .component(\n    'reactExpressSignupModal',\n    react2angular(reactWrapper(ExpressSignupModal), ExpressSignupModalProps, dependencies)\n  )\n  .component(\n    'reactExpressPoweredBy',\n    react2angular(reactWrapper(ExpressPoweredBy), ExpressPoweredByProps, dependencies)\n  )\n  .component(\n    'reactExpressFooter',\n    react2angular(reactWrapper(ExpressFooter), ExpressFooterProps, dependencies)\n  )\n  .component(\n    'reactExpressCountDown',\n    react2angular(reactWrapper(ExpressCountDown), ExpressCountDownProps, dependencies)\n  )\n  .component(\n    'reactMobileMenuWithExpressPopover',\n    react2angular(\n      reactWrapper(MobileMenuWithExpressPopover),\n      MobileMenuWithExpressPopoverProps,\n      dependencies\n    )\n  )\n\n  .component(\n    'reactExpressGiftCardRedeemModal',\n    react2angular(\n      reactWrapper(ExpressGiftCardRedeemModal),\n      ExpressGiftCardRedeemModalProps,\n      dependencies\n    )\n  )\n  .component(\n    'reactExpressPromoPlanChange',\n    react2angular(reactWrapper(ExpressPromoPlanChange), ExpressPromoPlanChangeProps, dependencies)\n  )\n  .component(\n    'reactExpressPromoPlanChangeModal',\n    react2angular(\n      reactWrapper(ExpressPromoPlanChangeModal),\n      ExpressPromoPlanChangeModalProps,\n      dependencies\n    )\n  )\n  .component(\n    'reactRxUpsellModal',\n    react2angular(reactWrapper(RxUpsellModal), RxUpsellModalProps, dependencies)\n  )\n  .component(\n    'reactFulfillmentNotAvailableModal',\n    react2angular(\n      reactWrapper(FulfillmentNotAvailableModal),\n      FulfillmentNotAvailableModalProps,\n      dependencies\n    )\n  )\n  .component(\n    'reactPolicyModal',\n    react2angular(reactWrapper(PolicyModal), PolicyModalProps, dependencies)\n  )\n\n  .component('reactItemTile', react2angular(reactWrapper(ItemTile), ItemTileProps, dependencies))\n\n  .component(\n    'reactRxRedirectErrorModal',\n    react2angular(reactWrapper(RxRedirectErrorModal), RxRedirectErrorModalProps, dependencies)\n  )\n  .component(\n    'reactHomepageBanners',\n    react2angular(reactWrapper(HomepageBanners), HomepageBannersProps, dependencies)\n  )\n  .component(\n    'reactProductUnavailableDisclaimer',\n    react2angular(\n      reactWrapper(ProductUnavailableDisclaimer),\n      ProductUnavailableDisclaimerProps,\n      dependencies\n    )\n  )\n  .component(\n    'reactFulfillmentBanner',\n    react2angular(reactWrapper(FulfillmentBanner), FulfillmentBannerProps, dependencies)\n  )\n  .component(\n    'reactMiniCartList',\n    react2angular(reactWrapper(MiniCartList), MiniCartListProps, dependencies)\n  )\n  .component(\n    'reactProductCollection',\n    react2angular(reactWrapper(ProductCollection), ProductCollectionProps, dependencies)\n  )\n  .component(\n    'reactIwsRegulationAlertModal',\n    react2angular(reactWrapper(IwsRegulationAlertModal), IwsRegulationAlertModalProps, dependencies)\n  )\n  .component(\n    'reactProductImageCarousel',\n    react2angular(reactWrapper(ProductImageCarousel), ProductImageCarouselProps, dependencies)\n  )\n  .component('reactHeroBanner', react2angular(reactWrapper(HeroBanner), [], dependencies))\n  .component('reactQuickLinks', react2angular(reactWrapper(QuickLinks), [], dependencies))\n","export default [\n  'enableActive',\n  'ratingCount',\n  'rating',\n  'labelStyles',\n  'iconSize',\n  'showAverage',\n  'styles',\n  'clickable',\n]\n","/* This should be an array of prop names that match\n * with the react Checkbox component props.\n */\n\nexport default ['checked', 'id', 'labelText', 'onChange', 'onClick', 'icon', 'size', 'styles']\n","/* This should be an array of prop names that match\n * with the react Checkbox component props.\n */\n\nexport default [\n  'border',\n  'children',\n  'fixedContent',\n  'imageGutter',\n  'height',\n  'images',\n  'link',\n  'style',\n  'imageTileTitle',\n]\n","/* This should be an array of prop names that match\n * with the react Checkbox component props.\n */\n\nexport default [\n  'placeholder',\n  'children',\n  'active',\n  'disabled',\n  'addIcon',\n  'onAdd',\n  'showAdd',\n  'removeIcon',\n  'onRemove',\n  'showRemove',\n  'items',\n  'onDropDownSelect',\n  'fullWidth',\n  'variant',\n  'size',\n  'styles',\n  'labelButtonProps',\n  'color',\n  'themeVariant',\n]\n","export default [\n  'entityId',\n  'entityExtId',\n  'onTermsClick',\n  'onShowAllClick',\n  'baseUrl',\n  'user',\n  'sessionToken',\n  'perPage',\n  'showPaging',\n  'onLoginRequired',\n  'reviewType',\n]\n","export default [\n  'amount',\n  'perContainer',\n  'fields',\n  'secondaryFields',\n  'nutritionDisclaimer',\n  'footnote',\n  'fullWidth',\n  'i18n',\n]\n","export default [\n  'i18n',\n  'inline',\n  'label',\n  'loyaltyPricingEnabled',\n  'hasLoyaltyCard',\n  'loyaltyIcon',\n  'unitPrice',\n  'styles',\n  'product',\n  'showUom',\n  'showEbtLabel',\n  'salePriceOverride',\n]\n","/* This should be an array of prop names that match\n * with the react cartLoyaltyBalance component props.\n */\n\nexport default ['titleText', 'value', 'content', 'styles']\nexport { default as CartLoyaltyBalanceDefaultProps } from './defaultProps'\n","/* This should be an array of prop names that match\n * with the react subscriptionCheckout component props.\n */\n\nexport default [\n  'config',\n  'i18n',\n  'styles',\n  'subscriptions',\n  'cartItems',\n  'onSubscriptionSelected',\n  'isDisabled',\n  'userSubscription',\n]\n","/* This should be an array of prop names that match\n * with the react component props.\n *\n * EXAMPLE - ['onClick', 'variant', 'size']\n */\n\nexport default [\n  /** Add to cart */\n  'addToCart',\n  'ngIgnoreAddToCart',\n  /** Aisle */\n  'aisle',\n  /** User logged in status */\n  'isLoggedIn',\n  /** Hide border */\n  'noBorder',\n  /** Hide shadow */\n  'noShadow',\n  /** Offer badge */\n  'offerBadge',\n  /** Price */\n  'price',\n  /** Price Alert */\n  'priceAlert',\n  'ngIgnorePriceAlert',\n  /** Product data */\n  'product',\n  /** Rating */\n  'rating',\n  /** Related product */\n  'relatedProduct',\n  /** Sales tag */\n  'salesTag',\n  /** Save for later list */\n  'saveForLaterList',\n  /** Tags */\n  'tags',\n  /** Unit size */\n  'unitSize',\n  /** Product cell style to display */\n  'variant',\n]\n","/* This should be an array of prop names that match\n * with the react component props.\n *\n * EXAMPLE - ['onClick', 'variant', 'size']\n */\n\nexport default ['basePrice', 'uomPrice', 'uom', 'averageWeight']\n","export default [\n  'onAddSubscriptionPlanClick',\n  'initialSubscriptionCode',\n  'onRedeemSubscriptionSuccess',\n]\n","/* This should be an array of prop names that match\n * with the react LoyaltyBarcode component props.\n */\n\nexport default ['card', 'useBarcodeNumberLabel']\n","export default [\n  'lang',\n  'userService',\n  (lang, userService) => {\n    return {\n      title: lang.values.loyaltyCartTitle,\n      content: lang.values.loyaltyCartMessage,\n      getValue: () =>\n        lang.templateAsString(lang.values.loyaltyPointsDisplayFormat, {\n          loyaltyPoints: userService.getLoyaltyCard().points_balance,\n        }),\n    }\n  },\n]\n","/* This should be an array of prop names that match\n * with the react subscriptionCheckout component props.\n */\n\nexport default [\n  'styles',\n  'isPurchasable',\n  'onContinueClicked',\n  'assetLoadingFunction',\n  'onStateChange',\n  'route',\n\n  // Payment related props\n  'cards',\n  'initialSelectedCardExtId',\n  'isAddNewCard',\n  'isIframeLoading',\n  'onBuySubscriptionClicked',\n  'onGiftSubscriptionClicked',\n  'onSelectionComplete',\n  'onAddNewCard',\n  'onDeleteCard',\n  'onPaymentIframeRendered',\n  'onPurchaseComplete',\n  'onSelectCard',\n  'onUpdateCard',\n  'selectedCardExtId',\n  'showSaveCardToggle',\n]\n","export default [\n  'timeSlots',\n  'onTimeSlotSelected',\n  'selectedTimeSlot',\n  'i18n',\n  'error',\n  'readOnly',\n  'onDaySelected',\n  'onWeekChanged',\n  'onGoToCart',\n  'alwaysShowAvailabilityCheckbox',\n  'availabilityCheckboxThreshold',\n  'isLoading',\n  'hasRxItem',\n]\n","/* This should be an array of prop names that match\n * with the react ErrorWindow component props.\n */\n\nexport default [\n  'errorTitle',\n  'body',\n  'primaryButtonContent',\n  'secondaryButtonContent',\n  'tertiaryButtonContent',\n  'onClickPrimaryButton',\n  'onClickSecondaryButton',\n  'onClickTertiaryButton',\n  'requestId',\n  'styles',\n  'buttonAlignment',\n  'buttonDirection',\n]\n","export default ['disconnectSocial', 'importIcAccount']\n","export default ['onImportClick', 'cancel']\n","export default ['close']\n","export default ['goToAccount', 'close']\n","export default [\n  'icExpressService',\n  'icExpressIconSrc',\n  'styles',\n  'menuAlign',\n  'contentAlign',\n  'imageBefore',\n  'iconBefore',\n  'onLoginClick',\n  'onItemClick',\n  'loadImage',\n]\n","export default ['icExpressService', 'styles', 'showIcons', 'showLogout', 'onItemClick']\n","export default ['isLoading', 'onClick']\n","export default ['size', 'onClick']\n","export default [\n  'reservationTimeslotButtonContent',\n  'bannerImageUrl',\n  'onContextButtonClick',\n  'showSideTriangle',\n  'isDisabled',\n]\n","/* This should be an array of prop names that match\n * with the react OrderTrack and child component props.\n */\nexport default [\n  'buttonSize',\n  'enableOrderDetailButton',\n  'enablePickupDetailButton',\n  'enableModifyButton',\n  'enableCancelButton',\n  'enableTipsRatingButton',\n  'initialOrderStatus',\n  'orderId',\n  'onOrderDetail',\n  'onPickupDetail',\n  'onModify',\n  'onCancel',\n  'onTipRating',\n  'resources',\n  'showOrderDetailButton',\n  'showPickupDetailButton',\n  'showModifyButton',\n  'showCancelButton',\n  'showTipsRatingButton',\n]\n","/* This should be an array of prop names that match\n * with the react ErrorWindow component props.\n */\n\nexport default ['lineItems', 'boldLabels', 'styles']\n","/* This should be an array of prop names that match\n * with the react AddressAutocomplete component props.\n */\n\nexport default [\n  'selectId',\n  'ariaLabel',\n  'onAddressSelected',\n  'country',\n  'requireFullAddress',\n  'initialOption',\n  'error',\n  'valid',\n  'disabled',\n  'inputSize',\n  'fullWidth',\n  'loadingMessage',\n  'noOptionsMessage',\n  'placeholder',\n  'selectAllOnFocus',\n  'onBlur',\n]\n","/* This should be an array of prop names that match\n * with the react icExpress component props.\n */\n\nexport const ExpressPlanModalProps = ['plans', 'currentSubscription', 'onPlanChange', 'onCancel']\nexport const ExpressPlansProps = [\n  'plans',\n  'currentSubscription',\n  'defaultSelectedPlanId',\n  'onPlanSelect',\n]\nexport const ExpressSignupModalProps = ['onCancel', 'planId', 'onSuccess']\n\nexport const ExpressGiftCardRedeemModalProps = ['onSuccess', 'onCancel']\n\nexport const ExpressPoweredByProps = ['small', 'poweredByText']\n\nexport const ExpressFooterProps = ['showText', 'showImage', 'poweredByText']\n\nexport const ExpressCountDownProps = ['small', 'startTime', 'enableRetailerTheme']\n\nexport const ExpressPromoPlanChangeProps = ['promoPlan', 'onButtonClick']\n\nexport const ExpressPromoPlanChangeModalProps = ['plan', 'onPlanChange', 'onCancel']\n\nexport const MobileMenuWithExpressPopoverProps = ['onClick']\n","export default ['onContinue', 'onClose']\n","export default ['onClose']\n","export default ['product']\n","export default ['onContinue']\n","export default ['banners']\n","export default ['onClickCTA']\n","export default ['storeProduct', 'withBorder', 'withPadding', 'fullWidth', 'justifyContent']\n","export default [\n  'items',\n  // TODO: ENT-40660 - once ebt service is converted to redux get from there directly\n  'hasEligibleEbtCard',\n  'onClick',\n  'onItemUpdate',\n  'obfuscatedRxItems',\n  'cartTotals',\n  'isInstoreList',\n]\n","export default ['collection', 'fullWidth', 'enableViewMore', 'enablePlacements']\n","export default ['onContinue', 'onCancel', 'storeProduct']\n","export default ['images', 'lang', 'zoomEnabled']\n","import angular from 'angular'\nimport { captureException, captureMessage } from '@sentry/browser'\n\n/**\n * How to enable lazy-loading for a AngularJS component or directive:\n * 1. Remove the corresponding static `import` statement from app/angular/components/**\\/index.js.\n * 2. Add `lazy-loading` attribute to all elements associated with a corresponding component or directive.\n * 3. Add an entry to `lazyLoadables`:\n * 'component-or-directive-name': {\n *   importModule: () => import(/* webpackChunkName: \"componentOrDirectiveName\" *\\/ '.../componentOrDirectiveName'),\n *   [indicatorProps: { [optional LazyLoadingIndicator props] },]\n * },\n */\nconst lazyLoadables = {\n  'register-form': {\n    importModule: () =>\n      import(\n        /* webpackChunkName: \"registerForm\" */ '@app/angular/components/shared/registerForm/registerForm'\n      ),\n  },\n  'register-form-improved': {\n    importModule: () =>\n      import(\n        /* webpackChunkName: \"registerFormImproved\" */ '@app/angular/components/shared/registerFormImproved/registerFormImproved'\n      ),\n  },\n  'shared-login': {\n    importModule: () =>\n      import(\n        /* webpackChunkName: \"sharedLogin\" */ '@app/angular/components/shared/util/sharedLogin'\n      ),\n  },\n}\n\nconst angularModule = angular\n  .module('lazyLoadingServicesModule', [])\n  .config(function ($compileProvider) {\n    angularModule.$compileProvider = $compileProvider\n    angularModule.lazyLoadedNames = new Set()\n  })\n  .directive('lazyLoading', function ($compile) {\n    return {\n      async link(scope, elements) {\n        const element = elements[0]\n\n        if (element.childElementCount > 0) {\n          return\n        }\n\n        const getName = name => (name in lazyLoadables ? name : undefined)\n        let name = getName(element.tagName.toLowerCase())\n        if (!name) {\n          name = Object.values(element.attributes)\n            .map(({ name }) => name)\n            .find(name => getName(name))\n        }\n        if (!name) {\n          const message = `No known lazy-loadable directive or component for the element: ${element.outerHTML}`\n          console.warn(message)\n          captureMessage(message)\n          return\n        }\n\n        let isError\n\n        if (!angularModule.lazyLoadedNames.has(name)) {\n          angularModule.lazyLoadedNames.add(name)\n\n          try {\n            const { importModule, indicatorProps } = lazyLoadables[name]\n\n            const attributes = Object.entries(indicatorProps ?? {})\n              .map(([name, value]) => (typeof value === 'boolean' ? name : `${name}=${value}`))\n              .join(' ')\n            const indicator = $compile(`<react-lazy-loading-indicator ${attributes} />`)(scope)[0]\n            element.appendChild(indicator)\n\n            const module = await importModule()\n            module.default._invokeQueue.forEach(item => {\n              const [type, [name, func]] = item.slice(item.length - 2)\n              angularModule.$compileProvider[type](name, func)\n            })\n          } catch (error) {\n            console.error(error)\n            captureException(error)\n\n            const alert = $compile(\n              `<alert type=\"warn-light\" disable-border=\"true\" small-text=\"true\">Failed to load module.</alert>`\n            )(scope)[0]\n            while (element.firstChild) {\n              element.firstChild.remove()\n            }\n            element.appendChild(alert)\n          }\n        }\n\n        if (!isError) {\n          $compile(element)(scope)\n          scope.$applyAsync()\n        }\n      },\n    }\n  })\n\nexport default angularModule\n","/* eslint-disable max-lines */\n\nimport _ from 'lodash'\n\nimport angular from 'angular'\nimport debounce from 'lodash/debounce'\n\nimport { Angular as AngularIntegration } from '@sentry/integrations'\n\nimport dropdown from 'angular-ui-bootstrap/src/dropdown'\nimport modal from 'angular-ui-bootstrap/src/modal'\nimport pagination from 'angular-ui-bootstrap/src/pagination'\nimport typeahead from 'angular-ui-bootstrap/src/typeahead'\nimport tooltip from 'angular-ui-bootstrap/src/tooltip'\nimport popover from 'angular-ui-bootstrap/src/popover'\n\nimport restangular from '@app/vendors/restangular'\nimport ngRedux from 'ng-redux'\nimport ngAria from 'angular-aria'\nimport ngTouch from 'angular-touch'\nimport uiMask from 'angular-ui-mask'\nimport uiRouter from '@uirouter/angularjs'\nimport ngSanitize from 'angular-sanitize'\nimport ocLazyLoad from 'oclazyload'\n\nimport AdditionalComponents from 'ClientPath/config/components.js'\nimport { config as configService, order } from '@instacart/enterprise-services'\nimport preloadCheckoutPage from '@app/utils/preloadCheckoutPage'\nimport '@app/vendors/circles/circles.js'\n\nimport { store } from '@app/services/store'\nimport { getRuntimeConfig } from '@app/rootConfig'\n\nimport { shouldUseHashHistory, hashTypeValue } from '@app/react/history'\nimport { fetchConfig } from '@app/services/config/slice'\nimport { eventEmitter, EVENT_TYPES } from '@app/utils/eventEmitter'\nimport { isReactDemo } from '@app/utils/isReactDemo'\nimport { fetchUserLists } from '@app/services/userList/thunks'\nimport { SHOPPING_MODES } from '@app/angular/constants/context'\nimport { fixCapacitorCookies } from '@app/utils/mobileApp/fixCapacitorCookies'\nimport { LOGIN_CONTEXTS } from './constants/loginContexts'\nimport Components from './components'\nimport Services from './services'\nimport OptionalComponents from './optionalComponents'\nimport ReactComponents from './reactComponents'\n\nimport { locations as StatesAndProvinces } from './constants/geo_locations'\nimport { DEVICE_TYPES } from './services/modules/mobile'\nimport { AUTH_ACTIONS } from './constants/authActions'\n\nimport LazyLoadingService from './services/modules/lazyLoading.service'\n\nfixCapacitorCookies()\n\nconst clientConfigModule = angular\n  .module('clientConfigModule', [])\n  .value('values', StatesAndProvinces)\n  .constant('theme', getRuntimeConfig().theme)\n\nexport const setupAngularApp = isBarebone => {\n  // eslint-disable-next-line angular/module-getter\n  clientConfigModule.constant('configConstants', configService.selectors.getConfig())\n\n  angular\n    .module('unata', [\n      AngularIntegration.moduleName,\n      clientConfigModule.name,\n      ngAria,\n      ngRedux,\n      ngTouch,\n      uiMask,\n      restangular,\n      uiRouter,\n      ngSanitize,\n      ocLazyLoad,\n      dropdown,\n      modal,\n      pagination,\n      typeahead,\n      tooltip,\n      popover,\n      Services.name,\n      Components.name,\n      LazyLoadingService.name,\n      OptionalComponents.name,\n      ReactComponents.name,\n      AdditionalComponents.name,\n    ])\n    .constant('isBarebone', isBarebone)\n    .config(\n      (\n        $ariaProvider,\n        $compileProvider,\n        $locationProvider,\n        $ngReduxProvider,\n        $ocLazyLoadProvider,\n        $sceDelegateProvider,\n        $urlRouterProvider,\n        configConstants\n      ) => {\n        $locationProvider.hashPrefix(hashTypeValue)\n        $locationProvider.html5Mode(!shouldUseHashHistory())\n\n        // Whitelist the url for the header/footer\n\n        $sceDelegateProvider.resourceUrlWhitelist([\n          // Allow same origin resource loads.\n          'self',\n          // Allow loading of .com Module header/footer\n          configConstants.dotComModule.headerFooterLocation,\n          `${configConstants.dotComModule.url}/wp-json/**/**/**`,\n          `${configConstants.dotComModule.url}/wp-json/**/**/**/**`,\n        ])\n\n        // Disable angular debugging info for prod environments\n        if (['prod', 'production'].includes(process.env.NODE_ENV)) {\n          $compileProvider.debugInfoEnabled(false)\n        }\n\n        $compileProvider.preAssignBindingsEnabled(true)\n\n        $compileProvider.imgSrcSanitizationWhitelist(\n          /^\\s*((https?|ftp|file|blob|capacitor):|data:image\\/)/\n        )\n\n        $compileProvider.aHrefSanitizationWhitelist(/^\\s*(https?|s?ftp|mailto|tel|file|capacitor):/)\n\n        $ariaProvider.config({\n          tabindex: false,\n          bindRoleForClick: false,\n        })\n\n        $ngReduxProvider.provideStore(store)\n      }\n    )\n    .run(\n      (\n        $injector,\n        $location,\n        $q,\n        $rootScope,\n        $state,\n        $stateParams,\n        $window,\n        anonymousIdService,\n        auth,\n        catalogCategoriesService,\n        config,\n        contextSelectorButtonService,\n        eComLightService,\n        list,\n        maintenance,\n        offersService,\n        offline,\n        oneCartService,\n        reactRouterHistory,\n        reservationService,\n        unataCommService,\n        userOverridesService,\n        userOverridesV2Service,\n        utilService\n      ) => {\n        // Sync React Router history with AngularJS Router\n        reactRouterHistory.listen()\n        eventEmitter.removeAllListeners(EVENT_TYPES.RELOAD_ANGULAR_STATE)\n\n        // Fetch all data required to reset the state of the app\n        // if a user changes store, etc..\n        $rootScope.reloadState = function () {\n          const deferred = $q.defer()\n          $rootScope.isAppLoading = true\n          $rootScope.$broadcast('reloadState')\n          if ($state.current.name) {\n            $state\n              .transitionTo($state.current, $stateParams, {\n                reload: true,\n                inherit: false,\n                notify: true,\n                location: false,\n              })\n              .then(() => {\n                deferred.resolve()\n              })\n              .catch(() => {\n                // if unable to load content after store was changed, then navigate to home page\n                if ($rootScope.deliveryStoreChangeIsInProgress) {\n                  $state.go('main.home').then(() => {\n                    deferred.resolve()\n                  })\n                } else {\n                  deferred.reject()\n                }\n              })\n              .finally(() => {\n                // removing indication of recent store selection event\n                $rootScope.deliveryStoreChangeIsInProgress = false\n              })\n          } else {\n            $window.location.reload()\n          }\n          return deferred.promise\n        }\n\n        // Allow react app to reload angular state\n        eventEmitter.on(EVENT_TYPES.RELOAD_ANGULAR_STATE, () => {\n          $rootScope.reloadState()\n        })\n\n        // A promise to keep track of cases where the title is set asynchronously\n        $rootScope.titlePromise = $q.defer()\n\n        // Make all state changes wait for the presence of a user object\n        $rootScope.$on('$stateChangeStart', (event, toState, toParams) => {\n          const hasOverrideParamsInURL =\n            Object.keys(toParams).filter(key => {\n              return (\n                toParams[key] !== null &&\n                toParams[key] !== undefined &&\n                userOverridesService.listOfOverrideParams.includes(key)\n              )\n            }).length > 0\n\n          const goToStateCallback = (goOptions = { location: false }) => {\n            utilService.removeSearchParametersGoToState(\n              toState,\n              toParams,\n              [...userOverridesService.listOfOverrideParams, ...userOverridesV2Service.PARAM_NAMES],\n              goOptions\n            )\n          }\n\n          userOverridesV2Service.preCaptureContextParamOverrides(toParams)\n          if (auth.onlyCateringEnabled()) {\n            eComLightService.setMode(true)\n          } else {\n            eComLightService.enableEComLight()\n          }\n\n          if (!auth.user && !maintenance.active && !offline.isOffline) {\n            // Halt state change\n            event.preventDefault()\n\n            auth\n              .initializeUser(userOverridesService.getUserOverridePayload) // Pass this function in to avoid circular dependency issues\n              .then(initializedUser => {\n                // Initialize category tree\n                catalogCategoriesService.fetchCategories(true)\n\n                const isUserTrial = auth.user.status === 'trial'\n\n                if (isUserTrial && config.gigya && config.gigya.enabled && config.gigya.syncLogin) {\n                  const gigyaService = $injector.get('gigyaService')\n\n                  return gigyaService.syncLogin().finally(goToStateCallback)\n                }\n\n                // This will not work if onecart is enabled via flagr\n                if (oneCartService.enabled()) {\n                  preloadCheckoutPage()\n                }\n\n                // Fetch user's reservation\n                reservationService.fetch().catch(() => {})\n\n                // If user is logged in...\n                if (!isUserTrial) {\n                  // Fetch user's save for later lists\n                  store.dispatch(fetchUserLists())\n                }\n\n                anonymousIdService.init(initializedUser)\n\n                // Here we fetch configs again so that any new\n                // configs based on the current user can be loaded in.\n                // Controllers reading from the config _constant_ will not\n                // receive this update.\n                return store.dispatch(fetchConfig())\n              })\n              .then(() => {\n                if (\n                  auth.user.status === 'trial' &&\n                  config.auth?.serviceName &&\n                  config.auth.serviceParams?.redirectTrialUser &&\n                  toState.name !== 'socialSignOn'\n                ) {\n                  // Gated Unata experience redirect user to third party SSO before\n                  // showing store content (currently only used by Costco)\n                  const currentState = { state: toState, stateParams: toParams }\n                  return auth.getAuthService().init(AUTH_ACTIONS.LOGIN, currentState)\n                }\n                // Parse user override parameters to see if we need to place the user in a certain store/context/zip on initialization\n                if (hasOverrideParamsInURL) {\n                  userOverridesService.parseOverrideParams(toParams)\n                  userOverridesService\n                    .updateExistingUserWithOverrides()\n                    .then(() => goToStateCallback())\n                } else {\n                  goToStateCallback()\n                }\n              })\n              .then(() => userOverridesV2Service.initializeContextParamOverrideSystem())\n              .then(() => auth.initializeContext())\n              .then(() => {\n                if (!process.env.UNATA_WIDGETS) {\n                  return\n                }\n\n                const event = new CustomEvent('unata-widgets-is-user-initialized')\n                window.dispatchEvent(event)\n              })\n          } else if (hasOverrideParamsInURL) {\n            // To support internal deep-linking.\n            event.preventDefault()\n            userOverridesService.parseOverrideParams(toParams)\n            userOverridesService.updateExistingUserWithOverrides()\n            goToStateCallback()\n\n            // hack for sprouts header deeplinks && to be removed once react header goes in\n            unataCommService.listen(unataCommService.EventType.CONFIRMCONTEXT, () => {\n              auth.user.context.shopping_mode !== SHOPPING_MODES.CATERING &&\n                userOverridesService.handleContextModalDeepLinks()\n            })\n          } else if (toParams['session-token']) {\n            // If URL contains session-token param, after we process it (in auth service), remove it from the URL\n            event.preventDefault()\n            $state.go(toState, _.omit(toParams, ['session-token']))\n            // TODO: Find a way to remove this callback once we've removed the param, so we don't have to keep checking on $stateChangeStart\n          }\n        })\n\n        $rootScope.$on('$stateChangeSuccess', () => {\n          userOverridesService.handleContextModalDeepLinks()\n        })\n      }\n    )\n    .config(($stateProvider, $uibTooltipProvider, $urlRouterProvider) => {\n      // Configure the main state for the app which pre-resolves anything we need globally\n\n      $stateProvider.state('main', {\n        url:\n          '?b2b_store&delivery_zip&hide_cart_compare_on_arrival&load-order&session-token&shopping_context&store&store_id&context&context_trial&context_authed&open_sidecart&confirm_context&enter_location&show_app_extended_info',\n        abstract: true,\n        resolve: {\n          loadOrder(\n            $q,\n            $state,\n            $stateParams,\n            $timeout,\n            cartService,\n            config,\n            errorModalService,\n            list,\n            oneCartService\n          ) {\n            // Load order to cart if specified in URL\n\n            const orderId = $stateParams['load-order']\n            if (orderId) {\n              const modal = errorModalService.open(\n                'Please wait while we load your order...',\n                null,\n                null,\n                'Loading Order',\n                true\n              )\n              return $q\n                .all([\n                  order.api.orders.get(orderId, {\n                    one_cart_enabled: oneCartService.enabled(),\n                    user_timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,\n                  }),\n                  cartService.fetch(),\n                ])\n                .then(([order]) => list.loadListToCart(order.order_items))\n                .then(() => {\n                  modal.close()\n                  return true\n                })\n            }\n            return false\n          },\n        },\n        onEnter(\n          $location,\n          $state,\n          $timeout,\n          $window,\n          auth,\n          config,\n          express,\n          loadOrder,\n          loyaltyOnboardingService,\n          // Make sure the mobileNativeHrefService service is loaded\n          // to ensure windowManager.listen is called.\n          mobileNativeHrefService,\n          mobileOnboardingService,\n          shoppingSelectorService,\n          userOverridesService\n        ) {\n          // Runs all code needed to initialize the express service\n          express.init()\n\n          // Setting a flag to let third parties know that the platform app has loaded.\n          if (!$window.unataLoaded) {\n            $window.unataLoaded = true\n          }\n\n          if (loadOrder) {\n            // If load-order param is used, once we've loaded the order we need to redirect to the checkout page\n            $timeout(() => {\n              $state.go('main.checkout', { 'load-order': null }, { location: 'replace' })\n            })\n          } else if (userOverridesService.openToStoreSelectorStep) {\n            userOverridesService.openShoppingSelectorAfterOverride()\n          }\n          // If enter_location or confirm_context deeplinks are present, the below flow should be ignored\n          else if (!userOverridesService.enterLocation && !userOverridesService.confirmContext) {\n            const skipModals = config.skipModalPaths.indexOf($location.$$path) > -1\n\n            // Below there are three different flows that can be triggered:\n            // 1: Mobile Onboarding (mobileOnboardingService) this is a short carousel which happens if on mobile and if mobileOnboardingService.shouldShowOnboarding() is true\n            // 2: Loyalty Onboarding (loyaltyOnboardingService). This is a series of three loyalty modal screens and happens if config.enableLoyaltyOnboarding and if the user is logged out\n            // This happens after Mobile Onboarding on Mobile and before shoppingSelectorService (#3)\n            // 3: Shopping Selector (shoppingSelectorService) This is the beginning of the unified flow. It is kicked off as the last step here.\n            // Checks if the user is on mobile and has previously seen app onboarding\n            mobileOnboardingService.shouldShowOnboarding().then(showOnboarding => {\n              if (process.env.UNATA_WIDGETS) {\n                return\n              }\n\n              if (!skipModals && showOnboarding) {\n                mobileOnboardingService.openModal().then(() => {\n                  // If user is logged out and loyalty onboarding is enabled show loyalty onboarding before initiating store selector\n                  if (\n                    config.enableLoyaltyOnboarding &&\n                    auth.user.status === 'trial' &&\n                    !loyaltyOnboardingService.hasSeenLoyalty &&\n                    !skipModals\n                  ) {\n                    loyaltyOnboardingService\n                      .initOnboarding('intro', null, null, null, LOGIN_CONTEXTS.LOYALTY_ONBOARDING)\n                      .finally(() => {\n                        shoppingSelectorService.homeStateContextHandler()\n                      })\n                  } else {\n                    shoppingSelectorService.homeStateContextHandler(skipModals)\n                  }\n                })\n              } else if (\n                config.enableLoyaltyOnboarding &&\n                auth.user.status === 'trial' &&\n                !loyaltyOnboardingService.hasSeenLoyalty &&\n                !skipModals\n              ) {\n                loyaltyOnboardingService\n                  .initOnboarding('intro', null, null, null, LOGIN_CONTEXTS.LOYALTY_ONBOARDING)\n                  .finally(() => {\n                    shoppingSelectorService.homeStateContextHandler()\n                  })\n              } else {\n                shoppingSelectorService.homeStateContextHandler(skipModals)\n              }\n            })\n          }\n        },\n        views: {\n          nav: {\n            template: require('./components/nav/views/nav.html'),\n            controller: 'NavController',\n          },\n          footer: {\n            template: require('./components/footer/footer.html'),\n            controller: 'FooterController',\n          },\n          sideCart: {\n            template: `\n              <div\n                sticky\n                side-cart\n                side-cart-auto-focus=\"side-cart-close-button\"\n                offset=\"{{::stickyOffset}}\"\n                min-width=\"1250\"\n                sticky-check-callback=\"sideCartPositionChange\"\n                ng-if=\"config.oneCart.enabled || (!config.disableSideCart && !mobile.isMobile)\"\n                class=\"slideInRight\"\n                ng-class=\"{\n                  'show-full-height': shouldShowSidecart() && isOneCartEnabled(),\n                  show: shouldShowSidecart() && !isOneCartEnabled(),\n                  hover: $root.isSideCartOpen,\n                  'ecom-light-mode': inEComLightMode,\n                  'non-sticky-height': isOneCartEnabled(),\n                  'is-onecart-sidecart': isOneCartEnabled()\n                }\"\n                aria-expanded=\"{{sideCartDropdownOpen}}\"\n                aria-controls=\"side-cart-container\"\n                data-test=\"side-cart-sticky-container\"\n              ></div>\n            `,\n          },\n        },\n      })\n\n      // Fall back to 404 page when angular route not found\n      $urlRouterProvider.otherwise($injector => {\n        const $state = $injector.get('$state')\n        $state.go('main.404', {}, { location: false })\n      })\n\n      // Set UI Bootstrap tooltip defaults\n      $uibTooltipProvider.options({\n        'popover-animation': false,\n      })\n    })\n    .run(\n      (\n        $anchorScroll,\n        $document,\n        $rootScope,\n        $templateCache,\n        $timeout,\n        $uibModalStack,\n        analytics,\n        config,\n        lang,\n        mobileService,\n        qualitricsService,\n        routingService,\n        utilService,\n        values\n      ) => {\n        $rootScope.config = config // Expose config in all scopes\n        $rootScope.values = values\n        $rootScope.analytics = analytics // Expose analytics in all scopes\n        $rootScope.util = utilService\n        $rootScope.mobile = mobileService\n        $rootScope.isAppLoading = true // Trigger app loading indicator when the app starts\n        $rootScope.lang = lang\n        $rootScope.isReactDemo = isReactDemo\n\n        // Trigger Qualitrics script when config enabled.\n        if (config.qualitricsScript?.enabled) {\n          qualitricsService.initQualitrics()\n        }\n\n        $rootScope.$on('$stateChangeSuccess', () => {\n          if ($uibModalStack.getTop()) {\n            // close all modal dialogs when changing pages (back button)\n            $uibModalStack.dismissAll()\n\n            // FIXME Find a way to preventDefault only in the case that the back button is pressed.\n            // prevent page change in this instance\n            // event.preventDefault();\n          } else if (mobileService.isMobile) {\n            // display loading indicator in mobile\n            $rootScope.isAppLoading = true\n          }\n        })\n\n        // Scroll to top when state changes and stop the app level loading indicator\n\n        $rootScope.$on('$stateChangeSuccess', (event, toState, toParams, fromState, fromParams) => {\n          $anchorScroll()\n          // TODO: Remove once [ENT-7481] is done\n          // keep the spinner up if this is a proxy call to a 3rd party authorization service and\n          // `norender` param was passed\n          const hasThirdPartyAuth = config.auth && config.auth.serviceName\n          const hasNoRenderParam = toParams && (toParams.norender || fromParams.norender)\n          if (hasThirdPartyAuth && hasNoRenderParam) {\n            const el = $document[0].querySelector('.load-app.view-loading-indicator')\n            if (el) {\n              // make backdrop full white, no transparency\n              el.className += ' no-render'\n            }\n            return\n          }\n          $rootScope.isAppLoading = false\n          utilService.scrollToTop()\n        })\n\n        // Save the name of the previous state.\n        $rootScope.$on('$stateChangeSuccess', (event, toState, toParams, fromState, fromParams) => {\n          $rootScope.previousState = fromState.name\n          $rootScope.previousStateParams = fromParams\n        })\n\n        const watchScope = $rootScope.$new()\n        watchScope.$on('$stateChangeSuccess', () => {\n          $rootScope.$broadcast('firstStateChangeSuccess')\n          $timeout(() => {\n            watchScope.$destroy()\n          })\n        })\n\n        // For a11y utility, inform document when mouse is being used\n        document.body.addEventListener('mousedown', () => {\n          $document[0].body.classList.add('using-mouse')\n        })\n\n        // For a11y utility, inform document when the last key press was tab (likely using)\n        document.body.addEventListener('keydown', event => {\n          if (event.keyCode === 9) {\n            $document[0].body.classList.remove('using-mouse')\n          }\n        })\n\n        // Enable the 'mouse' mode, hiding the focus outline, by default.\n        $document[0].body.classList.add('using-mouse')\n\n        // This is a fix for iOS weird scrolling issues in inputs in fixed position elements.\n        $rootScope.needsNativeIosStyleFix =\n          mobileService.isMobileApp() && mobileService.getMobileOs() === DEVICE_TYPES.IOS\n\n        // Fix accessibility with angular-carousel indicators\n        $templateCache.put(\n          'carousel-indicators.html',\n          `<ul class=\"rn-carousel-indicator\">\n            <li ng-repeat=\"slide in slides\">\n              <button\n                type=\"button\"\n                ng-class=\"{active: $index==index}\"\n                ng-click=\"goToSlide($index)\"\n                aria-label=\"{{::$parent.$root.lang.template($parent.$root.lang.aria.goToSlide, {index: $index + 1})}}\"\n                aria-current=\"{{$index===index}}\"\n              >●</button>\n            </li>\n          </ul>`\n        )\n\n        // Fix accessibility with uib-popover\n        $templateCache.put(\n          'uib/template/popover/popover.html',\n          `<div class=\"popover\"\n            tooltip-animation-class=\"fade\"\n            uib-tooltip-classes\n            ng-class=\"{ in: isOpen() }\"\n            role=\"tooltip\">\n            <div class=\"arrow\" aria-hidden=\"true\"></div>\n\n            <div class=\"popover-inner\">\n              <h3 class=\"popover-title\" ng-bind=\"title\" ng-if=\"title\"></h3>\n              <div class=\"popover-content\" ng-bind=\"content\"></div>\n            </div>\n          </div>`\n        )\n\n        // Fix accessibility with uib-popover-html\n        $templateCache.put(\n          'uib/template/popover/popover-html.html',\n          `<div class=\"popover\"\n            tooltip-animation-class=\"fade\"\n            uib-tooltip-classes\n            ng-class=\"{ in: isOpen() }\"\n            role=\"tooltip\">\n            <div class=\"arrow\" aria-hidden=\"true\"></div>\n\n            <div class=\"popover-inner\">\n              <h3 class=\"popover-title\" ng-bind=\"title\" ng-if=\"title\"></h3>\n              <div class=\"popover-content\" ng-bind-html=\"contentExp()\"></div>\n            </div>\n          </div>`\n        )\n\n        // Fix accessibility with uib-popover-template\n        $templateCache.put(\n          'uib/template/popover/popover-template.html',\n          `<div class=\"popover\"\n            tooltip-animation-class=\"fade\"\n            uib-tooltip-classes\n            ng-class=\"{ in: isOpen() }\"\n            role=\"tooltip\">\n            <div class=\"arrow\" aria-hidden=\"true\"></div>\n\n            <div class=\"popover-inner\">\n              <h3 class=\"popover-title\" ng-bind=\"title\" ng-if=\"title\"></h3>\n              <div class=\"popover-content\"\n                uib-tooltip-template-transclude=\"contentExp()\"\n                tooltip-template-transclude-scope=\"originScope()\"></div>\n            </div>\n          </div>`\n        )\n      }\n    )\n    .run(($location, $rootScope, $state, $window, config, eComLightService) => {\n      const performInternalRedirect = (destination, urlOverwrite, stateGoOptions) => {\n        $state.go(destination.sref, destination.params, stateGoOptions).then(() => {\n          if (urlOverwrite) {\n            $location.url(urlOverwrite) // Replace the url so redirect is hidden from user\n            // NOTE: `urlOverwrite` must match `toState` (state the user would've gone to had it not been redirected) url\n            //        or else the user will end up just getting redirected to the urlOverwrite\n          }\n        })\n      }\n\n      // Allow state navigation to be overriden to an external URL or an internal state\n      //  (external urls take precedence)\n\n      if (\n        config.eComLight.enabled ||\n        (config.externalStates && !_.isEmpty(config.externalStates)) ||\n        (config.internalRedirects && !_.isEmpty(config.internalRedirects))\n      ) {\n        $rootScope.$on('$stateChangeStart', (event, toState, toParams, fromState) => {\n          const fromStateName = fromState && fromState.name\n          const toStateName = toState && toState.name\n\n          if (config.externalStates[toStateName]) {\n            // Handle external redirects\n\n            event.preventDefault()\n            $window.open(config.externalStates[toStateName], 'external')\n            $rootScope.isAppLoading = false\n          } else {\n            // Handle internal redirects\n            // eslint-disable-next-line no-lonely-if\n            if (\n              eComLightService.inEComLightMode &&\n              eComLightService.isForbiddenState(toStateName, toParams)\n            ) {\n              // If a user tries to access a route/page we cannot show them in eCom Light mode,\n              //  we need to redirect them to config.eComLight.homeRedirect\n              event.preventDefault()\n              performInternalRedirect(config.eComLight.homeRedirect, '/', { reload: true })\n            } else if (config.internalRedirects[toStateName] && fromStateName !== toStateName) {\n              const destination = config.internalRedirects[toStateName]\n\n              event.preventDefault()\n              performInternalRedirect(destination)\n            }\n          }\n        })\n      }\n    })\n    .run(($document, $rootScope, config, isBarebone) => {\n      // Pull in the configured CMS provided scripts if Header Footer Sync is enabled.\n      if (\n        config.dotComModule.enableHeaderFooterSync &&\n        !config.react?.enableHeader &&\n        !$rootScope.isReactDemo() &&\n        !isBarebone\n      ) {\n        const head = $document[0].head || $document[0].getElementsByTagName('head')\n        config.dotComModule.headerSyncUrl.scripts.forEach(url => {\n          const scriptTag = document.createElement('script')\n          scriptTag.src = `${url}?t=${config.timestamp}`\n          head.appendChild(scriptTag)\n        })\n      }\n    })\n    .run((unataCommInterceptorService, unataCommService) => {\n      // Attach UnataCommService listeners\n      unataCommService.listen(unataCommService.EventType.GETADDITIONALCONTEXTDETAILS, () => {\n        unataCommInterceptorService.sendAdditionalContextDetails()\n      })\n\n      unataCommService.listen(unataCommService.EventType.UNATADEBUGMODE, event => {\n        unataCommInterceptorService.handleDebugEvents(event)\n      })\n    })\n    .run($rootScope => {\n      if (!process.env.UNATA_WIDGETS) {\n        return\n      }\n\n      $rootScope.$watch(\n        'showingSideCart',\n        debounce(showingSideCart => {\n          document.body.classList.toggle('unata-side-cart', showingSideCart)\n        }, 1500)\n      )\n    })\n}\n","/**\n * AngularJS App Renderer\n *\n * On mount, this renders the AngularJS app.\n *\n * When the parent React Route is NOT on an active React route, the AngularJS\n * app is displayed in the DOM. When on an active React route, the AngularJS\n * app is hidden. This is a workaround to prevent bootstrapping the AngularJS\n * every time the user navigates from a React to an AngularJS route.\n */\n\nimport React, { useEffect, useRef } from 'react'\nimport angular from 'angular'\nimport AngularAppContext from './AngularAppContext'\nimport { useIsReactRoute } from './routes'\nimport { setupAngularApp } from '../angular/app'\n\nconst AngularApp = () => {\n  const angularRootEl = useRef<HTMLDivElement>(null)\n  const isReactRoute = useIsReactRoute()\n  const { setIsReady, angularJSDependencies, isBarebone } = React.useContext(AngularAppContext)\n\n  useEffect(() => {\n    if (angularRootEl.current) {\n      setupAngularApp(isBarebone)\n      angular.bootstrap(angularRootEl.current, ['unata', ...(angularJSDependencies ?? [])])\n      setIsReady(true)\n    }\n  }, [setIsReady, angularRootEl, angularJSDependencies, isBarebone])\n\n  useEffect(() => {\n    if (!process.env.UNATA_WIDGETS) {\n      return\n    }\n\n    const event = new CustomEvent('unata-widgets-is-app-loaded')\n    window.dispatchEvent(event)\n  }, [])\n\n  return (\n    <div\n      id=\"angular\"\n      ref={angularRootEl}\n      className=\"angular-root\"\n      ng-class=\"{\n        'show-side-cart': $root.showingSideCart,\n        'is-modify-cart': $root.modifyingOrder,\n        'side-cart-open': $root.isSideCartOpen,\n        'wk': $root.mobile.iosWebViewCheck()\n      }\"\n      style={{ display: isReactRoute ? 'none' : 'block' }}\n      aria-hidden={isReactRoute ? 'true' : 'false'}\n    >\n      {!isBarebone && (\n        <>\n          <div\n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n            // @ts-ignore non-standard html attribute\n            overlay=\"true\"\n            className=\"storefront-overlay\"\n            ng-class=\"{ 'active': $root.isSideCartOpen && config.oneCart.enabled && !mobile.isMobile }\"\n            react-storefront-builder=\"react\"\n          />\n          <div ui-view=\"nav\" />\n          <div ui-view=\"sideCart\" react-storefront-builder=\"react-sidecart\" />\n          <div\n            ng-if=\"$root.isAppLoading\"\n            data-test=\"global-app-loading\"\n            className=\"load-app view-loading-indicator\"\n          />\n          <main\n            ui-view=\"content\"\n            ng-class=\"{\n          'banner-fix': $root.headerBanners.length > 0,\n          'show-overflow': $root.showOverflow,\n          'one-cart': config.oneCart.enabled,\n          'react-header-enabled': config.react.enableHeader,\n          'sidecart-padding': !(config.oneCart.enabled || config.react.enableHeader) && !mobile.isMobile && $root.showingSideCart\n        }\"\n            id=\"content\"\n          />\n          <div ui-view=\"fixed-content\" className=\"fixed-content\" />\n          <div ui-view=\"footer\" ng-if=\"!mobile.isMobile\" />\n        </>\n      )}\n    </div>\n  )\n}\n\nexport default AngularApp\n","module.exports = \"<div class=label-wrapper> <div class=label> <span class=icon aria-hidden=true></span> <h2> {{::lang.values.exploreMore}} <br/> <strong>{{::lang.values.waysToShop}}</strong> </h2> <a class=\\\"go link\\\" ui-sref=\\\"main.shop({page: null, tags: null})\\\" aria-label=\\\"{{:: lang.aria.seeMore + ' ' + lang.aria.waysToShop}}\\\">{{::lang.values.seeMore}}</a> </div> </div> <div class=tags> <ul class=tags-wrapper> <li class=\\\"tag {{::tag.id}}\\\" ng-repeat=\\\"tag in ::tags\\\"> <a class={{::tag.id}} analytics-click=\\\"['quickshop link', 'click', $index, tag.id]\\\" ui-sref=\\\"main.shop.categories({page: null, tags: [tag.id]})\\\" ng-attr-style=color:{{::tag.color}} data-test=quickshop-{{::tag.id}}> <div class=tag-icon tag-style tag=tag aria-hidden=true></div> <div class=info> <div>{{::tag.longName}}</div> <span class=link> {{::lang.values.shopNow}} <span class=go aria-hidden=true></span> </span> </div> </a> </li> </ul> </div> \";","module.exports = \"<div class=modal-container> <div class=\\\"unsupported-postal-code-modal error-modal\\\"> <h1 class=unsupported-postal-code-modal-header> {{::lang.values.rx.cantChangePickupHeader}} </h1> <div class=error-modal-content> <p class=rx-confirmation-modal-text> {{::lang.values.rx.cantChangePickupText1}} </p> <p class=rx-confirmation-modal-text> {{::lang.values.rx.cantChangePickupText2}} </p> <a class=\\\"button button--full-width rx-confirmation-modal-button\\\" ng-click=resolve(false);$close() analytics-click=\\\"['rxPickupChange modal continue', 'click']\\\"> {{::lang.values.rx.cantChangePickupConfirm}} </a> <a class=\\\"button hollow button--full-width\\\" ng-click=resolve(true);$close() analytics-click=\\\"['rxPickupChange modal cancel', 'click']\\\"> {{::lang.values.rx.cantChangePickupCancel}} </a> </div> </div> </div>\";","module.exports = \"<div class=cart-table__container> <div class=cart-table__products-container> <div class=visual-headers ng-if=::!mobile.isMobile> <div class=product-header aria-hidden=true>{{::lang.values.product}}</div> <div class=substitutions-header ng-if=\\\"!mobile.isMobile && !inEComLightMode\\\"> <input class=checkbox ng-model=$parent.$parent.allowAllSubstitutions ng-change=toggleAllowAllSubstitutions() id=allow-all-sub type=checkbox analytics-click=\\\"['cart allow all substitutions checkbox', 'click']\\\" aria-describedby=substitution-help> <label for=allow-all-sub class=screen-reader-text>{{::lang.values.substitutionForAllItems}}</label> <span aria-hidden=true>{{::lang.values.substitution}}</span> <span class=\\\"help question\\\" help=lang.values.substitutionHelp description-id=substitution-help tabindex=0></span> </div> <div class=offer-header></div> <div class=price-header aria-hidden=true>{{::lang.values.price}}</div> <div class=quantity-header aria-hidden=true>{{::lang.values.quantity}}</div> <div class=total-header aria-hidden=true>{{::lang.values.total}}</div> </div> <div class=cart-table__products ng-repeat=\\\"(categoryIndex, productCategory) in orderedCategories\\\" ng-if=cartService.isCategoryForCurrentCartType(productCategory) ng-class=\\\"{'show-mobile-extras': showNotesSubs}\\\"> <h2 class=category-label ng-class=\\\"{'mobile-label': mobile.isMobile}\\\">{{productCategory}}</h2> <table class=table> <thead class=screenreadertext> <tr> <th scope=col>{{::lang.aria.deleteCartItem}}</th> <th scope=col>{{::lang.aria.productImage}}</th> <th scope=col>{{::lang.values.product}}</th> <th scope=col>{{::lang.values.substitution}}</th> <th scope=col>{{::lang.values.offers}}</th> <th scope=col>{{::lang.values.price}}</th> <th scope=col>{{::lang.values.quantity}}</th> <th scope=col>{{::lang.values.total}}</th> </tr> </thead> <tbody> <tr ng-repeat-start=\\\"item in categorizedProducts[productCategory] track by generateUniqueItemId(item)\\\" id=checkout-cart-item-{{item.store_product.id}} class=\\\"row item\\\" ng-init=\\\"item.showDeleteConfirm = false\\\" ng-if=\\\"(!item.store_product.product_type || item.store_product.product_type !== 'subscription') && item.quantity > 0\\\" ng-class=\\\"{\\n            'show-delete-confirm': item.showDeleteConfirm,\\n            'out-of-stock': isItemCurrentlyOutOfStock(item)\\n            }\\\" data-test=cart-item-row> <td class=\\\"action delete\\\"> <button data-test=remove-item-button class=\\\"button round remove-item-button\\\" ng-class=\\\"{ 'darker small': !mobile.isMobile, empty: mobile.isMobile }\\\" ng-click=\\\"item.showDeleteConfirm = true\\\" name=item-delete-trigger analytics-click=\\\"['cart product delete button', 'click']\\\" aria-label=\\\"{{::\\n                lang.templateAsString(\\n                lang.aria.removeItemFromCart,\\n                { item: item.store_product.name }\\n                  )\\n                }}\\\" ng-disabled=item.showDeleteConfirm id=checkout-cart-item-{{item.store_product.id}}-remove> <span class=\\\"{{:: mobile.isMobile ? config.cartReview.mobile.deleteIcon : 'icon-delete'}}\\\" aria-hidden=true></span> </button> <div ng-if=item.showDeleteConfirm class=delete-confirm data-test=delete-confirm-button> <div class=label> {{::lang.values.wantToRemove}} <span auto-focus=true class=screen-reader-text tabindex=-1> {{:: lang.templateAsString( lang.aria.removeItemFromCartConfirmation, { item: item.store_product.name } ) }} </span> </div> <button ng-click=handleDeleteConfirmCancelClick(item) class=\\\"button smaller dark\\\" name=item-delete-cancel analytics-click=\\\"['cart product delete confirmation cancel button', 'click']\\\" aria-label={{::lang.aria.cancel}}> {{::lang.values.cancel}} </button> <button ng-click=\\\"item.showDeleteConfirm = false; cartService.removeItem(item, item.product_config.options)\\\" class=\\\"button smaller highlight\\\" name=item-delete-confirm analytics-click=\\\"['cart product delete confirmation remove button', 'click']\\\" send-analytics=!$root.modifyingOrder aria-label={{::lang.aria.removeItem}} data-test=remove-item-confirm-button> {{::lang.values.remove}} </button> </div> </td> <td class=\\\"action internal-link product-image\\\" ng-disabled=item.showDeleteConfirm ng-click=goToProductDetailsModal(item) name=item-image-link analytics-click=\\\"['cart product link', 'click']\\\" data-test=item-row-image-button> <button class=item-image ng-attr-style=\\\"background-image: url('{{imageURLService.getProductImageURL(item.store_product, 'small')}}')\\\" aria-label=\\\"{{lang.aria.openModal + ' ' + item.store_product.name}}\\\"></button> </td> <th scope=row class=product-meta ng-disabled=item.showDeleteConfirm> <button type=button class=name ng-click=goToProductDetailsModal(item) name=item-title-link analytics-click=\\\"['cart product link', 'click']\\\" ng-bind-html=cartService.getItemDescription(item) ng-disabled=item.showDeleteConfirm data-test=item-row-name></button> <div class=configurable-values-container ng-if=item.product_config.options.length> <p class=configurable-values compile=\\\"configurableProductService.configsString(item, true)\\\"></p> </div> <div ng-if=::mobile.isMobile> <div class=left> <div product-prices product=item.store_product unit-price=item.unit_price></div> </div> <div class=right ng-if=!showNotesSubs> <div ng-if=!isItemCurrentlyOutOfStock(item) modify-quantity item=item increment-fn=incrementItem(item) decrement-fn=decrementItem(item) on-update=\\\"updateItemQuantity(item, $originalQuantity, $onZeroFn)\\\" on-zero-fn=\\\"item.showDeleteConfirm = true\\\" include-zero=true analytics-name=\\\"cart product\\\"></div> </div> <div class=right ng-if=\\\"!inEComLightMode && showNotesSubs\\\"> <input class=checkbox ng-model=item.allow_substitutions ng-change=toggleAllowSubstitutions(item) ng-disabled=\\\"isItemCurrentlyOutOfStock(item) || isAllowSubstitutionsDisabled(item)\\\" id=allow-sub-{{categoryIndex}}-{{$index}} type=checkbox aria-label=\\\"{{::lang.template(lang.values.substituteFor, {substitute: lang.values.substitute, product: item.store_product.name})}}\\\" analytics-click=\\\"['cart product substitution checkbox', 'click']\\\"> <label aria-hidden=true class=checkbox-switch for=allow-sub-{{categoryIndex}}-{{$index}} analytics-click=\\\"['cart product substitution checkbox', 'click']\\\"> <span></span> </label> </div> <div class=left> <react-fulfillment-banner store-product=item.store_product></react-fulfillment-banner> </div> <div class=offer-tag ng-if=cartService.itemHasOffer(item)></div> </div> <div product-points product=item.store_product class=small></div> <div ng-if=::!mobile.isMobile> <react-fulfillment-banner store-product=item.store_product></react-fulfillment-banner> <div ng-if=!isItemCurrentlyOutOfStock(item) product-comments item=item product-comment-callback=updateItemComment(item) disable-input=item.showDeleteConfirm></div> <div ng-if=isItemCurrentlyOutOfStock(item)> <span class=out-of-stock-text uib-popover-html=outOfStockWarningPopover popover-trigger=\\\"mouseenter focus\\\" popover-enable=isItemCurrentlyOutOfStock(item) tabindex=\\\"{{ isItemCurrentlyOutOfStock(item) ? '0' : '-1' }}\\\" popover-append-to-body=true> {{::lang.values.outOfStock}} <i class=\\\"icon icon-info-i\\\" aria-hidden=true></i> </span> </div> </div>  <td class=substitutions ng-if=\\\"!mobile.isMobile && !inEComLightMode\\\" ng-disabled=item.showDeleteConfirm> <input class=\\\"checkbox qa-item-allow-sub\\\" ng-model=item.allow_substitutions ng-change=toggleAllowSubstitutions(item) ng-disabled=\\\"isItemCurrentlyOutOfStock(item) || isAllowSubstitutionsDisabled(item) || item.showDeleteConfirm\\\" id=allow-sub-{{categoryIndex}}-{{$index}} type=checkbox analytics-click=\\\"['cart product substitution checkbox', 'click']\\\"> <label for=allow-sub-{{categoryIndex}}-{{$index}} class=screen-reader-text> {{::lang.template(lang.values.substituteFor, {substitute: lang.values.substitutionForAnItem, product: item.store_product.name})}} </label> <span class=allow-sub-label analytics-click=\\\"['cart product substitution checkbox', 'click']\\\" aria-label={{::lang.aria.allowSubstitution}} aria-hidden=true> Allow? </span> </td> <td class=offer ng-if=::!mobile.isMobile> <div class=offer-tag ng-if=cartService.itemHasOffer(item)></div> </td> <td class=prices ng-if=::!mobile.isMobile ng-disabled=item.showDeleteConfirm> <div product-prices product=item.store_product unit-price=item.unit_price></div> </td> <td class=product-quantity ng-if=::!mobile.isMobile ng-disabled=item.showDeleteConfirm> <div class=wrapper ng-if=!isItemCurrentlyOutOfStock(item)> <div class=cosmetic><span aria-hidden=true>&times;</span></div> <div modify-quantity item=item ng-if=!showNotesSubs increment-fn=incrementItem(item) decrement-fn=decrementItem(item) on-update=\\\"updateItemQuantity(item, $originalQuantity, $onZeroFn)\\\" on-zero-fn=\\\"item.showDeleteConfirm = true\\\" include-zero=true analytics-name=\\\"cart product\\\" disable-input=item.showDeleteConfirm></div> <div class=cosmetic><span aria-hidden=true>=</span></div> </div> </td> <td class=product-total ng-if=\\\"::!isItemCurrentlyOutOfStock(item) && !mobile.isMobile\\\" ng-disabled=item.showDeleteConfirm name=item-subtotal data-test=item-subtotal> {{item.subtotal | currency}} </td> </th></tr> <tr hidden ng-repeat-end ng-class=\\\"{ 'out-of-stock': isItemCurrentlyOutOfStock(item) }\\\" ng-if=mobile.isMobile> <td colspan=4 class=mobile-extras ng-if=\\\"!isItemCurrentlyOutOfStock(item) && showNotesSubs\\\"> <div product-comments item=item product-comment-callback=updateItemComment(item)></div> </td> <td colspan=4 class=out-of-stock-bottom ng-if=\\\"isItemCurrentlyOutOfStock(item) && !showNotesSubs\\\"> <span class=\\\"out-of-stock-text out-of-stock-text-offset\\\" uib-popover-html=outOfStockWarningPopover popover-trigger=\\\"mouseenter focus\\\" popover-enable=\\\"isItemCurrentlyOutOfStock(item) && !mobile.isMobile\\\" tabindex=\\\"{{ isItemCurrentlyOutOfStock(item) ? '0' : '-1' }}\\\" popover-append-to-body=true> {{::lang.values.outOfStock}} <i class=\\\"icon icon-info-i\\\" aria-hidden=true></i> </span> </td> </tr> </tbody> </table> </div> <div class=\\\"cart-table__offers-container table\\\" ng-if=!showNotesSubs id=offers-table> <div class=\\\"cart-table__offers cart-offers\\\" id=cart-offers> <div data-test=offers-section ng-if=\\\"cartService.cart.offer_progress.length > 0\\\" class=offers> <h2 class=offer-heading><span aria-hidden=true class=offer-tag></span> {{::lang.values.offersApplicableToOrder}}</h2> <loyalty-opt-in-placement ng-if=::config.loyalty.enableLoyaltyOptInPlacements is-info-box=true></loyalty-opt-in-placement> <ul class=\\\"ul-el {{:: config.newCheckoutFlow.cartReviewPage.enabled ? 'offers-list--new' : 'offers-list' }}\\\"> <li class=li-el ng-repeat=\\\"offer in cartService.cart.offer_progress\\\" offer-tile=offer location=\\\"Cart Item Offer\\\"></li> </ul> </div> <div ng-if=\\\"::config.newCheckoutFlow.cartReviewPage.enabled && config.enablePromoCodes.checkout && mobile.isMobile\\\" class=mobile-promo-codes> <span ng-if=\\\"cartService.cart.promo_codes.length > 0\\\" class=ul-el> <span class=li-el data-test=cart-promo-codes ng-repeat=\\\"promoCode in cartService.cart.promo_codes track by $index\\\"> {{promoCode}} </span> </span> <div class=mobile-promo-codes__link> <button data-test=add-promo-code-button ng-click=openPromoCodeModal() refocus>{{::lang.values.addPromoCode}}</button> </div> </div> <div ng-if=\\\"::mobile.isMobile && config.newCheckoutFlow.cartReviewPage.enabled && rewards.length && auth.user.ic_linked\\\"> <div class=new-checkout__divider ng-repeat=\\\"reward in rewards track by reward.id\\\"> <react-cart-loyalty-balance title-text=reward.label value=\\\"reward.amount | currency\\\" content=\\\"reward.primaryInfo + reward.secondaryInfo\\\" styles=loyaltyReactProps.styles native-href-click-handler></react-cart-loyalty-balance> </div> </div> </div> </div> <div class=\\\"new-checkout__mobile-wrapper table\\\" ng-if=\\\"::config.newCheckoutFlow.cartReviewPage.enabled && mobile.isMobile\\\"> <div class=\\\"new-checkout__tile new-checkout__totals\\\"> <div class=new-checkout__divider> <div ng-if=\\\"(cartService.cart.promo_codes_total | number) > 0 || config.showZeroDiscount\\\" class=new-checkout__totals-section> <span>{{::lang.values.promoCodeApplied}}</span> <span>-{{cartService.cart.promo_codes_total | currency}}</span> </div> <div ng-if=\\\"(cartService.cart.offer_total | number) > 0 || config.showZeroDiscount\\\" class=\\\"new-checkout__totals-section new-checkout__totals-section--discount\\\"> <span>{{::lang.values.totalOfferDiscount}}</span> <span>-{{cartService.cart.offer_total | currency}}</span> </div> <div ng-if=\\\"::(config.hasLoyaltyPoints && config.showPointsGained)\\\" class=new-checkout__totals-section> <span>{{::lang.values.pointsGained}}</span> <span>{{(cartService.cart.points.awarded || 0) | number}}</span> </div> <div class=new-checkout__totals-section> <div> <span>{{::lang.values.subtotal}}</span> <div class=asterix> {{::lang.values.excludesTaxesAndFees}} </div> </div> <div class=new-checkout__totals-total> {{cartService.getCartTotalForCurrentType() | currency}} </div> </div> </div> </div> <div class=\\\"text-center continue-shopping-section\\\"> <a class=\\\"button hollow continue-shopping\\\" ui-sref={{::config.continueShoppingRedirect.desktop}}> {{::lang.values.continueShopping}} </a> </div> </div> <div ng-if=showLoyaltyCardBalance() class=\\\"loyalty-card-balance-wrapper new-checkout__tile\\\"> <react-cart-loyalty-balance class=new-checkout__loyalty-balance title-text=loyaltyReactProps.title value=loyaltyReactProps.getValue() content=loyaltyReactProps.content styles=loyaltyReactProps.styles></react-cart-loyalty-balance> </div> <div class=\\\"new-checkout__footer table\\\" ng-if=\\\"!config.newCheckoutFlow.cartReviewPage.enabled && !showNotesSubs\\\"> <div class=comments ng-if=::!mobile.isMobile> <div class=\\\"icon-note icon-left textarea-inner-button comment\\\" ng-init=\\\"showSave = false\\\" ng-if=::!mobile.isMobile> <textarea class=input ng-model=cartService.cart.comment ng-click=\\\"showSave = true\\\" ng-blur=\\\"showSave = false; modifyNote()\\\" id=checkout-cart-note-textarea placeholder=\\\"{{:: lang.values.addOrderNote}}\\\" maxlength={{::config.orderNoteMaxLength}} aria-label=\\\"{{:: lang.values.addOrderNote}}\\\">\\n            </textarea> <button id=checkout-cart-note-save class=\\\"button small\\\" ng-if=showSave>{{::lang.values.save}}</button> </div> </div> <span ng-if=\\\"::config.showNoteCharLimit && !mobile.isMobile\\\" ng-bind=\\\"config.orderNoteMaxLength - cartService.cart.comment.length\\\" class=character-count ng-class=\\\"{alert: (config.orderNoteMaxLength - cartService.cart.comment.length <= 10)}\\\"></span> <div class=totals-discounts> <div class=content> <div class=discount ng-if=\\\"(cartService.cart.offer_total | number) > 0 || config.showZeroDiscount\\\"> <div class=amount>{{cartService.cart.offer_total | currency}}</div> <div class=label>{{::lang.values.totalOfferDiscount}}:</div> </div> <div class=points-total ng-if=\\\"::(config.hasLoyaltyPoints && config.showPointsGained)\\\"> <div class=amount>{{(cartService.cart.points.awarded || 0) | number}}</div> <div class=label>{{::lang.values.pointsGained}}:</div> </div> <div class=subtotal> <div class=amount>{{cartService.getCartTotalForCurrentType() | currency}}</div> <div class=label> {{::lang.values.subtotal}}: <div class=asterix>{{::lang.values.excludesTaxesAndFees}}</div> </div> </div> </div> </div> <div class=tip-continue-promo-container> <div class=continue> <form ng-if=::config.enablePromoCodes.checkout ng-submit=addPromo(promo_) class=\\\"promo-code-container icon-left icon-coupon input-inner-button promo-code\\\"> <input class=input id=checkout-cart-promo-bottom-input type=text ng-model=promo_.promo_code placeholder={{::lang.values.enterPromoCode}} aria-label={{::lang.aria.enterPromoCode}}> <button id=checkout-cart-promo-bottom-apply class=\\\"button smaller\\\" type=submit ng-if=promo_.promo_code.length>{{::lang.values.apply}}</button> </form> <button fixed-to-body ng-click=\\\"checkoutCartContinue('cart bottom continue button')\\\" id=checkout-cart-bottom-continue data-test=bottom-checkout-continue-button ng-if=\\\"cartService.cart.items.length > 0 && !showNotesSubs\\\" class=\\\"button button-checkout mobile-bottom icon-after-go right mobile-fixed\\\"> <b ng-if=::mobile.isMobile>{{cartService.getCartTotalForCurrentType() | currency}} -</b> {{::lang.values.continue}} </button> </div> </div> </div> </div> </div> \";","module.exports = \"<div id=vantiv-integration ng-controller=VantivIntegrationController scroll-into-view> <h2 class=\\\"section-divider-small section-divider-small--align-left unata-payment-action\\\"> <span class=title>{{::lang.values.selectACard}}</span> </h2> <span class=\\\"unata-payment-ct unata-payment-list\\\" ng-class=\\\"{'unata-empty-list': paymentInstruments.length === 0 }\\\"> <div class=\\\"row condensed\\\" ng-repeat=\\\"card in paymentInstruments\\\" ng-class=\\\"{'unata-selected-card': $parent.paymentInstrumentId === card.id}\\\"> <input type=radio ng-model=$parent.paymentInstrumentId value={{card.id}} id=payment-instrument-{{card.id}} name=paymentInstrumentId class=radio ng-class=\\\"{'credit-card-list-selected-card': $parent.paymentInstrumentId === card.id}\\\"/> <label for=payment-instrument-{{card.id}} class=unata-payment-option> {{::lang.template(lang.values.cardEnding, {cardNumber: card.last_four_digits})}} </label> <button ng-click=deleteCard(card) ng-if=!card.isNew class=unata-payment-action> {{::lang.values.delete}} </button> <span ng-if=card.isNew class=unata-payment-action> <input class=checkbox ng-model=card.shouldSave id=save-payment-instrument-{{card.id}} type=checkbox analytics-click=\\\"['save payment instrument checkbox', 'click']\\\" aria-label=\\\"{{::lang.values.save}} {{::lang.template(lang.values.cardEnding, {cardNumber: card.last_four_digits})}}\\\"/> <label for=save-payment-instrument-{{card.id}} analytics-click=\\\"['save payment instrument checkbox', 'click']\\\" aria-label=\\\"{{::lang.values.save}} {{::lang.template(lang.values.cardEnding, {cardNumber: card.last_four_digits})}}\\\">{{lang.values.saveInProfile}}</label> </span> </div> </span> <button ng-if=!showAddInstrument class=\\\"button action add-card unata-payment-action\\\" ng-click=addPaymentInstrument()> {{::lang.values.addCard}} </button> <div ng-show=showAddInstrument class=unata-payment-action> <div ng-if=showAddInstrumentLoader aria-label={{::lang.aria.loadingImage}} class=\\\"view-loading-indicator over-vantiv-iframe\\\"></div> <div ng-show=isRecaptchaReady> <span> <recaptcha-checkbox ng-if=recaptcha.show class=recaptcha-container action=recaptcha.action on-success=recaptcha.onRecaptchaSuccess on-expired=recaptcha.onRecaptchaExpired on-render=onRecaptchaReady /> </span> <button class=\\\"button cancel-vantiv unata-payment-action\\\" ng-click=backToCardView()> {{::lang.values.cancelTransaction}} </button> </div> <iframe ng-show=recaptcha.complete id=iframeVantiv scrolling=auto frameborder=0 style=text-align:center></iframe> </div> </div> \";","// This library has been forked from [restangular](https://www.npmjs.com/package/restangular) to remove the `lodash` dependency. The original library is not maintained.\n\n(function(root, factory) {\n  /* global define, require */\n  // https://github.com/umdjs/umd/blob/master/templates/returnExports.js\n  if (typeof define === 'function' && define.amd) {\n    define(['angular'], factory);\n  } else if (typeof module === 'object' && module.exports) {\n    module.exports = factory(require('angular'));\n  } else {\n    // No global export, Restangular will register itself as Angular.js module\n    factory(root.angular);\n  }\n}(this, function(angular) {\n\n  var restangular = angular.module('restangular', []);\n\n  restangular.provider('Restangular', function() {\n    // Configuration\n    var Configurer = {};\n    Configurer.init = function(object, config) {\n      object.configuration = config;\n\n      /**\n       * Those are HTTP safe methods for which there is no need to pass any data with the request.\n       */\n      var safeMethods = ['get', 'head', 'options', 'trace', 'getlist'];\n      config.isSafe = function(operation) {\n        return safeMethods.indexOf(operation.toLowerCase()) > -1;\n      };\n\n      var absolutePattern = /^https?:\\/\\//i;\n      config.isAbsoluteUrl = function(string) {\n        return angular.isUndefined(config.absoluteUrl) || config.absoluteUrl === null ?\n          string && absolutePattern.test(string) :\n          config.absoluteUrl;\n      };\n\n      config.absoluteUrl = angular.isUndefined(config.absoluteUrl) ? true : config.absoluteUrl;\n      object.setSelfLinkAbsoluteUrl = function(value) {\n        config.absoluteUrl = value;\n      };\n      /**\n       * This is the BaseURL to be used with Restangular\n       */\n      config.baseUrl = angular.isUndefined(config.baseUrl) ? '' : config.baseUrl;\n      object.setBaseUrl = function(newBaseUrl) {\n        config.baseUrl = /\\/$/.test(newBaseUrl) ?\n          newBaseUrl.substring(0, newBaseUrl.length - 1) :\n          newBaseUrl;\n        return this;\n      };\n\n      /**\n       * Sets the extra fields to keep from the parents\n       */\n      config.extraFields = config.extraFields || [];\n      object.setExtraFields = function(newExtraFields) {\n        config.extraFields = newExtraFields;\n        return this;\n      };\n\n      /**\n       * Some default $http parameter to be used in EVERY call\n       **/\n      config.defaultHttpFields = config.defaultHttpFields || {};\n      object.setDefaultHttpFields = function(values) {\n        config.defaultHttpFields = values;\n        return this;\n      };\n\n      /**\n       * Always return plain data, no restangularized object\n       **/\n      config.plainByDefault = config.plainByDefault || false;\n      object.setPlainByDefault = function(value) {\n        config.plainByDefault = value === true ? true : false;\n        return this;\n      };\n\n      config.withHttpValues = function(httpLocalConfig, obj) {\n        return /** _.defaults */ angular.extend(obj, httpLocalConfig, config.defaultHttpFields);\n      };\n\n      config.encodeIds = angular.isUndefined(config.encodeIds) ? true : config.encodeIds;\n      object.setEncodeIds = function(encode) {\n        config.encodeIds = encode;\n      };\n\n      config.defaultRequestParams = config.defaultRequestParams || {\n        get: {},\n        post: {},\n        put: {},\n        remove: {},\n        common: {}\n      };\n\n      object.setDefaultRequestParams = function(param1, param2) {\n        var methods = [],\n          params = param2 || param1;\n        if (!angular.isUndefined(param2)) {\n          if (angular.isArray(param1)) {\n            methods = param1;\n          } else {\n            methods.push(param1);\n          }\n        } else {\n          methods.push('common');\n        }\n\n        angular.forEach(methods, function(method) {\n          config.defaultRequestParams[method] = params;\n        });\n        return this;\n      };\n\n      object.requestParams = config.defaultRequestParams;\n\n      config.defaultHeaders = config.defaultHeaders || {};\n      object.setDefaultHeaders = function(headers) {\n        config.defaultHeaders = headers;\n        object.defaultHeaders = config.defaultHeaders;\n        return this;\n      };\n\n      object.defaultHeaders = config.defaultHeaders;\n\n      /**\n       * Method overriders will set which methods are sent via POST with an X-HTTP-Method-Override\n       **/\n      config.methodOverriders = config.methodOverriders || [];\n      object.setMethodOverriders = function(values) {\n        var overriders = angular.extend([], values);\n        if (config.isOverridenMethod('delete', overriders)) {\n          overriders.push('remove');\n        }\n        config.methodOverriders = overriders;\n        return this;\n      };\n\n      config.jsonp = angular.isUndefined(config.jsonp) ? false : config.jsonp;\n      object.setJsonp = function(active) {\n        config.jsonp = active;\n      };\n\n      config.isOverridenMethod = function(method, values) {\n        var search = values || config.methodOverriders;\n        \n        /**\n        return !angular.isUndefined(_.find(search, function(one) {\n          return one.toLowerCase() === method.toLowerCase();\n        }));\n        */\n    \n        return !angular.isUndefined(search.filter(function(one) {\n          return one.toLowerCase() === method.toLowerCase();\n        }).shift());\n      };\n\n      /**\n       * Sets the URL creator type. For now, only Path is created. In the future we'll have queryParams\n       **/\n      config.urlCreator = config.urlCreator || 'path';\n      object.setUrlCreator = function(name) {\n        if (!config.urlCreatorFactory.hasOwnProperty(name)) {\n          throw new Error('URL Path selected isn\\'t valid');\n        }\n\n        config.urlCreator = name;\n        return this;\n      };\n\n      /**\n       * You can set the restangular fields here. The 3 required fields for Restangular are:\n       *\n       * id: Id of the element\n       * route: name of the route of this element\n       * parentResource: the reference to the parent resource\n       *\n       *  All of this fields except for id, are handled (and created) by Restangular. By default,\n       *  the field values will be id, route and parentResource respectively\n       */\n      config.restangularFields = config.restangularFields || {\n        id: 'id',\n        route: 'route',\n        parentResource: 'parentResource',\n        restangularCollection: 'restangularCollection',\n        cannonicalId: '__cannonicalId',\n        etag: 'restangularEtag',\n        selfLink: 'href',\n        get: 'get',\n        getList: 'getList',\n        put: 'put',\n        post: 'post',\n        remove: 'remove',\n        head: 'head',\n        trace: 'trace',\n        options: 'options',\n        patch: 'patch',\n        getRestangularUrl: 'getRestangularUrl',\n        getRequestedUrl: 'getRequestedUrl',\n        putElement: 'putElement',\n        addRestangularMethod: 'addRestangularMethod',\n        getParentList: 'getParentList',\n        clone: 'clone',\n        ids: 'ids',\n        httpConfig: '_$httpConfig',\n        reqParams: 'reqParams',\n        one: 'one',\n        all: 'all',\n        several: 'several',\n        oneUrl: 'oneUrl',\n        allUrl: 'allUrl',\n        customPUT: 'customPUT',\n        customPATCH: 'customPATCH',\n        customPOST: 'customPOST',\n        customDELETE: 'customDELETE',\n        customGET: 'customGET',\n        customGETLIST: 'customGETLIST',\n        customOperation: 'customOperation',\n        doPUT: 'doPUT',\n        doPATCH: 'doPATCH',\n        doPOST: 'doPOST',\n        doDELETE: 'doDELETE',\n        doGET: 'doGET',\n        doGETLIST: 'doGETLIST',\n        fromServer: 'fromServer',\n        withConfig: 'withConfig',\n        withHttpConfig: 'withHttpConfig',\n        singleOne: 'singleOne',\n        plain: 'plain',\n        save: 'save',\n        restangularized: 'restangularized'\n      };\n      object.setRestangularFields = function(resFields) {\n        config.restangularFields =\n          angular.extend(config.restangularFields, resFields);\n        return this;\n      };\n\n      config.isRestangularized = function(obj) {\n        return !!obj[config.restangularFields.restangularized];\n      };\n\n      config.setFieldToElem = function(field, elem, value) {\n        var properties = field.split('.');\n        var idValue = elem;\n        angular.forEach(properties.slice(0, properties.length - 1), function(prop) {\n          idValue[prop] = {};\n          idValue = idValue[prop];\n        });\n        var length = properties === null ? 0 : properties.length;\n        var idKey = length ? properties[length - 1] : undefined;\n        idValue[idKey] = value;\n        return this;\n      };\n\n      config.getFieldFromElem = function(field, elem) {\n        var properties = field.split('.');\n        var idValue = elem;\n        angular.forEach(properties, function(prop) {\n          if (idValue) {\n            idValue = idValue[prop];\n          }\n        });\n        return angular.copy(idValue);\n      };\n\n      config.setIdToElem = function(elem, id /*, route */ ) {\n        config.setFieldToElem(config.restangularFields.id, elem, id);\n        return this;\n      };\n\n      config.getIdFromElem = function(elem) {\n        return config.getFieldFromElem(config.restangularFields.id, elem);\n      };\n\n      config.isValidId = function(elemId) {\n        return '' !== elemId && !angular.isUndefined(elemId) && elemId !== null;\n      };\n\n      config.setUrlToElem = function(elem, url /*, route */ ) {\n        config.setFieldToElem(config.restangularFields.selfLink, elem, url);\n        return this;\n      };\n\n      config.getUrlFromElem = function(elem) {\n        return config.getFieldFromElem(config.restangularFields.selfLink, elem);\n      };\n\n      config.useCannonicalId = angular.isUndefined(config.useCannonicalId) ? false : config.useCannonicalId;\n      object.setUseCannonicalId = function(value) {\n        config.useCannonicalId = value;\n        return this;\n      };\n\n      config.getCannonicalIdFromElem = function(elem) {\n        var cannonicalId = elem[config.restangularFields.cannonicalId];\n        var actualId = config.isValidId(cannonicalId) ? cannonicalId : config.getIdFromElem(elem);\n        return actualId;\n      };\n\n      /**\n       * Sets the Response parser. This is used in case your response isn't directly the data.\n       * For example if you have a response like {meta: {'meta'}, data: {name: 'Gonto'}}\n       * you can extract this data which is the one that needs wrapping\n       *\n       * The ResponseExtractor is a function that receives the response and the method executed.\n       */\n\n      config.responseInterceptors = config.responseInterceptors || [];\n\n      config.defaultResponseInterceptor = function(data /*, operation, what, url, response, deferred */ ) {\n        return data;\n      };\n\n      config.responseExtractor = function(data, operation, what, url, response, deferred) {\n        var interceptors = angular.copy(config.responseInterceptors);\n        interceptors.push(config.defaultResponseInterceptor);\n        var theData = data;\n        angular.forEach(interceptors, function(interceptor) {\n          theData = interceptor(theData, operation,\n            what, url, response, deferred);\n        });\n        return theData;\n      };\n\n      object.addResponseInterceptor = function(extractor) {\n        config.responseInterceptors.push(extractor);\n        return this;\n      };\n\n      config.errorInterceptors = config.errorInterceptors || [];\n      object.addErrorInterceptor = function(interceptor) {\n        config.errorInterceptors.push(interceptor);\n        return this;\n      };\n\n      object.setResponseInterceptor = object.addResponseInterceptor;\n      object.setResponseExtractor = object.addResponseInterceptor;\n      object.setErrorInterceptor = object.addErrorInterceptor;\n\n      /**\n       * Response interceptor is called just before resolving promises.\n       */\n\n\n      /**\n       * Request interceptor is called before sending an object to the server.\n       */\n      config.requestInterceptors = config.requestInterceptors || [];\n\n      config.defaultInterceptor = function(element, operation, path, url, headers, params, httpConfig) {\n        return {\n          element: element,\n          headers: headers,\n          params: params,\n          httpConfig: httpConfig\n        };\n      };\n\n      config.fullRequestInterceptor = function(element, operation, path, url, headers, params, httpConfig) {\n        var interceptors = angular.copy(config.requestInterceptors);\n        var defaultRequest = config.defaultInterceptor(element, operation, path, url, headers, params, httpConfig);\n        return interceptors.reduce(function(request, interceptor) {\n          return angular.extend(request, interceptor(request.element, operation,\n            path, url, request.headers, request.params, request.httpConfig));\n        }, defaultRequest);\n      };\n\n      object.addRequestInterceptor = function(interceptor) {\n        config.requestInterceptors.push(function(elem, operation, path, url, headers, params, httpConfig) {\n          return {\n            headers: headers,\n            params: params,\n            element: interceptor(elem, operation, path, url),\n            httpConfig: httpConfig\n          };\n        });\n        return this;\n      };\n\n      object.setRequestInterceptor = object.addRequestInterceptor;\n\n      object.addFullRequestInterceptor = function(interceptor) {\n        config.requestInterceptors.push(interceptor);\n        return this;\n      };\n\n      object.setFullRequestInterceptor = object.addFullRequestInterceptor;\n\n      config.onBeforeElemRestangularized = config.onBeforeElemRestangularized || function(elem) {\n        return elem;\n      };\n      object.setOnBeforeElemRestangularized = function(post) {\n        config.onBeforeElemRestangularized = post;\n        return this;\n      };\n\n      object.setRestangularizePromiseInterceptor = function(interceptor) {\n        config.restangularizePromiseInterceptor = interceptor;\n        return this;\n      };\n\n      /**\n       * This method is called after an element has been \"Restangularized\".\n       *\n       * It receives the element, a boolean indicating if it's an element or a collection\n       * and the name of the model\n       *\n       */\n      config.onElemRestangularized = config.onElemRestangularized || function(elem) {\n        return elem;\n      };\n      object.setOnElemRestangularized = function(post) {\n        config.onElemRestangularized = post;\n        return this;\n      };\n\n      config.shouldSaveParent = config.shouldSaveParent || function() {\n        return true;\n      };\n      object.setParentless = function(values) {\n        if (angular.isArray(values)) {\n          config.shouldSaveParent = function(route) {\n            return values.indexOf(route) < 0;\n          };\n        } else if (angular.isBoolean(values)) {\n          config.shouldSaveParent = function() {\n            return !values;\n          };\n        }\n        return this;\n      };\n\n      /**\n       * This lets you set a suffix to every request.\n       *\n       * For example, if your api requires that for JSon requests you do /users/123.json, you can set that\n       * in here.\n       *\n       *\n       * By default, the suffix is null\n       */\n      config.suffix = angular.isUndefined(config.suffix) ? null : config.suffix;\n      object.setRequestSuffix = function(newSuffix) {\n        config.suffix = newSuffix;\n        return this;\n      };\n\n      /**\n       * Add element transformers for certain routes.\n       */\n      config.transformers = config.transformers || {};\n      config.matchTransformers = config.matchTransformers || [];\n      object.addElementTransformer = function(type, secondArg, thirdArg) {\n        var isCollection = null;\n        var transformer = null;\n        if (arguments.length === 2) {\n          transformer = secondArg;\n        } else {\n          transformer = thirdArg;\n          isCollection = secondArg;\n        }\n\n        var transformerFn = function(coll, elem) {\n          if (isCollection === null || (coll === isCollection)) {\n            return transformer(elem);\n          }\n          return elem;\n        };\n\n        if (angular.isObject(type) && Object.prototype.toString.call(type) === '[object RegExp]') {\n          config.matchTransformers.push({\n            regexp: type,\n            transformer: transformerFn\n          });\n        } else {\n          if (!config.transformers[type]) {\n            config.transformers[type] = [];\n          }\n          config.transformers[type].push(transformerFn);\n        }\n\n        return object;\n      };\n\n      object.extendCollection = function(route, fn) {\n        return object.addElementTransformer(route, true, fn);\n      };\n\n      object.extendModel = function(route, fn) {\n        return object.addElementTransformer(route, false, fn);\n      };\n\n      config.transformElem = function(elem, isCollection, route, Restangular, force) {\n        if (!force && !config.transformLocalElements && !elem[config.restangularFields.fromServer]) {\n          return elem;\n        }\n\n        var changedElem = elem;\n\n        var matchTransformers = config.matchTransformers;\n        if (matchTransformers) {\n          angular.forEach(matchTransformers, function(transformer) {\n            if (transformer.regexp.test(route)) {\n              changedElem = transformer.transformer(isCollection, changedElem);\n            }\n          });\n        }\n\n        var typeTransformers = config.transformers[route];\n        if (typeTransformers) {\n          angular.forEach(typeTransformers, function(transformer) {\n            changedElem = transformer(isCollection, changedElem);\n          });\n        }\n        return config.onElemRestangularized(changedElem, isCollection, route, Restangular);\n      };\n\n      config.transformLocalElements = angular.isUndefined(config.transformLocalElements) ?\n        false :\n        config.transformLocalElements;\n\n      object.setTransformOnlyServerElements = function(active) {\n        config.transformLocalElements = !active;\n      };\n\n      config.fullResponse = angular.isUndefined(config.fullResponse) ? false : config.fullResponse;\n      object.setFullResponse = function(full) {\n        config.fullResponse = full;\n        return this;\n      };\n\n\n      //Internal values and functions\n      config.urlCreatorFactory = {};\n\n      /**\n       * Base URL Creator. Base prototype for everything related to it\n       **/\n\n      var BaseCreator = function() {};\n\n      BaseCreator.prototype.setConfig = function(config) {\n        this.config = config;\n        return this;\n      };\n\n      BaseCreator.prototype.parentsArray = function(current) {\n        var parents = [];\n        while (current) {\n          parents.push(current);\n          current = current[this.config.restangularFields.parentResource];\n        }\n        return parents.reverse();\n      };\n\n      function RestangularResource(config, $http, url, configurer) {\n        var resource = {};\n        angular.forEach(Object.keys(configurer), function(key) {\n          var value = configurer[key];\n\n          // Add default parameters\n          value.params = angular.extend({}, value.params, config.defaultRequestParams[value.method.toLowerCase()]);\n          // We don't want the ? if no params are there\n          if (!value.params || !(angular.isObject(value.params)) ||\n            !(angular.isArray(value.params) ? value.params : Object.keys(value.params)).length) {\n            delete value.params;\n          }\n\n          if (config.isSafe(value.method)) {\n\n            resource[key] = function() {\n              return $http(angular.extend(value, {\n                url: url\n              }));\n            };\n\n          } else {\n\n            resource[key] = function(data) {\n              return $http(angular.extend(value, {\n                url: url,\n                data: data\n              }));\n            };\n\n          }\n        });\n\n        return resource;\n      }\n\n      BaseCreator.prototype.resource = function(current, $http, localHttpConfig, callHeaders, callParams, what, etag, operation) {\n\n        var params = /** _.defaults */ angular.extend(callParams || {}, this.config.defaultRequestParams.common);\n        var headers = /** _.defaults */ angular.extend(callHeaders || {}, this.config.defaultHeaders);\n\n        if (etag) {\n          if (!config.isSafe(operation)) {\n            headers['If-Match'] = etag;\n          } else {\n            headers['If-None-Match'] = etag;\n          }\n        }\n\n        var url = this.base(current);\n\n        if (what || what === 0) {\n          var add = '';\n          if (!/\\/$/.test(url)) {\n            add += '/';\n          }\n          add += what;\n          url += add;\n        }\n\n        if (this.config.suffix &&\n          url.indexOf(this.config.suffix, url.length - this.config.suffix.length) === -1 &&\n          !this.config.getUrlFromElem(current)) {\n          url += this.config.suffix;\n        }\n\n        current[this.config.restangularFields.httpConfig] = undefined;\n\n        return RestangularResource(this.config, $http, url, {\n          getList: this.config.withHttpValues(localHttpConfig, {\n            method: 'GET',\n            params: params,\n            headers: headers\n          }),\n\n          get: this.config.withHttpValues(localHttpConfig, {\n            method: 'GET',\n            params: params,\n            headers: headers\n          }),\n\n          jsonp: this.config.withHttpValues(localHttpConfig, {\n            method: 'jsonp',\n            params: params,\n            headers: headers\n          }),\n\n          put: this.config.withHttpValues(localHttpConfig, {\n            method: 'PUT',\n            params: params,\n            headers: headers\n          }),\n\n          post: this.config.withHttpValues(localHttpConfig, {\n            method: 'POST',\n            params: params,\n            headers: headers\n          }),\n\n          remove: this.config.withHttpValues(localHttpConfig, {\n            method: 'DELETE',\n            params: params,\n            headers: headers\n          }),\n\n          head: this.config.withHttpValues(localHttpConfig, {\n            method: 'HEAD',\n            params: params,\n            headers: headers\n          }),\n\n          trace: this.config.withHttpValues(localHttpConfig, {\n            method: 'TRACE',\n            params: params,\n            headers: headers\n          }),\n\n          options: this.config.withHttpValues(localHttpConfig, {\n            method: 'OPTIONS',\n            params: params,\n            headers: headers\n          }),\n\n          patch: this.config.withHttpValues(localHttpConfig, {\n            method: 'PATCH',\n            params: params,\n            headers: headers\n          })\n        });\n      };\n\n      /**\n       * This is the Path URL creator. It uses Path to show Hierarchy in the Rest API.\n       * This means that if you have an Account that then has a set of Buildings, a URL to a building\n       * would be /accounts/123/buildings/456\n       **/\n      var Path = function() {};\n\n      Path.prototype = new BaseCreator();\n\n      Path.prototype.normalizeUrl = function(url) {\n        var parts = /((?:http[s]?:)?\\/\\/)?(.*)?/.exec(url);\n        parts[2] = parts[2].replace(/[\\\\\\/]+/g, '/');\n        return (typeof parts[1] !== 'undefined') ? parts[1] + parts[2] : parts[2];\n      };\n\n      Path.prototype.base = function(current) {\n        var __this = this;\n        return this.parentsArray(current).reduce(function(acum, elem) {\n          var elemUrl;\n          var elemSelfLink = __this.config.getUrlFromElem(elem);\n          if (elemSelfLink) {\n            if (__this.config.isAbsoluteUrl(elemSelfLink)) {\n              return elemSelfLink;\n            } else {\n              elemUrl = elemSelfLink;\n            }\n          } else {\n            elemUrl = elem[__this.config.restangularFields.route];\n\n            if (elem[__this.config.restangularFields.restangularCollection]) {\n              var ids = elem[__this.config.restangularFields.ids];\n              if (ids) {\n                elemUrl += '/' + ids.join(',');\n              }\n            } else {\n              var elemId;\n              if (__this.config.useCannonicalId) {\n                elemId = __this.config.getCannonicalIdFromElem(elem);\n              } else {\n                elemId = __this.config.getIdFromElem(elem);\n              }\n\n              if (config.isValidId(elemId) && !elem.singleOne) {\n                elemUrl += '/' + (__this.config.encodeIds ? encodeURIComponent(elemId) : elemId);\n              }\n            }\n          }\n          acum = acum.replace(/\\/$/, '') + '/' + elemUrl;\n          return __this.normalizeUrl(acum);\n\n        }, this.config.baseUrl);\n      };\n\n\n\n      Path.prototype.fetchUrl = function(current, what) {\n        var baseUrl = this.base(current);\n        if (what) {\n          baseUrl += '/' + what;\n        }\n        return baseUrl;\n      };\n\n      Path.prototype.fetchRequestedUrl = function(current, what) {\n        var url = this.fetchUrl(current, what);\n        var params = current[config.restangularFields.reqParams];\n\n        // From here on and until the end of fetchRequestedUrl,\n        // the code has been kindly borrowed from angular.js\n        // The reason for such code bloating is coherence:\n        //   If the user were to use this for cache management, the\n        //   serialization of parameters would need to be identical\n        //   to the one done by angular for cache keys to match.\n        function sortedKeys(obj) {\n          var keys = [];\n          for (var key in obj) {\n            if (obj.hasOwnProperty(key)) {\n              keys.push(key);\n            }\n          }\n          return keys.sort();\n        }\n\n        function forEachSorted(obj, iterator, context) {\n          var keys = sortedKeys(obj);\n          for (var i = 0; i < keys.length; i++) {\n            iterator.call(context, obj[keys[i]], keys[i]);\n          }\n          return keys;\n        }\n\n        function encodeUriQuery(val, pctEncodeSpaces) {\n          return encodeURIComponent(val).\n          replace(/%40/gi, '@').\n          replace(/%3A/gi, ':').\n          replace(/%24/g, '$').\n          replace(/%2C/gi, ',').\n          replace(/%20/g, (pctEncodeSpaces ? '%20' : '+'));\n        }\n\n        if (!params) {\n          return url + (this.config.suffix || '');\n        }\n\n        var parts = [];\n        forEachSorted(params, function(value, key) {\n          if (value === null || value === undefined) {\n            return;\n          }\n          if (!angular.isArray(value)) {\n            value = [value];\n          }\n\n          angular.forEach(value, function(v) {\n            if (angular.isObject(v)) {\n              v = angular.toJson(v);\n            }\n            parts.push(encodeUriQuery(key) + '=' + encodeUriQuery(v));\n          });\n        });\n\n        return url + (this.config.suffix || '') + ((url.indexOf('?') === -1) ? '?' : '&') + parts.join('&');\n      };\n\n      config.urlCreatorFactory.path = Path;\n    };\n\n    var globalConfiguration = {};\n\n    Configurer.init(this, globalConfiguration);\n\n\n\n    this.$get = ['$http', '$q', function($http, $q) {\n\n      function createServiceForConfiguration(config) {\n        var service = {};\n\n        var urlHandler = new config.urlCreatorFactory[config.urlCreator]();\n        urlHandler.setConfig(config);\n\n        function restangularizeBase(parent, elem, route, reqParams, fromServer) {\n          elem[config.restangularFields.route] = route;\n          elem[config.restangularFields.getRestangularUrl] = urlHandler.fetchUrl.bind(urlHandler, elem);\n          elem[config.restangularFields.getRequestedUrl] = urlHandler.fetchRequestedUrl.bind(urlHandler, elem);\n          elem[config.restangularFields.addRestangularMethod] = addRestangularMethodFunction.bind(elem);\n          elem[config.restangularFields.clone] = copyRestangularizedElement.bind(elem, elem);\n          elem[config.restangularFields.reqParams] = (!reqParams || !(angular.isObject(reqParams)) ||\n          !(angular.isArray(reqParams) ? reqParams : Object.keys(reqParams)).length) ? null : reqParams;\n          elem[config.restangularFields.withHttpConfig] = withHttpConfig.bind(elem);\n          elem[config.restangularFields.plain] = stripRestangular.bind(elem, elem);\n\n          // Tag element as restangularized\n          elem[config.restangularFields.restangularized] = true;\n\n          // RequestLess connection\n          elem[config.restangularFields.one] = one.bind(elem, elem);\n          elem[config.restangularFields.all] = all.bind(elem, elem);\n          elem[config.restangularFields.several] = several.bind(elem, elem);\n          elem[config.restangularFields.oneUrl] = oneUrl.bind(elem, elem);\n          elem[config.restangularFields.allUrl] = allUrl.bind(elem, elem);\n\n          elem[config.restangularFields.fromServer] = !!fromServer;\n\n          if (parent && config.shouldSaveParent(route)) {\n            var parentId = config.getIdFromElem(parent);\n            var parentUrl = config.getUrlFromElem(parent);\n            var pickedFields = [];\n            ['route', 'singleOne', 'parentResource'].forEach(function(field) {\n              if (config.restangularFields.hasOwnProperty(field)) {\n                pickedFields.push(config.restangularFields[field]);\n              }\n            });\n            var pickedValues = Object.keys(pickedFields).map(function(key) {\n              return pickedFields[key];\n            });\n\n            /**\n            var restangularFieldsForParent = _.union(\n              pickedValues,\n              config.extraFields\n            );\n            */\n            var restangularFieldsForParent = angular.merge(pickedValues, config.extraFields);\n\n            var parentResource = {};\n            restangularFieldsForParent.forEach(function(field) {\n              if (parent.hasOwnProperty(field)) {\n                parentResource[field] = parent[field];\n              }\n            });\n\n            if (config.isValidId(parentId)) {\n              config.setIdToElem(parentResource, parentId, route);\n            }\n            if (config.isValidId(parentUrl)) {\n              config.setUrlToElem(parentResource, parentUrl, route);\n            }\n\n            elem[config.restangularFields.parentResource] = parentResource;\n          } else {\n            elem[config.restangularFields.parentResource] = null;\n          }\n          return elem;\n        }\n\n        function one(parent, route, id, singleOne) {\n          var error;\n          if (angular.isNumber(route) || angular.isNumber(parent)) {\n            error = 'You\\'re creating a Restangular entity with the number ';\n            error += 'instead of the route or the parent. For example, you can\\'t call .one(12).';\n            throw new Error(error);\n          }\n          if (angular.isUndefined(route)) {\n            error = 'You\\'re creating a Restangular entity either without the path. ';\n            error += 'For example you can\\'t call .one(). Please check if your arguments are valid.';\n            throw new Error(error);\n          }\n          var elem = {};\n          config.setIdToElem(elem, id, route);\n          config.setFieldToElem(config.restangularFields.singleOne, elem, singleOne);\n          return restangularizeElem(parent, elem, route, false);\n        }\n\n\n        function all(parent, route) {\n          return restangularizeCollection(parent, [], route, false);\n        }\n\n        function several(parent, route /*, ids */ ) {\n          var collection = [];\n          collection[config.restangularFields.ids] = Array.prototype.splice.call(arguments, 2);\n          return restangularizeCollection(parent, collection, route, false);\n        }\n\n        function oneUrl(parent, route, url) {\n          if (!route) {\n            throw new Error('Route is mandatory when creating new Restangular objects.');\n          }\n          var elem = {};\n          config.setUrlToElem(elem, url, route);\n          return restangularizeElem(parent, elem, route, false);\n        }\n\n\n        function allUrl(parent, route, url) {\n          if (!route) {\n            throw new Error('Route is mandatory when creating new Restangular objects.');\n          }\n          var elem = {};\n          config.setUrlToElem(elem, url, route);\n          return restangularizeCollection(parent, elem, route, false);\n        }\n        // Promises\n        function restangularizePromise(promise, isCollection, valueToFill) {\n          promise.call = promiseCall.bind(promise);\n          promise.get = promiseGet.bind(promise);\n          promise[config.restangularFields.restangularCollection] = isCollection;\n          if (isCollection) {\n            promise.push = promiseCall.bind(promise, 'push');\n          }\n          promise.$object = valueToFill;\n          if (config.restangularizePromiseInterceptor) {\n            config.restangularizePromiseInterceptor(promise);\n          }\n          return promise;\n        }\n\n        function promiseCall(method) {\n          var deferred = $q.defer();\n          var callArgs = arguments;\n          var filledValue = {};\n          this.then(function(val) {\n            var params = Array.prototype.slice.call(callArgs, 1);\n            var func = val[method];\n            func.apply(val, params);\n            filledValue = val;\n            deferred.resolve(val);\n          });\n          return restangularizePromise(deferred.promise, this[config.restangularFields.restangularCollection], filledValue);\n        }\n\n        function promiseGet(what) {\n          var deferred = $q.defer();\n          var filledValue = {};\n          this.then(function(val) {\n            filledValue = val[what];\n            deferred.resolve(filledValue);\n          });\n          return restangularizePromise(deferred.promise, this[config.restangularFields.restangularCollection], filledValue);\n        }\n\n        function resolvePromise(deferred, response, data, filledValue) {\n          angular.extend(filledValue, data);\n\n          // Trigger the full response interceptor.\n          if (config.fullResponse) {\n            return deferred.resolve(angular.extend(response, {\n              data: data\n            }));\n          } else {\n            deferred.resolve(data);\n          }\n        }\n\n\n        // Elements\n        function stripRestangular(elem) {\n          if (angular.isArray(elem)) {\n            var array = [];\n            angular.forEach(elem, function(value) {\n              array.push(config.isRestangularized(value) ? stripRestangular(value) : value);\n            });\n            return array;\n          }\n          \n          var newElem = angular.extend({}, elem);\n          Object.keys(config.restangularFields).forEach(function(key) {\n            key !== 'id' && delete newElem[config.restangularFields[key]];\n          });\n\n          return newElem;\n        }\n\n        function addCustomOperation(elem) {\n          elem[config.restangularFields.customOperation] = customFunction.bind(elem);\n          var requestMethods = {\n            get: customFunction,\n            delete: customFunction\n          };\n          angular.forEach(['put', 'patch', 'post'], function(name) {\n            requestMethods[name] = function(operation, elem, path, params, headers) {\n              return customFunction.bind(this)(operation, path, params, headers, elem);\n            };\n          });\n          angular.forEach(requestMethods, function(requestFunc, name) {\n            var callOperation = name === 'delete' ? 'remove' : name;\n            angular.forEach(['do', 'custom'], function(alias) {\n              elem[config.restangularFields[alias + name.toUpperCase()]] = requestFunc.bind(elem, callOperation);\n            });\n          });\n          elem[config.restangularFields.customGETLIST] = fetchFunction.bind(elem);\n          elem[config.restangularFields.doGETLIST] = elem[config.restangularFields.customGETLIST];\n        }\n\n        function copyRestangularizedElement(element) {\n          var copiedElement = angular.copy(element);\n\n          // check if we're dealing with a collection (i.e. an array)\n          // and restangularize the element using the proper restangularizer,\n          // element / collection\n          if (angular.isArray(element)) {\n            return restangularizeCollection(\n              element[config.restangularFields.parentResource],\n              copiedElement,\n              element[config.restangularFields.route],\n              element[config.restangularFields.fromServer],\n              element[config.restangularFields.reqParams]\n            );\n          }\n\n          // not a collection, restangularize it as an element\n          return restangularizeElem(\n            element[config.restangularFields.parentResource],\n            copiedElement,\n            element[config.restangularFields.route],\n            element[config.restangularFields.fromServer],\n            element[config.restangularFields.restangularCollection],\n            element[config.restangularFields.reqParams]\n          );\n        }\n\n        function restangularizeElem(parent, element, route, fromServer, collection, reqParams) {\n          var elem = config.onBeforeElemRestangularized(element, false, route);\n\n          var localElem = restangularizeBase(parent, elem, route, reqParams, fromServer);\n\n          if (config.useCannonicalId) {\n            localElem[config.restangularFields.cannonicalId] = config.getIdFromElem(localElem);\n          }\n\n          if (collection) {\n            localElem[config.restangularFields.getParentList] = function() {\n              return collection;\n            };\n          }\n\n          localElem[config.restangularFields.restangularCollection] = false;\n          localElem[config.restangularFields.get] = getFunction.bind(localElem);\n          localElem[config.restangularFields.getList] = fetchFunction.bind(localElem);\n          localElem[config.restangularFields.put] = putFunction.bind(localElem);\n          localElem[config.restangularFields.post] = postFunction.bind(localElem);\n          localElem[config.restangularFields.remove] = deleteFunction.bind(localElem);\n          localElem[config.restangularFields.head] = headFunction.bind(localElem);\n          localElem[config.restangularFields.trace] = traceFunction.bind(localElem);\n          localElem[config.restangularFields.options] = optionsFunction.bind(localElem);\n          localElem[config.restangularFields.patch] = patchFunction.bind(localElem);\n          localElem[config.restangularFields.save] = save.bind(localElem);\n\n          addCustomOperation(localElem);\n          return config.transformElem(localElem, false, route, service, true);\n        }\n\n        function restangularizeCollection(parent, element, route, fromServer, reqParams) {\n          var elem = config.onBeforeElemRestangularized(element, true, route);\n\n          var localElem = restangularizeBase(parent, elem, route, reqParams, fromServer);\n          localElem[config.restangularFields.restangularCollection] = true;\n          localElem[config.restangularFields.post] = postFunction.bind(localElem, null);\n          localElem[config.restangularFields.remove] = deleteFunction.bind(localElem);\n          localElem[config.restangularFields.head] = headFunction.bind(localElem);\n          localElem[config.restangularFields.trace] = traceFunction.bind(localElem);\n          localElem[config.restangularFields.putElement] = putElementFunction.bind(localElem);\n          localElem[config.restangularFields.options] = optionsFunction.bind(localElem);\n          localElem[config.restangularFields.patch] = patchFunction.bind(localElem);\n          localElem[config.restangularFields.get] = getById.bind(localElem);\n          localElem[config.restangularFields.getList] = fetchFunction.bind(localElem, null);\n\n          addCustomOperation(localElem);\n          return config.transformElem(localElem, true, route, service, true);\n        }\n\n        function restangularizeCollectionAndElements(parent, element, route, fromServer) {\n          var collection = restangularizeCollection(parent, element, route, fromServer);\n          angular.forEach(collection, function(elem) {\n            if (elem) {\n              restangularizeElem(parent, elem, route, fromServer);\n            }\n          });\n          return collection;\n        }\n\n        function getById(id, reqParams, headers) {\n          return this.customGET(id.toString(), reqParams, headers);\n        }\n\n        function putElementFunction(idx, params, headers) {\n          var __this = this;\n          var elemToPut = this[idx];\n          var deferred = $q.defer();\n          var filledArray = [];\n          filledArray = config.transformElem(filledArray, true, elemToPut[config.restangularFields.route], service);\n          elemToPut.put(params, headers).then(function(serverElem) {\n            var newArray = copyRestangularizedElement(__this);\n            newArray[idx] = serverElem;\n            filledArray = newArray;\n            deferred.resolve(newArray);\n          }, function(response) {\n            deferred.reject(response);\n          });\n\n          return restangularizePromise(deferred.promise, true, filledArray);\n        }\n\n        function parseResponse(resData, operation, route, fetchUrl, response, deferred) {\n          var data = config.responseExtractor(resData, operation, route, fetchUrl, response, deferred);\n          var etag = response.headers('ETag');\n          if (data && etag) {\n            data[config.restangularFields.etag] = etag;\n          }\n          return data;\n        }\n\n\n        function fetchFunction(what, reqParams, headers) {\n          var __this = this;\n          var deferred = $q.defer();\n          var operation = 'getList';\n          var url = urlHandler.fetchUrl(this, what);\n          var whatFetched = what || __this[config.restangularFields.route];\n\n          var request = config.fullRequestInterceptor(null, operation,\n            whatFetched, url, headers || {}, reqParams || {}, this[config.restangularFields.httpConfig] || {});\n\n          var filledArray = [];\n          filledArray = config.transformElem(filledArray, true, whatFetched, service);\n\n          var method = 'getList';\n\n          if (config.jsonp) {\n            method = 'jsonp';\n          }\n\n          var okCallback = function(response) {\n            var resData = response.data;\n            var fullParams = response.config.params;\n            var data = parseResponse(resData, operation, whatFetched, url, response, deferred);\n\n            // support empty response for getList() calls (some APIs respond with 204 and empty body)\n            if (angular.isUndefined(data) || '' === data) {\n              data = [];\n            }\n            if (!angular.isArray(data)) {\n              throw new Error('Response for getList SHOULD be an array and not an object or something else');\n            }\n\n            if (true === config.plainByDefault) {\n              return resolvePromise(deferred, response, data, filledArray);\n            }\n\n            var processedData = data.map(function(elem) {\n              if (!__this[config.restangularFields.restangularCollection]) {\n                return restangularizeElem(__this, elem, what, true, data);\n              } else {\n                return restangularizeElem(__this[config.restangularFields.parentResource],\n                  elem, __this[config.restangularFields.route], true, data);\n              }\n            });\n\n            processedData = angular.extend(data, processedData);\n\n            if (!__this[config.restangularFields.restangularCollection]) {\n              resolvePromise(\n                deferred,\n                response,\n                restangularizeCollection(\n                  __this,\n                  processedData,\n                  what,\n                  true,\n                  fullParams\n                ),\n                filledArray\n              );\n            } else {\n              resolvePromise(\n                deferred,\n                response,\n                restangularizeCollection(\n                  __this[config.restangularFields.parentResource],\n                  processedData,\n                  __this[config.restangularFields.route],\n                  true,\n                  fullParams\n                ),\n                filledArray\n              );\n            }\n          };\n\n          urlHandler.resource(this, $http, request.httpConfig, request.headers, request.params, what,\n            this[config.restangularFields.etag], operation)[method]().then(okCallback, function error(response) {\n            if (response.status === 304 && __this[config.restangularFields.restangularCollection]) {\n              resolvePromise(deferred, response, __this, filledArray);\n            } else if (config.errorInterceptors.every(function(cb) {\n                return cb(response, deferred, okCallback) !== false;\n              })) {\n              // triggered if no callback returns false\n              deferred.reject(response);\n            }\n          });\n\n          return restangularizePromise(deferred.promise, true, filledArray);\n        }\n\n        function withHttpConfig(httpConfig) {\n          this[config.restangularFields.httpConfig] = httpConfig;\n          return this;\n        }\n\n        function save(params, headers) {\n          if (this[config.restangularFields.fromServer]) {\n            return this[config.restangularFields.put](params, headers);\n          } else {\n            return elemFunction.bind(this)('post', undefined, params, undefined, headers);\n          }\n        }\n\n        function elemFunction(operation, what, params, obj, headers) {\n          var __this = this;\n          var deferred = $q.defer();\n          var resParams = params || {};\n          var route = what || this[config.restangularFields.route];\n          var fetchUrl = urlHandler.fetchUrl(this, what);\n\n          var callObj = obj || this;\n          // fallback to etag on restangular object (since for custom methods we probably don't explicitly specify the etag field)\n          var etag = callObj[config.restangularFields.etag] || (operation !== 'post' ? this[config.restangularFields.etag] : null);\n\n          if (angular.isObject(callObj) && config.isRestangularized(callObj)) {\n            callObj = stripRestangular(callObj);\n          }\n          var request = config.fullRequestInterceptor(callObj, operation, route, fetchUrl,\n            headers || {}, resParams || {}, this[config.restangularFields.httpConfig] || {});\n\n          var filledObject = {};\n          filledObject = config.transformElem(filledObject, false, route, service);\n\n          var okCallback = function(response) {\n            var resData = response.data;\n            var fullParams = response.config.params;\n            var elem = parseResponse(resData, operation, route, fetchUrl, response, deferred);\n\n            // accept 0 as response\n            if (elem !== null && elem !== undefined && elem !== '') {\n              var data;\n\n              if (true === config.plainByDefault) {\n                return resolvePromise(deferred, response, elem, filledObject);\n              }\n\n              if (operation === 'post' && !__this[config.restangularFields.restangularCollection]) {\n                data = restangularizeElem(\n                  __this[config.restangularFields.parentResource],\n                  elem,\n                  route,\n                  true,\n                  null,\n                  fullParams\n                );\n                resolvePromise(deferred, response, data, filledObject);\n              } else {\n                data = restangularizeElem(\n                  __this[config.restangularFields.parentResource],\n                  elem,\n                  __this[config.restangularFields.route],\n                  true,\n                  null,\n                  fullParams\n                );\n\n                data[config.restangularFields.singleOne] = __this[config.restangularFields.singleOne];\n                resolvePromise(deferred, response, data, filledObject);\n              }\n\n            } else {\n              resolvePromise(deferred, response, undefined, filledObject);\n            }\n          };\n\n          var errorCallback = function(response) {\n            if (response.status === 304 && config.isSafe(operation)) {\n              resolvePromise(deferred, response, __this, filledObject);\n            } else if (config.errorInterceptors.every(function(cb) {\n                return cb(response, deferred, okCallback) !== false;\n              })) {\n              // triggered if no callback returns false\n              deferred.reject(response);\n            }\n          };\n          // Overriding HTTP Method\n          var callOperation = operation;\n          var callHeaders = angular.extend({}, request.headers);\n          var isOverrideOperation = config.isOverridenMethod(operation);\n          if (isOverrideOperation) {\n            callOperation = 'post';\n            callHeaders = angular.extend(callHeaders, {\n              'X-HTTP-Method-Override': operation === 'remove' ? 'DELETE' : operation.toUpperCase()\n            });\n          } else if (config.jsonp && callOperation === 'get') {\n            callOperation = 'jsonp';\n          }\n\n          if (config.isSafe(operation)) {\n            if (isOverrideOperation) {\n              urlHandler.resource(this, $http, request.httpConfig, callHeaders, request.params,\n                what, etag, callOperation)[callOperation]({}).then(okCallback, errorCallback);\n            } else {\n              urlHandler.resource(this, $http, request.httpConfig, callHeaders, request.params,\n                what, etag, callOperation)[callOperation]().then(okCallback, errorCallback);\n            }\n          } else {\n            urlHandler.resource(this, $http, request.httpConfig, callHeaders, request.params,\n              what, etag, callOperation)[callOperation](request.element).then(okCallback, errorCallback);\n          }\n\n          return restangularizePromise(deferred.promise, false, filledObject);\n        }\n\n        function getFunction(params, headers) {\n          return elemFunction.bind(this)('get', undefined, params, undefined, headers);\n        }\n\n        function deleteFunction(params, headers) {\n          return elemFunction.bind(this)('remove', undefined, params, undefined, headers);\n        }\n\n        function putFunction(params, headers) {\n          return elemFunction.bind(this)('put', undefined, params, undefined, headers);\n        }\n\n        function postFunction(what, elem, params, headers) {\n          return elemFunction.bind(this)('post', what, params, elem, headers);\n        }\n\n        function headFunction(params, headers) {\n          return elemFunction.bind(this)('head', undefined, params, undefined, headers);\n        }\n\n        function traceFunction(params, headers) {\n          return elemFunction.bind(this)('trace', undefined, params, undefined, headers);\n        }\n\n        function optionsFunction(params, headers) {\n          return elemFunction.bind(this)('options', undefined, params, undefined, headers);\n        }\n\n        function patchFunction(elem, params, headers) {\n          return elemFunction.bind(this)('patch', undefined, params, elem, headers);\n        }\n\n        function customFunction(operation, path, params, headers, elem) {\n          return elemFunction.bind(this)(operation, path, params, elem, headers);\n        }\n\n        function addRestangularMethodFunction(name, operation, path, defaultParams, defaultHeaders, defaultElem) {\n          var bindedFunction;\n          if (operation === 'getList') {\n            bindedFunction = fetchFunction.bind(this, path);\n          } else {\n            bindedFunction = customFunction.bind(this, operation, path);\n          }\n\n          var createdFunction = function(params, headers, elem) {\n            var callParams = /** _.defaults */ angular.extend({\n              params: params,\n              headers: headers,\n              elem: elem\n            }, {\n              params: defaultParams,\n              headers: defaultHeaders,\n              elem: defaultElem\n            });\n            return bindedFunction(callParams.params, callParams.headers, callParams.elem);\n          };\n\n          if (config.isSafe(operation)) {\n            this[name] = createdFunction;\n          } else {\n            this[name] = function(elem, params, headers) {\n              return createdFunction(params, headers, elem);\n            };\n          }\n        }\n\n        function withConfigurationFunction(configurer) {\n          var newConfig = angular.copy(config);\n          delete newConfig.configuration;\n          Configurer.init(newConfig, newConfig);\n          configurer(newConfig);\n          return createServiceForConfiguration(newConfig);\n        }\n\n        function toService(route, parent) {\n          var knownCollectionMethods = Object.keys(config.restangularFields).map(function(key) {\n              return config.restangularFields[key];\n          });\n          var serv = {};\n          var collection = (parent || service).all(route);\n          serv.one = one.bind((parent || service), parent, route);\n          serv.post = collection.post.bind(collection);\n          serv.getList = collection.getList.bind(collection);\n          serv.withHttpConfig = collection.withHttpConfig.bind(collection);\n          serv.get = collection.get.bind(collection);\n\n          for (var prop in collection) {\n            if (collection.hasOwnProperty(prop) && angular.isFunction(collection[prop]) && knownCollectionMethods.indexOf(prop)< 0) {\n              serv[prop] = collection[prop].bind(collection);\n            }\n          }\n\n          return serv;\n        }\n\n\n        Configurer.init(service, config);\n\n        service.copy = copyRestangularizedElement.bind(service);\n\n        service.service = toService.bind(service);\n\n        service.withConfig = withConfigurationFunction.bind(service);\n\n        service.one = one.bind(service, null);\n\n        service.all = all.bind(service, null);\n\n        service.several = several.bind(service, null);\n\n        service.oneUrl = oneUrl.bind(service, null);\n\n        service.allUrl = allUrl.bind(service, null);\n\n        service.stripRestangular = stripRestangular.bind(service);\n\n        service.restangularizeElement = restangularizeElem.bind(service);\n\n        service.restangularizeCollection = restangularizeCollectionAndElements.bind(service);\n\n        return service;\n      }\n\n      return createServiceForConfiguration(globalConfiguration);\n    }];\n  });\n  return restangular.name;\n}));\n","module.exports = \"<div class=cancellation-step> <div class=cancellation-step__title ng-bind-html=\\\"\\n      $ctrl.lang.template(\\n        $ctrl.config.icExpress.cancellation.firstStep.title,\\n        { user: $ctrl.auth.user.first_name }\\n      )\\n    \\\"></div> <p class=cancellation-step__sub-title> {{::$ctrl.getSubtitle()}} </p> <ic-express-ad ng-if=$ctrl.adList.length list=$ctrl.adList cancellation-date={{$ctrl.express.getMembershipEndDate().format($ctrl.EXPIRATION_DATE_FORMAT)}} enable-retailer-theme=$ctrl.config.icExpress.enableRetailerTheme></ic-express-ad> <p class=\\\"cancellation-step__sub-title cancellation-step__sub-title--zero-margin\\\"> {{::$ctrl.getBottomText()}} </p> <div class=cancellation-step__actions ng-class=\\\"{ 'ic-theme': $ctrl.useIcTheme }\\\"> <div class=cancellation-step__action-reminder> <button class=\\\"button button--squared\\\" ng-click=$ctrl.onSendReminderClick()> {{::$ctrl.config.icExpress.cancellation.sendReminder}} </button> <div class=cancellation-step__action-details> {{::$ctrl.getRenewReminderText()}} </div> </div> <div class=cancellation-step__action-cancel> <button ng-click=$ctrl.onContinueClick() class=\\\"button button--squared\\\"> {{::$ctrl.config.icExpress.cancellation.continue}} </button> </div> </div> <div class=cancellation-step__tos ng-bind-html=$ctrl.termsOfService></div> </div>\";","module.exports = \"<div class=modal-container> <div class=modal-header> <button class=close ng-click=$close() analytics-click=\\\"['light box close button', 'click']\\\" aria-label={{::lang.aria.modalClose}}> <span class=icon-delete aria-hidden=true></span> </button> </div> <div class=\\\"light-box-content modal-content\\\"> <img ng-src={{::imageUrl}} alt={{::lang.aria.contentImageAlt}} /> </div> </div> \";","module.exports = \"<div class=cart-compare-state> <div class=client-logo> <img src=\" + require(\"assets/images/header-logo.svg\") + \" alt={{::lang.values.clientName}}> </div> <div class=\\\"compare-cart-modal modal-container\\\"> <div class=\\\"compare-cart-content modal-content\\\" ng-if=cartCompareLoaded> <cart-compare></cart-compare> </div> <div ng-if=cartCompareLoaded ng-class=\\\"::{ 'row buttons-box': !mobile.isMobile, 'buttons': mobile.isMobile }\\\" class=\\\"buttons cart-compare-buttons\\\"> <button ng-if=canProceed ng-click=redirect() class=button ng-class=\\\"::{ 'hollow': !mobile.isMobile, 'mobile-bottom dark': mobile.isMobile }\\\" analytics-click=\\\"['compareCart modal cancel button', 'click']\\\"> {{ canProceed ? lang.values.cancel : lang.values.ok }} </button> <button ng-click=updateStoreAndRedirect() class=button ng-class=\\\"::{ 'mobile-bottom': mobile.isMobile }\\\" analytics-click=\\\"['compareCart modal continue button', 'click']\\\"> {{::lang.values.continueAnyway}} </button> </div> </div> </div> \";","module.exports = \"<div ng-if=\\\"isProductInStock || !isProductInStock && enableOutOfStockAdd\\\"> <button data-test=add-to-cart-button ng-click=\\\"\\n      tellParents();\\n      cartService.addItem(product, 1, product.uoms[0]);\\n      productsService.getBeacon(product.onAddToCartBeacon);\\n      accessibleItemAdded();\\n      cartAnalytics.addItem(product, 1, index, location, locationValue, { is_modal: isModal, corner_distance: getCornerDistance() });\\n      analytics.logFBAddToCart(product);\\n      appReviewCheck();\\n      onTrigger();\\n    \\\" analytics-click=\\\"['add to cart product add button', 'click']\\\" send-analytics=!$root.modifyingOrder id=\\\"add-to-cart-button-cart-service-add-item-{{ product.id + idStringContext }}\\\" aria-label=\\\"{{ addButtonARIALabel }}\\\" ng-if=\\\"(cartItem.quantity === 0 || !cartItem.quantity) && !isConfigurableProduct && !product.order_by_weight\\\" class=\\\"add-to-cart-trigger icon-after-plus\\\"> </button> <span id=add-to-cart-ada-increment-{{product.id}} class=screen-reader-text tabindex=-1 aria-live=polite></span> <button aria-label={{::lang.aria.addItem}} ng-if=\\\"cartItem.quantity > 0 && !isConfigurableProduct && !product.order_by_weight\\\" class=\\\"add-to-cart-trigger is-inverted\\\" ng-class=\\\"{\\n      'is-fluid' : cartItem.quantity > 9\\n    }\\\" ng-click=onTrigger()> {{cartItem.quantity}} </button> <button data-test=add-to-cart-button-weight ng-click=onTrigger() id=\\\"add-to-cart-button-cart-service-add-weight-{{ product.id + idStringContext }}\\\" aria-label=\\\"{{ addButtonARIALabel }}\\\" ng-if=\\\"(cartItem.quantity === 0 || !cartItem.quantity) && !isConfigurableProduct && product.order_by_weight\\\" class=\\\"add-to-cart-trigger icon-after-plus\\\"> </button> <button aria-label={{::lang.aria.addItem}} ng-if=\\\"cartItem.quantity > 0 && !isConfigurableProduct && product.order_by_weight\\\" class=\\\"add-to-cart-trigger is-inverted is-fluid\\\" ng-click=onTrigger()> {{ quantity }} {{ product.ordering_parameters.display_name }} </button> </div>\";","module.exports = \"<div> <div ng-include=\\\"'pageHeader.desktop.html'\\\" ng-if=\\\":: !mobileService.isMobile && !isSearchState\\\"></div> <div ng-include=\\\"'pageHeader.mobile.html'\\\" ng-if=\\\"::mobileService.isMobile && !isSearchState\\\"></div> <div ng-include=\\\"'pageHeader.search.desktop.html'\\\" ng-if=\\\":: !mobileService.isMobile && isSearchState\\\"></div> <div ng-include=\\\"'pageHeader.search.mobile.html'\\\" ng-if=\\\"::mobileService.isMobile && isSearchState\\\"></div> </div> \";","module.exports = \"<div class=\\\"page-header full-width\\\" ng-class=\\\"{'no-breadcrumbs': !breadcrumbs, 'no-label': !label, 'has-search-tabs': showSearchTabs, 'no-background-border': noBackgroundBorder, 'faceted-tag-crumbs': hasFacetedSearchFilters && facetedSearchService.tagCrumbsArray.length, 'has-background': enableBackground }\\\"> <div class=wrapper> <nav aria-label=breadcrumbs> <ul class=breadcrumbs ng-if=\\\"breadcrumbs.length > 0\\\"> <li> <a ui-sref=main.home class=all analytics-click=\\\"['breadcrumbs home link', 'click']\\\" aria-label={{::lang.aria.goToHomepage}}> <span class=icon-home aria-hidden=true></span> </a> </li> <li ng-repeat=\\\"breadcrumb in breadcrumbs track by $index\\\"> <span class=divider></span> <a ng-if=breadcrumb.state ng-attr-href=\\\"{{state.href(breadcrumb.state, breadcrumb.params)}}\\\" analytics-click=\\\"['breadcrumbs link', 'click']\\\" ng-class=\\\"{active: $index == breadcrumbs.length - 1}\\\">{{breadcrumb.label}}</a> <span ng-if=!breadcrumb.state ng-class=\\\"{active: $index == breadcrumbs.length - 1}\\\" data-test=breadcrumb-label>{{breadcrumb.label}}</span> </li> </ul> </nav> <h1 class=label data-test=department-title> {{label}} <loading-dots show=loading></loading-dots> <faceted-search-tag-crumbs ng-if=\\\"::(!state.is('main.shop.offers') && !state.is('main.shop.coupons'))\\\"></faceted-search-tag-crumbs> </h1> <ul class=search-tabs ng-if=::showSearchTabs> <li ng-repeat=\\\"tab in tabs\\\" class=tabs ng-class=\\\"{'active': tab.label === activeTab.label}\\\"> <a ui-sref={{::tab.state}}> <span aria-label=\\\"{::tab.label}}{{tab.label === activeTab.label ? ', ' + lang.values.current : ''}}\\\">{{::tab.label}}</span> </a> </li> </ul> <div class=page-header-right-section> <flyer-preview flyer-data=flyerData preview-token=\\\"{{:: previewToken}}\\\"></flyer-preview> <button id=unata-loyalty-add-promo-code class=\\\"button small\\\" ng-if=button ng-click=button.onclick()> {{button.label}} </button> <a class=\\\"button small\\\" ng-if=\\\"link.href || link.sref\\\" ng-href=\\\"{{link.href || state.href(link.sref)}}\\\" ng-attr-target={{link.target}} analytics-click=\\\"['{{link.eventName}}', 'click']\\\">{{link.label}} <span ng-if=flyerData ng-class=\\\"{ 'icon-after-pdf': !config.hideFlyerButtonIcon }\\\" aria-hidden=true></span></a> </div> </div> <div class=background ng-if=enableBackground ng-attr-style=\\\"background-image: url('{{background}}')\\\"></div> </div> \";","module.exports = \"<div class=delivery-zip-code> <button ng-click=handleClick() ng-disabled=$root.modifyingInstacartOrder>{{ label }}</button> </div> \";","module.exports = \"<div class=external-page> <iframe ng-src={{src}} frameborder=0></iframe> </div> \";","module.exports = \"<div class=reservation> <div ui-view=reservation></div> </div>\";","module.exports = \"<div analytics-product-impression=\\\"[product, location, position]\\\" send-analytics=!$root.modifyingOrder> <react-item-tile product=product></react-item-tile> </div> \";","module.exports = \"<div class=shopping-confirmation ng-controller=ShoppingSelectorConfirmationController> <div class=shopping-context-main-content ng-class=\\\"{'no-top-padding': mobile.isMobile}\\\"> <h1>{{auth.user.first_name ? 'Hi ' + auth.user.first_name : unifiedWelcomeMessage()}},</h1> <p>{{::lang.values.hereIsHowYoureCurrentlyShopping}}</p> </div> <div class=shopping-context-table> <table role=presentation class=table> <tbody> <tr ng-if=\\\"config.multipleBanners.enabled && shopContextIntent === 'delivery'\\\"> <td class=table-highlight>{{::lang.values.from}}</td> <td> <banner-image ng-if=hasBannerImage banner-slug=bannerSlug></banner-image> {{bannerName}} </td> <td> <button ng-if=!reservationService.previewTimeslot id=shopping-selector-set-shopping-selector-stage-banner class=table-highlight ng-click=changeBanner() ng-disabled=$root.modifyingInstacartOrder aria-label={{::lang.aria.changeBanner}}> {{::lang.values.change}} </button> </td> </tr> <tr> <td class=table-highlight width=60> <span class=icon ng-class=\\\"{'icon-pickup': shopContextIntent == 'pickup', 'icon-delivery': shopContextIntent == 'delivery', 'icon-list': shopContextIntent == 'instore'}\\\" aria-hidden=true></span> </td> <td class=capitalize>{{ shoppingContextService.getShoppingModeTitle() }}</td> <td width=60> <button class=table-highlight id=shopping-selector-set-shopping-selector-stage-shopping-context ng-if=::showChangeLink ng-click=\\\"$parent.setShoppingSelectorStage('shoppingContext')\\\" aria-label={{::lang.aria.changeShoppingMode}} ng-disabled=$root.modifyingInstacartOrder> {{::lang.values.change}} </button> </td> </tr> <tr> <td ng-if=\\\"shopContextIntent === 'delivery'\\\" class=\\\"table-highlight capitalize\\\"> {{::lang.values.to}} </td> <td ng-if=\\\"shopContextIntent !== 'delivery'\\\" class=\\\"table-highlight capitalize\\\"> {{::lang.values.atStore}} </td> <td ng-if=\\\"shopContextIntent === 'delivery' && auth.user.context.deliveryPostalCode && !deliveryAddress\\\"> <span ng-if=auth.user.context.street_address>{{auth.user.context.street_address}}, </span> <span>{{auth.user.context.deliveryPostalCode}}</span> </td> <td class=delivery-address-cell ng-if=\\\"shopContextIntent === 'delivery' && auth.user.context.deliveryPostalCode && deliveryAddress\\\"> <p ng-if=deliveryAddress.address1>{{deliveryAddress.address1}}</p> <p ng-if=\\\"!deliveryAddress.address1 && deliveryAddress.postal_code\\\"> {{deliveryAddress.postal_code}} </p> </td> <td ng-if=\\\"shopContextIntent !== 'delivery' && auth.user.store.name\\\"> <span ng-if=::config.multipleBanners.enabled> <banner-image banner-slug=auth.user.store.store_banner.key></banner-image> </span> {{auth.user.store.name}}{{ shopContextIntent === 'pickup' && !auth.userStoreSupportsPickup() ? ' (No Pickup)' : '' }} </td> <td> <button id=shopping-selector-set-shopping-selector-stage-store-selector class=table-highlight ng-click=changeStoreOrZipcode() ng-disabled=$root.modifyingInstacartOrder aria-label={{::lang.aria.changeStore}}> {{::lang.values.change}} </button> </td> </tr> <tr ng-if=\\\"shopContextIntent !== 'instore' && !(config.hideTimeslotReservationFromTrialUsers && auth.user.status === 'trial')\\\"> <td class=table-highlight ng-if=!reservationService.previewTimeslot>On</td> <td class=table-highlight ng-if=reservationService.previewTimeslot> {{::lang.values.timeslotAvailable}} </td> <td>{{timeslotLabelFn()}}</td> <td> <button ng-if=!reservationService.previewTimeslot id=shopping-selector-set-shopping-selector-stage-timeslot class=table-highlight ng-click=changeTimeslot() aria-label={{::lang.aria.changeTimeslot}}> {{::lang.values.change}} </button> <button ng-if=reservationService.previewTimeslot id=shopping-selector-set-shopping-selector-stage-timeslot class=table-highlight ng-click=changeTimeslot() aria-label={{::lang.aria.timeslotView}}> {{::lang.values.timeslotView}} </button> </td> </tr> </tbody> </table> <button ng-if=::mobile.isMobile id=shopping-selector-confirmation-dismiss class=button ng-click=startContinueShopping()> <span ng-if=cartEmpty()>{{::lang.values.startShopping}}</span> <span ng-if=!cartEmpty()>{{::lang.values.continueShopping}}</span> </button> <div ng-if=::!mobile.isMobile class=\\\"buttons both\\\"> <button id=shopping-selector-confirmation-dismiss class=\\\"button mobile-bottom\\\" ng-click=startContinueShopping()> <span ng-if=cartEmpty()>{{::lang.values.startShopping}}</span> <span ng-if=!cartEmpty()>{{::lang.values.continueShopping}}</span> </button> </div> </div> </div> \";","module.exports = \"<div class=\\\"recipe-details view\\\"> <div ng-if=::!mobile.isMobile page-header breadcrumbs=recipeDetails.breadcrumbs></div> <div role=button tabindex=0 aria-label={{lang.aria.back}} ng-if=::mobile.isMobile class=mobile-back-button ng-click=util.goBack()></div> <div ng-if=::mobile.isMobile> <h1 class=recipe-name>{{::recipeDetails.recipe.name}}</h1> <div id=recipe-details-review role=button class=rating-review ng-if=::config.userReviews.enabled ng-click=\\\"openAndScrollToTab('reviews')\\\"> <react-rating enable-active=true rating=recipeDetails.recipe.recipe_rating.average_rating rating-count=recipeDetails.recipe.recipe_rating.user_count label-styles=config.userReviews.styles.pdp.label icon-size=config.userReviews.styles.pdp.icons.iconSize clickable=false /> </div> <div class=recipe-info> <ul class=\\\"recipe-tags shop-tags is-inline is-centered\\\" ng-if=::recipeDetails.recipeFullTags.length> <li ng-repeat=\\\"tag in ::recipeDetails.recipeFullTags\\\" class=shop-tag><div class=tag-icon title=::{{tag.tag_display_name}} tag-style tag=tag.tag_name></div> <span class=shop-tag__name ng-attr-style=color:{{tag.color}}>{{::tag.tag_display_name}}</span> </li> </ul> <div class=recipe-description> <p class=description-text>{{::recipeDetails.recipe.description}}</p> </div> <div class=recipe-image-slider> <img src=\\\"{{::recipeDetails.imageURLService.getRecipeImageURL(recipeDetails.recipe, 'rectangle')}}\\\" alt=\\\"\\\"/> </div> </div> <div class=recipe-products ng-if=::recipeDetails.recipe.products.mealkit class=recipe-products-list> <div class=recipe-products-list> <h3 class=\\\"recipe-product-type-title title-cell\\\">{{::lang.values.recipeProductsFeaturedMealkit}}</h3> <ul> <li class=product ng-repeat=\\\"product in ::recipeDetails.recipe.products.mealkit\\\"> <div related-product horizontal-layout=true product=::product></div> </li> </ul> </div> </div> <h2 class=recipe-product-title>{{::lang.values.recipeProductsFeaturedTitle}}</h2> <recipe-meta prep-info=::recipeDetails.recipe.preparation_information show-item-props=true is-saved=recipeDetails.model.isSaved recipe=::recipeDetails.recipe saved-count=::recipeDetails.model.savedCount></recipe-meta> <div class=recipe-mobile-tabs id=recipe-details-extras> <div class=tabs role=tablist> <button class=tab role=tab id=tab-ingredients aria-controls=panel-ingredients aria-selected=\\\"{{mobileActiveTab === 'ingredients'}}\\\" ng-click=\\\"activateTab('ingredients')\\\" ng-class=\\\"{active: mobileActiveTab === 'ingredients'}\\\">{{::lang.values.ingredients}}</button> <button class=tab role=tab data-test=recipe-directions-tab id=tab-directions aria-controls=panel-directions aria-selected=\\\"{{mobileActiveTab === 'directions'}}\\\" ng-click=\\\"activateTab('directions')\\\" ng-class=\\\"{active: mobileActiveTab === 'directions'}\\\">{{::lang.values.recipeDirections}}</button> <button class=tab role=tab id=tab-nutrition aria-controls=panel-nutrition aria-selected=\\\"{{mobileActiveTab === 'nutrition'}}\\\" ng-click=\\\"activateTab('nutrition')\\\" ng-class=\\\"{active: mobileActiveTab === 'nutrition'}\\\" ng-if=\\\"recipeDetails.recipe.nutrients && recipeDetails.recipe.nutrients.length > 0\\\">{{::lang.values.nutritionInformationShort}}</button> <button class=tab role=tab id=tab-reviews aria-controls=panel-reviews aria-selected=\\\"{{mobileActiveTab === 'reviews'}}\\\" ng-click=\\\"activateTab('reviews')\\\" ng-class=\\\"{active: mobileActiveTab === 'reviews'}\\\" ng-if=config.userReviews.enabled>{{::lang.values.reviews}}</button> </div> <div ng-if=\\\"mobileActiveTab === 'ingredients'\\\" class=tab-content role=tabpanel id=panel-ingredients aria-labelledby=tab-ingredients> <div ng-if=::recipeDetails.recipeHasProducts class=recipe-mobile-shopping> <button ng-click=recipeDetails.openShopThisRecipeModal() class=\\\"recipe-mobile-shopping-button button small\\\"> Shop Ingredients </button> </div> <recipe-ingredients ingredients=::recipeDetails.recipe.ingredients ingredient-servings=::recipeDetails.recipe.preparation_information.serving_size show-item-props=true></recipe-ingredients> </div> <div ng-if=\\\"mobileActiveTab === 'directions'\\\" class=tab-content role=tabpanel id=panel-directions aria-labelledby=tab-directions> <section class=recipe-directions> <button ng-click=recipeDetails.openCookingModeModal() class=\\\"recipe-cooking-mode-button button small\\\" data-test=recipe-cooking-mode-button> {{::lang.values.enterCookingMode}} </button> <ol> <li ng-repeat=\\\"direction in ::recipeDetails.recipe.directions track by $index\\\">{{::direction}}</li> </ol> </section> </div> <div ng-if=\\\"mobileActiveTab === 'nutrition'\\\" class=tab-content role=tabpanel id=panel-nutrition aria-labelledby=tab-nutrition> <nutrition-table nutrients=::recipeDetails.recipe.nutrients></nutrition-table> </div> <div ng-if=\\\"config.userReviews.enabled && mobileActiveTab === 'reviews'\\\" class=tab-content role=tabpanel id=panel-reviews aria-labelledby=tab-reviews> <react-user-reviews entity-id=recipeDetails.recipe.id entity-ext-id=\\\"recipeDetails.recipe.ext_id || recipeDetails.recipe.id\\\" user=recipeDetails.reviewsUserData on-terms-click=\\\"config.userReviews.termsOfUseUrl ? openTermsOfUse : null\\\" show-paging=true on-login-required=recipeDetails.openLogin review-type=\\\"'recipes'\\\"/> </div> </div> </div> <div ng-if=\\\":: !mobile.isMobile\\\"> <div class=recipe-content> <div class=recipe-content-center> <h1 class=recipe-name>{{::recipeDetails.recipe.name}}</h1> <div id=recipe-details-review role=button class=rating-review ng-if=::config.userReviews.enabled ng-click=\\\"openAndScrollToTab('reviews')\\\"> <react-rating rating=recipeDetails.recipe.recipe_rating.average_rating rating-count=recipeDetails.recipe.recipe_rating.user_count label-styles=config.userReviews.styles.pdp.label icon-size=config.userReviews.styles.pdp.icons.iconSize /> </div> <div class=recipe-info> <ul class=\\\"recipe-tags shop-tags is-inline\\\" ng-if=::recipeDetails.recipeFullTags.length> <li ng-repeat=\\\"tag in ::recipeDetails.recipeFullTags\\\" class=shop-tag> <div class=tag-icon title=::{{tag.tag_display_name}} tag-style tag=tag.tag_name></div> <span class=shop-tag__name ng-attr-style=color:{{tag.color}}>{{::tag.tag_display_name}}</span> </li> </ul> <div class=recipe-description> <p class=description-text>{{::recipeDetails.recipe.description}}</p> </div> <div class=recipe-image-slider> <img src=\\\"{{::recipeDetails.imageURLService.getRecipeImageURL(recipeDetails.recipe, 'rectangle')}}\\\" alt={{::recipeDetails.recipe.name}} /> </div> </div> <div ng-if=::recipeDetails.recipeHasProducts> <recipe-products products=::recipeDetails.recipe.products></recipe-products> </div> <section class=recipe-directions> <h2 class=recipe-directions-title>Directions</h2> <button ng-click=recipeDetails.openCookingModeModal() class=\\\"recipe-cooking-mode-button button smaller\\\"> {{::lang.values.enterCookingMode}} </button> <ol> <li ng-repeat=\\\"direction in ::recipeDetails.recipe.directions track by $index\\\">{{::direction}}</li> </ol> </section> <div id=recipe-details-extras ng-if=config.userReviews.enabled> <react-user-reviews entity-id=recipeDetails.recipe.id entity-ext-id=\\\"recipeDetails.recipe.ext_id || recipeDetails.recipe.id\\\" user=recipeDetails.reviewsUserData on-terms-click=\\\"config.userReviews.termsOfUseUrl ? openTermsOfUse : null\\\" show-paging=true on-login-required=recipeDetails.openLogin review-type=\\\"'recipes'\\\"/> </div> </div> <div class=recipe-content-left> <recipe-meta prep-info=::recipeDetails.recipe.preparation_information show-item-props=true></recipe-meta> <recipe-ingredients ingredients=::recipeDetails.recipe.ingredients show-item-props=true></recipe-ingredients> <nutrition-table nutrients=::recipeDetails.recipe.nutrients></nutrition-table> </div> <div class=recipe-content-right> <div ng-if=\\\"config.enableSavedRecipes && !config.disableRecipes\\\" class=recipe-save-button-container> <div class=\\\"save-recipe-prompt inline\\\" ng-if=\\\"recipeDetails.model.showSavePrompt && recipeDetails.model.isSaveButtonInView && !recipeDetails.model.isSaved\\\"> <div role=button class=icon-delete ng-click=recipeDetails.closeSavePrompt()></div> {{::lang.values.savedRecipes.promptPrimary}} </div> <div class=\\\"save-recipe-prompt fixed\\\" ng-if=recipeDetails.model.showSavePrompt ng-class=\\\"{'slide-down': !recipeDetails.model.isSaveButtonInView, 'slide-up': recipeDetails.model.isSaveButtonInView}\\\"> <div role=button class=icon-delete ng-click=recipeDetails.closeSavePrompt()></div> <div class=prompt-text>{{::lang.values.savedRecipes.promptSecondary}}</div> <div> <button ng-click=recipeDetails.toggleSaveRecipe() class=\\\"recipe-cooking-mode-button button small hollow save-recipe-button\\\" aria-pressed=\\\"{{recipeDetails.model.isSaved ? true : false}}\\\"> <span class=\\\"icon-{{::config.savedRecipesSaveIcon}} icon-save-recipe\\\" aria-hidden=true></span> <span ng-if=recipeDetails.model.isSaved class=\\\"badge icon-checkmark\\\" aria-hidden=true></span> {{recipeDetails.model.isSaved ? lang.values.savedRecipes.savedRecipe : lang.values.savedRecipes.saveRecipe}} </button> </div> </div> <button ng-click=recipeDetails.toggleSaveRecipe() class=\\\"recipe-cooking-mode-button button small hollow save-recipe-button\\\" element-in-view in-view=recipeDetails.model.isSaveButtonInView aria-pressed=\\\"{{recipeDetails.model.isSaved ? true : false}}\\\"> <span class=\\\"icon-{{::config.savedRecipesSaveIcon}} icon-save-recipe\\\" aria-hidden=true></span> <span ng-if=recipeDetails.model.isSaved class=\\\"badge icon-checkmark\\\" aria-hidden=true></span> {{recipeDetails.model.isSaved ? lang.values.savedRecipes.savedRecipe : lang.values.savedRecipes.saveRecipe}} </button> <div class=save-count> <span ng-if=\\\"recipeDetails.model.savedCount === 0\\\">Be the first to save this!</span> <span ng-if=\\\"recipeDetails.model.savedCount > 0\\\">{{::lang.values.savedRecipes.savedBy}} {{recipeDetails.model.savedCount}} {{recipeDetails.model.savedCount === 1 ? 'person' : 'people'}}</span> </div> </div> <div class=recipe-products ng-if=::recipeDetails.recipe.products.mealkit> <div class=\\\"recipe-products-list recipe-products-list--vertical\\\"> <h3 class=\\\"recipe-product-type-title title-cell\\\"> {{::lang.values.recipeProductsFeaturedMealkit}} </h3> <ul> <li class=product ng-repeat=\\\"product in ::recipeDetails.recipe.products.mealkit\\\"> <div product-cell product-details-modal-link=true product=product></div> </li> </ul> </div> </div> </div> </div> </div> </div> \";","module.exports = \"<div ng-include=\\\"'nav.desktop.html'\\\" ng-if=\\\"::!mobile.isMobile && !(config.react && config.react.enableHeader) && !isReactDemo()\\\"></div> <div ng-include=\\\"'nav.mobile.html'\\\" ng-if=\\\"::mobile.isMobile && !(config.react && config.react.enableMobileHeader) && !isReactDemo()\\\"></div> <div ng-include=\\\"'sideNav.html'\\\" ng-if=::mobile.isMobile></div> \";","module.exports = \"<ol> <li ng-repeat=\\\"store in storeMap.stores | filter: storeMap.storeFilterFn\\\" ng-class=\\\"{'store-selection-content__selected-store-box': store.id === auth.user.store.id, current: currentStore ==  store}\\\" id=shopping-selector-select-store-list-{{store.id}} class=store data-test=store-selector-store> <table role=presentation> <tr> <td ng-if=\\\"::config.multipleBanners.enabled && !config.multipleBanners.enableNonTabulatedView\\\" class=store-selector-banner-image-container> <banner-image banner-slug=store.store_banner.key></banner-image> </td> <td class=store-info> <div ng-if=\\\"store.id === auth.user.store.id\\\" class=store-info__current-store-label> Current store: </div> <div class=name data-test=store-name> <h2>{{store.name}}</h2> </div> <div class=address> <div>{{store.address.address1}}</div> <div>{{store.address.address2}}</div> <div>{{store.address.address3}}</div> <div ng-if=!!store.phone_number><a href=tel:{{store.phone_number}} class=phone-number ng-click=$event.stopPropagation()>{{store.phone_number}}</a></div> <div class=store-distance ng-if=\\\"store.distance !== undefined && storeMap.preciseLocation\\\"> {{store.distance}} {{storeMap.distanceUnitsAbbreviation}} </div> <div class=non-tabulated-banners ng-if=::config.multipleBanners.enableNonTabulatedView> <div class=banner-tags banner-tags banner-key=store.store_banner.key></div> <div ng-repeat=\\\"associated_store in store.associated_stores\\\"> <div class=banner-tags banner-tags banner-key=associated_store.store_banner.key has-pickup=associated_store.has_pickup has-delivery=associated_store.has_delivery> </div> </div> </div> <div ng-if=store.store_hours>{{::lang.values.todaysHours}}: {{store.store_hours | todaysHours}}</div> </div> </td> <td class=store-selector-button> <div ng-if=\\\"(storeMap.isStoreSelectable(store) || storeMap.shopContextIntent === 'instore') && $index !== storeMap.loadingIndex\\\"> <button type=button id=shopping-selector-update-home-store-{{store.id}} class=\\\"button small hollow store-selector-button__select-action\\\" ng-click=\\\"\\n                !(\\n                  (store.show_pickup && storeMap.shopContextIntent == 'pickup' || storeMap.shopContextIntent === 'catering') ||\\n                  storeMap.shopContextIntent == 'instore') || storeMap.selectStoreList(store, $index)\\n              \\\" analytics-click=\\\"['store selector set home store button', 'click']\\\" aria-label={{::lang.aria.select}} data-test=select-store-button> {{::lang.values.select}} </button> </div> <button ng-if=\\\"!store.show_pickup && storeMap.shopContextIntent == 'pickup' && !config.multipleBanners.enableNonTabulatedView\\\" ng-click=storeMap.shopAnotherWay() class=\\\"button small hollow darker shop-another-way\\\" analytics-click=\\\"['store selector set home store button', 'click']\\\"> {{::lang.values.shopAnotherWay}} </button> <button ng-if=\\\"!store.show_pickup && storeMap.shopContextIntent == 'pickup' && config.multipleBanners.enableNonTabulatedView\\\" ng-click=storeMap.shopAnotherWay() class=\\\"button small hollow shop-another-way\\\" analytics-click=\\\"['store selector set home store button', 'click']\\\"> {{::lang.values.switchModes}} </button> <a class=store-details-link ng-if=\\\"store.external_url && $index !== storeMap.loadingIndex\\\" ng-href=\\\"{{store.external_url | absoluteUrl}}\\\"> {{::lang.values.storeDetails}} </a> <div ng-if=\\\"$index == storeMap.loadingIndex\\\"> <img src=\" + require(\"static/images/loading-small.svg\") + \" alt=Loading /> </div> </td> </tr> <tr ng-if=\\\"store.last_purchased !== null\\\"> <td colspan=\\\"{{::(config.multipleBanners.enabled && !config.multipleBanners.enableNonTabulatedView) ? 3 : 2}}\\\"> <div class=store__label> <span class=\\\"icon previously-shopped store__icon--previously-shopped\\\"></span> <span>{{::lang.values.lastOrderedOn}} <span style=white-space:nowrap>{{store.last_purchased | apiDate:'MMM Do, YYYY'}}</span></span> </div> </td> </tr> <tr ng-if=\\\"!store.show_pickup && storeMap.shopContextIntent == 'pickup'\\\"> <td colspan=\\\"{{::(config.multipleBanners.enabled && !config.multipleBanners.enableNonTabulatedView) ? 3 : 2}}\\\"> <div class=store__label> <span aria-hidden=true class=store__icon--warning>!</span> {{::lang.values.pickupInstoreUnavailable}} </div> </td> </tr> </table> </li> </ol> \";","module.exports = \"<div class=store-selector ng-controller=StoreSelectorController> <div class=shopping-context-main-content ng-if=\\\"shopContextIntent == 'delivery' && shoppingSelectorStage !== 'bannerSelector'\\\"> <div class=delivery-context> <h2 class=icon-delivery-title ng-show=::mobile.isMobile> <span class=\\\"icon-delivery icon\\\" aria-hidden=true></span> <span>{{::config.shoppingSelector.delivery.title}}</span> </h2> <p class=delivery-content>{{::config.shoppingSelector.delivery.content}}</p> <p ng-if=config.shoppingSelector.delivery.contentSecondary ng-bind-html=::config.shoppingSelector.delivery.contentSecondary></p> </div> </div> <div ng-if=\\\"config.storeSelectorMode == 'map' && shopContextIntent !== 'delivery' && shoppingSelectorStage !== 'bannerSelector'\\\" ng-include=\\\"'storeSelectorMap.html'\\\"></div> <div ng-if=\\\"config.storeSelectorMode == 'list' || shopContextIntent === 'delivery' && shoppingSelectorStage !== 'bannerSelector'\\\" ng-include=\\\"'storeSelectorList.html'\\\"></div> <div class=shopping-context-main-content ng-if=\\\"shoppingSelectorStage === 'bannerSelector'\\\"> <div class=banner-selector-context> <p><strong>{{::lang.values.whereToShop}}</strong></p> <p>{{availableBannersCopy}}</p> </div> <div class=banner-selector-container> <banner-selector banners=config.multipleBanners.banners available-banner-slugs=availableBannerSlugs on-select=bannerSelectedFromBannerList(bannerSlug) on-shop-another-way=onShopAnotherWay()> </banner-selector> </div> <div ng-if=isThereAnError()> <p class=selection-error-msg ng-bind-html=getErrorMessage()></p> </div> </div> </div> \";","module.exports = \"<div class=\\\"cell cell--borderless product-cell product-cell--variant01\\\" analytics-product-impression=\\\"[product, location, position]\\\" send-analytics=!$root.modifyingOrder data-test=product-cell> <div class=product-cell__badges> <div class=\\\"offer-badge-container offer-badge--left\\\" ng-if=::showOfferBadge ng-class=productCellBadge()> <span ng-if=\\\"offerType === OFFER_TYPES.BMSM\\\" class=bmsm-badge-text>{{::lang.values.bmsm}}</span> <span ng-if=\\\"offerType === OFFER_TYPES.AMOUNT_REWARD\\\"> <span class=amount-reward-badge> <span class=amount-reward-badge-value>{{offerConditionAndReward.rewardAmount}}</span> <span class=amount-reward-badge-text>{{::lang.values.off}}</span> </span> </span> <span ng-if=\\\"offerType === OFFER_TYPES.PERCENT_REWARD\\\"> <span class=percent-reward-badge> <span class=percent-reward-badge-value>{{offerConditionAndReward.rewardAmount}}%</span> <span class=percent-reward-badge-text>{{::lang.values.off}}</span> </span> </span> <span ng-if=\\\"offerType === OFFER_TYPES.BUY_X\\\"> <span class=product-reward-badge-text>{{::lang.values.buy}} {{offerConditionAndReward.conditionAmount}}<br/>{{::lang.values.get}} {{offerConditionAndReward.rewardAmount}}</span> </span> </div> <div ng-if=\\\"::hasOfferPoints && config.hasLoyaltyPoints\\\" class=\\\"offer-badge-container points-badge--left\\\" ng-class=productCellBadge()> <span class=points-badge-amount>{{::offerPoints}}</span> <span class=points-badge-text>{{::lang.values.points}}</span> <span class=\\\"icon-points points-badge-icon\\\"></span> </div> <ul class=attributes ng-if=::product.tags.length> <li ng-repeat=\\\"tag in ::product.tags\\\" ng-if=\\\"!config.enableInstacartProductCellLabels || tag !== 'purchased'\\\" class=attribute tag-style tag=tag tag-location=productCell data-test=\\\"tag-cell {{::tag}}\\\"></li> </ul> <div ng-if=::config.enableInstacartProductCellLabels> <span class=\\\"product-label product-label--purchased\\\" ng-if=\\\"product.tags.includes('purchased') && !showSponsoredLabel && !sponsoredByText && !showFeaturedLabel\\\">{{::config.buyItAgain.displayName}}</span> <span class=\\\"product-label product-label--sponsored\\\" ng-if=\\\"showSponsoredLabel && !sponsoredByText && !showFeaturedLabel\\\">{{::lang.values.sponsored}}</span> <span class=\\\"product-label product-label--sponsored-by\\\" ng-if=\\\"sponsoredByText && !showFeaturedLabel\\\">{{::sponsoredByText}}</span> <span class=\\\"product-label product-label--featured\\\" ng-if=showFeaturedLabel>{{::lang.values.featured}}</span> </div> </div> <div class=cell-image-wrapper ng-class=\\\"{ 'is-out-of-stock': !isProductAvailable }\\\"> <span aria-label={{::productTitle()}} ng-click=linkToProductDetails() class=cell-image analytics-click=\\\"['product cell image link', 'click']\\\" analytics-product-click=\\\"[product, location, offerType]\\\" send-analytics=!$root.modifyingOrder cell-image lazy-load-image=true default-image=\\\"::imageURLService.getProductImageURL(product, (mobile.isMobile ? 'medium' : 'small') )\\\" promoted-media=promotedMedia title={{::productTitle()}} ng-class=\\\"{'cell-sponsored': showSponsoredLabel || showFeaturedLabel || sponsoredByText }\\\"> <div ng-if=\\\"::!config.enableInstacartProductCellLabels && showSponsoredLabel\\\" class=sponsored> {{::lang.values.sponsored}} </div> <div ng-if=\\\"::!config.enableInstacartProductCellLabels && sponsoredByText\\\" class=sponsored> {{::sponsoredByText}} </div> <div ng-if=\\\"::!config.enableInstacartProductCellLabels && showFeaturedLabel\\\" class=sponsored> {{::lang.values.featured}} </div> </span> <button ng-if=\\\"::showSaleRibbon() && isProductAvailable\\\" id=product_sale_ribbon_{{::product.id}} class=promo-tag-flat uib-popover=\\\"{{::lang.template(lang.values.saleEndDate, { endDate: (product.sale_end_date | apiDate:'MMM D') })}}\\\" popover-trigger=\\\"mouseenter focus\\\" popover-enable=\\\"::mobile.isMobile ? false : config.showSaleEndDate\\\" popover-placement=top-right> {{::product.promo_tag}} </button> <button ng-if=\\\"::showLoyaltyRibbon() && isProductAvailable\\\" id=product_loyalty_ribbon_{{::product.id}} class=promo-tag-flat ng-class=\\\"{'loyalty-required': !hasLoyaltyCard(), 'loyalty-price': hasLoyaltyCard()}\\\" uib-popover=\\\"{{::(hasLoyaltyCard()\\n        ? lang.template(lang.values.saleEndDate, { endDate: (product.loyalty_end_date | apiDate:'MMM D') })\\n        : lang.template(lang.values.loyaltyPricing.tagTooltip, { promo: product.promo_tag }))}}\\\" popover-trigger=\\\"mouseenter focus\\\" popover-enable=\\\"::mobile.isMobile ? false : config.showSaleEndDate || !hasLoyaltyCard()\\\" popover-placement=top-right> {{::(hasLoyaltyCard() ? product.promo_tag : lang.values.loyaltyPricing.tag)}} </button> <button ng-if=\\\"::showOfferPreviewRibbon() && isProductAvailable\\\" id=product-offer-preview-ribbon-{{::product.id}} class=\\\"promo-tag-flat offer-preview\\\" uib-popover={{::product.offer_title}} popover-trigger=\\\"mouseenter focus\\\"> <div class=offer-preview-text>{{::product.offer_title}}</div> </button> <button ng-if=::!isProductAvailable id=product-offer-oos-ribbon-{{::product.id}} class=\\\"promo-tag-flat is-out-of-stock\\\" uib-popover={{::lang.values.outOfStockDescription}} popover-trigger=\\\"mouseenter focus\\\"> <div class=offer-preview-text>{{::lang.values.outOfStock}}</div> </button> </div> <div class=cell-trigger-container> <div add-to-cart product=product button-type=trigger trigger-callback=onQuickAddClick() location={{::location}} location-value=locationValue></div> </div> <div class=cell-content-wrapper> <div ng-if=\\\"product.product_config && product.product_config.options.length > 0\\\"> <button class=\\\"cell-single-configuration text-left\\\" ng-if=\\\"product.product_config.config_type === 'prep_style'\\\" ng-click=linkToProductDetails() aria-label=\\\"{{product.product_config.options[0].items.length}} {{::lang.aria.available}} {{product.product_config.options[0].name | pluralize}}\\\"> <span ng-if=\\\"product.product_config.options[0].items.length === 1\\\">{{product.product_config.options[0].items.length}} {{::lang.values.available}} {{product.product_config.options[0].name}}</span> <span ng-if=\\\"product.product_config.options[0].items.length !== 1\\\">{{product.product_config.options[0].items.length}} {{::lang.values.available}} {{product.product_config.options[0].name | pluralize}}</span> </button> <button class=\\\"cell-single-configuration text-left\\\" ng-if=\\\"product.product_config.config_type === 'custom'\\\" ng-click=linkToProductDetails() aria-label={{::lang.values.customizable}}> <span>{{::lang.values.customizable}}</span> </button> </div> <button title=\\\"{{ productTitle() }}\\\" class=cell-title ng-class=\\\"{ 'cell-title-product-configuration': (product.product_config.config_type === 'prep_style' || product.product_config.config_type === 'custom') }\\\" ng-click=linkToProductDetails() analytics-click=\\\"['product cell name link', 'click']\\\" analytics-product-click=\\\"[product, location]\\\" send-analytics=!$root.modifyingOrder data-test=item-tile-name-button> <div class=\\\"cell-title-text cell-title-text--left cell-title-text--bold\\\" ng-bind-html=productTitle()></div> </button> <div class=\\\"cell-padding product-prices\\\"> <div product-prices product=product label=priceLabel show-uom=true styles=priceStyles></div> </div> <div class=cell-padding> <div class=cell-product-size ng-if=product.size_string>{{product.size_string}}</div> </div> <div class=\\\"cell-padding align-edges space-top\\\" ng-if=::config.userReviews.enabled> <react-rating rating=product.product_rating.average_rating rating-count=product.product_rating.user_count show-average=false label-styles=config.userReviews.styles.productCell.label icon-size=config.userReviews.styles.productCell.icons.iconSize /> <div ng-if=::!mobile.isMobile class=actions--default> <add-to-list ng-if=\\\"::!config.disableSaveForLaterLists && !product.product_config\\\" products=[product] toggle-style=icon class=action></add-to-list> <div price-alert class=action product=product small=true ng-if=\\\"::(!config.disablePriceAlerts && !config.disablePriceAlertsOnProductCells && auth.user.status !== 'trial')\\\"></div> </div> </div> <react-fulfillment-banner store-product=product with-padding=true full-width=true> </react-fulfillment-banner> <div class=\\\"cell-padding align-edges space-top\\\" ng-if=showAisle> <div> <div class=\\\"default-aisle-label icon-solidpin\\\" ng-bind-html=product.aisle.trim()></div> </div> </div> </div> <div class=cell-add-to-cart-overlay ng-show=showQuickAdd> <div class=cell-add-to-cart-overlay__background ng-click=\\\"closeQuickAdd($event, true)\\\"></div> <div class=cell-add-to-cart-container> <div add-to-cart product=product button-type=modify remove-callback=\\\"closeQuickAdd($event, true)\\\" location={{::location}} location-value=locationValue></div> </div> </div> </div> \";","/** *************************\n * CHECKOUT STEP CONSTANTS *\n ************************** */\n\nexport const CHECKOUT_STEP_IDS = {\n  BANNER: 'banner',\n  CART: 'cart',\n  CONTACT: 'contact',\n  DELIVERY: 'delivery',\n  ORDER_DELIVERY_INSTRUCTIONS: 'orderDeliveryInstructions',\n  PAYMENT: 'payment',\n  PICKUP: 'pickup',\n  SCHEDULE: 'schedule',\n  RESERVATION: 'reservation',\n}\n\nexport const CHECKOUT_STEPS_STATUS = {\n  [CHECKOUT_STEP_IDS.BANNER]: { valid: true },\n  [CHECKOUT_STEP_IDS.CART]: { valid: true },\n  [CHECKOUT_STEP_IDS.CONTACT]: { valid: false },\n  [CHECKOUT_STEP_IDS.DELIVERY]: { valid: false },\n  [CHECKOUT_STEP_IDS.ORDER_DELIVERY_INSTRUCTIONS]: { valid: false },\n  [CHECKOUT_STEP_IDS.PAYMENT]: { valid: false },\n  [CHECKOUT_STEP_IDS.PICKUP]: { valid: false },\n  [CHECKOUT_STEP_IDS.SCHEDULE]: { valid: false },\n}\n\nexport const FULFILLMENT_TYPES = {\n  DELIVERY: 'delivery',\n  INSTORE: 'instore',\n  PICKUP: 'pickup',\n  /*\n   * The catering intent is usually not provided by the server, which instead provides pickup\n   * This means you need to detect catering mode and manually switch to this intent as needed\n   */\n  CATERING: 'catering_pickup',\n}\n\n// This array hard codes the order of the pickup, delivery and timeslots\n// If we want to hard code more steps they can be added to this array and\n// removed from the config\nexport const RESERVATION_BREAKDOWN = [\n  {\n    name: CHECKOUT_STEP_IDS.PICKUP,\n  },\n  {\n    name: CHECKOUT_STEP_IDS.DELIVERY,\n  },\n  {\n    name: CHECKOUT_STEP_IDS.BANNER,\n  },\n  {\n    name: CHECKOUT_STEP_IDS.SCHEDULE,\n  },\n]\n\nexport const RESET_CHECKOUT_STEPS = 'RESET_CHECKOUT_STEPS'\nexport const EDIT_CHECKOUT_STEP = 'EDIT_CHECKOUT_STEP'\nexport const CLOSE_CHECKOUT_STEPS_SETTLED = 'CLOSE_CHECKOUT_STEPS_SETTLED'\n\nexport const MAX_TIP = 500\nexport const CUSTOM_TIP_OPTION = 'custom'\n\n/** **************************\n * CHECKOUT ROUTE CONSTANTS *\n *************************** */\n\nexport const CHECKOUT_VERSIONS = {\n  V1: 'V1',\n  V2: 'V2',\n}\n\nexport const CHECKOUT_ROUTE_PREFIXES = {\n  [CHECKOUT_VERSIONS.V1]: '',\n  [CHECKOUT_VERSIONS.V2]: '/v2',\n}\n\nexport const CHECKOUT_ROUTES_FACTORY = newCheckoutConfig => {\n  const { V1, V2 } = CHECKOUT_ROUTE_PREFIXES\n\n  return {\n    [CHECKOUT_VERSIONS.V1]: {\n      CART: `${V1}/cart`,\n      UPSELL: `${V1}/get-more`,\n      // CHECKOUT_REVIEW - there isn't a single route for v1\n    },\n    [CHECKOUT_VERSIONS.V2]: {\n      CART: `${V2}/cart`,\n      UPSELL: `${V2}/${newCheckoutConfig.upsellPage.routeName}`,\n      CHECKOUT_REVIEW: `${V2}/review`,\n    },\n  }\n}\n","// Escape image urls to prevent issues with spaces and other\n// special characters (additionally using regex to replace parentheses if `escapeParentheses` is true)\n// Typically, `escapeParentheses` would be required for background-image URLs\nconst escapeImageUrl = (path: string, escapeParentheses?: boolean) => {\n  let escaped = ''\n  if (escapeParentheses) {\n    escaped = encodeURI(path).replace(/(?=[()])/g, '\\\\')\n  } else {\n    escaped = encodeURI(path).replace(\"'\", \"\\\\'\")\n  }\n\n  return escaped\n}\n\nexport default escapeImageUrl\n","module.exports = \"<div class=bottom-buttons ng-if=$ctrl.isNotInstore()> <div ng-if=$ctrl.showCartMinimumAlert class=fulfillment-disabled-alert> <alert type=no-light disable-border=true notice-class=side-cart-warning small-text=true> <span ng-bind-html=$ctrl.getMinCartAlertMessage()></span> </alert> <alert ng-if=$ctrl.isEbtEnabled() type=info-positive class=no-ebt-min-alert closeable=true remember-close-status-by-id={{::$ctrl.EBT_NOTICE_ALERT_ID}} disable-border=true notice-class=side-cart-notice small-text=true> <span> {{::$ctrl.noEBTMinimum.start}} <a ng-if=$ctrl.isLoggedIn() ui-sref=main.account.snapEBT ng-click=$ctrl.closeSideCart() analytics-click=\\\"['side cart ebt account button', 'click', lang.values.ebt.EBTSNAP]\\\">{{::$ctrl.noEBTMinimum.account}}</a> <span ng-if=!$ctrl.isLoggedIn()>{{::$ctrl.noEBTMinimum.account}}</span> {{::$ctrl.noEBTMinimum.end}} </span> </alert> </div> <ng-transclude></ng-transclude> <a ng-click=$ctrl.onBottomButtonActionClick($event) ng-disabled=$ctrl.cartService.syncing id=side-cart-main-checkout-cart class=\\\"button small sidecart-checkout-button\\\" ng-class=\\\"$ctrl.showCartMinimumAlert && !$ctrl.cartService.syncing ? 'hollow' : 'highlight'\\\" analytics-click=\\\"[\\n      '{{$ctrl.showCartMinimumAlert ? 'cart continue shopping link' : 'side cart checkout button'}}',\\n      'click'\\n    ]\\\"> <span class=sidecart-checkout-button__content ng-if=!$ctrl.cartService.syncing> {{$ctrl.showCartMinimumAlert ? $ctrl.lang.values.continueShopping : $ctrl.getCheckoutButtonMessage()}} <span ng-if=!$ctrl.showCartMinimumAlert aria-hidden=true class=\\\"icon icon-after-go\\\"></span> </span> <loading-dots show=$ctrl.cartService.syncing></loading-dots> </a> </div> <div ng-if=\\\"$ctrl.inStoreIntent && !$ctrl.mobileService.isMobile\\\" class=bottom-buttons> <button ng-if=$ctrl.showOrderOnlineButton type=button id=side-cart-shopping-selector-service-open-shopping-context class=\\\"button small highlight icon-after-go\\\" ng-click=\\\"$ctrl.shoppingSelectorService.open('shoppingContext')\\\"> {{::$ctrl.lang.values.orderOnline }} </button> </div> \";","module.exports = \"<section ng-if=::$ctrl.enableReactCollection ng-class=\\\"{ 'collection': !$ctrl.isMobile }\\\" data-test=collection-{{$ctrl.collection.id}}> <react-product-collection collection=$ctrl.collection full-width=$ctrl.isFull enable-view-more=!$ctrl.hideViewMore enable-placements=$ctrl.enablePlacements /> </section> <section ng-if=\\\"::$ctrl.isMobile && !$ctrl.enableReactCollection\\\" class=mobile-section ng-class=\\\"{ 'mobile-product-collection': !$ctrl.mobileColumnLayout }\\\" data-test=collection-{{$ctrl.collection.id}}> <div ng-class=\\\"{'section-divider-left': $ctrl.isFull, 'section-divider': !$ctrl.isFull, 'mobile-section-header': $ctrl.isFull, 'section-divider--no-border': $ctrl.hideBorder }\\\"> <h2 class=title ng-class=\\\"{ 'title--small': $ctrl.isFull }\\\"> <placeholder-image type=nonImage remove-on=$ctrl.collection.name></placeholder-image> {{::$ctrl.collection.name}} </h2> <span ng-if=\\\"$ctrl.isFull && !$ctrl.hideViewMore\\\" class=section-divider__action> <a class=mobile-section-header-link ui-sref=main.shop.collection($ctrl.srefParams) analytics-click=\\\"['homepage collection see more button', 'click', $index, $ctrl.collection.id]\\\" data-test=collection-more-{{$ctrl.collection.id}}> {{::$ctrl.lang.values.viewMore}} <span class=icon-after-chevron-right aria-hidden=true></span> </a> </span> </div> <ol class=cell-container ng-class=\\\"{ 'centered': $ctrl.mobileColumnLayout }\\\"> <li ng-repeat=\\\"placement in ::$ctrl.collection.placements\\\" class=\\\"item mobile-span-{{::placement.promoted_media.mobile.span || 1}}\\\" ng-class=\\\"{ 'is-ic-variant': $ctrl.config.enableInstacartProductCell, 'is-empty': !placement.promoted_media.mobile.image_url }\\\" ng-if=$ctrl.enablePlacements> <div image-cell url=placement.target.url imageurl=\\\"\\\" ng-click=\\\"$ctrl.handleImagePlacementClick(placement, $index)\\\" promoted-media=placement.promoted_media class=collection-carousel-placement analytics-click=\\\"['catalog placement ID ' + placement.id + '', 'click']\\\" use-image-tag=true></div> </li> <li ng-if=!$ctrl.enableFullTileOnMobile ng-repeat=\\\"product in ::$ctrl.collection.items\\\" class=item ng-class=\\\"{ 'is-ic-variant': $ctrl.config.enableInstacartProductCell }\\\"> <div related-product product=product.store_product location={{$ctrl.location}}></div> </li> <li ng-if=$ctrl.enableFullTileOnMobile ng-repeat=\\\"product in ::$ctrl.collection.items\\\" class=\\\"item full-tile\\\" ng-class=\\\"{ 'is-ic-variant': $ctrl.config.enableInstacartProductCell }\\\"> <div product-cell product-details-modal-link=true product=product.store_product location={{$ctrl.location}} location-value=\\\"{'id': $ctrl.collection.id, 'display_name': $ctrl.collection.name}\\\" index=$index></div> </li> <li ng-class=\\\"{ 'collection-see-more-container': !$ctrl.mobileColumnLayout, 'footer': $ctrl.mobileColumnLayout, 'is-ic-variant': $ctrl.config.enableInstacartProductCell }\\\" ng-if=\\\"$ctrl.hasMore && !$ctrl.hideViewMore\\\"> <a ng-class=\\\"{ 'collection-see-more-link': !$ctrl.mobileColumnLayout, 'more': $ctrl.mobileColumnLayout }\\\" ui-sref=main.shop.collection($ctrl.srefParams) aria-label={{::$ctrl.lang.values.viewMore}}> <span ng-if=!$ctrl.mobileColumnLayout aria-hidden=true class=icon-after-arrow-right></span> </a> </li> </ol> </section> <section ng-if=\\\"!$ctrl.isMobile && !$ctrl.enableReactCollection\\\" class=collection ng-class=\\\"{ 'full-width': $ctrl.isFull }\\\" data-test=collection-{{$ctrl.collection.id}}> <h2 class=section-divider-left ng-class=\\\"{ 'section-divider--no-border': $ctrl.hideBorder}\\\"> <span class=title> <placeholder-image type=nonImage remove-on=$ctrl.collection.name></placeholder-image> {{::$ctrl.collection.name}} </span> <span ng-if=!$ctrl.hideViewMore class=section-divider__action> <a data-qa=collection-homepage-see-more-{{$ctrl.collection.id}} ui-sref=main.shop.collection($ctrl.srefParams) analytics-click=\\\"['homepage collection see more button', 'click', $index, $ctrl.collection.id]\\\" class=more data-test=collection-more-{{$ctrl.collection.id}}> {{::$ctrl.lang.values.viewMore}} <span class=\\\"icon-after-chevron-right icon-more-sizing\\\" aria-hidden=true></span> </a> </span> </h2> <placeholder-image type=productCell remove-on=$ctrl.collection.name show-max=5></placeholder-image> <unata-carousel name=::$ctrl.collection.name> <div class=\\\"cell-container centered\\\"> <div ng-repeat=\\\"placement in ::$ctrl.collection.placements\\\" class=cell-wrapper ng-if=$ctrl.enablePlacements role=group aria-label=\\\"{{::$ctrl.lang.template($ctrl.lang.aria.productItem, { number: $index + 1, count: $ctrl.collection.placements.length })}}\\\"> <div image-cell url=placement.target.url imageurl=\\\"\\\" ng-click=\\\"$ctrl.handleImagePlacementClick(placement, $index)\\\" promoted-media=placement.promoted_media class=span-{{::placement.promoted_media.desktop.span}} analytics-click=\\\"['catalog placement ID ' + placement.id + '', 'click']\\\" use-image-tag=true></div> </div> <div ng-repeat=\\\"product in ::$ctrl.collection.items\\\" class=cell-wrapper role=group aria-label=\\\"{{::$ctrl.lang.template($ctrl.lang.aria.productItem, { number: ($ctrl.enablePlacements ? $ctrl.collection.placements.length : 0) + $index + 1, count: ($ctrl.enablePlacements ? $ctrl.collection.placements.length : 0) + $ctrl.collection.items.length })}}\\\"> <div product-cell product-details-modal-link=true product=product.store_product location={{$ctrl.location}} location-value=\\\"{'id': $ctrl.collection.id, 'display_name': $ctrl.collection.name}\\\" index=$index></div> </div> </div> </unata-carousel> </section> \";","module.exports = \"<div scroll-into-view> <stripe-payment-form full-width-buttons=true style-add-card-as-link=true show-save-credit-card-checkbox=true on-credit-card-select=$ctrl.doSave() enable-credit-card-select-after-add=true enable-credit-card-list-background=false enable-gift-cards=$ctrl.config.showGiftCards enable-credit-card-select-button=$ctrl.editMode add-card-label={{::$ctrl.lang.values.addNewCard}}></stripe-payment-form> </div> \";","module.exports = \"<div ng-if=$ctrl.hasErrors class=\\\"message error checkout-form__error-message\\\"> <span class=icon-error aria-hidden=true></span> {{::$ctrl.lang.values.fillRequiredFieldsErrorMessage}} </div> <div class=\\\"checkout-form schedule-form\\\" ng-class=\\\"{'checkout-form--open': $ctrl.editMode}\\\"> <div ng-if=!$ctrl.editMode class=checkout-form__left> <ng-include class=icon src=\\\"::$ctrl.loadStaticImage('ic_time.svg')\\\" aria-hidden=true /> </div> <div class=checkout-form__right ng-if=\\\"!$ctrl.editMode && !$ctrl.hideChevron\\\"> <button class=checkout-form__edit-button id=schedule-save-button ng-click=$ctrl.enterEditMode() aria-label=\\\"{{ ::$ctrl.lang.values.expandSection }}: {{\\n        :: $ctrl.intent.pickup() ?\\n          $ctrl.lang.values.pickupTime :\\n          $ctrl.intent.delivery() ?\\n            $ctrl.lang.values.deliveryTime :\\n            ''\\n      }}\\\"> </button> </div> <div class=checkout-form__content ng-if=\\\"$ctrl.intent.pickup() || $ctrl.intent.delivery()\\\"> <div class=checkout-form__content-header> <div ng-if=$ctrl.editMode> <ng-include class=icon src=\\\"::$ctrl.loadStaticImage('ic_time.svg')\\\"/> </div> <h2 ng-if=$ctrl.intent.pickup() class=checkout-form__title> {{ ::$ctrl.lang.values.pickupTime }} </h2> <h2 ng-if=$ctrl.intent.delivery() class=checkout-form__title> {{ ::$ctrl.lang.values.deliveryTime }} </h2> </div> <div ng-if=!$ctrl.editMode class=checkout-form__readonly> <div>{{ $ctrl.reservationService.reservation | reservationScheduleToString }}</div> </div> <div ng-if=$ctrl.editMode class=\\\"checkout-form__form timeslot-selector\\\" auto-focus=true tabindex=-1> <span class=screen-reader-text>{{::$ctrl.lang.aria.deliveryTimeReserveATimeslot}}</span> <ic-express-timeslot ng-if=$ctrl.showTimeslotPlacement() opted-in=$ctrl.express.isIcExpressOptedIn use-ic-theme=!$ctrl.icExpress.enableRetailerTheme membership-status=$ctrl.express.getMembershipStatus() cart-total=$ctrl.cartService.getCartTotals()[$ctrl.config.cartTotalKey]></ic-express-timeslot> <ic-fullfillment-banner use-ic-theme=false ng-if=$ctrl.showFulfillmentBanner() logo-text={{::$ctrl.lang.values.deliveredBy}}></ic-fullfillment-banner> <timeslot-selectors address=$ctrl.getSelectedCheckoutAddress() root-level-css-class=\\\"timeslot timeslotV2 shopping-context-selection-content\\\" fulfillment-type=$ctrl.intent.toString() navigate-to-next-step=\\\"$ctrl.onDoSave({ success: true })\\\" navigate-to-next-step-failed=\\\"$ctrl.onDoSave({ success: false })\\\" on-load=$ctrl.onLoad() on-ready=$ctrl.onLoadDone() on-error=$ctrl.onLoadError(response) timeslots-are-selectable=true hide-select-later-link=true pagination=6 is-entire-row-click=true custom-labels=\\\"{ tomorrow: false, isShortDayNames: true, isShortTime: true }\\\" is-condensed=$ctrl.mobileService.isMobile on-after-cart-compare-confirm=$ctrl.onAfterCartCompare(shouldRecalculateFees) filter-blackouts=true></timeslot-selectors>  </div> </div> </div> \";","module.exports = \"<div id=icExpressCheckout class=ic-express-checkout ng-class=\\\"$ctrl.enableRetailerTheme ? 'ic-express-checkout-retailer' : 'ic-express-checkout-instacart'\\\"> <div ng-if=\\\"!$ctrl.optedIn || $ctrl.hasSubscription\\\" class=ic-express-checkout__title ng-class=\\\"{ 'ic-express-checkout__title--dark': $ctrl.hasSubscription }\\\"> <h2 class=text-unstyled>{{$ctrl.placementTitle}}</h2> </div> <div ng-if=!$ctrl.hasSubscription> <div ng-if=!$ctrl.optedIn class=ic-express-checkout__main-text ng-bind-html=$ctrl.express.getTermsAndConditions()></div> <span class=ic-express-checkout__actions> <button id=icExpressCheckoutButton ng-if=!$ctrl.optedIn class=\\\"button ic-express-checkout__button\\\" ng-click=\\\"$ctrl.optedIn = true;\\\"> {{::$ctrl.buttonLabel}} </button> <div class=ic-express-checkout__checkoutbox ng-if=$ctrl.optedIn> <input id=icExpressCheckoutCheckoutbox class=checkbox type=checkbox value=true ng-model=$ctrl.optedIn /> <label for=icExpressCheckoutCheckoutbox></label> <span class=ic-express-checkout__checkoutbox__label>{{::$ctrl.checkboxLabel}}</span> </div> </span> </div> <div class=ic-express-checkout__amount-left ng-if=\\\"($ctrl.hasSubscription || $ctrl.optedIn) && $ctrl.amountForFreeDelivery > 0\\\"> {{ $ctrl.lang.template( $ctrl.config.icExpress.placements.checkout.addAmountForFreeDelivery, { amount: $ctrl.currencyFilter($ctrl.amountForFreeDelivery) } ) }} </div> <div ng-if=\\\"!$ctrl.hasSubscription && $ctrl.optedIn && $ctrl.amountForFreeDelivery <= 0\\\" class=ic-express-checkout__savings> {{::$ctrl.config.icExpress.placements.checkout.savingsText}} </div> <div ng-if=\\\"$ctrl.hasSubscription && $ctrl.amountForFreeDelivery <= 0\\\" class=ic-express-checkout__member-text> {{::$ctrl.config.icExpress.placements.checkout.memberText}} </div> <div class=ic-express-checkout__powered-by> <react-express-powered-by small=true powered-by-text=$ctrl.config.icExpress.placements.checkout.logoText></react-express-powered-by> </div> </div> \";","module.exports = \"<div class=\\\"error-modal confirmation-modal\\\"> <div class=modal-header> {{ title || lang.values.warning }} </div> <div class=\\\"error-modal-content confirmation-modal-content\\\"> <div ng-bind-html=message class=text></div> <div class=confirmation-modal__actions> <button ng-click=resolve(true);$close() id=confirmation-modal-confirm-button class=\\\"button mobile-bottom\\\" analytics-click=\\\"['confirm modal ok button', 'click']\\\" aria-label={{::lang.aria.proceed}}> {{ confirm || lang.values.ok }} </button> <button ng-click=resolve(false);$close() id=confirmation-modal-cancel-button class=\\\"button mobile-bottom\\\" analytics-click=\\\"['confirm modal cancel button', 'click']\\\" aria-label={{::lang.aria.cancel}}> {{ cancel || lang.values.cancel }} </button> </div> </div> </div> \";","module.exports = \"<header ng-if=!utilService.isFixedLayout() id=app-header class=desktop-nav ng-class=\\\"::{ 'ecom-light-mode': inEComLightMode }\\\"> <div class=banner-row ng-if=hasShowableBanners()> <div ng-repeat=\\\"headerBanner in headerBanners | reverse track by $index\\\" ng-class=headerBanner.media.cssClass ng-if=\\\"headerBanner.media.text || headerBanner.media.image\\\" ng-click=\\\"logPromotedPlacement(headerBanner, 'Header Banner', $index)\\\" class=banner role=region aria-label={{::lang.aria.headerBanner}}> <a ng-href={{headerBanner.target.url}} ng-switch=headerBanner.media.type class=fullwidth-focusable-outline-offset id=nav-header-banner-{{headerBanner.id}} ng-click=\\\"acknowledgeHeaderBanner(headerBanner, !!headerBanner.target.dismissOnClick)\\\" aria-label=\\\"{{headerBanner.media.alt_text || headerBanner.media.text}}\\\" ng-attr-target=\\\"{{ bannerTarget(headerBanner.target) }}\\\" analytics-click=\\\"['header banner link', 'click', headerBanner.id, headerBanner.target.url]\\\" data-test=header-banner tabindex=0> <span ng-switch-when=text class=text>{{headerBanner.media.text}}</span> <span ng-if=\\\"headerBanner.media.cssClass.includes('ic-express-header')\\\" class=get-express-badge> {{::lang.values.icExpress.getExpress}} </span> <img ng-switch-when=image class=image ng-src={{imageTransform(headerBanner.media.image)}} alt={{headerBanner.media.alt_text}} /> </a> <button id=nav-acknowledge-header-banner-{{headerBanner.id}} aria-label={{::lang.aria.close}} class=close ng-class=\\\":: { 'add-text-shadow': (headerBanner.media.type !== 'text') }\\\" ng-click=acknowledgeHeaderBanner(headerBanner)></button> </div> </div> <div class=top-row ng-if=\\\"config.dotComModule.enableHeaderFooterSync && useAngularHeader && !headerSyncError\\\"> <div bind-html-compile=dotComHeader after-compile-handler=afterHeaderLoaded></div> </div> <div class=top-row ng-if=\\\"useAngularHeader && (!config.dotComModule.enableHeaderFooterSync || headerSyncError) && !config.disableTopRow\\\"> <div class=left> <a ui-sref=main.home analytics-click=\\\"['nav logo', 'click']\\\" id=nav-main-home-logo class=logo> <img src=\" + require(\"assets/images/header-logo.svg\") + \" alt={{::lang.values.clientName}} /> </a> <a ng-if=::config.externalHeaderLink.enabled class=external-link-button href={{::config.externalHeaderLink.href}} target=_blank> {{::lang.values.externalHeaderLink}} </a> </div> <div class=right> <div ng-if=$attributes.innerHTML ng-bind-html=$attributes.innerHTML style=margin-top:1px></div> <div ng-if=!$attributes.innerHTML> <span include-if-exists=\\\"'customNavTopMenuItems.html'\\\" class=\\\"wrapper flyer-wrapper\\\"></span> <span class=\\\"wrapper ecom-light-wrapper\\\" ng-if=\\\":: config.eComLight.enabled && enableToggleEcomLightMode\\\"> <button ng-click=toggleEComLightMode() id=nav-main-ecom-light class=\\\"link-group header-link\\\" analytics-click=\\\"['nav ecom-light button', 'click']\\\"> <span aria-hidden=true class=\\\"{{ecomLightModeToggleIcon}} header-icon\\\"></span> {{:: eComLightModeToggleText}} </button> </span> <span class=\\\"wrapper subscriptions-wrapper\\\" ng-if=\\\":: config.subscriptions.enabled && config.subscriptions.isDedicatedFlowEnabled\\\"> <a ui-sref=main.subscriptions.marketing id=nav-main-subscriptions class=\\\"link-group icon-subscription header-link\\\" analytics-click=\\\"['nav subscriptions button', 'click']\\\"> <span aria-hidden=true class=\\\"icon-subscription header-icon\\\"></span> {{::lang.values.subscriptions.headerButtonLabel}} </a> </span> <span class=\\\"wrapper recipes-wrapper\\\" ng-if=\\\":: !config.disableRecipes && !inEComLightMode\\\"> <a href=\\\"{{config.env.webUrl + '/shop/recipes'}}\\\" target=_blank class=\\\"link-group header-link\\\" analytics-click=\\\"['nav recipes button', 'click']\\\"> <span aria-hidden=true class=\\\"icon-recipes header-icon\\\"></span> {{::lang.values.recipes}} </a> </span> <span class=\\\"wrapper flyer-wrapper\\\" ng-if=\\\":: !config.disableWeeklyAd && !inEComLightMode\\\"> <a href=\\\"{{config.env.webUrl + '/shop/flyer'}}\\\" target=_blank id=nav-main-shop-flyer class=\\\"link-group header-link\\\" analytics-click=\\\"['nav deals button', 'click']\\\"> <span aria-hidden=true class=\\\"weekly-ad-image header-icon\\\"></span> {{::(lang.values.weeklyAdNav ? lang.values.weeklyAdNav : lang.values.weeklyAd)}} </a> </span> <span class=\\\"wrapper coupons-wrapper\\\" ng-if=\\\":: !config.disableCoupons && !inEComLightMode\\\"> <a href=\\\"{{config.env.webUrl + '/shop/coupons'}}\\\" target=_blank id=nav-main-shop-coupons class=\\\"link-group header-link\\\" analytics-click=\\\"['nav coupons button', 'click']\\\"> <span aria-hidden=true class=\\\"icon-clip header-icon\\\"></span> {{::lang.values.coupons}} </a> </span> <span class=\\\"wrapper loyalty-card-wrapper\\\" ng-if=\\\"config.hasLoyalty && !config.disableLoyaltyLinks && ((config.customerLoyaltyOverride && userService.loyaltyCards.length) || ((!config.disableLoyaltyWhenAccountless || (userService.loyaltyCards.length)) && (!config.disableLoyaltyWhenEmployeeIdless || (auth.user.ext_data && auth.user.ext_data.employee_id))))\\\"> <button ng-click=openLoyalty() id=nav-open-loyalty class=\\\"link-group header-link\\\" role=link> <span aria-hidden=true class=\\\"icon-rewards header-icon\\\"></span> {{::lang.values.loyaltyCard}} </button> </span> </div> <span class=\\\"wrapper user-wrapper\\\"> <unata-registration-dropdown></unata-registration-dropdown> </span> </div> </div> <div class=private-mode-message ng-if=privateMode>{{::privateModeMessage}}</div> <div sticky body-class=nav-sticky min-width=1250> <modify-order-banner></modify-order-banner> <div class=middle-row> <div class=\\\"wrapper clearfix\\\"> <div class=sliding-logo-container> <div ng-if=!config.dotComModule.enableSlidingHeaderLogoRedirect ui-sref=main.home analytics-click=\\\"['nav logo', 'click']\\\" id=nav-main-home-menu class=sliding-logo> <img ng-src={{::stickyNavLogo}} alt={{::lang.values.clientName}} /> </div> <a ng-if=config.dotComModule.enableSlidingHeaderLogoRedirect ng-href={{config.dotComModule.url}} analytics-click=\\\"['nav logo', 'click']\\\" id=nav-main-home-menu class=sliding-logo> <img ng-src={{::stickyNavLogo}} alt={{::lang.values.clientName}} /> </a> </div> <div class=\\\"left left-section\\\"> <unata-shopping-selector-nav ng-if=!config.swapShoppingSelectorAndSearch></unata-shopping-selector-nav> <unata-search-nav search-term=searchTerm ng-if=config.swapShoppingSelectorAndSearch></unata-search-nav> </div> <div class=\\\"left right-section\\\"> <unata-shopping-selector-nav ng-if=config.swapShoppingSelectorAndSearch></unata-shopping-selector-nav> <unata-search-nav search-term=searchTerm ng-if=!config.swapShoppingSelectorAndSearch></unata-search-nav> <unata-nav-cart ng-if=showCheckoutButton()></unata-nav-cart> </div> </div> </div> <div class=bottom-row ng-if=\\\":: !inEComLightMode\\\"> <div class=wrapper> <unata-categories-menu></unata-categories-menu> </div> </div> </div> </header> \";","module.exports = \"<span ng-if=\\\"$ctrl.subscriptions.length > 0\\\"> <react-cart-checkout-subscription-select subscriptions=$ctrl.subscriptions cart-items=$ctrl.cartService.cart.items on-subscription-selected=$ctrl.onSubscriptionSelected is-disabled=$ctrl.cartService.syncing user-subscription=$ctrl.auth.user.subscription config=$ctrl.config.subscriptions i18n=$ctrl.lang.values.subscriptions.cartCheckout> </react-cart-checkout-subscription-select> </span> \";","module.exports = \"<div class=\\\"page-header search full-width has-search-tabs\\\" ng-class=\\\"{'no-breadcrumbs': !breadcrumbs, 'no-label': !label, 'no-background-border': noBackgroundBorder, 'faceted-tag-crumbs': hasFacetedSearchFilters && facetedSearchService.tagCrumbsArray.length, 'has-background': enableBackground }\\\"> <div class=wrapper> <div class=background ng-if=enableBackground ng-style=\\\"background && {'background-image':'url(' + background + ')'}\\\"></div> <nav aria-label=\\\"search categories\\\"> <ul class=search-tabs ng-if=::showSearchTabs> <li ng-repeat=\\\"tab in tabs\\\" class=tabs data-test=search-tab-{{::tab.label}} ng-class=\\\"{'active': tab.label === activeTab.label}\\\"> <a aria-current=\\\"{{tab.label === activeTab.label ? 'page' : ''}}\\\" ng-attr-href=\\\"{{state.href(tab.state, {\\n              search_term: state.params.search_term,\\n              category_id: tabHrefParamCategoryId,\\n            }, {inherit: false})}}\\\"> {{::tab.label}} <span class=new-tag ng-if=::showNewTag(tab) aria-hidden=true>{{::config.searchTabTag.label}}</span> </a> </li> </ul> </nav> <nav aria-label=breadcrumbs ng-if=\\\"breadcrumbs.length > 0\\\"> <ul class=breadcrumbs> <li> <a ui-sref=main.home class=all analytics-click=\\\"['breadcrumbs home link', 'click']\\\" aria-label={{::lang.aria.goToHomepage}}> <span class=icon-home aria-hidden=true></span> </a> </li> <li ng-repeat=\\\"breadcrumb in breadcrumbs track by $index\\\"> <span class=divider></span> <a ng-if=breadcrumb.state ng-attr-href=\\\"{{state.href(breadcrumb.state, breadcrumb.params)}}\\\" analytics-click=\\\"['breadcrumbs link', 'click']\\\" ng-class=\\\"{active: $index == breadcrumbs.length - 1}\\\">{{breadcrumb.label}}</a> <span ng-if=!breadcrumb.state ng-class=\\\"{active: $index == breadcrumbs.length - 1}\\\">{{breadcrumb.label}}</span> </li> </ul> </nav> <h1 class=results data-test=search-results-text> {{label}} <loading-dots show=loading></loading-dots> <faceted-search-tag-crumbs selected-tag-crumbs=selectedTagCrumbs ng-if=\\\"::(!state.is('main.shop.offers') && !state.is('main.shop.coupons'))\\\"></faceted-search-tag-crumbs> </h1> <span ng-if=!!searchReformulationText class=search-reformulation-text data-test=search-reformulation-text> {{searchReformulationText}} </span> <span ng-if=isSpellCorrected class=search-correction-disabled-text data-test=search-correction-disabled-text> {{::lang.values.searchSpellCorrectionDisabled}} <a ui-sref={{searchSpellCorrectionDisabledSref}}>\\\"{{initialSearchTerm}}\\\"</a> </span> <div class=page-header-right-section> <flyer-preview flyer-data=flyerData preview-token=\\\"{{:: previewToken}}\\\"></flyer-preview> <button id=unata-loyalty-add-promo-code class=\\\"button small\\\" ng-if=button ng-click=button.onclick()>{{button.label}}</button> <a class=\\\"button small\\\" ng-if=\\\"link.href || link.sref\\\" ng-href=\\\"{{link.href || state.href(link.sref)}}\\\" ng-attr-target={{link.target}} analytics-click=\\\"['{{link.eventName}}', 'click']\\\">{{link.label}}</a> </div> </div> </div> \";","module.exports = \"<react-image-tile analytics-click=\\\"['recipes subcategories image link', 'click']\\\" border=reactProps.border images=reactProps.imagesObj link=reactProps.linkObj image-tile-title=reactProps.titleObj image-gutter=reactProps.imageGutter fixed-content=reactProps.fixedContent /> \";","module.exports = \"<div class=collections-home> <div page-header label=\\\"'Collections'\\\"></div> <div ng-if=::mobile.isMobile ng-include=\\\"'shopMenu.mobile.html'\\\"></div> <div ng-if=!collectionsContent fixed-to-body class=view-loading-indicator></div> <div class=collections> <ol analytics-placement-impression=\\\"[collectionsContent, 'ways_to_shop']\\\"> <li ng-repeat=\\\"banner in collectionsContent\\\" class=collection> <a ng-click=\\\"logPromotedPlacement(banner, 'Homepage Collection', $index)\\\" ng-init=canvas.logImpression(banner) content-href=banner class=collection-link analytics-click=\\\"['catalog home collection', 'click', $index]\\\"> <img ng-src={{util.escapeImageUrl(banner.media.image)}} alt={{banner.media.alt_text}}> <div ng-if=banner.target.collection.name class=label> {{banner.target.collection.name}} <span class=image-label__icon aria-hidden=true></span> </div> </a> </li> </ol> <div class=not-found ng-if=\\\"collectionsContent.length === 0\\\">{{::lang.values.noItemsFound}}</div> </div> </div> \";","import isMobileApp from '@app/utils/isMobileApp'\n\nexport default function (url: URL) {\n  if (['file:', 'capacitor:'].includes(url.protocol)) {\n    return true\n  }\n\n  return url.protocol === 'https:' && url.hostname.startsWith('localhost') && isMobileApp()\n}\n","module.exports = \"<div class=\\\"address-validation-modal modal-container\\\"> <div class=\\\"modal-header modal-header-collapse-desktop modal-mobile-header-brand\\\"> <button id=address-validation-modal-dismiss class=close ng-click=$dismiss() auto-focus=true aria-label={{::lang.aria.modalClose}}> <span class=icon-delete aria-hidden=true></span> </button> </div> <div class=modal-header> {{::$ctrl.lang.values.addressValidation.validateModalHeading}} </div> <div class=modal-content> <div ng-if=$ctrl.isValid> <h1>{{::$ctrl.lang.values.addressValidation.heading}}</h1> <div class=recommended-wrapper> <h2>{{::$ctrl.lang.values.addressValidation.recommended}}</h2> <div ng-repeat=\\\"address in $ctrl.recommendedAddresses\\\"> <div class=address> <input name=address-value id=address-value-{{$index}} type=radio ng-model=$ctrl.selectedAddress.address ng-value=address class=radio> <label for=address-value-{{$index}}> <div class=address-text> <span ng-if=address.address1.value ng-class=\\\"{'highlight': address.address1.changed}\\\" class=block>{{address.address1.value}}</span> <span ng-if=address.address2.value ng-class=\\\"{'highlight': address.address2.changed}\\\" class=block>{{address.address2.value}}</span> <span ng-if=address.address3.value ng-class=\\\"{'highlight': address.address3.changed}\\\" class=block>{{address.address3.value}}</span> <span ng-class=\\\"{'highlight': address.city.changed}\\\">{{address.city.value}}</span>, <span ng-class=\\\"{'highlight': address.province.changed}\\\">{{address.province.value}}</span> <span ng-class=\\\"{'highlight': address.postal_code.changed}\\\">{{address.postal_code.value}}</span> <span>{{auth.user.store.phone_number}}</span> </div> </label> </div> </div> </div> <hr/> <div class=original-wrapper> <h2>{{::$ctrl.lang.values.addressValidation.original}}</h2> <div class=address> <input name=address-value id=address-value-original type=radio ng-model=$ctrl.selectedAddress.address ng-value=$ctrl.originalAddress class=radio data-test=validate-original-input> <label for=address-value-original> <div class=address-text> <span ng-if=$ctrl.originalAddress.address1.value class=block>{{$ctrl.originalAddress.address1.value}}</span> <span ng-if=$ctrl.originalAddress.address2.value class=block>{{$ctrl.originalAddress.address2.value}}</span> <span ng-if=$ctrl.originalAddress.address3.value class=block>{{$ctrl.originalAddress.address3.value}}</span> <span>{{$ctrl.originalAddress.city.value}}, {{$ctrl.originalAddress.province.value}} {{$ctrl.originalAddress.postal_code.value}}</span> <span>{{auth.user.store.phone_number}}</span> </div> </label> </div> </div> </div> <div ng-if=!$ctrl.isValid> <h1>{{::$ctrl.lang.values.addressValidation.couldNotValidate}}</h1> <div class=address-text> <span ng-if=$ctrl.originalAddress.address1.value class=block>{{$ctrl.originalAddress.address1.value}}</span> <span ng-if=$ctrl.originalAddress.address2.value class=block>{{$ctrl.originalAddress.address2.value}}</span> <span ng-if=$ctrl.originalAddress.address3.value class=block>{{$ctrl.originalAddress.address3.value}}</span> <span>{{$ctrl.originalAddress.city.value}}, {{$ctrl.originalAddress.province.value}} {{$ctrl.originalAddress.postal_code.value}}</span> <span>{{auth.user.store.phone_number}}</span> </div> <p> {{::$ctrl.lang.values.addressValidation.disclaimer}} </p> </div> <div class=actions-wrapper> <button class=\\\"button hollow\\\" ng-click=$ctrl.editAddress()>{{::$ctrl.lang.values.addressValidation.goBackAndEdit}}</button> <button class=button ng-click=$ctrl.confirmSelectedAddress() data-test=confirm-validate-address>{{::$ctrl.lang.values.addressValidation.confirm}}</button> </div> </div> </div> \";","module.exports = \"<div class=product-points ng-if=\\\":: config.hasLoyaltyPoints && targetOffer.points\\\"> <span class=\\\"icon-points product-points-icon\\\"></span> <span class=product-points-amount>{{:: targetOffer.points}} {{::lang.values.points}}</span> <span class=product-points-expiry>{{::getFormatedDate(targetOffer.end_date)}}</span> </div> \";","import { useState, useEffect, useCallback } from 'react'\nimport { loading, subscriptions } from '@instacart/enterprise-services'\n\nconst useForceUpdate = () => {\n  const [, setTick] = useState(0)\n  const update = useCallback(() => {\n    setTick(tick => tick + 1)\n  }, [])\n  return update\n}\n\nexport const useLoading = () => {\n  const forceUpdate = useForceUpdate()\n  useEffect(() => loading.store.subscribe(forceUpdate), [forceUpdate])\n  return loading\n}\n\nexport const useSubscriptions = () => {\n  const forceUpdate = useForceUpdate()\n  useEffect(() => subscriptions.store.subscribe(forceUpdate), [forceUpdate])\n  return subscriptions\n}\n","export const SUBSCRIPTION_PATHS = {\n  BUYING: 'buying',\n  GIFTING: 'gifting',\n}\n","import React, { memo, forwardRef } from 'react'\nimport PropTypes from 'prop-types'\nimport { createStyles, utils, LazyImage } from '@instacart/cocktail'\n\nconst useStyles = createStyles(\n  tokens => ({\n    root: {\n      width: '100%',\n      borderTop: utils.toPx`${tokens.border.width.regular} solid ${tokens.color.border.regular}`,\n    },\n  }),\n  { displayName: 'SubscriptionCheckoutFooter' }\n)\n\nconst Footer = forwardRef((props, ref) => {\n  const styles = useStyles(props)\n  const { imageUrl, i18n, assetLoadingFunction, className } = props\n\n  return (\n    <div ref={ref} css={styles.root} className={className}>\n      <LazyImage\n        src={assetLoadingFunction(imageUrl)}\n        alt={i18n.imgAltText}\n        width=\"100%\"\n        height=\"100%\"\n      />\n    </div>\n  )\n})\n\nFooter.defaultProps = {\n  assetLoadingFunction: url => url,\n}\n\nFooter.propTypes = {\n  /** Custom style class name for the containing element */\n  className: PropTypes.string,\n  /** Image to show in the footer */\n  imageUrl: PropTypes.string,\n  /** Footer image alt text */\n  i18n: PropTypes.shape({\n    imgAltText: PropTypes.string,\n  }).isRequired,\n  /** function to load the asset images, this is needed for webpack to bundle the assets */\n  /** TODO: this can be removed once we move the images to a cdn and they don't have to be bundled */\n  assetLoadingFunction: PropTypes.func,\n}\n\nexport default memo(Footer)\n","import React, { useState, useEffect } from 'react'\nimport PropTypes from 'prop-types'\n\nconst Checkout = ({ i18n, route, paths, steps, onStateChange, ...restProps }) => {\n  const [currentParams, setCurrentParams] = useState({\n    path: paths && paths[0],\n  })\n\n  const getNextStep = () => {\n    const nextStepIndex = steps.findIndex(step => step.key === route) + 1\n    return nextStepIndex < steps.length ? steps[nextStepIndex] : steps[0]\n  }\n  const onStepComplete = params => {\n    setCurrentParams({\n      ...currentParams,\n      ...params,\n    })\n    onStateChange({ currentRoute: getNextStep().key, currentParams })\n  }\n\n  useEffect(() => {\n    const stepIndex = steps.findIndex(step => step.key === route)\n    // This checks that every step before the current step is valid\n    if (\n      steps\n        .slice(0, stepIndex + 1)\n        .every(step => step.isValid({ currentRoute: route, currentParams }))\n    ) {\n      onStateChange({ currentRoute: route, currentParams })\n    } else {\n      onStateChange({ currentRoute: steps[stepIndex - 1].key, currentParams })\n    }\n  }, [route, currentParams, onStateChange, steps])\n\n  const renderedSteps = steps.map(Step => {\n    return {\n      ...Step,\n      /* eslint-disable react/jsx-pascal-case */\n      component: (\n        <Step.component\n          i18n={i18n[Step.key]}\n          key={Step.key}\n          onStepComplete={onStepComplete}\n          {...currentParams}\n          {...restProps}\n        />\n      ),\n      /* eslint-enable react/jsx-pascal-case */\n    }\n  })\n\n  return renderedSteps.find(step => step.key === route).component || renderedSteps[0].component\n}\n\nCheckout.defaultProps = {\n  onStateChange: () => {},\n}\n\nCheckout.propTypes = {\n  /** Steps for the checkout process */\n  // eslint-disable-next-line react/forbid-prop-types\n  steps: PropTypes.array,\n  /** intial route to enter in the checkout process */\n  route: PropTypes.string.isRequired,\n  /** list of possible paths the checkout can take */\n  paths: PropTypes.arrayOf(PropTypes.string),\n  /** language object of objects with strings that correspond to each step */\n  // eslint-disable-next-line react/forbid-prop-types\n  i18n: PropTypes.object,\n  /** Callback function when the state changes */\n  onStateChange: PropTypes.func,\n}\n\nexport default Checkout\n","import React, { memo } from 'react'\nimport PropTypes from 'prop-types'\nimport { createStyles, Text, utils } from '@instacart/cocktail'\n\nconst useStyles = createStyles(\n  tokens => ({\n    root: {\n      textAlign: 'center',\n      width: '100%',\n    },\n    title: {\n      fontSize: tokens.size.font.h2,\n      [utils.mediaQuery.minWidth(tokens.breakpoint.small)]: {\n        fontSize: tokens.size.font.h1,\n      },\n    },\n    subtitle: {\n      fontSize: tokens.size.font.regular,\n      display: 'inline-block',\n      maxWidth: '850px',\n      [utils.mediaQuery.minWidth(tokens.breakpoint.small)]: {\n        fontSize: tokens.size.font.large,\n      },\n    },\n  }),\n  { displayName: 'SubscriptionCheckoutMarketing' }\n)\n\nconst defaultLang = {\n  title: 'Get unlimited shopping for only $49/yr.',\n  subtitle:\n    'With Fresh Grocery Express, you can avoid the crowded aisles, skip the long checkout lines, and save time and energy for everything else in your life.',\n}\n\nconst Header = props => {\n  const styles = useStyles(props)\n  const { i18n, className } = props\n\n  const lang = { ...defaultLang, ...i18n }\n  return (\n    <div css={styles.root} className={className}>\n      <Text variant=\"h2\" color=\"textPrimary\" css={styles.title}>\n        {lang.title}\n      </Text>\n      <Text variant=\"h3\" color=\"brandSecondary\" css={styles.subtitle}>\n        {lang.subtitle}\n      </Text>\n    </div>\n  )\n}\n\nHeader.propTypes = {\n  /** Custom style class name for the containing element */\n  className: PropTypes.string,\n  /** Custom language strings */\n  // eslint-disable-next-line react/forbid-prop-types\n  i18n: PropTypes.object,\n}\n\nexport default memo(Header)\n","import React, { Fragment, memo } from 'react'\nimport PropTypes from 'prop-types'\nimport {\n  createStyles,\n  ButtonGroup,\n  Button,\n  Text,\n  GridContainer,\n  GridItem,\n  LazyImage,\n  utils,\n} from '@instacart/cocktail'\nimport Header from '../Header'\n\nconst useStyles = createStyles(\n  tokens => ({\n    root: {\n      textAlign: 'center',\n      paddingLeft: tokens.size.spacing.medium,\n      paddingRight: tokens.size.spacing.medium,\n    },\n    valueProposition: {\n      fontSize: tokens.size.font.large,\n      margin: utils.toPx`0px 0px ${tokens.size.spacing.medium}`,\n      [utils.mediaQuery.maxWidth(tokens.breakpoint.small)]: {\n        margin: utils.toPx`0px 0px ${tokens.size.spacing.xSmall}`,\n      },\n    },\n    name: {\n      margin: utils.toPx`${tokens.size.spacing.xxxSmall} 0px`,\n    },\n    desc: {\n      fontSize: tokens.size.font.large,\n      display: 'inline-block',\n      maxWidth: '242px',\n    },\n    header: {\n      padding: tokens.size.spacing.medium,\n      marginBottom: tokens.size.spacing.xxLarge,\n    },\n\n    buttonStyles: {\n      display: 'flex',\n      flexWrap: 'row wrap',\n      justifyContent: 'center',\n      margin: utils.toPx`${tokens.size.spacing.medium} 0px`,\n    },\n\n    disclaimer: {\n      display: 'inline-block',\n      maxWidth: '676px',\n      color: tokens.color.text.secondary,\n      fontFamily: tokens.font.family.secondary,\n      textAlign: 'left',\n    },\n  }),\n  { displayName: 'SubscriptionCheckoutMarketing' }\n)\n\nconst SubscriptionMarketing = props => {\n  const styles = useStyles(props)\n  const {\n    i18n,\n    onStepComplete,\n    onBuySubscriptionClicked,\n    onGiftSubscriptionClicked,\n    marketing,\n    isGiftable,\n    isPurchasable,\n    assetLoadingFunction,\n  } = props\n\n  return (\n    <Fragment>\n      <Header css={styles.header} i18n={i18n.header} />\n      <div css={styles.root}>\n        <GridContainer alignContent=\"center\">\n          {i18n.valuePropositions.map((valueProposition, index) => (\n            <GridItem xSmall={12} small={4} key={valueProposition.name}>\n              <div css={styles.valueProposition}>\n                <GridContainer justify=\"center\" align=\"center\" alignContent=\"center\" spacing=\"none\">\n                  <GridItem small={12} xSmall={4}>\n                    <LazyImage\n                      alt={valueProposition.imageAltText}\n                      src={assetLoadingFunction(marketing.valuePropositions[index].icon)}\n                      height=\"85px\"\n                      width=\"85px\"\n                    />\n                  </GridItem>\n                  <GridItem small={12} xSmall={8}>\n                    <div>\n                      <Text variant=\"body\" color=\"brandPrimary\" css={styles.name}>\n                        {valueProposition.name}\n                      </Text>\n                      <Text variant=\"caption\" color=\"textPrimary\" css={styles.desc}>\n                        {valueProposition.desc}\n                      </Text>\n                    </div>\n                  </GridItem>\n                </GridContainer>\n              </div>\n            </GridItem>\n          ))}\n        </GridContainer>\n\n        <div css={styles.buttonStyles}>\n          <ButtonGroup>\n            {isPurchasable && (\n              <Button\n                onClick={() => {\n                  onBuySubscriptionClicked && onBuySubscriptionClicked()\n                  onStepComplete()\n                }}\n              >\n                {i18n.buyingSubscriptionButtonLabel}\n              </Button>\n            )}\n            {isGiftable && (\n              <Button\n                onClick={() => {\n                  onGiftSubscriptionClicked && onGiftSubscriptionClicked()\n                  onStepComplete({ path: 'gifting' })\n                }}\n                variant=\"outline\"\n              >\n                {i18n.giftingSubscriptionButtonLabel}\n              </Button>\n            )}\n          </ButtonGroup>\n        </div>\n\n        <Text\n          css={styles.disclaimer}\n          variant=\"caption\"\n          dangerouslySetInnerHTML={{ __html: i18n.disclaimer }}\n        />\n      </div>\n    </Fragment>\n  )\n}\n\nSubscriptionMarketing.defaultProps = {\n  assetLoadingFunction: url => url,\n}\n\nSubscriptionMarketing.propTypes = {\n  /** User pressed the next button */\n  onStepComplete: PropTypes.func,\n  /** User pressed the buy subscription button */\n  onBuySubscriptionClicked: PropTypes.func,\n  /** User pressed the gift subscription button */\n  onGiftSubscriptionClicked: PropTypes.func,\n  /** marketing object with icon images */\n  marketing: PropTypes.shape({\n    valuePropositions: PropTypes.arrayOf(\n      PropTypes.shape({\n        icon: PropTypes.string,\n      })\n    ),\n  }),\n  /** Custom language strings */\n  i18n: PropTypes.shape({\n    // eslint-disable-next-line react/forbid-prop-types\n    valuePropositions: PropTypes.array,\n    buyingSubscriptionButtonLabel: PropTypes.string,\n    giftingSubscriptionButtonLabel: PropTypes.string,\n    disclaimer: PropTypes.string,\n    header: PropTypes.shape({\n      default: PropTypes.shape({\n        title: PropTypes.string,\n        subtitle: PropTypes.string,\n      }),\n    }),\n  }).isRequired,\n  /** Whether subscriptions can be gifted */\n  isGiftable: PropTypes.bool,\n  /** Whether subscriptions can be purchased */\n  isPurchasable: PropTypes.bool,\n  /** function to load the asset images, this is needed for webpack to bundle the assets */\n  /** TODO: this can be removed once we move the images to a cdn and they don't have to be bundled */\n  assetLoadingFunction: PropTypes.func,\n}\n\nexport default memo(SubscriptionMarketing)\n","import React, { Fragment, useState, useEffect } from 'react'\nimport {\n  createStyles,\n  Button,\n  Text,\n  GridContainer,\n  GridItem,\n  FormControl,\n  FormLabel,\n  Select,\n  TextField,\n  FormHelpText,\n} from '@instacart/cocktail'\nimport PropTypes from 'prop-types'\nimport dayjs from 'dayjs'\nimport relativeTime from 'dayjs/plugin/relativeTime'\nimport { SUBSCRIPTION_PATHS } from '../constants'\nimport Header from '../Header'\n\ndayjs.extend(relativeTime)\n\nconst useStyles = createStyles(tokens => ({\n  root: {\n    paddingLeft: tokens.size.spacing.medium,\n    paddingRight: tokens.size.spacing.medium,\n  },\n  horizontalCenterAlign: {\n    display: 'flex',\n    justifyContent: 'center',\n  },\n  subscriptionsContainer: {\n    padding: tokens.size.spacing.small,\n    borderRadius: tokens.border.radius.regular,\n    backgroundColor: tokens.color.neutral.grey1,\n    marginTop: tokens.size.spacing.small,\n    marginBottom: tokens.size.spacing.small,\n  },\n  radioContainer: {\n    display: 'flex',\n    textTransform: 'capitalize',\n    marginBottom: tokens.size.spacing.small,\n    '&:last-child': {\n      marginBottom: tokens.size.spacing.none,\n    },\n  },\n  inputLabel: {\n    marginLeft: tokens.size.spacing.xxSmall,\n  },\n  formLabel: {\n    fontSize: tokens.size.font.large,\n  },\n  header: {\n    padding: tokens.size.spacing.medium,\n    marginBottom: tokens.size.spacing.xxLarge,\n  },\n  disclaimer: {\n    maxWidth: 676,\n    color: tokens.color.text.secondary,\n    fontFamily: tokens.font.family.secondary,\n    textAlign: 'left',\n    marginBottom: tokens.size.spacing.large,\n  },\n}))\n\nconst currentDate = new Date()\n\nconst formatDays = days => {\n  const expiryDate = dayjs(currentDate).add(days, 'day')\n  return (\n    dayjs(currentDate)\n      .to(dayjs(expiryDate), true)\n      // 1 Month instead of A Month (default)\n      .replace(/^(a|an)/i, '1')\n  )\n}\n\nconst getMonthString = month => dayjs(new Date(0, month)).format('MMMM')\n\nconst nextTenYears = new Array(10).fill(0).map((_, i) => ({\n  value: currentDate.getFullYear() + i,\n  label: `${currentDate.getFullYear() + i}`,\n}))\nconst listOfMonths = new Array(12).fill(0).map((_, i) => ({ value: i, label: getMonthString(i) }))\n\nconst defaultLang = {\n  disclaimer: '',\n  form: {\n    selectSubscription: 'Choose a subscription',\n    emailLabel: \"Recipient's email\",\n    emailPlaceholder: 'example@instacart.com',\n    submit: 'Continue to Payment',\n    dateLabel: 'Delivery Date',\n    customMessageLabel: 'Personalize your gift message',\n    customMessageCharacters: 'Characters',\n    errors: {\n      dateSelect: 'Date cannot be in the past',\n    },\n  },\n}\n\nconst SubscriptionSelection = props => {\n  const styles = useStyles(props)\n  const {\n    onStepComplete,\n    onSelectionComplete,\n    path,\n    maxMessageLength,\n    showDateSelection,\n    subscriptions,\n    i18n,\n  } = props\n\n  const lang = { ...defaultLang, ...i18n }\n\n  const [formData, setFormData] = useState({\n    email: '',\n    selectedSubscription: subscriptions[0] && subscriptions[0].id.toString(),\n    selectedYear: currentDate.getFullYear(),\n    selectedMonth: currentDate.getMonth(),\n    selectedDay: currentDate.getDate(),\n    customMessage: '',\n    errors: {\n      dateSelect: '',\n      customMessage: false,\n    },\n  })\n  const [daysForSelectedMonth, setDaysForSelectedMonth] = useState([])\n\n  useEffect(() => {\n    const newDaysList = new Array(\n      dayjs(new Date(formData.selectedYear, formData.selectedMonth)).daysInMonth()\n    )\n      .fill(0)\n      .map((_, i) => ({ value: i + 1, label: `${i + 1}` }))\n\n    setDaysForSelectedMonth(newDaysList)\n  }, [formData.selectedMonth, formData.selectedYear])\n\n  useEffect(() => {\n    setFormData(data => ({\n      ...data,\n      selectedSubscription: subscriptions && subscriptions[0] && subscriptions[0].id.toString(),\n    }))\n  }, [subscriptions])\n\n  /*\n   * Gets the errors present on the given form data\n   *\n   * @param {Object} - The form data to get errors for\n   *\n   * @returns {Object} errors\n   * {string} errors.dateSelect - Error message to be shown if selected date is in the past. Empty if no error.\n   * {boolean} errors.customMessage - True if the custom message is above the character limit. False if no error.\n   */\n  const getErrors = updatedFormData => {\n    const selectedDate = new Date(\n      updatedFormData.selectedYear,\n      updatedFormData.selectedMonth,\n      updatedFormData.selectedDay\n    )\n    const dateValid = !dayjs(selectedDate).isBefore(dayjs(currentDate), 'day')\n\n    return {\n      dateSelect: dateValid ? '' : lang.form.errors.dateSelect,\n      customMessage: updatedFormData.customMessage.length > maxMessageLength,\n    }\n  }\n\n  const hasErrors = () => {\n    return (\n      Object.values(formData.errors).reduce((foundError, error) => foundError || !!error, false) ||\n      (!formData.email && path === SUBSCRIPTION_PATHS.GIFTING)\n    )\n  }\n\n  const handleSubmit = event => {\n    event.preventDefault()\n\n    if (!hasErrors()) {\n      const params = {\n        path,\n        selectedSubscription: subscriptions.find(\n          subs => subs.id.toString() === formData.selectedSubscription\n        ),\n        customMessage: formData.customMessage,\n        date: new Date(formData.selectedYear, formData.selectedMonth, formData.selectedDay),\n        email: formData.email,\n      }\n      onSelectionComplete && onSelectionComplete(params)\n      onStepComplete(params)\n    }\n  }\n\n  const handleStateChange = key => {\n    return event => {\n      const newState = {\n        ...formData,\n        [key]: event.value || event.target.value,\n      }\n      setFormData({\n        ...newState,\n        errors: getErrors(newState),\n      })\n    }\n  }\n\n  return (\n    <Fragment>\n      <Header css={styles.header} i18n={i18n.header[path] || i18n.header.default} />\n      <div css={styles.root}>\n        <FormLabel style={styles.formLabel}>{lang.form.selectSubscription}</FormLabel>\n\n        <form onSubmit={handleSubmit}>\n          <div css={styles.subscriptionsContainer}>\n            {subscriptions.map(subscription => (\n              <div key={subscription.id} css={styles.radioContainer}>\n                {/* TODO: Use cocktail Radio button */}\n                <input\n                  type=\"radio\"\n                  name=\"subscription\"\n                  value={subscription.id}\n                  checked={subscription.id.toString() === formData.selectedSubscription}\n                  onChange={handleStateChange('selectedSubscription')}\n                />\n                <Text\n                  bold={subscription.id.toString() === formData.selectedSubscription}\n                  css={styles.inputLabel}\n                >\n                  {subscription.name}\n                  {\n                    // eslint-disable-next-line react/jsx-no-literals\n                    ' ('\n                  }\n                  {formatDays(subscription.days)}\n                  {\n                    // eslint-disable-next-line react/jsx-no-literals\n                    ') - $'\n                  }\n                  {subscription.price}\n                </Text>\n              </div>\n            ))}\n          </div>\n\n          <div css={styles.horizontalCenterAlign}>\n            <Text\n              css={styles.disclaimer}\n              variant=\"caption\"\n              dangerouslySetInnerHTML={{ __html: i18n.disclaimer }}\n            />\n          </div>\n\n          {path === SUBSCRIPTION_PATHS.GIFTING && (\n            <GridContainer>\n              <GridItem xSmall={12}>\n                <GridItem medium={6} small={12}>\n                  <TextField\n                    value={formData.email}\n                    onChange={handleStateChange('email')}\n                    type=\"email\"\n                    label={lang.form.emailLabel}\n                    inputSize=\"small\"\n                    placeholder={lang.form.emailPlaceholder}\n                    FormLabelProps={{ style: styles.formLabel }}\n                    fullWidth\n                    required\n                  />\n                </GridItem>\n              </GridItem>\n\n              {showDateSelection && (\n                <GridItem xSmall={12}>\n                  <GridItem medium={6} small={12}>\n                    <FormControl error={formData.errors.dateSelect.length > 0} required>\n                      <FormLabel style={styles.formLabel}>{lang.form.dateLabel}</FormLabel>\n                      <GridContainer spacing=\"xxxSmall\">\n                        <GridItem xSmall={7}>\n                          <Select\n                            value={listOfMonths.find(\n                              option => option.value === formData.selectedMonth\n                            )}\n                            options={listOfMonths}\n                            onChange={handleStateChange('selectedMonth')}\n                            inputSize=\"small\"\n                            minWidth={0}\n                            fullWidth\n                          />\n                        </GridItem>\n                        <GridItem xSmall={2}>\n                          <Select\n                            inputSize=\"small\"\n                            value={daysForSelectedMonth.find(\n                              option => option.value === formData.selectedDay\n                            )}\n                            onChange={handleStateChange('selectedDay')}\n                            minWidth={0}\n                            options={daysForSelectedMonth}\n                            fullWidth\n                          />\n                        </GridItem>\n                        <GridItem xSmall={3}>\n                          <Select\n                            inputSize=\"small\"\n                            value={nextTenYears.find(\n                              option => option.value === formData.selectedYear\n                            )}\n                            onChange={handleStateChange('selectedYear')}\n                            minWidth={0}\n                            options={nextTenYears}\n                            fullWidth\n                          />\n                        </GridItem>\n                      </GridContainer>\n                      {formData.errors.dateSelect && (\n                        <FormHelpText>{formData.errors.dateSelect}</FormHelpText>\n                      )}\n                    </FormControl>\n                  </GridItem>\n                </GridItem>\n              )}\n\n              <GridItem xSmall={12} medium={8}>\n                <TextField\n                  error={formData.errors.customMessage}\n                  value={formData.customMessage}\n                  onChange={handleStateChange('customMessage')}\n                  label={lang.form.customMessageLabel}\n                  helpText={`${formData.customMessage.length}/${maxMessageLength} ${lang.form.customMessageCharacters}`}\n                  FormHelpTextProps={{ style: { textAlign: 'right' } }}\n                  FormLabelProps={{ style: styles.formLabel }}\n                  multiline\n                  fullWidth\n                />\n              </GridItem>\n            </GridContainer>\n          )}\n\n          <div css={styles.horizontalCenterAlign}>\n            <Button type=\"submit\" disabled={hasErrors()}>\n              {lang.form.submit}\n            </Button>\n          </div>\n        </form>\n      </div>\n    </Fragment>\n  )\n}\n\nSubscriptionSelection.defaultProps = {\n  maxMessageLength: 250,\n  showDateSelection: false,\n}\n\nSubscriptionSelection.propTypes = {\n  /** Maximum length of the custom message */\n  maxMessageLength: PropTypes.number,\n  /** Whether to display the date selection for gifting */\n  showDateSelection: PropTypes.bool,\n  /** An array of subscription objects the user is selecting between */\n  subscriptions: PropTypes.arrayOf(\n    PropTypes.shape({\n      id: PropTypes.number.isRequired,\n      name: PropTypes.string.isRequired,\n      days: PropTypes.number.isRequired,\n      price: PropTypes.number.isRequred,\n      status: PropTypes.boolean,\n      created: PropTypes.string,\n      modified: PropTypes.string,\n    })\n  ).isRequired,\n  /** Language object with form labels and errors */\n  // eslint-disable-next-line react/forbid-prop-types\n  i18n: PropTypes.object,\n  /** Function to call when user selects subscription plan */\n  onSelectionComplete: PropTypes.func,\n  /** Function to call when user submits form */\n  onStepComplete: PropTypes.func,\n  /** Whether the user is gifting or buying the subscription */\n  path: PropTypes.oneOf(Object.values(SUBSCRIPTION_PATHS)),\n}\n\nexport default SubscriptionSelection\n","import PropTypes from 'prop-types'\n\nexport const CARD_PROPS = PropTypes.shape({\n  /** ExtId of the card */\n  ext_id: PropTypes.string.isRequired,\n  /** exp_month of the card */\n  exp_month: PropTypes.number,\n  /** exp_year of the card */\n  exp_year: PropTypes.number,\n  /** Has the card just been added? */\n  is_new: PropTypes.bool,\n  /** last_four_digits of the card */\n  last_four_digits: PropTypes.string.isRequired,\n  /** name of the card */\n  name: PropTypes.string,\n  /** provider of the card */\n  provider: PropTypes.string,\n  /** Whether the card is marked as a card to save */\n  shouldSave: PropTypes.bool,\n})\n","import React, { memo } from 'react'\nimport PropTypes from 'prop-types'\nimport { Button, Checkbox, createStyles, utils } from '@instacart/cocktail'\nimport { CARD_PROPS } from '../common/props'\n\nconst useStyles = createStyles(tokens => ({\n  container: {\n    display: 'block',\n    width: '100%',\n    height: '100%',\n  },\n  title: {\n    marginBottom: tokens.size.spacing.xSmall,\n    fontSize: tokens.size.font.large,\n    fontWeight: tokens.font.weight.bold,\n  },\n  card: {\n    position: 'relative',\n    whiteSpace: 'nowrap',\n    padding: utils.toPx`${tokens.size.spacing.xSmall} ${tokens.size.spacing.medium}`,\n  },\n  cardSelected: {\n    backgroundColor: tokens.color.neutral.grey1,\n    padding: utils.toPx`${tokens.size.spacing.small} ${tokens.size.spacing.medium}`,\n  },\n  cardRow: {\n    display: 'flex',\n    flexWrap: 'wrap',\n  },\n  radio: {\n    flex: '1 0 auto',\n    maxWidth: '90%',\n  },\n  radioButton: {\n    cursor: 'pointer',\n  },\n  label: {\n    position: 'relative',\n    top: tokens.size.spacing.xxxSmall,\n    width: '100%',\n    fontSize: tokens.size.font.body,\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n    marginLeft: tokens.size.spacing.xSmall,\n    cursor: 'pointer',\n  },\n  labelSelected: {\n    fontWeight: tokens.font.weight.bold,\n  },\n  deleteContainer: {\n    flex: '1 0 auto',\n  },\n  deleteLink: {\n    float: 'right',\n    marginTop: -tokens.size.spacing.xxxSmall,\n  },\n  deleteLinkHidden: {\n    visibility: 'hidden',\n  },\n  shouldSaveContainer: {\n    display: 'block',\n    position: 'relative',\n    top: -tokens.size.spacing.xxxSmall,\n    left: tokens.size.spacing.xxLarge,\n  },\n  shouldSave: {\n    label: {\n      position: 'relative',\n      top: tokens.size.spacing.xxxSmall,\n      color: tokens.color.neutral.grey4,\n      fontSize: tokens.size.font.caption,\n      fontStyle: 'italic',\n    },\n  },\n  submitButton: {\n    marginTop: tokens.size.spacing.xxSmall,\n    display: 'block',\n    width: '99%',\n    marginLeft: '0.5%',\n  },\n}))\n\nconst defaultLang = {\n  choosePayment: 'Choose a payment',\n  deleteCard: 'Delete',\n  saveInProfile: 'Save in Profile',\n  submitCard: 'Proceed with Checkout',\n}\n\nconst CreditCardList = props => {\n  const {\n    id,\n    i18n,\n    cards,\n    selectedCardExtId,\n    showSaveCardToggle,\n    onSelectCard,\n    onDeleteCard,\n    onSubmitCard,\n    onUpdateCard,\n  } = props\n\n  const styles = useStyles(props)\n  const lang = { ...defaultLang, ...i18n }\n  const { choosePayment, deleteCard, saveInProfile, submitCard } = lang\n  const selected = cards.findIndex(({ ext_id }) => ext_id === selectedCardExtId)\n  const radioBoxName = `creditCardList_${id}`\n\n  return (\n    <form id={id} data-test=\"creditCardList\" css={styles.container}>\n      <div css={styles.title}>{choosePayment}</div>\n\n      {cards.map(({ ext_id, isNew, last_four_digits, provider, shouldSave }, idx) => {\n        const isSelected = idx === (selected !== -1 ? selected : 0)\n        const label = `${provider} ****${last_four_digits}`\n\n        return (\n          <div key={ext_id} css={[styles.card, isSelected && styles.cardSelected]}>\n            <span css={styles.cardRow}>\n              <span title={label} css={styles.radio}>\n                <input\n                  type=\"radio\"\n                  id={`radio_${ext_id}`}\n                  name={radioBoxName}\n                  checked={isSelected}\n                  onClick={() => onSelectCard(ext_id)}\n                  css={styles.radioButton}\n                />\n                <label\n                  htmlFor={`radio_${ext_id}`}\n                  title={label}\n                  css={[styles.label, isSelected && styles.labelSelected]}\n                >\n                  {label}\n                </label>\n              </span>\n              <span css={styles.deleteContainer}>\n                <Button\n                  variant=\"link\"\n                  size=\"small\"\n                  onClick={() => onDeleteCard(ext_id)}\n                  css={[styles.deleteLink, isSelected && styles.deleteLinkHidden]}\n                >\n                  <span css={styles.label}>{deleteCard}</span>\n                </Button>\n              </span>\n            </span>\n            {showSaveCardToggle && isNew && (\n              <span css={styles.shouldSaveContainer}>\n                <Checkbox\n                  id={`shouldSave_${ext_id}`}\n                  checked={!!shouldSave}\n                  onChange={e => onUpdateCard(ext_id, { saveInProfile: e.target.checked })}\n                  inputSize=\"small\"\n                  styles={styles.shouldSave}\n                >\n                  {saveInProfile}\n                </Checkbox>\n              </span>\n            )}\n            {isSelected && (\n              <Button onClick={() => onSubmitCard(ext_id)} css={styles.submitButton}>\n                {submitCard}\n              </Button>\n            )}\n          </div>\n        )\n      })}\n    </form>\n  )\n}\n\nCreditCardList.propTypes = {\n  /** List of cards */\n  cards: PropTypes.arrayOf(CARD_PROPS).isRequired,\n  /** Language object for overrides */\n  // eslint-disable-next-line react/forbid-prop-types\n  i18n: PropTypes.object,\n  /** Id for this component - required */\n  id: PropTypes.string.isRequired,\n  /** When the delete link for a card is pressed: onDelete(extId) */\n  onDeleteCard: PropTypes.func.isRequired,\n  /** When a card is selected via a radio box toggle: onSelect(extId) */\n  onSelectCard: PropTypes.func.isRequired,\n  /** When the submit button for a card is pressed: onSubmit(extId) */\n  onSubmitCard: PropTypes.func.isRequired,\n  /** When the status of a card is updated, e.g. saveInProfile: onCardUpdate(extId, stateUpdate) */\n  onUpdateCard: PropTypes.func.isRequired,\n  /** Selected card ExtId */\n  selectedCardExtId: PropTypes.string,\n  /** Whether to show the save card option */\n  showSaveCardToggle: PropTypes.bool,\n}\n\nexport default memo(CreditCardList)\n","import React, { memo, useState, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport { createStyles } from '@instacart/cocktail'\n\nconst useStyles = createStyles(() => ({\n  iframe: {\n    display: 'none',\n    width: '100%',\n    height: 240,\n    textAlign: 'center',\n  },\n  iframeActive: {\n    display: 'block',\n  },\n}))\n\nconst defaultLang = {\n  iframeTitle: 'Credit card view',\n}\n\nconst PaymentIframe = props => {\n  const { id, i18n, onPaymentIframeRendered, showIframe, url } = props\n  const [iframeRef] = useState(() => React.createRef())\n  const styles = useStyles(props)\n\n  useEffect(() => {\n    onPaymentIframeRendered(iframeRef.current)\n  }, [onPaymentIframeRendered, iframeRef])\n\n  const lang = { ...defaultLang, ...i18n }\n\n  return (\n    <iframe\n      id={id}\n      ref={iframeRef}\n      src={url}\n      title={lang.iframeTitle}\n      scrolling=\"auto\"\n      frameBorder=\"0\"\n      css={[styles.iframe, showIframe && styles.iframeActive]}\n    />\n  )\n}\n\nPaymentIframe.defaultProps = {\n  onPaymentIframeRendered: () => {},\n  showIframe: false,\n  url: '',\n}\n\nPaymentIframe.propTypes = {\n  /** Language object for overrides */\n  // eslint-disable-next-line react/forbid-prop-types\n  i18n: PropTypes.object,\n  /** Id for this component - required */\n  id: PropTypes.string.isRequired,\n  /** Once the iframe is available: onPaymentIframeRendered(iframe) */\n  onPaymentIframeRendered: PropTypes.func,\n  /** Whether to show the iframe */\n  showIframe: PropTypes.bool,\n  /** The Vantiv Url to load (can be left blank not to load the iframe) */\n  url: PropTypes.string,\n}\n\nexport default memo(PaymentIframe)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { withStyles, Button, LoadingDots, utils } from '@instacart/cocktail'\nimport CreditCardList from '../components/CreditCardList'\nimport PaymentIframe from '../components/PaymentIframe'\nimport { CARD_PROPS } from '../common/props'\n\nconst styling = tokens => {\n  return {\n    container: {\n      position: 'relative',\n      width: '100%',\n      minHeight: 240,\n    },\n    containerLoading: {\n      display: 'none',\n    },\n    loading: {\n      margin: utils.toPx`${tokens.size.layout.medium} auto`,\n      width: 0,\n    },\n    addCard: {\n      fontWeight: tokens.font.weight.bold,\n    },\n  }\n}\n\nconst defaultLang = {\n  addCard: 'Add New Card',\n}\n\nclass PaymentFormVantiv extends React.PureComponent {\n  static propTypes = {\n    /** List of cards */\n    cards: PropTypes.arrayOf(CARD_PROPS).isRequired,\n    /** Id for this component - required */\n    id: PropTypes.string.isRequired,\n    /** Language object for overrides */\n    // eslint-disable-next-line react/forbid-prop-types\n    i18n: PropTypes.object,\n    /** Whether to show the new card iframe or not */\n    isAddNewCard: PropTypes.bool.isRequired,\n    /** Whether to show the loader or not */\n    isIframeLoading: PropTypes.bool.isRequired,\n    /** When a card the add new card button is clicked: onAddNewCard() */\n    onAddNewCard: PropTypes.func.isRequired,\n    /** The Vantiv Url to load (can be left blank not to load the iframe) */\n    vantivUrl: PropTypes.string,\n    /** Style overrides */\n    // eslint-disable-next-line react/forbid-prop-types\n    styles: PropTypes.object,\n  }\n\n  render() {\n    const {\n      cards,\n      id,\n      isAddNewCard,\n      isIframeLoading,\n      i18n,\n      styles,\n      vantivUrl,\n      onAddNewCard,\n      ...restProps\n    } = this.props\n\n    const lang = { ...defaultLang, ...i18n }\n\n    return (\n      <div id={id} data-test=\"paymentFormVantiv\">\n        <span css={[styles.container, isIframeLoading && styles.containerLoading]}>\n          {!isAddNewCard && !isIframeLoading && (\n            <>\n              <CreditCardList cards={cards} id={`${id}_creditCardList`} {...restProps} />\n              <Button variant=\"link\" onClick={onAddNewCard} css={styles.addCard}>\n                {lang.addCard}\n              </Button>\n            </>\n          )}\n          {/*\n           * The iframe needs to be available even when hidden so that the existing Vantiv logic in\n           * Angular JS is able to hook straight to the iframe as soon as this UI is rendered\n           */}\n          <PaymentIframe\n            id=\"iframeVantiv\"\n            showIframe={isAddNewCard}\n            url={vantivUrl}\n            {...restProps}\n          />\n        </span>\n        {isIframeLoading && (\n          <div css={styles.loading}>\n            <LoadingDots />\n          </div>\n        )}\n      </div>\n    )\n  }\n}\n\nexport default withStyles(styling, { displayName: 'PaymentFormVantiv' })(PaymentFormVantiv)\n","import React, { Fragment, memo, useState } from 'react'\nimport PropTypes from 'prop-types'\nimport { PaymentFormVantiv, CARD_PROPS } from '@instacart/enterprise-payments'\nimport { createStyles, Alert, utils } from '@instacart/cocktail'\nimport { SUBSCRIPTION_PATHS } from '../constants'\nimport Header from '../Header'\n\nconst useStyles = createStyles(tokens => ({\n  root: {\n    paddingLeft: tokens.size.spacing.medium,\n    paddingRight: tokens.size.spacing.medium,\n  },\n  isAddNewCardRoot: {\n    paddingLeft: 0,\n    paddingRight: 0,\n\n    [utils.mediaQuery.minWidth(tokens.breakpoint.small)]: {\n      paddingLeft: tokens.size.spacing.medium,\n      paddingRight: tokens.size.spacing.medium,\n    },\n  },\n  error: {\n    marginBottom: tokens.size.layout.xSmall,\n  },\n  header: {\n    padding: tokens.size.spacing.medium,\n    marginBottom: tokens.size.spacing.xxLarge,\n  },\n}))\n\nconst defaultLang = {\n  defaultErrorMessage: 'Oops! Something went wrong... Please try again.',\n  criticalErrorMessage: 'Oops! Something went wrong... Please contact support.',\n}\n\n/**\n * @Component\n * SubscriptionPayment\n *\n * This handles displaying of payment options and the purchasing\n */\nconst SubscriptionPayment = props => {\n  const {\n    cards,\n    email,\n    i18n,\n    isAddNewCard,\n    isIframeLoading,\n    customMessage,\n    onAddNewCard,\n    onPurchaseComplete,\n    onStepComplete,\n    path,\n    selectedSubscription,\n    services,\n  } = props\n\n  const styles = useStyles(props)\n  const { loadingService, subscriptionsService } = services\n  const { isLoading } = loadingService.selectors\n  const { BUY_SUBSCRIPTION, GIFT_SUBSCRIPTION } = subscriptionsService.constants\n  const [errorMessage, setErrorMessage] = useState('')\n  const showLoading = isIframeLoading || isLoading(BUY_SUBSCRIPTION) || isLoading(GIFT_SUBSCRIPTION)\n  const lang = { ...defaultLang, ...i18n }\n\n  const purchaseSubscription = async paymentInstrumentId => {\n    const card = cards.find(({ ext_id }) => ext_id === paymentInstrumentId)\n    let errorLang = lang.defaultErrorMessage\n\n    try {\n      const subscriptionId = selectedSubscription.id\n\n      switch (path) {\n        case SUBSCRIPTION_PATHS.BUYING:\n          await subscriptionsService.promiseActions.buySubscription(subscriptionId, {\n            payment_instrument: card,\n          })\n          break\n        case SUBSCRIPTION_PATHS.GIFTING:\n          await subscriptionsService.promiseActions.giftSubscription(\n            subscriptionId,\n            { payment_instrument: card },\n            { email, message: customMessage }\n          )\n          break\n        default:\n          errorLang = lang.criticalErrorMessage\n          throw new Error(`Unrecognized subscription path: ${path}`)\n      }\n\n      onPurchaseComplete({ selectedSubscription, path, email })\n      onStepComplete()\n    } catch (e) {\n      setErrorMessage(errorLang)\n      throw e\n    }\n  }\n\n  return (\n    <Fragment>\n      <Header css={styles.header} i18n={i18n.header[path] || i18n.header.default} />\n      <div css={[styles.root, isAddNewCard && styles.isAddNewCardRoot]}>\n        {errorMessage && (\n          <Alert variant=\"error\" css={styles.error}>\n            {errorMessage}\n          </Alert>\n        )}\n        <PaymentFormVantiv\n          {...props}\n          id=\"subscriptionPaymentFormVantiv\"\n          cards={cards || []}\n          isIframeLoading={showLoading || !cards}\n          onSubmitCard={purchaseSubscription}\n          onAddNewCard={() => {\n            setErrorMessage('')\n            return onAddNewCard()\n          }}\n        />\n      </div>\n    </Fragment>\n  )\n}\n\nSubscriptionPayment.propTypes = {\n  /** List of cards */\n  cards: PropTypes.arrayOf(CARD_PROPS),\n  /** For gifting: The email to send the gift to */\n  email: PropTypes.string,\n  /** Language overrides */\n  // eslint-disable-next-line react/forbid-prop-types\n  i18n: PropTypes.object,\n  /** Whether to show the new card iframe or not */\n  isAddNewCard: PropTypes.bool,\n  /** Whether to show the loader or not */\n  isIframeLoading: PropTypes.bool,\n  /** For gifting: The message to send with the gift */\n  customMessage: PropTypes.string,\n  /** Path: Determine if we're gifting or buying */\n  path: PropTypes.string.isRequired,\n  /** function to call when the step is complete */\n  onPurchaseComplete: PropTypes.func,\n  /** function to call when the step is complete */\n  onStepComplete: PropTypes.func,\n  /** function to add a new card - used for testing the readyness of Angular JS */\n  onAddNewCard: PropTypes.func,\n  /** The selected subscription from the previous step */\n  selectedSubscription: PropTypes.shape({\n    id: PropTypes.number.isRequired,\n  }).isRequired,\n  /** Services for use with SubscriptionCheckout */\n  services: PropTypes.shape({\n    // eslint-disable-next-line react/forbid-prop-types\n    loadingService: PropTypes.object.isRequired,\n    // eslint-disable-next-line react/forbid-prop-types\n    subscriptionsService: PropTypes.object.isRequired,\n  }).isRequired,\n  /** Styles to override the default styles */\n  // eslint-disable-next-line react/forbid-prop-types\n  styles: PropTypes.object,\n}\n\nSubscriptionPayment.defaultProps = {\n  onAddNewCard: () => {},\n  onPurchaseComplete: () => {},\n  onStepComplete: () => {},\n  customMessage: '',\n}\n\nexport default memo(SubscriptionPayment)\n","import React, { Fragment } from 'react'\nimport { Button, Text, createStyles } from '@instacart/cocktail'\nimport { lang as langService } from '@instacart/enterprise-services'\nimport dayjs from 'dayjs'\nimport advancedFormat from 'dayjs/plugin/advancedFormat'\nimport PropTypes from 'prop-types'\nimport { SUBSCRIPTION_PATHS } from '../constants'\nimport Header from '../Header'\n\ndayjs.extend(advancedFormat)\n\nconst useStyles = createStyles(tokens => ({\n  root: {\n    marginBottom: tokens.size.layout.xLarge,\n    paddingLeft: tokens.size.spacing.medium,\n    paddingRight: tokens.size.spacing.medium,\n  },\n  buttonContainer: {\n    display: 'flex',\n    justifyContent: 'center',\n    margin: tokens.size.spacing.medium,\n  },\n  secondMessage: {\n    marginTop: tokens.size.layout.medium,\n  },\n  buyingMessage: {\n    a: {\n      color: tokens.color.brand.primary.dark,\n    },\n  },\n  header: {\n    padding: tokens.size.spacing.medium,\n    marginBottom: tokens.size.spacing.xxLarge,\n  },\n}))\n\nconst defaultLang = {\n  continueButton: 'Start Shopping',\n  buying: {\n    message1: `Thank you for subscribing to Fresh Grocery. Like thousands of other members, you can now enjoy the convenience of\n       FREE pick fees and exclusive promotions for Fresh Grocery shoppers for a whole year.`,\n    message2:\n      'For further information about your subscription, please visit your <a>Profile</a> page on freshgrocery.com.',\n  },\n  gifting: {\n    message1:\n      'Gift subscriptions were purchased for: <b>{{email}}</b> and will be delivered on <b>{{date}}</b>.',\n    message2: `A redemption code and further instructions will be sent to the recipient through email. Customers will\n       have 7 days to redeem the subscription. If unredeemed for 7 days, you will recieve a refund for the subscription amount.`,\n  },\n}\n\nconst SubscriptionSuccess = props => {\n  const styles = useStyles(props)\n\n  const { path, i18n, email, date, onContinueClicked } = props\n  const lang = { ...defaultLang, ...i18n }\n\n  const htmlVars = {\n    email: email || '',\n    date: (date && dayjs(date).format('MMMM Do, YYYY')) || '',\n  }\n\n  return (\n    <Fragment>\n      <Header css={styles.header} i18n={i18n.header[path] || i18n.header.default} />\n      <div css={styles.root}>\n        <Text\n          variant=\"large\"\n          color=\"textPrimary\"\n          dangerouslySetInnerHTML={{\n            __html: langService.interpolate(lang[path].message1, htmlVars),\n          }}\n        />\n        {path === SUBSCRIPTION_PATHS.GIFTING && (\n          <Text css={styles.secondMessage} variant=\"large\" color=\"textPrimary\">\n            {lang[path].message2}\n          </Text>\n        )}\n        <div css={styles.buttonContainer}>\n          <Button onClick={onContinueClicked}>{lang.continueButton}</Button>\n        </div>\n        {path === SUBSCRIPTION_PATHS.BUYING && (\n          <Text\n            css={styles.buyingMessage}\n            variant=\"large\"\n            color=\"textPrimary\"\n            dangerouslySetInnerHTML={{ __html: lang[path].message2 }}\n          />\n        )}\n      </div>\n    </Fragment>\n  )\n}\n\nSubscriptionSuccess.propTypes = {\n  /** Path: Determine if we're gifting or buying */\n  path: PropTypes.string.isRequired,\n  /** Language object for overrides */\n  // eslint-disable-next-line react/forbid-prop-types\n  i18n: PropTypes.object,\n  /** email to send to if gifting (display only) */\n  email: PropTypes.string,\n  /** Date to send subscription if gifting (display only) */\n  // eslint-disable-next-line react/forbid-prop-types\n  date: PropTypes.object,\n  /** function to call when the continue button is clicked */\n  onContinueClicked: PropTypes.func,\n}\n\nexport default SubscriptionSuccess\n","import React, { memo } from 'react'\nimport { createStyles, utils } from '@instacart/cocktail'\nimport PropTypes from 'prop-types'\nimport { SUBSCRIPTION_PATHS } from './constants'\nimport Footer from './Footer'\nimport Checkout from './Checkout'\nimport SubscriptionMarketing from './steps/SubscriptionMarketing'\nimport SubscriptionSelection from './steps/SubscriptionSelection'\nimport SubscriptionPayment from './steps/SubscriptionPayment'\nimport SubscriptionSuccess from './steps/SubscriptionSuccess'\n\nexport const SUBSCRIPTION_STEPS = [\n  {\n    key: 'marketing',\n    component: SubscriptionMarketing,\n    isValid: () => true,\n    // The following is required to tie in the steps with AngularJS UI router routes\n    urlName: '/info',\n    data: {\n      requireRegistered: false,\n    },\n  },\n\n  {\n    key: 'select',\n    component: SubscriptionSelection,\n    isValid: () => true,\n    // The following is required to tie in the steps with AngularJS UI router routes\n    urlName: '/select',\n    data: {\n      requireRegistered: true,\n    },\n  },\n\n  {\n    key: 'payment',\n    component: SubscriptionPayment,\n    isValid: param => {\n      return !!param.currentParams?.selectedSubscription?.id\n    },\n    // The following is required to tie in the steps with AngularJS UI router routes\n    urlName: '/payment',\n    data: {\n      requireRegistered: true,\n    },\n  },\n\n  {\n    key: 'success',\n    component: SubscriptionSuccess,\n    isValid: () => true,\n    // The following is required to tie in the steps with AngularJS UI router routes\n    urlName: '/purchased',\n    data: {\n      requireRegistered: true,\n    },\n  },\n]\n\nconst useStyles = createStyles(\n  tokens => ({\n    root: {\n      display: 'flex',\n      width: '100%',\n      backgroundColor: tokens.color.neutral.grey1,\n      justifyContent: 'center',\n      padding: 0,\n      [utils.mediaQuery.minWidth(tokens.breakpoint.small)]: {\n        padding: tokens.size.spacing.xxLarge,\n      },\n    },\n    container: {\n      maxWidth: tokens.breakpoint.large,\n      borderRadius: tokens.border.radius.regular,\n      backgroundColor: tokens.color.neutral.white,\n    },\n    footer: {\n      marginTop: tokens.size.spacing.xxLarge,\n    },\n  }),\n  { displayName: 'SubscriptionCheckout' }\n)\n\nconst SubscriptionCheckout = props => {\n  const styles = useStyles(props)\n  const {\n    config,\n    i18n,\n    styles: originalStyles,\n    services,\n    isGiftable,\n    isPurchasable,\n    ...restProps\n  } = props\n\n  const { subscriptionsService } = services\n  const subscriptions = subscriptionsService.selectors.getStoreSubscriptions()\n  const { footer, isGiftingEnabled, isPurchasingEnabled } = config.subscriptions\n\n  // Inject the default header value into the step header\n  const i18nWithDefaultHeaderInSteps = SUBSCRIPTION_STEPS.reduce((newI18n, step) => {\n    return {\n      ...newI18n,\n      [step.key]: {\n        ...i18n[step.key],\n        header: {\n          default: {\n            ...i18n.header,\n          },\n          ...(i18n[step.key] && i18n[step.key].header),\n        },\n      },\n    }\n  }, i18n)\n\n  return (\n    <div css={styles.root}>\n      <div css={styles.container}>\n        <Checkout\n          steps={SUBSCRIPTION_STEPS}\n          paths={Object.values(SUBSCRIPTION_PATHS)}\n          i18n={i18nWithDefaultHeaderInSteps}\n          subscriptions={subscriptions}\n          services={services}\n          config={config}\n          isGiftable={isGiftingEnabled && isGiftable}\n          isPurchasable={isPurchasingEnabled && isPurchasable}\n          {...config.subscriptions}\n          {...restProps}\n        />\n        <Footer css={styles.footer} i18n={i18n.footer} {...footer} {...restProps} />\n      </div>\n    </div>\n  )\n}\n\nSubscriptionCheckout.defaultProps = {\n  isGiftable: true,\n  isPurchasable: true,\n}\n\nSubscriptionCheckout.propTypes = {\n  /** Services for use with SubscriptionCheckout */\n  services: PropTypes.shape({\n    // eslint-disable-next-line react/forbid-prop-types\n    loadingService: PropTypes.object,\n    // eslint-disable-next-line react/forbid-prop-types\n    subscriptionsService: PropTypes.object,\n  }),\n  /** Styles to override the default styles */\n  // eslint-disable-next-line react/forbid-prop-types\n  styles: PropTypes.object,\n  /** Configs to pass to the components */\n  // eslint-disable-next-line react/forbid-prop-types\n  config: PropTypes.object,\n  /** Language overrides */\n  i18n: PropTypes.shape({\n    // eslint-disable-next-line react/forbid-prop-types\n    footer: PropTypes.object,\n    // eslint-disable-next-line react/forbid-prop-types\n    header: PropTypes.object,\n  }),\n  /** Whether subscriptions can be gifted */\n  isGiftable: PropTypes.bool,\n  /** Whether subscriptions can be purchased */\n  isPurchasable: PropTypes.bool,\n}\n\nexport default memo(SubscriptionCheckout)\n","import React, { Fragment } from 'react'\nimport {\n  Checkbox,\n  Text,\n  createStyles,\n  utils,\n  GridContainer,\n  GridItem,\n  FormLabel,\n} from '@instacart/cocktail'\nimport { lang as langService } from '@instacart/enterprise-services'\n\n// TODO: use cocktail component for radio button once it is ready\n// TODO: use a dropdown for when there is more than 2 subscription options\n\nimport PropTypes from 'prop-types'\n\nconst useStyles = props =>\n  createStyles(\n    tokens => ({\n      root: {\n        width: '100%',\n        backgroundColor: tokens.color.neutral.grey1,\n        padding: tokens.size.layout.xxSmall,\n      },\n      title: {\n        color: tokens.color.text.primary,\n        fontWeight: tokens.font.weight.bold,\n      },\n      selectOption: {\n        marginTop: tokens.size.layout.xxSmall,\n      },\n      radioButton: {\n        flex: '0 0 auto',\n        height: tokens.size.checkbox.height.regular,\n        width: tokens.size.checkbox.height.regular,\n      },\n      radioLabel: {\n        color: tokens.color.text.primary,\n        fontSize: tokens.size.font.caption,\n        verticalAlign: 'middle',\n        display: 'flex',\n      },\n      radioLabelText: {\n        paddingTop: (tokens.size.checkbox.height.regular - tokens.size.font.body) / 2,\n        display: 'inline-block',\n      },\n      subscribedIcon: {\n        height: tokens.size.checkbox.height.regular,\n        width: tokens.size.checkbox.height.regular,\n        marginRight: tokens.size.spacing.xxSmall,\n        backgroundImage: `url(${props.config.cartCheckout.subscribedIcon})`,\n      },\n    }),\n    { displayName: 'CartCheckoutSubscriptionSelect' }\n  )(props)\n\nconst getSubscriptionFromCart = cartItems => {\n  const foundCartItem =\n    cartItems &&\n    cartItems.find(cartItem => {\n      return cartItem.store_product.product_type === 'subscription'\n    })\n  return foundCartItem\n}\n\nconst defaultLang = {\n  title: 'Yes, I want unlimited FREE Pick Up!',\n  subtitle:\n    \"For only $49/year, get unlimited Pick Up services for a full year. View <a href='instacart.com' target='_blank'>Terms and Conditions.</a>\",\n  selectOption: 'Select Option:',\n  subscribedTitle: 'You get FREE Pick Up!',\n  subscribedSubtitle: 'Thank you for being a Fresh Express member.',\n  ariaLabels: {\n    toggleSubscriptions: 'Toggle subscriptions',\n    addSubscription: 'Add {{subscriptionName}}',\n  },\n}\n\nconst CartCheckoutSubscriptionSelect = props => {\n  const {\n    config,\n    i18n,\n    subscriptions,\n    onSubscriptionSelected,\n    // TODO (deprecated after 2.26): cartItems is not needed as we won't be using the cart to buy subscriptions anymore\n    cartItems,\n    styles: originalStyles,\n    isDisabled,\n    userSubscription,\n    selectedSubscription,\n    ...restProps\n  } = props\n  const styles = useStyles(props)\n\n  const lang = { ...defaultLang, ...i18n }\n\n  const subscriptionInCart = getSubscriptionFromCart(cartItems)\n\n  const passOldSubscription = ({ newSubscription }) => {\n    onSubscriptionSelected({\n      selectedSubscription: newSubscription,\n      // TODO (deprecated after 2.26): subscriptionInCart is not needed as we won't be using the cart to buy subscriptions anymore\n      oldSubscription: subscriptionInCart || selectedSubscription,\n    })\n  }\n\n  const checkboxClicked = event => {\n    if (event.target.checked) {\n      passOldSubscription({ newSubscription: subscriptions && subscriptions[0] })\n    } else {\n      passOldSubscription({ newSubscription: null })\n    }\n  }\n\n  const listItems = (\n    <div>\n      <Text css={styles.selectOption} variant=\"caption\" color=\"textPrimary\" bold>\n        {lang.selectOption}\n      </Text>\n      <div>\n        {subscriptions &&\n          subscriptions.map(sub => (\n            <div key={sub.id}>\n              <label htmlFor={sub.id} css={styles.radioLabel}>\n                <input\n                  type=\"radio\"\n                  name=\"selectedSubscription\"\n                  defaultChecked={\n                    // TODO (deprecated after 2.26): subscriptionInCart is not needed as we won't be using the cart to buy subscriptions anymore\n                    (subscriptionInCart && subscriptionInCart.store_product.id === sub.id) ||\n                    selectedSubscription?.id === sub.id\n                  }\n                  onClick={() => passOldSubscription({ newSubscription: sub })}\n                  id={sub.id}\n                  disabled={isDisabled}\n                  css={styles.radioButton}\n                  aria-label={langService.interpolate(lang.ariaLabels.addSubscription, {\n                    subscriptionName: sub.name,\n                  })}\n                />\n                {/* // TODO (deprecated after 2.26): sub.base_price is not needed as 'sub_price' is only for store products */}\n                <div css={styles.radioLabelText}>\n                  {sub.name}\n                  {\n                    // eslint-disable-next-line react/jsx-no-literals\n                    ' - '\n                  }\n                  {utils.formatCurrency(sub.base_price || sub.price)}\n                </div>\n              </label>\n            </div>\n          ))}\n      </div>\n    </div>\n  )\n\n  const isNotSubscribed = (\n    <Fragment>\n      <GridItem>\n        <Checkbox\n          id=\"subscription-checkbox\"\n          // TODO (deprecated after 2.26): subscriptionInCart is not needed as we won't be using the cart to buy subscriptions anymore\n          defaultChecked={subscriptionInCart || selectedSubscription}\n          onChange={checkboxClicked}\n          disabled={isDisabled}\n          aria-label={lang.ariaLabels.toggleSubscriptions}\n        />\n      </GridItem>\n      <GridItem>\n        <FormLabel htmlFor=\"subscription-checkbox\" css={styles.title}>\n          {lang.title}\n        </FormLabel>\n        <Text\n          variant=\"caption\"\n          color=\"textPrimary\"\n          dangerouslySetInnerHTML={{ __html: lang.subtitle }}\n        />\n        {/* // TODO (deprecated after 2.26): subscriptionInCart is not needed as we won't be using the cart to buy subscriptions anymore */}\n        {subscriptions &&\n          subscriptions.length > 1 &&\n          (subscriptionInCart || selectedSubscription) &&\n          listItems}\n      </GridItem>\n    </Fragment>\n  )\n\n  const isSubscribed = (\n    <Fragment>\n      <GridItem>\n        {config && config.cartCheckout && config.cartCheckout.subscribedIcon && (\n          <div css={styles.subscribedIcon} />\n        )}\n      </GridItem>\n      <GridItem>\n        <Text color=\"textPrimary\" bold>\n          {lang.subscribedTitle}\n        </Text>\n        <Text variant=\"caption\" color=\"textPrimary\">\n          {lang.subscribedSubtitle}\n        </Text>\n      </GridItem>\n    </Fragment>\n  )\n\n  return (\n    config &&\n    config.enabled &&\n    config.cartCheckout.enabled && (\n      <GridContainer\n        css={styles.root}\n        {...restProps}\n        align=\"flex-start\"\n        wrap=\"nowrap\"\n        spacing=\"none\"\n      >\n        {userSubscription ? isSubscribed : isNotSubscribed}\n      </GridContainer>\n    )\n  )\n}\n\nCartCheckoutSubscriptionSelect.defaultProps = {}\n\nCartCheckoutSubscriptionSelect.propTypes = {\n  /** Styles to override the default styles */\n  // eslint-disable-next-line react/forbid-prop-types\n  styles: PropTypes.object,\n  /** Configs to pass to the components */\n  // eslint-disable-next-line react/forbid-prop-types\n  config: PropTypes.object,\n  /** Language overrides */\n  // eslint-disable-next-line react/forbid-prop-types\n  i18n: PropTypes.object,\n  /** Array of subscriptions to pick from */\n  // eslint-disable-next-line react/forbid-prop-types\n  subscriptions: PropTypes.array,\n  // TODO (deprecated after 2.26): Not needed as we won't be using the cart to buy subscriptions anymore\n  /** Array of items currently in the cart */\n  // eslint-disable-next-line react/forbid-prop-types\n  cartItems: PropTypes.array,\n  /** Function to when a new subscription is selected */\n  onSubscriptionSelected: PropTypes.func,\n  /** Boolean to disable the component */\n  isDisabled: PropTypes.bool,\n  /** Subscription object that is currently on the user */\n  // eslint-disable-next-line react/forbid-prop-types\n  userSubscription: PropTypes.object,\n  /** Subscription object that has been selected and is waiting to be ordered */\n  // eslint-disable-next-line react/forbid-prop-types\n  selectedSubscription: PropTypes.object,\n}\n\nexport default CartCheckoutSubscriptionSelect\n","import React, { useEffect } from 'react'\nimport PropTypes from 'prop-types'\n\nimport { config as configService, auth as authService } from '@instacart/enterprise-services'\nimport { useLoading, useSubscriptions } from './hooks'\n\nimport CartCheckoutSubscriptionSelectDummy from './CartCheckoutSubscriptionSelect'\n\nconst CartCheckoutSubscriptionSelectSmart = props => {\n  // Subscribe to the services we need\n  const config = configService.selectors.getConfig()\n  const loadingService = useLoading()\n  const subscriptionsService = useSubscriptions()\n\n  // Destructure some objects for ease of use\n  const { isLoaded } = loadingService.selectors\n  const { GET_STORE_SUBSCRIPTIONS } = subscriptionsService.constants\n\n  const subscriptions = subscriptionsService.selectors.getStoreSubscriptions()\n  const userSubscription = authService.selectors.getUser()\n\n  // Check if we need to fetch data\n  useEffect(() => {\n    if (!isLoaded(GET_STORE_SUBSCRIPTIONS)) {\n      subscriptionsService.actions.getStoreSubscriptions()\n    }\n  }, [GET_STORE_SUBSCRIPTIONS, isLoaded, subscriptionsService.actions])\n\n  // TODO (deprecated after 2.26): this conditional statement isn't needed as we won't be passing in subscriptions or cartitems anymore\n  return props.subscriptions || props.cartItems ? (\n    <CartCheckoutSubscriptionSelectDummy {...props} />\n  ) : (\n    <CartCheckoutSubscriptionSelectDummy\n      {...props}\n      subscriptions={subscriptions}\n      config={config.subscriptions}\n      userSubscription={userSubscription?.subscription}\n      i18n={config.lang.subscriptions.cartCheckout}\n    />\n  )\n}\n\n// TODO (deprecated after 2.26): Not needed as we won't be using the cart to buy subscriptions anymore\nCartCheckoutSubscriptionSelectSmart.propTypes = {\n  /** Array of subscriptions to pick from */\n  // eslint-disable-next-line react/forbid-prop-types\n  subscriptions: PropTypes.array,\n  /** Array of items currently in the cart */\n  // eslint-disable-next-line react/forbid-prop-types\n  cartItems: PropTypes.array,\n}\n\nexport default CartCheckoutSubscriptionSelectSmart\n","import React, { useEffect } from 'react'\nimport { config as configService } from '@instacart/enterprise-services'\nimport { useLoading, useSubscriptions } from './hooks'\nimport SubscriptionCheckout from './SubscriptionCheckout'\n\nexport { default as CartCheckoutSubscriptionSelect } from './CartCheckoutSubscriptionSelectSmart'\nexport { SUBSCRIPTION_STEPS } from './SubscriptionCheckout'\nexport { SUBSCRIPTION_PATHS } from './constants'\n\nexport default props => {\n  // Subscribe to the services we need\n  const config = configService.selectors.getConfig()\n  const loadingService = useLoading()\n  const subscriptionsService = useSubscriptions()\n\n  // Destructure some objects for ease of use\n  const { isLoaded } = loadingService.selectors\n  const { GET_STORE_SUBSCRIPTIONS } = subscriptionsService.constants\n\n  // Check if we need to fetch data\n  useEffect(() => {\n    if (!isLoaded(GET_STORE_SUBSCRIPTIONS)) {\n      subscriptionsService.actions.getStoreSubscriptions()\n    }\n  }, [GET_STORE_SUBSCRIPTIONS, isLoaded, subscriptionsService.actions])\n\n  return (\n    <SubscriptionCheckout\n      {...props}\n      services={{ loadingService, subscriptionsService }}\n      config={config}\n      i18n={config.lang.subscriptions}\n    />\n  )\n}\n","module.exports = \"<div> <ul class=categories-menu ng-class=\\\"{ simpleFadeIn: $ctrl.categories.length > 0 }\\\"> <li ng-repeat=\\\"link in categoriesMenuAdditionalLinks.prependedLinks\\\" class=category> <a ng-href=\\\"{{ ::link.href }}\\\" analytics-click=\\\"['nav category prepended link', 'click', $index]\\\" ng-attr-aria-current=\\\"{{$ctrl.util.isLinkCurrentPageByUrl($ctrl.window, link.href) ? 'page' : undefined }}\\\" ng-class=\\\"{ active: $ctrl.util.isLinkCurrentPageByUrl($ctrl.window, link.href) }\\\" data-test=prepended-link> {{ ::link.text }} </a> </li> <li uib-dropdown class=category ng-if=\\\"($ctrl.featuredMenu.length > 0 || $ctrl.merchandisedLandingPages.length > 0) && enableFeaturedDropdownMenu\\\" is-open=isFeaturedMenuOpen on-toggle=toggled(open)> <a href id=featured-dropdown-toggle aria-controls=featured-dropdown-list uib-dropdown-toggle role=button> {{::lang.values.featuredMenuLabel}} <span aria-hidden=true ng-class=\\\"{'icon-after-caret-up': isFeaturedMenuOpen, 'icon-after-caret-down': !isFeaturedMenuOpen}\\\"></span> </a> <ul class=dropdown-menu uib-dropdown-menu aria-labelledby=simple-dropdown id=featured-dropdown-list> <li ng-repeat=\\\"item in $ctrl.merchandisedLandingPages\\\" class=featured-dep-item> <a ui-sref=\\\"main.shop.mlp({ mlp_id: item.id, mlp_slug: (item.text | slugify) })\\\" analytics-click=\\\"['nav category merchandised landing page', 'click', $index]\\\"> {{ item.text }} </a> </li> </ul> </li> <li ng-repeat=\\\"category in $ctrl.categories\\\" ng-if=$ctrl.isNonEComLightCategory(category) class=category> <a href=\\\"{{webUrl + '/shop/categories/' + category.id}}\\\" target=_blank ng-class=\\\"{ active: $ctrl.isActiveCategory(category.id) }\\\" id=\\\"nav-main-shop-category-{{ category.id }}\\\" analytics-click=\\\"['nav category link', 'click', $index, category.id]\\\" ng-attr-aria-current=\\\"{{$ctrl.isActiveCategory(category.id) ? 'page' : undefined}}\\\" data-test=\\\"{{'category-link-' + category.id}}\\\"> {{ category.text }} </a> </li> <li ng-repeat=\\\"link in categoriesMenuAdditionalLinks.appendedLinks\\\" class=category> <a ng-href=\\\"{{ ::link.href }}\\\" analytics-click=\\\"['nav category appended link', 'click', $index]\\\" data-test=appended-link> {{ ::link.text }} </a> </li> </ul> </div> \";","module.exports = \"<div filters-bar-resize-hide> <div sticky class=filters ng-class=\\\"::{ 'ecom-light-mode': inEComLightMode }\\\" offset=\\\"{{ ::stickyOffset }}\\\" min-width=1250> <div class=filters-wrapper> <div class=toggles> <div class=\\\"tag more\\\" ng-if=extraFilters.length uib-dropdown auto-close=outsideClick> <div class=faceted-filters-dropdown uib-dropdown-toggle sanitize-uib=\\\"['aria-haspopup', 'aria-expanded']\\\"> <span aria-hidden=true class=icon-filter></span> <span>{{$root.lang.values.moreFilters}}</span> <span aria-hidden=true class=dropdown-chevron></span> </div> <div class=\\\"dropdown-menu bottom-center\\\" uib-dropdown-menu> <ul> <li ng-repeat=\\\"tag in extraFilters | reverse track by tag.id\\\" class=\\\"tag {{tag.id}}\\\" analytics-click=\\\"['tag filter ' + tag.name, 'click']\\\" data-test=\\\"filter {{::tag.id}}\\\"> <div class=react-checkbox> <react-checkbox analytics-click=\\\"['tag filter ' + tag.name, 'click']\\\" aria-checked=tags[tag.id] checked=tags[tag.id] label-text=tag.name size=\\\"'small'\\\" on-change=onCheckboxChange ng-attr-id=tag.id icon=tag.iconClass styles=tag.styles></react-checkbox> </div> </li> </ul> </div> </div> <div data-tag-name={{::tag.id}} ng-repeat=\\\"tag in ::fixedTags\\\" class=\\\"tag {{::tag.id}}\\\" tab-enter analytics-click=\\\"['tag filter ' + tag.name, 'click']\\\" data-test=\\\"filter {{::tag.id}}\\\"> <div class=react-checkbox> <react-checkbox analytics-click=\\\"['tag filter ' + tag.name, 'click']\\\" aria-checked=tags[tag.id] checked=tags[tag.id] label-text=tag.name size=\\\"'small'\\\" on-change=onCheckboxChange ng-attr-id=tag.id icon=tag.iconClass styles=tag.styles></react-checkbox> </div> </div> </div> <div class=\\\"filter-dropdowns faceted-sort-dropdown\\\"> <span class=screenreadertext>{{ ::lang.facetedFilterScreenReaderText }}</span> <div ng-if=showSort class=sort analytics-click=\\\"['sort dropdown', 'click']\\\"> <div class=\\\"select small\\\"> <label for=sort-{{sort.name}} aria-label=\\\"{{::$root.lang.aria.sort}} {{sort.name}} and reload page\\\">{{$root.lang.values.sort}} {{sort.name}}</label> <select ng-model=sort name=sort-{{::sort.name}} ng-change=sortChange(sort) aria-label=\\\"{{::$root.lang.aria.sort}} {{sort.name}} and reload page\\\" ng-options=\\\"option as option.name for option in sortOptions track by option.value\\\"></select> <div class=selected><span class=icon-tag-more aria-hidden=true></span>{{sort.name ? '' : $root.lang.values.sort}} {{sort.name}}</div> </div> </div> <div ng-if=brands.length class=brands analytics-click=\\\"['brands dropdown', 'click']\\\"> <div class=\\\"select small\\\"> <label for=brand-sort-{{::brand.name}} aria-label=\\\"{{::$root.lang.aria.chooseBrand}} {{brand.name}}\\\">{{::$root.lang.aria.chooseBrand}} {{brand.name}}</label> <select ng-model=brand name=brand-sort-{{::brand.name}} ng-change=\\\"state.go('.', {brand_name: brand.value, page: 1})\\\" aria-label={{::$root.lang.aria.chooseBrand}} ng-options=\\\"option.name for option in mappedBrands track by option.value\\\"></select> <div class=\\\"selected selected--align-center\\\"><span>{{::brand.name}}</span></div> </div> </div> </div> </div> </div> </div> \";","module.exports = \"<div class=\\\"catalog products view\\\"> <div class=shop-layout> <div ui-view=desktopMenu class=\\\"menu-wrapper sidenav-wrapper\\\"></div> <div ui-view=content class=content-wrapper></div> </div> </div>\";","module.exports = \"<div id=authorize-net-integration ng-controller=AuthorizeNetIntegrationController ng-show=auth_token scroll-into-view> <h2 class=\\\"section-divider-small section-divider-small--align-left unata-payment-action\\\"> <span class=title>{{::lang.values.selectACard}}</span> </h2> <span class=\\\"unata-payment-ct unata-payment-list\\\"> <div class=\\\"row condensed\\\" ng-repeat=\\\"card in paymentInstruments\\\" ng-class=\\\"{'unata-selected-card': $parent.paymentInstrumentId === card.ext_id}\\\"> <input type=radio ng-model=$parent.paymentInstrumentId value={{card.ext_id}} id=payment-instrument-{{card.ext_id}} name=paymentInstrumentId class=radio ng-class=\\\"{'credit-card-list-selected-card': $parent.paymentInstrumentId === card.ext_id}\\\"/> <label for=payment-instrument-{{card.ext_id}} class=unata-payment-option> {{::lang.template(lang.values.cardEnding, {cardNumber: card.last_four_digits})}} </label> <button class=unata-payment-action ng-click=authCaptureEditCard(card)>{{::lang.values.edit}}</button> </div> </span> <button class=\\\"button action add-card unata-payment-action\\\" ng-click=authCaptureAddCard()>{{::lang.values.addCard}}</button> <div class=unata-payment-action> <form method=post id=formAuthorizeNet name=formAuthorizeNet target=iframeAuthorizeNet style=display:none> <input type=hidden name=Token value={{auth_token}} /> <input type=hidden name=PaymentProfileId value=\\\"\\\"/> </form> <iframe name=iframeAuthorizeNet id=iframeAuthorizeNet frameborder=0 scrolling=no width=0px height=0px></iframe> </div> </div> \";","module.exports = \"<div ng-style=\\\"{ visibility: isDropdownVisible }\\\"> <div class=\\\"dropdown-menu configurable stick-to-bottom\\\"> <div ng-if=!$parent.showAllOptions> <div class=single-configuration ng-repeat=\\\"configuration in existingConfig\\\" ng-init=\\\"option = configuration.product_config.options[0].base || configuration.product_config.options[0].item\\\"> <span class=single-configuration-label>{{::option.name}}</span> <div add-to-cart product=product configuration=option is-dropdown=true></div> </div> <div role=button ng-if=\\\"existingConfig.length >= 1\\\" class=\\\"add-another icon-fixed-right icon-after-plus\\\" ng-click=linkToProductDetails(product.id)> Add Another </div> </div> <div ng-if=$parent.showAllOptions> <div class=single-configuration ng-repeat=\\\"configuration in product.product_config.options[0].items\\\"> <span class=single-configuration-label>{{::configuration.name}}</span> <div add-to-cart product=product configuration=configuration is-dropdown=true></div> </div> </div> </div> <div role=button ng-if=\\\"existingConfig.length >= 1\\\" ng-click=togglePopover(); class=menu-backdrop></div> </div> \";","export const USER_STATUSES = {\n  TRIAL: 'trial',\n  COMPLETE: 'complete',\n}\n","module.exports = \"<div class=\\\"unata-payment-action paypal-checkout-notice\\\"> {{::lang.values.paypalCheckoutNotice}} </div> \";","module.exports = \"<div class=shopping-context ng-controller=ContextSelectorController> <div class=shopping-context-image-container ng-if=::!mobile.isMobile></div> <div class=shopping-context-container ng-class=\\\"{'modal-transition': modalTransition, 'context-list-grid': visibleShopContextIntents.length > 3}\\\"> <div class=\\\"shopping-context-title clearfix\\\"> <h2 ng-class=\\\"{'modal-transition': modalTransition}\\\" ng-if=auth.user.first_name> {{::lang.template(config.shoppingSelector.main.title.loggedIn, {clientName: lang.values.clientName, userName: auth.user.first_name})}} </h2> <h2 aria-hidden=true ng-class=\\\"{'modal-transition': modalTransition}\\\" ng-if=!auth.user.first_name> {{::config.shoppingSelector.main.title.loggedOut}} </h2> <h1 class=screenreadertext ng-if=!auth.user.first_name> {{::config.shoppingSelector.main.title.loggedOut}} </h1> <p ng-class=\\\"{'modal-transition': modalTransition}\\\"> {{::config.shoppingSelector.main.content}} </p> <span auto-focus=true ng-hide=::mobile.isMobile class=screen-reader-text>Choose a new shopping mode. Press the escape key to exit.</span> </div> <span class=\\\"ul-el clearfix shopping-context-list\\\"> <shopping-context-item ng-repeat=\\\"ctx in shopContextIntents | orderBy:'displayOrder'\\\" ng-if=ctx.visible ctx-name=ctx.name class-icons=ctx.classIcons is-active=ctx.isActive show-transition=modalTransition ng-click=shoppingContextSubmit(ctx.name) /> </span> </div> </div> \";","module.exports = \"<div class=\\\"search products view\\\"> <div page-header class=page-header-search initial-search-term=initialSearchTerm is-spell-corrected=isSpellCorrected() label=getPageHeaderResults() previous-page=true search-reformulation-text=getSearchReformulationText() search-spell-correction-disabled-sref=getSearchSpellCorrectionDisabledSref() loading=loadingResults selected-filters=\\\"tagsService.getSelectedFilters(tags, brands)\\\"></div> <div class=shop-layout> <div class=sidenav-wrapper ng-if=\\\"!mobile.isMobile && !inEComLightMode\\\" ng-class=\\\"{'hide-sidenav': hideSideNav && enableDotComSearch, 'menu-wrapper': enableDotComSearch, 'menu-wrapper-dot-com': !enableDotComSearch}\\\"> <nav class=\\\"menu sidenav\\\" ng-class=\\\"{ 'no-border': enableFacetedSearchFilters }\\\" aria-label={{::lang.values.filters}}> <ul ng-if=::!enableFacetedSearchFilters> <li class=\\\"sidenav-item parent\\\" ng-class=\\\"{active: !categoryId}\\\"> <a ng-click=filterCategory() analytics-click=\\\"['search menu top link', 'click']\\\">{{::lang.values.searchResults}}</a> <ul> <li ng-repeat=\\\"searchCat in searchCategories\\\" class=\\\"sidenav-item child\\\" ng-class=\\\"{active: categoryId == searchCat.category.id}\\\"> <a ng-click=filterCategory(searchCat.category.id) analytics-click=\\\"['search menu ' + searchCat.category.name + ' link', 'click']\\\">{{searchCat.category.name}} ({{searchCat.count}}) </a> </li> </ul> </li> </ul> <span class=faceted-search-sidenav ng-if=::enableFacetedSearchFilters> <h2 ng-if=rootCategoryFacets.length class=sidenav-header> {{::lang.values.departments}} <button type=button class=see-all ng-click=resetFacets() ng-if=shouldShowSeeAll() data-test=departments-see-all>{{::lang.values.seeAll}}</button> </h2> <faceted-search-categories search-context=searchContext categories=rootCategoryFacets on-category-click=filterCategory(id) selected-category=categoryId> </faceted-search-categories> <span ng-if=!hideFacets> <h2 class=sidenav-header data-test=facet-side-filters-header> {{::lang.values.filters}} <button type=button class=see-all ng-click=resetFacets() ng-if=shouldShowReset()>{{::lang.values.reset}}</button> </h2> <faceted-side-filters role=region aria-label=\\\"{{ ::lang.values.filters }}\\\" faceted-side-filters=sideFacetsArray> </faceted-side-filters> </span> </span> </nav> </div> <div class=content-wrapper> <div ng-if=\\\"'main.search' | isState\\\" ng-include=\\\"'searchProducts.html'\\\"></div> <div ng-if=\\\"'main.search.recipes' | isState\\\" ng-include=\\\"'searchRecipes.html'\\\"></div> <div ng-if=\\\"'main.search.types' | isState\\\" ng-include=\\\"'searchPosts.html'\\\"></div> </div> </div> </div> \";","module.exports = \"<div class=ic-express-profile ng-style=\\\"{'background-image': 'url(' + $ctrl.imageURL + ')'}\\\"> <div ng-bind-html=$ctrl.text class=ic-express-profile__text ng-class=\\\"{ 'ic-express-profile__text--ic': $ctrl.useIcTheme }\\\"></div> </div>\";","module.exports = \"<div ng-class=\\\"{'checkout-width-override': isCondensed, 'timeslots-extra-padding': !willBeFulfilledByInstacart}\\\"> <react-time-slots time-slots=timeslots on-time-slot-selected=(onTimeSlotSelected) selected-time-slot=selectedTimeSlotV2 i18n=reactTimeSlotsI18n error=error read-only=!timeslotsAreSelectable on-day-selected=(onDaySelected) on-week-changed=(onWeekChanged) always-show-availability-checkbox=showAvailableTimeslotsOnlyCheckbox availability-checkbox-threshold=availabilityCheckboxThreshold is-loading=loading on-go-to-cart=(onGoToCart) has-rx-item=hasRxItem></react-time-slots> </div> \";","module.exports = \"<div class=\\\"modal-container loyalty-onboarding-container\\\" ng-class=\\\"{ 'registration--improved': config.enableImprovedRegistration }\\\" data-test=loyalty-onboarding-modal> <div class=\\\"modal-header modal-header-collapse-desktop modal-mobile-header-brand\\\"> <img src=\" + require(\"assets/images/footer-logo.svg\") + \" alt=\\\"Brand Logo\\\" class=modal-mobile-header-brand-logo tabindex=0 /> <button id=loyalty-onboarding-dismiss class=close ng-click=$dismiss(loyaltyOnboardingStep) aria-label={{::lang.aria.close}} data-test=loyalty-onboarding-modal-close-button> <span class=icon-delete aria-hidden=true></span> </button> </div> <div class=modal-content> <div ng-if=\\\"loyaltyOnboardingStep === LOYALTY_ONBOARDING_STEPS.INTRO\\\" class=loyalty-onboarding-intro> <div class=header-text> <h1 class=header-title>{{::config.loyaltyOnboarding.intro.headerText}}</h1> </div> <div class=hero-image> <img ng-if=\\\"::!mobile.isMobile && config.loyaltyOnboarding.intro.heroImageUrl\\\" ng-src={{::utilService.loadAssetImage(config.loyaltyOnboarding.intro.heroImageUrl)}} alt=\\\"\\\"/> <img ng-if=\\\"::mobile.isMobile && config.loyaltyOnboarding.intro.mobileHeroImageUrl\\\" ng-src={{::utilService.loadAssetImage(config.loyaltyOnboarding.intro.mobileHeroImageUrl)}} alt=\\\"\\\"/> </div> <div class=description> <span ng-bind-html=::config.loyaltyOnboarding.intro.descriptionText></span> </div> <button id=loyalty-onboarding-intro-register class=\\\"button call-to-action loyalty-onboarding-call-to-action\\\" ng-click=setLoyaltyOnboardingStep(LOYALTY_ONBOARDING_STEPS.REGISTER) data-test=loyalty-onboarding-cta-button> {{::config.loyaltyOnboarding.intro.callToActionText}} </button> <div class=question-text> <span>{{::lang.values.alreadyHaveAnAccount}}</span> <button ng-click=setLoyaltyOnboardingStep(LOYALTY_ONBOARDING_STEPS.LOGIN) id=loyalty-onboarding-intro-login class=question-link> {{::lang.values.signIn}} </button> </div> </div> <div ng-if=\\\"loyaltyOnboardingStep === LOYALTY_ONBOARDING_STEPS.REGISTER\\\" class=loyalty-onboarding-form> <div ng-if=\\\"::!mobile.isMobile && config.loyaltyOnboarding.form.bannerImageUrl\\\" class=form-banner> <img ng-src={{::utilService.loadAssetImage(config.loyaltyOnboarding.form.bannerImageUrl)}} alt={{::lang.aria.loyaltyOnboardingBannerAlt}} /> </div> <div class=form-header ng-if=!socialSignOnData> <h1 class=header-title>{{::config.loyaltyOnboarding.form.headerText}}</h1> <div class=question-text> {{::lang.values.alreadyHaveAnAccount}} <button ng-click=setLoyaltyOnboardingStep(LOYALTY_ONBOARDING_STEPS.LOGIN) class=question-link> {{::lang.values.signIn}} </button> </div> <p class=question-text ng-if=::config.createYourSecureAccount ng-bind-html=::config.createYourSecureAccount /> </div> <div class=form-header ng-if=\\\"socialSignOnData.action === 'registration'\\\"> <h1 class=header-title>{{::config.socialSignOn.registration.headerText}}</h1> <p class=question-text> {{::config.socialSignOn.registration.descriptionText}}<br/> {{::config.socialSignOn.registration.linkText}} <button class=question-link ng-click=goToSocialLinkFlow()> {{::config.socialSignOn.registration.linkCTA}}</button>. </p> </div> <div class=form-container ng-if=!config.enableImprovedRegistration> <div ng-if=\\\"context === 'loyaltyOnboarding'\\\" register-form lazy-loading trigger=loyaltyOnboarding context=loyaltyRegister social-sign-on-data=socialSignOnData on-register=onRegister()></div> <div ng-if=\\\"context !== 'loyaltyOnboarding'\\\" register-form lazy-loading context=loyaltyRegister social-sign-on-data=socialSignOnData on-register=onRegister()></div> </div> <div class=form-container ng-if=config.enableImprovedRegistration> <div ng-if=\\\"context === 'loyaltyOnboarding'\\\" register-form-improved lazy-loading trigger=loyaltyOnboarding context=loyaltyRegister social-sign-on-data=socialSignOnData on-register=onRegister()></div> <div ng-if=\\\"context !== 'loyaltyOnboarding'\\\" register-form-improved lazy-loading context=loyaltyRegister social-sign-on-data=socialSignOnData on-register=onRegister()></div> </div> </div> <div ng-if=\\\"loyaltyOnboardingStep === LOYALTY_ONBOARDING_STEPS.THANKYOU\\\" class=loyalty-onboarding-thank-you> <div class=thank-card> <img ng-if=\\\"::!mobile.isMobile && config.loyaltyOnboarding.thankYou.cardImageUrl\\\" ng-src={{::utilService.loadAssetImage(config.loyaltyOnboarding.thankYou.cardImageUrl)}} alt={{::lang.values.loyaltyPricing.desciptionNoDate}} /> <img ng-if=\\\"::mobile.isMobile && config.loyaltyOnboarding.thankYou.mobileCardImageUrl\\\" ng-src={{::utilService.loadAssetImage(config.loyaltyOnboarding.thankYou.mobileCardImageUrl)}} alt={{::lang.values.loyaltyPricing.desciptionNoDate}} /> </div> <div class=thank-header> <h1 class=header-title>{{::config.loyaltyOnboarding.thankYou.headerText}}</h1> </div> <div class=thank-description> <span ng-bind-html=::config.loyaltyOnboarding.thankYou.description></span> </div> <div class=thank-call-to-action-box> <button ng-if=::config.loyaltyOnboarding.thankYou.callToActionOne class=\\\"button call-to-action loyalty-onboarding-call-to-action\\\" ng-click=doCallToAction(config.loyaltyOnboarding.thankYou.callToActionOne)> {{::config.loyaltyOnboarding.thankYou.callToActionOne.text}} </button> <button ng-if=::config.loyaltyOnboarding.thankYou.callToActionTwo class=\\\"button call-to-action loyalty-onboarding-call-to-action hollow\\\" ng-click=doCallToAction(config.loyaltyOnboarding.thankYou.callToActionTwo)> {{::config.loyaltyOnboarding.thankYou.callToActionTwo.text}} </button> </div> <div ng-if=\\\"::!mobile.isMobileApp() && (config.appStoreLinks.android || config.appStoreLinks.ios)\\\" class=thank-app-download-box> <div class=thank-app-text>{{::config.loyaltyOnboarding.thankYou.appDownloadText}}</div> <div ng-if=::config.appStoreLinks.ios class=thank-ios-icon> <a ng-click=\\\"goToStore(config.appStoreLinks.ios, 'ios')\\\"> <img ng-src=\" + require(\"static/images/app-store-icon.svg\") + \" alt={{::lang.aria.appStore}} /> </a> </div> <div ng-if=::config.appStoreLinks.android class=thank-android-icon> <a ng-click=\\\"goToStore(config.appStoreLinks.android, 'android')\\\"> <img ng-src=\" + require(\"static/images/play-store-icon.svg\") + \" alt={{::lang.aria.playStore}} /> </a> </div> </div> </div> <div ng-if=\\\"loyaltyOnboardingStep === LOYALTY_ONBOARDING_STEPS.LOGIN\\\" class=loyalty-onboarding-login> <div ng-if=\\\"::!mobile.isMobile && config.loyaltyOnboarding.login.bannerImageUrl\\\" class=login-banner> <img ng-src={{::utilService.loadAssetImage(config.loyaltyOnboarding.login.bannerImageUrl)}} alt=\\\"{{::config.loyaltyOnboarding.login.alt || lang.values.logIn}}\\\"/> </div> <ic-express-signin ng-if=\\\"::mobile.isMobile && express.isPlacementConfigEnabled(IC_PLACEMENTS.SIGNIN)\\\" enable-retailer-theme=config.icExpress.enableRetailerTheme></ic-express-signin> <div class=login-container> <div class=login-header> <h1 class=header-title>{{::lang.values.logIn}}</h1> <div class=question-text ng-if=\\\":: !hideRegistration\\\"> {{::lang.values.dontHaveAnAccount}} <button ng-click=setLoyaltyOnboardingStep(LOYALTY_ONBOARDING_STEPS.REGISTER) class=question-link data-test=loyalty-onboarding-signup-button> {{::lang.values.signUp}} </button> </div> </div> <shared-login lazy-loading error-message=errorMessage display-reset-password-link=::mobile.isMobile password-reset-fn=setLoyaltyOnboardingStep(LOYALTY_ONBOARDING_STEPS.FORGOT) close-modal=$close(loyaltyOnboardingStep) context=context></shared-login> </div> <div class=loyalty-footer ng-if=::!mobile.isMobile> <forgot-password-button set-view-fn=setLoyaltyOnboardingStep(LOYALTY_ONBOARDING_STEPS.FORGOT)></forgot-password-button> </div> <ic-express-signin ng-if=\\\"::!mobile.isMobile && express.isPlacementConfigEnabled(IC_PLACEMENTS.SIGNIN)\\\" enable-retailer-theme=config.icExpress.enableRetailerTheme></ic-express-signin> </div> <div ng-if=\\\"loyaltyOnboardingStep === LOYALTY_ONBOARDING_STEPS.FORGOT\\\" class=loyalty-onboarding-forgot-password> <div ng-if=\\\"::!mobile.isMobile && config.loyaltyOnboarding.forgotPassword.bannerImageUrl\\\" class=forgot-password-banner> <img ng-src={{::utilService.loadAssetImage(config.loyaltyOnboarding.forgotPassword.bannerImageUrl)}} alt={{::lang.values.forgotPassword}} /> </div> <div class=forgot-password-container> <div class=forgot-password-header> <h1 class=header-title>{{::lang.values.forgotPassword}}</h1> <div class=question-text> {{::lang.values.emailPasswordReset}} </div> </div> <div shared-forgot-password context=loyaltyForgotPassword></div> </div> <div class=loyalty-footer> <button ng-click=setLoyaltyOnboardingStep(LOYALTY_ONBOARDING_STEPS.LOGIN) class=loyalty-footer-link> {{::lang.values.backToLogin}} </button> </div> </div> </div> </div> \";","module.exports = \"<div class=\\\"shopping-context-selection-content delivery-addresses\\\" ng-controller=StoreSelectorListController> <div> <form ng-submit=fetchStores($event) class=\\\"clearfix address-form\\\" ng-if=\\\"$parent.shopContextIntent === 'delivery'\\\"> <div class=\\\"field postal\\\"> <label for=shopping-selector-postal-code>{{::addressInputLabel | capitalize}}</label> <div class=\\\"postal-input-container error-shake icon-left\\\"> <span class=\\\"icon-left icon-center icon-pin\\\" aria-hidden=true></span> <input ng-if=::!requireFullAddress ng-change=addressInputChangedCallback() auto-focus=!showMultipleDeliveryAddresses ng-model=delivery.postalCode type=text class=input placeholder=\\\"{{::addressInputLabel | capitalize}}\\\" aria-label=\\\"{{::lang.aria.enter + ' ' + lang.aria.postalCode}}\\\" id=shopping-selector-postal-code pattern={{::config.postalCodePattern}} aria-describedby=selection-error-msg aria-invalid=\\\"{{ isThereAnError() }}\\\"/> <address-autocomplete-input ng-if=::requireFullAddress input-auto-focus=\\\"auth.user.status === 'trial'\\\" input-id=shopping-selector-postal-code input-class=input input-name=delivery-address input-placeholder=\\\"::addressInputLabel | capitalize\\\" input-changed-callback=addressInputChangedCallback address-chosen-callback=addressChosenCallback has-error=isThereAnError() set-auto-complete-option-selected=setAutoCompleteOptionSelected> </address-autocomplete-input> <span id=selection-error-msg class=required-field ng-if=isThereAnError() ng-bind-html=getErrorMessage()></span> </div> </div> <div class=button-container> <button type=submit id=shopping-selector-list-dismiss class=button ng-class=\\\"{'loading': loading}\\\" ng-if=::!mobile.isMobile data-test=shopping-selector-list-submit> <span ng-if=::config.shoppingContextProcess.delivery.hideTimeslot>{{::lang.values.startShoppingDelivery}}</span><span ng-hide=::config.shoppingContextProcess.delivery.hideTimeslot>{{::lang.values.next}}</span> </button> </div> <button type=submit id=shopping-selector-fetch-stores class=\\\"button mobile-bottom fadeIn\\\" ng-class=\\\"{'loading': loading}\\\" ng-if=::mobile.isMobile data-test=shopping-selector-list-submit> {{::lang.values.submit}} </button> </form> <div class=stores-wrapper> <div class=\\\"stores list\\\" ng-if=stores> <div ng-if=\\\"::mobile.isMobile && $parent.shopContextIntent !== 'delivery'\\\" ng-include=\\\"'storeSelectorListStores.mobile.html'\\\"></div> <div ng-if=\\\"::!mobile.isMobile && $parent.shopContextIntent !== 'delivery'\\\" ng-include=\\\"'storeSelectorListStores.desktop.html'\\\"></div> </div> </div> </div> <div ng-if=\\\"showMultipleDeliveryAddresses && addressList.hasAddressItems()\\\" class=\\\"address-list-container clearfix\\\"> <address-list class=address-list selectable-addresses=button select-address-callback=addressListChosenCallback(address) optional-fields=\\\"[\\n          ADDRESS_FIELDS.FIRST_NAME,\\n          ADDRESS_FIELDS.LAST_NAME,\\n          ADDRESS_FIELDS.PHONE_NUMBER\\n        ]\\\" validate-address=::config.enableExternalAddressValidation text-header=::lang.values.chooseFromAddressBook show-idle-message=::config.enableShowIdleMessage hide-address-form-on-load=true></address-list> </div> </div> \";","module.exports = \"<div class=react-checkbox> <react-checkbox checked=checked ng-attr-id=createId label-text=label on-change=onCheckboxChange class-name=className icon=iconClass size=\\\"'small'\\\" styles=styles /> </div> \";","module.exports = \" <div> <a ng-if=match.model.isRedirect href=# tabindex=-1 ng-click=$event.preventDefault() ng-attr-title=\\\"{{ match.label }}{{ match.model.redirectCategory ? (' - ' + match.model.redirectCategory) : '' }}\\\"> <span ng-bind-html=\\\"match.label | uibTypeaheadHighlight:query\\\"></span> <span class=search-results-menu-redirect-category ng-class=\\\"{ 'icon-after-external-link': match.model.redirectIsExternal }\\\"> {{ match.model.redirectCategory }} </span> </a> <a ng-if=!match.model.isRedirect href=# tabindex=-1 ng-click=$event.preventDefault() ng-bind-html=\\\"match.label | uibTypeaheadHighlight:query\\\" ng-attr-title=\\\"{{ match.label }}\\\" data-test=suggested-term></a> </div> \";","module.exports = \"<div class=purchase> <div class=content-header> <h3>{{::lang.template(lang.values.purchaseNumber, {id: purchase.id})}}</h3> </div> <div class=\\\"content-section items\\\"> <h2 class=section-divider-small> <span class=title>{{::lang.values.itemsOrdered}}</span> </h2> <table ng-if=purchase.items.length class=table> <thead> <tr> <td colspan=\\\"{{::(mobile.isMobile ? 3 : 1)}}\\\"> <input class=checkbox type=checkbox ng-change=\\\"selectAll(); analytics.logEvent('account purchase select all checkbox', 'click')\\\" ng-model=$parent.noneSelected id=purchaseSelectAll> <label for=purchaseSelectAll>{{::(mobile.isMobile ? lang.values.selectAll : '' )}}</label> </td> <td ng-if=\\\":: !mobile.isMobile\\\" colspan=2>{{::lang.values.name}}</td> <td ng-if=\\\":: !mobile.isMobile\\\">{{::lang.values.quantity}}</td> <td ng-if=\\\":: !mobile.isMobile\\\">{{::lang.values.pricePaid}}</td> </tr> </thead> <tbody ng-repeat=\\\"(category, items) in categorizedProducts\\\" ng-init=\\\"categoryIndex = $index\\\"> <tr class=category> <td colspan=\\\"{{::(mobile.isMobile ? 3 : 5)}}\\\">{{category}}</td> </tr> <tr ng-repeat-start=\\\"item in items\\\" ng-disabled=!item.store_product.status> <td class=action> <input class=checkbox type=checkbox ng-disabled=!item.store_product.status ng-change=\\\"selectItem(item); analytics.logEvent('account purchase product checkbox', 'click')\\\" ng-model=selectedMap[item.store_product.id] id=purchaseItem{{categoryIndex}}-{{$index}}> <label for=purchaseItem{{categoryIndex}}-{{$index}}> </label></td> <td role=button ng-click=\\\"!isProductDetailsModalDisabled(item) && productDetailsModal.open(item.store_product.id, { location: config.analyticsSourceKeys.orderHistory })\\\" class=\\\"action internal-link\\\"> <div class=item-image ng-attr-style=\\\"background-image: url('{{::imageURLService.getProductImageURL(item.store_product, 'small')}}')\\\"></div> </td> <td role=button class=internal-link ng-click=\\\"!isProductDetailsModalDisabled(item) && productDetailsModal.open(item.store_product.id, { location: config.analyticsSourceKeys.orderHistory })\\\"> <div class=item-name>{{item.store_product.name}}</div> </td> <td ng-if=\\\":: !mobile.isMobile\\\"> <div>{{item.quantity}}</div> </td> <td ng-if=\\\":: !mobile.isMobile\\\"> <div>{{item.sub_total | currency}}</div> </td> </tr> <tr ng-repeat-end ng-if=\\\":: mobile.isMobile\\\"> <td colspan=3> <div class=\\\"paid right\\\"><span class=label>{{::lang.values.paid}}</span>{{item.sub_total | currency}}</div> <div class=\\\"quantity left\\\"><span class=label>{{::lang.values.qty}}</span>{{item.quantity}}</div> </td> </tr> </tbody> </table>  <div class=item-actions ng-if=selectedItems.length> <add-to-list ng-if=\\\":: !config.disableSaveForLaterLists\\\" products=selectedItems></add-to-list> <button class=button ng-click=loadList(selectedItems) analytics-click=\\\"['account purchase add to cart button', 'click']\\\" send-analytics=!$root.modifyingOrder>{{::lang.values.addToCartButtonLabel}}</button> </div> <div class=content-section> <h2 class=section-divider-small> <span class=title>{{::lang.values.purchaseDetails}}</span> </h2> <div class=field> <label>{{::lang.values.store}}:</label> <div class=data>{{purchase.store_name || purchase.store.name}}</div> </div> <div class=field> <label>{{::lang.values.dateAndTime}}:</label> <div class=data>{{purchase.timestamp | apiDate:'MMM Do, YYYY [at] h:mma'}}</div> </div> <div class=field> <label>{{::lang.values.items}}:</label> <div class=data>{{purchase.items.length}}</div> </div> <div class=field> <label>{{::lang.values.total}}:</label> <div class=data>{{purchase.final_totals.total | currency}}</div> </div> </div> </div> </div>\";","module.exports = \" <div class=\\\"product-details__section product-details__border--bottom small-padding--top\\\"> <div ng-if=hasExtData class=\\\"ext_data hidden\\\"> <div ng-repeat=\\\"(key, value) in product.ext_data track by $index\\\" class=row ng-if=!excludedExtData.includes(key)> <div class=key ng-if=\\\"key !== 'CRV'\\\">{{key}}:</div> <div class=key ng-if=\\\"key === 'CRV'\\\">{{::lang.values.crvTitle}}:</div> <div class=value>{{value}}</div> </div> </div> <div> <div ng-if=showOfferRibbon() class=\\\"promo product-discount-ribbon\\\"> {{product.offer_title}} </div> <div ng-if=\\\"showOfferRibbon() && offer\\\" class=offer-info> <span ng-if=offer.offer.end_date>{{lang.template(lang.values.saleEndDate, {endDate: (offer.offer.end_date | date:'MMM D':config.apiDateFormat)})}}</span> <span ng-if=\\\"offer.offer.end_date && (offer.offer.limit_total || offer.offer.limit_customer || offer.offer.limit_basket)\\\"> - </span> {{offer.offer.limit_total ? lang.template(lang.values.limitPerTotal, {limit: offer.offer.limit_total}) : ''}} {{offer.offer.limit_customer ? lang.template(lang.values.limitPerCustomer, {limit: offer.offer.limit_customer}) : ''}} {{offer.offer.limit_basket ? lang.template(lang.values.limitPerBasket, {limit: offer.offer.limit_basket}) : ''}} </div> </div> <div ng-if=product.message_code> <div class=\\\"warning icon-warning\\\" ng-bind-html=\\\"product.message_code | linebreaks\\\"></div> </div> <div ng-if=\\\"!product.product_config || product.product_config.config_type !== 'custom' || product.product_config.has_pricing === false\\\" product-prices product=product loyalty-icon=false non-loyalty-suffix=::lang.values.regularPrice show-uom=true styles=priceStyles></div> <div ng-if=noticeAlert class=notice-alert> <alert ng-if=\\\"noticeAlert.type === 'OFFER_UNAVAILABLE'\\\" type=warn-light disable-border=true small-text=true> <strong>{{::lang.values.offerUnavailableCaption}}</strong><br/> {{::lang.template(lang.values.offerUnavailableMessage, {validFrom: noticeAlert.params.validFrom, validTo: noticeAlert.params.validTo})}} </alert> <alert ng-if=\\\"noticeAlert.type === 'OFFER_EXPIRED'\\\" type=warn-light disable-border=true small-text=true> <strong>{{::lang.values.offerExpiredCaption}}</strong><br/> {{::lang.template(lang.values.offerExpiredMessage, {validFrom: noticeAlert.params.validFrom, validTo: noticeAlert.params.validTo})}} </alert> </div> <div class=product-promo> <span ng-if=showEbtRibbon class=\\\"promo product-ebt-ribbon\\\"> {{ lang.values.ebt.EBT }} </span> <div ng-if=\\\"product.promo_tag && showPricingPromos\\\" class=promo ng-class=\\\"{'loyalty-required': hasLoyaltyPrice() && !hasLoyaltyCard(), 'loyalty-price': hasLoyaltyPrice() && hasLoyaltyCard()}\\\"> <span ng-if=!hasLoyaltyPrice()> {{product.promo_tag}} </span> <span ng-if=hasLoyaltyPrice()> {{hasLoyaltyCard() ? product.promo_tag : lang.values.loyaltyPricing.tag}} </span> </div> <div ng-if=\\\"hasSalePrice() && config.showSaleEndDate && showPricingPromos\\\" class=expires> {{lang.template(lang.values.saleEndDate, {endDate: (product.sale_end_date | apiDate:'MMM D')})}} </div> </div> <div ng-if=hasLoyaltyPrice() class=product-loyalty> <span class=\\\"icon-loyalty-badge loyalty-icon\\\" aria-hidden=true></span> <span ng-if=config.showSaleEndDate> {{lang.template(hasLoyaltyCard() ? lang.values.loyaltyPricing.description : lang.values.loyaltyPricing.descriptionNonMember, { date: (product.loyalty_end_date | apiDate:'MMM D') })}} </span> <span ng-if=!config.showSaleEndDate> {{hasLoyaltyCard() ? lang.values.loyaltyPricing.descriptionNoDate : lang.values.loyaltyPricing.descriptionNonMemberNoDate}} </span> </div> <react-pricing-disclosure ng-if=\\\"config.showPricingDisclaimerOnPdp && product.average_weight\\\" base-price=::product.base_price uom-price=::product.uom_price.price uom=::product.uom_price.uom average-weight=::product.average_weight></react-pricing-disclosure> <div ng-if=\\\"isProductAvailable || shopContextIntent === SHOPPING_MODES.INSTORE_LIST\\\"> <div class=product-action-buttons ng-if=\\\"!product.product_config || (product.product_config && product.product_config.options.length === 0)\\\"> <div class=add-to-buttons> <div add-to-cart product=product location={{location}} class=product-details is-modal=isModal react-styles=addToCartStyles use-react=true color=\\\"'highlight'\\\"></div> <div ng-if=maxInCart class=add-to-buttons__warning> <span class=\\\"icon-warning warning\\\" aria-hidden=true></span> {{lang.template(lang.values.limitPerOrder, { limit: maxInCart })}} </div> </div> </div> </div> <div ng-if=\\\"!isProductAvailable && shopContextIntent !== SHOPPING_MODES.INSTORE_LIST\\\"> <div class=out-of-stock> <i class=icon-warning></i> <div> <div class=out-of-stock-message>{{::lang.values.outOfStock}}</div> <div>{{::lang.values.outOfStockDescription}}</div> </div> </div> </div> </div> \";","module.exports = \"<div class=continuity-progress-bar> <button id=unata-loyalty-offer-start-button-{{::offer.id}} type=button name=button class=\\\"button small\\\" ng-if=\\\"offer.continuity.offer_activated === false || offer.offer.continuity.offer_activated === false\\\" require-registered-user if-registered=\\\"startContinuityOffer($event, offer)\\\">{{::config.continuityOffers.startOffer}}</button> <div ng-if=\\\"offer.continuity.offer_activated && continuityStampProgress\\\" class=continuity-progress-stamps> <div ng-repeat=\\\"x in continuityStampProgress\\\" class=\\\"progress-check icon-stamp-checkmark\\\" ng-class=\\\"{'complete': offer.continuity.rwd_offer_id}\\\"></div> <div ng-repeat=\\\"x in continuityStampProgressRemaining\\\" class=\\\"progress-stamp icon-stamp\\\"><span class=progress-count>{{x}}</span></div> </div> <div ng-if=\\\"offer.continuity.offer_activated && continuityCartProgressMax\\\" class=continuity-progress-cart> <div class=progress-bar aria-label={{label}}><div class=bar ng-attr-style=\\\"width: {{continuityProgressBarWidth}};\\\"></div></div> <span class=offer-text ng-if=\\\"offer.condition.type === 'cart' && offer.continuity.offer_activated\\\">${{offer.continuity.cdn_count}} of ${{continuityCartProgressMax}}</span> </div> </div> \";","module.exports = \"<div class=order-add-on ng-class=\\\"{ 'order-add-on-fixed': $ctrl.isOrderAddOnInline }\\\"> <div class=desktop-nav ng-if=\\\"::!$ctrl.mobile.isMobile && !$ctrl.isOrderAddOnInline\\\"> <div class=top-row> <div class=left> <a ui-sref=main.home analytics-click=\\\"['nav logo', 'click']\\\" id=nav-main-home-logo class=logo> <img src=\" + require(\"assets/images/header-logo.svg\") + \" alt={{::$ctrl.lang.values.clientName}}> </a> </div> </div> </div> <div ng-if=$ctrl.isLoading() class=\\\"loading order-add-on-loading\\\"> <div class=\\\"view-loading-indicator fill\\\"></div> </div> <div ng-if=!$ctrl.isLoading() class=order-add-on-wrapper> <div class=header ng-if=::!$ctrl.isOrderAddOnInline> <div class=order-add-on-info> <h1>{{::lang.values.orderAddOn.searchHeadline}} {{::lang.values.orderAddOn.order | capitalize}} #{{$ctrl.order.id}}</h1> <span>{{$ctrl.timeslotLabelFn()}}</span> </div> <div class=order-add-on-back ng-if=::!$ctrl.mobile.isMobile> <a ui-sref=\\\"main.account.orderHistory.order({id: $ctrl.order.id})\\\">{{::lang.values.orderAddOn.backToOrder}}</a> </div> </div> <div class=search-bar> <unata-search-nav set-searching-to=$ctrl.setSearchingTo(newValue) is-searching=$ctrl.search.loading lite-mode=true search-term=$ctrl.search.term focus-initially=true></unata-search-nav> </div> <div ng-if=\\\"\\n        !$ctrl.isOrderAddOnInline &&\\n          $ctrl.getResults().length === 0 &&\\n          !$ctrl.search.loading &&\\n          $ctrl.search.term.length === 0\\n      \\\" class=search-tooltip> {{::lang.values.orderAddOn.searchDisclaimer}} </div> <div class=search-results> <div class=search-info> <span ng-if=\\\"$ctrl.getResults() && $ctrl.search.term && !$ctrl.search.loading\\\"> {{$ctrl.getResults().item_count}} {{::lang.values.searchResults | lowercase}} {{::lang.values.for}} '{{$ctrl.search.term}}' </span> </div> <div ng-class=\\\"{ 'loading': $ctrl.search.loading }\\\"> <div class=\\\"view-loading-indicator fill\\\" ng-if=$ctrl.search.loading></div> </div> <div ng-if=\\\"$ctrl.search.results.length === 0 && $ctrl.search.term && !$ctrl.search.loading\\\" data-test=no-item-found> {{::$ctrl.lang.template($ctrl.lang.values.nothingFound, {searchResult: $ctrl.search.term.slice(0, 50)})}} </div> <div ng-if=\\\"$ctrl.getResults().length > 0\\\"> <div ng-if=!$ctrl.isAddOnFullProductCell ng-repeat=\\\"product in $ctrl.getResults() | limitTo: $ctrl.productsPerPage track by $index\\\" related-product product=product location=\\\"Cart Item Related\\\" full-button-layout=true></div> <ol ng-if=$ctrl.isAddOnFullProductCell class=cell-container> <li ng-repeat=\\\"product in $ctrl.getResults() track by $index\\\" class=cell-wrapper> <div product-cell product-details-modal-link=true is-external-routes-disabled=true product=product promoted-media=product.promoted_media location=\\\"{{::analyticsFlyerLocation | capitalize}}\\\" index=$index class=\\\"span-{{::($root.mobile.isMobile) ? (product.promoted_media.mobile.span || product.promoted_media.desktop.span) : product.promoted_media.desktop.span}}\\\" role=group aria-label=product></div> </li> </ol> <div class=\\\"text-center clearfix\\\"> <ul ng-if=\\\"!$ctrl.mobile.isMobile && $ctrl.getResults().item_count > $ctrl.productsPerPage\\\" uib-pagination boundary-links=true previous-text=\\\"\\\" first-text=1 template-url=pagination-modified-uibootstrap-desktop.html next-text=\\\"\\\" total-items=$ctrl.getResults().item_count max-size=$ctrl.config.maxPaginationLinks items-per-page=$ctrl.productsPerPage ng-model=page.current class=pagination analytics-click=\\\"['search pagination', 'click']\\\"></ul> <ul ng-if=\\\"$ctrl.mobile.isMobile && $ctrl.getResults().item_count > $ctrl.productsPerPage\\\" uib-pagination boundary-links=true previous-text=Prev first-text=First template-url=pagination-modified-uibootstrap-mobile.html next-text=\\\"\\\" total-items=$ctrl.getResults().item_count max-size=$ctrl.config.maxPaginationLinks items-per-page=$ctrl.productsPerPage ng-model=page.current class=pagination analytics-click=\\\"['search pagination', 'click']\\\"></ul> </div> </div> </div> </div> </div> \";","module.exports = \"<div filters-bar-resize-hide> <div sticky class=\\\"filters faceted-filters\\\" ng-class=\\\"::{ 'ecom-light-mode': $ctrl.inEComLightMode }\\\" offset=\\\"{{ ::stickyOffset }}\\\" min-width=1250> <div class=faceted-filters-wrapper> <fieldset class=toggles> <legend class=screen-reader-text>Toggle Product Filters. Choosing a filter will refresh the search results and show updated products</legend> <div class=\\\"tag more\\\" ng-class=\\\"{'spacing-right': !$ctrl.showSort}\\\" ng-if=extraFilters.length uib-dropdown auto-close=outsideClick> <div class=faceted-filters-dropdown uib-dropdown-toggle sanitize-uib=\\\"['aria-haspopup', 'aria-expanded']\\\"> <span aria-hidden=true class=icon-filter></span> <span>{{$ctrl.lang.values.moreFilters}}</span> <span aria-hidden=true class=dropdown-chevron></span> </div> <div class=\\\"dropdown-menu bottom-center\\\" uib-dropdown-menu> <ul> <li ng-repeat=\\\"tag in extraFilters | reverse\\\" class=tag analytics-click=\\\"['tag filter ' + tag.id, 'click']\\\" data-test=\\\"filter {{::tag.id}}\\\"> <faceted-search-checkbox checked=$ctrl.selectedTags[tag.id] selected-tags=$ctrl.selectedTags id=\\\"'extra-dropdown'\\\" item=tag label=tag.name select-value=tag.id /> </li> </ul> </div> </div> <div data-tag-name={{staticTag.id}} ng-repeat=\\\"staticTag in $ctrl.tags\\\" class=tag--container analytics-click=\\\"['tag filter ' + staticTag.id, 'click']\\\" data-test=\\\"filter {{::staticTag.id}}\\\"> <faceted-search-checkbox checked=$ctrl.selectedTags[staticTag.id] selected-tags=$ctrl.selectedTags id=\\\"''\\\" item=staticTag label=staticTag.name select-value=staticTag.id /> </div> </fieldset> <div class=faceted-sort-dropdown ng-if=::$ctrl.showSort> <span class=screenreadertext>{{ ::lang.facetedFilterScreenReaderText }}</span> <div class=sort analytics-click=\\\"['sort dropdown', 'click']\\\"> <div class=\\\"select small\\\"> <label for=sort-{{$ctrl.sort.name}} aria-label=\\\"{{::$ctrl.lang.aria.sort}} {{$ctrl.sort.name}} and reload page\\\">{{$ctrl.lang.values.sort}} {{$ctrl.sort.name}}</label> <select ng-model=$ctrl.sort name=sort-{{$ctrl.sort.name}} ng-change=$ctrl.sortChange() aria-label=\\\"{{::$ctrl.lang.aria.sort}} {{$ctrl.sort.name}} and reload page\\\" ng-options=\\\"option as option.name for option in $ctrl.sortOptions track by option.value\\\"></select> <div class=selected><span class=icon-tag-more aria-hidden=true></span> {{$ctrl.sort.name ? '' : $ctrl.lang.values.sort}} {{$ctrl.sort.name}}</div> </div> </div> </div> </div> </div> </div> \";","module.exports = \"<react-checkbox checked=checked on-change=onCheckboxChange label-text=createLabelText ng-attr-id=createId size=\\\"'small'\\\"/> \";","module.exports = \"<div data-test=offer-details-modal class=\\\"offer-details-modal modal-container\\\"> <div class=\\\"modal-header modal-header-collapse-desktop\\\" shop-modal-header></div> <div class=modal-content> <div ng-include=\\\"'offerDetails.html'\\\"></div> </div> </div> \";","module.exports = \"<div class=\\\"parent-shopping-selector modal-container\\\" data-test=parent-shopping-selector-{{shoppingSelectorStage}} ng-class=\\\"{\\n    'selector-error': triggerInputShake,\\n    'zoom-in-open': !mobile.isMobile && modalOpen,\\n    'zoom-out-close': !mobile.isMobile && !modalOpen && (shoppingSelectorStage === 'shoppingContext' || shoppingSelectorStage === 'confirmation'),\\n    'fade-out-close': !mobile.isMobile && !modalOpen && (shoppingSelectorStage == 'timeslot' || shoppingSelectorStage == 'storeSelector'),\\n    'custom-context-modal': shoppingSelectorStage === 'shoppingContext' || shoppingSelectorStage === 'confirmation',\\n    'timeslot-modal': shoppingSelectorStage === 'timeslot'\\n\\n  }\\\"> <div ng-if=\\\":: mobile.isMobile && config.enableShoppingSelectorHeader\\\" shopping-selector-modal-header></div> <div ng-if=\\\":: !mobile.isMobile && config.enableShoppingSelectorHeader\\\" class=modal-header role=region ng-class=\\\"{\\n      'pickup-context': shopContextIntent == 'pickup',\\n      'delivery-context': shopContextIntent == 'delivery',\\n      'instore-context': shopContextIntent == 'instore',\\n      'modal-header-collapse-desktop': (shoppingSelectorStage == 'shoppingContext' || shoppingSelectorStage == 'cartToListMigration')\\n    }\\\"> <div class=shopping-context-header> <span aria-hidden=true class=icon ng-class=\\\"{\\n          'icon-pickup': shopContextIntent == 'pickup',\\n          'icon-list': shopContextIntent == 'instore',\\n          'icon-delivery': shopContextIntent == 'delivery'\\n        }\\\"></span> <span role=heading aria-level=1 class=shopping-context-text> {{shoppingContextText}} </span> </div> </div> <button ng-if=\\\"modalOptions.isBackButtonVisible() && isBackButtonVisible() && (!mobile.isMobile || !config.enableShoppingSelectorHeader)\\\" ng-click=handleBackButtonClickFrom(shoppingSelectorStage) aria-label={{::lang.aria.goToShoppingContextSelector}} id={{getBackButtonId()}} class=go-back-link auto-focus=true data-test=context-modal-back-button> <span class=icon-chevron-left aria-hidden=true></span> </button> <button ng-if=\\\"showCloseButton() && (!mobile.isMobile || !config.enableShoppingSelectorHeader)\\\" ng-click=processModalCloseClick() class=close analytics-click=\\\"['shop modal close button', 'click']\\\" id=shopping-selector-parent-process-modal-close-click aria-label={{::lang.aria.modalClose}} auto-focus=true> <span class=icon-delete aria-hidden=true></span> </button> <div class=modal-content role=region> <div ng-if=\\\"shoppingSelectorStage === 'shoppingContext'\\\" ng-include=\\\"'contextSelector.html'\\\"></div> <div ng-if=\\\"shoppingSelectorStage === 'cartToListMigration'\\\"> <cart-list-transfer></cart-list-transfer> </div> <div ng-if=\\\"shoppingSelectorStage === 'storeSelector' || shoppingSelectorStage === 'bannerSelector'\\\" ng-include=\\\"'storeSelector.html'\\\"></div> <div ng-if=\\\"shoppingSelectorStage === 'timeslot'\\\" ng-include=\\\"'timeslotSelector.html'\\\"></div> <div ng-if=\\\"shoppingSelectorStage === 'confirmation'\\\" ng-include=\\\"'shoppingSelectorConfirmation.html'\\\"></div> </div> </div> \";","module.exports = \"<div data-test=promo-code-modal trap-focus ng-if=\\\"::!promoCodeOptions.newVersion || !mobile.isMobile\\\" class=\\\"promo-code-modal modal-container\\\" role=dialog aria-modal=true aria-label={{::lang.values.addAPromoCode}}> <div class=modal-header> {{::lang.values.promoCode}} <button ng-click=$dismiss() class=close aria-label={{::lang.aria.close}} auto-focus=true> <span class=icon-delete aria-hidden=true></span> </button> </div> <form ng-submit=\\\"checkIfValidPromoCode(promo, promoCodeForm)\\\" class=\\\"promo-code-modal-content modal-content\\\" name=promoCodeForm> <h1 class=screen-reader-text>{{::lang.values.promoCodeLabel}}</h1> <label class=promo-code-label for=promo-code-input>{{::lang.values.promoCodeLabel}}</label> <input type=text class=input name=promoCode ng-class=\\\"{'error': error}\\\" ng-model=promo.promo_code placeholder={{::lang.values.enterPromoCode}} title={{::lang.values.enterPromoCode}} auto-focus=\\\"{{ !!error }}\\\" required keep-observing=true aria-describedby=promo-code-error-message id=promo-code-input data-test=promo-code-input /> <p class=\\\"message error\\\" ng-if=\\\"error && promoCodeForm.promoCode.$invalid\\\" id=promo-code-error-message> <span class=icon-error aria-hidden=true></span> {{error}} </p> <div class=row ng-class=\\\"::{ 'row buttons-box': !mobile.isMobile, 'buttons': mobile.isMobile }\\\"> <button class=button type=submit>{{::lang.values.submit}}</button> </div> </form> </div> <div data-test=promo-code-modal ng-if=\\\"::promoCodeOptions.newVersion && mobile.isMobile\\\" class=\\\"promo-code-modal modal-container\\\" role=dialog aria-modal=true aria-label={{::lang.values.addAPromoCode}}> <div class=\\\"modal-header modal-header__light\\\"> <button ng-click=$dismiss() class=modal-header__back aria-label={{::lang.aria.modalClose}} auto-focus=true></button> <h1 class=modal-header-title>{{::lang.values.addAPromoCode}}</h1> </div> <form ng-submit=\\\"checkIfValidPromoCode(promo, promoCodeForm)\\\" class=\\\"promo-code-modal-content promo-code-modal-content--new modal-content\\\" name=promoCodeForm> <label class=promo-code-label for=promo-code-input>{{::lang.values.promoCodeLabel}}</label> <p class=\\\"message error\\\" ng-if=\\\"error && promoCodeForm.promoCode.$invalid\\\" id=promo-code-error-message> <span class=icon-error aria-hidden=true></span> {{error}} </p> <input id=promo-code-input data-test=promo-code-input aria-describedby=promo-code-error-message auto-focus=\\\"{{ !!error }}\\\" type=text class=input name=promoCode ng-class=\\\"{'error': error}\\\" ng-model=promo.promo_code placeholder={{::lang.values.enterPromoCode}} title={{::lang.values.enterPromoCode}} required aria-invalid=\\\"{{ promoCodeForm.promoCode.$dirty && !promoCodeForm.promoCode.$valid }}\\\"/> <div class=row> <button class=\\\"button dark\\\" type=submit>{{::lang.values.apply}}</button> </div> </form> </div> \";","module.exports = \"<div class=\\\"view home\\\" ng-init=logHomepageView()> <div class=\\\"store-details store-details-container\\\"> <div role=button tabindex=0 ng-click=onIntentChange() ng-disabled=isIntentChangeDisabled data-test=store-button class=change-intent-button> <div class=home-store> <div class=store-details-title> <span class=\\\"icon icon-{{::intentIcon()}}\\\" aria-hidden=true></span> {{::intentLabel()}} </div> <div class=store-details-content> <banner-image ng-if=\\\"::config.multipleBanners.enabled && hasBannerImage\\\" banner-slug=auth.user.store.store_banner.key></banner-image> <span class=banner-name>{{intentLocation()}}</span> <span class=\\\"icon icon-after-chevron-down\\\" aria-hidden=true></span> </div> </div> <div class=timeslot ng-if=shouldShowIntentTimeslot() data-test=reservation-button> <div class=store-details-title>{{::intentTimeslotLabel()}}</div> <div class=store-details-content>{{::intentTimeslotDetails()}}</div> </div> </div> <div ng-if=\\\"config.policyModal.showPricingPolicyInHeader && config.policyModal.isPricingPolicyEnabled\\\" class=pricing-policy> <div class=store-details-title>&nbsp;</div> <button class=store-details-content ng-click=openPolicyModal()> <span class=\\\"icon icon-dollars-alt\\\" aria-hidden=true></span> {{::lang.values.viewPricingPolicy}} </button> </div> </div> <react-hero-banner></react-hero-banner> <div class=old-mobile-home-layout-styles> <section class=\\\"mobile-section mobile-section-divider\\\" ng-if=\\\"showBuyItAgain && config.buyItAgain.location === 'top'\\\"> <unata-product-collection layout=\\\"'mobile-row'\\\" collection=buyItAgainCollection location={{buyItAgainText}} attribute-add-to-cart-events=true analytics-placement-impression=\\\"[[{}], 'homepage', buyItAgainText]\\\"></unata-product-collection> <div class=\\\"mobile-section mobile-section-divider\\\"></div> </section> <section class=\\\"mobile-section mobile-section-divider\\\" ng-if=\\\"showHomepageFeaturedProducts && config.homepageFeaturedProducts.location === 'top'\\\"> <unata-product-collection layout=\\\"'mobile-row'\\\" collection=homepagedFeaturedProductsCollection location={{homepagedFeaturedProductsText}} analytics-placement-impression=\\\"[[{}], 'homepage', homepagedFeaturedProductsText]\\\" hide-view-more=true></unata-product-collection> <div class=\\\"mobile-section mobile-section-divider\\\"></div> </section> <div ng-if=\\\":: !config.disableQuickLinkCards && reactQuickLinkEnabled\\\"> <react-quick-links/> </div> <div ng-if=\\\":: !config.disableQuickLinkCards && !reactQuickLinkEnabled\\\" class=quick-links> <h2 class=section-divider> <span class=title>{{::lang.values.quickLinks}}</span> </h2> <ul class=quicklinks data-test=quicklinks-mobile> <li ng-repeat=\\\"quickLink in quickLinksFiltered\\\" class=quicklink-wrapper aria-label=\\\"Quick Link - {{quickLink.name}}\\\"> <a href=# class=quicklink ng-click=quickLinkClick(quickLink) ng-class=\\\"{'has-icon-text' : quickLink.iconText}\\\" data-test=quicklink-{{quickLink.id}}> <span class=\\\"quicklink-icon icon-{{quickLink.icon}}\\\" aria-hidden=true></span> <span class=quicklink-icon-text ng-if=quickLink.iconText>{{quickLink.iconText}}</span> <span class=quicklink-title-container> <span class=quicklink-title>{{quickLink.name}}</span> </span> </a> </li> </ul> </div> <div ng-if=\\\":: showWaysToShop\\\"> <h2 class=section-divider> <span class=title>{{::lang.values.shopBy}}</span> </h2> <div class=tags> <ul class=tags-wrapper data-test=shop-by-tags> <li ng-repeat=\\\"tag in ::tags\\\"> <a class=tag ui-sref=\\\"main.shop.categories({page: null, tags: [tag.id]})\\\" data-test=quickshop-{{::tag.id}}> <div class=tag-icon tag-style tag-location=mobile-home tag=tag></div> <div class=info ng-attr-style=color:{{::tag.color}}>{{::tag.name}}</div> </a> </li> </ul> </div> </div> <section class=\\\"mobile-section mobile-section-divider\\\" ng-if=\\\"showBuyItAgain && config.buyItAgain.location === 'bottom'\\\"> <unata-product-collection layout=\\\"'mobile-row'\\\" collection=buyItAgainCollection location={{buyItAgainText}} attribute-add-to-cart-events=true analytics-placement-impression=\\\"[[{}], 'homepage', buyItAgainText]\\\"></unata-product-collection> <div class=\\\"mobile-section mobile-section-divider\\\"></div> </section> <div class=list-nav> <react-mobile-list-nav></react-mobile-list-nav> </div> <div ng-if=\\\":: (config.shoppingSelector.delivery.exist || config.shoppingSelector.pickup.exists) && !config.disableOrderHistory\\\" class=orders ng-class=\\\"{'no-orders': !orders || orders.length == 0}\\\"> <a class=header ui-sref=main.account.orderHistory> <span class=icon-order aria-hidden=true></span> {{::lang.values.homeOrdersHeader}} <span class=icon-chevron-right aria-hidden=true></span> </a> <div class=content> <div ng-if=\\\"auth.user.status == 'trial'\\\" class=no-orders> <div class=big>{{::lang.values.loginToViewOrders}}</div> <button ng-click=loginToOrders() class=\\\"button small\\\">{{::lang.values.login}}</button> </div> <div ng-if=\\\"auth.user.status != 'trial' && (!orders || orders.length == 0)\\\" class=no-orders> <div class=big>{{::lang.values.noOrders}}</div> <a ui-sref={{::config.continueShoppingRedirect.mobile}} class=shop>{{::lang.values.startShopping}}</a> </div> <div ng-if=\\\"auth.user.status != 'trial' && orders && orders.length > 0\\\"> <ol class=list> <li ng-repeat=\\\"order in orders | orderBy:'fulfillment_date':true | limitTo:2\\\" class=order> <a href=\\\"\\\" ng-click=handleViewOrderClick(order) analytics-click=\\\"['homepage order button', 'click', $index]\\\" role=button> <div class=date> {{order.fulfillment_date | date:\\\"MMMM DD, YYYY\\\":config.apiDateFormat}} </div> <div class=total> {{::lang.values.total}}: <span class=amount>{{order.final_totals ? order.final_totals.total : order.estimated_totals.total | currency}}</span> </div> <span class=icon-after-go aria-hidden=true></span> </a> </li> </ol> </div> </div> </div> <h2 class=section-divider ng-if=\\\"bannerContent && !config.enableHomepageBannerSlider\\\"> <span class=title>{{::lang.values.featured}}</span> </h2> <div class=banners ng-if=\\\"bannerContent && !config.enableHomepageBannerSlider\\\"> <div analytics-placement-impression=\\\"[bannerContent, 'homepage']\\\"> <div ng-repeat=\\\"banner in bannerContent | limitTo:config.numHomepageBanners\\\" class=banner> <a ng-click=\\\"logPromotedPlacement(banner, 'Homepage Banner', $index)\\\" ng-init=canvas.logImpression(banner) content-href=banner analytics-click=\\\"['mobile homepage banner', 'click', $index, banner.id]\\\" data-test=content-banner-{{banner.id}} ng-attr-target=\\\"{{ bannerTarget(banner) }}\\\"> <img ng-src={{imageTransform(util.escapeImageUrl(banner.media.image))}} alt={{banner.media.alt_text}}> </a> </div> </div> </div> <react-homepage-banners ng-if=config.enableHomepageBannerSlider></react-homepage-banners> <div ng-if=collectionPlacements analytics-placement-impression=\\\"[collectionPlacements, 'homepage']\\\"> <div ng-repeat=\\\"collection in collections\\\" class=collection-wrapper ng-click=\\\"logPromotedPlacement(collectionPlacements[$index], 'Homepage Collection', $index)\\\"> <div ng-init=\\\"getCollectionData(collection, $index)\\\"> <unata-product-collection collection=::collections[$index] location=\\\"Mobile Homepage Collection\\\" layout=\\\"'mobile-row'\\\" data-test=collection-{{collections[$index].id}} ng-if=::collections[$index].items.length></unata-product-collection> </div> </div> </div> </div> <section class=\\\"mobile-section mobile-section-divider\\\" ng-if=\\\"showHomepageFeaturedProducts && config.homepageFeaturedProducts.location === 'bottom'\\\"> <unata-product-collection layout=\\\"'mobile-row'\\\" collection=homepageFeaturedProductsCollection location={{homepageFeaturedProductsText}} analytics-placement-impression=\\\"[[{}], 'homepage', homepageFeaturedProductsText]\\\" hide-view-more=true></unata-product-collection> <div class=\\\"mobile-section mobile-section-divider\\\"></div> </section> <div mobile-app-promotion-banner></div> <section class=\\\"categories mobile-section\\\" ng-if=::config.shopByAisle.mobile.enabled> <h2 class=mobile-section-header> <span class=title>{{::lang.values.shopByAisle}}</span> </h2> <ul class=\\\"categories-grid categories-grid--centered\\\"> <li ng-repeat=\\\"category in categories | limitTo:config.shopByAisle.mobile.limit track by $index\\\" class=category> <category-card analytics-click=\\\"['homepage category link', 'click', $index, category.id]\\\" href=\\\"'main.shop.category'\\\" href-opts=\\\"{ inherit: false }\\\" category=category /> </li> </ul> <a ng-if=\\\"::config.shopByAisle.mobile.limit !== null\\\" class=vertical-list-cta ui-sref=main.shop.categories> {{::lang.values.viewAllAisles}} </a> <div class=\\\"mobile-section mobile-section-divider\\\"></div> </section> </div> \";","module.exports = \"<div ng-include=\\\"'loyalty.desktop.html'\\\" ng-if=\\\":: !mobile.isMobile && !$ctrl.loyaltyOptIn\\\"></div> <div ng-include=\\\"'loyalty.mobile.html'\\\" ng-if=\\\":: (mobile.isMobile && !config.disableLoyaltyCard) && !$ctrl.loyaltyOptIn\\\"></div> <div ng-include=\\\"'loyalty.mobileAlternate.html'\\\" ng-if=\\\":: (mobile.isMobile && config.disableLoyaltyCard && !$ctrl.loyaltyOptIn)\\\"></div> <div ng-if=\\\":: $ctrl.loyaltyOptIn\\\"> <loyalty-opt-in-placement></loyalty-opt-in-placement> </div> \";","module.exports = \"<div ng-if=$ctrl.checkoutService.error class=\\\"message error checkout-steps__error\\\"> <span class=icon-error aria-hidden=true></span> {{$ctrl.checkoutService.error}} </div> <cart-compare-dialog items=$ctrl.getCartItemsByType($ctrl.cartType)></cart-compare-dialog> <div class=checkout-steps> <div ng-repeat=\\\"checkoutStep in ::$ctrl.filteredSteps track by $index\\\" class=checkout-steps__section> <div ng-switch=checkoutStep.name> <cart-form ng-switch-when=cart title={{$ctrl.cartTitle}} edit-mode=$ctrl.steps.cart.editMode update-message=$ctrl.cartService.updateMessage items=$ctrl.getCartItemsByType($ctrl.cartType) on-cart-size-change=$ctrl.showCartUpdatedMessage(cartChangeSize) on-message-dismiss=\\\"$ctrl.cartService.updateMessage = null\\\"> </cart-form> <pickup-form stores=$ctrl.stores ng-switch-when=pickup edit=$ctrl.editStep(step) user-store=$ctrl.auth.user.store edit-mode=$ctrl.steps.pickup.editMode title={{::$ctrl.lang.values.pickupStoreTitle}} on-store-applied=\\\"$ctrl.handlePickupApply(hasChanged, store)\\\" hide-chevron=\\\"$ctrl.steps.pickup.disabled || $root.modifyingInstacartOrder\\\"> </pickup-form> <banner-form ng-switch-when=banner address=$ctrl.checkoutService.deliveryAddress edit=$ctrl.editStep(step) edit-mode=$ctrl.steps.banner.editMode user-store=$ctrl.auth.user.store on-error=$ctrl.handleError(error) on-change-banner=$ctrl.onChangeBanner() hide-chevron=\\\"$ctrl.steps.delivery.disabled || $root.modifyingInstacartOrder\\\"> </banner-form> <delivery-form address=$ctrl.checkoutService.deliveryAddress edit=$ctrl.editStep(step) edit-mode=$ctrl.steps.delivery.editMode ng-switch-when=delivery on-address-applied=$ctrl.handleAddressApplied(address) on-error=$ctrl.handleDeliveryAddressError() hide-chevron=\\\"$ctrl.steps.delivery.disabled || $root.modifyingInstacartOrder\\\" on-cancel=$ctrl.onCancelAddressEdit()> </delivery-form> <order-delivery-instructions-form edit=$ctrl.editStep(step) edit-mode=$ctrl.steps.orderDeliveryInstructions.editMode ng-switch-when=orderDeliveryInstructions hide-chevron=$ctrl.steps.orderDeliveryInstructions.disabled section-options=$ctrl.orderDeliveryInstructionsStep.options on-save=$ctrl.handleOrderDeliveryInstructionsSave(leaveUnattended) validate-cart=$ctrl.validateCart()> </order-delivery-instructions-form> <schedule-form edit-mode=$ctrl.steps.schedule.editMode ng-switch-when=schedule on-error=$ctrl.handleError(error) on-save=$ctrl.handleScheduleFormSave() edit=$ctrl.editStep(step) hide-chevron=$ctrl.steps.schedule.disabled cart-id=$ctrl.getCartId()> </schedule-form> <contact-form edit-mode=$ctrl.steps.contact.editMode ng-switch-when=contact title={{::$ctrl.lang.values.contactInformation}} contact=$ctrl.checkoutService.contact on-error=$ctrl.handleError(error) on-save=\\\"$ctrl.handleContactInfoSave(fetch, contact)\\\" edit=$ctrl.editStep(step) condensed=$ctrl.mobileService.isMobile hide-chevron=$ctrl.steps.contact.disabled> </contact-form> <payment-form edit-mode=$ctrl.steps.payment.editMode suppress-initial-auto-close=$ctrl.paymentIsInitialStep ng-switch-when=payment payment=$ctrl.payment on-error=$ctrl.handleError(error) on-save=\\\"$ctrl.onPaymentSave(isValid, hasBeenEdited)\\\" edit=$ctrl.editStep(step) abort-edit=$ctrl.abortEdit() hide-chevron=$ctrl.steps.payment.disabled step-names=$ctrl.stepNames show-deferred-payment-notice=$ctrl.isDeferredAuth()> </payment-form> </div> </div> </div> \";","module.exports = \"<div tabindex=0 class=ic-express-popover ng-class=\\\"$ctrl.enableRetailerTheme ? 'ic-express-popover-retailer' : 'ic-express-popover-instacart'\\\"> <img aria-hidden=true class=ic-express-popover__image ng-src={{::$ctrl.utilService.loadInternalExternalAssets($ctrl.image)}} /> <div class=ic-express-popover__title> {{ $ctrl.lang.templateAsString( $ctrl.title, { days: $ctrl.config.icExpress.trialDays, express: $ctrl.config.icExpress.name } ) }} </div> <div class=ic-express-popover__actions> <button class=\\\"button ic-express-popover__button\\\" ng-click=$ctrl.primaryClick()> {{::$ctrl.primaryButtonLabel}} </button> <button class=button ng-click=$ctrl.secondaryClick() ng-class=\\\"$ctrl.enableRetailerTheme ? 'hollow' : 'ic-express-popover__secondary-button'\\\"> {{::$ctrl.secondaryButtonLabel}} </button> </div> <div class=ic-express-popover__subtitle>{{::$ctrl.subtitle}}</div> </div>\";","module.exports = \"<li role=button ng-click=shareListToMobile() class=icon-share-list analytics-click=\\\"['side cart share button', 'click']\\\"> <span ng-if=!hideText class=\\\"dropdown-menu-item next-to-item-thumbnail\\\">{{::lang.values.shareList}}</span> </li> \";","module.exports = \"<div data-test=homeview class=\\\"view home\\\" ng-init=logHomepageView()> <react-hero-banner ng-if=showHeroContent></react-hero-banner> <div class=homeview-top-section> <div ng-if=\\\"auth.getContext().intent !== 'instore'\\\" ng-include=\\\"'homepageOrders.html'\\\"></div> <div ng-if=showBannerContent class=banners> <div ng-if=bannerContent analytics-placement-impression=\\\"[bannerContent.slice(0, config.numHomepageBanners), 'homepage', 'homepage_banners']\\\"> <a ng-repeat=\\\"banner in bannerContent | limitTo:config.numHomepageBanners\\\" ng-click=\\\"logPromotedPlacement(banner, 'Homepage Banner', $index)\\\" ng-init=canvas.logImpression(banner) content-href=banner class=banner analytics-click=\\\"['homepage banner', 'click', $index, banner.id]\\\" data-test=content-banner-{{banner.id}} ng-attr-target=\\\"{{ bannerTarget(banner) }}\\\"> <img ng-src={{imageTransform(util.escapeImageUrl(banner.media.image))}} alt={{banner.media.alt_text}}> </a> </div> <a href=# aria-label={{::lang.aria.loadingImage}} ng-if=!bannerContent ng-repeat=\\\"i in utilService.getArrayOfSpecificLength(config.numHomepageBanners) track by $index\\\" class=\\\"banner-loader loading-shimmer\\\"></a> </div> <unata-product-collection class=buy-it-again collection=buyItAgainCollection ng-if=\\\"showBuyItAgain && config.buyItAgain.location === 'top'\\\" attribute-add-to-cart-events=true location={{buyItAgainText}} padded=true analytics-placement-impression=\\\"[[{}], 'homepage', buyItAgainText]\\\"></unata-product-collection> <unata-product-collection class=homepage-featured-products collection=homepageFeaturedProductsCollection ng-if=\\\"showHomepageFeaturedProducts && config.homepageFeaturedProducts.location === 'top'\\\" attribute-add-to-cart-events=true location={{homepageFeaturedProductsText}} padded=true analytics-placement-impression=\\\"[[{}], 'homepage', homepageFeaturedProductsText]\\\" hide-view-more=true></unata-product-collection> <div quickshop ng-if=::showWaysToShop></div> <unata-product-collection class=buy-it-again collection=buyItAgainCollection attribute-add-to-cart-events=true ng-if=\\\"showBuyItAgain && config.buyItAgain.location === 'bottom'\\\" location={{buyItAgainText}} padded=true analytics-placement-impression=\\\"[[{}], 'homepage', buyItAgainText]\\\"></unata-product-collection> </div> <div ng-if=collectionPlacements analytics-placement-impression=\\\"[collectionPlacements, 'homepage', 'collection placements']\\\"> <div ng-repeat=\\\"collection in collections track by $index\\\" class=collection-wrapper ng-click=\\\"logPromotedPlacement(collectionPlacements[$index], 'Homepage Collection', $index)\\\"> <div ng-init=\\\"getCollectionData(collection, $index)\\\"> <unata-product-collection collection=collection ng-if=collection.items.length location=\\\"Desktop Homepage Collection\\\"></unata-product-collection> </div> </div> </div> <unata-product-collection class=homepage-featured-products collection=homepageFeaturedProductsCollection ng-if=\\\"showHomepageFeaturedProducts && config.homepageFeaturedProducts.location === 'bottom'\\\" attribute-add-to-cart-events=true location={{homepageFeaturedProductsText}} padded=true analytics-placement-impression=\\\"[[{}], 'homepage', homepageFeaturedProductsText]\\\" hide-view-more=true></unata-product-collection> <div class=categories ng-class=\\\"{ 'hide-background': config.react.enableIdsCategoryTile }\\\" ng-if=::config.shopByAisle.desktop.enabled> <h2 class=section-divider> <span class=title>{{::lang.values.shopByAisle}}</span> </h2> <ul class=\\\"categories-grid categories-grid--centered\\\"> <li ng-repeat=\\\"category in categories | limitTo:\\n        config.shopByAisle.desktop.limit track by $index\\\" class=category> <category-card analytics-click=\\\"['homepage category link', 'click', $index, category.id]\\\" href=\\\"'main.shop.category'\\\" href-opts=\\\"{ inherit: false }\\\" category=category /> </li> </ul> </div> </div> \";","module.exports = \"<div class=credit-card-logos> <img ng-repeat=\\\"creditCard in ::$ctrl.creditCards track by creditCard.id\\\" alt=\\\"{{ ::creditCard.name }}\\\" class=credit-card-logos__img ng-src=\\\"{{ ::utilService.loadStaticImage(creditCard.logo) }}\\\" ng-class=\\\"{ 'credit-card-logos__img--disabled': $ctrl.isDirty && $ctrl.selectedCreditCard !== creditCard.id }\\\"/> </div>\";","module.exports = \"<div class=error-modal> <div class=modal-header> {{::lang.values.unclippedCouponHeading}} </div> <div class=error-modal-content> <div class=text ng-bind-html=lang.values.unclippedCouponMessage></div> <div class=\\\"both buttons\\\"> <button ng-click=$close() class=\\\"button mobile-bottom\\\" analytics-click=\\\"['unclippedCoupon modal ok button', 'click']\\\">{{::lang.values.unclippedCouponOkText}}</button> <button ng-click=$dismiss() class=\\\"button mobile-bottom\\\" ng-class=\\\"::{ 'dark': mobile.isMobile }\\\" analytics-click=\\\"['unclippedCoupon modal cancel button', 'click']\\\">{{::lang.values.unclippedCouponCancelText}}</button> </div> </div> </div> \";","module.exports = \"<div class=context-switch> <div class=context-switch-warning> <div class=\\\"warning icon-warning\\\"></div> </div> <div class=context-switch-message> <strong>{{::noItemsInContextHeader}}</strong> <br/> <div class=context-switch-message-body> {{::noItemsInContextBody}} </div> <div> <button id=404-switch-context-to-delivery-button class=\\\"button smaller\\\" ng-if=showDeliveryContextSwitch ng-click=switchShoppingMethodToDelivery()> {{::lang.values.changeShoppingMethodToDelivery}} </button> <button id=404-switch-context-to-pickup-button class=\\\"button smaller\\\" ng-if=showPickupContextSwitch ng-click=switchShoppingMethodToPickup()> {{::lang.values.changeShoppingMethodToPickup}} </button> <button id=404-switch-context-to-catering-button class=\\\"button smaller\\\" ng-if=showCateringContextSwitch ng-click=switchShoppingMethodToCatering()> {{::lang.values.changeShoppingMethodToCatering}} </button> </div> </div> </div>\";","module.exports = \"<div id=icExpressForm class=ic-express-form ng-class=\\\"!$ctrl.enableRetailerTheme ? 'instacart' : ''\\\"> <div class=ic-express-form__stripe> <stripe-payment-form additional-form-info=\\\"{{:: $ctrl.additionalFormText }}\\\" hide-title=true use-ic-theme=!$ctrl.enableRetailerTheme style-add-card-as-link=true add-card-label=\\\"{{:: $ctrl.lang.values.addNewCard}}\\\" create-credit-card-label=\\\"{{:: $ctrl.lang.values.continue}}\\\" enable-form-background=true enable-credit-card-select-button=true enable-cancel-form-button=true on-cancel-form-click=$ctrl.onCancelFormClick() on-credit-card-select=$ctrl.subscribe() squared-buttons=true request-user-payment-on-first-fetch=true></stripe-payment-form> </div> </div> \";","module.exports = \"<div class=cancellation-step> <div class=cancellation-step__title ng-bind-html=$ctrl.config.icExpress.cancellation.secondStep.title></div> <p class=cancellation-step__sub-title> {{::$ctrl.subTitle}} </p> <div class=cancellation-step__update-membership> <button class=\\\"button hollow\\\" ng-click=$ctrl.onUpdateMembershipClick() ng-class=\\\"{ 'ic-theme': $ctrl.useIcTheme }\\\"> {{::$ctrl.membershipButtonLabel}} </button> </div> <p class=\\\"cancellation-step__sub-title cancellation-step__sub-title--small cancellation-step__sub-title--zero-margin\\\"> {{::$ctrl.bottomText}} </p> <div class=cancellation-step__actions ng-class=\\\"{ 'ic-theme': $ctrl.useIcTheme }\\\"> <div class=cancellation-step__action-reminder> <button class=\\\"button button--squared\\\" ng-click=$ctrl.onSendReminderClick()> {{::$ctrl.config.icExpress.cancellation.sendReminder}} </button> <div class=cancellation-step__action-details> {{::$ctrl.getRenewReminderText()}} </div> </div> <div class=cancellation-step__action-cancel> <button ng-click=$ctrl.onContinueClick() class=\\\"button button--squared\\\"> {{::$ctrl.config.icExpress.cancellation.continue}} </button> </div> </div> <div class=cancellation-step__tos ng-bind-html=$ctrl.termsOfService></div> </div>\";","module.exports = \"<div class=offer-progress data-test=offer-progress ng-class=\\\"{'completed': completed, 'conditional': conditional, 'coupon-incomplete': unclipped}\\\"> <button ng-if=\\\":: openOfferDetailsModal\\\" ng-click=openOfferDetailsModal() class=offer-progress-container aria-label=\\\"Go to {{offerProgressData.offer.name}} Offer Page\\\" analytics-click=\\\"['progress bar offer link', 'click']\\\"> <div class=progress-bar><div class=bar ng-attr-style=\\\"width: {{progress}};\\\" aria-label=\\\"Offer Progress: {{label}}\\\"></div></div> <div class=progress-label> <span aria-hidden=true class=icon-promo-check></span> {{label}} </div> </button> <a ng-if=\\\":: !openOfferDetailsModal\\\" class=offer-progress-container analytics-click=\\\"['progress bar offer link', 'click']\\\"> <div class=progress-bar> <div class=bar ng-attr-style=\\\"width: {{progress}};\\\"></div> </div> <div class=progress-label> <span aria-hidden=true class=icon-promo-check></span> {{label}} </div> </a> </div> \";","module.exports = \"<div class=\\\"view account {{section}}\\\"> <div class=account-container> <div class=sidenav-wrapper ng-if=\\\"::(!mobile.isMobile || config.enableAccountSubMenuMobile)\\\"> <div class=\\\"menu sidenav\\\"> <ul> <li class=sidenav-item ng-repeat=\\\"item in accountMenuItems\\\" ng-if=\\\"!item.ngIf || item.ngIf()\\\" ng-class=\\\"{'active': state.includes(item.sref)}\\\"> <a ng-if=\\\"!item.extLink && !item.onClick\\\" href={{state.href(item.sref)}} ng-attr-id=\\\"{{:: item.id}}\\\" analytics-click=\\\"['account menu link', 'click', item.label]\\\">{{item.label}}</a> <a ng-if=\\\"!item.extLink && item.onClick\\\" ng-click=item.onClick() ng-attr-id=\\\"{{:: item.id}}\\\" analytics-click=\\\"['account menu link', 'click', item.label]\\\">{{item.label}}</a> <a ng-if=\\\"item.extLink && item.extLink !== 'gigya'\\\" href={{item.extLink}} target=_blank analytics-click=\\\"['account menu link', 'click', item.label]\\\">{{item.label}}</a> <a ng-if=\\\"item.extLink && item.extLink === 'gigya'\\\" ng-click=gigyaChangePassword() analytics-click=\\\"['account menu link', 'click', item.label]\\\">{{item.label}}</a> </li> </ul> </div> </div> <div class=content> <div page-header button=checkForButtons() label=getPageHeaderTitle() breadcrumbs=breadcrumbs></div> <div ui-view=content></div> </div> </div> </div> \";","// circles\n// copyright Artan Sinani\n// https://github.com/lugolabs/circles\n\n/*\n  Lightwheight JavaScript library that generates circular graphs in SVG.\n\n  Call Circles.create(options) with the following options:\n\n    id         - the DOM element that will hold the graph\n    radius     - the radius of the circles\n    width      - the width of the ring (optional, has value 10, if not specified)\n    value      - init value of the circle (optional, defaults to 0)\n    maxValue   - maximum value of the circle (optional, defaults to 100)\n    text       - the text to display at the centre of the graph (optional, the current \"htmlified\" value will be shown if not specified)\n                 if `null` or an empty string, no text will be displayed\n                 can also be a function: the returned value will be the displayed text\n                     ex1. function(currentValue) {\n                              return '$'+currentValue;\n                          }\n                     ex2.  function() {\n                               return this.getPercent() + '%';\n                           }\n    colors     - an array of colors, with the first item coloring the full circle\n                 (optional, it will be `['#EEE', '#F00']` if not specified)\n    duration   - value in ms of animation duration; (optional, defaults to 500);\n                 if 0 or `null` is passed, the animation will not run\n    wrpClass     - class name to apply on the generated element wrapping the whole circle.\n    textClass:   - class name to apply on the generated element wrapping the text content.\n\n    API:\n      updateRadius(radius) - regenerates the circle with the given radius (see spec/responsive.html for an example hot to create a responsive circle)\n      updateWidth(width) - regenerates the circle with the given stroke width\n      updateColors(colors) - change colors used to draw the circle\n      update(value, duration) - update value of circle. If value is set to true, force the update of displaying\n      getPercent() - returns the percentage value of the circle, based on its current value and its max value\n      getValue() - returns the value of the circle\n      getMaxValue() - returns the max value of the circle\n       getValueFromPercent(percentage) - returns the corresponding value of the circle based on its max value and given percentage\n       htmlifyNumber(number, integerPartClass, decimalPartClass) - returned HTML representation of given number with given classes names applied on tags\n\n*/\n\n;(function(root, factory) {\n  if (typeof exports === 'object') {\n    module.exports = factory()\n  } else if (typeof define === 'function' && define.amd) {\n    define([], factory)\n  } else {\n    window.Circles = factory()\n  }\n})(this, function() {\n  'use strict'\n\n  var requestAnimFrame =\n      window.requestAnimationFrame ||\n      window.webkitRequestAnimationFrame ||\n      window.mozRequestAnimationFrame ||\n      window.oRequestAnimationFrame ||\n      window.msRequestAnimationFrame ||\n      function(callback) {\n        setTimeout(callback, 1000 / 60)\n      },\n    Circles = function(options) {\n      var elId = options.id\n      this._el = document.getElementById(elId)\n\n      if (this._el === null) return\n\n      this._radius = options.radius || 10\n      this._duration = options.duration === undefined ? 500 : options.duration\n\n      this._value = 0.0000001\n      this._maxValue = options.maxValue || 100\n\n      this._text =\n        options.text === undefined\n          ? function(value) {\n              return this.htmlifyNumber(value)\n            }\n          : options.text\n      this._strokeWidth = options.width || 10\n      this._colors = options.colors || ['#EEE', '#F00']\n      this._svg = null\n      this._movingPath = null\n      this._wrapContainer = null\n      this._textContainer = null\n\n      this._wrpClass = options.wrpClass || 'circles-wrp'\n      this._textClass = options.textClass || 'circles-text'\n\n      this._valClass = options.valueStrokeClass || 'circles-valueStroke'\n      this._maxValClass = options.maxValueStrokeClass || 'circles-maxValueStroke'\n\n      this._styleWrapper = options.styleWrapper === false ? false : true\n      this._styleText = options.styleText === false ? false : true\n\n      var endAngleRad = (Math.PI / 180) * 270\n      this._start = (-Math.PI / 180) * 90\n      this._startPrecise = this._precise(this._start)\n      this._circ = endAngleRad - this._start\n\n      this._generate().update(options.value || 0)\n    }\n\n  Circles.prototype = {\n    VERSION: '0.0.6',\n\n    _generate: function() {\n      this._svgSize = this._radius * 2\n      this._radiusAdjusted = this._radius - this._strokeWidth / 2\n\n      this._generateSvg()\n        ._generateText()\n        ._generateWrapper()\n\n      this._el.innerHTML = ''\n      this._el.appendChild(this._wrapContainer)\n\n      return this\n    },\n\n    _setPercentage: function(percentage) {\n      this._movingPath.setAttribute('d', this._calculatePath(percentage, true))\n      this._textContainer.innerHTML = this._getText(this.getValueFromPercent(percentage))\n    },\n\n    _generateWrapper: function() {\n      this._wrapContainer = document.createElement('div')\n      this._wrapContainer.className = this._wrpClass\n\n      if (this._styleWrapper) {\n        this._wrapContainer.style.position = 'relative'\n        this._wrapContainer.style.display = 'inline-block'\n      }\n\n      this._wrapContainer.appendChild(this._svg)\n      this._wrapContainer.appendChild(this._textContainer)\n\n      return this\n    },\n\n    _generateText: function() {\n      this._textContainer = document.createElement('div')\n      this._textContainer.className = this._textClass\n\n      if (this._styleText) {\n        var style = {\n          position: 'absolute',\n          top: 0,\n          left: 0,\n          textAlign: 'center',\n          width: '100%',\n          fontSize: this._radius * 0.7 + 'px',\n          height: this._svgSize + 'px',\n          lineHeight: this._svgSize + 'px',\n        }\n\n        for (var prop in style) {\n          this._textContainer.style[prop] = style[prop]\n        }\n      }\n\n      this._textContainer.innerHTML = this._getText(0)\n      return this\n    },\n\n    _getText: function(value) {\n      if (!this._text) return ''\n\n      if (value === undefined) value = this._value\n\n      value = parseFloat(value.toFixed(2))\n\n      return typeof this._text === 'function' ? this._text.call(this, value) : this._text\n    },\n\n    _generateSvg: function() {\n      this._svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg')\n      this._svg.setAttribute('xmlns', 'http://www.w3.org/2000/svg')\n      this._svg.setAttribute('width', this._svgSize)\n      this._svg.setAttribute('height', this._svgSize)\n\n      this._generatePath(100, false, this._colors[0], this._maxValClass)._generatePath(\n        1,\n        true,\n        this._colors[1],\n        this._valClass\n      )\n\n      this._movingPath = this._svg.getElementsByTagName('path')[1]\n\n      return this\n    },\n\n    _generatePath: function(percentage, open, color, pathClass) {\n      var path = document.createElementNS('http://www.w3.org/2000/svg', 'path')\n      path.setAttribute('fill', 'transparent')\n      path.setAttribute('stroke', color)\n      path.setAttribute('stroke-width', this._strokeWidth)\n      path.setAttribute('d', this._calculatePath(percentage, open))\n      path.setAttribute('class', pathClass)\n\n      this._svg.appendChild(path)\n\n      return this\n    },\n\n    _calculatePath: function(percentage, open) {\n      var end = this._start + (percentage / 100) * this._circ,\n        endPrecise = this._precise(end)\n      return this._arc(endPrecise, open)\n    },\n\n    _arc: function(end, open) {\n      var endAdjusted = end - 0.001,\n        longArc = end - this._startPrecise < Math.PI ? 0 : 1\n\n      return [\n        'M',\n        this._radius + this._radiusAdjusted * Math.cos(this._startPrecise),\n        this._radius + this._radiusAdjusted * Math.sin(this._startPrecise),\n        'A', // arcTo\n        this._radiusAdjusted, // x radius\n        this._radiusAdjusted, // y radius\n        0, // slanting\n        longArc, // long or short arc\n        1, // clockwise\n        this._radius + this._radiusAdjusted * Math.cos(endAdjusted),\n        this._radius + this._radiusAdjusted * Math.sin(endAdjusted),\n        open ? '' : 'Z', // close\n      ].join(' ')\n    },\n\n    _precise: function(value) {\n      return Math.round(value * 1000) / 1000\n    },\n\n    /*== Public methods ==*/\n\n    htmlifyNumber: function(number, integerPartClass, decimalPartClass) {\n      integerPartClass = integerPartClass || 'circles-integer'\n      decimalPartClass = decimalPartClass || 'circles-decimals'\n\n      var parts = (number + '').split('.'),\n        html = '<span class=\"' + integerPartClass + '\">' + parts[0] + '</span>'\n\n      if (parts.length > 1) {\n        html += '.<span class=\"' + decimalPartClass + '\">' + parts[1].substring(0, 2) + '</span>'\n      }\n      return html\n    },\n\n    updateRadius: function(radius) {\n      this._radius = radius\n\n      return this._generate().update(true)\n    },\n\n    updateWidth: function(width) {\n      this._strokeWidth = width\n\n      return this._generate().update(true)\n    },\n\n    updateColors: function(colors) {\n      this._colors = colors\n\n      var paths = this._svg.getElementsByTagName('path')\n\n      paths[0].setAttribute('stroke', colors[0])\n      paths[1].setAttribute('stroke', colors[1])\n\n      return this\n    },\n\n    getPercent: function() {\n      return (this._value * 100) / this._maxValue\n    },\n\n    getValueFromPercent: function(percentage) {\n      return (this._maxValue * percentage) / 100\n    },\n\n    getValue: function() {\n      return this._value\n    },\n\n    getMaxValue: function() {\n      return this._maxValue\n    },\n\n    update: function(value, duration) {\n      if (value === true) {\n        //Force update with current value\n        this._setPercentage(this.getPercent())\n        return this\n      }\n\n      if (this._value == value || isNaN(value)) return this\n      if (duration === undefined) duration = this._duration\n\n      var self = this,\n        oldPercentage = self.getPercent(),\n        delta = 1,\n        newPercentage,\n        isGreater,\n        steps,\n        stepDuration\n\n      this._value = Math.min(this._maxValue, Math.max(0, value))\n\n      if (!duration) {\n        //No duration, we can't skip the animation\n        this._setPercentage(this.getPercent())\n        return this\n      }\n\n      newPercentage = self.getPercent()\n      isGreater = newPercentage > oldPercentage\n\n      delta += newPercentage % 1 //If new percentage is not an integer, we add the decimal part to the delta\n      steps = Math.floor(Math.abs(newPercentage - oldPercentage) / delta)\n      stepDuration = duration / steps\n      ;(function animate(lastFrame) {\n        if (isGreater) oldPercentage += delta\n        else oldPercentage -= delta\n\n        if (\n          (isGreater && oldPercentage >= newPercentage) ||\n          (!isGreater && oldPercentage <= newPercentage)\n        ) {\n          requestAnimFrame(function() {\n            self._setPercentage(newPercentage)\n          })\n          return\n        }\n\n        requestAnimFrame(function() {\n          self._setPercentage(oldPercentage)\n        })\n\n        var now = Date.now(),\n          deltaTime = now - lastFrame\n\n        if (deltaTime >= stepDuration) {\n          animate(now)\n        } else {\n          setTimeout(function() {\n            animate(Date.now())\n          }, stepDuration - deltaTime)\n        }\n      })(Date.now())\n\n      return this\n    },\n  }\n\n  Circles.create = function(options) {\n    return new Circles(options)\n  }\n\n  window.Circles = Circles\n  return Circles\n})\n","module.exports = \" <div class=faceted-modal-wrapper> <faceted-filter-modal filter-modal-options=filterModalOptions close=$close dismiss=$dismiss> </faceted-filter-modal> </div> \";","module.exports = \"<div class=\\\"cancel-order-error-modal modal-container\\\"> <react-error-window error-title=$ctrl.lang.values.cancelOrder primary-button-content=$ctrl.lang.values.cancelOrderModal.cancelOrderYes secondary-button-content=$ctrl.secondaryButtonLabel tertiary-button-content=$ctrl.lang.values.cancelOrderModal.cancelOrderNo on-click-primary-button=($ctrl.$custom.callAndCloseFactory($ctrl.removeOrder)) on-click-secondary-button=($ctrl.$custom.callAndCloseFactory($ctrl.doModifyImmediately)) on-click-tertiary-button=($close) button-alignment=\\\"'center'\\\" button-direction=\\\"'column'\\\" body=\\\"$ctrl.$custom.templateToString('\\n      <div class=\\\\'cancelOrderMessage\\\\'>\\n        <div class=\\\\'question\\\\'>{{::$ctrl.lang.values.cancelOrderModal.cancelQuestion}}</div>\\n        {{::$ctrl.lang.values.cancelOrderModal.pleaseDontCancel}}\\n      </div>\\n    ')\\\"/> </div> \";","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport { FormControl, GridItem } from '@instacart/cocktail'\n\nconst InputGroup = ({ children }) => (\n  <GridItem xSmall={6}>\n    <FormControl fullWidth>{children}</FormControl>\n  </GridItem>\n)\n\nInputGroup.propTypes = {\n  children: PropTypes.node.isRequired,\n}\n\nexport default InputGroup\n","import React from 'react'\nimport { GridContainer, LoadingBlock, FormLabel } from '@instacart/cocktail'\n\nimport InputGroup from './InputGroup'\n\nconst TimeslotSelectLoading = () => (\n  <GridContainer data-test=\"timeslots-loading-state\">\n    <InputGroup>\n      <FormLabel>\n        <LoadingBlock shape=\"line\" width={200} />\n      </FormLabel>\n      <LoadingBlock shape=\"line\" height={38} />\n    </InputGroup>\n    <InputGroup>\n      <FormLabel>\n        <LoadingBlock shape=\"line\" width={200} />\n      </FormLabel>\n      <LoadingBlock shape=\"line\" height={38} />\n    </InputGroup>\n  </GridContainer>\n)\n\nexport default TimeslotSelectLoading\n","import React, { Suspense } from 'react'\nimport PropTypes from 'prop-types'\nimport { Alert } from '@instacart/cocktail'\nimport { ErrorBoundary } from '@instacart/enterprise-ui-common'\n\nimport TimeslotSelectLoading from './TimeslotSelectLoading'\n\nconst defaultLang = {\n  timeslotsError: 'It was not possible to retrieve timeslots.',\n}\n\nconst TimeslotsContainer = ({ children }) => {\n  const lang = { ...defaultLang }\n\n  return (\n    <ErrorBoundary\n      fallback={\n        <Alert variant=\"error\" data-test=\"timeslot-select-error-alert\">\n          {lang.timeslotsError}\n        </Alert>\n      }\n    >\n      <Suspense fallback={<TimeslotSelectLoading />}>{children}</Suspense>\n    </ErrorBoundary>\n  )\n}\n\nTimeslotsContainer.propTypes = {\n  children: PropTypes.node.isRequired,\n}\n\nexport default TimeslotsContainer\n","import React, { useState, useCallback } from 'react'\nimport PropTypes from 'prop-types'\nimport dayjs from 'dayjs'\nimport { useTimeslotsQuery } from '@instacart/enterprise-services-hooks'\nimport { createStyles, FormLabel, GridContainer, Select } from '@instacart/cocktail'\nimport { lang as langService, utils as utilsService } from '@instacart/enterprise-services'\n\nimport InputGroup from './InputGroup'\n\nconst DATE_FORMAT = 'YYYY/MM/DD'\nconst API_DATE_FORMAT = 'YYYY-MM-DD'\n\nconst lang = {\n  timeslotDateLabel: '{{fulfillmentType}} date',\n  timeslotTimeLabel: '{{fulfillmentType}} time',\n  timeslotTimeOptionLabel: '{{from}} until {{to}}',\n}\n\nconst useStyles = createStyles(() => ({\n  labels: {\n    textTransform: 'capitalize',\n  },\n}))\n\nconst getTimeslotOptions = ({ timeslots, date, options }) => {\n  const uniqueDays = [...new Set(timeslots.map(timeslot => timeslot.fulfillment_date))]\n\n  const days = uniqueDays.map(timeslot => ({\n    label: dayjs(timeslot, API_DATE_FORMAT).format(options.dateFormat),\n    value: timeslot,\n  }))\n\n  const filteredTimeslots = date\n    ? timeslots.filter(timeslot => timeslot.fulfillment_date === date.value)\n    : timeslots\n\n  const times = filteredTimeslots.map(({ timeslot }) => {\n    return {\n      value: timeslot.id || timeslots.ext_id,\n      label: langService.interpolate(lang.timeslotTimeOptionLabel, {\n        from: timeslot.from_time,\n        to: timeslot.to_time,\n      }),\n      ...timeslot,\n    }\n  })\n\n  return { days, timeslots: times }\n}\n\nconst TimeslotSelect = ({ query, type, dateFormat, onChange, inputSize }) => {\n  const styles = useStyles()\n  const [selectedDate, setSelectedDate] = useState(null)\n  const [selectedTimeslot, setSelectedTimeslot] = useState(null)\n  const { data } = useTimeslotsQuery(type, query)\n  const handleTimeslotChange = timeslot => {\n    setSelectedTimeslot(timeslot)\n    onChange(timeslot)\n  }\n  const handleDateChange = date => {\n    setSelectedDate(date)\n    setSelectedTimeslot(null)\n  }\n\n  const memoizedTimeslotOptions = useCallback(\n    () =>\n      getTimeslotOptions({\n        date: selectedDate,\n        timeslots: data.items,\n        options: { dateFormat },\n      }),\n    [data.items, selectedDate, dateFormat]\n  )\n\n  const { days, timeslots } = memoizedTimeslotOptions()\n\n  return (\n    <GridContainer data-test=\"timeslot-select-container\">\n      <InputGroup>\n        <FormLabel css={[styles.labels]}>\n          {langService.interpolate(lang.timeslotDateLabel, {\n            fulfillmentType: query.fulfillment_type,\n          })}\n        </FormLabel>\n        <Select\n          inputSize={inputSize}\n          data-test=\"timeslots-select-date\"\n          onChange={handleDateChange}\n          options={days}\n        />\n      </InputGroup>\n\n      <InputGroup>\n        <FormLabel css={[styles.labels]}>\n          {langService.interpolate(lang.timeslotTimeLabel, {\n            fulfillmentType: query.fulfillment_type,\n          })}\n        </FormLabel>\n        <Select\n          inputSize={inputSize}\n          native={utilsService.isMobile()}\n          data-test=\"timeslots-select-time\"\n          disabled={!selectedDate}\n          value={selectedTimeslot}\n          onChange={handleTimeslotChange}\n          options={timeslots}\n        />\n      </InputGroup>\n    </GridContainer>\n  )\n}\n\nconst groceryQuery = PropTypes.shape({\n  above_threshold: PropTypes.bool,\n  cart_id: PropTypes.number,\n  filter_product_blackouts_timeslots: PropTypes.bool,\n  fulfillment_type: PropTypes.oneOf(['pickup', 'delivery']),\n  user_timezone: PropTypes.isRequired,\n})\n\nconst cateringQuery = PropTypes.shape({\n  store_id: PropTypes.number.isRequired,\n  fulfillment_type: PropTypes.oneOf(['pickup', 'delivery']),\n  shopping_mode: PropTypes.oneOf(['catering', 'grocery']),\n  user_timezone: PropTypes.string.isRequired,\n})\n\nTimeslotSelect.propTypes = {\n  dateFormat: PropTypes.string,\n  onChange: PropTypes.func.isRequired,\n  query: PropTypes.oneOfType([groceryQuery, cateringQuery]),\n  inputSize: PropTypes.oneOf(['small', 'regular']),\n  type: PropTypes.oneOf(['catering', 'grocery']),\n}\n\nTimeslotSelect.defaultProps = {\n  inputSize: 'regular',\n  dateFormat: DATE_FORMAT,\n}\n\nexport default TimeslotSelect\n","/* eslint-disable complexity */\nimport React, { memo, forwardRef, useState, useMemo } from 'react'\n\nimport PropTypes from 'prop-types'\n\nimport {\n  Button,\n  createStyles,\n  Text,\n  utils,\n  GridContainer,\n  GridItem,\n  Alert,\n  LoadingDots,\n  useMediaQuery,\n} from '@instacart/cocktail'\n\nimport { FULFILLMENT_TYPES } from '@app/angular/constants/checkout'\nimport { getMainLabel } from '../utils'\nimport { TIMESLOT_FEES, TIMESLOT_POLYTYPES } from '../constants'\n\nconst isHideTimeslotFee = (timeslot, showTimeslotPickupFeeAsFree) =>\n  timeslot.fulfillment_type === FULFILLMENT_TYPES.PICKUP && !showTimeslotPickupFeeAsFree\n\nconst useStyles = props =>\n  createStyles(tokens => ({\n    root: {\n      color: tokens.color.text.primary,\n      borderRadius: tokens.border.radius.small,\n      width: '100%',\n      border: utils.toPx`${tokens.border.width.regular} solid ${tokens.color.border.light}`,\n      backgroundColor: tokens.color.neutral.white,\n      textAlign: 'center',\n      margin: tokens.size.spacing.none,\n      '&:hover': {\n        backgroundColor: tokens.color.neutral.grey1,\n        cursor: 'pointer',\n      },\n      [utils.mediaQuery.maxWidth(tokens.breakpoint.small)]: {\n        border: 'none',\n        borderBottom: utils.toPx`${tokens.border.width.regular} solid ${tokens.color.border.light}`,\n      },\n    },\n    buttonSelected: {\n      border: utils.toPx`${tokens.border.width.regular} solid ${tokens.color.brand.primary.regular}`,\n    },\n    timeRangeText: {\n      fontWeight: tokens.font.weight.bold,\n    },\n    selectButton: {\n      pointerEvents: 'none',\n      minWidth: 90,\n    },\n    readOnly: {\n      '&:hover': {\n        backgroundColor: tokens.color.neutral.white,\n        cursor: 'default',\n      },\n    },\n    error: {\n      paddingTop: 0,\n      textAlign: 'initial',\n    },\n    timeLabel: {\n      textAlign: 'left',\n      paddingLeft: isHideTimeslotFee(props.timeSlot.timeslot, props.showTimeslotPickupFeeAsFree)\n        ? 0\n        : tokens.size.spacing.xxLarge,\n      [utils.mediaQuery.maxWidth(tokens.breakpoint.small)]: {\n        paddingLeft: 0,\n      },\n    },\n    unavailableText: {\n      color: tokens.color.ui.error,\n    },\n    unavailable: {\n      color: tokens.color.text.secondary,\n    },\n    unavailableReason: {\n      fontFamily: tokens.font.family.primary,\n      color: tokens.color.text.secondary,\n      paddingLeft: tokens.size.spacing.xxLarge,\n      textAlign: 'left',\n    },\n    showDetailButtonOverrides: {\n      border: 'none',\n      backgroundColor: 'transparent',\n      padding: 0,\n      fontFamily: tokens.font.family.primary,\n      color: tokens.color.text.secondary,\n      '&:hover': {\n        cursor: 'pointer',\n      },\n    },\n  }))(props)\n\nexport const defaultLang = {\n  selected: 'Selected',\n  select: 'Select',\n  noAlcohol: 'No Alcohol',\n  unavailable: 'Unavailable',\n  hideDetail: 'Hide detail',\n  showDetail: 'Show detail',\n  withinHours: 'Within {{hours}} hour{{plural}}',\n  free: 'Free',\n  highDemand: 'Demand is high, your order will be taken by the first available shopper.',\n  blackoutUnavailableReason: 'There are items in your cart that are unavailable during this time.',\n}\n\nconst TimeSlot = forwardRef((props, ref) => {\n  const styles = useStyles(props)\n  const {\n    timeSlot,\n    isSelected,\n    i18n,\n    onSelected,\n    readOnly,\n    error,\n    isAttemptingToSelect,\n    showTimeslotPickupFeeAsFree = true,\n    ...restProps\n  } = props\n\n  const lang = useMemo(() => ({ ...defaultLang, ...i18n }), [i18n])\n  const slotIsUnavailable = !!(\n    timeSlot.timeslot?.unavailable ||\n    timeSlot.timeslot?.unavailability_reasons?.length ||\n    timeSlot.timeslot?.during_blackout\n  )\n  const handleSelection = () => {\n    if (!readOnly && !error && !slotIsUnavailable) {\n      onSelected(timeSlot)\n    }\n  }\n  const onKeyDown = event => {\n    if (event.key === 'Enter' || event.key === 'Spacebar' || event.key === ' ') {\n      handleSelection()\n    }\n  }\n  const [showUnavailableDetail, setShowUnavailableDetail] = useState(false)\n  const isMobile = useMediaQuery(tokens => utils.mediaQuery.maxWidth(tokens.breakpoint.small))\n  const hideFreeText = isHideTimeslotFee(timeSlot.timeslot, showTimeslotPickupFeeAsFree)\n\n  const formatFeePrice = ({ timeslot }) => {\n    const shoppingModeFee =\n      timeslot[TIMESLOT_FEES[timeslot.source][timeslot.fulfillment_type] || TIMESLOT_FEES.DEFAULT]\n\n    const freeText = hideFreeText ? '' : lang.free\n\n    return timeslot.is_free || parseFloat(shoppingModeFee) === 0\n      ? freeText\n      : utils.formatCurrency(shoppingModeFee)\n  }\n\n  const pickupFee = (\n    <span>\n      <Text component=\"span\" variant=\"body\" css={styles.fee} data-test=\"time-slot-fee\">\n        {formatFeePrice(timeSlot)}\n      </Text>\n    </span>\n  )\n\n  const handleUnavailableClick = e => {\n    e.stopPropagation()\n    setShowUnavailableDetail(!showUnavailableDetail)\n  }\n\n  const unavailabilityReasons = useMemo(\n    () =>\n      [\n        ...(timeSlot.timeslot?.unavailability_reasons || []),\n        timeSlot.timeslot?.during_blackout ? lang.blackoutUnavailableReason : null,\n      ].filter(reason => reason),\n    [timeSlot, lang]\n  )\n\n  return (\n    <GridContainer\n      ref={ref}\n      css={[\n        styles.root,\n        isSelected ? styles.buttonSelected : {},\n        readOnly || error ? styles.readOnly : {},\n      ]}\n      justify=\"space-evenly\"\n      align=\"center\"\n      onClick={() => handleSelection()}\n      onKeyDown={onKeyDown}\n      {...restProps}\n    >\n      <GridItem\n        xSmall={readOnly && !slotIsUnavailable ? 12 : 8}\n        small={slotIsUnavailable || readOnly ? 8 : 5}\n      >\n        <div css={[styles.timeLabel, slotIsUnavailable ? styles.unavailable : {}]}>\n          <Text bold data-test=\"time-slot-main-label\">\n            {getMainLabel(timeSlot, { showDate: false })}\n          </Text>\n          {/* We need to treat null as true here, as BE will return null for some retailers */}\n          {!timeSlot.timeslot.allow_alcohol && timeSlot.timeslot.allow_alcohol !== null && (\n            <Text variant=\"caption\" data-test=\"time-slot-no-alcohol-label\">\n              {lang.noAlcohol}\n            </Text>\n          )}\n          {timeSlot.timeslot.polytype === TIMESLOT_POLYTYPES.ASAP && (\n            <Text data-test=\"time-slot-high-demand-label\" variant=\"caption\">\n              {lang.highDemand}\n            </Text>\n          )}\n          {!!timeSlot.timeslot.during_blackout && (\n            <Text data-test=\"time-slot-high-demand-label\" variant=\"caption\">\n              {lang.unavailable}\n            </Text>\n          )}\n\n          {slotIsUnavailable ? (\n            <button\n              css={styles.showDetailButtonOverrides}\n              data-test=\"show-hide-detail\"\n              onClick={handleUnavailableClick}\n            >\n              <Text>{showUnavailableDetail ? lang.hideDetail : lang.showDetail}</Text>\n            </button>\n          ) : (\n            <></>\n          )}\n          {!slotIsUnavailable && isMobile ? pickupFee : <></>}\n        </div>\n      </GridItem>\n\n      {!isMobile && !slotIsUnavailable ? <GridItem small={3}>{pickupFee}</GridItem> : <></>}\n\n      {!slotIsUnavailable && !readOnly ? (\n        <GridItem xSmall={4}>\n          <Button\n            aria-current={isSelected}\n            variant={isSelected ? 'filled' : 'outline'}\n            css={styles.selectButton}\n            data-test=\"time-slot-select-button\"\n            disabled={error}\n          >\n            {isAttemptingToSelect && !error ? (\n              <LoadingDots />\n            ) : isSelected ? (\n              lang.selected\n            ) : (\n              lang.select\n            )}\n          </Button>\n        </GridItem>\n      ) : slotIsUnavailable ? (\n        <GridItem xSmall={4}>\n          <Text data-test=\"time-slot-unavailable\" css={styles.unavailableText}>\n            {lang.unavailable}\n          </Text>\n        </GridItem>\n      ) : (\n        <></>\n      )}\n\n      {error ? (\n        <GridItem xSmall={12} css={styles.error} data-test=\"time-slot-error\">\n          <Alert variant=\"error\">{error.message}</Alert>\n        </GridItem>\n      ) : (\n        <></>\n      )}\n      {slotIsUnavailable && showUnavailableDetail && unavailabilityReasons.length ? (\n        <GridItem xSmall={12} data-test=\"time-slot-unavailable-msg\">\n          {unavailabilityReasons.map(reason => (\n            <Text align=\"left\" variant=\"caption\" key={reason} style={styles.unavailableReason}>\n              {reason}\n            </Text>\n          ))}\n        </GridItem>\n      ) : (\n        <></>\n      )}\n    </GridContainer>\n  )\n})\n\nTimeSlot.propTypes = {\n  /** The timeslot to display */\n  // eslint-disable-next-line react/forbid-prop-types\n  timeSlot: PropTypes.object,\n  /** If the timeslot is selected */\n  isSelected: PropTypes.bool,\n  /** If the timeslot is attempting to be reserved */\n  isAttemptingToSelect: PropTypes.bool,\n  /** Custom lang object */\n  // eslint-disable-next-line react/forbid-prop-types\n  i18n: PropTypes.object,\n  /** Function to call when a timeslot is selected */\n  onSelected: PropTypes.func,\n  /** Makes the component look like text and not a button */\n  readOnly: PropTypes.bool,\n  /** Decide when to display pickup timeslot as free */\n  showTimeslotPickupFeeAsFree: PropTypes.bool,\n  /** The error to display on the time slot */\n  error: PropTypes.shape({\n    message: PropTypes.string.isRequired,\n  }),\n}\n\nexport default memo(TimeSlot)\n","import React, { memo, forwardRef } from 'react'\nimport PropTypes from 'prop-types'\nimport { Text, Button, createStyles } from '@instacart/cocktail'\n\nimport { TIMESLOT_POLYTYPES } from '../constants'\n\nimport { formatDayOfTheWeek, formatDayOfTheMonth } from '../utils'\n\nconst useStyles = createStyles(tokens => ({\n  root: {},\n  button: {\n    background: tokens.color.neutral.grey1,\n    color: tokens.color.brand.primary.dark,\n    height: tokens.size.layout.xLarge,\n    maxWidth: tokens.size.layout.xLarge + 16,\n    minWidth: tokens.size.layout.xLarge,\n    whiteSpace: 'normal',\n    '&:hover': {\n      backgroundColor: tokens.color.brand.primary.light,\n    },\n  },\n  buttonUnavailable: {\n    // Unfortunately, !important is required to override a web-frontend button style on `@keyframes appear`.\n    opacity: '0.5 !important',\n  },\n  buttonSelected: {\n    background: tokens.color.brand.primary.dark,\n    color: tokens.color.neutral.white,\n    '&:hover': {\n      backgroundColor: tokens.color.brand.primary.dark,\n    },\n  },\n  buttonNotSelected: {\n    '&:active': {\n      backgroundColor: 'transparent',\n      borderColor: tokens.color.brand.primary.dark,\n      color: tokens.color.brand.primary.dark,\n    },\n  },\n}))\n\nconst defaultLang = {\n  today: 'Today',\n  fastestPossible: 'Fastest Possible',\n  unavailable: 'Unavailable',\n}\n\nconst NAVIGATION_KEYS = [\n  'Enter',\n  'Spacebar',\n  ' ',\n  'ArrowRight',\n  'ArrowDown',\n  'ArrowLeft',\n  'ArrowUp',\n]\n\nconst Day = forwardRef((props, ref) => {\n  const styles = useStyles(props)\n  const { isSelected, day, i18n, onSelected, isUnavailable, ...restProps } = props\n  const lang = { ...defaultLang, ...i18n }\n  const onKeyDown = event => {\n    if (NAVIGATION_KEYS.includes(event.key)) {\n      return onSelected(event)\n    }\n  }\n\n  const dayTabLabel = `${formatDayOfTheMonth(day, 2)}${\n    isUnavailable ? ` (${lang.unavailable})` : ''\n  }`\n\n  const tabProps = {\n    ref,\n    onKeyDown,\n    role: 'tab',\n    onClick: onSelected,\n    'aria-selected': isSelected,\n    css: [\n      styles.button,\n      isSelected ? styles.buttonSelected : styles.buttonNotSelected,\n      styles.root,\n      isUnavailable && styles.buttonUnavailable,\n    ],\n    ...restProps,\n  }\n\n  if (!isSelected) tabProps.tabIndex = -1\n\n  return (\n    <Button aria-label={dayTabLabel} {...tabProps}>\n      {day === TIMESLOT_POLYTYPES.ASAP ? (\n        <Text data-test=\"day-asap\">{lang.fastestPossible}</Text>\n      ) : (\n        <span>\n          <Text variant=\"large\" bold data-test=\"day-of-week\">\n            {formatDayOfTheWeek(day, lang.today)}\n          </Text>\n          <Text variant=\"caption\" data-test=\"day-of-month\">\n            {formatDayOfTheMonth(day)}\n          </Text>\n        </span>\n      )}\n    </Button>\n  )\n})\n\nDay.propTypes = {\n  /** The day to display */\n  day: PropTypes.string.isRequired,\n  /** If the day is selected */\n  isSelected: PropTypes.bool,\n  /** If the day does not have any available timeslots */\n  isUnavailable: PropTypes.bool,\n  /** Custom lang object */\n  // eslint-disable-next-line react/forbid-prop-types\n  i18n: PropTypes.object,\n  /** Function to call when a day is selected */\n  onSelected: PropTypes.func,\n}\n\nexport default memo(Day)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { LoadingBlock, createStyles } from '@instacart/cocktail'\n\nconst loadingUseStyles = createStyles(tokens => ({\n  margins: {\n    marginBottom: tokens.size.layout.xxSmall,\n    marginTop: tokens.size.layout.xxSmall,\n  },\n  nowrap: {\n    overflow: 'hidden',\n    whiteSpace: 'nowrap',\n  },\n  inline: {\n    display: 'inline-block',\n  },\n  root: {\n    minHeight: 68,\n  },\n}))\n\nconst TimeSlotsLoading = ({ styles, alwaysShowAvailabilityCheckbox, ...restProps }) => {\n  const loadingStyles = loadingUseStyles(restProps)\n\n  return (\n    <div css={[styles.root, loadingStyles.root]} data-test=\"time-slots-loading\">\n      <div\n        css={[\n          styles.titleRow,\n          loadingStyles.margins,\n          !alwaysShowAvailabilityCheckbox ? styles.titleRowWithoutCheckbox : {},\n        ]}\n      >\n        {alwaysShowAvailabilityCheckbox ? (\n          <LoadingBlock shape=\"square\" height={20} width={180} />\n        ) : (\n          <></>\n        )}\n        <LoadingBlock shape=\"square\" height={32} width={180} css={styles.dayPager} />\n      </div>\n      <div css={[styles.days, loadingStyles.margins, loadingStyles.noWrap]}>\n        {Array(7)\n          .fill()\n          .map((val, index) => (\n            <LoadingBlock\n              // eslint-disable-next-line react/no-array-index-key\n              key={`day-loading-block-${index}`}\n              shape=\"square\"\n              css={[styles.day, loadingStyles.inline]}\n              height={64}\n              width={64}\n            />\n          ))}\n      </div>\n      <div>\n        {Array(6)\n          .fill()\n          .map((val, index) => (\n            <LoadingBlock\n              // eslint-disable-next-line react/no-array-index-key\n              key={`time-slot-loading-block-${index}`}\n              shape=\"square\"\n              height={42}\n              width={'100%'}\n              css={loadingStyles.margins}\n            />\n          ))}\n      </div>\n    </div>\n  )\n}\n\nTimeSlotsLoading.propTypes = {\n  /** The styles from the timeslots component */\n  styles: PropTypes.shape({\n    // eslint-disable-next-line react/forbid-prop-types\n    root: PropTypes.object,\n    // eslint-disable-next-line react/forbid-prop-types\n    titleRow: PropTypes.object,\n    // eslint-disable-next-line react/forbid-prop-types\n    dayPager: PropTypes.object,\n    // eslint-disable-next-line react/forbid-prop-types\n    days: PropTypes.object,\n    // eslint-disable-next-line react/forbid-prop-types\n    day: PropTypes.object,\n    // eslint-disable-next-line react/forbid-prop-types\n    title: PropTypes.object,\n    // eslint-disable-next-line react/forbid-prop-types\n    titleRowWithoutCheckbox: PropTypes.object,\n  }),\n  /** Shows only available timeslots and takes away the unavailable functionality */\n  alwaysShowAvailabilityCheckbox: PropTypes.bool,\n}\n\nexport default TimeSlotsLoading\n","import React, { memo, useState, useEffect, useMemo, useRef, useCallback } from 'react'\nimport PropTypes from 'prop-types'\nimport { keyframes } from '@emotion/core'\n\nimport {\n  createStyles,\n  Pager,\n  Button,\n  List,\n  ListItem,\n  utils,\n  useMediaQuery,\n  Checkbox,\n  Text,\n  Alert,\n} from '@instacart/cocktail'\nimport { useConfig } from '@app/services/config/hooks'\nimport TimeSlot from './TimeSlot'\nimport Day from './Day'\nimport TimeSlotsLoading from './TimeSlotsLoading'\n\nimport {\n  isEqualDay,\n  isEqualTimeSlot,\n  getUniqIdFromTimeSlot,\n  getTimeSlotFromUniqId,\n  isTimeSlotBetween,\n  getTimeSlotId,\n} from '../utils'\nimport { TIMESLOT_POLYTYPES } from '../constants'\n\nconst DAYS_PER_PAGE = 7\nconst TIMESLOTS_PER_PAGE = 6\n\nconst fadeIn = keyframes({\n  '0%': {\n    opacity: 0,\n  },\n  '100%': {\n    opacity: 1,\n  },\n})\n\nconst NAVIGATION_KEY_STEPS_MAP = {\n  ArrowUp: -1,\n  ArrowLeft: -1,\n  ArrowDown: 1,\n  ArrowRight: 1,\n  Enter: 0,\n  Spacebar: 0,\n}\n\nconst useStyles = createStyles(tokens => ({\n  root: {\n    width: '100%',\n  },\n  titleRow: {\n    display: 'flex',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n  },\n  titleRowWithoutCheckbox: {\n    justifyContent: 'flex-end',\n  },\n  dayPager: {\n    maxWidth: '240px',\n    minWidth: '220px',\n    [utils.mediaQuery.maxWidth(tokens.breakpoint.small)]: {\n      display: 'none',\n    },\n  },\n  day: {\n    marginRight: tokens.size.spacing.xxSmall,\n  },\n  days: {\n    whiteSpace: 'nowrap',\n    overflow: 'auto',\n    marginBottom: tokens.size.spacing.small,\n    paddingTop: tokens.size.spacing.xxxSmall,\n    paddingBottom: tokens.size.spacing.xxxSmall,\n  },\n  moreTimesButton: {\n    width: '100%',\n    borderRadius: tokens.border.radius.small,\n    margin: tokens.size.spacing.none,\n    padding: tokens.size.spacing.none,\n    '&:hover': {\n      backgroundColor: tokens.color.neutral.grey1,\n    },\n  },\n  availabilityCheckbox: {\n    padding: utils.toPx`${tokens.size.spacing.medium} 0`,\n  },\n  noTimeslotsHeader: {\n    paddingBottom: tokens.size.spacing.xxSmall,\n  },\n  timeslot: {\n    animation: `${fadeIn} 0.2s ease 1`,\n  },\n  timeslotListItem: {\n    padding: '0',\n  },\n  timeslotsList: {\n    listStyle: 'none',\n    padding: '0',\n  },\n  noTimeslotsDayMessage: {\n    fontSize: tokens.size.font.body,\n    padding: tokens.size.spacing.small,\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  goToCartButton: {\n    padding: tokens.size.spacing.small,\n    display: 'block',\n  },\n  rxWarning: {\n    borderRadius: tokens.border.radius.regular,\n    backgroundColor: `${tokens.color.ui.warning} !important`,\n    color: `${tokens.color.text.primary} !important`,\n    textAlign: 'center',\n    padding: tokens.size.spacing.small,\n    fontWeight: tokens.font.weight.bold,\n  },\n}))\n\nconst defaultLang = {\n  availabilityCheckboxLabel: 'Available Timeslots Only',\n  moreTimes: 'More Times',\n  nextWeek: 'Next Week',\n  previousWeek: 'Previous Week',\n  changeWeek: 'Change Week',\n  noTimeslotAvailable: 'No Timeslot Available',\n  noTimeslotsForDayError: 'There are no time slots available on this day.',\n  noTimeslotsAvailableMessage:\n    'Demand is higher than normal right now, so service times may not be available. Please check back later.',\n  goToCart: 'Go to cart',\n  rxWarning: 'Recipient must have an ID and be 18+ to accept prescriptions',\n  aria: {\n    daySelection: 'Day selection',\n  },\n}\n\nconst TimeSlots = props => {\n  const {\n    timeSlots,\n    onTimeSlotSelected,\n    onDaySelected,\n    onGoToCart,\n    onWeekChanged,\n    selectedTimeSlot,\n    i18n,\n    readOnly,\n    error,\n    alwaysShowAvailabilityCheckbox,\n    availabilityCheckboxThreshold,\n    isLoading,\n    hasRxItem,\n    ...restProps\n  } = props\n  const lang = { ...defaultLang, ...i18n }\n  const styles = useStyles(props)\n  const isSmallBreakpoint = useMediaQuery(tokens =>\n    utils.mediaQuery.maxWidth(tokens.breakpoint.small)\n  )\n  const firstTimeSlotAfterMoreTimes = useRef(null)\n  const timeslotsContainer = useRef(null)\n  const dayTabs = useRef(null)\n\n  const days = useMemo(() => {\n    return [\n      ...(timeSlots.find(timeSlot => timeSlot.timeslot.polytype === TIMESLOT_POLYTYPES.ASAP)\n        ? [TIMESLOT_POLYTYPES.ASAP]\n        : []),\n      ...new Set(timeSlots.map(({ fulfillment_date }) => fulfillment_date)),\n    ]\n  }, [timeSlots])\n\n  const [page, setPage] = useState(1)\n  const [onlyShowAvailableTimes, setOnlyShowAvailableTimes] = useState(true)\n  const [showAllTimeSlots, setShowAllTimeSlots] = useState(false)\n  const [selectedDay, setSelectedDay] = useState(null)\n  const [attemptingToSelectTimeSlotId, setAttemptingToSelectTimeSlotId] = useState(null)\n\n  const isTimeslotAvailable = timeslot => !(timeslot.unavailable || timeslot.during_blackout)\n\n  // Gets the number of unavailable timeslots, for each day, days that are entirely unavailable,\n  // and max unavailable overall count for any given day.\n  const unavailabilities = useMemo(\n    () =>\n      timeSlots.reduce(\n        (\n          { unavailableCountByDay, dayUnavailability, maxUnavailableCountByDay },\n          { timeslot, fulfillment_date: dayKey }\n        ) => {\n          const isAvailable = isTimeslotAvailable(timeslot)\n\n          const unavailableCount = (unavailableCountByDay[dayKey] || 0) + (isAvailable ? 0 : 1)\n\n          // A day is unavailable if all timeslots for that day are unavailable.\n          const currentDayUnavailability =\n            dayUnavailability[dayKey] === undefined || dayUnavailability[dayKey]\n              ? !isAvailable\n              : false\n\n          return {\n            dayUnavailability: { ...dayUnavailability, [dayKey]: currentDayUnavailability },\n            unavailableCountByDay: { ...unavailableCountByDay, [dayKey]: unavailableCount },\n            maxUnavailableCountByDay: Math.max(unavailableCount, maxUnavailableCountByDay),\n          }\n        },\n        { dayUnavailability: {}, unavailableCountByDay: {}, maxUnavailableCountByDay: 0 }\n      ),\n    [timeSlots]\n  )\n\n  const getFirstAvailableDay = useCallback(\n    (currentPage = page) => {\n      const daysForPage = days.slice((currentPage - 1) * DAYS_PER_PAGE, currentPage * DAYS_PER_PAGE)\n\n      return (\n        daysForPage.reduce((availableDay, day) => {\n          return !availableDay && !unavailabilities.dayUnavailability[day] ? day : availableDay\n        }, null) || daysForPage[0]\n      )\n    },\n    [unavailabilities, days, page]\n  )\n\n  useEffect(() => {\n    if (selectedDay) return\n\n    if (selectedTimeSlot && selectedTimeSlot.timeslot.polytype === TIMESLOT_POLYTYPES.ASAP) {\n      setSelectedDay(TIMESLOT_POLYTYPES.ASAP)\n    } else if (selectedTimeSlot && isTimeSlotBetween(selectedTimeSlot, timeSlots)) {\n      setSelectedDay(selectedTimeSlot?.fulfillment_date)\n    } else {\n      setSelectedDay(getFirstAvailableDay())\n    }\n  }, [days, selectedTimeSlot, timeSlots, selectedDay, getFirstAvailableDay])\n\n  useEffect(() => {\n    if (attemptingToSelectTimeSlotId) {\n      const attemptingToSelectTimeSlot = getTimeSlotFromUniqId(\n        attemptingToSelectTimeSlotId,\n        timeSlots\n      )\n      if (\n        isEqualTimeSlot(attemptingToSelectTimeSlot, selectedTimeSlot) ||\n        isEqualTimeSlot(attemptingToSelectTimeSlot, error?.payload?.invalid_params?.timeslot)\n      ) {\n        setAttemptingToSelectTimeSlotId(null)\n      }\n    }\n  }, [selectedTimeSlot, attemptingToSelectTimeSlotId, timeSlots, error])\n\n  useEffect(() => {\n    return firstTimeSlotAfterMoreTimes?.current?.focus()\n  }, [showAllTimeSlots])\n\n  const createDaysItems = (newPage = 1, showAllDays = false) => {\n    const visibleDays = !showAllDays\n      ? days.slice((newPage - 1) * DAYS_PER_PAGE, newPage * DAYS_PER_PAGE)\n      : days\n\n    return visibleDays.map((day, i) => {\n      return (\n        <Day\n          key={day}\n          day={day}\n          css={styles.day}\n          onSelected={event => {\n            const step = NAVIGATION_KEY_STEPS_MAP[event.key]\n            const selectedDayIndex = visibleDays.findIndex(e => e === selectedDay)\n            const selectDay = visibleDays[selectedDayIndex + step] || day\n\n            event.stopPropagation()\n            event.preventDefault()\n\n            setShowAllTimeSlots(false)\n            setSelectedDay(selectDay)\n            onDaySelected(selectDay)\n\n            if (step === 0 && event.type === 'keydown') {\n              timeslotsContainer.current.focus()\n            } else if (typeof step === 'number') {\n              dayTabs.current.querySelector(`#reservation-select-day-${selectDay}`).focus()\n            }\n          }}\n          isUnavailable={unavailabilities.dayUnavailability[day]}\n          isSelected={selectedDay === day}\n          i18n={lang.day}\n          data-test={`day-${i}`}\n          id={`reservation-select-day-${day}`}\n          role=\"tab\"\n          aria-controls={`timeslots-${day}`}\n          {...restProps}\n        />\n      )\n    })\n  }\n\n  const timeSlotsDay = timeSlots.filter(\n    ({ fulfillment_date, timeslot }) =>\n      isEqualDay(fulfillment_date, selectedDay) || timeslot.polytype === selectedDay\n  )\n  const handleTimeSlotSelected = timeSlot => {\n    setAttemptingToSelectTimeSlotId(getUniqIdFromTimeSlot(timeSlot))\n    onTimeSlotSelected(timeSlot)\n  }\n\n  const showAvailabilityCheckbox = useMemo(() => {\n    if (alwaysShowAvailabilityCheckbox) return true\n\n    if (!availabilityCheckboxThreshold) return false\n\n    return unavailabilities.maxUnavailableCountByDay >= availabilityCheckboxThreshold\n  }, [unavailabilities, alwaysShowAvailabilityCheckbox, availabilityCheckboxThreshold])\n\n  const filteredTimeslotsForDay = timeSlotsDay.filter(\n    ({ timeslot }) =>\n      !(showAvailabilityCheckbox && onlyShowAvailableTimes) || isTimeslotAvailable(timeslot)\n  )\n\n  const {\n    shoppingContextProcess: {\n      pickup: { showTimeslotFeeAsFree: showTimeslotPickupFeeAsFree },\n    },\n  } = useConfig()\n  const createTimeSlotItems = (showAll = false) => {\n    return (\n      filteredTimeslotsForDay\n        .filter(({ timeslot }) =>\n          selectedDay === TIMESLOT_POLYTYPES.ASAP\n            ? timeslot.polytype === TIMESLOT_POLYTYPES.ASAP\n            : timeslot.polytype !== TIMESLOT_POLYTYPES.ASAP\n        )\n        .slice(0, showAll ? filteredTimeslotsForDay.length : TIMESLOTS_PER_PAGE)\n        // Sort the time slots so that the time slots within_hours are at the top\n        .sort((a, b) =>\n          a.timeslot.within_hours && b.timeslot.within_hours\n            ? 0\n            : a.timeslot.within_hours\n            ? -1\n            : b.timeslot.within_hours\n            ? 1\n            : 0\n        )\n        .map((timeSlot, i) => {\n          const timeSlotProps = { timeSlot, readOnly, showTimeslotPickupFeeAsFree }\n          return (\n            <ListItem css={styles.timeslotListItem} key={getTimeSlotId(timeSlot)}>\n              <TimeSlot\n                {...timeSlotProps}\n                isSelected={isEqualTimeSlot(selectedTimeSlot, timeSlot)}\n                onSelected={handleTimeSlotSelected}\n                i18n={lang.timeSlot}\n                data-test={`time-slot-${i}`}\n                error={\n                  error && isEqualTimeSlot(error.payload?.invalid_params?.timeslot, timeSlot)\n                    ? error\n                    : null\n                }\n                isAttemptingToSelect={isEqualTimeSlot(\n                  getTimeSlotFromUniqId(attemptingToSelectTimeSlotId, timeSlots),\n                  timeSlot\n                )}\n                ref={i === TIMESLOTS_PER_PAGE ? firstTimeSlotAfterMoreTimes : null}\n                css={styles.timeslot}\n                {...restProps}\n              />\n            </ListItem>\n          )\n        })\n    )\n  }\n\n  if (isLoading) return <TimeSlotsLoading styles={styles} />\n\n  return timeSlots.length > 0 ? (\n    <div css={styles.root} {...restProps}>\n      {hasRxItem ? <p css={styles.rxWarning}>{lang.rxWarning}</p> : <></>}\n\n      <div css={[styles.titleRow, !showAvailabilityCheckbox ? styles.titleRowWithoutCheckbox : {}]}>\n        {showAvailabilityCheckbox ? (\n          <Checkbox\n            id=\"availability-checkbox\"\n            data-test=\"availability-checkbox\"\n            checked={onlyShowAvailableTimes}\n            onChange={event => setOnlyShowAvailableTimes(event.target.checked)}\n            inputSize=\"small\"\n            css={styles.availabilityCheckbox}\n          >\n            {lang.availabilityCheckboxLabel}\n          </Checkbox>\n        ) : (\n          <></>\n        )}\n\n        <Pager\n          currentPage={page}\n          pageCount={Math.ceil(days.length / DAYS_PER_PAGE)}\n          onPageClick={newPage => {\n            setShowAllTimeSlots(false)\n            setPage(newPage)\n            // This sets the day to the first day of the new week\n            setSelectedDay(getFirstAvailableDay(newPage))\n            onWeekChanged({ currentPage: page, newPage })\n          }}\n          css={styles.dayPager}\n          showPageCount={false}\n          previousLinkLabel={lang.previousWeek}\n          nextLinkLabel={lang.nextWeek}\n          aria-label={lang.changeWeek}\n          data-test=\"time-slots-pager\"\n        />\n      </div>\n      <div ref={dayTabs} css={styles.days} role=\"tablist\" aria-label={lang.aria.daySelection}>\n        {createDaysItems(page, isSmallBreakpoint)}\n      </div>\n      <div\n        role=\"tabpanel\"\n        aria-labelledby={`reservation-select-day-${selectedDay}`}\n        id={`timeslots-${selectedDay}`}\n      >\n        <List css={styles.timeslotsList} ref={timeslotsContainer}>\n          {filteredTimeslotsForDay.length > 0 ? (\n            createTimeSlotItems(showAllTimeSlots, selectedDay)\n          ) : (\n            <ListItem css={styles.noTimeslotsDayMessage}>{lang.noTimeslotsForDayError}</ListItem>\n          )}\n        </List>\n      </div>\n      {!showAllTimeSlots && filteredTimeslotsForDay.length > TIMESLOTS_PER_PAGE && (\n        <Button\n          iconAfter=\"icon-chevron-down\"\n          iconSize=\"small\"\n          variant=\"link\"\n          css={styles.moreTimesButton}\n          onClick={() => setShowAllTimeSlots(true)}\n          data-test=\"time-slots-more-times\"\n        >\n          {lang.moreTimes}\n        </Button>\n      )}\n    </div>\n  ) : (\n    <div>\n      <Text css={styles.noTimeslotsHeader} variant=\"large\">\n        {lang.noTimeslotAvailable}\n      </Text>\n      <Alert data-test=\"empty-state-message\" variant=\"warning\">\n        {lang.noTimeslotsAvailableMessage}\n        <Button css={styles.goToCartButton} onClick={() => onGoToCart()}>\n          {lang.goToCart}\n        </Button>\n      </Alert>\n    </div>\n  )\n}\n\nTimeSlots.propTypes = {\n  /** The array of time slots */\n  // eslint-disable-next-line react/forbid-prop-types\n  timeSlots: PropTypes.array.isRequired,\n  /** Callback for when a timeslot is selected */\n  onTimeSlotSelected: PropTypes.func,\n  /** Callback for when a day is selected */\n  onDaySelected: PropTypes.func,\n  /** Callback for the go to cart button is pressed */\n  onGoToCart: PropTypes.func,\n  /** Callback for when the week is changed */\n  onWeekChanged: PropTypes.func,\n  /** The currently selected time slot */\n  // eslint-disable-next-line react/forbid-prop-types\n  selectedTimeSlot: PropTypes.object,\n  /** Custom lang object */\n  // eslint-disable-next-line react/forbid-prop-types\n  i18n: PropTypes.object,\n  /** Makes the component look like text an stops callbacks */\n  readOnly: PropTypes.bool,\n  /** error to display inline with the timeslot that is unavailable */\n  // eslint-disable-next-line react/forbid-prop-types\n  error: PropTypes.object,\n  /** If enabled, the toggle to show or hide availability will always be visible */\n  alwaysShowAvailabilityCheckbox: PropTypes.bool,\n  /** If the number of unavailable timeslots on any day passes this threshold,\n   * then the toggle to show or hide availability will become visible.\n   * Set to 0 to disable. */\n  availabilityCheckboxThreshold: PropTypes.number,\n  /** Whether to show loading state */\n  isLoading: PropTypes.bool,\n  /** Whether to show pertinent information for RX */\n  hasRxItem: PropTypes.bool,\n}\n\nTimeSlots.defaultProps = {\n  onDaySelected: () => {},\n  onWeekChanged: () => {},\n  alwaysShowAvailabilityCheckbox: false,\n  availabilityCheckboxThreshold: 0,\n  isLoading: false,\n}\n\nexport default memo(TimeSlots)\n","import TimeSlots from './TimeSlots'\n\nexport default TimeSlots\n","module.exports = \"<div class=related-coupon> <div class=info> <a ui-sref=\\\"main.offers.details({offerId: coupon.id})\\\" class=title analytics-click=\\\"['coupon overlay link', 'click']\\\"> {{coupon.name}} </a> </div> <div coupon-clipper coupon=coupon couponclass=\\\"'coup-offer-page'\\\"></div> </div> \";","module.exports = \"<div class=collections-previews> <div page-header label=tree.current.name breadcrumbs=breadcrumbs></div> <div ng-if=mobile.isMobile ng-include=\\\"'shopMenu.mobile.html'\\\"></div> <div ng-if=!collections fixed-to-body class=view-loading-indicator></div> <div class=collections ng-if=\\\"collections.length > 0\\\"> <div ng-repeat=\\\"collection in collections\\\" class=collection-wrapper> <div class=collection ng-if=collection.items.length> <h2 class=section-divider> <span class=title>{{collection.name}}</span> </h2> <div cell-slider items=collection.items location=\\\"{{collection.name}} Collection\\\"></div> <div class=footer> <a ui-sref={{collection.sref}} analytics-click=\\\"['homepage collection see more button', 'click', $index]\\\" class=more>{{::lang.template(lang.values.seeMoreCollection, {name: collection.name})}}</a> </div> </div> <div class=request-login-container ng-if=\\\"!collection.items.length && auth.user.status === 'trial'\\\"> <div class=request-login-img-container> <div class=request-login-content-container> <span class=collection-title>{{collection.name}}</span> <button class=\\\"button sign-in-button\\\" ng-click=\\\"registrationService.open('login')\\\">{{::lang.values.login}}</button> </div> <img ng-if=::!mobile.isMobile src=\" + require(\"static/images/request-login.png\") + \" alt={{::lang.aria.requestLogin}}> <img ng-if=::mobile.isMobile src=\" + require(\"static/images/request-login-mobile.png\") + \" alt={{::lang.aria.requestLogin}}> </div> </div> </div> <div class=not-found ng-if=\\\"collections.length === 0\\\">{{::lang.values.noItemsFound}}</div> </div> </div> \";","module.exports = \"<div id=ic-express-post-checkout ng-if=\\\"$ctrl.hasSubscription !== true\\\" class={{::$ctrl.css()}} ng-class=\\\"$ctrl.enableRetailerTheme ? 'ic-express-post-checkout-retailer' : 'ic-express-post-checkout-instacart'\\\"> <div ng-if=\\\"$ctrl.hasSubscription === null\\\" class=\\\"{{::$ctrl.css('container')}}\\\"> <div class=\\\"{{::$ctrl.css('loading')}}\\\"> <div class=view-loading-indicator></div> <react-express-powered-by small=true></react-express-powered-by> </div> </div> <div ng-if=\\\"$ctrl.hasSubscription === false\\\" class=\\\"{{::$ctrl.css('container')}}\\\"> <div class=\\\"{{::$ctrl.css('left')}}\\\"> <span ng-if=$ctrl.mobileService.isMobile> <react-express-count-down small=true enableretailertheme=$ctrl.enableRetailerTheme class=ic-express__count-down></react-express-count-down> </span> <div class=\\\"{{::$ctrl.css('title')}}\\\">{{::$ctrl.title}}</div> <div class=\\\"{{::$ctrl.css('desc')}}\\\"> {{:: $ctrl.lang.templateAsString( $ctrl.subtitle, { express: $ctrl.config.icExpress.name } ) }} </div> <div class=ic-express-post-checkout__powered-by> <react-express-powered-by small=true></react-express-powered-by> </div> <span ng-repeat=\\\"item in $ctrl.list\\\"> <div class=\\\"{{::$ctrl.css('point-title')}}\\\">{{::item.title}}</div> <div class=\\\"{{::$ctrl.css('point-desc')}}\\\">{{::item.description}}</div> </span> <span class=\\\"{{::$ctrl.css('opt-in-ct')}}\\\"> <button class=\\\"button {{::$ctrl.css('opt-in')}}\\\" id=ic-express-post-checkout-button ng-class=\\\"{ 'view-loading-indicator': $ctrl.isSubscribing }\\\" ng-click=$ctrl.onClick() ng-disabled=$ctrl.isSubscribing> {{ $ctrl.lang.templateAsString( $ctrl.isTrialEligible ? $ctrl.buttonLabels.trialEligible : $ctrl.buttonLabels.trialIneligible, { days: $ctrl.config.icExpress.trialDays } ) }} </button> </span> <div class=\\\"{{::$ctrl.css('disclaimer')}}\\\" ng-bind-html=$ctrl.express.getTermsAndConditions()></div> </div> <div class=\\\"{{::$ctrl.css('right')}}\\\"> <span ng-if=!$ctrl.mobileService.isMobile> <react-express-count-down enableretailertheme=$ctrl.enableRetailerTheme class=ic-express__count-down></react-express-count-down> </span> <img alt={{::$ctrl.imageAlt}} class=\\\"{{::$ctrl.css('banner')}}\\\" ng-src=\\\"{{::$ctrl.utilService.loadInternalExternalAssets($ctrl.mobileService.isMobile ? $ctrl.imageMobile : $ctrl.image)}}\\\"/> </div> </div> </div> \";","module.exports = \"<div ng-if=::mobile.isMobile class=\\\"page-header-buttons search\\\"> <button ng-if=\\\"!state.is('main.shop.flyer')\\\" class=\\\"icon icon-filter\\\" ng-click=openFilterModal() aria-label={{::lang.aria.openFilterModal}}></button> </div> <div class=post-wrapper ng-if=\\\"searchContentResults && searchContentResults.length > 0 && !loading\\\"> <div class=post-preview ng-repeat=\\\"post in searchContentResults\\\" data-test=content-preview> <a href={{post.link}}> <div class=img-container ng-if=::!mobile.isMobile> <img src={{post.thumbnail}} alt={{post.thumbnail}}> </div> </a> <div class=container> <a href={{post.link}}> <h3 class=type>{{post.type}}</h3> <h2 class=title ng-bind-html=post.title></h2> </a> <p class=excerpt ng-bind-html=post.excerpt></p> </div> </div> </div> <div class=not-found ng-if=\\\"searchTotalLength == 0\\\"> {{::lang.template(lang.values.nothingFound, {searchResult: term.slice(0, 50)})}} </div> <div ng-if=\\\"!mobile.isMobile && !searchContentResults\\\" class=loading-shimmer> <img ng-repeat=\\\"post in skeletonPosts\\\" ng-src=\" + require(\"static/images/emt-post-img.svg\") + \" class=post-skeleton> </div> <div ng-if=\\\"mobile.isMobile && !searchContentResults\\\" class=loading-shimmer> <img ng-repeat=\\\"post in skeletonPosts\\\" ng-src=\" + require(\"static/images/emt-post-img-mobile.svg\") + \" class=post-skeleton> </div> <div class=\\\"text-center clearfix\\\" ng-if=\\\"searchTotalLength > 0\\\"> <ul uib-pagination ng-if=\\\"!mobile.isMobile && !loading && (searchTotalLength > config.dotComModule.searchPostsPerPage)\\\" previous-text=\\\"\\\" first-text=1 class=pagination boundary-links=true ng-model=contentSearchPagination.currentPage ng-change=changePage() items-per-page=config.dotComModule.searchPostsPerPage template-url=pagination-modified-uibootstrap-desktop.html total-items=searchTotalLength analytics-click=\\\"['search pagination', 'click']\\\"></ul> <ul uib-pagination ng-if=\\\"mobile.isMobile && !loading && (searchTotalLength > config.dotComModule.searchPostsPerPage)\\\" previous-text=Prev first-text=First class=pagination boundary-links=true ng-model=contentSearchPagination.currentPage ng-change=changePage() items-per-page=config.dotComModule.searchPostsPerPage template-url=pagination-modified-uibootstrap-mobile.html total-items=searchTotalLength analytics-click=\\\"['search pagination', 'click']\\\"></ul> </div> \";","module.exports = \"<div ng-if=$ctrl.hasErrors class=\\\"message error checkout-form__error-message\\\"> <span class=icon-error aria-hidden=true></span> {{::$ctrl.lang.values.fillRequiredInfoErrorMessage}} </div> <div ng-class=\\\"{\\n    'checkout-form--open': $ctrl.editMode,\\n    'checkout-form--closed': !$ctrl.editMode,\\n    'checkout-form--new-card': $ctrl.isNewCard\\n  }\\\" class=\\\"{{'checkout-form gateway-style_' + $ctrl.paymentCssClassName + ' gateway-type_' + $ctrl.payment.payment_type}}\\\"> <div ng-if=!$ctrl.editMode class=checkout-form__left> <ng-include class=icon src=\\\"::$ctrl.loadStaticImage('ic_card.svg')\\\" aria-hidden=true /> </div> <div class=checkout-form__right ng-show=\\\"\\n      !$ctrl.editMode &&\\n      !$ctrl.hideChevron &&\\n      !$ctrl.isSingleOption() &&\\n      !$ctrl.isModifyAndPaymentReadOnly()\\n    \\\"> <button class=checkout-form__edit-button id=payment-form-edit-button ng-click=$ctrl.enterEditMode() aria-label=\\\"{{ ::$ctrl.lang.values.expandSection }}: {{ ::$ctrl.lang.values.paymentMethod }}\\\"> </button> </div> <div class=\\\"checkout-form__content payment-form\\\"> <div class=checkout-form__content-header> <div ng-if=$ctrl.editMode> <ng-include class=icon src=\\\"::$ctrl.loadStaticImage('ic_card.svg')\\\"/> </div> <h2 class=checkout-form__title> {{ ::$ctrl.lang.values.paymentMethod }} </h2> </div> <div ng-if=$ctrl.shouldShowPaymentWarning() id=payment-warning class=\\\"message warn\\\"> <span class=icon-warning aria-hidden=true></span> {{::lang.values.paymentWarning}} </div> <div ng-if=!$ctrl.editMode class=checkout-form__readonly> <div class=checkout-form__payment-type> {{$ctrl.currentPaymentType}} </div> </div> <div class=checkout-form__payment-methods ng-if=$ctrl.editMode role=radiogroup aria-labelledby=select_pay> <div id=select_pay>{{::lang.values.pleaseSelectPaymentMethod}}</div> <span ng-if=\\\"$ctrl.getPaymentIntentTypes().length > 1\\\" ng-repeat=\\\"payType in $ctrl.getPaymentIntentTypes()\\\"> <input type=radio id=payment-type-{{::payType}} analytics-click=\\\"['checkout payment {{payType}} button', 'click']\\\" name=paymentMethod ng-model=$ctrl.payment.payment_type ng-value=payType ng-change=\\\"$ctrl.updatePaymentType(payType, true)\\\" aria-checked=\\\"{{$ctrl.payment.payment_type == payType}}\\\" role=radio class=radio data-test=payment-type-{{::payType}} /> <label for=payment-type-{{::payType}} class=\\\"payment-type-radio-label payment-type-{{::payType}}\\\"> <span>{{::$ctrl.getPaymentTypeString(payType)}}</span> </label> </span> </div> <div ng-if=\\\"$ctrl.fulfillmentType && $ctrl.selectedGateway && $ctrl.selectedGateway !== $ctrl.NOTHING_TO_SHOW_GATEWAY\\\" compile=$ctrl.selectedGateway class=\\\"{{'payment-gateway ' + $ctrl.paymentCssClassName}}\\\"> </div> <div class=gift-cards ng-if=\\\"$ctrl.config.showGiftCards && $ctrl.fulfillmentType && $ctrl.payment.gift_cards.length > 0\\\"> <div ng-if=!$ctrl.editMode class=checkout-form__gift-cards>{{lang.values.giftCards}}</div> <div ng-repeat=\\\"giftCard in $ctrl.payment.gift_cards track by $index\\\" class=gift-card> <button ng-if=$ctrl.editMode ng-click=$ctrl.removeGiftCard($index) class=\\\"remove-button icon-delete\\\" id=payment-gift-card-remove-{{::giftCard.card_number}} analytics-click=\\\"['checkout payment remove gift card button', 'click']\\\"></button> <span class=label> <span class=amount>{{giftCard.amount | currency}}</span> <span class=description> {{::lang.template(lang.values.fromGiftCardNew, { number: giftCard.card_number })}} </span> </span> </div> </div> <button ng-if=$ctrl.shouldShowGiftCardsLink() class=\\\"button checkout-gift-card link\\\" id=payment-form-add-gift-card-button ng-class=\\\"{ 'has-gift-cards': $ctrl.payment.gift_cards.length > 0 }\\\" ng-click=$ctrl.showAddGiftCard()> {{lang.values.giftCardHeader}} </button> <billing-information-form ng-if=\\\"\\n          $ctrl.editMode &&\\n          $ctrl.config.enableBillingInformation &&\\n          $ctrl.payment &&\\n          $ctrl.payment.payment_type === 'auth_capture' &&\\n          !$ctrl.isNewCard\\n        \\\" billing-address=$ctrl.services.auth.user.billing_address condensed=$ctrl.services.mobile.isMobile fulfillment-type=$ctrl.fulfillmentType same-as-delivery-address=$ctrl.services.checkout.isBillingAddressSameAsDelivery title={{::$ctrl.lang.values.billingAddress}}></billing-information-form> <button ng-if=$ctrl.shouldShowSaveButton() class=\\\"button checkout-save checkout-save-provided dark\\\" id=payment-form-choose-payment-button ng-click=$ctrl.doSave()> {{::$ctrl.lang.values.save}} </button> <div class=\\\"notice notice-block\\\" ng-if=\\\"$ctrl.editMode && $ctrl.doesPaymentTypeHaveAuth && $ctrl.showDeferredPaymentNotice\\\"> <i class=\\\"icon icon-info-i\\\"></i> <span> {{::$ctrl.lang.values.deferredAuthCaptureMessage}} </span> </div> </div> </div> \";","import type { RootState } from '../rootReducer'\n\nexport const userListsSelector = (state: RootState) => state.userLists.lists\n","module.exports = \"<div id=ic-express-entry class=ic-express-main ng-class=\\\"{ 'ic-express-main--retailer': $ctrl.config.icExpress.enableRetailerTheme }\\\" ng-if=!$ctrl.isLoading> <div class=ic-express-main__content> <div class=ic-express-main__header data-test=ic-express-main__header> <img class=ic-express-main__image ng-if=$ctrl.headerImage ng-src=\\\"{{ $ctrl.headerImage }}\\\" aria-hidden=true /> <div class=ic-express-main__title>{{ $ctrl.title }}</div> <div ng-if=\\\"$ctrl.currentStep !== $ctrl.EXPRESS_SUBSCRIPTION_STEPS.SUCCESS\\\" class=ic-express-main__sub-title ng-bind-html=$ctrl.subTitle></div> <div ng-if=\\\"$ctrl.currentStep === $ctrl.EXPRESS_SUBSCRIPTION_STEPS.SUCCESS\\\" class=ic-express-main__sub-title>{{:: $ctrl.config.icExpress.ad.successSubTitle }}</div> </div> <div class=ic-express-main__steps ng-switch=$ctrl.currentStep> <ic-express-ad ng-switch-when=AD list=$ctrl.adList on-cta-button-clicked=$ctrl.ctaButtonClicked() on-cta-link-button-clicked=$ctrl.ctaLinkButtonClicked() cta-button-label={{$ctrl.ctaButtonLabel}} cta-link-button-show=$ctrl.ctaLinkButtonShow cta-link-button-label={{$ctrl.ctaLinkButtonLabel}} cta-link-button-description={{$ctrl.ctaLinkButtonDescription}} enable-retailer-theme=$ctrl.config.icExpress.enableRetailerTheme cancellation-date={{$ctrl.express.getMembershipEndDate().format($ctrl.EXPIRATION_DATE_FORMAT)}} user-subscription-status=$ctrl.userSubscriptionStatus eligible-subscription-plans=$ctrl.eligibleSubscriptionPlans on-plan-selected-callback=$ctrl.planSelected , plan-id-to-subscribe-to=$ctrl.planIdToSubscribeTo></ic-express-ad> <div ng-switch-when=AD class=ic-express-main__cta-item ng-if=$ctrl.showGiftCardRedeemButton()> <a class=ic-express-main__cta-button ng-click=$ctrl.showGiftCardRedeemModal()> {{$ctrl.config.lang.icExpress.redeemGiftCard.showModalCTA}} </a> </div> <div ng-switch-when=AD class=ic-express-main__cta-item ng-if=$ctrl.showAccountLinkButton()> <a class=ic-express-main__cta-button ng-click=$ctrl.ctaLinkButtonClicked() uib-popover-html=$ctrl.ctaLinkButtonDescription popover-trigger=mouseenter> {{$ctrl.config.lang.icExpress.showExpressAccountLinkCTA}} </a> <div ng-if=$ctrl.mobileService.isMobile ng-bind-html=$ctrl.ctaLinkButtonDescription></div> </div> <ic-express-form ng-switch-when=FORM enable-retailer-theme=$ctrl.config.icExpress.enableRetailerTheme user-subscription-status=$ctrl.userSubscriptionStatus on-subscription-success=$ctrl.handleSubscriptionSuccess() on-cancel-form-click=$ctrl.previousStep() plan-id-to-subscribe-to=$ctrl.planIdToSubscribeTo></ic-express-form> <div id=ic-express-entry-success class=ic-express-main__success-step ng-switch-when=SUCCESS> <p> {{$ctrl.config.icExpress.ad.successMessage}} </p> <a id=ic-express-entry-redirect-button ng-class=\\\"{ 'ic-theme': $ctrl.useIcTheme }\\\" class=button ng-click=$ctrl.onClose()> {{$ctrl.config.lang.continueShopping}} </a> </div> </div> <react-express-footer powered-by-text=$ctrl.config.icExpress.footer.poweredByText></react-express-footer> </div> </div> \";","module.exports = \"<div class=ic-fulfillment-banner ng-class=\\\"{ 'ic-fulfillment-banner--ic': $ctrl.useIcTheme }\\\"> <react-express-powered-by powered-by-text=$ctrl.logoText small=true></react-express-powered-by> </div> \";","module.exports = \"<div class=price-alerts ng-if=!loading ng-switch=!_.isEmpty(categorizedPriceAlerts)> <table class=table ng-switch-when=true> <tbody ng-repeat=\\\"(category, items) in categorizedPriceAlerts\\\"> <tr class=category> <td colspan=5>{{category}}</td> </tr> <tr ng-repeat=\\\"item in items track by item.id\\\" id=\\\"price-alert-product-{{ item.id }}\\\" data-testid={{item.id}}> <td class=action> <button class=\\\"button smaller round darker icon-delete\\\" ng-click=deletePriceAlert(item.id) name=price-alert-delete aria-label=\\\"{{lang.aria.remove + ' ' + item.store_product.name}}\\\"></button> </td> <td role=button class=internal-link ng-click=\\\"productDetailsModal.open(item.store_product.id, { location: config.analyticsSourceKeys.priceAlerts })\\\" class=action name=price-alert-product-modal-trigger-img aria-label=\\\"{{lang.aria.openModal + ' ' + item.store_product.name}}\\\"> <div class=item-image ng-attr-style=\\\"background-image: url('{{::imageURLService.getProductImageURL(item.store_product, 'small')}}')\\\"></div> </td> <td role=button class=internal-link ng-click=\\\"productDetailsModal.open(item.store_product.id, { location: config.analyticsSourceKeys.priceAlerts })\\\" name=price-alert-product-modal-trigger-name aria-label=\\\"{{lang.aria.openModal + ' ' + item.store_product.name}}\\\"> <div class=item-name>{{item.store_product.name}}</div> </td> <td class=action> <span class=price-change ng-hide=!item.store_product.sale_price></span> </td> <td class=action> <button type=button ng-click=\\\"productDetailsModal.open(item.store_product.id, { location: config.analyticsSourceKeys.priceAlerts })\\\" class=product-link name=price-alert-product-modal-trigger-arrow aria-label=\\\"{{lang.aria.openModal + ' ' + item.store_product.name}}\\\"></button> </td> </tr> </tbody> </table> <div class=price-alerts-empty ng-switch-when=false> <div class=price-alert-message-box> <div class=\\\"price-alert-button toggled button round\\\"><span class=badge aria-hidden=true></span></div> <p class=description>{{::lang.values.priceAlertsMessage}}</p> </div> <p class=empty-message>{{::lang.values.noPriceAlerts}}</p> <a ng-if=::!mobile.isMobile ui-sref={{::config.continueShoppingRedirect.desktop}} class=\\\"continue-button button\\\">{{::lang.values.continueShopping}}</a> <a ng-if=::mobile.isMobile ui-sref={{::config.continueShoppingRedirect.mobile}} class=\\\"continue-button button\\\">{{::lang.values.continueShopping}}</a> </div> </div> <div class=\\\"view-loading-indicator price-alert-loading\\\" ng-if=loading></div> \";","module.exports = \"\";","module.exports = \" <div ng-if=\\\"useAngularFooter && config.dotComModule.enableHeaderFooterSync && !utilService.isFixedLayout()\\\"> <div bind-html-compile=dotComFooter after-compile-handler=afterFooterLoaded></div> </div> <footer class=site-footer role=contentinfo ng-if=\\\"useAngularFooter && (!config.dotComModule.enableHeaderFooterSync || footerSyncError) && !utilService.isFixedLayout()\\\" role=group ng-class=\\\"{ 'is-one-cart': config.oneCart.enabled }\\\"> <div include-if-exists=\\\"'footerCustom.html'\\\"></div> <div class=top> <div class=logo> <img class=logo-img src=\" + require(\"assets/images/footer-logo.svg\") + \" alt={{::lang.values.clientName}} /> </div> <ul class=links ng-if=$attributes.innerHTML ng-bind-html=$attributes.innerHTML></ul> <div ng-if=!$attributes.innerHTML> <ul class=links> <li ng-repeat=\\\"link in :: footerPrimaryLinks\\\" ng-if=\\\"!link.loggedIn || link.loggedIn === true && auth.user.status !== 'trial'\\\"> <a ng-attr-id=\\\"{{:: link.id}}\\\" href=\\\"{{config.env.webUrl + (link.href || state.href(link.sref, {}, { inherit: false }))}}\\\" target=_blank>{{link.label}}</a> </li> </ul> <ul class=social> <li ng-repeat=\\\"(link, url) in :: config.footerSocialLinks\\\"> <a href={{url}} target=_blank id=\\\"footer-social-{{:: link}}\\\" class=\\\"icon-social-{{:: link}}\\\" analytics-click=\\\"['footer {{:: link}} link', 'click']\\\" aria-label=\\\"{{:: link}}\\\"></a> </li> </ul> </div> </div> <div class=bottom> <span class=copyright ng-bind-html=\\\"lang.template(lang.values.copyright, {year: currentYear})\\\"></span> <ul class=links> <li ng-repeat=\\\"link in :: footerSecondaryLinks\\\"> <a ng-attr-id=\\\"{{:: link.id}}\\\" ng-href=\\\"{{link.href || state.href(link.sref, {}, { inherit: false })}}\\\" target={{link.target}}>{{link.text}}</a> </li> </ul> </div> </footer> \";","// TODO: Add the other event actions here and use from here.\nexport const USER_ACTIONS = {\n  USER_LOGGED_IN: 'userLoggedIn',\n  POST_USER_LOGGED_IN_STATE_RELOAD: 'postUserLoggedInStateReload',\n  POST_USER_LOGGED_IN_NO_STATE_RELOAD: 'postUserLoggedInNoStateReload',\n  POST_USER_EXTERNAL_LOGIN: 'postUserExternalLoggedIn',\n  USER_UPDATED: 'userUpdated',\n  USER_LOGGING_OUT: 'userLoggingOut',\n}\n\nexport const CONTEXT_ACTIONS = {\n  CONTEXT_UPDATED: 'contextUpdated',\n}\n","var map = {\n\t\"./payment-auth_capture\": \"b58a3ff5b40e148a43b5\",\n\t\"./payment-auth_capture.svg\": \"b58a3ff5b40e148a43b5\",\n\t\"./payment-cash\": \"660b7d4ab67629630163\",\n\t\"./payment-cash.svg\": \"660b7d4ab67629630163\",\n\t\"./payment-credit\": \"42c10e6f4a9d565f2778\",\n\t\"./payment-credit.svg\": \"42c10e6f4a9d565f2778\",\n\t\"./payment-debit\": \"2df53781c0582025e80c\",\n\t\"./payment-debit.svg\": \"2df53781c0582025e80c\",\n\t\"./payment-external_auth\": \"f7f6c2044e377ee3799d\",\n\t\"./payment-external_auth.svg\": \"f7f6c2044e377ee3799d\",\n\t\"./payment-house_account\": \"4228f9bb1462e0349836\",\n\t\"./payment-house_account.svg\": \"4228f9bb1462e0349836\",\n\t\"./payment-paypal\": \"2dc11aeda291d3d19cf2\",\n\t\"./payment-paypal.svg\": \"2dc11aeda291d3d19cf2\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"51c1a7fb2a3ef4abbacf\";","module.exports = \"<div uib-dropdown dropdown-append-to-body=::!$ctrl.isMobile auto-close=outsideClick is-open=$ctrl.dropdownIsOpen on-toggle=$ctrl.toggled(open) ng-class=\\\"::{'button-style': $ctrl.toggleStyle === 'button' }\\\"> <button data-test=add-to-list-popover-button class=\\\"{{'add-to-list-button ' + $ctrl.popoverButtonExtraClass}}\\\" ng-disabled=\\\"$ctrl.products.length === 0\\\" uib-dropdown-toggle ng-disabled=$ctrl.isConfigurationInvalid ng-if=\\\":: $ctrl.isTrialUser\\\" ng-class=\\\"::{\\n      'button hollow icon-after-caret-down icon-fixed-right': $ctrl.toggleStyle === 'button',\\n      'link-group icon-after-caret-down': $ctrl.toggleStyle === 'text',\\n      'link-group link-group-small': $ctrl.toggleStyle === 'icon'\\n    }\\\" uib-popover=\\\"{{:: ($ctrl.lang.values.addTo + ' ' + $ctrl.lang.values.saveForLaterLists)}}\\\" popover-placement=top-right popover-trigger=\\\"mouseenter focus\\\" popover-class=add-to-list-button__popover-style popover-append-to-body=true sanitize-uib=\\\"['aria-haspopup', 'aria-expanded']\\\" aria-label=\\\"{{$ctrl.productsAreInOneList() && $ctrl.products.length !== 0 ? $ctrl.lang.values.addedTo : $ctrl.lang.values.addTo}} {{::$ctrl.lang.values.saveForLaterLists}}\\\"> <span aria-hidden=true class=\\\"add-to-list-button__icon icon-heart-sfl\\\" ng-class=\\\"::{\\n      'link-group link-group-small': $ctrl.toggleStyle === 'icon'\\n    }\\\"> </span> <span ng-if=\\\"!($ctrl.toggleStyle === 'text') && $ctrl.productsAreInOneList() && $ctrl.products.length !== 0\\\" class=\\\"badge icon-checkmark\\\" aria-hidden=true> <span class=screen-reader-text>{{::$ctrl.lang.aria.addedToList}}</span> </span> <span ng-if=\\\"!($ctrl.toggleStyle === 'icon') && $ctrl.productsAreInOneList() && $ctrl.products.length !== 0\\\" class=in-list-label>{{:: $ctrl.lang.values.saved }}</span> <span ng-if=\\\"!($ctrl.toggleStyle === 'icon') && !$ctrl.productsAreInOneList() || $ctrl.products.length === 0\\\" class=label>{{:: $ctrl.lang.values.saveForLater }}</span> </button> <div role=dialog aria-modal=true uib-dropdown-menu aria-label={{::$ctrl.lang.aria.saveItemForLater}} ng-class=\\\"::{ 'stick-to-bottom': $ctrl.isMobile }\\\" class=\\\"add-to-list-menu show-above-modals item-thumbnail-left dropdown-menu-right\\\"> <div ng-if=$ctrl.dropdownIsOpen id=add-to-list-content tabindex=-1 trap-focus> <button ng-if=$ctrl.isMobile data-test=create-list-close ng-click=$ctrl.close() class=mobile-close-button aria-label=\\\"{{:: $ctrl.lang.aria.modalClose}}\\\"> <span class=icon-delete aria-hidden=true></span> </button> <h2 class=title tabindex=0>{{:: $ctrl.lang.values.saveForLater}}</h2> <ul class=unlimited-dropdown ng-if=$ctrl.lists.length> <li data-test=popover-save-list-item ng-repeat=\\\"list in $ctrl.lists track by list.id\\\"> <div class=item-thumbnail-cell ng-if=\\\"list.isSyncing || !$ctrl.productsAreIn(list)\\\"> <img ng-if=list.isSyncing src=\" + require(\"static/images/loading-small.svg\") + \" alt=Loading /> </div> <div class=next-to-item-thumbnail> <div class=add-to-list-item> <button class=add-to-list-item-name ng-click=$ctrl.addOrRemoveItemsFrom(list) ng-disabled=list.isSyncing analytics-click=\\\"['add product/s to list', 'click']\\\"> <i aria-label=\\\"{{:: $ctrl.lang.aria.addedToList }}\\\" class=\\\"icon-checkmark added-to-list-icon highlight-icon\\\" ng-if=\\\"!list.isSyncing && $ctrl.productsAreIn(list)\\\"></i> {{::list.name}} </button> <button ng-if=!$ctrl.isExternalRoutesDisabled ui-sref=\\\"list({ list_id: list.id })\\\" class=add-to-list-item-edit ng-click=$event.stopPropagation() aria-label=\\\"{{$ctrl.lang.aria.edit + list.name}}\\\">{{:: $ctrl.lang.values.edit}}</button> </div> </div> </li> </ul> <hr class=add-to-list-divider aria-hidden=true /> <div class=\\\"add-to-list-form has-input\\\"> <form ng-submit=\\\"$ctrl.createNewList(); analytics.logEvent('add product/s to new list', 'submit')\\\"> <label for=add-to-list-name-input>{{:: $ctrl.lang.values.createANewList }}</label> <div class=input-button> <input type=text class=input keep-observing=true ng-model=$ctrl.newListName ng-disabled=$ctrl.isCreatingNewList placeholder=\\\"{{:: $ctrl.lang.values.enterNewListName}}\\\" id=add-to-list-name-input data-test=add-to-list-name-input /> <button type=submit class=\\\"right button highlight\\\" ng-class=\\\"{ 'showing-loading-dots': $ctrl.isCreatingNewList }\\\" ng-disabled=\\\"(!$ctrl.newListName || $ctrl.isCreatingNewList)\\\" aria-label=\\\"{{:: $ctrl.lang.aria.createList}}\\\" data-test=create-list-button> <span aria-hidden=true> <i ng-if=!$ctrl.isCreatingNewList class=icon-plus></i> <loading-dots show=$ctrl.isCreatingNewList></loading-dots> </span> </button> </div> </form> </div> <div class=\\\"desktop-close-button-holder text-center\\\" ng-if=!$ctrl.isMobile> <button type=button class=\\\"button small hollow highlight\\\" data-test=create-list-close ng-click=$ctrl.close() aria-label=\\\"{{:: $ctrl.lang.aria.modalClose}}\\\">{{::$ctrl.lang.values.close}}</button> </div> </div> </div> </div> <div ng-click=\\\"($ctrl.dropdownIsOpen = false)\\\" ng-if=\\\"$ctrl.isMobile && $ctrl.dropdownIsOpen\\\" class=\\\"menu-backdrop menu-backdrop--top-0\\\"></div> \";","module.exports = \"<div class=notifications> <h3>{{::lang.values.notificationPreferences}}</h3> <div notification-settings-table show-group-titles=true at-registration=false on-save=saveNotifications></div> <div class=content-footer> <button class=button analytics-click=\\\"['notification preferences', 'submit']\\\" ng-click=updateNotifications();>{{::lang.values.saveChanges}}</button> <div ng-if=error class=\\\"message error\\\" scroll-into-view> <span class=icon-error aria-hidden=true></span> {{error}} </div> <div ng-if=message class=\\\"message success\\\" scroll-into-view> <span class=icon-checkmark-circle aria-hidden=true></span> {{message}} </div> </div> </div> \";","module.exports = \"<ul class=product-tags ng-if=productTags.length> <li ng-repeat=\\\"tag in ::productTags\\\" data-test=\\\"tag-pdp {{::tag}}\\\"> <span class=tag-icon tag-style tag=tag tag-location=pdp aria-hidden=true></span> <label> <span>{{::getTagName(tag)}}</span> </label> </li> </ul> <div class=description id=product-description-text ng-if=!!product.description ng-class=\\\"{'is-long': isDescriptionLong}\\\" ng-bind-html=\\\"formattedDescription | linebreaks\\\"></div> <button class=show-more-description aria-controls=product-description-text aria-expanded=\\\"{{ showMoreOpen }}\\\" ng-if=\\\"!!product.description && isDescriptionLong\\\" ng-class=\\\"{'is-open': showMoreOpen}\\\" ng-click=showMoreDescription()> {{showMoreOpen ? (lang.values.showLess || 'show less') : lang.values.showMore}} </button> \";","module.exports = \"<div ng-controller=MaintenanceController class=\\\"view maintenance\\\" ng-class=\\\"'maintenance--' + variant\\\"> <div class=maintenance__content> <div class=maintenance__logo> <img src=\" + require(\"assets/images/small-logo.svg\") + \" alt={{::lang.values.clientName}}> </div> <div ng-switch=variant> <div ng-switch-when=siteDown> <h1>{{::lang.values.siteDown}}</h1> <p>{{::lang.values.siteDownMessage}}</p> </div> <div ng-switch-default> <h1>{{::lang.values.underMaintenance}}</h1> <p>{{::lang.values.underMaintenanceMessage}}</p> </div> </div> </div> </div> \";","import isMobileContainerUrl from './isMobileContainerUrl'\nimport { getBuildConfig } from '../rootConfig'\nimport urlParser from './urlParser'\n\nconst buildConfig = getBuildConfig()\n\n/**\n * Return the html5 version of the url on Cordova.\n *\n * url: `file://<path>/mobile.index.html#/categories`\n * returns: `<webUrl>/categories`\n */\n\nconst getHtml5Url = url => {\n  const { env } = buildConfig\n\n  if (isMobileContainerUrl(urlParser(url))) {\n    const path = url?.split('#')?.[1]\n    return `${env.webUrl}${path || ''}`\n  }\n  return url\n}\n\nexport default getHtml5Url\n","module.exports = \"<div class=\\\"view shop {{state.current.data.section}}\\\"> <div page-header label=\\\"breadcrumbs[breadcrumbs.length - 1].label\\\" breadcrumbs=breadcrumbs background=\\\"tree.current.images.header ? tree.current.images.header.medium : ''\\\" button=checkForButtons() link=tree.current.pageHeaderLink previous-page=true hide-mobile-animation=hideMobileHeaderAnimation flyer-data=flyerData preview-token=\\\"{{:: previewToken}}\\\" selected-filters=\\\"tagsService.getSelectedFilters(tags, brand)\\\" ng-if=!items.featured></div> <div ng-if=promoCodeService.successMessage class=\\\"message success\\\" scroll-into-view> <span class=icon-checkmark-circle aria-hidden=true></span> {{promoCodeService.successMessage}} <button class=button-link ng-click=promoCodeService.clearSuccessMessage()>{{::lang.values.dismiss}}</button> </div> <div ng-if=\\\"::(mobile.isMobile && (filterTags.length || tree.current.sort || tree.current.pageHeaderLink.href || tree.current.pageHeaderLink.sref))\\\" class=page-header-buttons> <a ng-if=\\\"tree.current.pageHeaderLink.href || tree.current.pageHeaderLink.sref\\\" class=\\\"download-pdf icon icon-download-pdf header-button\\\" aria-label=tree.current.pageHeaderLink.label ng-href=\\\"{{tree.current.pageHeaderLink.href || state.href(tree.current.pageHeaderLink.sref)}}\\\" analytics-click=\\\"['current weekly flyer PDF', 'click']\\\" ng-attr-target={{tree.current.pageHeaderLink.target}}> </a> <button ng-hide=\\\"!filterTags.length || useFacetedFilters\\\" class=\\\"icon icon-filter\\\" aria-label=Filter ng-click=openFilterModal() data-test=mobile-filters-button></button> <button ng-hide=\\\"!filterTags.length || !useFacetedFilters\\\" class=\\\"icon icon-filter\\\" aria-label=Filter ng-click=openFacetedFilterModal() data-test=mobile-filters-button></button> </div> <featured-header ng-if=items.featured collection=items></featured-header> <div ng-if=::mobile.isMobile> <flyer-preview flyer-data=flyerData preview-token=\\\"{{:: previewToken}}\\\"></flyer-preview> </div> <div ui-view=mobileMenu class=menu-container></div> <div ng-if=\\\"::(!hideFilters && useFacetedFilters && !mobile.isMobile && (facetedTags.length || tree.current.sort))\\\"> <faceted-filters-bar tags=::facetedTags class=faceted-filters-bar show-sort=::showSort subset=::subset> </faceted-filters-bar> </div> <div ng-if=\\\"!hideFilters && !useFacetedFilters && (!mobile.isMobile && (filterTags.length || tree.current.sort))\\\" filters tags=filterTags show-sort=showSort subset={{::subset}} brands=tree.current.brand_names></div> <div ng-if=src.endpoint ng-init=loadItems() class=cell-container> <placeholder-image type=productCell remove-on=items show-max=10></placeholder-image> <div ng-include=\\\"'shopCells.html'\\\"></div> </div> <div ng-if=\\\"!src.endpoint && state.current.data.section === 'catalog'\\\" ng-include=\\\"'shopSubcategories.html'\\\"></div> <div ng-if=\\\"!src.endpoint && state.current.data.section === 'recipes'\\\" ng-include=\\\"'recipeCategories.html'\\\"></div> <notice-modal ng-if=\\\":: previewToken && onFlyerHomepage\\\"> <span ng-if=\\\":: config.overrideFlyerPreviewNotice\\\" ng-bind-html=\\\":: lang.values.flyerPreviewNoticeOverride\\\"></span> <span ng-if=\\\":: !config.overrideFlyerPreviewNotice\\\"> {{:: lang.values.flyerPreviewNotice}} {{:: lang.values.flyerPreviewMessage}} </span> </notice-modal> <notice-modal ng-if=\\\":: previewTimestampDate && onFlyerHomepage\\\"> {{:: lang.template(lang.values.flyerPreviewNoticeFromDashboard, { startDate: previewTimestampDate })}} </notice-modal> </div> \";","module.exports = \"<div class=\\\"side-sub-menu item-thumbnail-left\\\" ng-if=\\\"$ctrl.mobileService.isMobile && !$ctrl.showNotesSubstitutions\\\"> <span class=ul-el> <span class=li-el ng-class=\\\"{ 'icon-note': $ctrl.inCheckoutCartPage && !$ctrl.config.newCheckoutFlow.cartReviewPage.enabled}\\\"> <span class=\\\"side-sub-menu-item next-to-item-thumbnail dark\\\"> <h2 class=text-unstyled> {{:: $ctrl.inShoppingList ? $ctrl.lang.values.inStoreList : $ctrl.lang.values.reviewCart }} </h2> </span> <div ng-if=::!$ctrl.menuConfig.mobile.menu.useCustomMenu> <button data-test=shopping-list-actions-menu-button class=icon-more ng-click=$ctrl.toggleMenu() aria-label=\\\"{{:: $ctrl.lang.aria.openModal }} {{:: $ctrl.lang.aria.cartActions}}\\\" aria-controls=cart-actions-dropdown aria-expanded=\\\"{{$ctrl.isMenuOpen ? 'true': 'false'}}\\\"></button> </div> <div ng-if=$ctrl.menuConfig.mobile.menu.useCustomMenu> <button class=custom-shopping-list-menu ng-click=$ctrl.toggleMenu() ng-class=\\\"{ 'text-is-uppercase': $ctrl.menuConfig.mobile.menu.isUppercase }\\\" aria-label=\\\"{{:: $ctrl.lang.aria.openModal }} {{:: $ctrl.lang.aria.cartActions}}\\\" data-test=shopping-list-actions-menu-button aria-controls=cart-actions-dropdown aria-expanded=\\\"{{$ctrl.isMenuOpen ? 'true': 'false'}}\\\"> <span class=label>{{:: $ctrl.lang.values[$ctrl.menuConfig.mobile.menu.labelKey] }}</span> <span aria-hidden=true class=\\\"icon {{:: $ctrl.menuConfig.mobile.menu.icon }}\\\"></span> </button> </div> </span> </span> </div> <div class=\\\"dropdown-menu item-thumbnail-left\\\" ng-if=$ctrl.isMenuOpen id=cart-actions-dropdown is-open=dropdownIsOpen trap-focus role=dialog aria-modal=true aria-label={{::$ctrl.lang.values.cartActions}}> <span class=ul-el> <button class=side-sub-menu-close-button aria-label={{::$ctrl.lang.aria.modalClose}} ng-click=$ctrl.toggleMenu()> <span class=icon-delete ng-click=\\\"dropdownIsOpen = false\\\" aria-hidden=true></span> </button> <button ng-if=\\\"$ctrl.inInstoreListPage && !$ctrl.config.disableAisles\\\" ng-click=\\\"$ctrl.triggerSortModal(); $ctrl.toggleMenu()\\\" analytics-click=\\\"['side cart sub menu sort cart modal button', 'click']\\\" class=\\\"li-el side-sub-menu-item\\\" aria-label=\\\"{{:: $ctrl.lang.values.sortBy }} {{$ctrl.currentSortType}} \\\"> <span class=\\\"icon-sort-by side-sub-menu-icon\\\" aria-hidden=true></span> <span> {{::$ctrl.lang.values.sortBy}}: {{$ctrl.currentSortType}} </span> </button> <button ng-if=::!$ctrl.inShoppingList class=\\\"li-el side-sub-menu-item\\\" ng-click=\\\"$ctrl.toggleShowNotesSubs(); $ctrl.toggleMenu()\\\" aria-label={{::$ctrl.lang.values.notesOnSubstitution}}> <span class=\\\"icon-note side-sub-menu-icon\\\" aria-hidden=true></span> <span>{{::$ctrl.lang.values.notesOnSubstitution}}</span> </button> <button ng-click=\\\"$ctrl.emptyList(); $ctrl.toggleMenu()\\\" analytics-click=\\\"['side cart sub menu empty cart button', 'click']\\\" send-analytics=!$root.modifyingOrder class=\\\"li-el side-sub-menu-item\\\" aria-label=\\\"{{::$ctrl.lang.values.empty}}\\n      {{\\n        $ctrl.inInstoreListPage ?\\n          $ctrl.lang.values.list :\\n          $ctrl.lang.values.cart\\n      }}\\\"> <span class=\\\"icon-trash side-sub-menu-icon\\\" aria-hidden=true></span> <span> {{::$ctrl.lang.values.empty}} {{ $ctrl.inInstoreListPage ? $ctrl.lang.values.list : $ctrl.lang.values.cart }} </span> </button> <span ng-if=\\\"::$ctrl.mobileService.isMobileApp() && $ctrl.config.shoppingSelector.instore.exists && $ctrl.inShoppingList\\\" class=li-el share-list-button sorted-products=$ctrl.sortedProducts sorted-categories=$ctrl.sortedCategories custom-items=$ctrl.getCustomItems()></span> <button ng-click=\\\"$ctrl.uncheckAllItems(); $ctrl.toggleMenu()\\\" class=li-el ng-if=\\\"$ctrl.checkedItemsCount > 0 && $ctrl.inShoppingListContext\\\" data-test=uncheck-all-items-button aria-label={{::$ctrl.lang.values.uncheckAllItems}}> <span class=next-to-item-thumbnail> {{::$ctrl.lang.values.uncheckAllItems}} </span> </button> <button ng-click=\\\"$ctrl.deleteCheckedItems(); $ctrl.toggleMenu()\\\" class=li-el ng-if=\\\"$ctrl.checkedItemsCount > 0 && $ctrl.inShoppingListContext\\\" data-test=delete-checked-items-button aria-label=\\\"{{::$ctrl.lang.values.deleteCheckedItems}} ({{$ctrl.checkedItemsCount}})\\\"> <span class=\\\"dropdown-menu-item next-to-item-thumbnail\\\">{{::$ctrl.lang.values.deleteCheckedItems}} ({{$ctrl.checkedItemsCount}})</span> </button></span>  </div> <div class=menu-backdrop ng-click=$ctrl.toggleMenu() ng-show=$ctrl.isMenuOpen></div> \";","module.exports = \"<div class=flexcell__content> <button type=button ng-click=\\\"recipeCell.linkToRecipeDetails(recipeCell.recipe.id, $index)\\\" analytics-click=\\\"['recipe cell', 'click']\\\" class=flexcell__image-container> <a class=flexcell__image cell-image default-image=\\\":: recipeCell.imageURLService.getRecipeImageURL(recipeCell.recipe, 'square')\\\" lazy-load-image=true use-image-tag=true aria-label={{::recipeCell.recipe.name}}></a> </button> <div class=flexcell__content-meta> <div role=button class=flexcell-recipe__name title={{::recipeCell.recipe.name}} ng-click=recipeCell.linkToRecipeDetails(recipeCell.recipe.id)> {{::recipeCell.recipe.name}} </div> <div class=flexcell-recipe__ready-in> <div> {{::lang.values.recipeReadyIn}} {{::recipeCell.recipe.preparation_information.total_time | secondsToHoursMins}} </div> <div class=flex-row-reverse ng-if=::config.userReviews.enabled> <react-rating rating=recipeCell.recipe.recipe_rating.average_rating rating-count=recipeCell.recipe.recipe_rating.user_count show-average=false label-styles=config.userReviews.styles.productCell.label icon-size=config.userReviews.styles.productCell.icons.iconSize /> </div> </div> <div class=flexcell-recipe__icon-row> <div role=button class=flexcell-recipe__icon ng-click=\\\"recipeCell.toggleSaveRecipe(recipeCell.recipe.id, $index)\\\"> <button class=\\\"icon-{{::config.savedRecipesSaveIcon}} link-group-small link-group\\\" ng-if=::!recipeCell.mobile.isMobile ng-class=\\\"{'toggled' : recipeCell.isSaved()}\\\" uib-popover=\\\"{{recipeCell.isSaved() ? 'Unsave Recipe' : 'Save Recipe'}}\\\" popover-trigger=\\\"mouseenter focus\\\" aria-label=\\\"Toggle Save Recipe\\\" role=button aria-pressed={{recipeCell.isSaved()}}> <span ng-if=recipeCell.isSaved() class=\\\"badge icon-checkmark\\\" aria-hidden=true></span> </button> <button class=\\\"icon-{{::config.savedRecipesSaveIcon}} link-group-small link-group\\\" ng-if=::recipeCell.mobile.isMobile ng-class=\\\"{'toggled' : recipeCell.isSaved()}\\\" aria-label=\\\"Toggle Save Recipe\\\" role=button aria-pressed={{recipeCell.isSaved()}}> <span ng-if=recipeCell.isSaved() class=\\\"badge icon-checkmark\\\" aria-hidden=true></span> </button> </div> <div class=flexcell-recipe__tags> <ul class=\\\"shop-tags is-inline\\\" ng-if=::recipeCell.recipeTags.length> <li ng-repeat=\\\"tag in ::recipeCell.recipeTags | limitTo: recipeCell.tagLimit\\\" class=\\\"flexcell-recipe__icon shop-tag tag-icon\\\" title={{::tagsService.byVal(tag).name}} tag-style tag=tag.tag_name> </li> </ul> <div class=shop-tag-count ng-if=\\\"::recipeCell.recipeTags.length > recipeCell.tagLimit\\\"> + {{::recipeCell.recipeTags.length - recipeCell.tagLimit}} </div> </div> </div> </div> </div> \";","module.exports = \"<div ng-controller=FirstDataIntegrationController id=first-data-integration> <h2 ng-hide=!paymentInstruments.length class=\\\"section-divider-small section-divider-small--align-left unata-payment-action\\\"> <span class=title>{{::lang.values.selectACard}}</span> </h2> <span class=\\\"unata-payment-ct unata-payment-list\\\"> <div class=\\\"row condensed\\\" ng-repeat=\\\"card in paymentInstruments\\\" ng-class=\\\"{'unata-selected-card': $parent.selectedCard.id === card.id}\\\"> <input type=radio ng-model=$parent.selectedCard ng-value=card id=payment-instrument-{{card.id}} name=selectedCard class=radio> <label for=payment-instrument-{{card.id}} class=unata-payment-option> {{::lang.template(lang.values.cardEnding, {cardName: card.name, cardNumber:card.last_four_digits})}} </label> <button ng-click=deleteCard(card) class=unata-payment-action> {{::lang.values.delete}} </button> </div> </span> <button class=\\\"button add-card unata-payment-action\\\" ng-click=showAddCardForm() ng-hide=hideAddCardButton> {{::lang.values.addACard}} </button> <div ng-if=showFirstDataForm class=unata-payment-action> <h2 class=\\\"section-divider-small section-divider-small--align-left\\\"> <span class=title>{{::lang.values.addNewCard}}</span> <credit-card-logos class=\\\"right credit-cards-mobile\\\" credit-cards=creditCards is-dirty=\\\"ccNumber.length > 0\\\" selected-credit-card=cardType> </credit-card-logos> </h2> <form ng-submit=addCard() method=post name=payment-info-form id=payment-info-form class=payment-info-form> <div class=payment-info-form__fields> <select style=display:none name=auth id=auth payeezy-data=auth> <option value=false>false</option> <option value=true selected=selected>true</option> </select> <div class=form-row> <input class=\\\"input small\\\" type=text payeezy-data=cc_number ng-model=$parent.ccNumber placeholder={{::lang.values.creditCardFields.cardNumber}} aria-label={{::lang.values.creditCardFields.cardNumber}} required/> </div> <div class=form-row> <div class=col-2-3> <input class=\\\"input small\\\" type=text payeezy-data=cardholder_name placeholder={{::lang.values.creditCardFields.cardHolderName}} aria-label={{::lang.values.creditCardFields.cardHolderName}} required/> </div> <div class=col-1-3> <input class=\\\"input small\\\" type=text payeezy-data=cvv_code placeholder={{::lang.values.creditCardFields.cvvCode}} aria-label={{::lang.values.creditCardFields.cvvCode}} required/> </div> </div> <div class=form-row> <div class=col-1-2> <div class=\\\"select small\\\"> <span class=chevron-down aria-hidden=true></span> <select payeezy-data=exp_month ng-model=selectedMonth ng-options=\\\"option.value as option.name for option in expiryMonth\\\" aria-label={{::lang.values.creditCardFields.selectMonth}}> <option disabled=disabled value=\\\"\\\">{{::lang.values.creditCardFields.selectMonth}}</option> </select> <div class=selected> <span class=item-selected ng-if=selectedMonth>{{selectedMonth | nameFromValue:expiryMonth}}</span> <span class=no-item-selected ng-if=!selectedMonth>{{::lang.values.creditCardFields.selectMonth}}</span> </div> </div> </div> <div class=col-1-2> <div class=\\\"select small\\\"> <span class=chevron-down aria-hidden=true></span> <select payeezy-data=exp_year ng-model=selectedYear ng-options=\\\"option.value as option.name for option in expiryYear\\\" aria-label={{::lang.values.creditCardFields.selectYear}}> <option disabled=disabled value=\\\"\\\">{{::lang.values.creditCardFields.selectYear}}</option> </select> <div class=selected> <span class=item-selected ng-if=selectedYear>{{selectedYear | nameFromValue:expiryYear}}</span> <span class=no-item-selected ng-if=!selectedYear>{{::lang.values.creditCardFields.selectYear}}</span> </div> </div> </div> </div> <div class=form-row> <input class=\\\"input small\\\" type=text payeezy-data=zip_postal_code ng-model=$parent.zipPostalCode placeholder={{::lang.values.creditCardFields.zipCode}} aria-label={{::lang.values.creditCardFields.zipCode}} required/> </div> <div class=form-row> <input class=\\\"input small\\\" type=text ng-model=$parent.cardDescription placeholder={{::lang.values.creditCardFields.cardDescription}} aria-label={{::lang.values.creditCardFields.cardDescription}} required/> </div> <div ng-if=error class=error scroll-into-view>{{error}}</div> <div class=row> <button class=button ng-submit=addCard() ng-disabled=!valid aria-label={{::lang.values.addYourCard}}>{{::lang.values.addYourCard}}</button> <button class=button ng-hide=!paymentInstruments.length class=light ng-click=cancelAddCard() aria-label={{::lang.values.cancel}}>{{::lang.values.cancel}}</button> </div> <div class=form-row> <div class=explain>{{::lang.values.firstDataMemo}}</div> </div> </div> <div class=payment-info-form__fields> <div class=\\\"form-row credit-cards-wide\\\"> <credit-card-logos credit-cards=creditCards is-dirty=\\\"ccNumber.length > 0\\\" selected-credit-card=cardType> </credit-card-logos> </div> </div> <input type=hidden name=cardType payeezy-data=card_type ng-value=cardType> </form> </div> </div> \";","module.exports = \"<div class=snapEBT> <div class=card> <div class=card-title-container> <div class=ebt-card-title> {{::lang.values.ebt.ebtCard}} </div> <div class=ebt-card-number> <br ng-if=!ebtCardService.userHasEbtCard> <span ng-if=ebtCardService.userHasEbtCard>{{::lang.template(lang.values.ebt.EBTCardLabel, {lastFourDigits: ebtCardService.lastFourEbtDigits})}}</span> </div> </div> <button ng-if=!ebtCardService.userHasEbtCard ng-click=openAddCardModal() class=\\\"button link ebt-button\\\">{{::lang.values.ebt.add}}</button> <button ng-if=ebtCardService.userHasEbtCard ng-click=openRemoveCardModal() class=\\\"button link ebt-button\\\">{{::lang.values.remove}}</button> </div> </div> \";","module.exports = \"<div data-test=pdp-modal class=\\\"product-details-modal modal-container\\\"> <div role=region class=\\\"modal-header modal-header-collapse-desktop\\\" shop-modal-header></div> <div role=region class=modal-content> <div ng-include=\\\"'productDetails.html'\\\"></div> </div> </div> \";","module.exports = \"<div class=\\\"loyalty-info modal-container\\\"> <div class=\\\"modal-header modal-header-collapse-desktop modal-header-hidden-mobile\\\"> <button class=close ng-click=$dismiss() aria-label={{::lang.aria.modalClose}}> <span class=icon-delete aria-hidden=true></span> </button> </div> <div class=modal-content> <button ng-if=\\\":: mobile.isMobile\\\" class=close ng-click=$dismiss() aria-label={{::lang.aria.modalClose}}> <span class=icon-delete aria-hidden=true></span> </button> <h2 class=loyalty-info-title>{{::lang.values.loyaltyCard}}</h2> <div class=\\\"loyalty-info-body top-spacing\\\" ng-bind-html=lang.values.loyaltyInfo></div> <a class=\\\"button hollow\\\" ui-sref=main.account.loyalty ui-sref-opts=\\\"{ reload: true }\\\" id=loyalty-info-main-account-loyalty> <span ng-if=\\\"auth.user.status != 'trial'\\\">{{::lang.values.getStarted}}</span> <span ng-if=\\\"auth.user.status == 'trial'\\\">{{::lang.values.loginOrRegister}}</span> </a> </div> </div> \";","module.exports = \"<button ng-click=togglePopover() class=\\\"selected small cart button dropdown configurable-dropdown icon-fixed-right icon-after-caret-down icon-cart\\\" ng-class=\\\"{'in-cart': aggregateQuantity > 0}\\\"> <span ng-if=\\\"aggregateQuantity > 0\\\">{{aggregateQuantity}} {{product.ordering_parameters.display_name}} {{!mobile.isMobile ? 'Added' : ''}}</span> <span ng-if=\\\"aggregateQuantity === 0\\\">{{auth.getContext().intent === 'instore' ? lang.values.addToListButtonLabel : lang.values.addToCartButtonLabel}}</span> </button> \";","module.exports = \"<div class=\\\"filter-modal modal-container\\\" data-test=filter-modal> <div class=modal-header> <button ng-click=$ctrl.dismissModal() class=close analytics-click=\\\"['filter modal close button', 'click']\\\" aria-label={{::lang.aria.close}}> <span class=icon-delete aria-hidden=true></span> </button> <button ng-click=$ctrl.reset() class=reset analytics-click=\\\"['filter modal reset button', 'click']\\\">{{::$ctrl.lang.values.reset}}</button> </div> <div class=\\\"filter-modal-content modal-content\\\"> <div ng-if=\\\"$ctrl.model.content === 'Products'\\\"> <section ng-if=\\\"$ctrl.sortOptions && $ctrl.sortOptions.length\\\"> <h2>{{::$ctrl.lang.values.sortBy}}</h2> <ul class=sort> <li ng-repeat=\\\"sortOption in ::$ctrl.sortOptions\\\" class=sort-option> <input ng-model=$ctrl.model.sort type=radio name=sortOption id=tag-{{::sortOption.value}} ng-value=sortOption.value class=radio data-test=tag-{{::sortOption.value}}> <label for=tag-{{::sortOption.value}} class=radio-button> <span>{{::sortOption.name}}</span> </label> </li> </ul> </section> <section ng-if=\\\"$ctrl.tagOptions && $ctrl.tagOptions.length\\\"> <h2>{{::$ctrl.lang.values.filters}}</h2> <ul class=\\\"tags list\\\"> <li ng-repeat=\\\"tagOption in ::$ctrl.tagOptions\\\" class=\\\"tag-option list-item {{::tagOption.id}}\\\" analytics-click=\\\"['tag filter ' + tagOption.id, 'click']\\\" data-test=\\\"filter {{::tagOption.id}}\\\" run-on-enter=$ctrl.keyboardToggleTagOption(tagOption.id) tabindex=0> <input ng-model=$ctrl.model.tags[tagOption.id] type=checkbox id=tag-{{::tagOption.id}} name=tag-{{::tagOption.id}} data-test=tag-{{::tagOption.id}}> <label for=tag-{{::tagOption.id}}> <div class=tag-icon tag-style tag=tagOption tag-location=filters></div> <span>{{::tagOption.name}}</span> <span class=indicator aria-hidden=true></span> </label> </li> </ul> </section> <section ng-if=\\\"$ctrl.brandOptions && $ctrl.brandOptions.length > 1\\\"> <h2>{{::$ctrl.lang.values.brands}}</h2> <ul class=\\\"brands list\\\"> <li ng-repeat=\\\"brandOption in ::$ctrl.brandOptions\\\" class=\\\"brand-option list-item\\\" run-on-enter=$ctrl.keyboardSelectBrandOption(brandOption.value) tabindex=0> <input ng-model=$ctrl.model.brand type=radio name=brandOption id=tag-{{::brandOption.value}} ng-value=brandOption.value tabindex=-1 class=radio data-test=tag-{{::brandOption.value}}> <label for=tag-{{::brandOption.value}}> <span>{{::brandOption.name}}</span> <span class=indicator aria-hidden=true></span> </label> </li> </ul> </section> </div> </div> <button ng-click=$ctrl.applyFilters() class=\\\"button mobile-bottom footer\\\" analytics-click=\\\"['filter modal apply button', 'click']\\\" data-test=mobile-apply-filters-button>{{::$ctrl.lang.values.applyFilters}}</button> </div> \";","export enum SSO_PROVIDERS {\n  FACEBOOK = 'facebook',\n  GOOGLE = 'google',\n  INSTACART_IDP = 'instacart_idp',\n  // Instacart SSO IDP for retailers with isolated context\n  INSTACART_LOGIN = 'instacart_login',\n  // Instacart Account Import for retailers with isolated context\n  INSTACART_LINK = 'instacart_link',\n  TWITTER = 'twitter',\n  COSTCO_IDP = 'costco_idp',\n  APPLE = 'apple',\n  EXTERNAL_OAUTH2_IDP = 'external_oauth2_idp',\n}\n","module.exports = \"<div class=not-found ng-if=\\\"tree.children.length === 0 && (tree.promoted && tree.promoted.length === 0)\\\"> {{::lang.values.noItemsFound}} </div> <ul ng-if=\\\"(tree.promoted && tree.promoted.length > 0) || (tree.children && tree.children.length > 0)\\\" class=\\\"categories-grid recipes-grid\\\"> <li ng-if=\\\"tree.promoted && tree.promoted.length > 0\\\" ng-repeat=\\\"promoted in tree.promoted\\\" class=category category-filter=subcategory> <saved-recipes-cell ng-if=\\\"promoted.tile === 'saved-recipes'\\\" cell=promoted></saved-recipes-cell> <ul class=children></ul> </li> <li ng-repeat=\\\"subcategory in tree.children\\\" class=category category-filter=subcategory> <category-card analytics-click=\\\"['recipes subcategories image link', 'click']\\\" type=\\\"'recipe'\\\" href=\\\"'main.shop.recipes.category'\\\" category=subcategory /> <ul class=children> <li ng-repeat=\\\"child in subcategory.children\\\"> <a ui-sref=\\\"main.shop.recipes.category({ recipe_category_id: child.id, page: null })\\\" analytics-click=\\\"['recipes subcategories text link', 'click']\\\">{{child.name}}</a> </li> </ul> </li> </ul> \";","module.exports = \" <div class=modal-wrapper> <invalid-cart-items-display validate-response=validateResponse on-dismiss=$dismiss()> </invalid-cart-items-display> </div> \";","module.exports = \"<div class=\\\"filter-modal modal-container\\\"> <div class=modal-header> <button ng-click=$dismiss() class=close analytics-click=\\\"['filter modal close button', 'click']\\\" aria-label={{::lang.aria.close}}> <span class=icon-delete aria-hidden=true></span> </button> </div> <div class=\\\"filter-modal-content modal-content\\\"> <fieldset ng-if=\\\"sortOptions && sortOptions.length\\\"> <legend> <h2>{{::lang.values.sortBy}}</h2> </legend> <ul class=sort> <li ng-repeat=\\\"sortOption in sortOptions\\\" class=sort-option> <input ng-model=$parent.$parent.sort type=radio name=sortOption id=tag-{{::sortOption.value}} ng-value=sortOption.value class=radio> <label for=tag-{{::sortOption.value}} class=radio-button> <span>{{sortOption.name}}</span> </label> </li> </ul> </fieldset> </div> </div> \";","import { ShoppingListItem } from '@app/types/shoppingList'\nimport * as lang from '@instacart/enterprise-services/lang'\nimport { isProductAvailable } from '@instacart/enterprise-services/product/utils'\nimport { useLang } from '@app/services/config/hooks'\nimport {\n  getMinimumCartSpend,\n  areAllItemsRx,\n  getRemainingAmount,\n} from '@instacart/enterprise-services/shopping-list/_common/utils'\nimport { Banner } from '@app/types/config'\nimport cloneDeep from 'lodash/cloneDeep'\nimport { formatCurrency } from '@instacart/cocktail-utils'\nimport { CartTotalsForCartTypeMap, MultiCart, CartTypeUnion } from '@app/types/cart'\n\n/**\n *  Creates an object with categories as the key and respective items in an array\n */\nexport const categorizeItemsByDepartment = (items: ShoppingListItem[]) => {\n  const categories: { [key: string]: ShoppingListItem[] } = {}\n  items.forEach(item => {\n    // Custom items dont have categories and should not be included\n    if (!item.store_product?.categories) return\n\n    let category =\n      item.store_product?.categories[0]?.name || lang.default.translate('uncategorizedCategory')\n\n    if (!isProductAvailable(item.store_product)) {\n      const langObj = useLang()\n      category = langObj.currentlyUnavailable\n    }\n\n    if (category in categories) {\n      categories[category] = [...categories[category], item]\n    } else {\n      categories[category] = [item]\n    }\n  })\n  return categories\n}\n\n/**\n *  Creates an object by the different cart types with each holding the totals, items, categorized items, and the banner\n *\n */\nexport const getDataByCartType = (\n  items: ShoppingListItem[],\n  cartTotals: CartTotalsForCartTypeMap,\n  banners: Banner[]\n): MultiCart => {\n  if (items?.length === 0 || !cartTotals) return {}\n\n  const carts: MultiCart = cloneDeep(cartTotals)\n\n  const getMinCartAlertMessage = (\n    pre_reward_program_discount_product_total: number,\n    itemsArray: ShoppingListItem[],\n    bannerName = ''\n  ) => {\n    const cartMinimum = getMinimumCartSpend() || 0\n    const remainingAmount = getRemainingAmount(\n      cartMinimum,\n      pre_reward_program_discount_product_total,\n      itemsArray\n    )\n\n    const stringKey = bannerName\n      ? 'cartMinimum.miniCartAlertTextWithBanner'\n      : 'cartMinimum.miniCartAlertText'\n\n    return !areAllItemsRx(items) && remainingAmount > 0\n      ? lang.default.translate(stringKey, {\n          amount: formatCurrency(cartMinimum),\n          bannerName,\n          remainingAmount: formatCurrency(remainingAmount),\n        })\n      : ''\n  }\n\n  items.forEach((item: ShoppingListItem) => {\n    const { cart_type } = item\n\n    const singleCart = carts[cart_type]\n    if (singleCart?.items) {\n      singleCart.items.push(item)\n    } else if (singleCart) {\n      singleCart.items = []\n      singleCart.items.push(item)\n    }\n  })\n\n  Object.entries(carts).forEach(([key, val]) => {\n    if (val && val.items && val.items.length > 0) {\n      // eslint-disable-next-line no-param-reassign\n      val.categorizedItems = categorizeItemsByDepartment(val.items)\n      // This assumes all the items in a store would have the same banner id and that banner and stores are 1:1\n      const storeBanner = banners.find(\n        (banner: Banner) => val.items && banner.bannerExtId === val.items[0].warehouse_id\n      )\n      // eslint-disable-next-line no-param-reassign\n      val.banner = storeBanner\n      // eslint-disable-next-line no-param-reassign\n      val.cartMinMsg = getMinCartAlertMessage(\n        parseFloat(val?.pre_reward_program_discount_product_total),\n        val.items\n      )\n      // eslint-disable-next-line no-param-reassign\n      val.cartMinMsgWithBanner = getMinCartAlertMessage(\n        parseFloat(val?.pre_reward_program_discount_product_total),\n        val.items,\n        val.banner.name\n      )\n    } else {\n      // We don't need to show if the cart has no items\n      delete carts[key as CartTypeUnion]\n    }\n  })\n\n  return carts\n}\n","module.exports = \"<div ng-controller=\\\"FirstDataIntegrationV2Controller as $ctrl\\\" id=first-data-integration> <h2 ng-if=$ctrl.paymentInstruments.length class=\\\"section-divider-small section-divider-small--align-left unata-payment-action\\\"> <span class=title>{{::lang.values.selectACard}}</span> </h2> <span ng-if=!$ctrl.paymentListRefresh class=\\\"unata-payment-ct unata-payment-list\\\"> <div class=\\\"row condensed\\\" ng-repeat=\\\"card in $ctrl.paymentInstruments\\\" ng-class=\\\"{'unata-selected-card': $ctrl.uiState.selectedCard.id === card.id}\\\"> <input type=radio ng-model=$ctrl.uiState.selectedCard ng-value=card id=payment-instrument-{{card.id}} name=selectedCard class=radio ng-class=\\\"{'credit-card-list-selected-card': $ctrl.uiState.selectedCard.id === card.id}\\\"/> <label for=payment-instrument-{{card.id}} class=unata-payment-option> {{::lang.template(lang.values.cardEnding, { cardName: card.name, cardNumber: card.last_four_digits })}} </label> <button ng-click=$ctrl.deleteCard(card) class=unata-payment-action> {{::lang.values.delete}} </button> </div> </span> <button class=\\\"button add-card unata-payment-action\\\" ng-click=$ctrl.showAddCardForm() ng-if=!$ctrl.hideAddCardButton> {{::lang.values.addACard}} </button> <div ng-if=$ctrl.showFirstDataForm class=unata-payment-action> <h2 class=\\\"section-divider-small section-divider-small--align-left\\\"> <span class=title>{{::lang.values.addNewCard}}</span> </h2> <div ng-if=!$ctrl.firstDataFormReady aria-label={{::lang.aria.loadingImage}} class=view-loading-indicator></div> <form method=post ng-show=$ctrl.firstDataFormReady name=payment-info-form id=payment-info-form class=\\\"payment-info-form firstData-form font-for-firstdata-fields\\\" novalidate> <div class=payment-info-form__fields> <div class=form-row> <div id=cc-card class=\\\"input small\\\" data-cc-card></div> </div> <div class=form-row> <div class=col-2-3> <div id=cc-name class=\\\"input small\\\" data-cc-name></div> </div> <div class=col-1-3> <div id=cc-cvv class=\\\"input small\\\" data-cc-cvv></div> </div> </div> <div class=form-row> <div id=cc-exp class=\\\"input small\\\" data-cc-exp></div> </div> <div class=form-row> <input class=\\\"input small\\\" type=text ng-model=$ctrl.zipPostalCode id=cc-zip placeholder={{::lang.values.creditCardFields.zipCode}} aria-label={{::lang.values.creditCardFields.zipCode}} required/> </div> <div class=form-row> <input class=\\\"input small\\\" type=text ng-messages=false ng-model=$ctrl.cardDescription id=cc-description placeholder={{::lang.values.creditCardFields.cardDescription}} aria-label={{::lang.values.creditCardFields.cardDescription}} required/> </div> <div ng-if=$ctrl.error class=error scroll-into-view>{{$ctrl.error}}</div> <div class=row> <button class=button ng-click=$ctrl.addCard() aria-label={{::lang.values.addYourCard}}> {{::lang.values.addYourCard}} </button> <button class=\\\"button light\\\" ng-if=$ctrl.paymentInstruments.length ng-click=$ctrl.cancelAddCard() aria-label={{::lang.values.cancel}}> {{::lang.values.cancel}} </button> </div> <div class=form-row> <div class=explain>{{::lang.values.firstDataMemo}}</div> </div> </div> </form> </div> </div> \";","export const locations = {\n  provinces: [\n    {\n      name: 'Ontario',\n      value: 'ON',\n    },\n    {\n      name: 'Quebec',\n      value: 'QC',\n    },\n    {\n      name: 'British Columbia',\n      value: 'BC',\n    },\n    {\n      name: 'Alberta',\n      value: 'AB',\n    },\n    {\n      name: 'Manitoba',\n      value: 'MB',\n    },\n    {\n      name: 'Saskatchewan',\n      value: 'SK',\n    },\n    {\n      name: 'Nova Scotia',\n      value: 'NS',\n    },\n    {\n      name: 'New Brunswick',\n      value: 'NB',\n    },\n    {\n      name: 'Newfoundland and Labrador',\n      value: 'NL',\n    },\n    {\n      name: 'Prince Edward Island',\n      value: 'PE',\n    },\n    {\n      name: 'Northwest Territories',\n      value: 'NT',\n    },\n    {\n      name: 'Yukon',\n      value: 'YT',\n    },\n    {\n      name: 'Nunavut',\n      value: 'NT',\n    },\n  ],\n\n  states: [\n    {\n      name: 'Alabama',\n      value: 'AL',\n    },\n    {\n      name: 'Alaska',\n      value: 'AK',\n    },\n    {\n      name: 'Arizona',\n      value: 'AZ',\n    },\n    {\n      name: 'Arkansas',\n      value: 'AR',\n    },\n    {\n      name: 'California',\n      value: 'CA',\n    },\n    {\n      name: 'Colorado',\n      value: 'CO',\n    },\n    {\n      name: 'Connecticut',\n      value: 'CT',\n    },\n    {\n      name: 'Delaware',\n      value: 'DE',\n    },\n    {\n      name: 'District of Columbia',\n      value: 'DC',\n    },\n    {\n      name: 'Florida',\n      value: 'FL',\n    },\n    {\n      name: 'Georgia',\n      value: 'GA',\n    },\n    {\n      name: 'Hawaii',\n      value: 'HI',\n    },\n    {\n      name: 'Idaho',\n      value: 'ID',\n    },\n    {\n      name: 'Illinois',\n      value: 'IL',\n    },\n    {\n      name: 'Indiana',\n      value: 'IN',\n    },\n    {\n      name: 'Iowa',\n      value: 'IA',\n    },\n    {\n      name: 'Kansas',\n      value: 'KS',\n    },\n    {\n      name: 'Kentucky',\n      value: 'KY',\n    },\n    {\n      name: 'Louisiana',\n      value: 'LA',\n    },\n    {\n      name: 'Maine',\n      value: 'ME',\n    },\n    {\n      name: 'Maryland',\n      value: 'MD',\n    },\n    {\n      name: 'Massachusetts',\n      value: 'MA',\n    },\n    {\n      name: 'Michigan',\n      value: 'MI',\n    },\n    {\n      name: 'Minnesota',\n      value: 'MN',\n    },\n    {\n      name: 'Mississippi',\n      value: 'MS',\n    },\n    {\n      name: 'Missouri',\n      value: 'MO',\n    },\n    {\n      name: 'Montana',\n      value: 'MT',\n    },\n    {\n      name: 'Nebraska',\n      value: 'NE',\n    },\n    {\n      name: 'Nevada',\n      value: 'NV',\n    },\n    {\n      name: 'New Hampshire',\n      value: 'NH',\n    },\n    {\n      name: 'New Jersey',\n      value: 'NJ',\n    },\n    {\n      name: 'New Mexico',\n      value: 'NM',\n    },\n    {\n      name: 'New York',\n      value: 'NY',\n    },\n    {\n      name: 'North Carolina',\n      value: 'NC',\n    },\n    {\n      name: 'North Dakota',\n      value: 'ND',\n    },\n    {\n      name: 'Ohio',\n      value: 'OH',\n    },\n    {\n      name: 'Oklahoma',\n      value: 'OK',\n    },\n    {\n      name: 'Oregon',\n      value: 'OR',\n    },\n    {\n      name: 'Pennsylvania',\n      value: 'PA',\n    },\n    {\n      name: 'Rhode Island',\n      value: 'RI',\n    },\n    {\n      name: 'South Carolina',\n      value: 'SC',\n    },\n    {\n      name: 'South Dakota',\n      value: 'SD',\n    },\n    {\n      name: 'Tennessee',\n      value: 'TN',\n    },\n    {\n      name: 'Texas',\n      value: 'TX',\n    },\n    {\n      name: 'Utah',\n      value: 'UT',\n    },\n    {\n      name: 'Vermont',\n      value: 'VT',\n    },\n    {\n      name: 'Virginia',\n      value: 'VA',\n    },\n    {\n      name: 'Washington',\n      value: 'WA',\n    },\n    {\n      name: 'West Virginia',\n      value: 'WV',\n    },\n    {\n      name: 'Wisconsin',\n      value: 'WI',\n    },\n    {\n      name: 'Wyoming',\n      value: 'WY',\n    },\n  ],\n}\n","module.exports = \"<div class=add-to-cart-modify ng-if=!product.order_by_weight> <button id=\\\"add-to-cart-modify-remove-button-{{ product.id }}\\\" ng-click=\\\"\\n      cartService.updateItemQuantity(product, quantity - 1, configuration);\\n      cartAnalytics.removeItem(product, 1, index, location, locationValue, { is_modal: isModal, corner_distance: getCornerDistance() });\\n      onAllItemsRemoved();\\n    \\\" analytics-click=\\\"['add to cart product decrement cart quantity button', 'click']\\\" send-analytics=!$root.modifyingOrder class=\\\"add-to-cart-modify__button remove\\\" aria-label={{::lang.aria.removeItem}} ng-class=\\\"{ 'icon-minus': quantity > 1, 'icon-trash': quantity <= 1 }\\\"></button> <div class=add-to-cart-modify__count> <span>{{cartItem.quantity || '0' }} {{hasReachedProductAddLimit() ? '(' + lang.values.max + ')' : ''}}</span> </div> <button id=\\\"add-to-cart-modify-add-button-{{ product.id }}\\\" data-test=add-to-cart-button ng-click=\\\"\\n      cartService.updateItemQuantity(product, quantity + 1, configuration);\\n      productsService.getBeacon(product.onAddToCartBeacon);\\n      cartAnalytics.addItem(product, 1, index, location, locationValue, { is_modal: isModal, corner_distance: getCornerDistance() });\\n      analytics.logFBAddToCart(product);\\n      appReviewCheck();\\n    \\\" ng-disabled=hasReachedProductAddLimit() analytics-click=\\\"['add to cart product increment cart quantity button', 'click']\\\" send-analytics=!$root.modifyingOrder class=\\\"add-to-cart-modify__button icon-plus\\\" ng-class=\\\"{small: small, 'icon-list': auth.getContext().intent === 'instore', 'icon-cart': auth.getContext().intent !== 'instore'}\\\" aria-label={{::lang.aria.addItem}}> </button> </div> <div class=add-to-cart-modify ng-if=product.order_by_weight> <button ng-disabled=!quantity id=\\\"add-to-cart-modify-remove-button-{{ product.id }}\\\" ng-click=\\\"\\n      cartService.removeItem(product);\\n      cartAnalytics.removeItem(product, $parent.quantity, index, location, locationValue, { is_modal: isModal, corner_distance: getCornerDistance() });\\n      onAllItemsRemoved();\\n    \\\" ng-disabled=hasReachedProductAddLimit() analytics-click=\\\"['add to cart product decrement cart quantity button', 'click']\\\" send-analytics=!$root.modifyingOrder class=\\\"add-to-cart-modify__button remove icon-trash\\\" aria-label={{::lang.aria.removeItem}}></button> <div class=select-button> <div class=add-to-cart-modify__count> <span>{{cartItem.quantity || '0'}} {{ hasReachedProductAddLimit() ? '(' + lang.values.max + ')' : ''}}</span> </div> <button class=\\\"add-to-cart-modify__button icon-caret-down\\\"> </button> <select ng-model=$parent.quantity ng-change=\\\"updateWeight(configuration, $parent.quantity); appReviewCheck();\\\" aria-label={{::lang.aria.updateWeight}} ng-options=\\\"weight.value as weight.label for weight in orderWeightOptions\\\" id=\\\"add-to-cart-button-cart-service-select-item-weight-{{ product.id + idStringContext }}\\\" data-test=add-to-cart-button-select> <option value=\\\"\\\" selected=selected disabled=disabled>{{ lang.values.selectWeight }}</option> </select> </div> </div> \";","module.exports = \"<div class=modify-quantity ng-class=\\\"{ 'secondary-style': secondaryStyle }\\\" ng-disabled=disableInput> <div ng-if=!item.store_product.order_by_weight> <button ng-class=\\\"{'disable-input' : disableInput}\\\" ng-click=decrementFn() id=modify-quantity-decrement-fn-{{::context}}-{{item.id}} class=\\\"decrement linkDisabled\\\" analytics-click=\\\"['{{analyticsName}} decrement quantity button', 'click']\\\" send-analytics=!$root.modifyingOrder aria-label={{::lang.aria.removeItem}} data-test=item-decrement-quantity-button ng-if=!secondaryStyle ng-disabled=disableInput data-test=item-decrement-button></button> <button ng-class=\\\"{'disable-input' : disableInput}\\\" ng-click=decrementFn() data-test=item-decrement-quantity-button class=decrement analytics-click=\\\"['{{analyticsName}} decrement quantity button', 'click']\\\" send-analytics=!$root.modifyingOrder aria-label={{::lang.aria.removeItem}} ng-if=secondaryStyle ng-disabled=\\\"item.quantity === 1 || disableInput\\\" data-test=item-decrement-button></button> <label class=screenreadertext for=modify-quantity-input-{{::context}}-{{item.id}}>{{::lang.aria.itemQuantity}}</label> <input ng-disabled=disableInput ng-change=onUpdate() class=\\\"input quantity\\\" data-test=item-quantity-input analytics-click=\\\"['{{analysicsName}} quantity field', 'click']\\\" update-on-enter type=number max={{maxItemsInCart}} required ng-model=item.quantity ng-model-options=\\\"{updateOn: 'blur'}\\\" data-test=item-quantity-input name=modify-quantity-input-{{::context}}-{{item.id}} /> <button ng-class=\\\"{'disable-input' : disableInput}\\\" ng-click=incrementFn() data-test=item-increment-quantity-button class=increment analytics-click=\\\"['{{analyticsName}} increment button', 'click']\\\" send-analytics=!$root.modifyingOrder aria-label={{::lang.aria.addItem}} ng-disabled=shouldDisableButton() data-test=item-increment-button></button> </div> <div ng-if=item.store_product.order_by_weight> <div class=dropdown> <div aria-hidden=true> <div class=display tabindex=-1> {{item.quantity}} {{::item.store_product.ordering_parameters.display_name}} <span class=\\\"icon-chevron-down right-chevon-down-button\\\" aria-hidden=true></span> </div> <label for=modify-quantity-by-weight-fn-{{::context}}-{{item.store_product.id}} class=screen-reader-text aria-hidden=true> {{::lang.values.selectWeight}} </label> </div> <select ng-disabled=disableInput ng-model=item.quantity ng-options=\\\"weight.value as weight.label for weight in orderWeightOptionsService.generate({ product: item.store_product, includeZeroOption: includeZero })\\\" ng-change=\\\"onUpdateValue('{{item.quantity}}')\\\" id=modify-quantity-by-weight-fn-{{::context}}-{{item.store_product.id}} data-test=item-weight-select analytics-click=\\\"['{{analyticsName}} weight dropdown', 'click']\\\" aria-label={{::lang.aria.selectWeight}} data-test=item-quantity-input> <option value=\\\"\\\" selected=selected disabled=disabled>{{::lang.values.selectWeight}}</option> </select> </div> </div> </div> \";","module.exports = \"<div class=\\\"compare-cart-modal modal-container\\\"> <div class=modal-header> {{::lang.values.warning}} </div> <div tabindex=-1 class=\\\"compare-cart-content modal-content\\\"> <cart-compare custom-cart-compare-config=customCartCompare></cart-compare> <div ng-class=\\\"::{ 'row buttons-box': !mobile.isMobile, 'buttons': mobile.isMobile }\\\"> <button ng-if=canProceed ng-click=$close() class=button analytics-click=\\\"['compareCart modal continue button', 'click']\\\"> {{::lang.values.continueAnyway}} </button> <button ng-click=$dismiss() class=button ng-class=\\\"::{ 'hollow': !mobile.isMobile, 'dark': mobile.isMobile }\\\" analytics-click=\\\"['compareCart modal cancel button', 'click']\\\"> {{ canProceed ? lang.values.cancel : lang.values.ok }} </button> </div> </div> </div> \";","module.exports = \"<div class=\\\"cart review-cart\\\"> <progress-indicator ng-if=\\\"!mobile.isMobile && !showNotesSubs\\\" segments=progressSegments current-segment=checkout-cart> </progress-indicator> <div ng-if=!loading> <h1 class=review-cart-title ng-if=\\\"::!mobile.isMobile && !config.newCheckoutFlow.cartReviewPage.enabled\\\"> {{::lang.values.reviewCart}} </h1> <div class=actions ng-if=::!mobile.isMobile> <nav class=review-cart__nav ng-if=::config.newCheckoutFlow.cartReviewPage.enabled aria-label=breadcrumbs> <ul class=breadcrumbs> <li> <a ui-sref=main.home class=all analytics-click=\\\"['breadcrumbs home link', 'click']\\\" aria-label={{::lang.aria.goToHomepage}}> <span class=icon-home aria-hidden=true></span> </a> </li> <li ng-repeat=\\\"breadcrumb in breadcrumbs track by $index\\\"> <span class=divider></span> <a ng-if=breadcrumb.state ng-attr-href=\\\"{{$state.href(breadcrumb.state, breadcrumb.params)}}\\\" analytics-click=\\\"['breadcrumbs link', 'click']\\\" ng-class=\\\"{active: $index == breadcrumbs.length - 1}\\\">{{breadcrumb.label}}</a> </li> </ul> </nav> <h1 class=review-cart-title--new ng-if=\\\"::!mobile.isMobile && config.newCheckoutFlow.cartReviewPage.enabled\\\"> {{::lang.values.reviewCart}} </h1> <span ng-if=::!config.newCheckoutFlow.cartReviewPage.enabled> <button id=checkout-cart-empty class=link-group ng-click=cartService.clear() analytics-click=\\\"['cart empty cart button', 'click']\\\" ng-if=!showNotesSubs> <span class=icon-trash aria-hidden=true></span> <span class=label>{{::lang.values.emptyCart}}</span> </button> <button id=checkout-cart-print class=link-group ng-click=\\\"listPrintService.printList(cartService.cart.items, lang.values.shoppingCart)\\\" analytics-click=\\\"['cart print button', 'click']\\\"> <span class=icon-print aria-hidden=true></span> <span class=label>{{::lang.values.print}}</span> </button> <add-to-list ng-if=::!config.disableSaveForLaterLists class=link-group products=cartService.cart.items toggle-style=text analytics-click=\\\"['cart add to list button', 'click']\\\"></add-to-list> </span> <div class=right ng-if=hasCartItems()> <span ng-if=::config.newCheckoutFlow.cartReviewPage.enabled> <button id=checkout-cart-empty class=link-group ng-click=cartService.clear() analytics-click=\\\"['cart empty cart button', 'click']\\\" send-analytics=!$root.modifyingOrder ng-if=!showNotesSubs> <span class=icon-trash aria-hidden=true></span> <span class=label>{{::lang.values.emptyCart}}</span> </button> <button id=checkout-cart-print class=link-group ng-click=\\\"listPrintService.printList(cartService.cart.items, lang.values.shoppingCart)\\\" analytics-click=\\\"['cart print button', 'click']\\\"> <span class=icon-print aria-hidden=true></span> <span class=label>{{::lang.values.print}}</span> </button> <add-to-list ng-if=::!config.disableSaveForLaterLists class=link-group products=cartService.cart.items toggle-style=text analytics-click=\\\"['cart add to list button', 'click']\\\"></add-to-list> </span> <div ng-class=\\\"::{'fulfillment-spacing': config.newCheckoutFlow.cartReviewPage.enabled}\\\" ng-if=hasCartItems()> <form class=left ng-if=\\\"::config.enablePromoCodes.checkout && !config.newCheckoutFlow.cartReviewPage.enabled\\\" ng-submit=addPromo(promo)> <div class=\\\"icon-left icon-coupon input-inner-button promo-code\\\"> <input class=input type=text id=checkout-cart-promo-top-input ng-model=promo.promo_code placeholder={{::lang.values.enterPromoCode}} aria-label={{::lang.aria.enterPromoCode}}> <button class=\\\"button smaller\\\" type=submit id=checkout-cart-promo-top-apply ng-if=promo.promo_code.length> {{::lang.values.apply}} </button> </div> </form> <div class=right> <button data-test=top-checkout-continue-button id=checkout-cart-top-continue ng-click=\\\"checkoutCartContinue('cart top continue button')\\\" class=button ng-disabled=\\\"cartService.isCartBelowMin() || cartService.syncing\\\" ng-class=\\\"{\\n                              'icon-after-go': !isNewCheckout,\\n                              'highlight': !isNewCheckout,\\n                              'dark': isNewCheckout\\n                          }\\\" uib-popover=\\\"{{::lang.template(\\n                            config.cartMinimum.tooltipText,\\n                            { amount: currencyFilter(getMinCartSpend()) }\\n                          )}}\\\" popover-trigger=\\\"mouseenter focus\\\" popover-class=cart-minimum-tooltip popover-enable=cartService.isCartBelowMin() popover-placement=left> <span ng-if=!cartService.syncing>{{ lang.template(lang.values.checkout, { subtotal: currencyFilter(cartService.cart.product_total) }) }}</span> <loading-dots show=cartService.syncing /> </button> </div> </div> </div> </div> <div class=mobile-actions ng-if=\\\"mobile.isMobile && showNotesSubs\\\"> <h2 class=section-divider-small> <span class=title> <span ng-if=::!inEComLightMode>{{::lang.values.editNotesOnSubstitution}}</span> <span ng-if=::inEComLightMode>{{::lang.values.editNotes}}</span> </span> </h2> <label ng-if=\\\"::(config.enableOrderNotes && mobile.isMobile)\\\" for=orderNoteInput class=\\\"bold orderNoteLabel\\\">{{::lang.values.addOrderNoteLabel}}</label> <div ng-if=::config.enableOrderNotes class=comment ng-init=\\\"showSave = false\\\"> <span aria-hidden=true class=note-icon></span> <input type=text id=orderNoteInput ng-model=cartService.cart.comment ng-blur=\\\"showSave = false; cartService.sync(); analytics.logEvent('cart save comment update', 'update')\\\" placeholder={{::lang.values.addOrderNote}} maxlength={{::config.orderNoteMaxLength}} class=notes-input aria-describedby=note-char-limit> <div ng-if=\\\"config.showNoteCharLimit && cartService.cart.comment.length\\\" class=character-count id=note-char-limit aria-live=polite aria-atomic=true ng-class=\\\"{alert: (config.orderNoteMaxLength - cartService.cart.comment.length <= 10)}\\\"> {{config.orderNoteMaxLength - cartService.cart.comment.length}} <span class=screen-reader-text>{{::lang.values.charactersRemaining}}</span> </div> </div> <div class=subs ng-if=::!inEComLightMode> <input class=checkbox ng-model=$parent.$parent.allowAllSubstitutions ng-change=toggleAllowAllSubstitutions() id=allow-all-sub-mob type=checkbox aria-label={{::lang.values.substitutionForAllItems}} analytics-click=\\\"['cart allow all substitutions checkbox', 'click']\\\"> <label aria-hidden=true class=\\\"checkbox-switch right\\\" for=allow-all-sub-mob> <span></span> </label> <div class=subs-label aria-hidden=true>{{::lang.values.allowSubstitutionCart}}</div> </div> <button class=\\\"button dark mobile-bottom\\\" fixed-to-body ng-if=showNotesSubs ng-click=\\\"cartService.isSubstitutionNotesOpen = false\\\"> {{::lang.values.done}} </button> </div> <div class=content-wrapper> <div class=review-cart-content ng-class=\\\"{'review-cart-content--new': config.newCheckoutFlow.cartReviewPage.enabled}\\\"> <div ng-if=!hasCartItems() class=not-found data-test=empty-cart-container> <div class=cart-empty-msg>{{::emptyCartMessage}}</div> <div ng-if=inCatering>{{::lang.values.seperateFromOtherCarts}}</div> <div> <a class=\\\"button hollow switch-context\\\" analytics-click=\\\"['cart continue shopping switch link', 'click']\\\" ng-click=\\\"shoppingSelectorService.open('shoppingContext')\\\" ng-if=::config.eComLight.enabled> {{::lang.values.switchShoppingMode}} </a> <a ng-if=::!mobile.isMobile class=\\\"button continue-shopping\\\" ui-sref=main.shop analytics-click=\\\"['cart continue shopping link', 'click']\\\"> {{::lang.values.continueShopping}} </a> <a ng-if=::mobile.isMobile class=\\\"button continue-shopping\\\" ui-sref=main.shop.categories analytics-click=\\\"['cart continue shopping link', 'click']\\\"> {{::lang.values.continueShopping}} </a> </div> </div> <div class=cart-content-container ng-if=hasCartItems()> <unata-side-cart-sub-menu show-notes-substitutions=cartService.isSubstitutionNotesOpen empty-list=cartService.clear() delete-checked-items=cartService.deleteCheckedItems() uncheck-all-items=cartService.uncheckAllItems() checked-items-count=cartService.getCheckedItemsCount()></unata-side-cart-sub-menu> <div ng-include=\\\"'checkoutCartTable.html'\\\"></div> </div> </div> <fulfillment-list ng-if=\\\"config.newCheckoutFlow.cartReviewPage.enabled && hasCartItems()\\\" checkout-cart-continue=checkoutCartContinue(analyticsValue)></fulfillment-list> </div> </div> <div class=cart-express-placement ng-if=\\\"express.shouldShowDynamicPlacement(IC_PLACEMENTS.SIDECART) && mobile.isMobile\\\"> <ic-express-side-cart on-clicked=handleExpressPlacementClick() on-closed=express.acknowledgePlacement(IC_PLACEMENTS.SIDECART) subtitle=icExpressSideCartSubtitle enable-retailer-theme=config.icExpress.enableRetailerTheme></ic-express-side-cart> </div> <section class=cart-upsell ng-if=\\\"shouldShowCartUpsell() && !showNotesSubs\\\" aria-labelledby=cart-upsell-header> <h2 class=\\\"section-divider-small section-divider-small--align-left\\\" id=cart-upsell-header> <span class=title>{{::lang.values.areYouForgettingSomething}}</span> </h2> <span class=\\\"ul-el items\\\" ng-if=upsellItems> <span class=\\\"li-el product\\\" ng-repeat=\\\"product in upsellItems\\\"> <div related-product product=product location=\\\"Cart Item Upsell\\\"></div> </span> </span> </section> <div class=loyalty-placement-fulfillment-list-mobile ng-if=\\\"mobile.isMobile && showLoyaltyCartPagePlacement()\\\"> <loyalty-placement savings=cartService.cart.potential_loyalty_savings></loyalty-placement> </div> <div ng-if=\\\"loading || (cartService.syncing && !hasCartItems())\\\" fixed-to-body class=view-loading-indicator></div> </div> \";","module.exports = \"<div class=\\\"cell image-cell image-cover\\\"> <div class=cell-image-wrapper> <a class=cell-image ng-class=\\\"{'arrow-cursor': imageOnly}\\\" ng-href={{url}} cell-image default-image=imageUrl promoted-media=promotedMedia use-image-tag=useImageTag></a> </div> </div>\";","module.exports = \"<div> <div modal-render={{$isRendered}} role=dialog aria-modal=true uib-modal-aria-label trap-focus class=modal uib-modal-animation-class=fade ng-class=\\\"{in: animate}\\\" ng-style=\\\"{'z-index': 1060 + index * 10 + 1, display: 'block'}\\\"> <div class=modal-dialog ng-class=\\\"size ? 'modal-' + size : ''\\\"> <span class=modal-dismiss-background data-test=modal-dismiss-background role=button ng-click=close($event); aria-label={{::lang.aria.modalClose}}></span> <div class=modal-wrapper uib-modal-transclude></div> </div> </div> </div> \";","module.exports = \"<div class=\\\"view shop\\\"> <div page-header label=$ctrl.merchandisedLandingPageName breadcrumbs=$ctrl.breadcrumbs previous-page=true></div> <div ng-if=::mobile.isMobile ng-include=\\\"'shopMenu.mobile.html'\\\"></div> <div class=collections> <div class=not-found ng-if=\\\"$ctrl.merchandisedLandingPageContent.length === 0\\\">{{::lang.values.noItemsFound}}</div> <div ng-repeat=\\\"item in $ctrl.merchandisedLandingPageContent\\\"> <div class=content-placement ng-if=\\\"item.type === 'content_placement'\\\" analytics-placement-impression=\\\"[[item.data], 'mlp', 'mlp_banners']\\\"> <a ng-click=\\\"$ctrl.handleImagePlacementClick(item.data, 'MLP Banner', $index)\\\" ng-init=$ctrl.logImpression(item.data) content-href=item.data analytics-click=\\\"['mlp banner', 'click', $index, item.data.id]\\\"> <img ng-if=::!mobile.isMobile ng-src={{$ctrl.imageTransform(util.escapeImageUrl(item.data.media.desktop.image))}} alt={{item.data.media.desktop.alt_text}} /> <img ng-if=::mobile.isMobile ng-src={{$ctrl.imageTransform(util.escapeImageUrl(item.data.media.mobile.image))}} alt={{item.data.media.mobile.alt_text}} /> </a> </div> <div ng-if=\\\"item.type === 'collection'\\\" ng-init=\\\"$ctrl.getCollection(item.data.id, $index)\\\"> <p ng-if=!$ctrl.collections[$index]> <react-lazy-loading-indicator/> </p> <unata-product-collection ng-if=$ctrl.collections[$index].items.length collection=$ctrl.collections[$index] location=\\\"Merchandised Landing Page Collection\\\" full-width=true padded=true enable-placements=true></unata-product-collection> </div> </div> </div> </div> \";","module.exports = \"<div class=\\\"cell product-cell\\\" ng-click=storeImpressionIfFeatured() analytics-product-impression=\\\"[product, location, position]\\\" send-analytics=!$root.modifyingOrder data-test=product-cell role=group aria-label={{lang.aria.product}}> <h2 ng-if=::isMobileApp class=screen-reader-text>{{::product.name}}</h2> <div ng-if=::hasUnclippedCoupon cell-overlay show-if=overlay.featuredCoupon> <span class=cell-overlay-header aria-hidden=true>{{::lang.values.relatedCoupons}}</span> <div ng-if=::overlay.featuredCoupon related-coupon coupon=overlay.featuredCoupon></div> </div> <div ng-if=::!hasUnclippedCoupon cell-overlay show-if=overlay.recoProduct> <span class=cell-overlay-header aria-hidden=true>{{::lang.values.goesWellWith}}</span> <div related-product product=overlay.recoProduct condensed-layout=true ng-if=::overlay.recoProduct location=\\\"{{ config.analyticsSourceKeys.productCellRelated }}\\\"></div> </div> <div class=product-cell__badges> <div ng-if=::showOfferBadge class=offer-badge-container ng-class=productCellBadge() ng-attr-role=\\\"{{ offerBadgeAriaRole() }}\\\" ng-attr-aria-label=\\\"{{ offerBadgeAriaLabel() }}\\\"> <span ng-if=\\\"offerType === OFFER_TYPES.BMSM\\\" class=bmsm-badge-text>{{::lang.values.bmsm}}</span> <span ng-if=\\\"offerType === OFFER_TYPES.AMOUNT_REWARD\\\"> <span class=amount-reward-badge> <span class=amount-reward-badge-value>{{offerConditionAndReward.rewardAmount}}</span> <span class=amount-reward-badge-text>{{::lang.values.off}}</span> </span> </span> <span ng-if=\\\"offerType === OFFER_TYPES.PERCENT_REWARD\\\"> <span class=percent-reward-badge> <span class=percent-reward-badge-value>{{offerConditionAndReward.rewardAmount}}%</span> <span class=percent-reward-badge-text>{{::lang.values.off}}</span> </span> </span> <span ng-if=\\\"offerType === OFFER_TYPES.BUY_X\\\"> <span class=product-reward-badge-text>{{::lang.values.buy}} {{offerConditionAndReward.conditionAmount}}<br/>{{::lang.values.get}} {{offerConditionAndReward.rewardAmount}}</span> </span> </div> <div ng-if=\\\"::hasOfferPoints && config.hasLoyaltyPoints\\\" ng-class=productCellBadge() class=offer-badge-container> <span class=points-badge-amount>{{::offerPoints}}</span> <span class=points-badge-text>{{::lang.values.points}}</span> <span class=\\\"icon-points points-badge-icon\\\"></span> </div> </div> <div class=cell-image-wrapper> <span aria-hidden=true ng-click=linkToProductDetails() class=cell-image analytics-click=\\\"['product cell image link', 'click']\\\" analytics-product-click=\\\"[product, location, offerType]\\\" send-analytics=!$root.modifyingOrder cell-image lazy-load-image=true default-image=\\\"::imageURLService.getProductImageURL(product, (mobile.isMobile ? 'medium' : 'small') )\\\" promoted-media=promotedMedia title={{::productTitle()}} ng-class=\\\"{'cell-sponsored': showSponsoredLabel || showFeaturedLabel || sponsoredByText }\\\"> </span> <div ng-if=::showSponsoredLabel class=sponsored>{{::lang.values.sponsored}}</div> <div ng-if=::sponsoredByText class=sponsored>{{::sponsoredByText}}</div> <div ng-if=::showFeaturedLabel class=sponsored>{{::lang.values.featured}}</div> </div> <div class=cell-content-wrapper> <div ng-if=\\\"product.product_config && product.product_config.options.length > 0 && !(showAisle)\\\"> <button class=cell-single-configuration ng-if=\\\"product.product_config.config_type === 'prep_style'\\\" ng-click=linkToProductDetails() aria-label=\\\"{{product.product_config.options[0].items.length}} {{::lang.aria.available}} {{product.product_config.options[0].name | pluralize}}\\\"> <span ng-if=\\\"product.product_config.options[0].items.length === 1\\\">{{product.product_config.options[0].items.length}} {{::lang.values.available}} {{product.product_config.options[0].name}}</span> <span ng-if=\\\"product.product_config.options[0].items.length !== 1\\\">{{product.product_config.options[0].items.length}} {{::lang.values.available}} {{product.product_config.options[0].name | pluralize: product.product_config.options[0].items.length}}</span> </button> <button class=cell-single-configuration ng-if=\\\"product.product_config.config_type === 'custom'\\\" ng-click=linkToProductDetails() aria-label={{::lang.values.customizable}}> <span>{{::lang.values.customizable}}</span> </button> </div> <h2 class=product-title-container> <button title=\\\"{{ productTitle() }}\\\" class=cell-title ng-class=\\\"{ 'cell-title-product-configuration': (product.product_config.config_type === 'prep_style' || product.product_config.config_type === 'custom') }\\\" ng-click=linkToProductDetails() analytics-click=\\\"['product cell name link', 'click']\\\" analytics-product-click=\\\"[product, location]\\\" send-analytics=!$root.modifyingOrder data-test=item-tile-name-button> <div class=cell-title-text ng-bind-html=productTitle()></div> <div class=cell-product-size ng-if=product.size_string>{{product.size_string}}</div> <div class=\\\"cell-aisle-label icon-solidpin\\\" ng-if=showAisle ng-bind-html=product.aisle.trim()></div> </button> </h2> <ul class=attributes ng-if=::product.tags.length> <li uib-popover={{::getTagName(tag)}} popover-trigger=\\\"mouseenter focus\\\" ng-repeat=\\\"tag in ::product.tags\\\" class=attribute tag-style tag=tag tag-location=productCell data-test=\\\"tag-cell {{::tag}}\\\" tabindex=0></li> </ul> <div ng-if=::!mobile.isMobile class=actions> <add-to-list ng-if=\\\"::!config.disableSaveForLaterLists && !product.product_config\\\" products=[product] is-external-routes-disabled=isExternalRoutesDisabled toggle-style=icon class=action></add-to-list> <div price-alert class=action product=product small=true source=product_tile ng-if=\\\"::(!config.disablePriceAlerts && !config.disablePriceAlertsOnProductCells && auth.user.status !== 'trial')\\\"></div> </div> <div ng-if=\\\"::(!config.userReviews.enabled && !config.disableUserRating && (!config.disableRecoRating || product.user_rating) && (product.reco_rating !== null || product.user_rating))\\\" rating-directive product=product disabled=disabled></div> <div class=\\\"rating flex-row-reverse\\\" ng-if=::config.userReviews.enabled> <react-rating rating=product.product_rating.average_rating rating-count=product.product_rating.user_count show-average=false label-styles=config.userReviews.styles.productCell.label icon-size=config.userReviews.styles.productCell.icons.iconSize /> </div> <div tabindex=\\\"{{::mobile.isMobile ? '-1' : config.showSaleEndDate ? '0' : '-1'}}\\\" ng-if=::showSaleRibbon() id=product_sale_ribbon_{{::product.id}} class=\\\"promo-tag price-align\\\" uib-popover=\\\"{{::lang.template(lang.values.saleEndDate, { endDate: (product.sale_end_date | apiDate:'MMM D') })}}\\\" popover-trigger=\\\"mouseenter focus\\\" popover-enable=\\\"::mobile.isMobile ? false : config.showSaleEndDate\\\" popover-placement=top-right> {{::product.promo_tag}} </div> <div tabindex=0 ng-if=::showOfferPreviewRibbon() id=product-offer-preview-ribbon-{{::product.id}} class=\\\"promo-tag offer-preview price-align\\\" uib-popover={{::product.offer_title}} popover-trigger=\\\"mouseenter focus\\\"> <div class=offer-preview-text>{{::product.offer_title}}</div> </div> <div tabindex=\\\"{{::mobile.isMobile ? '-1' : config.showSaleEndDate || !hasLoyaltyCard() ? '0' : '-1'}}\\\" ng-if=::showLoyaltyRibbon() id=product_loyalty_ribbon_{{::product.id}} class=\\\"promo-tag price-align\\\" ng-class=\\\"{'loyalty-required': !hasLoyaltyCard(), 'loyalty-price': hasLoyaltyCard()}\\\" uib-popover=\\\"{{::(hasLoyaltyCard()\\n        ? lang.template(lang.values.saleEndDate, { endDate: (product.loyalty_end_date | apiDate:'MMM D') })\\n        : lang.template(lang.values.loyaltyPricing.tagTooltip, { promo: product.promo_tag }))}}\\\" popover-enable=\\\"::mobile.isMobile ? false : config.showSaleEndDate || !hasLoyaltyCard()\\\" popover-trigger=\\\"mouseenter focus\\\" popover-placement=top-right> {{::(hasLoyaltyCard() ? product.promo_tag : lang.values.loyaltyPricing.tag)}} <span class=screen-reader-text> {{::(hasLoyaltyCard() ? lang.template(lang.values.saleEndDate, { endDate: (product.loyalty_end_date | apiDate:'MMM D') }) : lang.template(lang.values.loyaltyPricing.tagTooltip, { promo: product.promo_tag }))}} </span> </div> <div class=\\\"cell-prices product-prices\\\"> <div product-prices product=product label=priceLabel show-uom=true styles=priceStyles></div> </div> </div> <div add-to-cart small=true product=product class=product-cell-add-to-cart location={{location}} location-value=locationValue index=index ng-if=\\\"(existingConfigurationCartItems.length <= 1 || !existingConfigurationCartItems) && !showAllOptions\\\" is-product-cell=true existing-config-singular=existingConfigSingular></div> <div configurable-product-dropdown product=product location={{location}} class=\\\"product-cell-add-to-cart add-to-cart button\\\" ng-if=\\\"existingConfigurationCartItems.length > 1 || showAllOptions\\\" existing-config=existingConfigurationCartItems aggregate-quantity=aggregateQuantityCount></div> </div> \";","module.exports = \"<div class={{::$ctrl.cssClass}}> <table> <tbody> <tr class=product-total> <td>{{::$ctrl.lang.values.itemTotal}}</td> <td>{{$ctrl.totals.pre_discount_product_total | currency}}</td> </tr> <tr class=pick-fees ng-if=$ctrl.isPickFeesVisible()> <td>{{::$ctrl.lang.values.pickFees}}</td> <td>{{$ctrl.totals.pickup_fee | currency}}</td> </tr> <tr class=delivery-fees ng-if=$ctrl.isDeliveryFeesVisible()> <td>{{::$ctrl.lang.values.deliveryFees}}</td> <td>{{$ctrl.totals.delivery_fee | currency}}</td> </tr> <tr class=tip-total ng-if=\\\"$ctrl.showFees && $ctrl.totals.tip_total && $ctrl.totals.tip_total != '0'\\\"> <td>{{::$ctrl.lang.values.tip}}</td> <td data-test=checkout-tip-total>{{$ctrl.totals.tip_total | currency}}</td> </tr> <tr class=credits ng-if=$ctrl.showFees> <td>{{::$ctrl.lang.values.creditsApplied}}</td> <td>{{-$ctrl.totals.credit_total | currency}}</td> </tr> <tr class=offer-discount ng-if=$ctrl.totals.offer_total> <td>{{::$ctrl.lang.values.offerDiscount}}</td> <td>{{-$ctrl.totals.offer_total | currency}}</td> </tr> <tr class=subscription-fee ng-if=$ctrl.isSubscriptionFeesVisible()> <td>{{::$ctrl.lang.values.subscriptionTotal}}</td> <td>{{$ctrl.totals.subscription_total | currency}}</td> </tr> <tr class=tax ng-if=$ctrl.showFees> <td>{{::$ctrl.lang.values.tax}}</td> <td>{{ $ctrl.getTaxTotal() | currency }}</td> </tr> <tr class=additional-fees ng-repeat=\\\"fee in $ctrl.config.additionalFees track by fee.key\\\" ng-if=\\\"$ctrl.showFees && $ctrl.totals.additional_fees[fee.key] > 0\\\"> <td>{{::$ctrl.lang.values[fee.labelReference]}}</td> <td>{{$ctrl.totals.additional_fees[fee.key] | currency}}</td> </tr> <tr class=total ng-if=$ctrl.showFees> <td>{{::$ctrl.lang.values.estTotal}}</td> <td>{{$ctrl.getEstimatedTotal() | currency}}</td> </tr> <tr class=total ng-if=!$ctrl.showFees> <td>{{::$ctrl.lang.values.estTotal}}</td> <td>{{$ctrl.totals.product_total | currency}}</td> </tr> </tbody> <tfoot ng-if=\\\"::($ctrl.lang.values.totalsNote || $ctrl.lang.values.intentTotalsNote)\\\"> <tr class=totalsNote ng-if=::$ctrl.getTotalsNote()> <td colspan=2 ng-bind-html=::$ctrl.getTotalsNote()></td> </tr> <tr class=totalsNote ng-if=::$ctrl.lang.values.totalsNote> <td colspan=2 ng-bind-html=::$ctrl.lang.values.totalsNote></td> </tr> </tfoot> </table> </div> \";","module.exports = \"<div class=printable-list> <h1>{{title}}</h1> <p>{{store.name}}, {{store.address.address1}}, {{store.address.address2 | appendIfNotNull:', '}}{{store.address.address3 | appendIfNotNull:', '}}{{store.address.city}}, {{store.address.province}}, {{store.address.postal_code}}.</p> <table ng-repeat=\\\"(category, items) in categorizedItems\\\"> <thead> <tr> <th class=image></th> <th class=name>{{category}}</th> <th class=price>Price</th> <th class=quantity>Quantity</th> </tr> </thead> <tbody> <tr ng-repeat=\\\"item in items\\\"> <td class=image> <img class=product-image ng-src={{item.store_product.images.tile.small}} alt=\\\"{{item.store_product.name}} image\\\"> </td> <td class=name> {{item.store_product.name || item.pseudo_product.name}} <div class=configString ng-if=item.configString ng-bind-html=\\\"item.configString | linebreaks\\\"></div> <div class=comment ng-if=item.comment>{{item.comment}}</div> </td> <td class=price> <div product-prices product=item.store_product unit-price=item.unit_price> </div></td> <td class=quantity> {{item.quantity}} <span ng-if=item.store_product.order_by_weight> {{item.store_product.ordering_parameters.display_name}}</span> </td> </tr> </tbody> </table> </div> \";","module.exports = \"<div class=mobile-app-banner ng-if=\\\"!hasBannerBeenHidden && isBannerEnabled && mobile.isMobile && !mobile.isMobileApp()\\\" aria-label={{::lang.aria.goToAppStore}} ng-click=util.openExtLink(appStoreLink)> <button class=\\\"button round smaller dark icon-delete\\\" aria-label={{::lang.aria.close}} ng-click=closeBanner()></button> <img ng-src={{bannerImageUrl}} alt=Banner> </div> \";","module.exports = \"<div class=checkout-manual-upsell> <progress-indicator segments=progressSegments current-segment=checkout-manual-upsell></progress-indicator> <h1 class=section-divider> <span class=title>{{::lang.values.getMore}}</span> </h1> <div class=slider-container> <div cell-slider items=upsellProducts location=\\\"Upsell Collection\\\"></div> </div> <div class=continue-container-center> <a ui-sref={{nextState}} class=\\\"button highlight mobile-bottom mobile-fixed\\\" fixed-to-body analytics-click=\\\"['checkout upsell top continue button', 'click']\\\"> {{::lang.values.continueCheckout}} <span aria-hidden=true class=\\\"icon-after-go icon-next-styles\\\"></span> </a> </div> <div ng-if=loading fixed-to-body class=view-loading-indicator></div> </div> \";","module.exports = \"<div class=loading-dots ng-show=show> <span></span> <span></span> <span></span> </div> \";","module.exports = \"<div class=\\\"registration modal-container\\\" ng-class=\\\"{ 'registration--improved': config.enableImprovedRegistration }\\\"> <div ng-if=\\\"!(socialSignOnData.action === 'registration')\\\" class=\\\"modal-header modal-header-tabs\\\"> <button ng-if=!disableClose id=registration-close class=close ng-click=$dismiss() analytics-click=\\\"['login close button', 'click']\\\" aria-label={{::lang.aria.modalClose}}> <span class=icon-delete aria-hidden=true></span> </button> <div class=tabs role=tablist> <button role=tab id=tab-login aria-controls=panel-login aria-selected=\\\"{{view === 'login' || view === 'forgot'}}\\\" ng-if=\\\"showTab('login')\\\" ng-click=\\\"setView('login')\\\" ng-class=\\\"{active: view == 'login' || view == 'forgot'}\\\" id=registration-login class=tab> {{::lang.values.login}} </button> <button role=tab id=tab-register aria-controls=panel-register aria-selected=\\\"{{view === 'register'}}\\\" ng-if=\\\"showTab('register')\\\" ng-click=\\\"setView('register')\\\" ng-class=\\\"{active: view == 'register'}\\\" class=tab> {{::lang.values.register}} </button> </div> </div> <div ng-if=\\\"socialSignOnData.action === 'registration'\\\" class=modal-header> <button class=close ng-click=$dismiss() aria-label={{::lang.aria.modalClose}}> <span class=icon-delete aria-hidden=true></span> </button> {{::lang.values.createNewAccount}} </div> <div class=modal-content> <ic-express-signin small=true ng-if=\\\"mobile.isMobile && express.isPlacementConfigEnabled(IC_PLACEMENTS.SIGNIN)\\\" enable-retailer-theme=config.icExpress.enableRetailerTheme></ic-express-signin> <div ng-if=\\\"view == 'login' && showTab('login')\\\" role=tabpanel id=panel-login aria-labelledby=tab-login> <h1>{{::lang.values.login}}</h1> <shared-login lazy-loading error-message=error display-reset-password-link=true password-reset-fn=\\\"setView('forgot')\\\" close-modal=$close()></shared-login> </div> <div ng-if=\\\"view == 'forgot'\\\" role=tabpanel> <h1>{{::lang.values.forgotPassword}}</h1> <p ng-if=lang.values.emailPasswordReset> {{::lang.values.emailPasswordReset}} </p> <div shared-forgot-password context=mainForgotPassword></div> </div> <div ng-if=\\\"view == 'register' && showTab('register')\\\" role=tabpanel id=panel-register aria-labelledby=tab-register> <p ng-if=\\\"socialSignOnData.action === 'registration'\\\" class=social-sign-on-text> {{::config.socialSignOn.registration.descriptionText}}<br/> {{::config.socialSignOn.registration.linkText}} <button type=button class=social-sign-on-link ng-click=goToSocialLinkFlow()> {{::config.socialSignOn.registration.linkCTA}} </button> </p> <div ng-if=!config.enableImprovedRegistration> <h1>{{::lang.values.register}}</h1> <p class=required-fields-message>{{::lang.values.requiredFieldsMessage}}</p> <div register-form lazy-loading context=mainRegister social-sign-on-data=socialSignOnData subscription-code=subscriptionCode on-register=onRegister()></div> </div> <div ng-if=config.enableImprovedRegistration class=form-container> <h1 class=screen-reader-text>{{::lang.values.register}}</h1> <div register-form-improved lazy-loading context=mainRegister social-sign-on-data=socialSignOnData subscription-code=subscriptionCode on-register=onRegister()></div> </div> </div> <ic-express-signin small=true ng-if=\\\"!mobile.isMobile && express.isPlacementConfigEnabled(IC_PLACEMENTS.SIGNIN)\\\" enable-retailer-theme=config.icExpress.enableRetailerTheme></ic-express-signin> </div> </div> \";","module.exports = \" <div ng-if=isLoading class=profile-page-loading> <react-lazy-loading-indicator/> </div> <div ng-if=!isLoading> <ic-express-profile username={{auth.user.first_name}} membership-status=express.getMembershipStatus() use-ic-theme=!config.icExpress.enableRetailerTheme ng-if=\\\"express.isPlacementConfigEnabled(IC_PLACEMENTS.PROFILE) && mobileService.isMobile\\\"></ic-express-profile> <div class=express-profile-page> <div ng-if=express.topMessage class=\\\"express-profile-page__message message success\\\"> <span class=icon-checkmark-circle aria-hidden=true></span> <div class=express-profile-page__message-title>{{express.topMessage.title}}</div> <div class=express-profile-page__message-body> {{express.topMessage.message}} <a ng-click=express.dismissMessage(MESSAGE_PLACEMENTS.TOP)> {{::lang.values.dismiss}} </a> </div> </div> <div class=express-profile-page__section> <div ng-if=isCoupon() class=express-profile-page__message-coupon> <span class=\\\"express-profile-page__message-coupon-icon icon-info-i\\\" aria-hidden=true></span> <div class=express-profile-page__message-coupon-body ng-bind-html=\\\"lang.template(\\n                lang.values.icExpress.couponDurationText,\\n                { date: membershipEndDate() }\\n              )\\n            \\\"></div> </div> <h2 class=\\\"express-profile-page__title section-divider-small\\\"> <span class=title>{{::lang.values.membershipPlan}}</span> </h2> <div ng-if=express.membershipMessage class=\\\"express-profile-page__message message success\\\"> <span class=icon-checkmark-circle aria-hidden=true></span> <div class=express-profile-page__message-title>{{express.membershipMessage.title}}</div> <div class=express-profile-page__message-body> {{express.membershipMessage.message}} <a ng-click=express.dismissMessage(MESSAGE_PLACEMENTS.MEMBERSHIP)> {{::lang.values.dismiss}} </a> </div> </div> <div class=express-profile-page__content data-test=express-profile-page__content> <p> <b class=express-profile-page__current-subscription> {{ getCurrentSubscription().name }} </b> </p> <p> </p><p ng-if=\\\"isTrial() && membershipStatus().active\\\"> {{ lang.templateAsString( getCurrentSubscription().description, { days: config.icExpress.trialDays } ) }} </p> <span ng-if=isCoupon() ng-bind-html=\\\"lang.template(\\n                lang.values.icExpress.couponNextPlanText,\\n                {\\n                  date: getNextPlanDate().format('MMMM D, YYYY'),\\n                  plan: getNextSubscriptionPlan().name\\n                }\\n              )\\n            \\\"></span> <span ng-if=\\\"isTrial() && membershipStatus().active\\\" ng-bind-html=\\\"lang.template(\\n                lang.values.icExpress.trialNextPlanText,\\n                {\\n                  date: getNextPlanDate().format('MMMM D, YYYY'),\\n                  plan: getNextSubscriptionPlan().name\\n                }\\n              )\\n            \\\"></span> <br/> <span ng-if=isTrial() ng-bind-html=\\\"lang.template(lang.values.icExpress.trialRemainingDays, { days: getTrialRemainingDays() })\\\"></span> <p></p> <div ng-if=\\\"!membershipStatus().active && isTrial()\\\" class=\\\"express-profile-page__message message warn\\\"> <span class=icon-warning aria-hidden=true></span> <div class=express-profile-page__message-body> {{:: lang.template( lang.values.icExpress.trialCancellation, { date: membershipEndDate() } ) }} </div> </div> <button ng-if=showChangePlanButton() ng-disabled=isCoupon() ng-click=openPlansModal() class=\\\"button dark\\\"> {{::lang.values.changeMyPlan}} </button> <button class=\\\"button dark\\\" ng-if=\\\"!membershipStatus().active && isTrial()\\\" ng-click=revertTrialCancellation()> {{:: lang.template( lang.values.icExpress.joinExpress, { name: config.icExpress.shortName } ) }} </button> </div> </div> <div ng-if=\\\"membershipStatus().active || express.isMember()\\\" class=express-profile-page__section> <h2 class=\\\"express-profile-page__title section-divider-small\\\"> <span class=title>{{:: lang.values.payment }}</span> </h2> <div ng-if=express.paymentMessage class=\\\"express-profile-page__message message success\\\"> <span class=icon-checkmark-circle aria-hidden=true></span> <div class=express-profile-page__message-title>{{express.paymentMessage.title}}</div> <div class=express-profile-page__message-body> {{ express.paymentMessage.message }} <a ng-click=express.dismissMessage(MESSAGE_PLACEMENTS.PAYMENT)> {{:: lang.values.dismiss }} </a> </div> </div> <div class=\\\"express-profile-page__content express-profile-page__content--flex\\\"> <div class=express-profile-page__payment-method> <p> <b>{{:: lang.values.preferredPaymentMethod }}</b> </p> <p> <span ng-if=!isCoupon()> {{ currentCreditCard().provider ? lang.templateAsString( lang.values.creditCardFormat, { name: currentCreditCard().provider, lastFourDigits: currentCreditCard().last_four_digits } ) : lang.values.noCreditCardSelected }} </span> <span ng-if=isCoupon()> {{::lang.values.icExpress.couponPaymentText}} </span> </p> <button class=\\\"button dark\\\" ng-click=openAddCreditCardModal() ng-disabled=isCoupon()> {{:: lang.values.changePayment }} </button> </div> <div class=express-profile-page__next-payment> <p> <b>{{:: lang.values.nextPayment }}</b> </p> <p ng-if=!isCoupon()> {{getNextPaymentString()}} <b>{{getNextPlanString()}}</b> </p> <span ng-if=isCoupon() ng-bind-html=\\\"lang.template(\\n                lang.values.icExpress.couponReminderText,\\n                { date: membershipEndDate() }\\n              )\\\"></span> <div ng-if=express.userCurrentSubscription.subscription.send_reminder_on> <div ng-if=!isCoupon()> <p>{{ getReminderString() }}</p> </div> <button class=\\\"button dark\\\" ng-click=toggleReminder() ng-disabled=isCoupon()> {{::lang.values.turnOffReminder}} </button> </div> <div ng-if=!express.userCurrentSubscription.subscription.send_reminder_on> <p>{{:: lang.values.reminderTurnedOff }}</p> <button ng-click=toggleReminder() class=\\\"button dark\\\">{{:: lang.values.turnOnReminder }}</button> </div> </div> </div> </div> <div ng-if=\\\"membershipStatus().active || express.isMember()\\\" class=express-profile-page__section> <h2 class=\\\"express-profile-page__title section-divider-small\\\"> <span class=title>{{:: lang.values.cancellation }}</span> </h2> <div class=express-profile-page__content> <div ng-if=!isCoupon()> <p> {{:: lang.values.cancelYourMembership }} </p> </div> <span ng-if=isCoupon() ng-bind-html=lang.values.icExpress.couponCancelationText></span> <a class=\\\"button dark\\\" ui-sref=main.icExpressCancel ng-disabled=isCoupon()> {{:: lang.values.cancelMembership }} </a> </div> </div> </div> </div> \";","module.exports = \"<div class=checkout-page id=checkout-page-desktop-container autofocus tabindex=-1> <modify-order-banner></modify-order-banner> <simplified-header screen-reader-title=::lang.values.checkout></simplified-header> <main class=checkout-page__content> <div class=checkout-page__accordion> <checkout-steps ng-if=cartService.cart cart=cartService.cart initial-step=$resolve.initialStep fulfillment-type=intent.toString() on-validate-change=handleValidationChange(isValid) on-step-edit-mode=handleStepEditMode(stepID) on-payment-update=handlePaymentUpdate(payment) on-contact-update=handleContactUpdate(contact) on-checkout-exit=handleCheckoutExit() cart-type=cartType></checkout-steps> <div class=checkout-page__place-order> <div class=checkout-page__place-order__text> <span ng-bind-html=::lang.values.doneEnjoyYourDay></span> </div> <button ng-disabled=\\\"!isPlaceOrderButtonEnabled || isPlacingOrder || cartService.isCartBelowMin()\\\" class=\\\"button dark checkout-page__place-order__button\\\" id=checkout-place-order-button ng-class=\\\"{ disabled: !isPlaceOrderButtonEnabled }\\\" ng-click=placeOrder()> <span ng-if=\\\"!(cartService.isValidatingCart || cartService.syncing || isPlacingOrder)\\\">{{cartService.getPlaceOrderButtonText()}}</span> <loading-dots show=\\\"cartService.isValidatingCart || cartService.syncing || isPlacingOrder\\\"></loading-dots> </button> </div> </div> <div class=checkout-page__floating-content> <div class=checkout-page__cart-summary> <cart-summary ng-if=cartService.cart cart=cartService.cart fulfillment-type=intent.toString() total-label-text=lang.values.estTotal is-place-order-enabled=isPlaceOrderButtonEnabled current-edit-step=currentEditStep on-place-order=placeOrder() is-placing-order=isPlacingOrder cart-type=cartType></cart-summary> <div ng-hide=!showTermsAndConditions() class=checkout-page__terms-of-service ng-bind-html=termsAndConditionsMessage()></div> </div> </div> </main> </div> \";","module.exports = \"<div ng-if=::mobile.isMobile class=\\\"page-header-buttons search\\\"> <button type=button ng-if=\\\"!state.is('main.shop.flyer') && !enableFacetedSearchFilters\\\" class=\\\"icon icon-filter\\\" ng-class=\\\"{'has-search-reformulation': !!getSearchReformulationText(), 'is-spell-corrected': isSpellCorrected()}\\\" ng-click=openFilterModal() aria-label=\\\"{{::lang.aria.openModal}} - filter\\\"></button> <button type=button ng-if=\\\"!state.is('main.shop.flyer') && enableFacetedSearchFilters\\\" class=\\\"icon icon-filter\\\" ng-class=\\\"{'has-search-reformulation': !!getSearchReformulationText(), 'is-spell-corrected': isSpellCorrected()}\\\" ng-click=openFacetedFilterModal() aria-label=\\\"{{::lang.aria.openModal}} - filter\\\"></button> </div> <div class=menu ng-if=\\\"!enableFacetedSearchFilters && mobile.isMobile\\\"> <ul ng-if=hasPrimaryResults class=wrapper> <li class=search-scroll-tab ng-class=\\\"{current: !categoryId}\\\"> <button type=button ng-click=filterCategory() analytics-click=\\\"['search menu top link', 'click']\\\"> {{::lang.values.searchResultsAll}} </button> </li> <li ng-repeat=\\\"searchCat in searchCategories\\\" class=search-scroll-tab ng-class=\\\"{current: categoryId == searchCat.category.id}\\\"> <button type=button ng-click=filterCategory(searchCat.category.id) analytics-click=\\\"['search menu ' + searchCat.category.name + ' link', 'click']\\\"> {{searchCat.category.name}} ({{searchCat.count}}) </button> </li> </ul> </div> <div class=menu ng-if=\\\"enableFacetedSearchFilters && mobile.isMobile\\\"> <ul ng-if=\\\"hasPrimaryResults || hasSecondaryResults\\\" class=wrapper> <div class=search-scroll-tab ng-class=\\\"{current: !categoryId}\\\"> <button type=button ng-click=filterCategory() analytics-click=\\\"['search menu top link', 'click']\\\" data-test=departments-see-all aria-current=\\\"{{ !categoryId }}\\\"> {{::lang.values.searchResultsAll}} </button> </div> <faceted-search-categories class=mobile-faceted-search-categories search-context=\\\"'products'\\\" categories=rootCategoryFacets on-category-click=filterCategory(id) selected-category=categoryId> </faceted-search-categories> </ul> </div> <div ng-if=\\\"enableFacetedSearchFilters && !mobile.isMobile\\\"> <faceted-filters-bar tags=::filterTags facets=facets show-sort=true> </faceted-filters-bar> </div> <div ng-if=\\\"!enableFacetedSearchFilters && !mobile.isMobile\\\" filters tags=filterTags show-sort=true brands=brandNames subset=search></div> <div class=\\\"not-found left pad-left\\\" ng-if=\\\"results && !hasPrimaryResults && !hasSecondaryResults\\\"> <div ng-if=\\\"(showPickupContextSwitch || showDeliveryContextSwitch || showCateringContextSwitch) && !state.params.tags\\\"> <empty-results-context-switcher search-term=\\\"{{::term.slice(0, 50)}}\\\" show-pickup-context-switch=showPickupContextSwitch show-delivery-context-switch=showDeliveryContextSwitch show-catering-context-switch=showCateringContextSwitch> </empty-results-context-switcher> </div> <div ng-if=\\\"!(showPickupContextSwitch || showDeliveryContextSwitch || showCateringContextSwitch) || state.params.tags\\\"> {{::lang.template(lang.values.nothingFound, {searchResult: term.slice(0, 50)})}} <span ng-if=state.params.tags> <span ng-repeat=\\\"tag in tags\\\"> & {{getTagName(tag)}}<span ng-if=\\\"$index < tags.length - 1\\\"> </span> </span> </span> <span ng-if=state.params.brand_name> <span ng-repeat=\\\"brand in brands\\\"> & {{brand}}<span ng-if=\\\"$index < tags.length - 1\\\"> </span> </span> </span> </div> <div ng-if=state.params.tags> <a class=\\\"button highlight\\\" ui-sref=\\\".({tags: null, brand_name: null, group_display_name: null})\\\">{{::lang.values.tryWithoutFilters}}</a> </div> </div> <div ng-init=loadResults() data-analytic-scope={{::analyticScope}}> <placeholder-image type=productCell remove-on=\\\"results && !loading\\\" show-max=10></placeholder-image> <ol class=cell-container ng-class=\\\"{'cell-container--css-grid': results.placements.length > 0}\\\"> <li data-test=promoted-placement ng-repeat=\\\"placement in results.placements | limitTo: config.productsPerPage track by $index\\\" class=\\\"cell-wrapper mobile-span-{{($root.mobile.isMobile && placement.promoted_media.mobile.span) ? placement.promoted_media.mobile.span : 1}}\\\"> <div role=button image-cell ng-if=\\\"placement.item_type !== 'product'\\\" imageurl=\\\"\\\" ng-click=\\\"handleImagePlacementClick(placement, $index)\\\" promoted-media=placement.promoted_media class=\\\"span-{{::($root.mobile.isMobile) ? (placement.promoted_media.mobile.span || placement.promoted_media.desktop.span) : placement.promoted_media.desktop.span}}\\\" analytics-click=\\\"['search placement ID ' + placement.id + '', 'click']\\\" use-image-tag=true></div> <div product-cell ng-if=\\\"placement.item_type === 'product'\\\" product-details-modal-link=true product=placement.product location=\\\"Search Results\\\" promoted-product=true promoted-media=placement.promoted_media class=\\\"span-{{::($root.mobile.isMobile) ? (placement.promoted_media.mobile.span || placement.promoted_media.desktop.span) : placement.promoted_media.desktop.span}}\\\"></div> </li> <li ng-repeat=\\\"product in primary_results | limitTo: config.productsPerPage track by $index\\\" class=\\\"product-wrapper cell-wrapper\\\"> <div product-cell product-details-modal-link=true product=product promoted-product=product.placement location=\\\"Search Results\\\" location-value=\\\"{'id': null, 'display_name': term}\\\" index=$index></div> </li> </ol> <div ng-if=\\\"secondary_results.length > 0\\\"> <h1 class=related-results-heading>{{::lang.values.relatedSearchResults}}</h1> <ol class=cell-container> <li ng-repeat=\\\"product in secondary_results | limitTo: config.productsPerPage track by $index\\\" class=\\\"product-wrapper cell-wrapper\\\"> <div product-cell product-details-modal-link=true product=product location=\\\"Search Results\\\" location-value=\\\"{'id': null, 'display_name': term}\\\" index=$index></div> </li> </ol> </div> <div class=\\\"text-center clearfix\\\" ng-if=\\\"results && results.length > 0 && !loading\\\"> <ul ng-if=\\\"!mobile.isMobile && (results.item_count > config.productsPerPage)\\\" uib-pagination boundary-links=true previous-text=\\\"\\\" first-text=1 template-url=pagination-modified-uibootstrap-desktop.html next-text=\\\"\\\" total-items=results.item_count max-size=config.maxPaginationLinks items-per-page=config.productsPerPage ng-model=page.current class=pagination analytics-click=\\\"['search pagination', 'click']\\\"></ul> <ul ng-if=\\\"mobile.isMobile && (results.item_count > config.productsPerPage)\\\" uib-pagination boundary-links=true previous-text=Prev first-text=First template-url=pagination-modified-uibootstrap-mobile.html next-text=\\\"\\\" total-items=results.item_count max-size=config.maxPaginationLinks items-per-page=config.productsPerPage ng-model=page.current class=pagination analytics-click=\\\"['search pagination', 'click']\\\"></ul> </div> </div> \";","module.exports = \"<button class=close ng-click=\\\"$event.stopPropagation(); $dismiss()\\\" analytics-click=\\\"['shop modal close button', 'click']\\\" aria-label={{::lang.aria.modalClose}} auto-focus=true data-test=modal-close-button> <span class=icon-delete aria-hidden=true></span> </button> <unata-mobile-header-home-button ng-if=\\\":: mobile.isMobile && config.enableMobileHeaderHomeButton\\\"></unata-mobile-header-home-button> <h1 ng-if=\\\"mobile.isMobile && product\\\" class=modal-header-title>{{product.name}}</h1> <h1 ng-if=\\\"mobile.isMobile && offer\\\" class=modal-header-title>{{offer.name}}</h1> <react-cart-icon-button ng-if=\\\":: (auth.getContext().intent !== 'instore' && mobile.isMobile && !inOrderAddOnMode)\\n    && !searching\\n    && !(placement && placement.isExternalRoutesDisabled)\\\" on-click=goToNextStep() class=cart-button></react-cart-icon-button> <a ng-click=$dismiss() ng-if=\\\"(auth.getContext().intent === 'instore' && mobile.isMobile && !inOrderAddOnMode) && !searching\\\" class=list-button ui-sref=main.inStoreList.review aria-label=\\\"{{::\\n    lang.templateAsString(\\n        lang.aria.cartIconButton,\\n        { itemCount: cartService.countItems(), context: 'cart' }\\n    )\\n  }}\\\"> <div class=count ng-if=\\\"cartService.countItems() > 0\\\">{{cartService.countItems()}}</div> </a> \";","module.exports = \"<div class=product-prices> <react-product-price i18n=i18n inline=inline label=label loyalty-pricing-enabled=loyaltyPricingEnabled has-loyalty-card=hasLoyaltyCard loyalty-icon=loyaltyIcon unit-price=unitPrice styles=styles product=product show-uom=showUom show-ebt-label=showEbtLabel sale-price-override=salePriceOverride /> </div> \";","module.exports = \"<div ng-controller=HouseAccountController class=clearfix> <h2 class=section-divider-small scroll-into-view> <span class=title>{{::lang.template(lang.values.enterAccount, {account: lang.values.paymentTypes['house_account'][reservationService.reservation.timeslot.fulfillment_type]})}}</span> <span class=label>{{::lang.values.existingInstoreCustomers}}</span> </h2> <span ng-if=::config.newCheckoutFlow.checkoutPage.enabled class=\\\"new-checkout-only unata-payment-info\\\">{{payment.house_account.id}}</span> <form name=houseAccount class=\\\"form-row unata-payment-action\\\"> <div class=col-1-2> <input name=houseAccountNumber id=house-account-input class=\\\"input small\\\" type=text ng-minlength=\\\"{{::(config.shouldValidateHouseAccount ? config.maxHouseAccountLength : 0)}}\\\" ng-maxlength={{::config.maxHouseAccountLength}} required ng-model=payment.house_account.id ng-model-options=\\\"(config.shouldValidateHouseAccount ? { updateOn: 'blur' } : {})\\\" placeholder=\\\"{{::inputPlaceHolder || ''}}\\\" ng-attr-maxlength={{::config.maxHouseAccountLength}} ng-pattern=inputPattern> <div class=required-field ng-if=\\\"config.shouldValidateHouseAccount && houseAccount.houseAccountNumber.$touched && houseAccount.houseAccountNumber.$invalid\\\"> {{::lang.template(lang.values.requiredForm.houseAccount, {digitLength : config.maxHouseAccountLength})}} <div ng-if=config.houseAccountRegexPattern> {{::lang.values.requiredForm.houseAccountInvalid}} </div> </div> </div> </form> </div> \";","module.exports = \"<div class=react-image-tile> <react-image-tile fixed-content=reactProps.fixedContent images=reactProps.imagesObj link=reactProps.linkObj image-tile-title=reactProps.titleObj data-test=category-card-{{category.id}} /> </div> \";","module.exports = \"<div class=rx-upsell-modal> <react-rx-upsell-modal on-continue=(continue) on-close=(close) /> </div>\";","module.exports = \"<div class=video-modal ng-click=$dismiss()> <div class=content> <div class=modal-header> <button ng-click=$dismiss() class=close analytics-click=\\\"['video close button', 'click']\\\" aria-label={{::lang.aria.modalClose}}> <span class=icon-delete aria-hidden=true></span> </button> </div> <iframe ng-src={{src}} frameborder=0 allowfullscreen></iframe> </div> </div> \";","module.exports = \"<ul> <li ng-repeat=\\\"store in stores\\\" class=\\\"open store\\\" data-test=store-selector-store> <div class=marker>{{$index + 1}}</div> <div ng-if=!$root.mobile.isMobile class=name data-test=store-name>{{store.name}}</div> <div ng-if=$root.mobile.isMobile class=name> <div class=name-pin></div><div class=name-point></div> </div> <div class=store-info> <div class=address> <div class=name-txt>{{store.name}}</div> <div>{{store.address.address1}}</div> <div>{{store.address.address2}}</div> <div>{{store.address.address3}}</div> <div>{{store.address.city}}, {{store.address.province}}</div> <div>{{store.address.postal_code}}</div> <div>{{::lang.template(lang.values.storePhoneNumber, {number: store.phone_number})}}</div> </div> <div class=btn-box> <button ng-if=\\\"store.id != auth.user.store.id\\\" ng-click=$parent.updateHomeStore(store) id=shopping-selector-update-home-store-{{store.id}}-not-chosen class=\\\"button small\\\" analytics-click=\\\"['store selector set home store button', 'click']\\\" data-test=select-store-button>{{::lang.values.setAsHomeStore}}</button> <button ng-if=\\\"store.id == auth.user.store.id\\\" ng-click=$parent.updateHomeStore(store) id=shopping-selector-update-home-store-{{store.id}}-chosen class=\\\"button small highlight\\\" analytics-click=\\\"['store selector set home store button', 'click']\\\" data-test=select-store-button>{{::lang.values.myHomeStore}}</button> </div> <div class=flags ng-if=store.show_ecommerce> <div ng-if=store.show_pickup class=flag><i class=icon-cart aria-hidden=true></i>{{::lang.values.pickup}}</div> <div ng-if=store.show_delivery class=flag><i class=icon-delivery aria-hidden=true></i>{{::lang.values.delivery}}</div> </div> </div> </li> </ul> \";","module.exports = \"<div class=\\\"banner-form checkout-form\\\" ng-class=\\\"{'checkout-form--open': $ctrl.editMode}\\\"> <div ng-if=!$ctrl.editMode class=checkout-form__left> <banner-image banner-slug=$ctrl.userStore.store_banner.key></banner-image> </div> <div class=checkout-form__right ng-if=\\\"!$ctrl.editMode && !$ctrl.hideChevron\\\"> <button class=checkout-form__edit-button id=pickup-store-edit-button ng-click=$ctrl.enterEditMode() aria-label=\\\"{{ ::$ctrl.lang.values.expandSection }}: {{\\n        $ctrl.editMode\\n        ? $ctrl.config.lang.whereToShop\\n        : $ctrl.userStore.store_banner.name\\n      }}\\\"> </button> </div> <div class=checkout-form__content> <div class=checkout-form__content-header> <h2 class=checkout-form__title> {{ $ctrl.editMode ? $ctrl.config.lang.whereToShop : $ctrl.userStore.store_banner.name }} </h2> </div> <div ng-if=$ctrl.editMode> <div class=banner-form__selector> <alert type=warn-light disable-border=true small-text=true> {{::$ctrl.config.multipleBanners.changeStoreMessage}} </alert> </div> <div class=banner-form__selector> <banner-selector ng-if=$ctrl.hasFetchedBanners selected=$ctrl.userStore.store_banner.key banners=$ctrl.config.multipleBanners.banners available-banner-slugs=$ctrl.bannerSlugsInZip hide-unavailable-banners=true on-select=$ctrl.selectBanner(bannerSlug)> </banner-selector> </div> </div> </div> </div>\";","module.exports = \"<div class=credits> <h3>{{::lang.values.availableCredits}}</h3> <div class=\\\"left message-box\\\" ng-if=!credits data-test=no-credits-message> <p>{{::lang.values.noAvailableCredits}}</p> </div> <div class=\\\"left message-box\\\" ng-if=\\\"credits && !credits.length\\\" data-test=no-credits-in-account-message> <p>{{::lang.values.noAvailableCreditsInYourAccount}}</p> </div> <table ng-if=credits.length class=table> <thead> <tr> <td>{{::lang.values.balance}}</td> <td>{{::lang.values.dateAwarded}}</td> <td>{{::lang.values.notes}}</td> </tr> </thead> <tbody> <tr ng-repeat=\\\"credit in credits\\\" data-test=credits-row> <td>{{credit.remaining | currency}}</td> <td>{{credit.timestamp | date:\\\"MM/DD/YYYY\\\"}}</td> <td>{{credit.customer_note}}</td> </tr> </tbody> </table> </div> \";","module.exports = \"<div ng-if=offer.offer.name data-test=offer-container> <div class=offer-tile-wrapper analytics-offer-impression=\\\"[offer.offer, location]\\\" send-analytics=!$root.modifyingOrder> <div class=offer-image offer-icon offer=offer.offer></div> <div class=offer-content data-test=offer-content> <button analytics-click=\\\"['offer tile button', 'click']\\\" class=offer-details ng-click=openOfferModal(offer.offer) ng-class=\\\"{ 'noclick': !offer.offer.has_details }\\\"> <div class=offer-name ng-bind-html=offer.offer.name></div> </button> <div class=\\\"{{(offer.offer.offer_type == 'coupon')? 'clearfix' : ''}}\\\"> <button coupon-clipper is-disabled=::disableCouponClipping ng-if=\\\"offer.offer.offer_type == 'coupon'\\\" coupon=offer.offer class=\\\"button small\\\" aria-label={{::lang.aria.clipCoupon}} data-test=offer-clip-button></button> <div class=\\\"offer-info {{(offer.offer.offer_type == 'coupon') ? 'type-coupon' : ''}}\\\"> <span ng-if=offer.offer.end_date>{{lang.template(lang.values.saleEndDate, {endDate: (offer.offer.end_date | date:'MMM D':config.apiDateFormat)})}}</span> <span ng-if=\\\"offer.offer.end_date && (offer.offer.limit_total || offer.offer.limit_customer || offer.offer.limit_basket)\\\"> - </span> {{offer.offer.limit_total ? lang.template(lang.values.limitPerTotal, {limit: offer.offer.limit_total}) : ''}} {{offer.offer.limit_customer ? lang.template(lang.values.limitPerCustomer, {limit: offer.offer.limit_customer}) : ''}} {{offer.offer.limit_basket ? lang.template(lang.values.limitPerBasket, {limit: offer.offer.limit_basket}) : ''}} </div> </div> <button analytics-click=\\\"['offer tile button', 'click']\\\" class=offer-details ng-class=\\\"{ 'noclick': !offer.offer.has_details }\\\" ng-click=openOfferModal(offer.offer)> <div class=offer-tile-progress offer-progress offer-progress-data=offer ng-if=\\\"offer.offer.offer_type !== 'continuity'\\\"></div> <div ng-if=\\\"offer.offer.offer_type === 'continuity'\\\"> <div continuity-progress offer=offer></div> </div> </button> </div> </div> </div> \";","module.exports = \"<div class=\\\"timeslot-selector single-state\\\" ng-controller=TimeslotSelectorStateController> <div class=\\\"timeslot shopping-context-selection-content\\\" ng-if=!selectedTimeslot> <div class=link-container> <a href={{redirect}} class=\\\"back link\\\" aria-label={{::lang.values.back}}> <span>{{::lang.values.back}}</span> </a> <a ui-sref=main.home class=\\\"skip link\\\" aria-label={{::lang.values.skipForNow}}> <span>{{::lang.values.skipForNow}}</span> </a> </div> <h3 class=title>{{::lang.values.reserveATimeslot}}</h3> <timeslot-selectors root-level-css-class=\\\"timeslot timeslotV2\\\" fulfillment-type=shopContextIntent navigate-to-next-step=redirectToPreviousState() is-condensed=mobileService.isMobile timeslots-are-selectable=timeslotsAreSelectable is-entire-row-click=mobileService.isMobile></timeslot-selectors> </div> </div> \";","module.exports = \"<nav class=simplified-header> <h1 ng-if=$ctrl.screenReaderTitle class=screen-reader-text>{{$ctrl.screenReaderTitle}}</h1> <a ui-sref={{::$ctrl.customUiSref}} analytics-click=\\\"['nav logo', 'click']\\\" id=simplified-header-home-logo class=\\\"logo simplified-header__logo\\\"> <img src=\" + require(\"assets/images/header-logo.svg\") + \" alt={{::$ctrl.lang.values.clientName}} class=simplified-header__logo-img /> </a> </nav> \";","module.exports = \"<div class=timeslot-selector ng-controller=TimeslotSelectorController> <div class=\\\"timeslot shopping-context-selection-content\\\" ng-if=!selectedTimeslot> <div class=shopping-context-main-content ng-show=::mobile.isMobile> <div class=delivery-context> <h2 class=icon-{{shopContextIntent}}-title> <span class=\\\"icon-{{shopContextMode}} icon\\\" aria-hidden=true></span> <span>{{::shoppingContextText}}</span> </h2> </div> </div> <h2 class=timeslot-title>{{:: getTitle() }}</h2> <p ng-if=::getSubTitle()>{{:: getSubTitle() }}</p> <timeslot-selectors root-level-css-class=\\\"timeslot timeslotV2\\\" fulfillment-type=shopContextIntent navigate-to-next-step=processComplete() select-later=selectLater() on-error=onTimeslotError(response) timeslots-are-selectable=timeslotsAreSelectable is-condensed=mobileService.isMobile is-entire-row-click=mobileService.isMobile></timeslot-selectors> <div ng-if=::isSelectLaterLinkVisible> <button type=button ng-if=\\\":: timeslotsAreSelectable\\\" id=reservation-set-shopping-selector-stage-confirmation class=\\\"shopping-timeslot-skip dark\\\" ng-click=\\\"!mobileService.isMobile ? $rootScope.setShoppingSelectorStage('confirmation') : selectLater()\\\" data-test=timeslots-select-later-link> {{::lang.values.selectLater}} </button> </div> <button type=button class=\\\"button button--full-width continue-shopping\\\" ng-if=!timeslotsAreSelectable ng-click=processModalCloseClick()> {{::lang.values.continueShopping}} </button> </div> </div> \";","module.exports = \"<div class=cell-overlay ng-class=\\\"{show: showIf}\\\"> <div class=close ng-click=close()></div> <div class=cell-overlay-wrapper> <div ng-transclude></div> </div> </div>\";","module.exports = \"<div class=ic-express-timeslot ng-class=\\\"{ 'ic-theme': $ctrl.useIcTheme }\\\"> <div ng-if=$ctrl.isExpressEligible> <div class=ic-express-timeslot__title> <div ng-class=\\\"{ 'ic-theme': $ctrl.useIcTheme }\\\" class=ic-express-timeslot__checkbox> <div class=ic-express-timeslot__checkbox-content> <input id=ic-express-timeslot-checkbox class=checkbox type=checkbox ng-model=$ctrl.optedIn value=true /> <label ng-class=\\\"{ 'ic-theme': $ctrl.useIcTheme }\\\" for=ic-express-timeslot-checkbox></label> <span class=ic-express-timeslot__checkbox-label ng-class=\\\"{ 'ic-express-timeslot__checkbox-label--selected': $ctrl.optedIn }\\\"> <h2 class=text-unstyled>{{$ctrl.checkboxLabel}}</h2> </span> </div> </div> </div> <div ng-if=!$ctrl.optedIn class=ic-express-timeslot__main> <div class=ic-express-timeslot__disclaimer> <span ng-bind-html=$ctrl.express.getTermsAndConditions()></span> </div> </div> <div class=ic-express-timeslot__remaining-amount ng-if=\\\"$ctrl.optedIn && $ctrl.remainingAmount > 0\\\" ng-class=\\\"{ 'ic-theme': $ctrl.useIcTheme }\\\"> {{ $ctrl.lang.template( $ctrl.expressConfig.placements.timeslot.freeDeliveryAmountText, { amount: $ctrl.$filter('currency')($ctrl.remainingAmount) } ) }} </div> </div> <div ng-if=$ctrl.isEnrolled> <div class=\\\"ic-express-timeslot__title ic-express-timeslot__title--dark\\\"> {{:: $ctrl.lang.template( $ctrl.expressConfig.placements.timeslot.enrolledTitle, { name: $ctrl.expressConfig.name } ) }} </div> <div ng-if=\\\"$ctrl.remainingAmount <= 0\\\" class=ic-express-timeslot__member-text> {{::$ctrl.expressConfig.placements.timeslot.memberText}} </div> <div class=ic-express-timeslot__remaining-amount ng-if=\\\"$ctrl.remainingAmount > 0\\\" ng-class=\\\"{ 'ic-theme': $ctrl.useIcTheme }\\\"> {{ $ctrl.lang.template( $ctrl.expressConfig.placements.timeslot.freeDeliveryAmountText, { amount: $ctrl.$filter('currency')($ctrl.remainingAmount) } ) }} </div> </div> <div class=ic-express-timeslot__footer> <react-express-powered-by powered-by-text=$ctrl.expressConfig.placements.timeslot.logoText small=true></react-express-powered-by> </div> </div> \";","module.exports = \"<div class=mobile-header ng-if=::mobile.isMobile> <div ng-if=\\\"auth.userStoreSupportsDelivery() && auth.userStoreSupportsPickup()\\\" role=button ng-click=\\\"shoppingSelectorService.open('shoppingContext')\\\" id=reservation-fulfillment-shopping-selector-service-open-shopping-context class=change>{{::lang.values.change}}</div> <div class=\\\"section-divider-small section-divider-small--align-left\\\" ng-if=\\\"shoppingIntent === 'pickup'\\\"> {{::lang.values.pickupAtStore}} </div> <div class=\\\"section-divider-small section-divider-small--align-left\\\" ng-if=\\\"shoppingIntent === 'delivery'\\\"> {{::lang.values.delivery}} </div> </div> <div class=reservation-content> <div class=form-header> <button ng-disabled=\\\"deliveryAddressForm.$invalid || !addressValidationModalClosed || shoppingSelectorService.isShowing()\\\" ng-click=saveDeliveryAddress() id=reservation-save-delivery-address-header class=\\\"button button-checkout icon-after-go\\\" analytics-click=\\\"['fulfillment address top save button', 'click']\\\"> {{::lang.values.continue}} </button> </div> <div class=\\\"fulfillment-address clearfix\\\" ng-if=showMultipleDeliveryAddresses> <div class=fulfillment-address-form> <div class=address-list-container> <h2 class=\\\"section-divider-small section-divider-small--align-left\\\"> <span class=title>{{::lang.values.whereOrderDelivered}}</span> </h2> <address-list selectable-addresses=radio select-address-callback=$parent.deliveryAddressChanged(address) current-address=$parent.initialDeliveryAddress validate-address=config.enableExternalAddressValidation></address-list> </div> </div> </div> <div class=\\\"fulfillment-address clearfix\\\" ng-if=!showMultipleDeliveryAddresses> <div class=fulfillment-address-form> <div class=col> <form name=forms.deliveryAddressForm class=edit-address> <h2 class=\\\"section-divider-small section-divider-small--align-left\\\" ng-if=\\\"shoppingIntent === 'delivery'\\\"> <span class=title>{{::lang.values.whereOrderDelivered}}</span> </h2> <h2 class=\\\"section-divider-small section-divider-small--align-left\\\" ng-if=\\\"shoppingIntent === 'pickup'\\\"> <span class=title>{{::lang.values.confirmContactInformation}}</span> </h2> <div class=form-row> <div class=col-1-2> <input class=\\\"input small\\\" name=first_name ng-model=deliveryAddress.delivery_address.first_name type=text class=first-name placeholder=\\\"{{::lang.values.firstName}} *\\\" required aria-label=\\\"{{::lang.aria.firstName + ' ' + lang.aria.required}}\\\" maxlength={{::config.maxNameLength}}> <span class=required-field ng-if=\\\"deliveryAddressForm.first_name.$touched && deliveryAddressForm.first_name.$invalid\\\">{{::lang.values.requiredForm.firstName}}</span> </div> <div class=col-1-2> <input class=\\\"input small\\\" name=last_name ng-model=deliveryAddress.delivery_address.last_name type=text class=last-name placeholder=\\\"{{::lang.values.lastName}} *\\\" required aria-label=\\\"{{::lang.aria.lastName + ' ' + lang.aria.required}}\\\" maxlength={{::config.maxNameLength}}> <span class=required-field ng-if=\\\"deliveryAddressForm.last_name.$touched && deliveryAddressForm.last_name.$invalid\\\">{{::lang.values.requiredForm.lastName}}</span> </div> </div> <div class=form-row ng-if=\\\"shoppingIntent === 'delivery'\\\"> <input ng-model=deliveryAddress.delivery_address.company_name type=text class=\\\"input small\\\" placeholder={{::lang.values.companyName}} name=company_name aria-label={{::lang.aria.companyName}}> </div> <div class=form-row ng-if=\\\"shoppingIntent === 'delivery'\\\"> <input ng-model=deliveryAddress.delivery_address.address1 type=text class=\\\"input address1 small\\\" placeholder=\\\"{{::lang.values.addressLine1}} *\\\" name=address1 maxlength={{::config.deliveryAddressFieldsMaxLength}} required aria-label=\\\"{{::lang.aria.streetAddress + ' ' + lang.aria.required}}\\\"> <span class=required-field ng-if=\\\"deliveryAddressForm.address1.$touched && deliveryAddressForm.address1.$invalid\\\">{{::lang.values.requiredForm.address}}</span> </div> <div class=form-row ng-if=\\\"shoppingIntent === 'delivery'\\\"> <input ng-model=deliveryAddress.delivery_address.address2 type=text class=\\\"input address2 small\\\" placeholder={{::lang.values.addressLine2}} name=address2 maxlength={{::config.deliveryAddressFieldsMaxLength}} aria-label={{::lang.aria.secondAddress}}> </div> <div class=form-row ng-if=\\\"shoppingIntent === 'delivery'\\\"> <input ng-model=deliveryAddress.delivery_address.city type=text class=\\\"input small\\\" placeholder=\\\"{{::lang.values.city}} *\\\" name=city required aria-label={{::lang.aria.city}} maxlength={{config.formFieldMaxLengths.city}}> <span class=required-field ng-if=\\\"deliveryAddressForm.city.$touched && deliveryAddressForm.city.$invalid\\\">{{::lang.values.requiredForm.city}}</span> </div> <div class=form-row ng-if=\\\"shoppingIntent === 'delivery'\\\"> <div class=\\\"col-2-3 col-m-1\\\"> <div class=small province-select province=deliveryAddress.delivery_address.province province-is-required=true></div> </div> <div class=\\\"col-1-3 col-m-1\\\"> <input ng-model=deliveryAddress.delivery_address.postal_code type=text class=\\\"input postal-code small\\\" placeholder={{::lang.values.postalCode}} name=postal_code pattern={{::config.postalCodePattern}} required> <span class=required-field ng-if=\\\"deliveryAddressForm.postal_code.$touched && deliveryAddressForm.postal_code.$invalid\\\">{{::lang.values.requiredForm.postalCode}}</span> </div> </div> <div class=form-row ng-repeat=\\\"field in ::config.deliveryAddressPhoneNumberFields\\\"> <div class=col-1-2> <input type=tel ng-keyup=setPreferredPhoneNumber(field.key) ng-model=deliveryAddress[field.key] placeholder=\\\"{{::field.label}}  {{deliveryAddress.primary_number_key === field.key ? '*' : ''}}\\\" class=\\\"input small\\\" name={{::field.key}} update-on-enter ng-model-options=\\\"{updateOn: 'blur', allowInvalid: true}\\\" ng-required=\\\"deliveryAddress.primary_number_key === field.key\\\" aria-label=\\\"{{::field.label}}  {{deliveryAddress.primary_number_key === field.key ? lang.aria.required : ''}}\\\" pattern={{::config.phoneNumberPattern}} maxlength={{::config.phoneNumberMaxLength}}> <span class=required-field ng-if=\\\"deliveryAddress.primary_number_key === field.key && deliveryAddressForm[field.key].$touched && deliveryAddressForm[field.key].$invalid\\\">{{::lang.values.requiredForm.phone}}</span> </div> <div class=col-1-2> <input class=radio type=radio ng-model=deliveryAddress.primary_number_key value={{::field.key}} id=primary{{::field.key}}> <label for=primary{{::field.key}}>{{::(mobile.isMobile ? 'Preferred' : 'Mark as preferred')}}</label> </div> </div> <div ng-if=\\\"!config.disableDeliveryInstructions && shoppingIntent === 'delivery'\\\" class=field> <textarea class=\\\"input small\\\" ng-model=deliveryAddress.delivery_address.instructions rows=3 resize=false placeholder={{::lang.values.deliveryInstructionsPlaceholder}} name=instructions maxlength={{::config.deliveryNoteMaxLength}}></textarea> <span ng-if=\\\"config.showDeliveryNoteCharLimit && deliveryAddress.delivery_address.instructions.length\\\" ng-bind=\\\"config.deliveryNoteMaxLength - deliveryAddress.delivery_address.instructions.length\\\" class=\\\"character-count right\\\" ng-class=\\\"{alert: (config.deliveryNoteMaxLength - deliveryAddress.delivery_address.instructions.length <= 10)}\\\"></span> </div> </form> </div> <div class=col> <div class=store ng-if=showStoreMap> <h2 class=\\\"section-divider-small section-divider-small--align-left\\\" ng-if=\\\"shoppingIntent === 'pickup'\\\"> <span class=title>{{::lang.values.pickupAt}}:</span> </h2> <div class=clearfix> <img data-test=pickup-store-map ng-if=\\\"auth.user.store.location.latitude && auth.user.store.location.longitude\\\" ng-src=\\\"https://api.mapbox.com/styles/v1/mapbox/streets-v9/static/pin-s({{auth.user.store.location.longitude}},{{auth.user.store.location.latitude}})/{{auth.user.store.location.longitude}},{{auth.user.store.location.latitude}},7/500x300?access_token={{config.mapboxglAccessToken}}\\\" class=map alt=\\\"Fulfillment Map\\\"> <div class=address> <h3 class=store-name>{{auth.user.store.name}}</h3> <div ng-if=auth.user.store.address.address1>{{auth.user.store.address.address1}}</div> <div ng-if=auth.user.store.address.address2>{{auth.user.store.address.address2}}</div> <div ng-if=auth.user.store.address.address3>{{auth.user.store.address.address3}}</div> <div>{{auth.user.store.address.city}}, {{auth.user.store.address.province}} {{auth.user.store.address.postal_code}}</div> <div>{{auth.user.store.phone_number}}</div> </div> <div ng-if=\\\":: !config.forceStoreId\\\" class=edit-store> <button ng-click=\\\"shoppingSelectorService.open('storeSelector')\\\" id=reservation-change-store class=\\\"button small\\\" analytics-click=\\\"['fulfillment address change store button', 'click']\\\">{{::lang.values.change}}</button> </div> </div> <div class=\\\"message info\\\"> <span class=icon-error aria-hidden=true></span> <span ng-bind-html=lang.safe(lang.values.changeStoreWarning)></span> </div> </div> </div> </div> </div> <div class=\\\"form-footer clearfix\\\"> <div class=\\\"message info address-change-warning\\\" ng-if=\\\"shoppingIntent === 'delivery'\\\"> <span class=icon-error aria-hidden=true></span> <span ng-bind-html=lang.safe(lang.values.changeDeliveryAddressWarning)></span> </div> <button data-test=reservation-address-confirmation-button ng-disabled=\\\"deliveryAddressForm.$invalid || !addressValidationModalClosed || shoppingSelectorService.isShowing()\\\" ng-click=saveDeliveryAddress() fixed-to-body id=reservation-save-delivery-address-footer class=\\\"button button-checkout icon-after-go mobile-bottom mobile-fixed\\\" analytics-click=\\\"['fulfillment address bottom save button', 'click']\\\"> <b ng-if=\\\"mobile.isMobile && showCartTotals\\\">{{cartService.getCartTotalForCurrentType() | currency}} -</b> {{::lang.values.continue}} </button> </div> </div> \";","module.exports = \"<div class=stripe-form ng-class=\\\"{ 'stripe-form--solid': $ctrl.enableSolidBackground }\\\"> <form method=post id=payment-form data-test=stripe-form class=stripe-payment-form ng-submit=$ctrl.saveCreditCard()> <div ng-show=!$ctrl.cardStripeElLoaded class=view-loading-indicator></div> <div ng-show=$ctrl.cardStripeElLoaded> <div class=form-row> <stripe-element use-ic-theme=$ctrl.useIcTheme instance=$ctrl.card ng-if=$ctrl.isStripeFormInitialized> </stripe-element> <div id=card-errors role=alert>{{$ctrl.cardErrors}}</div> </div> <div class=stripe-form__actions ng-class=\\\":: { 'row buttons-box': !$ctrl.isMobile, 'buttons': ctrl.isMobile }\\\"> <div> <div ng-if=$ctrl.showSaveCreditCardCheckbox class=checkout-form__form-row> <input ng-checked=$ctrl.auth.user.opt_out_save_payment_info type=checkbox class=checkbox id=do-not-save-payment-info ng-model=$ctrl.doNotSaveCard aria-label={{::lang.values.dontSavePaymentInfo}} analytics-click=\\\"['add credit card do not save payment checkbox', 'click']\\\"/> <label class=save-card-label for=do-not-save-payment-info>{{::$ctrl.lang.values.dontSavePaymentInfo}}</label> </div> <button class=\\\"button add-card-button {{:: $ctrl.saveButtonSize }}\\\" ng-class=\\\"{'ic-theme': $ctrl.useIcTheme}\\\" ng-disabled=$ctrl.isFormSubmitting type=submit data-test=create-credit-card-button> <span ng-if=!$ctrl.isFormSubmitting> {{:: $ctrl.saveLabel || $ctrl.lang.values.addCard }} </span> <loading-dots show=$ctrl.isFormSubmitting></loading-dots> </button> <button ng-if=\\\"$ctrl.creditCards.length > 0\\\" class=stripe-form__cancel-link ng-click=$ctrl.handleFormCancelClick() ng-disabled=$ctrl.isFormSubmitting ng-class=\\\"{ 'ic-theme': $ctrl.useIcTheme }\\\" type=button> {{:: $ctrl.lang.values.cancel}} </button> </div> </div> </div></form> </div> \";","module.exports = \"<div class=offline-nav> <span class=\\\"icons left\\\"> <span ng-if=\\\"config.offlineShoppingList.enabled && $state.is('offlineList')\\\" class=icon-rewards ui-sref=offline> </span> </span> <img ng-if=\\\"$state.is('offline')\\\" class=offline-header-logo src=\" + require(\"assets/images/footer-logo.svg\") + \" fallback-src={{getDefaultHeaderImage()}}> <span ng-if=\\\"!$state.is('offline')\\\" class=header-text>{{::lang.values.offlineList}}</span> <span class=\\\"icons right\\\"> <span ng-if=\\\"config.offlineShoppingList.enabled && $state.is('offline')\\\" class=icon-list ui-sref=offlineList> <span class=count>{{::itemCount}}</span> </span> </span> </div> <div class=offline-header> <button ng-if=!offline.isOffline class=\\\"offline-retry button alert\\\" ng-class=\\\"{loading: trying}\\\" ng-click=tryAgain()>{{::lang.values.connect}}</button> <span class=offline-icon></span> <span class=offline-text>{{offline.isOffline ? lang.values.offlineMode : lang.values.youAreOffline}}</span> <div class=offline-message ng-if=\\\"$state.is('offline')\\\">{{getMessage()}}</div> </div> <div ng-if=\\\"config.offlineShoppingList.enabled && $state.is('offline')\\\" class=offline-quicklinks> <a class=\\\"quicklink icon-list\\\" ui-sref=offlineList> {{::lang.values.shoppingList}} <span class=quicklink-count> {{::itemCount}} {{::lang.values.item | pluralize:itemCount}} </span> </a> </div> \";","module.exports = \"<div class=orders> <div include-if-exists=\\\"'orderHistoryHeader.html'\\\"></div> <form class=\\\"orders-header clearfix\\\"> <div class=form-row> <div ng-if=!useMostRecentPagination class=\\\"w-220 col-m-1\\\"> <div class=\\\"select small\\\"> <span class=chevron-down aria-hidden=true></span> <select ng-model=selectedRange ng-change=\\\"resetFilterState(selectedRange, selectedType); analytics.logEvent('account orders filter', 'change')\\\" ng-options=\\\"filter as filter.name for filter in filters\\\" aria-label={{::lang.aria.selectDateRange}}></select> <div class=selected>{{selectedRange.name}}</div> </div> </div> <div class=\\\"w-220 col-m-1\\\"> <div class=\\\"select small\\\"> <span class=chevron-down aria-hidden=true></span> <select ng-model=selectedType ng-change=\\\"resetFilterState(selectedRange, selectedType)\\\" ng-options=\\\"type as type.label for type in filterTypes\\\" aria-label={{::lang.aria.selectOrderType}}></select> <div class=selected>{{selectedType.label}}</div> </div> </div> </div> </form> <div class=view-loading-indicator ng-if=!orderHistory></div> <div class=\\\"not-found left\\\" ng-if=\\\"(orderHistory | filter:filterByType).length == 0\\\"> <p>{{::lang.values.orderNotFound}}</p> <a ng-if=::!mobile.isMobile class=\\\"button continue-shopping\\\" ui-sref={{::config.continueShoppingRedirect.desktop}} analytics-click=\\\"['account list start shopping button', 'click']\\\"> {{::lang.values.startShopping}} </a> <a ng-if=::mobile.isMobile class=\\\"button continue-shopping\\\" ui-sref={{::config.continueShoppingRedirect.mobile}} analytics-click=\\\"['account list start shopping button', 'click']\\\"> {{::lang.values.startShopping}} </a> </div> <table class=table ng-if=\\\"mobile.isMobile && (orderHistory | filter:filterByType).length\\\"> <tbody> <tr ng-repeat=\\\"item in orderHistory | filter:filterByType\\\" ng-click=handleViewOrderClick(item) analytics-click=\\\"['account orderHistory order details button', 'click']\\\"> <td> <div> <div class=\\\"total right\\\">{{item.final_totals.total || item.estimated_totals.total | currency}}</div> <div class=date> {{(item.fulfillment_date || item.timestamp) | apiDate:'MMM Do, YYYY'}} {{(item.ext_data && item.ext_data.source_cart_type || item.fulfillment_type) | capitalize}} </div> </div> <div> <div class=\\\"status right\\\" ng-if=\\\"::(config.shoppingSelector.pickup.exists || config.shoppingSelector.delivery.exists)\\\">{{::lang.values.orderStatuses[item.status] || 'N/A'}}</div> <div class=location>{{item.location}}</div> </div> </td> <td class=action> <span class=icon-chevron-right></span> </td> </tr> </tbody> </table> <table ng-if=\\\"!mobile.isMobile && (orderHistory | filter:filterByType).length\\\" class=table> <thead> <tr> <td ng-if=::config.useMultiContextCart></td> <td>{{::lang.values.dateScheduled}}</td> <td>{{::lang.values.location}}</td> <td>{{::lang.values.total}}</td> <td colspan=2 ng-if=\\\"::(config.shoppingSelector.pickup.exists || config.shoppingSelector.delivery.exists)\\\"> <div uib-popover-html=lang.values.orderStatusHelp popover-trigger=\\\"mouseenter focus\\\" popover-placement=bottom-left> {{::lang.values.status}} <i class=\\\"icon icon-info-i info-icon-color\\\" aria-hidden=true></i> </div> </td> <td ng-if=\\\":: !(config.shoppingSelector.pickup.exists || config.shoppingSelector.delivery.exists)\\\"></td> </tr> </thead> <tbody> <tr ng-repeat=\\\"item in orderHistory | filter:filterByType\\\" data-test=order-history-table-order-{{$index}}> <td ng-if=::config.useMultiContextCart class=orders-table-store> <img class=orders-table-store-logo ng-src=\\\"{{loadImg(item.banner.logoImageUrl, 'images/header-logo.svg')}}\\\" alt={{::lang.values.clientName}}> <span class=orders-table-store-name>{{item.banner.name ? item.banner.name : lang.values.clientName}}</span> </td> <td>{{(item.fulfillment_date || item.timestamp) | apiDate:'MMM Do, YYYY'}} {{(item.ext_data && item.ext_data.source_cart_type || item.fulfillment_type) | capitalize}}</td> <td>{{item.location}}</td> <td>{{item.final_totals.total || item.estimated_totals.total | currency}}</td> <td ng-if=\\\"::(config.shoppingSelector.pickup.exists || config.shoppingSelector.delivery.exists)\\\" data-test=order-history-table-order-status-{{$index}}> {{::lang.values.orderStatuses[item.status] || 'N/A'}} </td> <td> <a class=\\\"button action\\\" ng-if=\\\"item.type == 'order'\\\" analytics-click=\\\"['account orderHistory order details button', 'click']\\\" ng-click=handleViewOrderClick(item)> {{::lang.values.view}} </a> <a class=\\\"button action\\\" ui-sref=\\\"main.account.orderHistory.purchase({id: item.id, selectedRange: null, selectedType: null})\\\" ng-if=\\\"item.type == 'purchase'\\\" analytics-click=\\\"['account orderHistory purchase details button', 'click']\\\"> {{::lang.values.view}} </a> </td> </tr> </tbody> </table> <div class=\\\"text-center clearfix order-pagination\\\" ng-if=\\\" useMostRecentPagination && orderHistory.length > 0\\\"> <a ng-if=\\\"orderPaginationStack.length > 0\\\" ng-click=prevPageOrders() class=\\\"pagination-right button small hollow\\\"> <span class=\\\"icon-chevron-left icon-alignment-fix\\\" aria-hidden=true></span> {{::lang.values.previousOrders}} </a> <a ng-if=\\\"order_meta.has_next_page || purchase_meta.has_next_page\\\" ng-click=\\\"nextPageOrders(order_meta.end_cursor, purchase_meta.end_cursor)\\\" class=\\\"pagination-left button small hollow\\\"> {{::lang.values.nextOrders}} <span class=\\\"icon-after-chevron-right icon-alignment-fix\\\" aria-hidden=true></span> </a> </div> </div> \";","module.exports = \"<div class=\\\"not-found left pad-left\\\" ng-if=\\\"items.length == 0 && (state.current.name !== 'main.shop.coupons' && state.current.name !== 'main.shop.recipes.saved')\\\"> <div ng-if=\\\"(showPickupContextSwitch || showDeliveryContextSwitch || showCateringContextSwitch) && !state.params.tags\\\"> <empty-results-context-switcher search-term={{::department.label}} show-pickup-context-switch=showPickupContextSwitch show-delivery-context-switch=showDeliveryContextSwitch show-catering-context-switch=showCateringContextSwitch> </empty-results-context-switcher> </div> <div ng-if=\\\"!(showPickupContextSwitch || showDeliveryContextSwitch || showCateringContextSwitch) || state.params.tags\\\"> {{::noItemsFoundMsg}} <span ng-if=state.params.tags> {{::lang.values.for}} <span ng-repeat=\\\"tag in tags\\\"> {{getTagName(tag)}} <span ng-if=\\\"$index < tags.length - 1\\\">& </span> </span> </span> </div> <div ng-if=state.params.tags> <a class=button ui-sref=\\\".({tags: null})\\\">{{::lang.values.tryWithoutFilters}}</a> </div> <div> <a ng-if=\\\"::!mobile.isMobile && !state.params.tags\\\" class=button ui-sref=main.shop.categories analytics-click=\\\"['cart continue shopping link', 'click']\\\">{{::lang.values.continueShopping}}</a> <a ng-if=\\\"::mobile.isMobile && !state.params.tags\\\" class=button ui-sref=main.shop.categories analytics-click=\\\"['cart continue shopping link', 'click']\\\">{{::lang.values.continueShopping}}</a> </div> </div> <div class=\\\"not-found left pad-left\\\" ng-if=\\\"items.length == 0 && state.current.name === 'main.shop.coupons'\\\"> {{::lang.values.noCouponsFound}} <div> <a ng-if=::!mobile.isMobile class=button ui-sref=main.shop.categories analytics-click=\\\"['cart continue shopping link', 'click']\\\">{{::lang.values.continueShopping}}</a> <a ng-if=::mobile.isMobile class=button ui-sref=main.shop.categories analytics-click=\\\"['cart continue shopping link', 'click']\\\">{{::lang.values.continueShopping}}</a> </div> </div> <div class=\\\"not-found left pad-left\\\" ng-if=\\\"items.length == 0 && state.current.name === 'main.shop.recipes.saved'\\\"> {{::lang.values.savedRecipes.noSavedRecipes}} <div> <a class=button ui-sref=main.shop.recipes analytics-click=\\\"['cart continue shopping link', 'click']\\\">{{::lang.values.savedRecipes.browseRecipes}}</a> </div> </div> <div ng-if=\\\"items && items.length > 0\\\"> <div ng-if=\\\"!mobile.isMobile && config.stickyPagination[state.current.name]\\\" class=sticky-pagination-container> <div sticky class=\\\"text-center clearfix sticky-pagination\\\" offset=152 min-width=1249 ng-include=\\\"'shopPagination.html'\\\"></div> </div> <loyalty-opt-in-placement ng-if=\\\"config.loyalty.enableLoyaltyOptInPlacements && state.current.name === 'main.shop.coupons'\\\" is-info-box=true></loyalty-opt-in-placement> <div ng-include=\\\"'cellContainer.html'\\\"></div> <div ng-if=\\\"!mobile.isMobile && !config.stickyPagination[state.current.name]\\\" class=\\\"text-center clearfix\\\" ng-include=\\\"'shopPagination.html'\\\"></div> <ul ng-if=\\\"mobile.isMobile && items.item_count > config.productsPerPage\\\" uib-pagination template-url=pagination-modified-uibootstrap-mobile.html previous-text=Prev total-items=items.item_count max-size=config.maxPaginationLinks items-per-page=config.productsPerPage ng-model=page.current class=pagination ng-click=\\\"analytics.logEvent('catalog products pagination', 'click')\\\"></ul> <div ng-if=::mobile.isMobile class=mobile-layout-extras> <button class=\\\"button link page-header-button\\\" ng-if=tree.current.pageHeaderButton ng-click=tree.current.pageHeaderButton.onclick()>{{tree.current.pageHeaderButton.label}}</button> <div ng-if=config.showShopNextCategoryPagination class=category-nav-buttons> <a ng-if=prevCategory ng-href=\\\"{{state.href(prevCategory.state, utilService.withoutPage(prevCategory.params))}}\\\" class=\\\"button hollow segment-left ellipsis prev-category\\\">{{prevCategory.name}}<span aria-hidden=true class=icon-chevron-left></span></a> <a ng-if=nextCategory ng-href=\\\"{{state.href(nextCategory.state, utilService.withoutPage(nextCategory.params))}}\\\" class=\\\"button hollow segment-right ellipsis next-category\\\">{{nextCategory.name}}<span aria-hidden=true class=icon-chevron-right></span></a> </div> </div> </div> \";","module.exports = \"<div class=\\\"rate-products view\\\"> <div ng-if=\\\"mode == 'empty'\\\" class=rate-products-empty> {{::lang.values.noProductsToRate}} </div> <div ng-if=\\\"mode == 'rating'\\\"> <div class=rate-products-message>{{message}}</div> <div class=rate-products-stack> <div ng-class=\\\"{hidden: remaining <= 1}\\\" class=\\\"rate-products-card loading loading-dark loading-large\\\"></div> <div ng-class=\\\"{hidden: remaining <= 2}\\\" class=rate-products-card></div> <div ng-class=\\\"{hidden: remaining <= 3}\\\" class=rate-products-card></div> <div class=rate-products-main-card> <div bg-img-fade=\\\"imageURLService.getProductImageURL(currentProduct, 'small')\\\" add-class-on-load=show class=image></div> <div class=rate-products-stack-progress>{{currentProductIndex + 1}}/{{products.length}}</div> <div class=rate-products-main-card-prices> <div product-prices product=currentProduct></div> </div> <div class=rate-products-main-card-name>{{currentProduct.name}}</div> <div rating-directive product=currentProduct on-rate=onRate></div> </div> </div> </div> <div ng-if=\\\"mode == 'done'\\\" class=rate-products-done> <h4>Congrats!</h4> <span ng-if=\\\"totalPointsAwarded > 0\\\">{{totalPointsMessage()}}</span> <span ng-if=\\\"totalPointsAwarded == 0\\\">{{::lang.values.allProductsRated}}</span> </div> <button ng-if=\\\"mode == 'rating'\\\" class=\\\"button highlight\\\" ng-click=nextProduct() ng-disabled=!currentProduct.user_rating> <span ng-if=\\\"products.length > currentProductIndex + 1\\\">{{::lang.values.next}}</span> <span ng-if=\\\"products.length == currentProductIndex + 1\\\">{{::lang.values.done}}</span> </button> <a ng-if=\\\"(mode == 'empty' || mode == 'done') && !mobile.isMobile\\\" class=\\\"button highlight\\\" ui-sref={{::config.continueShoppingRedirect.desktop}}>{{::lang.values.continueShopping}}</a> <a ng-if=\\\"(mode == 'empty' || mode == 'done') && mobile.isMobile\\\" class=\\\"button highlight\\\" ui-sref={{::config.continueShoppingRedirect.mobile}}>{{::lang.values.continueShopping}}</a> <div class=view-loading-indicator ng-if=\\\"mode == 'loading'\\\"></div> </div>\";","module.exports = \"<div class=\\\"recipe-details recipe-details-modal modal-container\\\"> <div class=modal-header> <button class=close ng-click=$dismiss() analytics-click=\\\"['recipe modal close button', 'click']\\\" aria-label={{::lang.aria.modalClose}}> <span class=icon-delete aria-hidden=true></span> </button> <unata-mobile-header-home-button ng-if=\\\":: mobile.isMobile && config.enableMobileHeaderHomeButton\\\"></unata-mobile-header-home-button> <div class=recipe-header-container> <span ng-if=\\\":: mobile.isMobile && config.recipeMobileHeaderSettings.inclueRecipeName\\\" class=recipe-header>{{::recipeDetails.recipe.name}}</span> </div> <unata-nav-cart ng-if=\\\":: mobile.isMobile && config.recipeMobileHeaderSettings.inclueNavCart\\\"></unata-nav-cart> </div> <div class=modal-content> <div class=wrapper> <div ng-include=\\\"'recipeDetails.html'\\\"></div> </div> </div> </div> \";","module.exports = \"<div class=\\\"alcohol-error-modal modal-container\\\"> <div class=modal-header> {{::$ctrl.isAlcoholError ? $ctrl.lang.values.error : $ctrl.lang.values.warning}} <button ng-click=$dismiss() class=close aria-label={{::$ctrl.lang.aria.close}}> <span class=icon-delete aria-hidden=true></span> </button> </div> <div class=modal-content> <div class=\\\"message warn\\\"> <span class=icon-warning aria-hidden=true></span> {{::$ctrl.lang.values.alcoholCompliance.warnMessage}} </div> <p> {{::$ctrl.lang.values.alcoholCompliance.errorPossibleReasons}} </p> <ul> <li>{{::$ctrl.lang.values.alcoholCompliance.zipCodeIneligible}}</li> <li>{{::$ctrl.lang.values.alcoholCompliance.alcoholQuantity}}</li> <li>{{::$ctrl.lang.values.alcoholCompliance.unattendedDelivery}}</li> </ul> <p> {{::$ctrl.lang.values.alcoholCompliance.errorTryAgain}} </p> <div class=alcohol-error-modal__actions> <a ui-sref=main.checkout.cart class=\\\"button dark\\\"> {{::$ctrl.isAlcoholError ? $ctrl.lang.values.ok : $ctrl.lang.values.returnToCart}} </a> </div> </div> </div> \";","module.exports = \"<div class=credit-card-list> <div class=unata-payment-ct> <div ng-repeat=\\\"creditCard in $ctrl.creditCards track by creditCard.ext_id\\\" ng-class=\\\"{\\n        'unata-selected-card': $ctrl.selectedCreditCard.ext_id === creditCard.ext_id,\\n        'credit-card-list__item--selected': $ctrl.selectedCreditCard.ext_id === creditCard.ext_id,\\n      }\\\" class=\\\"row condensed credit-card-list__item\\\" data-test=credit-card-item> <div class=credit-card-list__item-row> <div> <input class=\\\"radio row condensed\\\" id=\\\"{{:: ('credit-card-' + creditCard.ext_id)}}\\\" name=selectedCard ng-class=\\\"{'credit-card-list-selected-card': ($ctrl.selectedCreditCard && $ctrl.selectedCreditCard.ext_id) === creditCard.ext_id}\\\" ng-checked=\\\"($ctrl.selectedCreditCard && $ctrl.selectedCreditCard.ext_id) === creditCard.ext_id\\\" ng-value=creditCard ng-model=$ctrl.selectedCreditCard type=radio /> <label class=unata-payment-option ng-class=\\\"{ 'ic-theme': $ctrl.useIcTheme }\\\" for=\\\"{{:: ('credit-card-' + creditCard.ext_id)}}\\\"> {{:: $ctrl.getCardInfoString(creditCard) }} <span ng-if=$ctrl.includeExpiryDate> {{:: $ctrl.getCardExpiryString(creditCard) }} </span> </label> </div> <div ng-if=\\\"!$ctrl.disableDelete && $ctrl.showDeleteLink(creditCard)\\\" class=credit-card-list__action-container> <button id=payment-form-delete-card-button ng-click=\\\"$ctrl.onDeleteClick({ creditCard: creditCard })\\\" class=\\\"link credit-card-list__item-action credit-card-list__item-delete\\\" data-test=delete-credit-card-button> {{::$ctrl.lang.values.delete}} </button> </div> <div role=button uib-popover={{::$ctrl.lang.values.creditCardLocked}} popover-placement=\\\"auto bottom\\\" popover-trigger=\\\"mouseenter focus\\\" popover-enable=!$ctrl.mobileService.isMobile ng-if=\\\"$ctrl.selectedCreditCard.ext_id !== creditCard.ext_id && creditCard.source === $ctrl.SOURCES.INSTACART\\\" class=credit-card-list__action-container ng-click=$ctrl.handleLockedCreditCardClick() aria-label={{::$ctrl.lang.values.creditCardLocked}}> <img class=credit-card-list__item-action ng-src=\\\"{{::$ctrl.utilService.loadStaticImage('lock.svg')}}\\\" aria-hidden=true /> </div> </div> <button ng-if=\\\"!$ctrl.disableSelectButton && $ctrl.selectedCreditCard.ext_id === creditCard.ext_id\\\" ng-click=\\\"$ctrl.onSelect({ creditCard: creditCard })\\\" class=\\\"button dark credit-card-list__item-select-button credit-card-list__item-action\\\" ng-class=\\\"{'ic-theme': $ctrl.useIcTheme}\\\" data-test=select-credit-card-button> {{::$ctrl.lang.values.choosePaymentMethod}} </button> </div> </div> </div> \";","module.exports = \"<div class=\\\"ic__credit-card-modal modal-container\\\"> <div class=modal-header> {{::lang.values.changePaymentMethod}} <button ng-click=$dismiss() class=close aria-label={{::lang.aria.modalClose}}> <span class=icon-delete aria-hidden=true></span> </button> </div> <div class=modal-content> <p> {{::lang.values.chooseAPayment}} </p> <stripe-payment-form hide-title=true style-add-card-as-link=true add-card-label={{::lang.values.addNewCard}} create-credit-card-label={{::lang.values.continue}} enable-form-background=true enable-credit-card-select-button=true enable-cancel-form-button=true on-cancel-form-click=$ctrl.onCancelFormClick() on-credit-card-select=$ctrl.handleCardSelection(creditCard) squared-buttons=true show-save-credit-card-checkbox=false></stripe-payment-form> </div> </div> \";","module.exports = \"<div class=checkout-form ng-class=\\\"{'checkout-form--open': $ctrl.editMode}\\\"> <div ng-if=!$ctrl.editMode class=checkout-form__left> <ng-include class=icon src=\\\"::$ctrl.utilService.loadStaticImage('ic_pin.svg')\\\" aria-hidden=true /> </div> <div class=pickup-form__banner ng-if=\\\"!$ctrl.editMode && $ctrl.config.multipleBanners.enabled\\\"> <banner-image banner-slug=$ctrl.userStore.store_banner.key></banner-image> </div> <div class=checkout-form__right ng-if=\\\"!$ctrl.editMode && !$ctrl.hideChevron\\\"> <button class=checkout-form__edit-button id=pickup-store-edit-button ng-click=$ctrl.enterEditMode() aria-label=\\\"{{ ::$ctrl.lang.values.expandSection }}: {{ ::$ctrl.lang.values.pickupStore }}\\\"> </button> </div> <div class=checkout-form__content> <div class=checkout-form__content-header> <div ng-if=$ctrl.editMode> <ng-include class=icon src=\\\"::$ctrl.utilService.loadStaticImage('ic_pin.svg')\\\"/> </div> <h2 class=checkout-form__title> {{ $ctrl.editMode ? $ctrl.title : $ctrl.userStore.name || $ctrl.title }} </h2> </div> <div ng-if=!$ctrl.editMode class=checkout-form__readonly> <div ng-if=$ctrl.userStore.address> {{ $ctrl.userStore.address.address1 }}, {{ $ctrl.userStore.address.province }} {{ $ctrl.userStore.address.postal_code }} </div> </div> <div ng-if=$ctrl.editMode class=checkout-form__form> <div class=checkout-form__alert ng-if=::$ctrl.config.multipleBanners.enabled> <alert type=warn-light disable-border=true small-text=true> {{::$ctrl.config.multipleBanners.changeStoreMessage}} </alert> </div> <form ng-submit=$ctrl.searchAddress()> <label class=pickup-form__label for=pickup-store-search-input> {{:: $ctrl.lang.template( $ctrl.lang.values.enterCityOrPostalCode, { postalCode: $ctrl.lang.values.postalCode } ) }} </label> <input class=\\\"input small\\\" ng-model=$ctrl.searchTerm placeholder=\\\"{{::$ctrl.lang.template($ctrl.lang.values.enterCityOrPostalCode, { postalCode: $ctrl.lang.values.postalCode })}}\\\" type=text id=pickup-store-search-input /> </form> <div class=pickup-form__map> <stores-map current-location=$ctrl.currentLocation map-id=pickup-form-map stores=$ctrl.stores selected-store=$ctrl.selectedStore on-store-select=$ctrl.handleMapStoreSelect(store)> </stores-map> </div> <div class=pickup-form__stores-list> <store-list stores=$ctrl.filteredStores selected-store=$ctrl.selectedStore apply-button-text=$ctrl.lang.values.pickupStoreTitle on-store-select=$ctrl.selectStore(store) on-store-apply=$ctrl.applyStore(store)> </store-list> </div> </div> </div> </div>\";","module.exports = \"<div data-test=shop-ingredients-modal class=\\\"shop-this-recipe-modal modal-container\\\"> <div class=modal-header> <h1 class=modal-header-title>{{::lang.values.shopThisRecipe}}</h1> <button class=close ng-click=$dismiss() aria-label={{::lang.aria.modalClose}}> <span class=icon-delete aria-hidden=true></span> </button> </div> <div class=modal-content> <recipe-products products=::shopThisRecipeModal.products></recipe-products> </div> </div> \";","module.exports = \"<div ng-if=\\\"!$ctrl.mobileService.isMobile && $ctrl.cartService.cart.order\\\" class=order-modify> <div class=wrapper> <span ng-if=$ctrl.cartService.cart.order.can_modify> <a ui-sref=\\\"main.account.orderHistory.order({id: {{::$ctrl.cartService.cart.order.id}} })\\\" id=nav-main-account-orderhistory-order> <span class=title-text>{{::$ctrl.lang.template($ctrl.lang.values.modifyingOrderNumber, {orderId: $ctrl.cartService.cart.order.id})}}: <span ng-if=$ctrl.shoppingIntentTitle>{{::$ctrl.shoppingIntentTitle}}</span><span ng-if=$ctrl.reservationService.reservation>, {{ $ctrl.reservationService.reservation | reservationScheduleToString }} </span> </span> <span class=subtitle-text>{{::$ctrl.lang.values.modifyingOrderInstructions}}</span> </a> </span> <span class=title-text ng-if=!$ctrl.cartService.cart.order.can_modify> {{::$ctrl.lang.values.orderCantBeModified}} </span> <button id=nav-cart-cancel-order class=header-link ng-click=$ctrl.cartService.cancelOrderModification() analytics-click=\\\"['nav order modify cancel button', 'click']\\\"> {{::$ctrl.lang.values.discardChanges}} </button> </div> {{::$ctrl.finishedRender()}} </div> <div ng-if=\\\"$ctrl.mobileService.isMobile && $ctrl.cartService.cart.order\\\" class=mobile-order-modify> <div class=wrapper> <span class=text-container ng-if=$ctrl.cartService.cart.order.can_modify> <a ui-sref=\\\"main.account.orderHistory.order({id: {{::$ctrl.cartService.cart.order.id}} })\\\" id=nav-main-account-orderhistory-order> <span class=title-text>{{::$ctrl.lang.template($ctrl.lang.values.modifyingOrderNumber, {orderId: $ctrl.cartService.cart.order.id})}}: <span ng-if=$ctrl.shoppingIntentTitle>{{::$ctrl.shoppingIntentTitle}}</span><span ng-if=$ctrl.reservationService.reservation>, {{ $ctrl.reservationService.reservation | reservationScheduleToString }} </span></span> <span class=subtitle-text>{{::$ctrl.lang.values.modifyingOrderInstructions}}</span> </a> </span> <span class=title-text ng-if=!$ctrl.cartService.cart.order.can_modify> {{::$ctrl.lang.values.orderCantBeModified}} </span> <button id=nav-cart-cancel-order ng-click=$ctrl.cartService.cancelOrderModification() analytics-click=\\\"['nav order modify cancel button', 'click']\\\" aria-label={{::$ctrl.lang.values.cancelOrder}}> {{::$ctrl.lang.values.discardChanges}} </button> </div> {{::$ctrl.finishedRender()}} </div> \";","module.exports = \"<div class=store-selection-content ng-controller=\\\"StoreSelectorMapController as storeMap\\\"> <div class=store-search-wrapper> <div ng-if=::storeMap.mobile.isMobile class=mobile-context-title> <div class=shopping-context-header> <span aria-hidden=true class=icon ng-class=\\\"{\\n            'icon-pickup': shopContextIntent == 'pickup',\\n            'icon-list': shopContextIntent == 'instore',\\n            'icon-delivery': shopContextIntent == 'delivery'\\n          }\\\"></span> <span role=heading aria-level=1 class=shopping-context-text> {{storeMap.shoppingContextText}} </span> </div> </div> <div class=search-filter> <h2>{{::lang.values.selectYourHomeStore}}</h2> <div ng-if=\\\"storeMap.shopContextIntent === 'pickup' && storeMap.config.showPickupOnly\\\"> <input class=\\\"checkbox checkbox--compact\\\" type=checkbox id=shopping-selector-filter-stores ng-model=storeMap.storeFilters.onlyShowPickup ng-true-value=true ng-false-value=\\\"\\\" ng-change=storeMap.filterMarkers()> <label for=shopping-selector-filter-stores class=search-filter__label> {{::lang.values.pickupLocationsOnly}} </label> </div> </div> <div class=search> <form ng-submit=\\\"storeMap.search(); analytics.logEvent('store selector search', 'submit', 'search', storeMap.terms)\\\"> <div class=search__buttons> <button type=button class=\\\"search__use-location icon-location-arrow\\\" ng-click=storeMap.useMyLocation()>Use my location</button> <label for=shopping-selector-search-cities>Enter City or Zip</label> </div> <div class=search-input-container> <span class=\\\"icon-left icon-search icon-large\\\" aria-hidden=true></span> <input name=cityZipInput type=text class=input id=shopping-selector-search-cities ng-model=storeMap.terms placeholder=\\\"Enter City or {{::lang.values.postalCode}}\\\" aria-label=\\\"{{::lang.aria.enter + ' ' + lang.aria.city + ' or ' + lang.values.postalCode}}\\\"> </div> </form> </div> </div> <div class=store-map> <multiple-banner-tabs ng-if=\\\"config.multipleBanners.enabled && !config.multipleBanners.enableNonTabulatedView\\\" tabs-config=config.multipleBanners tab-selected=storeMap.updateBannerFilter(bannerSlug) current-value=storeMap.storeFilters.banner_slug></multiple-banner-tabs> <div class=map-wrapper ng-class=\\\"{'collapse': !storeMap.showMap}\\\"> <button ng-click=storeMap.toggleMap() ng-if=::storeMap.config.hideStoreSelectorMapOnInit class=map-toggle data-test=map-toggle><span class=icon-map aria-hidden=true></span>{{storeMap.showMap ? 'Hide' : 'Show'}} Map</button> <div class=map id=storeSelectorMap ng-class=\\\"{'hide': !storeMap.showMap}\\\" role=region aria-label=map></div> </div> <p ng-if=\\\"storeMap.shopContextIntent == 'pickup' && isThereAnError()\\\" class=selection-error-msg ng-bind-html=getErrorMessage()></p> <div class=stores-wrapper ng-class=\\\"{loading: !storeMap.stores || storeMap.locationLookupInProgress}\\\"> <div class=\\\"view-loading-indicator fill\\\" ng-if=\\\"!storeMap.stores || storeMap.locationLookupInProgress\\\"></div> <div class=\\\"stores stores-scroll-flag\\\"> <div class=not-found ng-if=\\\"storeMap.stores.length == 0\\\">{{::lang.values.noStoresFound}}</div> <div ng-if=::storeMap.mobile.isMobile ng-include=\\\"'storeSelectorMapStores.mobile.html'\\\"></div> <div ng-if=::!storeMap.mobile.isMobile ng-include=\\\"'storeSelectorMapStores.desktop.html'\\\"></div> </div> </div> </div> </div> \";","module.exports = \"<div class=react-add-to-cart-button ng-class=\\\"{'in-cart': cartItem && quantity}\\\"> <div> <react-add-to-cart-button variant=variant theme-variant=themeVariant full-width=fullWidth add-icon=addIcon on-remove=(onRemove) on-add=(onAdd) children=addToCartContent active=\\\"cartItem.quantity && quantity\\\" show-remove=\\\"!product.order_by_weight ? quantity : addToCartContent\\\" label-button-props=labelButtonProps placeholder=placeholder on-drop-down-select=(onDropDownSelect) styles=reactStyles items=items size=size color=color> </react-add-to-cart-button> <div ng-if=\\\"mobile.isMobile && product.order_by_weight\\\"> <div class=select-button> <select pass-to-ctrl=passToCtrl ng-model=$parent.quantity ng-change=\\\"updateWeight(configuration, $parent.quantity); appReviewCheck();\\\" aria-label={{::lang.aria.updateWeight}} ng-options=\\\"weight.value as weight.label for weight in orderWeightOptions\\\" data-test=add-to-cart-button-select></select> </div> </div> </div> </div> \";","module.exports = \"<div class=ways-to-shop> <div page-header label=\\\"'Ways To Shop'\\\"></div> <div quickshop></div> <div ng-if=\\\"!config.disableCollections && collectionsContent.length\\\" class=collections analytics-placement-impression=\\\"[collectionsContent, 'ways_to_shop']\\\"> <div class=section-divider-wrapper> <h2 class=\\\"section-divider-small section-divider-small--align-left\\\"> <div class=title>{{::lang.values.shopHomepageCollectionsHeader}}</div> </h2> </div> <a ng-repeat=\\\"banner in collectionsContent\\\" ng-click=\\\"logPromotedPlacement(banner, 'Catalog Home Collection', $index)\\\" ng-init=canvas.logImpression(banner) content-href=banner class=collection analytics-click=\\\"['catalog home collection', 'click', $index]\\\"> <img ng-src={{util.escapeImageUrl(banner.media.image)}} alt={{banner.media.alt_text}}> <div ng-if=banner.target.collection.name class=label> {{banner.target.collection.name}} <span class=image-label__icon aria-hidden=true></span> </div> </a> </div> <div class=banners ng-if=bannerContent.length analytics-placement-impression=\\\"[bannerContent, 'ways_to_shop']\\\"> <div class=section-divider-wrapper> <h2 class=\\\"section-divider-small section-divider-small--align-left\\\"> <div class=title>{{::lang.values.shopHomepageBannersHeader}}</div> </h2> </div> <a ng-repeat=\\\"banner in bannerContent\\\" ng-click=\\\"logPromotedPlacement(banner, 'Catalog Home Banner', $index)\\\" ng-init=canvas.logImpression(banner) content-href=banner class=banner analytics-click=\\\"['catalog home banner', 'click', $1]\\\"> <img ng-src={{util.escapeImageUrl(banner.media.image)}} alt={{banner.media.alt_text}}> </a> </div> </div> \";","module.exports = \"<div class=confirmation-new data-test=confirmation-page-v2> <div class=confirmation-new__top-section> <div ng-if=::!isMobile class=confirmation-new__top-section-left> <div ng-if=!isSubscribed class=confirmation-new__title> <span role=heading aria-level=1> <i class=\\\"icon-checkmark-circle icon\\\" aria-hidden=true></i> {{ ::order.fulfillment_type === 'delivery' ? lang.values.orderSuccessDelivery : lang.values.orderSuccessPickup }} {{::timeslotLabelFn()}} </span> </div> <div ng-if=isSubscribed class=confirmation-new__title> <i class=\\\"icon-checkmark-circle icon\\\" aria-hidden=true></i> {{ ::expressOrderSuccessText }} </div> <div class=confirmation-new__subtitle> <p ng-if=::lang.values.globalOrderSuccessMessage class=confirmation-new__subtitle>{{ ::lang.values.globalOrderSuccessMessage }}</p> <p>{{ order.store_order_message || lang.values.orderSuccessSubtitle }}</p> </div> </div> <div ng-if=::isMobile class=confirmation-new__top-section-left> <a class=close-button ui-sref=main.shop.categories aria-label={{::lang.values.close}} ng-if=::utilService.isMobileDotComHeaderPresent()></a> <div class=confirmation-new__company-logo> <img src=\" + require(\"assets/images/small-logo.svg\") + \" alt={{::$ctrl.lang.values.clientName}} /> </div> <p ng-if=::lang.values.globalOrderSuccessMessage>{{ ::lang.values.globalOrderSuccessMessage }}</p> <p>{{ order.store_order_message || lang.values.orderSuccessSubtitle }}</p> <div ng-if=!isSubscribed class=confirmation-new__subtitle> {{ ::order.fulfillment_type === 'delivery' ? lang.values.orderSuccessDelivery : lang.values.orderSuccessPickup }} <br/> <span class=confirmation-new__date> {{::timeslotLabelFn()}} </span> </div> <div ng-if=isSubscribed class=confirmation-new__subtitle> {{ ::expressOrderSuccessText }} </div> </div> <div ng-if=\\\"!isMobile && !remainingCartType\\\" class=confirmation-new__top-section-right> <a ui-sref=main.shop.categories class=\\\"button dark\\\">{{ ::lang.values.continueShopping }}</a> </div> </div> <div ng-if=remainingCartType class=\\\"message warn-light confirmation-new__remaining-cart-alert\\\"> <span class=icon-warning aria-hidden=true></span> <div> <div class=message-title role=heading aria-level=2> {{ ::lang.templateAsString( lang.values.remainingCartMessageTitle, { cartType: lang.values.cartTypes[remainingCartType] } ) }} </div> <div> {{ ::lang.templateAsString( lang.values.remainingCartMessage, { cartSize: remainingCarts[remainingCartType].length, cartType: lang.values.cartTypes[remainingCartType] } ) }} </div> </div> <a ng-click=updateContextAndRedirectToCheckout() class=\\\"button dark\\\" href=#> {{ ::lang.templateAsString( lang.values.remainingCartCTALabel, { cartType: lang.values.cartTypes[remainingCartType] } ) }} </a> </div> <div ng-if=::!isMobile class=confirmation-new__content> <div class=confirmation-new__content-left> <div class=confirmation-new__order-detail> <div class=confirmation-new__title role=heading aria-level=2>{{ ::lang.values.orderDetails }}</div> <p id=confirmation-order-id> {{ ::lang.values.order }} #{{ ::order.id }} </p> <p id=confirmation-order-total> {{ ::lang.values.total }} {{ ::order.estimated_totals.total | currency }} </p> <p id=confirmation-order-view-details-link> <a class=confirmation-new__order-details-link ui-sref=\\\"main.account.orderHistory.order({id: order.id})\\\"> {{ ::lang.values.viewDetails }} </a> </p> </div> <div class=confirmation-new__order-schedule> <div class=confirmation-new__title role=heading aria-level=2>{{ ::lang.values.schedule }}</div> <div> <p>{{::timeslotLabelFn()}}</p> </div> </div> </div> <div class=confirmation-new__content-right> <div class=confirmation-new__title role=heading aria-level=2> {{ ::order.fulfillment_type === 'delivery' ? lang.values.deliveryAddress : lang.values.pickupStore }} </div> <div class=confirmation-new__section-header> <div class=confirmation-new__section-header-icon> <ng-include class=icon src=\\\"::utilService.loadStaticImage('ic_pin.svg')\\\" aria-hidden=true /> </div> <div class=confirmation-new__section-header-text> <div class=confirmation-new__title>{{ ::mapTitle }}</div> <span> {{ ::orderObject.city }}, {{ ::orderObject.province }} {{ ::orderObject.postal_code }}, {{ ::orderObject.address1 }} {{ ::orderObject.address2 }} {{ ::orderObject.address3 }} {{ ::orderObject.phone_number }} </span> </div> </div> <stores-map ng-if=isPickup current-location=order.store.location initial-zoom=12 map-id=confirmation-new-map stores=[order.store] selected-store=order.store> </stores-map> <div ng-if=getInstructions() class=confirmation-new__section-footer> <span>{{::getInstructions().title}}</span>: {{::getInstructions().content}} </div> </div> </div> <div ng-if=\\\"::!isMobile && orderConfirmationPlacement\\\" class=confirmation-new__placement> <button ng-click=handleImagePlacementClick(orderConfirmationPlacement)> <img ng-src={{::imageTransform(orderConfirmationPlacement.media.image)}} alt={{::orderConfirmationPlacement.media.alt_text}} /> </button> </div> </div> <div ng-if=::isMobile class=confirmation-new__mobile-content> <div class=confirmation-new__section-header> <div class=confirmation-new__section-header-icon> <ng-include class=icon src=\\\"::utilService.loadStaticImage('ic_bag.svg')\\\" aria-hidden=true /> </div> <div class=\\\"confirmation-new__section-header-text confirmation-new__section-header-text--flex\\\"> <div> <h2 id=confirmation-order-id class=confirmation-new__title> {{ ::lang.values.order }} #{{ ::order.id }} </h2> <span id=confirmation-order-total> {{ ::lang.values.total }} {{ ::order.estimated_totals.total | currency }} </span> </div> <a class=order-details-link ui-sref=\\\"main.account.orderHistory.order({id: order.id})\\\"> {{ ::lang.values.viewDetails }} </a> </div> </div> <div class=confirmation-new__section-header> <div class=confirmation-new__section-header-icon> <ng-include class=icon src=\\\"::utilService.loadStaticImage('ic_time.svg')\\\" aria-hidden=true /> </div> <div class=confirmation-new__section-header-text> <div class=confirmation-new__title>{{ ::lang.values.schedule }}</div> <span> {{::timeslotLabelFn()}} </span> </div> </div> <div class=confirmation-new__section-header> <div class=confirmation-new__section-header-icon> <ng-include class=icon src=\\\"::utilService.loadStaticImage('ic_pin.svg')\\\" aria-hidden=true /> </div> <div class=confirmation-new__section-header-text> <div class=confirmation-new__title>{{ ::mapTitle }}</div> <span> {{ ::orderObject.city }}, {{ ::orderObject.province }} {{ ::orderObject.postal_code }}, {{ ::orderObject.address1 }} {{ ::orderObject.address2 }} {{ ::orderObject.address3 }} </span> </div> </div> <stores-map ng-if=isPickup current-location=order.store.location initial-zoom=12 map-id=confirmation-new-map-mobile stores=[order.store] selected-store=order.store> </stores-map> <div ng-if=\\\"::isMobile && orderConfirmationPlacement\\\" class=confirmation-new__placement--mobile> <button ng-click=handleImagePlacementClick(orderConfirmationPlacement)> <img ng-src={{::imageTransform(orderConfirmationPlacement.media.image)}} alt={{::orderConfirmationPlacement.media.alt_text}} /> </button> </div> </div> <a ng-if=\\\"::isMobile && !remainingCartType\\\" ui-sref=main.shop.categories id=new-checkout-continue-shopping class=\\\"button dark new-checkout-continue-shopping\\\"> {{ ::lang.values.continueShopping }} </a> \";","import { config as configService } from '@instacart/enterprise-services'\nimport { getCurrentBannerConfig } from '@app/utils/banners'\n\ntype SupportedModules = 'waysToShop'\n\nexport const isModuleEnabled = (module: SupportedModules, bannerKey?: string): boolean => {\n  const config = configService.selectors.getConfig()\n  return (\n    config[module]?.enabled ||\n    Boolean(\n      bannerKey && config.multipleBanners?.enableModuleByBannerKey[module]?.includes(bannerKey)\n    )\n  )\n}\n\nexport const isWaysToShopEnabled = (): boolean => {\n  return isModuleEnabled('waysToShop', getCurrentBannerConfig()?.bannerExtId)\n}\n","export const formatCurrency = (amount: string | number) => {\n  if (!amount || Number.isNaN(amount)) {\n    return ''\n  }\n\n  let formattedAmount\n\n  if (typeof amount === 'string') {\n    formattedAmount = Number(amount)\n  } else {\n    formattedAmount = amount\n  }\n\n  return `$${formattedAmount.toFixed(2).replace(/\\d(?=(\\d{3})+\\.)/g, '$&,')}`\n}\n","module.exports = \"<div class=billing-information-form ng-class=\\\"{ 'billing-information-form--condensed': $ctrl.condensed }\\\"> <h1 class=billing-information-form__title>{{::$ctrl.title}}</h1> <div ng-if=\\\"$ctrl.fulfillmentType === 'delivery'\\\" class=billing-information-form__section> <input class=checkbox type=checkbox ng-change=selectAll() ng-model=$ctrl.sameAsDeliveryAddress id=same-as-delivery-address /> <label for=same-as-delivery-address>Same as delivery address</label> </div> <div class=billing-information-form__section ng-if=\\\"!$ctrl.sameAsDeliveryAddress || $ctrl.fulfillmentType === 'pickup'\\\"> <div class=billing-information-form__input> <input class=\\\"input small\\\" placeholder={{::$ctrl.lang.values.streetAddress}} ng-model=$ctrl.billingAddress.address1 type=text required data-test=billing-information-address-input /> </div> <div class=billing-information-form__input> <input class=\\\"input small\\\" placeholder={{::$ctrl.lang.values.city}} ng-model=$ctrl.billingAddress.city type=text required data-test=billing-information-address-city /> </div> <div class=billing-information-form__input> <div class=small class=\\\"input small\\\" province-select province=$ctrl.billingAddress.province input-id-attr=profileBillingAddressProvince data-test=billing-information-address-state></div> </div> <div class=billing-information-form__input> <input class=\\\"input small\\\" placeholder={{::$ctrl.lang.values.creditCardFields.zipCode}} ng-model=$ctrl.billingAddress.postal_code type=text required data-test=billing-information-address-zipcode /> </div> </div> </div>\";","module.exports = \"<div class=fulfillment-content> <table role=presentation> <tbody> <tr> <td class=fulfillment-shopping-intent> <h2 class=fulfillment-shopping-intent-header>{{ shoppingIntentTitle }}</h2> </td> <td class=fulfillment-list__action> <button class=table-highlight id=fulfilment-shopping-selector ng-if=showContextChangeBtn ng-click=\\\"openShoppingSummary('shoppingContext')\\\" aria-label={{::lang.aria.changeShoppingMode}} ng-disabled=$root.modifyingInstacartOrder> {{ ::lang.values.change }} </button> </td> </tr> <tr ng-if=intent.delivery()> <td> <div class=fulfillment-title>{{::lang.values.deliverTo}}</div> <div class=fulfillment-delivery-address data-test=delivery-address> <span ng-if=deliveryAddress.address1>{{ deliveryAddress.address1 }}, </span> {{ deliveryAddress.postal_code }} </div> </td> <td class=fulfillment-list__action> <delivery-zip-code on-click=openZipCodeModal() zip-code=deliveryAddress.postal_code> </delivery-zip-code> </td> </tr> <tr ng-if=\\\"config.multipleBanners.enabled && intent.delivery()\\\"> <td> <div class=fulfillment-title>{{::lang.values.from}}</div> <div class=fulfillment-list__banners> <banner-image banner-slug=userStore.store_banner.key></banner-image> <span class=banner-label>{{ userStore.store_banner.name }}</span> </div> </td> <td class=fulfillment-list__action> <button class=table-highlight id=fulfilment-banner-selector ng-click=\\\"openShoppingSummary('bannerSelector')\\\" aria-label={{::lang.aria.changeShoppingMode}} ng-disabled=$root.modifyingInstacartOrder> {{ ::lang.values.change }} </button> </td> </tr> <tr ng-if=\\\"intent.inStore() || intent.pickup()\\\"> <td ng-if=::!config.multipleBanners.enabled> <div class=fulfillment-title> {{ intent.pickup() ? lang.values.pickup : '' }} {{::lang.values.store}} </div> <div class=fulfillment-large data-test=store-name> {{ userStore.name || lang.values.selectAStore }} </div> <div class=fulfillment-large> {{ userStore.address && userStore.address.address1 }} </div> </td> <td ng-if=::config.multipleBanners.enabled> <div class=fulfillment-title> {{ intent.pickup() ? lang.values.pickup : '' }} {{::lang.values.store}} </div> <div class=multiple-banner__pickup> <div class=multiple-banner__pickup-image> <banner-image banner-slug=userStore.store_banner.key></banner-image> </div> <div class=fulfillment-large> <div> {{ userStore.address && userStore.address.address1 }} </div> <div> {{ userStore.name || lang.values.selectAStore }} </div> </div> </div> </td> <td class=fulfillment-list__action> <button class=table-highlight id=fulfilment-store-selector ng-if=showContextChangeBtn ng-click=handleChangeStoreClick() aria-label={{::lang.aria.changeStore}} ng-disabled=$root.modifyingInstacartOrder> {{::lang.values.change}} </button> </td> </tr> <tr ng-if=\\\"intent.pickup() || intent.delivery()\\\"> <td colspan=2> <div class=fulfillment-list__timeslot> <div> <span ng-if=config.shoppingContextProcess[auth.getCurrentShoppingMode()].timeslotSelectionAtCheckoutOnly> {{::lang.values.timeslotAvailable}} </span> <span ng-if=!config.shoppingContextProcess[auth.getCurrentShoppingMode()].timeslotSelectionAtCheckoutOnly> <div ng-if=intent.pickup() class=fulfillment-title> {{::lang.values.pickupTime}} </div> <div ng-if=intent.delivery() class=fulfillment-title> {{::lang.values.deliveryTime}} </div> </span> <div ng-if=reservationService.displayReservation> {{ reservationService.displayReservation | reservationScheduleToString }} </div> </div> <div ng-click=openScheduleModal()> <button class=\\\"button small\\\" id=fulfillment-add-timeslot-button ng-if=!reservationService.displayReservation aria-label={{::lang.values.changeTimeslot}}> {{::lang.values.reserve}} </button> <button class=fulfillment-list__action id=fulfillment-change-timeslot-button ng-if=reservationService.displayReservation> <span ng-if=config.shoppingContextProcess[auth.getCurrentShoppingMode()].timeslotSelectionAtCheckoutOnly> {{::lang.values.timeslotView}} </span> <span ng-if=!config.shoppingContextProcess[auth.getCurrentShoppingMode()].timeslotSelectionAtCheckoutOnly> {{::lang.values.change}} </span> </button> </div> </div> </td> </tr> <tr ng-if=\\\"config.enableOrderNotes && (intent.pickup() || intent.delivery())\\\"> <td colspan=2> <div class=fulfillment-title>{{::lang.values.orderNote}}</div> <div class=comment> <div ng-if=!orderNotesEditing> {{cartService.cart.comment}} </div> <div ng-if=orderNotesEditing class=\\\"textarea-inner-button icon-note icon-left\\\"> <textarea auto-focus=true class=input ng-model=cartService.cart.comment id=checkout-cart-note-textarea placeholder={{::lang.values.addNote}} maxlength={{::config.orderNoteMaxLength}} aria-label={{::lang.values.addNote}} aria-describedby=order-note-counter>\\n              </textarea> </div> <button class=\\\"fulfillment-list__action fulfillment-list__button-right\\\" id=checkout-cart-note-textarea-button ng-click=toggleOrderNotes()> {{orderNotesEditing ? lang.values.save : lang.values.change}} </button> </div> <div> <span aria-atomic=true aria-live=polite id=order-note-counter ng-if=\\\"config.showNoteCharLimit && cartService.cart.comment.length\\\" ng-bind=\\\"config.orderNoteMaxLength - cartService.cart.comment.length\\\" class=character-count ng-class=\\\"{alert: (config.orderNoteMaxLength - cartService.cart.comment.length <= 10)}\\\"></span> </div> </td> </tr> <tr ng-if=\\\"config.enablePromoCodes.checkout && (intent.pickup() || intent.delivery())\\\"> <td colspan=2> <span ng-if=\\\"cartService.cart.promo_codes.length > 0\\\"> <div class=fulfillment-title>{{::lang.values.promoCode}}</div> <span class=ul-el> <span data-test=cart-promo-codes class=\\\"fulfillment-title li-el\\\" ng-repeat=\\\"promoCode in cartService.cart.promo_codes track by $index\\\"> {{promoCode}} </span> </span> </span> <button class=fulfillment-list__action id=fulfillment-add-promo-code-button ng-click=openPromoCodeModal() data-test=add-promo-code-button> {{::lang.values.addAPromoCode}} </button> </td> </tr> <tr ng-if=\\\"rewards.length && auth.user.ic_linked\\\"> <td ng-repeat=\\\"reward in rewards track by reward.id\\\" colspan=2> <react-cart-loyalty-balance title-text=reward.label value=\\\"reward.amount | currency\\\" content=\\\"reward.primaryInfo + reward.secondaryInfo\\\" styles=loyaltyReactProps.styles native-href-click-handler></react-cart-loyalty-balance> </td> </tr> <tr ng-if=\\\"::(config.hasLoyaltyPoints && config.showPointsGained)\\\"> <td class=fulfillment-title>{{::lang.values.pointsGained}}</td> <td class=fulfillment-discount> {{ cartService.cart.points.awarded || 0 | number }} </td> </tr> <tr ng-if=\\\"config.enablePromoCodes.checkout && (cartService.cart.promo_codes_total | number) > 0\\\"> <td class=fulfillment-title>{{::lang.values.promoCodeApplied}}</td> <td class=fulfillment-discount> - {{ cartService.cart.promo_codes_total | currency }} </td> </tr> <tr ng-if=\\\"(cartService.cart.offer_total | number) > 0 || config.showZeroDiscount\\\"> <td class=fulfillment-title>{{::lang.values.totalOfferDiscount}}</td> <td class=fulfillment-discount> - {{ cartService.cart.offer_total | currency }} </td> </tr> <tr> <td class=fulfillment-summary colspan=2> <div class=fulfillment-title> {{::lang.values.estimatedSubTotal}} </div> <div class=fulfillment-pricing> <div class=text-right> <unata-cart-total-label label-id=fulfillment-estimated-total-label></unata-cart-total-label> </div> <div class=fulfillment-excludesTaxesAndFees> {{::lang.values.excludesTaxesAndFees}} </div> </div> </td> </tr> <tr ng-if=showLoyaltyCartPagePlacement()> <td colspan=2 class=loyalty-placement-fulfillment-list> <loyalty-placement savings=cartService.cart.potential_loyalty_savings></loyalty-placement> </td> </tr> <tr ng-if=showLoyaltyCardBalance()> <td colspan=2 class=\\\"fulfillment-title fulfillment-loyalty-balance\\\"> <react-cart-loyalty-balance title-text=loyaltyReactProps.title value=loyaltyReactProps.getValue() content=loyaltyReactProps.content styles=loyaltyReactProps.styles></react-cart-loyalty-balance> </td> <td></td> </tr> </tbody> </table> </div> <div class=fulfillment-list__bottom-actions> <div ng-if=\\\"hasCartItems() && (intent.pickup() || intent.delivery())\\\"> <div ng-if=cartService.isCartBelowMin() class=fulfillment-disabled-alert> <alert type=warn-light disable-border=true small-text=true> <span ng-bind-html=\\\"lang.template(\\n            config.cartMinimum.alertText,\\n            { amount: currencyFilter(getMinCartSpend())\\n          })\\\"></span> </alert> </div> <button ng-click=\\\"checkoutCartContinue({ analyticsValue: 'cart bottom continue button' })\\\" id=fulfillment-list-checkout-cart-top-continue class=\\\"button dark right\\\" ng-disabled=\\\"cartService.isCartBelowMin() || cartService.syncing\\\"> <span ng-if=!cartService.syncing>{{ lang.template(lang.values.checkout, { subtotal: currencyFilter(cartService.cart.product_total) }) }}</span> <loading-dots show=cartService.syncing /> </button> </div> <button ng-if=\\\"showOrderOnlineButton && intent.inStore()\\\" ng-click=\\\"openShoppingSummary('shoppingContext')\\\" id=checkout-cart-top-order-online class=\\\"button dark right\\\" analytics-click=\\\"['list top order online button', 'click']\\\"> {{::lang.values.orderOnline}} </button> <a class=\\\"button hollow continue-shopping\\\" ui-sref={{::config.continueShoppingRedirect.desktop}}> {{::lang.values.continueShopping}} </a> </div> \";","module.exports = \"<div class=profile> <div ng-if=error class=\\\"message error\\\" scroll-into-view> <span class=icon-error aria-hidden=true></span> {{error}} </div> <div ng-if=message class=\\\"message success\\\" scroll-into-view> <span class=icon-checkmark-circle aria-hidden=true></span> {{message}} </div> <react-profile-page class=native-lists disconnect-social=openDisconnectSocialAccountModal import-ic-account=importIcAccount /> </div> \";","module.exports = \"<div class=lists> <div class=clearfix> <div class=create-list> <div ng-if=creatingList> <form class=button-inline ng-submit=\\\"createList(newListName); analytics.logEvent('accounts lists create list button', 'click')\\\"> <input type=text class=\\\"input small\\\" class=new-list-name ng-model=newListName placeholder=\\\"List Name\\\" data-test=new-list-name-input /> <button class=\\\"button action small\\\" data-test=new-list-submit-button> {{::lang.values.saveForLaterListAdd}} </button> </form> </div> <button ng-if=!creatingList class=\\\"button new-list action\\\" ng-click=showCreateList() data-test=save-for-later-new-list-button analytics-click=\\\"['accounts lists create new list button', 'click']\\\"> {{::lang.values.saveForLaterListCreateNew}} </button> </div> </div> <div class=view-loading-indicator ng-if=!lists></div> <div data-test=save-for-later-no-lists class=not-found ng-if=\\\"lists.length == 0\\\">{{::lang.values.saveForLaterListsHaveNone}}</div> <table class=table ng-if=\\\"mobile.isMobile && lists.length\\\"> <tbody> <tr data-test=save-for-later-list-row ng-repeat=\\\"list in lists track by list.id\\\"> <td class=action> <button ng-click=deleteList(list) data-test=save-for-later-list-delete-button aria-label={{::lang.aria.deleteList}} class=\\\"button smaller round darker icon-delete\\\"></button> </td> <td> <a class=info ui-sref=\\\"list({list_id: list.id})\\\" analytics-click=\\\"['accounts lists list details button', 'click']\\\"> <div data-test=save-for-later-list-name class=name aria-label={{list.name}}>{{list.name}}</div> <div data-test=save-for-later-list-size class=count aria-label=\\\"{{list.items.length}} Items\\\">{{list.items.length}} {{ 'Item' | pluralize: list.items.length }}</div> </a> </td> <td class=action> <a class=icon-chevron-right ui-sref=\\\"list({list_id: list.id})\\\" aria-label=\\\"{{ list.name }} list details\\\" analytics-click=\\\"['accounts lists list details button', 'click']\\\" aria-label={{::lang.aria.goToList}}></a> </td> </tr> </tbody> </table> <table ng-if=\\\"!mobile.isMobile && lists.length\\\" class=\\\"lists-table table\\\"> <thead> <tr> <td></td> <td>{{::lang.values.saveForLaterListName}}</td> <td colspan=2>Items</td> </tr> </thead> <tbody> <tr data-test=save-for-later-list-row ng-repeat=\\\"list in lists track by list.id\\\"> <td class=action> <button ng-click=deleteList(list) aria-label={{::lang.aria.deleteList}} data-test=save-for-later-list-delete-button class=\\\"button smaller round darker icon-delete\\\"></button> </td> <td data-test=save-for-later-list-name>{{list.name}}</td> <td data-test=save-for-later-list-size>{{list.items.length}} {{ 'Item' | pluralize: list.items.length }}</td> <td><a class=\\\"button action details\\\" ui-sref=\\\"list({list_id: list.id})\\\" aria-label=\\\"{{ list.name }} list details\\\" analytics-click=\\\"['accounts lists list details button', 'click']\\\">Details</a></td> </tr> </tbody> </table> </div> \";","module.exports = \"<div class=\\\"error-modal recaptcha-modal\\\"> <div class=modal-header> {{::lang.values.confirm}} <button ng-click=$dismiss() class=close aria-label={{::lang.aria.close}}></button> </div> <div class=\\\"error-modal-content recaptcha-modal-content\\\"> <span> <recaptcha-checkbox ng-if=$ctrl.$custom.isModalRendered() class=recaptcha-container action=$ctrl.reCaptchaSetup.action on-success=$ctrl.$custom.callAndCloseFactory($ctrl.reCaptchaSetup.onRecaptchaSuccess) on-expired=$ctrl.$custom.callAndDismissFactory($ctrl.reCaptchaSetup.onRecaptchaExpired) on-render=$ctrl.reCaptchaSetup.onRecaptchaReady /> </span> </div> </div> \";","module.exports = \"<div class=\\\"flyer-preview-modal filter-modal modal-container\\\"> <div class=\\\"modal-header modal-header-collapse-desktop\\\"> <button ng-click=$dismiss() class=close id=flyer-preview-modal-x-close analytics-click=\\\"['weekly ad preview modal close button', 'click']\\\" aria-label={{::lang.aria.close}}> <span class=icon-delete aria-hidden=true></span> </button> </div> <div class=\\\"filter-modal-content modal-content\\\"> <h1 ng-if=\\\":: !$ctrl.isMobile\\\" class=flyer-preview-modal-title>Choose a {{:: $ctrl.lang.values.weeklyAd}}</h1> <section> <h2>{{:: lang.values.flyerPreviewLiveHeader}}</h2> <ul> <li class=flyer-preview-modal-flyer> <input ng-model=$ctrl.selectedPreviewToken type=radio name=selectedFlyer id=select-flyer-current value=current class=radio> <label for=select-flyer-current class=radio-button> {{:: $ctrl.currentFlyer.dateRangeLabel}} </label> <a ng-if=\\\":: ($ctrl.currentFlyer.pdfHref && !config.dotComModule.weeklyAdPath)\\\" ng-href=\\\"{{:: $ctrl.currentFlyer.pdfHref}}\\\" target=_blank class=\\\"flyer-preview-modal-flyer-pdf-link icon-download-pdf\\\" analytics-click=\\\"['current weekly flyer PDF', 'click']\\\" aria-label={{::lang.aria.curretWeeklyFlyer}}></a> <a ng-if=\\\":: config.dotComModule.weeklyAdPath\\\" ng-href=\\\"{{:: (config.dotComModule.url + config.dotComModule.weeklyAdPath)}}\\\" class=\\\"flyer-preview-modal-flyer-pdf-link icon-download-pdf\\\" analytics-click=\\\"['current weekly flyer PDF', 'click']\\\" aria-label={{::lang.aria.curretWeeklyFlyer}}></a> </li> </ul> </section> <section> <h2>{{:: lang.values.flyerPreviewUpcomingHeader}}</h2> <p ng-if=\\\":: !config.hideFlyerPreviewMessage\\\">{{:: lang.values.flyerPreviewMessage}}</p> <ul> <li ng-repeat=\\\"previewFlyer in ::$ctrl.previewFlyers track by $index\\\" class=flyer-preview-modal-flyer> <input ng-model=$ctrl.selectedPreviewToken type=radio class=radio name=selectedFlyer id=\\\"select-flyer-preview-{{:: $index}}\\\" ng-value=previewFlyer.preview_token> <label for=select-flyer-preview-{{::$index}} class=radio-button> {{:: previewFlyer.dateRangeLabel}} </label> <a ng-if=\\\":: (previewFlyer.pdfHref && !config.dotComModule.weeklyAdPath)\\\" ng-href=\\\"{{:: previewFlyer.pdfHref}}\\\" target=_blank class=\\\"flyer-preview-modal-flyer-pdf-link icon-download-pdf\\\" analytics-click=\\\"['preview weekly flyer PDF', 'click']\\\" aria-label={{::lang.aria.curretWeeklyFlyer}}></a> <a ng-if=\\\":: config.dotComModule.weeklyAdPath\\\" ng-href=\\\"{{:: (config.dotComModule.url + config.dotComModule.weeklyAdPath + '?preview')}}\\\" class=\\\"flyer-preview-modal-flyer-pdf-link icon-download-pdf\\\" analytics-click=\\\"['preview weekly flyer PDF', 'click']\\\" aria-label={{::lang.aria.curretWeeklyFlyer}}></a> </li> </ul> </section> <button ng-if=\\\":: !$ctrl.isMobile\\\" ng-click=$ctrl.goToFlyer($ctrl.selectedPreviewToken) class=\\\"button small right\\\" id=flyer-preview-modal-confirm analytics-click=\\\"['weekly ad preview modal apply button', 'click']\\\"> Choose {{:: $ctrl.lang.values.weeklyAd}} </button> </div> <button ng-if=\\\":: $ctrl.isMobile\\\" ng-click=$ctrl.goToFlyer($ctrl.selectedPreviewToken) class=\\\"button mobile-bottom footer\\\" id=flyer-preview-modal-confirm analytics-click=\\\"['weekly ad preview modal apply button', 'click']\\\"> Choose {{:: $ctrl.lang.values.weeklyAd}} </button> </div> \";","module.exports = \"<div class=\\\"expressgidt-card-redeem-modal modal-container\\\"> <react-express-gift-card-redeem-modal on-cancel=$ctrl.onCancel on-success=$ctrl.onSuccess></react-express-gift-card-redeem-modal> </div>\";","module.exports = \"<div class=\\\"delivery-form checkout-form\\\" ng-class=\\\"{'checkout-form--open': $ctrl.editMode}\\\"> <div ng-if=!$ctrl.editMode class=checkout-form__left> <ng-include class=icon src=\\\"::$ctrl.utilService.loadStaticImage('ic_pin.svg')\\\" aria-hidden=true /> </div> <div class=checkout-form__right ng-if=\\\"!$ctrl.editMode && !$ctrl.hideChevron\\\"> <button class=checkout-form__edit-button id=delivery-address-edit-button ng-click=$ctrl.enterEditMode() aria-label=\\\"{{ ::$ctrl.lang.values.expandSection }}: {{ ::$ctrl.lang.values.deliveryAddress }}\\\"> </button> </div> <div class=checkout-form__content> <div ng-if=\\\"$ctrl.errors.length > 0 && $ctrl.editMode\\\" class=\\\"cart-form__message message error\\\" role=alert> <span class=icon-error aria-hidden=true></span> <div class=cart-form__message-title>{{::$ctrl.lang.values.error}}</div> <div class=cart-form__message-body> {{$ctrl.errors[$ctrl.errors.length - 1]}} </div> </div> <div class=checkout-form__content-header> <div ng-if=$ctrl.editMode> <ng-include class=icon src=\\\"::$ctrl.utilService.loadStaticImage('ic_pin.svg')\\\"/> </div> <h2 class=checkout-form__title> {{::$ctrl.lang.values.deliveryAddress}} </h2> </div> <div ng-if=!$ctrl.editMode class=\\\"checkout-form__readonly delivery-form__address-info\\\"> <div ng-bind-html=\\\"!$ctrl.isValid($ctrl.address) ?\\n          $ctrl.lang.values.addDeliveryAddress :\\n          $ctrl.addressAsString($ctrl.address)\\\"></div> <div ng-if=$ctrl.isValid($ctrl.address)> {{ $ctrl.contactInformationAsString($ctrl.address) }} </div> <div class=sub-title ng-if=$ctrl.isValidPhoneNumber($ctrl.address)> <i aria-hidden=true class=\\\"icon icon-info-i\\\"></i> <span>{{ $ctrl.lang.values.contactInformationDisclaimer }}</span> </div> </div> <div ng-if=\\\"$ctrl.editMode && $ctrl.config.enableMultipleDeliveryAddresses\\\" class=\\\"checkout-form__form delivery-form__multiple-addresses\\\"> <address-list selectable-addresses=radio select-address-callback=\\\"$ctrl.setDeliveryAddress(address, saveSelectedAddress)\\\" edit-address-callback=$ctrl.editingDeliveryAddress(address) current-address=$ctrl.address validate-address=$ctrl.config.enableExternalAddressValidation> </address-list> <button class=\\\"button save dark delivery-form__save-button\\\" id=delivery-address-save-button ng-click=$ctrl.saveAddress($ctrl.address) ng-if=!$ctrl.isEditingAddress data-test=delivery-address-selection-save-button> <span ng-if=!$ctrl.isLoading>{{::$ctrl.lang.values.save}}</span> <loading-dots show=$ctrl.isLoading></loading-dots> </button> </div> <div ng-if=\\\"$ctrl.editMode && !$ctrl.config.enableMultipleDeliveryAddresses\\\" class=checkout-form__form> <address-list-form data=$ctrl.address on-save=$ctrl.saveAddress($ctrl.address) on-cancel=$ctrl.onCancel() validate-address=$ctrl.config.enableExternalAddressValidation> </address-list-form> </div> </div> </div> \";","module.exports = \"<div class=\\\"menu sidenav\\\" ng-if=!$root.mobile.isMobile ng-class=\\\"{ 'no-border': config.enableFacetedSearchFilters || config.enableICSearch }\\\"> <nav ng-class=\\\"{ 'faceted-search-sidenav': config.enableFacetedSearchFilters || config.enableICSearch }\\\" aria-label={{::lang.values.filters}}> <h2 class=sidenav-header ng-if=\\\"::config.enableFacetedSearchFilters || config.enableICSearch\\\">{{::lang.values.departments}}</h2> <ul> <li ng-repeat=\\\"parent in tree.parents track by $index\\\" class=\\\"sidenav-item parent\\\"> <span class=faceted-search-icon-back aria-hidden=true></span> <a ng-attr-href=\\\"{{state.href(parent.state, utilService.cleanShopParams(parent.params))}}\\\" ng-attr-id=\\\"{{:: idAttrs.parents[$index]}}\\\" analytics-click=\\\"['catalog menu link', 'click']\\\"> {{parent.name}} </a> <ul ng-if=\\\"$last && showSiblings\\\"> <li ng-repeat=\\\"sibling in tree.siblings track by $index\\\" class=\\\"sidenav-item child\\\" ng-class=\\\"{active: util.stateIs(sibling.state, sibling.params)}\\\"> <a ng-attr-href=\\\"{{state.href(sibling.state, utilService.cleanShopParams(sibling.params))}}\\\" ng-attr-id=\\\"{{:: idAttrs.siblings[$index]}}\\\" analytics-click=\\\"['catalog menu link', 'click']\\\" aria-current=\\\"{{util.stateIs(sibling.state, sibling.params) ? 'page' : ''}}\\\"> {{sibling.name}} </a> </li> </ul> </li> <li ng-if=\\\"tree.children.length > 0 || !showSiblings\\\" class=\\\"sidenav-item parent\\\" ng-class=\\\"{active: util.stateIs(tree.current.state, tree.current.params)}\\\"> <span class=faceted-search-icon-down aria-hidden=true></span> <a ng-attr-href=\\\"{{state.href(tree.current.state, utilService.cleanShopParams(tree.current.params))}}\\\" ng-attr-id=\\\"{{:: idAttrs.current}}\\\" analytics-click=\\\"['catalog menu link', 'click']\\\" aria-current=\\\"{{util.stateIs(tree.current.state, tree.current.params) ? 'page' : ''}}\\\"> {{tree.current.name}} </a> <ul> <li ng-if=\\\"tree.promoted && tree.promoted.length > 0\\\" ng-repeat=\\\"child in tree.promoted track by $index\\\" class=\\\"sidenav-item child\\\" ng-class=\\\"{ 'has-children': child.children.length > 0 }\\\"> <a ng-attr-href=\\\"{{child.link || state.href(child.state, utilService.cleanShopParams(child.params))}}\\\" ng-attr-id=\\\"{{:: idAttrs.children[$index]}}\\\" analytics-click=\\\"['catalog menu link', 'click']\\\"> {{child.name}} </a> </li> <li ng-if=\\\"tree.children.length > 0 && isNonEComLightChild(child)\\\" ng-repeat=\\\"child in tree.children track by $index\\\" class=\\\"sidenav-item child\\\" ng-class=\\\"{ 'has-children': child.children.length > 0 }\\\"> <span class=faceted-search-icon-right aria-hidden=true></span> <a ng-attr-href=\\\"{{child.link || state.href(child.state, utilService.cleanShopParams(child.params))}}\\\" ng-attr-id=\\\"{{:: idAttrs.children[$index]}}\\\" analytics-click=\\\"['catalog menu link', 'click']\\\" data-test=\\\"{{'department-link-' + child.id}}\\\"> {{child.name}} </a> </li> </ul> </li> </ul> <span ng-if=!hideFacets> <h2 class=sidenav-header data-test=facet-side-filters-header> {{::lang.values.filters}} <button type=button class=see-all ng-click=resetFacets() ng-if=shouldShowReset()>Reset</button> </h2> <faceted-side-filters role=region aria-label=\\\"{{ ::lang.values.filters }}\\\" faceted-side-filters=sideFacetsArray> </faceted-side-filters> </span> </nav> </div> <span class=faceted-search-sidenav ng-if=\\\"::config.enableFacetedSearchFilters || config.enableICSearch\\\"> </span> \";","module.exports = \"<div class=\\\"offer-collections view\\\"> <div page-header label=title breadcrumbs=\\\"[\\n    {label: offer.name, state: 'main.offers.details', params: {offerId: offer.id}},\\n    {label: title}\\n  ]\\\"></div> <div ng-if=!collection class=view-loading-indicator></div> <div ng-if=\\\"collection && collection.length > 0\\\" class=\\\"cell-container offer-items\\\"> <div ng-repeat=\\\"item in collection track by $index\\\" class=cell-wrapper> <div class=offer-item product-cell product-details-modal-link=true product=item location=\\\"Product Offer Collection\\\" location-value=\\\"{'id': offer.id, 'display_name': offer.name}\\\" index=$index></div> </div> <ul ng-if=\\\"!mobile.isMobile && collection.item_count > config.productsPerPage\\\" uib-pagination boundary-links=true previous-text=\\\"\\\" first-text=1 next-text=\\\"\\\" total-items=collection.item_count template-url=pagination-modified-uibootstrap-desktop.html max-size=config.maxPaginationLinks items-per-page=config.productsPerPage ng-model=page.current class=pagination ng-click=\\\"analytics.logEvent('offer product collection pagination', 'click')\\\"></ul> <ul ng-if=\\\"mobile.isMobile && collection.item_count > config.productsPerPage\\\" uib-pagination boundary-links=true previous-text=\\\"\\\" first-text=First next-text=\\\"\\\" total-items=collection.item_count template-url=pagination-modified-uibootstrap-mobile.html max-size=config.maxPaginationLinks items-per-page=config.productsPerPage ng-model=page.current class=pagination ng-click=\\\"analytics.logEvent('offer product collection pagination', 'click')\\\"></ul> </div> </div> \";","module.exports = \"<button aria-label=\\\"{{coupon.clipped ? lang.aria.clippedCouponFor + coupon.name : lang.aria.clipCouponFor + coupon.name }}\\\" class=button ng-disabled=\\\"isCartSyncing() || isDisabled || coupon.clipped\\\" analytics-click=\\\"['coupon {{(coupon.clipped) ? 'unclip': 'clip'}} button', 'click']\\\" send-analytics=!$root.modifyingOrder require-registered-user if-registered=toggleClippedState() location={{::location}}> <span ng-class=\\\"{toggled: coupon.clipped, 'no-unclipping' : config.disableCouponUnclipping}\\\" aria-hidden=true></span> {{coupon.clipped ? lang.values.clipped : lang.values.clip}} </button> \";","module.exports = \"<div class=order-add-on-modal-container> <div class=modal-content> <div class=order-add-on-confirmation-modal> <div class=header> <div class=order-add-on-info> <h1>{{::lang.values.orderAddOn.confirmHeadline}}</h1> <span ng-if=\\\"$ctrl.order.timeslot.polytype === 'asap'\\\">{{::lang.values.orderAddOn.requestAddOn}} {{::lang.values.for}} {{::lang.values.order | capitalize}} #{{$ctrl.order.id}} {{$ctrl.order.fulfillment_type | capitalize}} | {{$ctrl.order.timeslot.label}}</span> <span ng-if=\\\"$ctrl.order.timeslot.polytype !== 'asap'\\\">{{::lang.values.orderAddOn.requestAddOn}} {{::lang.values.for}} {{::lang.values.order | capitalize}} #{{$ctrl.order.id}} {{$ctrl.order.fulfillment_type | capitalize}} | {{$ctrl.order.timeslot.from_time | date:'h:mmA':'HH:mm:ss'}}-{{$ctrl.order.timeslot.to_time | date:'h:mmA':'HH:mm:ss'}} {{$ctrl.order.fulfillment_date | date:'MMMM D':config.apiDateFormat}}</span> </div> </div> <div class=product-wrapper> <div class=product-meta> <img ng-src={{$ctrl.product.images.tile.small}} alt={{$ctrl.product.name}} /> <span>{{$ctrl.product.name}}</span> </div> <div class=price> <div product-prices product=$ctrl.product unit-price=$ctrl.product.uom_price.price></div> </div> <div class=cosmetic> &times; </div> <div class=modify-quantity> <div modify-quantity secondary-style=true item=$ctrl.product increment-fn=$ctrl.orderAddOnIncrement() decrement-fn=$ctrl.orderAddOnDecrement() on-update=$ctrl.orderAddOnUpdate() analytics-name=\\\"cart product\\\"> </div> </div> <div class=cosmetic> = </div> <div class=sub-total> <span ng-if=$ctrl.mobile.isMobile>Total </span>{{$ctrl.product.subtotal | currency}} </div> </div> <div class=disclaimer> {{::lang.values.orderAddOn.confirmDisclaimer}} </div> <div class=actions-wrapper> <button class=button ng-click=$ctrl.confirmOrderAddOn() analytics-click=\\\"['modify order add-on confirm button', 'click']\\\" ng-disabled=loading>{{::lang.values.orderAddOn.confirmRequest}}</button> <button class=\\\"button hollow\\\" ng-click=$dismiss() analytics-click=\\\"['modify order add-on cancel button', 'click']\\\">Cancel</button> </div> </div> </div> </div> \";","module.exports = \"<div class=\\\"dropdown-menu bottom-center search-results-menu\\\" data-test=search-auto-complete-list ng-show=\\\"isOpen() && !moveInProgress\\\"> <ul role=listbox aria-hidden={{!isOpen()}} id=typeahead-search-results-list> <span ng-if=\\\"isOpen() && !moveInProgress\\\" class=screen-reader-text aria-live=assertive>{{matches.length}} results are available.</span> <li data-test=\\\"{{match.model.context || (match.model.isRedirect && 'redirect') || 'product'}}-search-suggestion\\\" ng-repeat=\\\"match in matches track by $index\\\" ng-click=selectMatch($index) id={{::match.id}} role=option class=link ng-class=\\\"{ 'active': isActive($index), 'search-results-menu-redirect-divider': match.model.isLastRedirect }\\\" ng-mouseenter=selectActive($index)> <div uib-typeahead-match index=$index match=match query=query template-url=templateUrl></div> <span class=auto-complete-context ng-if=match.model.context>In {{match.model.context}}</span> </li> </ul> </div> \";","module.exports = \"<div class=\\\"compare-cart-modal modal-container\\\"> <div class=modal-header>{{::lang.values.weightDriftModal.title}}</div> <div tabindex=-1 class=\\\"compare-cart-content modal-content\\\"> <div class=\\\"message warn\\\"> <span class=icon-warning aria-hidden=true></span> {{::lang.values.weightDriftModal.alert}} </div> <table class=table> <thead ng-if=\\\":: (!mobile.isMobile)\\\"> <tr class=text-left> <th scope=col>{{::$ctrl.lang.values.productName}}</th> <th scope=col>{{::$ctrl.lang.values.quantity}}</th> </tr> </thead> <tbody> <tr class=products-list ng-repeat=\\\"item in $ctrl.items track by $index\\\" data-test=\\\"cart-compare-item-row-{{ item.id }}\\\" ng-if=\\\"(!item.store_product.product_type || item.store_product.product_type !== 'subscription') && item.quantity\\\"> <td> <div class=product> <div class=image ng-attr-style=\\\"background-image: url('{{::$ctrl.imageURLService.getProductImageURL(item.store_product, 'small')}}')\\\" analytics-click=\\\"['cart product link', 'click']\\\"></div> <div class=meta> <div class=prod-name>{{ item.store_product.name }}</div> </div> </div> </td> <td> <div class=quantity> {{:: mobile.isMobile ? $ctrl.lang.values.values.qty + ' ' : ''}} <span class=quant-amnt>{{ item.quantity }}</span> <span class=quant-unit>{{ item.store_product.ordering_parameters.display_name.toLowerCase() != $ctrl.UNIT_OF_MEASURE.EACH ? item.store_product.ordering_parameters.display_name : '' }}</span> </div> </td> </tr> </tbody> </table> <div ng-class=\\\"::{ 'row buttons-box': !mobile.isMobile, 'buttons': mobile.isMobile }\\\"> <button ng-click=$ctrl.onClose() class=button ng-class=\\\"::{ 'hollow': !mobile.isMobile, 'dark': mobile.isMobile }\\\" ng-style=\\\"{ width: '100%' }\\\"> {{::lang.values.weightDriftModal.cta}} </button> </div> </div> </div> \";","module.exports = \"<header class=page-header ng-class=\\\"{'has-background': enableBackground}\\\"> <div class=trail> <div class=label ng-class=\\\"{ 'show-header-animation': !hideMobileAnimation, 'no-back-button': !shouldShowMobileBackButton() }\\\"> <button ng-if=shouldShowMobileBackButton() ng-click=mobileGoBack() class=back aria-label=\\\"{{:: lang.aria.back}}\\\"></button> <div class=va> <div class=lbl-txt data-test=mobile-page-header-title><h1>{{label}}</h1> <loading-dots show=loading></loading-dots></div> <div class=cat-filters>{{getFacetDisplayNames(selectedFilters)}}</div> </div> </div> </div> <div class=background ng-if=enableBackground ng-attr-style=\\\"background-image: url('{{background}}')\\\"></div> </header> \";","import _ from 'lodash'\nimport angular from 'angular'\nimport { LOGIN_CONTEXTS } from '@app/angular/constants/loginContexts'\nimport cookingModeModalTemplate from './cookingModeModal.html'\nimport shopThisRecipeModalTemplate from './shopThisRecipeModal.html'\n\nexport default angular\n  .module('RecipeDetailsControllerModule', [])\n  .controller(\n    'RecipeDetailsController',\n    function RecipeDetailsController(\n      $rootScope,\n      $scope,\n      $state,\n      $timeout,\n      $uibModal,\n      addressList,\n      analytics,\n      auth,\n      config,\n      imageURLService,\n      lang,\n      mobileService,\n      recipe,\n      registrationService,\n      savedRecipes,\n      savedRecipesService,\n      tagsService,\n      titleService,\n      uibModalAriaLabelService,\n      utilService\n    ) {\n      const vm = this\n      vm.config = config\n      vm.imageURLService = imageURLService\n      vm.lang = lang\n      vm.recipe = recipe\n      vm.mobile = mobileService\n      vm.tagsService = tagsService\n\n      const recipeTags = vm.recipe.tags && vm.recipe.tags.tags ? vm.recipe.tags.tags : []\n\n      // combine tags/values with matching configuration tags to simplify retrieving things like color\n      // that we need in the template\n      vm.recipeFullTags = recipeTags.map(tag => {\n        return { ...tagsService.byVal(tag.tag_name), ...tag }\n      })\n\n      const initSaveStatus = _.some(savedRecipes, savedRecipe => {\n        return savedRecipe.id === vm.recipe.id\n      })\n\n      const promptCloseDelayTime = 500\n\n      // We need to nest a model object in vm to update the view for $on broadcast\n      // from cart service and other adjacent scopes. #JustAngularThings\n      vm.model = {\n        showSavePrompt: false,\n        isSaveButtonInView: true,\n        savedCount: recipe.saved_count,\n        isSaved: initSaveStatus,\n      }\n\n      if ($state.current.data) {\n        // setPageTitleAndBreadcrumbs is set in recipesRoutes.js\n        // (it will only be true if the user has landed on the recipeDetails page, and not just opened the modal in mobile)\n        if ($state.current.data.setPageTitleAndBreadcrumbs) {\n          // Set Page Title\n          titleService.setTitle(vm.recipe.name)\n\n          // Set Breadcrumbs\n          const { recipesHomeState } = $state.current.data\n          recipesHomeState.label = recipesHomeState.name // breadcrumbs expects 'label', not 'name'\n\n          // Recipes can belong to multiple category trees. In some user flows, a user traverses a single category tree (read: breadcrumbs) and lands on a particular recipe.\n          // For example, the following user path: shop -> recipes -> recipes by course -> Breakfast & Brunch course -> Sweet Potato & Apple Hash recipe\n          // In those cases, we want to only display the `By Course / Breakfast & Brunch` category tree on the recipe page and not any others that the recipe may belong to.\n          // In order to do that, we can be passed a categoryIds array which contains the ids of the categories to display on the recipe page.\n          // Paths where user doesn't traverse a category tree to get to the recipe (for example, search), would continue to display the all of the category trees that the recipe belongs to.\n          const filteredCategories = $state.params.categoryIds\n            ? vm.recipe.categories.filter(category => {\n                return $state.params.categoryIds.includes(category.id)\n              })\n            : vm.recipe.categories\n\n          vm.breadcrumbs = [\n            recipesHomeState,\n            ...filteredCategories.map(category => ({\n              label: category.name,\n              state: 'main.shop.recipes.category',\n              params: { recipe_category_id: category.id },\n            })),\n            { label: vm.recipe.name, active: true },\n          ]\n        }\n      }\n\n      $scope.mobileActiveTab = 'ingredients' // initialize active tab\n\n      $scope.activateTab = tab => {\n        $scope.mobileActiveTab = tab\n      }\n\n      vm.openCookingModeModal = () => {\n        $uibModal.open({\n          template: cookingModeModalTemplate,\n          controller: function cookingModalController(recipe) {\n            const vm = this\n\n            vm.recipe = recipe\n\n            vm.mobileActiveTab = $scope.mobileActiveTab\n\n            vm.directions = {\n              currentStep: 1, // initialize directions step\n              totalSteps: recipe.directions.length,\n              stepsChecked: recipe.directions.map(() => false), // array where index is true if checked, initialized to false\n            }\n            vm.directionsPreviousStep = () => {\n              // eslint-disable-next-line no-plusplus\n              vm.directions.currentStep--\n              document.getElementById('step-counter-heading').focus()\n            }\n            vm.directionsNextStep = () => {\n              // eslint-disable-next-line no-plusplus\n              vm.directions.currentStep++\n              document.getElementById('step-counter-heading').focus()\n            }\n\n            $scope.activateTab('directions')\n          },\n          controllerAs: 'cookingModeModal',\n          resolve: {\n            ariaLabel: () => {\n              uibModalAriaLabelService.setLabel(lang.values.cookingMode)\n            },\n            recipe: () => vm.recipe,\n          },\n        })\n      }\n\n      vm.recipeHasProducts =\n        (vm.recipe.products.fresh && vm.recipe.products.fresh.length > 0) ||\n        (vm.recipe.products.mealkitOptions && vm.recipe.products.mealkitOptions.length > 0) ||\n        (vm.recipe.products.pantry && vm.recipe.products.pantry.length > 0) ||\n        (vm.recipe.products.other && vm.recipe.products.other.length > 0)\n\n      if (vm.recipeHasProducts) {\n        vm.openShopThisRecipeModal = () => {\n          $uibModal.open({\n            template: shopThisRecipeModalTemplate,\n            controller: function shopThisRecipeModalController(products) {\n              const vm = this\n              vm.products = products\n              vm.mobileActiveTab = $scope.mobileActiveTab\n            },\n            controllerAs: 'shopThisRecipeModal',\n            resolve: {\n              products: () => vm.recipe.products,\n            },\n          })\n        }\n      }\n\n      // Save Recipe functionality\n\n      vm.toggleSaveRecipe = () => {\n        savedRecipesService.requireLogin().then(() => {\n          if (vm.model.isSaved) {\n            savedRecipesService\n              .removeSavedRecipe(vm.recipe.id, vm.recipe, $state.params.index)\n              .then(() => {\n                vm.model.isSaved = false\n                // eslint-disable-next-line no-plusplus\n                vm.model.savedCount--\n              })\n          } else {\n            savedRecipesService\n              .saveRecipe(vm.recipe.id, vm.recipe, $state.params.index)\n              .then(() => {\n                vm.model.isSaved = true\n                // eslint-disable-next-line no-plusplus\n                vm.model.savedCount++\n\n                $timeout(() => {\n                  vm.model.showSavePrompt = false\n                }, promptCloseDelayTime)\n              })\n          }\n        })\n      }\n\n      vm.closeSavePrompt = () => {\n        vm.model.showSavePrompt = false\n        vm.model.userClosedSavePrompt = true\n      }\n\n      vm.reviewsUserData = {\n        id: auth.user.id,\n        name: auth.getUserFullName(),\n        location: addressList.getAddressRegionString(addressList.getDefault()),\n        isTrial: auth.user.status === 'trial',\n      }\n\n      vm.openLogin = () => {\n        registrationService.open(\n          'login',\n          null,\n          null,\n          null,\n          null,\n          null,\n          LOGIN_CONTEXTS.RECIPE_USER_REVIEW\n        )\n      }\n\n      $scope.openAndScrollToTab = tab => {\n        $scope.activateTab(tab)\n\n        const el = document.querySelector('#recipe-details-extras')\n\n        if (!el) {\n          return\n        }\n\n        utilService.scrollIntoView(el)\n      }\n\n      analytics.logSegmentEvent('recipe.view_recipe', {\n        recipe_details: analytics.getRecipeAnalytics(recipe, $state.params.index),\n      })\n\n      analytics.logRecipeDetailsView(recipe)\n\n      $rootScope.$on('cartService', (event, action, item) => {\n        if (\n          action === 'add' &&\n          !vm.model.showSavePrompt &&\n          !vm.model.userClosedSavePrompt &&\n          item.quantity !== 0\n        ) {\n          vm.model.showSavePrompt = true\n        }\n      })\n    }\n  )\n  .run($templateCache => {\n    $templateCache.put('recipeDetails.html', require('./recipeDetails.html'))\n  })\n","module.exports = \"<div class=\\\"cancellation-step cancellation-step--no-footer\\\"> <div class=cancellation-step__title> {{::$ctrl.getTitle()}} </div> <p class=cancellation-step__sub-title> {{::$ctrl.getBody()}} </p> </div>\";","module.exports = \"<nav aria-label=page> <ul class=pagination> <li ng-if=::directionLinks ng-class=\\\"{disabled: noPrevious()||ngDisabled}\\\" class=pagination-prev> <button ng-click=\\\"selectPage(page - 1, $event)\\\" class=prev-next> <span class=\\\"button round small darker icon-chevron-left\\\" aria-hidde=true></span> {{::getText('previous')}} </button> </li> <li ng-if=::boundaryLinks ng-class=\\\"{disabled: noPrevious()||ngDisabled}\\\" class=pagination-first> <button ng-click=\\\"selectPage(1, $event)\\\">{{::getText('first')}}</button> </li> <li class=\\\"pagination-page active\\\"> Page {{page}} / {{totalPages}} </li> <li ng-if=::boundaryLinks ng-class=\\\"{disabled: noNext()||ngDisabled}\\\" class=pagination-last> <a ng-click=\\\"selectPage(totalPages, $event)\\\">{{::getText('last')}}</a> </li> <li ng-if=::directionLinks ng-class=\\\"{disabled: noNext()||ngDisabled}\\\" class=pagination-next> <button ng-click=\\\"selectPage(page + 1, $event)\\\" class=prev-next> {{::getText('next')}} <span class=\\\"button round small darker icon-chevron-right\\\" aria-hidden=true></span> </button> </li> </ul> </nav> \";","import _ from 'lodash'\n\n// TODO - make this more readable\nexport const productPlacementsFromProducts = results => {\n  return results?.placements?.length > 0\n    ? results.placements\n        // eslint-disable-next-line array-callback-return\n        .map(placement => {\n          if (placement.item_type === 'product') {\n            placement.product.placement = true\n            return placement.product\n          }\n        })\n        .filter(item => item)\n    : []\n}\n\n// Massage the image placements returned from /store_products into an object as returned\n// by /placements for consistent use within analytics\nexport const formatImagePlacementForAnalytics = (placement, type) => ({\n  route: type,\n  media: { type: 'image' },\n  target: placement.target,\n  name: placement.name,\n  id: placement.id,\n})\n\nexport const insertPlacementsInProducts = (placements = [], products = []) => {\n  /* Both splice and the spread operator which are used below remove all\n  non numeric keys from the products object:\n\n  Example: products = { 0: item1, ... 24: item24, item_count: 25, placements: [] }\n  Becomes: products = { 0: item1, ... 24: item24 }\n\n  To avoid that, and retain all non numeric keys so as to mutate the object as\n  as little as possible, the code below copies the item from the object, splices\n  the ads into the correct locations, then manually ads the numeric keys back into\n  the correct spots in the object\n\n  NOTE: This will only insert product placements into the array, not image placements\n\n  Input: products = { 0: item1, ... 24: item24, item_count: 25, placements: [{ id: item123, position: 1 }], ... }\n  Output: products = { 0: item123, 1: item1, ... 24: item24, item_count: 26, ... }\n  */\n\n  // IC, Elevaate, or Criteo ads.\n  const positionedPlacements = []\n  // Unata product placements.\n  const unpositionedProductPlacements = []\n  let areUnpositionedProductPlacementsFirst\n  // Unata image placements.\n  const unpositionedNonProductPlacements = []\n  placements.forEach(placement => {\n    if (placement.item_type !== 'product') {\n      unpositionedNonProductPlacements.push(placement)\n    } else if (typeof placement.product?.position === 'number') {\n      positionedPlacements.push(placement)\n      areUnpositionedProductPlacementsFirst ??= false\n    } else {\n      unpositionedProductPlacements.push(placement)\n      areUnpositionedProductPlacementsFirst ??= true\n    }\n  })\n\n  // Populate the placement list only with unpositioned non-product placements.\n  products.placements = unpositionedNonProductPlacements\n\n  // Order positioned product placements by their position to insert them into\n  // the product list later.\n  const sortedPositionedPlacements = _.sortBy(\n    positionedPlacements,\n    placement => placement.product.position\n  )\n\n  // Insert positioned product placements at their respected positions.\n  sortedPositionedPlacements.forEach(placement => {\n    const index = placement.product.position - 1\n    products.splice(index, 0, placement.product)\n  })\n\n  // Determine an index at which to insert unpositioned placements relative to positioned ones.\n  let unpositionedProductPlacementsIndex = 0\n  if (sortedPositionedPlacements.length) {\n    const relativePositionedPlacement = areUnpositionedProductPlacementsFirst\n      ? sortedPositionedPlacements[0]\n      : sortedPositionedPlacements[sortedPositionedPlacements.length - 1]\n    unpositionedProductPlacementsIndex = relativePositionedPlacement.position ?? 0\n  }\n\n  // Insert unpositioned placements.\n  products.splice(\n    unpositionedProductPlacementsIndex,\n    0,\n    ...unpositionedProductPlacements.map(({ product }) => product)\n  )\n\n  return products\n}\n","module.exports = \"<div role=button ng-click=openCollection() class=\\\"cell promo-collection-cell\\\" analytics-click=\\\"['promo collection cell', 'click']\\\"> <div class=cell-image-wrapper> <div class=cell-image cell-image default-image=promoCollection.images.tile.medium promoted-media=promotedMedia use-image-tag=true></div> <div ng-if=promoCollection.promo_tag class=promo-tag uib-popover=\\\"Ends {{promoCollection.sale_end_date | apiDate:'MMM D'}}\\\" popover-trigger=\\\"mouseenter focus\\\" popover-enable=\\\"::mobile.isMobile ? false : config.showSaleEndDate\\\" tabindex=\\\"{{::mobile.isMobile ? '-1' : config.showSaleEndDate ? '0' : '-1'}}\\\"> {{promoCollection.promo_tag}} </div> </div> <div class=cell-content-wrapper> <div class=cell-title> <span class=cell-title-text>{{promoCollection.collection.name}}</span> </div> <div product-prices ng-if=promoCollection.base_price product=promoCollection class=cell-prices></div> <div class=cell-badge> <div class=num>{{promoCollection.count}}</div> <div class=items>{{::lang.values.items | lowercase}}</div> </div> </div> </div> \";","module.exports = \"<form class=address-form name=addressForm ng-submit=$ctrl.validateAddressAndSave() data-test=delivery-address-form novalidate> <div class=form-row> <div class=col-1> <label for=profileDeliveryAddressAddress1>{{::$ctrl.lang.values.addressLine1}} *</label> <address-autocomplete-input initial-address=$ctrl.data.address1 input-auto-focus=false input-id=profileDeliveryAddressAddress1 input-class=\\\"input address-input-field\\\" input-name=address1 input-placeholder=::$ctrl.lang.values.addressLine1 address-chosen-callback=$ctrl.addressChosenCallback input-required=true show-street-address=true></address-autocomplete-input> <span id=profile-address1-error class=required-field ng-if=\\\"(addressForm.address1.$touched || addressForm.$submitted) && addressForm.address1.$invalid\\\">{{::$ctrl.lang.values.requiredForm.address}}</span> </div> </div> <div class=form-row ng-if=::$ctrl.config.profileAddress.showAddress2Field> <div class=col-1> <label for=profileDeliveryAddressAddress2>{{::$ctrl.lang.values.addressLine2}}</label> <input id=profileDeliveryAddressAddress2 class=\\\"input address-input-field\\\" type=text ng-model=$ctrl.data.address2 maxlength={{::$ctrl.config.deliveryAddressFieldsMaxLength}} aria-label={{::$ctrl.lang.values.secondAddress}} placeholder={{::$ctrl.lang.values.addressLine2}} autocomplete=address-line2 /> </div> </div> <div class=form-row> <div class=col-1> <label for=profileDeliveryAddressCity>{{::$ctrl.lang.values.city}}</label> <input id=profileDeliveryAddressCity name=city aria-describedby=profile-city-error aria-label={{::$ctrl.lang.values.city}} class=\\\"input address-input-field\\\" type=text ng-model=$ctrl.data.city maxlength={{::$ctrl.config.formFieldMaxLengths.city}} placeholder={{::$ctrl.lang.values.city}} required autocomplete=address-level2 /> <span id=profile-city-error class=required-field ng-if=\\\"(addressForm.city.$touched || addressForm.$submitted) && addressForm.city.$invalid\\\">{{::$ctrl.lang.values.requiredForm.city}}</span> </div> </div> <div class=form-row> <div class=col-1> <label for=profileDeliveryAddressProvince>{{::$ctrl.lang.values.selectAProvince}} *</label> <div province-select province=$ctrl.data.province input-id-attr=profileDeliveryAddressProvince province-is-required=true error-element-id=profile-province-error ng-class=\\\"{ invalid: (addressForm.province.$touched || addressForm.$submitted) && addressForm.province.$invalid, success: addressForm.province.$valid }\\\"></div> <span id=profile-province-error class=required-field ng-if=\\\"(addressForm.province.$touched || addressForm.$submitted) && addressForm.province.$invalid\\\">{{::$ctrl.lang.values.requiredForm.province}}</span> </div> </div> <div class=form-row> <div class=col-1> <label for=profileDeliveryPostalCode>{{::$ctrl.lang.values.postalCode}}</label> <input id=profileDeliveryPostalCode name=postalCode aria-describedby=profile-postal-code-error aria-label={{::$ctrl.lang.values.postalCode}} class=\\\"input address-input-field\\\" type=text ng-model=$ctrl.data.postal_code placeholder={{::$ctrl.lang.values.postalCode}} pattern={{::$ctrl.config.postalCodePattern}} required autocomplete=postal-code /> <span id=profile-postal-code-error class=required-field ng-if=\\\"(addressForm.postalCode.$touched || addressForm.$submitted) && addressForm.postalCode.$invalid\\\">{{::$ctrl.lang.values.requiredForm.postalCode}}</span> </div> </div> <div class=form-row ng-if=::!$ctrl.config.disableDeliveryInstructions> <div class=col-1> <label for=profileDeliveryAddressInstructions>{{::$ctrl.lang.values.deliveryInstructions}}</label> <textarea id=profileDeliveryAddressInstructions aria-label={{::$ctrl.lang.values.deliveryInstructionsPlaceholder}} class=\\\"address-form-input input\\\" ng-model=$ctrl.data.instructions rows=3 resize=false placeholder={{::$ctrl.lang.values.deliveryInstructionsPlaceholder}} name=instructions maxlength={{::$ctrl.config.deliveryNoteMaxLength}}></textarea> </div> </div> <div ng-if=!$ctrl.config.useInstacartAddressBook> <div class=address-list-item-form-title> <p>{{::$ctrl.lang.values.contactInformation}}</p> <p class=sub-title ng-bind-html=::$ctrl.lang.values.contactInformationDisclaimer></p> </div> <div class=form-row> <div class=col-1-2> <label for=profileDeliveryAddressFirstName>{{::$ctrl.lang.aria.firstName}}</label> <input id=profileDeliveryAddressFirstName name=firstName aria-describedby=profile-first-name-error class=input type=text ng-model=$ctrl.data.first_name aria-label={{$ctrl.lang.aria.firstName}} maxlength={{::$ctrl.config.maxNameLength}} placeholder={{::$ctrl.lang.aria.firstName}} ng-required=::$ctrl.isFieldRequired($ctrl.ADDRESS_FIELDS.FIRST_NAME) autocomplete=given-name /> <span id=profile-first-name-error class=required-field ng-if=\\\"$ctrl.isFieldRequired($ctrl.ADDRESS_FIELDS.FIRST_NAME) && (addressForm.firstName.$touched || addressForm.$submitted) && addressForm.firstName.$invalid\\\">{{::$ctrl.lang.values.requiredForm.firstName}}</span> </div> <div class=col-1-2> <label for=profileDeliveryAddressLastName>{{::$ctrl.lang.aria.lastName}}</label> <input id=profileDeliveryAddressLastName name=lastName aria-describedby=profile-last-name-error class=input type=text ng-model=$ctrl.data.last_name aria-label={{$ctrl.lang.aria.lastName}} maxlength={{::$ctrl.config.maxNameLength}} placeholder={{::$ctrl.lang.aria.lastName}} ng-required=::$ctrl.isFieldRequired($ctrl.ADDRESS_FIELDS.LAST_NAME) autocomplete=family-name /> <span id=profile-last-name-error class=required-field ng-if=\\\"$ctrl.isFieldRequired($ctrl.ADDRESS_FIELDS.LAST_NAME) && (addressForm.lastName.$touched || addressForm.$submitted) && addressForm.lastName.$invalid\\\">{{::$ctrl.lang.values.requiredForm.lastName}}</span> </div> </div> <div class=form-row> <div class=col-1> <label for=profileDeliveryAddressPhoneNumber>{{::$ctrl.lang.values.phone}}</label> <input id=profileDeliveryAddressPhoneNumber name=phoneNumber aria-describedby=profile-phone-number-error aria-label={{::$ctrl.lang.values.phone}} class=input type=text ng-model=$ctrl.data.phone_number placeholder={{::$ctrl.lang.values.phone}} pattern={{::$ctrl.config.phoneNumberPattern}} maxlength={{::$ctrl.config.phoneNumberMaxLength}} ng-required=::$ctrl.isFieldRequired($ctrl.ADDRESS_FIELDS.PHONE_NUMBER) autocomplete=tel-national /> <span id=profile-phone-number-error class=required-field ng-if=\\\"$ctrl.isFieldRequired($ctrl.ADDRESS_FIELDS.PHONE_NUMBER) && (addressForm.phoneNumber.$touched || addressForm.$submitted) && addressForm.phoneNumber.$invalid \\\">{{::$ctrl.lang.values.requiredForm.phone}}</span> </div> </div> </div> <div> <div class=\\\"form-row address-form-buttons\\\"> <button type=submit class=\\\"button dark\\\" analytics-click=\\\"['account profile delivery addresses', 'submit']\\\"> {{$ctrl.useContinueCopy ? $ctrl.lang.values.saveAndContinue : $ctrl.lang.values.save}} </button> <button class=\\\"button hollow\\\" type=button analytics-click=\\\"['account profile delivery addresses', 'cancel']\\\" ng-click=$ctrl.onCancel(); ng-if=$ctrl.addressList.hasAddressItems()> {{$ctrl.lang.values.cancel}} </button> <button class=\\\"button empty address-list-item-action-delete\\\" type=button analytics-click=\\\"['account profile delivery addresses', 'delete']\\\" ng-click=$ctrl.onDelete(); ng-if=$ctrl.addressList.hasAddressItems() ng-disabled=\\\"$root.modifyingInstacartOrder || !($ctrl.data.id)\\\" data-test=address-list-item-delete-button> {{$ctrl.lang.values.delete}} </button> <div ng-if=$ctrl.error class=\\\"message error\\\" scroll-into-view> <span class=icon-error aria-hidden=true></span> {{$ctrl.error}} </div> <div ng-if=$ctrl.message class=\\\"message success\\\" scroll-into-view> <span class=icon-checkmark-circle aria-hidden=true></span> {{$ctrl.message}} </div> </div> </div> </form> \";","module.exports = \"<div class=ic-express__order-page> <simplified-header></simplified-header> <div class=ic-express__order-page-content> <div class=ic-express__order-page-titles> <h2>{{::lang.values.icExpress.postCheckoutPage.title}}</h2> <h3>{{::lang.values.icExpress.postCheckoutPage.subtitle}}</h3> </div> <div class=ic-express__order-page-form> <div class=ic-express__order-page-alert> <alert icon=icon-info-i type=warn-light disable-border=true small-text=true> <span> {{:: lang.templateAsString( lang.values.icExpress.postCheckoutPage.warning, { express: config.icExpress.shortName } ) }} </span> </alert> </div> <div class=ic-express__order-page-payment> <div> <h4 class=ic-express__order-page-form-title>{{::lang.values.icExpress.postCheckoutPage.formTitle}}</h4> <span class=ic-express__order-page-form-subtitle tabindex=0 uib-popover=\\\"{{::\\n              lang.templateAsString(\\n                lang.values.icExpress.postCheckoutPage.popover,\\n                { express: config.icExpress.name }\\n              )\\n            }}\\\" popover-trigger=\\\"mouseenter focus\\\"> <span id=ic-express__order-page-popover-button-label> {{::lang.values.icExpress.postCheckoutPage.formSubtitle}} <i class=icon-info-i aria-hidden=true></i> </span> </span> </div> <ic-express-form enable-retailer-theme=true on-subscription-success=goToOrderPage() user-subscription-status=express.getMembershipStatus() order-id=order.id></ic-express-form> <a ui-sref=\\\"main.checkout.confirmation({ orderId: order.id })\\\" class=ic-express__order-page-form-cancel-link href=#main> {{:: lang.templateAsString( lang.values.icExpress.postCheckoutPage.cancelLink, { express: config.icExpress.shortName, orderFee: $filter('currency')(order.estimated_totals.fees.delivery_fee) } ) }} </a> </div> </div> <react-express-footer show-image=!mobileService.isMobile></react-express-footer> </div> </div> \";","module.exports = \"<div class=modal-container> <react-express-signup-modal on-cancel=$ctrl.onCancel plan-id=$ctrl.planId on-success=$ctrl.onSuccess></react-express-signup-modal> </div> \";","module.exports = \"<div ng-controller=sideNavController fixed-to-body=desktop id=mobile-side-nav> <div class=slide-out-menu> <nav class=mobile ng-class=\\\"{show: mobileNavService.slideOutMenuIsVisible}\\\" aria-hidden={{!mobileNavService.slideOutMenuIsVisible}} role=dialog aria-modal=true aria-label=\\\"Main Menu\\\"> <h2 class=screen-reader-text>Main Menu</h2> <div class=nav-content ng-class=\\\"{\\n      'logout-button-not-sticky': auth.user.status !== 'trial' && !config.dotComModule.mobileNav.logoutButton.sticky,\\n      'logout-button-sticky': auth.user.status !== 'trial' && config.dotComModule.mobileNav.logoutButton.sticky,\\n      'login-button-with-cta': auth.user.status === 'trial' &&  config.dotComModule.mobileNav.loginButton.showCta,\\n      'login-button-sticky': auth.user.status === 'trial' &&  config.dotComModule.mobileNav.logoutButton.sticky}\\\"> <div ng-if=::config.dotComModule.mobileNav.showLogo class=logo-container> <button ng-if=::config.enableMobileSidenavLogoClick type=button ng-click=\\\"go('main.home', {}, $event)\\\" analytics-click=\\\"['nav logo', 'click']\\\" id=nav-main-home-logo class=logo> <img src=\" + require(\"assets/images/header-logo.svg\") + \" alt={{::lang.values.clientName}}> </button> <div ng-if=::!config.enableMobileSidenavLogoClick id=nav-main-home-logo class=logo> <img src=\" + require(\"assets/images/header-logo.svg\") + \" alt={{::lang.values.clientName}}> </div> </div> <section> <div class=nav-menu> <ul> <li ng-if=::config.dotComModule.mobileNav.showContextSelector class=shopping-details ng-class=\\\"{pickup: shopContextIntent == 'pickup', instore: shopContextIntent == 'instore', delivery: shopContextIntent == 'delivery'}\\\"> <button ng-if=\\\"shoppingContextService.getIntentFromContext() == 'instore'\\\" data-test=sidenav-shopping-details-link ng-click=\\\"shoppingSelectorService.open(config.defaultSelectorService.mobileNavInstore); closeMenu()\\\"> <span class=\\\"icon-list icon-large\\\" aria-hidden=true></span> <div class=shopping-details-info> <div class=shopping-details-context-container> <banner-image class=sidenav-banner-image ng-if=\\\"::config.multipleBanners.enabled && hasBannerImage\\\" banner-slug=auth.user.store.store_banner.key></banner-image> <div class=shopping-details-context>{{::instoreContextDetail()}}</div> </div> <div class=shopping-details-store> {{::lang.values.atStore}} {{auth.user.store.name}} </div> </div> </button> <button ng-if=\\\"shoppingContextService.getIntentFromContext() == 'pickup'\\\" data-test=sidenav-shopping-details-link ng-click=\\\"shoppingSelectorService.open(config.defaultSelectorService.mobileNavPickup); closeMenu()\\\" ng-disabled=$root.modifyingInstacartOrder> <span class=\\\"icon-pickup icon-large\\\" aria-hidden=true></span> <div class=shopping-details-info ng-class=\\\"{'single-row-only': !reservationService.displayReservation && !shouldShowTimeslot()}\\\"> <div class=shopping-details-context-container> <banner-image class=sidenav-banner-image ng-if=\\\"::config.multipleBanners.enabled && hasBannerImage\\\" banner-slug=auth.user.store.store_banner.key></banner-image> <div class=shopping-details-context>{{::config.shoppingSelector.pickup.title}}</div> </div> <div class=shopping-details-store> {{::lang.values.atStore}} {{auth.user.store.name}} </div> <div class=shopping-details-timeslot ng-if=shouldShowTimeslot()> {{timeslotLabelFn()}} </div> </div> </button> <button ng-if=\\\"shoppingContextService.getIntentFromContext() == 'delivery'\\\" data-test=sidenav-shopping-details-link ng-click=\\\"shoppingSelectorService.open(config.defaultSelectorService.mobileNavDelivery); closeMenu()\\\" ng-disabled=$root.modifyingInstacartOrder> <span class=\\\"icon-delivery icon-large\\\" aria-hidden=true></span> <div class=shopping-details-info ng-class=\\\"{'single-row-only': !reservationService.displayReservation && !shouldShowTimeslot()}\\\"> <div class=shopping-details-context-container> <banner-image class=sidenav-banner-image ng-if=\\\"::config.multipleBanners.enabled && hasBannerImage\\\" banner-slug=auth.user.store.store_banner.key></banner-image> <div class=shopping-details-context>{{::config.shoppingSelector.delivery.title}}</div> </div> <div class=shopping-details-timeslot ng-if=shouldShowTimeslot()> {{timeslotLabelFn()}} </div> </div> </button> <button ng-if=\\\"shoppingContextService.getIntentFromContext() == 'catering'\\\" data-test=sidenav-shopping-details-link ng-click=\\\"shoppingSelectorService.open(config.defaultSelectorService.mobileNavPickup); closeMenu()\\\" ng-disabled=$root.modifyingInstacartOrder> <span class=\\\"icon-catering icon-large\\\" aria-hidden=true></span> <div class=shopping-details-info ng-class=\\\"{'single-row-only': !reservationService.displayReservation && !shouldShowTimeslot()}\\\"> <div class=shopping-details-context-container> <banner-image class=sidenav-banner-image ng-if=\\\"::config.multipleBanners.enabled && hasBannerImage\\\" banner-slug=auth.user.store.store_banner.key></banner-image> <div class=shopping-details-context>{{::config.shoppingSelector.catering.title}}</div> </div> <div class=shopping-details-store> {{::lang.values.atStore}} {{auth.user.store.name}} </div> <div class=shopping-details-timeslot ng-if=shouldShowTimeslot()> {{timeslotLabelFn()}} </div> </div> </button> <span class=chevron aria-hidden=true> <span class=icon-chevron-right></span> </span> </li> </ul> <wordpress-mobile-side-nav-items ng-if=!showPlatformSideNav></wordpress-mobile-side-nav-items> <ul ng-if=\\\"!showPlatformSideNav && isExpressMenuVisible()\\\"> <li> <a href=# ui-sref=main.account.icExpress id=nav-ic-express class=sidenav__custom-item__cms> <img class=sidenav__custom-item__cms-image ng-src={{::utilService.loadAssetImage(config.icExpress.placements.userDropdown.icon)}} alt=\\\"\\\"/> {{::config.icExpress.name}} </a> </li> </ul> <ul ng-if=::showPlatformSideNav> <li> <a href=# id=nav-main-home-menu ng-click=\\\"go('main.home', {}, $event)\\\"> <span class=icon-home aria-hidden=true></span> {{::lang.values.home}} </a> </li> <li ng-if=\\\":: !inEComLightMode\\\"> <a href=# id=nav-main-shop-categories-flyer data-test=mobile-nav-departments ng-click=\\\"go('main.shop.categories', {page: null, tags: null, brand_name: null, sort: null}, $event)\\\"> <span class=icon-departments aria-hidden=true></span> {{::lang.values.departments}} </a> </li> <li ng-if=\\\"::((!config.disableWeeklyAd || config.weeklyAdMobileOverride) && !inEComLightMode)\\\"> <a href=# id=nav-main-shop-flyer data-test=mobile-nav-flyer ng-click=\\\"go('main.shop.flyer', {page: null, tags: null, brand_name: null, sort: null}, $event)\\\"> <span class=icon-promo-tag aria-hidden=true></span> {{::lang.values.weeklyAd}} </a> </li> <li ng-if=\\\":: !config.disableCollections\\\"> <a href=# id=nav-main-shop-collections data-test=mobile-nav-collections ng-click=\\\"go('main.shop.collections', {page: null, tags: null, brand_name: null, sort: null}, $event)\\\"> <span class=icon-collections aria-hidden=true></span> {{::lang.values.collections}} </a> </li> <li ng-if=\\\":: (config.shoppingSelector.delivery.exists || config.shoppingSelector.pickup.exists)\\\"> <a href=# id=nav-main-shop-categories data-test=mobile-nav-purchases ng-click=\\\"go('main.shop.purchases', {page: null, tags: null, brand_name: null, sort: null}, $event)\\\" refocus> <span class=icon-tag-purchased aria-hidden=true></span> {{::lang.values.previousPurchases}} </a> </li> <li ng-if=\\\":: !config.disableCoupons && !inEComLightMode\\\" class=coupons> <a href=# id=nav-main-shop-coupons data-test=mobile-nav-coupons ng-click=\\\"go('main.shop.coupons', {page: null, tags: null, brand_name: null, sort: null}, $event)\\\"> <span class=icon-clip aria-hidden=true></span> {{::lang.values.coupons}} </a> </li> <li ng-if=\\\":: !config.disableCustomOffersPage && !inEComLightMode\\\" class=coupons> <a href=# id=nav-main-shop-offers data-test=mobile-nav-offers ng-click=\\\"go('main.shop.offers', {page: null, tags: null, brand_name: null, sort: null}, $event)\\\"> <span class=icon-clip aria-hidden=true></span> {{::lang.values.offers}} </a> </li> <li ng-if=\\\":: !config.disableRecipes && !inEComLightMode\\\"> <a href=# id=nav-main-shop-recipes data-test=mobile-nav-recipes ng-click=\\\"go('main.shop.recipes', {page: null, tags: null, brand_name: null, sort: null}, $event)\\\"> <span class=icon-recipes aria-hidden=true></span> {{::lang.values.recipes}} </a> </li> <li ng-if=\\\":: config.subscriptions.enabled && config.subscriptions.isDedicatedFlowEnabled\\\"> <a href=# id=nav-main-shop-subscriptions data-test=mobile-nav-subscriptions ng-click=\\\"go('main.subscriptions.marketing', {page: null, tags: null, brand_name: null, sort: null}, $event)\\\"> <span class=icon-subscription aria-hidden=true></span> {{::lang.values.subscriptions.headerButtonLabel}} </a> </li> <li ng-if=\\\":: enableToggleEcomLightMode && config.eComLight.enabled\\\"> <a href=# ng-click=toggleEComLightMode() id=nav-main-ecom-light> <span class={{ecomLightModeToggleIcon}} aria-hidden=true></span> {{:: eComLightModeToggleText}} </a> </li> <li ng-repeat=\\\"link in ::config.mobileHomeLinks\\\"> <a href=# id=nav-{{::link.sref}} ui-sref={{::link.sref}} class=link> <span class=icon-{{::link.icon}} aria-hidden=true></span> {{::link.text}} </a> </li> <li ng-if=isExpressMenuVisible()> <a href=# ui-sref=main.account.icExpress id=nav-ic-express class=sidenav__custom-item> <img class=sidenav__custom-item__image ng-src={{::utilService.loadAssetImage(config.icExpress.menuIcon)}} alt=\\\"\\\"/> {{::config.icExpress.name}} </a> </li> <li ng-if=::config.externalHeaderLink.enabled class=external-header-link> <a href={{::config.externalHeaderLink.href}} target=_blank> <span class=icon-external-link aria-hidden=true></span> {{::lang.values.externalHeaderLink}} </a> <a ng-if=::!mobile.isMobileApp()> <span id=ot-sdk-btn class=ot-sdk-show-settings onclick=oneTrustSDKCookieSettings()> <span class=icon-cog aria-hidden=true></span> {{::lang.values.cookieSettings}} </span> </a> </li> <li role=button ng-repeat=\\\"link in ::config.mobileNavLinks\\\"> <a class=link href={{::link.href}}> <span class=icon-{{::link.icon}} aria-hidden=true ng-if=::link.icon></span> {{::link.text}} </a> </li> <li ng-if=\\\"auth.user.status !== 'trial'\\\"> <span id=nav-user class=menu-item-account>{{::lang.values.accountSettings}}</span> <ul class=sub-menu> <li ng-repeat=\\\"item in accountMenuItems\\\"> <a ng-if=\\\"!item.extLink && !item.onClick\\\" ng-class=\\\"{'active': state.includes(item.sref)}\\\" ng-click=\\\"go(item.sref, {}, $event)\\\" ng-attr-id=\\\"{{:: item.id}}\\\" analytics-click=\\\"['nav account menu link', 'click', item.label]\\\">{{item.label}}</a> <a ng-if=\\\"!item.extLink && item.onClick\\\" ng-click=item.onClick() ng-attr-id=\\\"{{:: item.id}}\\\" analytics-click=\\\"['nav account menu link', 'click', item.label]\\\">{{item.label}}</a> <a ng-if=\\\"item.extLink && item.extLink !== 'gigya'\\\" href={{item.extLink}} target=_blank analytics-click=\\\"['nav account menu link', 'click', item.label]\\\">{{item.label}}</a> <a ng-if=\\\"item.extLink && item.extLink === 'gigya'\\\" target=_blank ng-click=gigyaChangePassword() analytics-click=\\\"['account menu link', 'click', item.label]\\\">{{item.label}}</a> </li> </ul> </li> </ul> <ul class=slide-out-menu-mobile-app ng-if=::mobile.isMobileApp()> <li> <a class=slide-out-menu-mobile-app__link href=# ng-click=\\\"go('main.mobileAppInfo', {}, $event)\\\"> {{::lang.values.aboutThisApp || 'About this app'}} </a> </li> </ul> </div> <ul ng-if=::showSocialLinks class=social> <li ng-repeat=\\\"(name, link) in ::config.footerSocialLinks\\\"> <a href={{link}} ng-attr-target=\\\"{{mobile.isMobileApp() ? '_system' : '_blank' }}\\\" id=nav-social-{{name}} class=icon-social-{{name}} analytics-click=\\\"['footer {{name}} link', 'click']\\\" aria-label=\\\"Open {{name}}\\\"></a> </li> </ul> </section> <div ng-if=\\\"auth.user.status !== 'trial' && !config.dotComModule.mobileNav.logoutButton.sticky\\\" ng-class=\\\"{'logged-in': auth.user.status !== 'trial'}\\\" class=logout-button-container> <unata-nav-logout-button parent=$parent></unata-nav-logout-button> </div> </div> <div ng-if=\\\"auth.user.status === 'trial' && config.dotComModule.mobileNav.loginButton.showCta && !config.dotComModule.mobileNav.logoutButton.sticky\\\" ng-class=\\\"{'show-cta': auth.user.status === 'trial'}\\\" class=logout-button-container> <h3 class=cta-title>{{::config.dotComModule.mobileNav.loginButton.ctaTitle}}</h3> <span class=cta-description>{{::config.dotComModule.mobileNav.loginButton.ctaDescription}}</span> <unata-nav-logout-button parent=$parent ng-click=closeMenu()></unata-nav-logout-button> </div> <div ng-if=::config.dotComModule.mobileNav.logoutButton.sticky> <unata-nav-logout-button parent=$parent></unata-nav-logout-button> </div> </nav> <button type=button class=nav-backdrop ng-class=\\\"{show: mobileNavService.slideOutMenuIsVisible}\\\" ng-click=mobileNavService.hideSlideOutMenu() aria-hidden={{!mobileNavService.slideOutMenuIsVisible}} aria-label=\\\"Close Main Menu\\\"></button> </div> </div> \";","module.exports = \"<div class=\\\"modal-header modal-mobile-header-brand\\\"> <button ng-if=isBackButtonVisible() ng-click=handleBackButtonClickFrom(shoppingSelectorStage) aria-label={{::lang.aria.back}} id={{getBackButtonId()}} class=go-back-link auto-focus=true data-test=context-modal-back-button> <span class=icon-chevron-left aria-hidden=true></span> </button> <img ng-if=config.useAltShoppingModalLogo ng-src=\" + require(\"assets/images/alt-logo.svg\") + \" fallback-src=\" + require(\"assets/images/footer-logo.svg\") + \" alt=\\\"Brand Logo\\\" class=modal-mobile-header-brand-logo /> <img ng-if=!config.useAltShoppingModalLogo ng-src=\" + require(\"assets/images/header-logo.svg\") + \" fallback-src=\" + require(\"assets/images/footer-logo.svg\") + \" alt=\\\"Brand Logo\\\" class=modal-mobile-header-brand-logo /> <button ng-if=showCloseButton() class=close ng-click=processModalCloseClick() analytics-click=\\\"['shop modal close button', 'click']\\\" id=shopping-selector-parent-process-modal-close-click aria-label={{::lang.aria.modalClose}} auto-focus=true> <span class=icon-delete aria-hidden=true></span> </button> </div> \";","module.exports = \"<div class=\\\"gift-card-modal modal-container\\\"> <div class=modal-header ng-if=::!mobile.isMobile> {{::lang.values.giftCard.title}} <button ng-click=$dismiss() class=close aria-label={{::lang.aria.modalClose}} auto-focus=true> <span class=icon-delete aria-hidden=true></span> </button> </div> <div class=\\\"modal-header modal-header__light\\\" ng-if=::mobile.isMobile> <a ng-click=$dismiss() class=modal-header__back aria-label={{::lang.aria.modalClose}} auto-focus=true></a> <h1 class=modal-header-title>{{::lang.values.giftCard.title}}</h1> </div> <form class=\\\"gift-card-modal-content modal-content\\\"> <div ng-if=isLoading class=view-loading-indicator></div> <div class=gift-card-input-ct> <div class=gift-card-input-number> <label for=gift-card-input-number> {{::lang.values.giftCard.enterGiftCard}} </label> <input type=text id=gift-card-input-number class=input ng-class=\\\"{'error': error}\\\" ng-model=giftCard.card_number placeholder={{::lang.values.giftCard.enterGiftCard}} /> </div> <div class=gift-card-input-amount> <label for=gift-card-input-amount> {{::lang.values.giftCard.enterAmount}} </label> <input type=text id=gift-card-input-amount class=input ng-class=\\\"{'error': error}\\\" ng-model=giftCard.amount placeholder={{::lang.values.giftCard.enterAmount}} /> </div> </div> <button ng-if=::mobile.isMobile class=\\\"button dark gift-card-modal__apply-button\\\" ng-click=submitAddGiftCard()> {{::lang.values.apply}} </button> <p class=\\\"message error\\\" ng-if=error> <span class=icon-error aria-hidden=true></span> {{error}} </p> <div ng-if=::!mobile.isMobile class=\\\"row buttons-box\\\"> <button class=button ng-click=submitAddGiftCard()> {{::lang.values.submit}} </button> </div> </form> </div> \";","module.exports = \"<div class=order ng-class=\\\"'order_status-' + order.status\\\"> <div ng-if=isOrderAddedToCart.top class=\\\"message success\\\" scroll-into-view> <span class=icon-checkmark-circle aria-hidden=true></span> {{::lang.values.selectedItemsAdded}} <span ng-if=\\\"::shoppingIntent !== 'instore'\\\">{{::lang.values.toShoppingCartLC}}</span> <span ng-if=\\\"::shoppingIntent === 'instore'\\\">{{::lang.values.toShoppingListLC}}</span> </div> <div class=content-header> <h3 class=content-header-title ng-if=\\\"::!config.orderHistoryView.showOrderTracker || mobileService.isMobile\\\"> {{::lang.values.order}} # {{order.id}} {{(order.status === 'cancelled') ? '-' : ''}} <span class=cancelled ng-if=\\\"order.status === 'cancelled' \\\">{{::lang.values.cancelled}}</span> </h3> <div class=order-actions ng-if=::!config.orderHistoryView.showOrderTracker> <button ng-if=showTipAndRatingButton() class=\\\"button small highlight\\\" ng-click=tip() analytics-click=\\\"['account order rate and tip button', 'click']\\\"> {{::lang.values.instacart.rateAndTip}} </button> <button class=\\\"button small cart action\\\" ng-click=\\\"loadList(selectedItems, 'top')\\\" ng-disabled=\\\"selectedItems.length === 0\\\" ng-if=shouldShowAddSelectedItemButton() analytics-click=\\\"['account order add to cart button', 'click']\\\" send-analytics=!$root.modifyingOrder> {{::lang.values.addSelectedItems}} <span ng-if=\\\"::shoppingIntent !== 'instore'\\\">{{::lang.values.toShoppingCart}}</span> <span ng-if=\\\"::shoppingIntent === 'instore'\\\">{{::lang.values.toShoppingList}}</span> </button> <span uib-popover={{::lang.values.cateringOrderCancelMessage}} popover-trigger=\\\"mouseenter focus\\\" popover-enable=\\\"order.ext_data.source_cart_type === CART_TYPES.CATERING\\\"> <button ng-show=isShowCancelButton() data-test=order-history-cancel-order-button class=\\\"button small hollow\\\" ng-click=cancelOrder() ng-disabled=!enableCancelButton() analytics-click=\\\"['account order cancel order button', 'click']\\\"> {{::lang.values.cancelOrder}} </button> </span> <span uib-popover={{::lang.values.cateringOrderModifyMessage}} popover-trigger=\\\"mouseenter focus\\\" popover-enable=\\\"order.ext_data.source_cart_type === CART_TYPES.CATERING\\\"> <button data-test=order-history-modify-order-button ng-disabled=!enableModifyButton() class=\\\"button small\\\" ng-click=modifyOrder() analytics-click=\\\"['account order modify order button', 'click']\\\" ng-if=isShowModifyButton()> {{::lang.values.modifyOrder}} </button> </span> </div> <div ng-if=::config.orderHistoryView.showOrderTracker class=order-tracker ng-class=\\\"::{'no-order-line': !config.orderHistoryView.includeOrderTrackerProgressLine}\\\"> <react-order-track enable-modify-button=enableModifyButton() enable-cancel-button=enableCancelButton() show-order-detail-button=isShowOrderDetailButton() show-pickup-detail-button=isShowPickupDetailButton() show-modify-button=isShowModifyButton() show-cancel-button=isShowCancelButton() show-tips-rating-button=isShowTipAndRatingButton() initial-order-status=::order.status order-id=\\\"::(order.id * 1)\\\" on-order-detail=(goToOrderInstacartLink) on-pickup-detail=(goToPickupInstacartLink) on-modify=(modifyOrder) on-cancel=(cancelOrModifyOrder) on-tip-rating=(tip) resources=orderTrackResources /> </div> </div> <div class=\\\"content-section instacart-delivery-wrapper\\\" ng-if=showNonOrderTrackInstacartSection()> <div class=powered-by-text> <div class=instacart-logo-wrapper> <img src=\" + require(\"static/images/instacart-logo-square.svg\") + \" alt={{::lang.values.instacart.instacart}}> </div>{{::lang.values[order.fulfillment_type === SHOPPING_MODES.PICKUP ? SHOPPING_MODES.PICKUP : SHOPPING_MODES.DELIVERY]}} {{::lang.values.instacart.poweredBy}} {{::lang.values.instacart.instacart}} </div> <div class=powered-by-button> <button class=\\\"button small cart action hollow\\\" ng-click=instacartService.goToInstacartLink(order.ext_data.pickup_status_url) ng-if=order.ext_data.pickup_status_url analytics-click=\\\"['account order view pickup status button', 'click']\\\"> {{::lang.values.instacart.pickupDetails}} </button> <button ng-if=::!config.orderHistoryView.disableViewOrderProgress class=\\\"button small cart action\\\" ng-click=instacartService.goToInstacartLink(order.ext_data.instacart_order_url) analytics-click=\\\"['account order view order progress button', 'click']\\\"> {{::lang.values.instacart.viewOrderProgress}} </button> </div> </div> <div class=\\\"content-section items\\\"> <div class=order-add-on-messages> <div ng-if=error class=\\\"message error\\\" scroll-into-view> <span class=icon-error aria-hidden=true></span> {{error}} </div> <div ng-if=message class=\\\"message success\\\" scroll-into-view> <span class=icon-checkmark-circle aria-hidden=true></span> {{message}} </div> </div> <h2 class=section-divider-small> <span class=title>{{::lang.values.itemsOrdered}}</span> </h2> <div ng-if=config.orderHistoryView.showOrderTracker class=order-track-items-inline-buttons> <button class=\\\"button small\\\" ng-click=\\\"loadList(selectedItems, 'top')\\\" ng-disabled=\\\"selectedItems.length === 0\\\" ng-if=shouldShowAddSelectedItemButton() analytics-click=\\\"['account order add to cart button', 'click']\\\" send-analytics=!$root.modifyingOrder> {{::lang.values.addSelectedItems}} <span ng-if=\\\"::shoppingIntent !== 'instore'\\\">{{::lang.values.toShoppingCart}}</span> <span ng-if=\\\"::shoppingIntent === 'instore'\\\">{{::lang.values.toShoppingList}}</span> </button> <button ng-if=showInlineExternalProgressButton() class=\\\"button small\\\" ng-click=instacartService.goToInstacartLink(order.ext_data.instacart_order_url) analytics-click=\\\"['account order view order progress button', 'click']\\\"> {{::lang.values.orderTracker.orderStatus.viewOrderProgressButton}} </button> <button ng-if=isUseItemEditFlow() class=\\\"button small modify-items-button\\\" ng-click=modifyOrder() analytics-click=\\\"['account order modify order button', 'click']\\\"> {{::lang.values.orderHistoryView.editItems}} </button> </div> <table ng-if=order.order_items.length class=table> <thead> <tr> <td colspan=\\\"{{::(mobile.isMobile ? 3 : 1)}}\\\"> <input class=checkbox type=checkbox ng-change=selectAll() ng-model=selectAllCheckbox.value aria-label={{::lang.aria.selectAll}} id=orderProductSelectAll> <label for=orderProductSelectAll>{{::(mobile.isMobile ? lang.values.selectAll : '' )}}</label> </td> <td ng-if=::(!mobile.isMobile) colspan=2>{{::lang.values.productName}}</td> <td ng-if=::(!mobile.isMobile)>{{::lang.values.notes}}</td> <td ng-if=::(!mobile.isMobile)>{{::lang.values.allowSubs}}</td> <td ng-if=::(!mobile.isMobile)>{{::lang.values.quantity}}</td> <td ng-if=::(!mobile.isMobile)>{{::lang.values.pricePaid}}</td> </tr> </thead> <tbody ng-if=isOrderAddOnVisible() class=order-add-on-wrapper> <tr class=category ng-if=\\\"order.additional_order_items.length > 0\\\"> <td colspan=\\\"{{::(mobile.isMobile ? 3 : 7)}}\\\"><strong>{{::lang.values.orderAddOn.tableHeader}}</strong></td> </tr> <tr class=order-add-on-cta ng-if=::!mobile.isMobile> <td colspan=6> <strong ng-if=\\\"order.additional_order_items.length === 0\\\">{{::lang.values.orderAddOn.headline}}</strong> <span>{{::lang.values.orderAddOn.disclaimer}}</span> </td> <td> <button class=\\\"button highlight\\\" ng-click=requestOrderAddOn() ng-if=order.can_add_items analytics-click=\\\"['account order request add-on button', 'click']\\\" id=requestAddOnButtonDesktop>{{::lang.values.orderAddOn.requestAddOn}}</button> </td> </tr> <tr class=parent ng-repeat-start=\\\"item in order.additional_order_items\\\"> <td class=action ng-disabled=!item.store_product.status> <input type=checkbox ng-disabled=\\\"!item.isReorderable || isItemOOS(item)\\\" class=checkbox ng-change=selectItem(item) aria-label=\\\"{{lang.aria.select + ' ' + item.store_product.name}}\\\" ng-model=\\\"selectedMap[item.store_product.id + '-' + getItemLineNumber(item)]\\\" id=orderProduct{{item.store_product.id}}-{{$index}}-addon> <label for=orderProduct{{item.store_product.id}}-{{$index}}-addon></label> </td> <td role=button class=\\\"action text-right internal-link\\\" ng-disabled=isProductDetailsModalDisabled(item) ng-click=\\\"!isProductDetailsModalDisabled(item) && productDetailsModal.open(item.store_product.id, { location: config.analyticsSourceKeys.orderHistory })\\\" analytics-click=\\\"['account order add-on product link', 'click']\\\" aria-label=\\\"{{lang.aria.openModal + ' ' + item.store_product.name}}\\\"> <div class=item-image ng-attr-style=\\\"background-image: url('{{::imageURLService.getProductImageURL(item.store_product, 'small')}}')\\\"></div> </td> <td class=internal-link ng-disabled=isProductDetailsModalDisabled(item) analytics-click=\\\"['account order add-on product link', 'click']\\\" colspan=3> <div role=button class=item-name ng-click=\\\"!isProductDetailsModalDisabled(item) && productDetailsModal.open(item.store_product.id, { location: config.analyticsSourceKeys.orderHistory })\\\"><span ng-bind-html=item.store_product.name></span></div> <div class=configurable-values-container ng-if=item.product_config.options.length> <p class=configurable-values compile=\\\"configurableProductService.configsString(item, true)\\\"></p> </div> <div ng-if=\\\"mobile.isMobile && item.customer_comment\\\" class=customer-comment>{{item.customer_comment}}</div> <div ng-if=\\\"item.child_order_item || (item.status == 'picked' || item.status == 'added' || item.status == 'removed')\\\" class=\\\"status icon {{(item.child_order_item) ? 'substituted' : item.status}}\\\">{{(item.child_order_item) ? 'substituted' : item.status}}</div> </td> <td ng-if=::(!mobile.isMobile) ng-disabled=\\\"item.isUnavailable || !item.isReorderable\\\"> <div ng-class=\\\"{ strikethrough: item.isUnavailable || !item.isReorderable }\\\">{{ item.quantity || item.actual_quantity }}</div> </td> <td ng-if=::(!mobile.isMobile) ng-disabled=\\\"item.isUnavailable || !item.isReorderable\\\"> <div ng-class=\\\"{ strikethrough: item.isUnavailable || !item.isReorderable }\\\">{{ item.sub_total | currency }}</div> </td> </tr> <tr ng-repeat-end ng-if=::mobile.isMobile ng-disabled=\\\"item.isUnavailable || !item.isReorderable\\\"> <td colspan=3> <div class=subs> . </div> <div class=\\\"quantity text-center\\\"> <span class=label>{{::lang.values.qty}}</span> <span class=text ng-class=\\\"{ strikethrough: item.isUnavailable || !item.isReorderable }\\\">{{ item.quantity || item.actual_quantity }}</span> </div> <div class=\\\"paid text-right\\\"> <span class=label>{{::lang.values.paid}}</span> <span class=text ng-class=\\\"{ strikethrough: item.isUnavailable || !item.isReorderable }\\\">{{ item.sub_total | currency }}</span> </div> </td> </tr> <tr class=order-add-on-cta ng-if=::mobile.isMobile> <td colspan=6> <strong ng-if=\\\"order.additional_order_items.length === 0\\\">{{::lang.values.orderAddOn.headline}}</strong><br/> <button class=\\\"button highlight\\\" ng-if=order.can_add_items ng-click=requestOrderAddOn() analytics-click=\\\"['account order request add-on button', 'click']\\\" id=requestAddOnButtonMobile>{{::lang.values.orderAddOn.requestAddOn}}</button> <span>{{::lang.values.orderAddOn.disclaimer}}</span> </td> </tr> </tbody> <tbody ng-repeat=\\\"category in orderedCategories\\\" ng-init=\\\"categoryIndex = $index\\\"> <tr class=category> <td colspan=\\\"{{::(mobile.isMobile ? 3 : 7)}}\\\">{{category}}</td> </tr> <tr class=parent ng-if=\\\"item.store_product.product_type == 'product'\\\" ng-repeat-start=\\\"item in categorizedProducts[category]\\\"> <td class=action ng-disabled=item.isUnavailable> <input type=checkbox class=checkbox ng-change=selectItem(item) id=orderProduct{{categoryIndex}}-{{$index}} ng-disabled=\\\"!item.isReorderable || item.isUnavailable\\\" aria-label=\\\"{{lang.aria.select + ' ' + item.store_product.name}}\\\" ng-model=\\\"selectedMap[item.store_product.id + '-' + getItemLineNumber(item)]\\\"/> <label for=orderProduct{{categoryIndex}}-{{$index}} tabindex=\\\"{{ isItemOOS(item) ? '0' : '-1' }}\\\" uib-popover-html=outOfStockWarningPopover popover-trigger=\\\"mouseenter focus\\\" popover-enable=isItemOOS(item) popover-placement=auto></label> </td> <td role=button class=\\\"action text-right internal-link\\\" ng-disabled=isProductDetailsModalDisabled(item) ng-click=\\\"!isProductDetailsModalDisabled(item) && productDetailsModal.open(item.store_product.id, { location: config.analyticsSourceKeys.orderHistory })\\\" analytics-click=\\\"['account order product link', 'click']\\\" aria-label=\\\"{{lang.aria.openModal + ' ' + item.store_product.name}}\\\"> <div class=item-image ng-attr-style=\\\"background-image: url('{{::imageURLService.getProductImageURL(item.store_product, 'small')}}')\\\"></div> </td> <td class=internal-link analytics-click=\\\"['account order product link', 'click']\\\" ng-disabled=isProductDetailsModalDisabled(item)> <div role=button class=item-name ng-click=\\\"!isProductDetailsModalDisabled(item) && productDetailsModal.open(item.store_product.id, { location: config.analyticsSourceKeys.orderHistory })\\\"><span ng-bind-html=item.store_product.name></span></div> <div class=configurable-values-container ng-if=item.product_config.options.length> <p class=configurable-values compile=\\\"configurableProductService.configsString(item, true)\\\"></p> </div> <div ng-if=\\\"mobile.isMobile && item.customer_comment\\\" class=customer-comment>{{item.customer_comment}}</div> <div ng-if=\\\"item.child_order_item || (item.status == 'picked' || item.status == 'added' || item.status == 'removed')\\\" class=\\\"status icon {{(item.child_order_item) ? 'substituted' : item.status}}\\\">{{(item.child_order_item) ? 'substituted' : item.status}}</div> </td> <td ng-if=::(!mobile.isMobile) ng-disabled=\\\"item.isUnavailable || !item.isReorderable\\\"> <div ng-if=item.customer_comment class=customer-comment>{{item.customer_comment}}</div> </td> <td ng-if=::(!mobile.isMobile) ng-disabled=\\\"item.isUnavailable || !item.isReorderable\\\"> <div>{{item.allow_substitutions | humanBool}}</div> </td> <td ng-if=::(!mobile.isMobile) ng-disabled=\\\"item.isUnavailable || !item.isReorderable\\\"> <div ng-class=\\\"{ strikethrough: item.isUnavailable || !item.isReorderable }\\\">{{ item.quantity || item.actual_quantity }}</div> </td> <td ng-if=::(!mobile.isMobile) ng-disabled=\\\"item.isUnavailable || !item.isReorderable\\\"> <div ng-class=\\\"{ strikethrough: item.isUnavailable || !item.isReorderable }\\\">{{ item.sub_total | currency }}</div> </td> </tr> <tr ng-if=\\\"mobile.isMobile && !(item.isUnavailable && item.child_order_item)\\\" ng-disabled=\\\"item.isUnavailable || !item.isReorderable\\\"> <td colspan=3> <div class=subs><span class=label>Allow Subs</span><span class=text>{{ item.allow_substitutions | humanBool }}</span></div> <div class=\\\"quantity text-center\\\"> <span class=label>{{::lang.values.qty}}</span> <span class=text ng-class=\\\"{ strikethrough: item.isUnavailable || !item.isReorderable }\\\">{{ item.quantity || item.actual_quantity }}</span> </div> <div class=\\\"paid text-right\\\"> <span class=label>{{::lang.values.paid}}</span> <span class=text ng-class=\\\"{ strikethrough: item.isUnavailable || !item.isReorderable }\\\">{{ item.sub_total | currency }}</span> </div> </td> </tr> <tr class=child ng-if=\\\"item.store_product.product_type == 'product' && item.child_order_item\\\" ng-disabled=!item.child_order_item.store_product.status> <td class=action> <div class=substituted-icon></div> </td> <td role=button class=internal-link ng-click=\\\"!item.child_order_item.store_product.status && !isProductDetailsModalDisabled(item) && productDetailsModal.open(item.child_order_item.store_product.id, { location: config.analyticsSourceKeys.orderHistory })\\\" analytics-click=\\\"['account order substituted product link', 'click']\\\"> <div class=item-image ng-attr-style=\\\"background-image: url('{{::imageURLService.getProductImageURL(item.child_order_item.store_product, 'small')}}')\\\"></div> </td> <td role=button class=internal-link ng-click=\\\"!item.child_order_item.store_product.status && !isProductDetailsModalDisabled(item) && productDetailsModal.open(item.child_order_item.store_product.id, { location: config.analyticsSourceKeys.orderHistory })\\\" analytics-click=\\\"['account order substituted product link', 'click']\\\"> <div class=item-name><span ng-bind-html=item.child_order_item.store_product.name></span></div> </td> <td ng-if=::(!mobile.isMobile) colspan=2></td> <td ng-if=::(!mobile.isMobile)>{{ item.child_order_item.quantity || item.child_order_item.actual_quantity }}</td> <td ng-if=::(!mobile.isMobile)>{{ item.child_order_item.sub_total | currency }}</td> </tr> <tr ng-repeat-end ng-if=\\\"mobile.isMobile && item.store_product.product_type == 'product' && item.child_order_item\\\"> <td colspan=3> <div class=subs> <span ng-if=\\\"(item.isUnavailable || !item.isReorderable && item.child_order_item)\\\"> <span class=label>Allow Subs</span><span class=text>{{ item.allow_substitutions | humanBool }}</span> </span> <span ng-if=\\\"!(item.isUnavailable || !item.isReorderable && item.child_order_item)\\\">&nbsp;</span> </div> <div class=\\\"quantity text-center\\\"> <span class=label>{{::lang.values.qty}}</span> <span class=text>{{ item.child_order_item.quantity || item.child_order_item.actual_quantity }}</span> </div> <div class=\\\"paid text-right\\\"><span class=label>{{::lang.values.paid}}</span><span class=text>{{ item.child_order_item.sub_total | currency }}</span></div> </td> </tr> </tbody> </table> </div> <div ng-if=isOrderAddedToCart.bottom class=\\\"message success\\\" scroll-into-view> <span class=icon-checkmark-circle aria-hidden=true></span> {{::lang.values.selectedItemsAdded}} <span ng-if=\\\"::shoppingIntent !== 'instore'\\\">{{::lang.values.toShoppingCartLC}}</span> <span ng-if=\\\"::shoppingIntent === 'instore'\\\">{{::lang.values.toShoppingListLC}}</span> </div> <div class=content-header> <button ng-if=\\\"isUseItemEditFlow() && config.orderHistoryView.showOrderTracker\\\" class=\\\"button small modify-items-button\\\" data-test=modify-items-button ng-click=modifyOrder() analytics-click=\\\"['account order modify order button', 'click']\\\"> {{::lang.values.orderHistoryView.editItems}} </button> <div class=order-actions> <button class=\\\"button small cart action\\\" ng-click=\\\"loadList(selectedItems, 'bottom')\\\" ng-disabled=\\\"selectedItems.length === 0\\\" ng-if=shouldShowAddSelectedItemButton() analytics-click=\\\"['account order add to cart button', 'click']\\\" send-analytics=!$root.modifyingOrder> {{::lang.values.addSelectedItems}} <span ng-if=\\\"::shoppingIntent !== 'instore'\\\">{{::lang.values.toShoppingCart}}</span> <span ng-if=\\\"::shoppingIntent === 'instore'\\\">{{::lang.values.toShoppingList}}</span> </button> <add-to-list ng-if=::!config.disableSaveForLaterLists popover-button-extra-class=small products=selectedItems></add-to-list> </div> </div> <div ng-if=order.fulfillment_type> <div class=\\\"content-section details\\\"> <h2 class=section-divider-small> <span class=title>{{::lang.values.orderDetails}}</span> <span ng-if=!config.orderHistoryView.showOrderTracker> <img ng-if=::(showInstacartLogo(false)) class=section-divider__image ng-src=\\\"{{::utilService.loadAssetImage('images/ic-express/instacart-delivered-by--desktop.svg')}}\\\" alt=\\\"{{::lang.values.delivery}} {{::lang.values.instacart.poweredBy}} {{::lang.values.instacart.instacart}}\\\"> <img ng-if=::(showInstacartLogo(true)) class=section-divider__image ng-class=\\\"{ 'is-mobile': (mobile.isMobile) }\\\" ng-src=\\\"{{::utilService.loadAssetImage('images/ic-express/instacart-logo-30px.png')}}\\\" alt=\\\"{{::lang.values.delivery}} {{::lang.values.instacart.poweredBy}} {{::lang.values.instacart.instacart}}\\\"> </span> </h2> <div ng-if=\\\"config.orderHistoryView.showOrderTracker && config.orderHistoryView.showPickupDetailsButton\\\" class=order-track-details-inline-buttons> <button class=\\\"button small cart action\\\" ng-click=instacartService.goToInstacartLink(order.ext_data.pickup_status_url) ng-if=showInlineExternalPickupButton() analytics-click=\\\"['account order view pickup status button', 'click']\\\"> {{::lang.values.orderTracker.orderStatus.pickupDetailsButton}} </button> </div> <div class=col> <div class=field> <label>{{::lang.values.orderPlaced}}</label> <div class=data>{{order.timestamp | apiDate:'MMM Do, YYYY [at] h:mma'}}</div> </div> <div class=field> <label>Deliver To</label> <div class=data>{{order.delivery_address.first_name}} {{order.delivery_address.last_name}}</div> </div> <div class=field ng-if=\\\"order.fulfillment_type == 'delivery'\\\"> <label>{{::lang.values.deliveryAddress}}</label> <div class=data> <div>{{order.delivery_address.address1}}</div> <div>{{order.delivery_address.address2}}</div> <div>{{order.delivery_address.address3}}</div> <div>{{order.delivery_address.city}}, {{order.delivery_address.province}} {{order.delivery_address.postal_code}}</div> </div> </div> <div class=field ng-if=::(showDeliveryInstructions())> <label>{{::lang.values.deliveryInstructions}}</label> <div class=data> {{order.customer_comment !== null ? order.customer_comment : order.delivery_address.instructions}} <span ng-if=order.leave_unattended class=leave-unattended-no-wrap> {{::lang.values.orderDeliveryInstructions.unattendedDelivery}} </span> </div> </div> <div class=field ng-if=\\\"order.fulfillment_type == 'pickup'\\\"> <label>{{::lang.values.pickupAt}}</label> <div class=data> <div>{{order.store.name}}</div> <div>{{order.store.address.address1}}</div> <div>{{order.store.address.address2}}</div> <div>{{order.store.address.address3}}</div> <div>{{order.store.address.city}}, {{order.store.address.province}} {{order.store.address.postal_code}}</div> <div>Phone: {{order.store.phone_number}}</div> </div> </div> </div> <div class=col> <div class=field> <label>{{::lang.values.orderType}}</label> <div class=\\\"data capitalize\\\">{{order.ext_data && order.ext_data.source_cart_type || order.fulfillment_type}}</div> </div> <div class=field> <label>{{::lang.values.fulfillmentTime}}</label> <div class=data>{{::timeslotLabelFn()}}</div> </div> <div class=field> <label>{{::lang.values.orderStatus}}</label> <div class=data>{{::lang.values.orderStatuses[order.status]}}</div> </div> <div class=field ng-if=order.ext_data.pos_receipt_number> <label>{{::lang.values.receiptId}}</label> <div class=data>{{order.ext_data.pos_receipt_number}}</div> </div> <div class=field ng-if=order.ext_data.pos_order_number> <label>{{::lang.values.orderId}}</label> <div class=data>{{order.ext_data.pos_order_number}}</div> </div> <div class=field ng-show=\\\"order.customer_comment.length && !showDeliveryInstructions()\\\"> <label>{{::lang.values.orderNote}}</label> <div class=data>{{order.customer_comment}}</div> </div> <button ng-if=isUseRescheduleOrderButton() class=\\\"button hollow small reschedule-button\\\" ng-click=jumpToCheckout(CHECKOUT_STEP_IDS.SCHEDULE) analytics-click=\\\"['account order reschedule order button', 'click']\\\" data-test=reschedule-order-button> {{::lang.values.orderHistoryView.reschedule}} </button> </div> </div> <div class=\\\"content-section payment\\\"> <h2 class=section-divider-small> <span class=title>{{::lang.values.paymentInformation}}</span> </h2> <div class=col> <div class=field> <label>{{::lang.values.paymentMethod}}</label> <div class=\\\"data capitalize\\\"> <span ng-if=isPaidWithCreditCard(order)> {{ lang.template(lang.values.creditCardFormat, { name: order.payment_instruments[0].provider, lastFourDigits: order.payment_instruments[0].last_four_digits }) }} </span> <span ng-if=!isPaidWithCreditCard(order)> {{::lang.values.paymentTypes[order.payment_type][order.fulfillment_type]}} </span> </div> </div> <button ng-if=isUseModifyOrderPaymentButton() class=\\\"button hollow small payment-change-button\\\" ng-click=jumpToCheckout(CHECKOUT_STEP_IDS.PAYMENT) analytics-click=\\\"['account order reschedule order button', 'click']\\\" data-test=change-payment-button> {{::lang.values.orderHistoryView.changePayment}} </button> <div ng-if=\\\"config.editCreditCardAfterOrdering && order.can_update\\\" class=field ng-class=\\\"{loading: loading}\\\"> <button class=\\\"button update-credit-card\\\" ng-disabled=loading ng-click=toggleCreditCardForm() ng-if=hideCreditCardForm> {{::lang.values.updateCreditCard}} &nbsp; <img ng-if=loading src=\" + require(\"static/images/loading-small.svg\") + \" alt={{::lang.values.loading}} /> </button> <update-credit-card ng-if=!hideCreditCardForm fulfillment-type=order.fulfillment_type delivery-address=order.delivery_address billing-address=order.billing_address payment=payment payment-type=order.payment_type on-save=\\\"updateCreditCard(payment, error)\\\"></update-credit-card> <div ng-if=!hideUpdateCreditCardError class=\\\"message error message-width-override\\\" scroll-into-view> <span class=icon-error aria-hidden=true></span> {{::lang.values.paymentInformationNotUpdated}} </div> <div ng-if=!hideUpdateCreditCardSuccess class=\\\"message success message-width-override\\\" scroll-into-view> <span class=icon-checkmark-circle aria-hidden=true></span> {{::lang.values.paymentInformationUpdated}} </div> </div> </div> <div class=col> <div class=order-totals-column-wrapper> <react-order-totals bold-labels=true line-items=getOrderTotalsLines()></react-order-totals> </div> </div> </div> </div> <div ng-if=!order.fulfillment_type> <div class=\\\"content-section invalid-total\\\"> <h2 class=section-divider-small> <span class=title>Payment Information</span> </h2> <div class=col> <div class=form-row> <label>Total</label> <div class=data>{{order.final_totals.total | currency}}</div> </div> </div> </div> </div> </div> \";","module.exports = \"<div class=\\\"view change-password\\\"> <div class=wrapper> <div ng-if=!message> <h1 class=section-divider-small> <span class=title>{{::lang.values.enterNewPassword}}</span> </h1> <div class=input-help ng-if=lang.values.passwordInputHelpText> {{::lang.values.passwordInputHelpText}} </div> <form name=passwordChangeForm ng-submit=\\\"change(); analytics.logEvent('change password', 'submit')\\\"> <div class=form-row> <input class=\\\"input small\\\" type=password name=newPassword required ng-model=values.newPassword placeholder=\\\"{{::lang.values.passwordNew + ' *'}}\\\" aria-label=\\\"{{::lang.values.passwordNew + ' ' + lang.aria.required}}\\\" ng-pattern=passwordRegex ng-minlength={{::config.passwordMinLength}} ng-maxlength={{::config.passwordMaxLength}} ng-model-options=\\\"{ updateOn: 'default blur', debounce: { default: 500, blur: 0 } }\\\"/> <span id=confirm-new-password-error class=required-field ng-if=\\\"(passwordChangeForm.newPassword.$touched || passwordChangeForm.$submitted) && passwordChangeForm.newPassword.$error.required\\\">{{::lang.values.requiredForm.password}} </span> <span id=confirm-new-password-error class=required-field ng-if=\\\"(passwordChangeForm.newPassword.$touched || passwordChangeForm.$submitted) && passwordChangeForm.newPassword.$error.minlength\\\">{{::lang.values.passwordInvalidMinLength}} </span> <span id=confirm-new-password-error class=required-field ng-if=\\\"(passwordChangeForm.newPassword.$touched || passwordChangeForm.$submitted) && passwordChangeForm.newPassword.$error.maxlength\\\">{{::lang.values.passwordInvalidMaxLength}} </span> <span id=confirm-new-password-error class=required-field ng-if=\\\"(passwordChangeForm.newPassword.$touched || passwordChangeForm.$submitted) &&\\n              !passwordChangeForm.newPassword.$error.minlength &&\\n              !passwordChangeForm.newPassword.$error.maxlength &&\\n              passwordChangeForm.newPassword.$error.pattern\\\">{{::lang.values.passwordInvalid}} </span> </div> <div class=form-row> <input class=\\\"input small\\\" type=password name=newPasswordConfirm required ng-model=values.confirmNewPassword placeholder=\\\"{{::lang.values.passwordConfirmNew + ' *'}}\\\" aria-label=\\\"{{::lang.values.passwordConfirmNew + ' ' + lang.aria.required}}\\\" ng-pattern=passwordRegex ng-minlength={{::config.passwordMinLength}} ng-maxlength={{::config.passwordMaxLength}} ng-model-options=\\\"{ updateOn: 'default blur', debounce: { default: 500, blur: 0 } }\\\"/> <span id=confirm-new-password-error class=required-field ng-if=\\\"(passwordChangeForm.newPasswordConfirm.$touched || passwordChangeForm.$submitted) && passwordChangeForm.newPasswordConfirm.$error.required\\\">{{::lang.values.requiredForm.password}} </span> <span id=confirm-new-password-error class=required-field ng-if=\\\"(passwordChangeForm.newPasswordConfirm.$touched || passwordChangeForm.$submitted) && passwordChangeForm.newPasswordConfirm.$error.minlength\\\">{{::lang.values.passwordInvalidMinLength}} </span> <span id=confirm-new-password-error class=required-field ng-if=\\\"(passwordChangeForm.newPasswordConfirm.$touched || passwordChangeForm.$submitted) && passwordChangeForm.newPasswordConfirm.$error.maxlength\\\">{{::lang.values.passwordInvalidMaxLength}} </span> <span id=confirm-new-password-error class=required-field ng-if=\\\"(passwordChangeForm.newPasswordConfirm.$touched || passwordChangeForm.$submitted) &&\\n              !passwordChangeForm.newPasswordConfirm.$error.minlength &&\\n              !passwordChangeForm.newPasswordConfirm.$error.maxlength &&\\n              passwordChangeForm.newPasswordConfirm.$error.pattern\\\">{{::lang.values.passwordInvalid}} </span> </div> <button class=\\\"button form-row\\\" ng-disabled=\\\"changing || passwordChangeForm.$invalid\\\">{{::lang.values.passwordChange}}</button> </form> </div> <div ng-if=error class=\\\"message error\\\"> <span class=icon-error aria-hidden=true></span> {{error}} </div> <div ng-if=message> <h1 class=section-divider-small> <span class=title>{{message}}</span> </h1> <button ng-if=showLogin ng-click=login() class=button>{{::lang.values.login}}</button> </div> </div> </div> \";","module.exports = \"<div class=\\\"collection-modal modal-container\\\"> <div class=modal-header ng-class=\\\"{ 'modal-header-collapse-desktop modal-header-hidden-mobile': !items || items.featured }\\\"> <button class=close ng-click=$dismiss() analytics-click=\\\"['collection modal close button', 'click']\\\" aria-label={{::lang.aria.modalClose}} autofocus=true> <span class=icon-delete aria-hidden=true></span> </button> <h1 ng-if=!items.featured class=modal-header-title>{{items.name}}</h1> <a ng-if=\\\"(auth.getContext().intent !== 'instore' && mobile.isMobile) && !searching\\\" class=cart-button ui-sref=main.checkout.cart aria-label=\\\"{{::\\n        lang.templateAsString(\\n            lang.aria.cartIconButton,\\n            { itemCount: cartService.countItems(), context: 'cart' }\\n        )\\n      }}\\\"> <span class=cart-button-icon aria-label=hidden aria-hidden=true></span> <div class=count ng-if=\\\"cartService.countItems() > 0\\\">{{cartService.countItems()}}</div> </a> <a ng-if=\\\"(auth.getContext().intent === 'instore' && mobile.isMobile) && !searching\\\" class=list-button ui-sref=main.inStoreList.review aria-label={{::lang.aria.goToList}}> <div class=count ng-if=\\\"cartService.countItems() > 0\\\">{{cartService.countItems()}}</div> </a> </div> <div class=\\\"collection-modal-wrapper modal-content\\\"> <div ng-if=noticeAlert> <alert ng-if=\\\"noticeAlert.type === 'OFFER_UNAVAILABLE'\\\" type=warn-light disable-border=true small-text=true> <strong>{{::lang.values.offerUnavailableCaption}}</strong><br/> {{::lang.template(lang.values.offerUnavailableMessage, {validFrom: noticeAlert.params.validFrom, validTo: noticeAlert.params.validTo})}} </alert> <alert ng-if=\\\"noticeAlert.type === 'OFFER_EXPIRED'\\\" type=warn-light disable-border=true small-text=true> <strong>{{::lang.values.offerExpiredCaption}}</strong><br/> {{::lang.template(lang.values.offerExpiredMessage, {validFrom: noticeAlert.params.validFrom, validTo: noticeAlert.params.validTo})}} </alert> </div> <div ng-if=!items class=\\\"view-loading-indicator fill\\\"></div> <button ng-if=\\\"mobile.isMobile && items.featured\\\" class=close ng-click=$dismiss() analytics-click=\\\"['collection modal close button', 'click']\\\" aria-label={{::lang.aria.modalClose}}> <span class=icon-delete aria-hidden=true></span> </button> <featured-header ng-if=items.featured collection=items hide-back=true></featured-header> <div ng-if=\\\"items && items.length > 0\\\"> <ol class=cell-container> <li ng-repeat=\\\"item in items track by $index\\\" ng-if=\\\"item.item_type == 'store_product'\\\" class=cell-wrapper> <div product-cell product-details-modal-link=true product=item.store_product location=\\\"Collection Modal\\\" location-value=\\\"{'id': items.id, 'display_name': items.name}\\\" index=$index></div> </li> </ol> <ul ng-if=\\\"!mobile.isMobile && (items.item_count > config.productsPerPage)\\\" uib-pagination boundary-links=true previous-text=\\\"\\\" next-text=\\\"\\\" first-text=1 template-url=pagination-modified-uibootstrap-desktop.html total-items=items.item_count max-size=config.maxPaginationLinks items-per-page=config.productsPerPage ng-model=page.current class=pagination ng-click=\\\"analytics.logEvent('collection modal pagination', 'click')\\\"></ul> <ul ng-if=\\\"mobile.isMobile && (items.item_count > config.productsPerPage)\\\" uib-pagination boundary-links=true first-text=First template-url=pagination-modified-uibootstrap-mobile.html previous-text=\\\"\\\" next-text=\\\"\\\" total-items=items.item_count max-size=config.maxPaginationLinks items-per-page=config.productsPerPage ng-model=page.current class=pagination ng-click=\\\"analytics.logEvent('catalog products pagination', 'click')\\\"></ul> </div> </div> </div> \";","module.exports = \"<div class=\\\"modal-container customer-link-container\\\"> <instacart-customer-link-header on-dismiss=(onDismiss) skippable=skippable></instacart-customer-link-header> <div class=modal-content> <div class=customer-link-body> <instacart-customer-link-subheader></instacart-customer-link-subheader> <instacart-customer-link-notify close-modal=onClose skippable=skippable set-stage=setStage link-later=setLinkLater show-link-later=linkLater ng-if=\\\"stage===''\\\"></instacart-customer-link-notify> <instacart-customer-link-input skippable=skippable set-stage=setStage ng-if=\\\"stage==='link'\\\"></instacart-customer-link-input> <instacart-customer-link-confirm close-modal=onClose skippable=skippable ng-if=\\\"stage==='confirm'\\\"></instacart-customer-link-confirm> </div> </div> </div> \";","module.exports = \"<div class=\\\"view paypal\\\"> <h1>{{::lang.values.waitingPayPal}}</h1> <div class=view-loading-indicator></div> </div>\";","export const COLLECTION_CONSTANTS = {\n  PRODUCT_LIMIT: 10, // Currently baked into our design, if that changes this value likely makes more sense as a config\n  BIA_COLLECTION_ID: 'most_frequent', // The id of the collection to use for the buy it again carousel\n  HOMEPAGE_FP_COLLECTION_ID: 'homepage_featured', // The id of the collection to use for the homepage featured products carousel\n}\n","module.exports = \"<div class=\\\"message warn\\\"> <span class=icon-warning aria-hidden=true></span> {{::$ctrl.compareCartNotice}} </div> <table class=table> <thead ng-if=\\\":: (!mobile.isMobile && $ctrl.hasFlaggedProductsByCategory)\\\"> <tr class=text-left> <th scope=col>{{::$ctrl.lang.values.productName}}</th> <th scope=col>{{::$ctrl.lang.values.quantity}}</th> <th scope=col>{{::$ctrl.lang.values.total}}</th> </tr> </thead> <tbody ng-repeat=\\\"(category, items) in ::$ctrl.flaggedProductsByCategory\\\"> <tr class=category> <td colspan=3>{{ category }}</td> </tr> <tr class=products-list ng-repeat=\\\"item in items track by $index\\\" data-test=\\\"cart-compare-item-row-{{ item.id }}\\\" ng-if=\\\"(!item.store_product.product_type || item.store_product.product_type !== 'subscription') && item.quantity > 0\\\"> <td> <div class=product> <div class=image ng-attr-style=\\\"background-image: url('{{::$ctrl.imageURLService.getProductImageURL(item.store_product, 'small')}}')\\\" analytics-click=\\\"['cart product link', 'click']\\\"></div> <div class=meta> <div class=prod-name>{{ item.store_product.name }}</div> <div data-test=cart-compare-out-of-stock ng-if=item.hasProductInventoryChange class=inventory-diff> {{::$ctrl.lang.values.outOfStock}} </div> <div data-test=cart-compare-blackout ng-if=item.hasProductBlackout class=product-blackout> {{ item.blackoutMessage }} </div> <div data-test=cart-compare-product-lead ng-if=item.hasConfigurableProductLeadtime class=product-blackout> {{ item.configurableProductLeadtimeMessage }} </div> <div data-test=cart-compare-pricing-change ng-if=item.hasProductPricingChange class=pricing-diff> {{::$ctrl.lang.values.pricingChange}} </div> </div> </div> </td> <td> <div class=quantity> {{:: mobile.isMobile ? $ctrl.lang.values.values.qty + ' ' : ''}} <span class=quant-amnt>{{ item.quantity }}</span> <span class=quant-unit>{{ item.store_product.ordering_parameters.display_name.toLowerCase() != $ctrl.UNIT_OF_MEASURE.EACH ? item.store_product.ordering_parameters.display_name : '' }}</span> </div> </td> <td> <div class=total ng-if=item.hasProductPricingChange> <div class=total-txt>{{ mobile.isMobile ? $ctrl.lang.values.total : '' }}</div> <div class=new-total> {{ item.newPrice | currency }} <span class=per-unit>/ {{ item.store_product.display_uom }}</span> </div> <div class=old-total> {{::$ctrl.lang.values.was}} : <span class=total-strike>{{ item.oldPrice | currency }} / {{ item.store_product.display_uom }}</span> </div> </div> </td> </tr> </tbody> <tbody ng-if=\\\":: $ctrl.hasFlaggedOffers\\\" class=offers-list> <tr class=category> <td colspan=3><span class=offer-tag></span> {{::$ctrl.lang.values.offers}}</td> </tr> <tr ng-if=\\\":: $ctrl.flaggedOffers\\\" ng-repeat=\\\"offer in ::$ctrl.flaggedOffers\\\"> <td colspan=3> <div offer-tile offer-data=offer location=\\\"Compare Cart Offer\\\"></div> </td> </tr> </tbody> </table> \";","/**\n * Overwrites the JSON-LD script in the head element\n *\n * @param {Object} scriptEl\n * @param {Object} structuredData\n */\nconst overwriteJsonLdInHead = (scriptEl, structuredData) => {\n  const currentStructuredData = JSON.parse(scriptEl[0].innerHTML)\n  if (currentStructuredData['@type']) {\n    scriptEl[0].innerHTML = structuredData\n  }\n}\n\n/**\n * Creates and adds a JSON-LD script in the head element\n *\n * @param {Object} structuredData\n */\nconst addJsonLdToHead = structuredData => {\n  const scriptEl = document.createElement('script')\n\n  scriptEl.setAttribute('type', 'application/ld+json')\n  scriptEl.append(structuredData)\n\n  document.getElementsByTagName('head')[0].appendChild(scriptEl)\n}\n\n/**\n * Gets the current script elements with type \"application/ld+json\"\n */\nexport const getCurrentJsonLd = () =>\n  document.getElementsByTagName('head')[0].querySelectorAll('script[type=\"application/ld+json\"]')\n\n/**\n * Removes JSON-LD from head\n */\nexport const deleteJsonLd = () => {\n  const el = document\n    .getElementsByTagName('head')[0]\n    .querySelectorAll('script[type=\"application/ld+json\"]')[0]\n\n  if (el) el.parentNode.removeChild(el)\n}\n\n/**\n * Checks the scripts to see if one already exists,\n * if so it overwrites, if not it creates on and sets it\n *\n * @param {Object} scriptEl\n * @param {Object} structuredData\n */\nexport const setJsonLdInHead = (scriptEl, structuredData) => {\n  const stringifiedStructuredData = JSON.stringify(structuredData)\n\n  if (scriptEl.length) {\n    overwriteJsonLdInHead(scriptEl, stringifiedStructuredData)\n  } else {\n    addJsonLdToHead(stringifiedStructuredData)\n  }\n}\n","module.exports = \"<div class=\\\"view product-details\\\"> <nav aria-label=breadcrumbs> <ul ng-if=\\\"::!inEComLightMode && !inOrderAddOnMode && !placement.isExternalRoutesDisabled\\\" class=breadcrumbs> <li> <a ui-sref=main.home class=all analytics-click=\\\"['breadcrumbs home link', 'click']\\\" aria-label={{::lang.aria.goToHomepage}}> <span class=icon-home aria-hidden=true></span> </a> </li> <li ng-if=::isWaysToShopEnabled> <span class=divider></span> <a ui-sref=main.shop analytics-click=\\\"['breadcrumbs link', 'click']\\\">{{::lang.values.waysToShop}}</a> </li> <li> <span class=divider></span> <a ui-sref=main.shop.categories analytics-click=\\\"['breadcrumbs link', 'click']\\\">{{::lang.values.departments}}</a> </li> <li ng-repeat=\\\"category in ::product.categories\\\"> <span class=divider></span> <a ng-if=\\\"category.id !== currentCategory\\\" ui-sref=\\\"main.shop.category({category_id: category.id})\\\" ui-sref-opts=\\\"{inherit: false}\\\" analytics-click=\\\"['breadcrumbs link', 'click']\\\">{{::category.name}}</a> <span ng-if=\\\"category.id === currentCategory\\\">{{::category.name}}</span> </li> <li> <span class=divider></span> <a ng-if=isProductDetailsModal ui-sref=\\\"main.product({ id: product.id, name: (product.name | slugify), placement: placement })\\\" analytics-click=\\\"['breadcrumbs active link', 'click']\\\" class=active ng-bind-html=::product.name></a> <span ng-if=!isProductDetailsModal class=active ng-bind-html=::product.name></span> </li> </ul> </nav> <div> <div ng-if=message> <div role=alert class=\\\"message product-details-message {{:: message.type }}\\\"> {{:: message.content }} </div> </div> <placeholder-image type=productDetails remove-on=product></placeholder-image> <div ng-include=\\\"'productDetailsMainContent.html'\\\"></div> </div> <div ng-if=showBackToScanner class=scan-more-items-container> <button ng-click=backToScanner() ng-if=::config.enableBarcodeScanner class=\\\"button mobile-bottom icon-scanner uppercase barcode-scanner-button\\\" analytics-click=\\\"['backToScanner button', 'click']\\\" fixed-to-body>{{::lang.values.scanMoreItems}}</button> </div> </div> \";","module.exports = \"<div class=\\\"alcohol-validation-modal modal-container\\\"> <div class=modal-header> <button class=close id=alcohol-validation-modal ng-click=handleDismissClick() aria-label={{::lang.aria.close}}> <span class=icon-delete aria-hidden=true></span> </button> <h1 class=modal-header-title>{{::config.alcoholCompliance.title}}</h1> </div> <div class=modal-content> <p class=alcohol-validation-modal__subtitle> {{::config.alcoholCompliance.subtitle}} </p> <div class=alcohol-validation-modal__main> <div class=alcohol-validation-modal__input-group> <label for=dob>{{::lang.values.dateOfBirth}}</label> <input ng-model=dateOfBirth ui-mask=99/99/9999 type=text inputmode=numeric class=input placeholder=mm/dd/yyyy ng-class=\\\"{ 'error': (dateOfBirth !== undefined && !service.isDateOfBirthValid(dateOfBirth)) }\\\" id=dob autocomplete=bday /> <span class=alcohol-validation-modal__error-message ng-if=\\\"dateOfBirth && !service.isDateOfBirthValid(dateOfBirth)\\\"> {{::config.alcoholCompliance.errorMessage}} </span> </div> <p ng-bind-html=config.alcoholCompliance.disclaimer></p> <div> <div class=alcohol-validation-modal__actions> <button class=\\\"button dark\\\" ng-click=continue() ng-disabled=!service.isDateOfBirthValid(dateOfBirth)> {{::lang.values.continue}} </button> </div> </div> </div> </div></div>\";","module.exports = \"<section class=nutrition-table ng-if=\\\"$ctrl.nutrients && $ctrl.nutrients.length > 0\\\"> <div ng-if=::!$ctrl.mobile.isMobile> <h2 class=\\\"nutrition-table-section-title title-cell\\\">{{::$ctrl.lang.values.nutritionInformation}}</h2> </div> <div class=nutrition-table__title> {{::$ctrl.lang.template($ctrl.lang.values.nutritionInformationServing, {title: $ctrl.lang.values.nutritionInformation})}} </div> <div class=nutrition-table__container> <div ng-repeat=\\\"nutrient in ::$ctrl.nutrients track by $index\\\" class=nutrition-table__row> <div class=nutrition-table__parent-row> <div> <b>{{nutrient.name}}</b> </div> <div ng-if=\\\"nutrient.quantity !== ''\\\"> {{nutrient.quantity}}<span ng-if=nutrient.uom>{{nutrient.uom.toLowerCase()}}</span> </div> </div> <div ng-if=\\\"nutrient.children && nutrient.children.length > 0\\\" ng-repeat=\\\"nutrientChild in ::nutrient.children track by $index\\\" class=nutrition-table__child-row> <div> {{nutrientChild.name}} </div> <div ng-if=\\\"nutrientChild.quantity !== ''\\\"> {{nutrientChild.quantity}}<span ng-if=nutrientChild.uom>{{nutrientChild.uom.toLowerCase()}}</span> </div> </div> </div> </div> </section>\";","module.exports = \"<div class=\\\"offer-details view\\\"> <div ng-if=::!mobile.isMobile page-header show-search-tabs=false breadcrumbs=breadcrumbs no-background-border=true></div> <div class=offer ng-class=\\\"{'coupon-offer' : offer.offer_type === 'coupon'}\\\" ng-if=offer> {{ collapseOfferSection }} <div class=offer-info> <div ng-if=offer.end_date> <span class=offer-tag aria-hidden=true></span> </div> <span ng-if=offer.end_date> {{(lang.values.offerEndDate) ? lang.template(lang.values.offerEndDate, {endDate: (offer.end_date | apiDate:config.offerDateFormat)}) : 'Ends ' + (offer.end_date | date:'MMM D':config.apiDateFormat)}} </span> <span ng-if=\\\"offer.end_date && (offer.limit_total || offer.limit_customer || offer.limit_basket)\\\">-</span> <span ng-if=\\\"offer.limit_total || offer.limit_customer || offer.limit_basket\\\"> Limit {{(offer.limit_total) ? 'of '+offer.limit_total : ''}} {{(offer.limit_customer) ? offer.limit_customer+' per ' + lang.values.customer : ''}} {{(offer.limit_customer && offer.limit_basket )? ' - Limit ': ''}} {{(offer.limit_basket) ? offer.limit_basket+' per cart' : ''}} </span> </div> <div offer-icon offer=offer></div> <h1 class=offer-name ng-bind-html=offer.name ng-if=::!mobile.isMobile></h1> <h2 class=offer-name ng-bind-html=offer.name ng-if=::mobile.isMobile></h2> <div class=offer-description> <div class=description-text ng-bind-html=offer.description></div> </div> <div coupon-clipper ng-if=\\\"offer.offer_type == 'coupon'\\\" coupon=offer class=button></div> <div ng-if=\\\"offer.offer_type !== 'continuity'\\\" class=progress-divider offer-progress offer-progress-data=offerProgressData></div> <div ng-if=\\\"offer.offer_type === 'continuity'\\\"> <div continuity-progress offer=offer></div> <div role=button id=unata-loyalty-offer-start-button-{{offer.id}} ng-if=\\\"offer.continuity.rwd_count > 0 && offer.continuity.rwd_offer_id\\\" class=\\\"button continuity-offer-button\\\" ng-click=unlockContinuityOfferReward(offer.continuity.rwd_offer_id)> {{ ::config.continuityOffers.viewReward }} </div> <span ng-if=\\\"!(offer.continuity.rwd_count > 0 && offer.continuity.rwd_offer_id)\\\" class=continuity-disclaimer>{{ ::config.continuityOffers.progressDisclaimer }}</span> </div> </div> <div ng-if=offer.is_not_actionable> <h2 class=section-divider> <span class=\\\"title title--full offer-not-actionable\\\"> {{::config.lang.offersInactionableMessage}} </span> </h2> </div> <div ng-if=\\\"conditions.length > 0\\\" ng-repeat=\\\"condition in conditions\\\"> <div ng-if=\\\"condition.type !== 'cart' && condition.product_details.length\\\"> <h2 class=section-divider> <span class=\\\"title title--full\\\"> {{::getConditionLabel($index)}} <a class=more ui-sref=\\\"main.offers.details.conditions({offerId: offer.id})\\\" ng-if=\\\"condition.product_details.item_count > 5\\\" analytics-click=\\\"['offer details see more link', 'click']\\\" aria-label={{::lang.aria.seeMore}}>{{::lang.values.seeMore}}</a> </span> </h2> <ol class=\\\"cell-container offer-items\\\"> <li ng-repeat=\\\"item in condition.product_details\\\" class=offer-details-cell-wrapper> <div ng-if=\\\":: condition.type == 'products'\\\" class=offer-item related-product product-details-modal-link=true product=item location=\\\"Offer Details\\\"></div> <div ng-if=\\\":: condition.type == 'collection'\\\" class=offer-item related-product product-details-modal-link=true product=item.store_product location=\\\"Offer Details\\\"></div> </li> </ol> </div> </div> <div ng-if=\\\"rewards.length > 0\\\" ng-repeat=\\\"reward in rewards\\\"> <div ng-if=\\\"reward.type === 'products' && reward.product_details.length\\\"> <h2 class=section-divider> <span class=\\\"title title--full\\\"> {{::reward.rwd_collection_title || offerProgressData.reward.collection_title}} <a class=more ui-sref=\\\"main.offers.details.rewards({offerId: offer.id})\\\" ng-if=\\\"reward.product_details.item_count > 5\\\" aria-label={{::lang.aria.seeMore}}>{{::lang.values.seeMore}}</a> </span> </h2> <ol class=\\\"cell-container offer-items\\\" ng-if=\\\"reward.type == 'products'\\\"> <li ng-repeat=\\\"item in reward.product_details\\\" class=offer-details-cell-wrapper> <div class=offer-item related-product product-details-modal-link=true product=item location=\\\"Offer Details\\\"></div> </li> </ol> </div> </div> <div ng-if=offer.terms> <h2 class=section-divider> <span class=\\\"title title--full\\\"> {{::lang.values.termsAndConditions}} </span> </h2> <div class=tnc> {{offer.terms}} </div> </div> </div> \";","module.exports = \"<ul class=\\\"subcategories categories-grid\\\"> <li ng-repeat=\\\"subcategory in tree.children track by $index\\\" class=\\\"subcategory category\\\" category-filter=subcategory> <category-card analytics-click=\\\"['catalog subcategories image link', 'click']\\\" tile-size=\\\"'medium'\\\" href=subcategory.state category=subcategory data-test=category-card-{{subcategory.id}}></category-card> <ul class=children ng-if=config.enableCategoryCardChildren> <li ng-repeat=\\\"child in subcategory.children\\\"> <a ui-sref=\\\"{{ child.sref }}\\\" id=\\\"catalog-category-{{ child.id }}\\\" analytics-click=\\\"['catalog subcategories text link', 'click']\\\"> {{ child.name }} </a> </li> </ul> </li> </ul> \";","export const LOGIN_CONTEXTS = {\n  LOYALTY_ONBOARDING: 'loyaltyOnboarding',\n  MAIN_LOGIN_STATE: 'mainLoginState',\n  ON_REGISTRATION: 'onRegistration',\n  PASSWORD_CHANGE: 'passwordChange',\n  PRODUCT_USER_REVIEW: 'productUserReview',\n  PROMPT_LOGIN: 'promptLogin',\n  RECIPE_USER_REVIEW: 'recipeUserReview',\n  REGISTRATION_DROPDOWN: 'registrationDropdown',\n  SAVE_RECIPE: 'saveRecipe',\n  TAG_LOGIN: 'tagLogin',\n  UNREGISTERED_ROUTE_CHANGE: 'unregisteredRouteChange',\n  REDIRECT_ONECART_CHECKOUT: 'redirectOneCartCheckout',\n  REDIRECT_ONECART_ORDER_STATUS: 'redirectOneCartOrderStatus',\n  VIEW_ORDER_HISTORY: 'viewOrderHistory',\n  SOCIAL_SIGN_ON_LINK_MODAL: 'socialSignOnLinkModal',\n  INSTACART_EXPRESS: 'instacartExpress',\n}\n","module.exports = \"<ul> <li class=item-wrapper ng-class=\\\"{ 'out-of-stock': isItemCurrentlyOutOfStock(item) }\\\" ng-if=\\\"item.quantity > 0 && (!item.store_product.product_type || item.store_product.product_type !== 'subscription')\\\" ng-repeat=\\\"item in sortedProductsBy[sortType][groupName] track by $index\\\" ng-init=\\\"showEdit = false\\\" data-test=mini-cart-item id=mini-cart-item-{{::item.id}}> <div ng-include=\\\"'sideCartListItem.html'\\\" ng-init=\\\"sideCartReference = sideCartReference\\\"></div> </li> </ul> \";","module.exports = \"<div class=error-modal> <react-account-import-success-modal close=(close) /> </div> \";","module.exports = \"<div ng-if=$ctrl.isVisible class=\\\"message {{$ctrl.type}} {{$ctrl.noticeClass}}\\\" ng-class=\\\"{\\n      'no-border': $ctrl.disableBorder,\\n      'small-text': $ctrl.smallText,\\n      'is-closeable': $ctrl.closeable\\n    }\\\"> <span ng-class=$ctrl.icon aria-hidden=true class=message-icon></span> <ng-transclude></ng-transclude> <button ng-if=$ctrl.closeable ng-click=$ctrl.close() aria-label={{::lang.aria.closeNotice}} class=\\\"close message-close\\\"> <span class=\\\"icon-delete message-close-icon\\\" aria-hidden=true></span> </button> </div> \";","module.exports = \"<div class=error-modal> <react-account-import-error-modal go-to-account=(goToAccount) close=(close) /> </div> \";","module.exports = \"<div ng-if=\\\"$ctrl.cartLengthDiff !== 0\\\" class=\\\"cart-form__message message success\\\"> <span class=icon-checkmark-circle aria-hidden=true></span> <div class=cart-form__message-title>{{::$ctrl.lang.values.cartUpdated}}</div> <div class=cart-form__message-body> {{::$ctrl.updateMessage}} <a class=cart-form__message-dismiss-link id=cart-form-dismiss-button ng-click=$ctrl.onMessageDismiss()> {{::$ctrl.lang.values.dismiss}} </a> </div> </div> \";","module.exports = \"<div class=policy-modal-wrapper> <div class=\\\"policy-modal modal-container\\\"> <react-policy-modal on-close=$close></react-policy-modal> </div> </div>\";","module.exports = \"<div class=product-comments ng-disabled=disableProductComments() ng-if=!hideProductComments()> <div ng-if=::!mobile.isMobile> <div class=note-comment ng-show=!showEdit> <span ng-if=item.comment class=note>{{item.comment}}</span> <button class=add name=item-note-add-edit ng-disabled=disableProductComments() analytics-click=\\\"['product add note button', 'click']\\\" ng-click=\\\"\\n          comment = item.comment;\\n          showEdit = true;\\n          util.focusSelector('.edit-comment input', $element.parentNode)\\n        \\\" aria-label=\\\"{{ item.comment ? lang.aria.editItemNote : lang.aria.addItemNote }}\\\" data-test=\\\"item-{{ item.comment ? 'edit' : 'add' }}-comment-button\\\"> <i class=icon-note aria-hidden=true></i> {{ item.comment ? lang.values.edit : lang.values.addANote }} </button> </div> <div class=edit-comment ng-show=showEdit> <label for=item-comment-input>{{::lang.values.addANote}}</label> <input type=text update-on-enter class=\\\"input small\\\" name=item-note-input ng-model=item.comment ng-disabled=disableProductComments() maxlength={{::config.productNoteMaxLength}} aria-describedby=remaining-character-count-{{item.store_product.id}} aria-label={{::lang.aria.itemNotes}} ng-blur=\\\"showEdit = false; productCommentCallback(item); analytics.logEvent('product save comment update', 'blur')\\\" data-test=item-comment-input id=\\\"item-comment-input={{item.store_product.id}}\\\"> <span aria-live=polite aria-atomic=true class=character-count id=remaining-character-count-{{item.store_product.id}} ng-class=\\\"{ alert: (config.productNoteMaxLength - item.comment.length <= 10) }\\\" ng-if=\\\"config.showNoteCharLimit && item.comment.length && config.productNoteMaxLength - item.comment.length <= 10\\\"> {{config.productNoteMaxLength - item.comment.length}} </span> </div> </div> <div ng-if=mobile.isMobile class=\\\"comment form\\\" ng-init=\\\"showSave = false\\\"> <label for=mobile-product-comment-{{item.store_product.id}} class=\\\"bold product-comments\\\"> <span>{{::lang.aria.addANote}}</span> <span class=\\\"icon-note icon-left small align-left\\\" aria-hidden=true></span> <input type=text class=\\\"input small\\\" ng-model=item.comment placeholder={{::lang.values.addANote}}... run-on-enter=finishEditing() ng-disabled=disableProductComments() maxlength={{::config.productNoteMaxLength}} ng-blur=\\\"showSave = false; productCommentCallback(item); analytics.logEvent('product save comment update', 'update')\\\" aria-label=\\\"{{::lang.template(lang.aria.addNoteTo, {item: item.store_product.name})}}\\\" aria-describedby=remaining-character-count-{{item.store_product.id}} id=mobile-product-comment-{{item.store_product.id}}> </label> <span aria-live=polite aria-atomic=true class=character-count id=remaining-character-count-{{item.store_product.id}} ng-class=\\\"{alert: (config.productNoteMaxLength - item.comment.length <= 10)}\\\" ng-if=\\\"config.showNoteCharLimit && item.comment.length\\\"> {{config.productNoteMaxLength - item.comment.length}} <span class=screen-reader-text>{{::lang.values.charactersRemaining}}</span> </span> </div> </div> \";","module.exports = \"<div class=cart-list-transfer-state> <div class=client-logo> <img src=\" + require(\"assets/images/header-logo.svg\") + \" alt={{::lang.values.clientName}}> </div> <div ng-if=cartListTransferLoaded class=cart-list-transer-content> <cart-list-transfer></cart-list-transfer> </div> </div> \";","module.exports = \"<div ng-class=\\\"{'checkout-form--new-card': $ctrl.isNewCard}\\\" class=\\\"{{'checkout-form checkout-form--open gateway-style_' + $ctrl.paymentCssClassName + ' gateway-type_' + $ctrl.payment.payment_type}}\\\"> <div class=\\\"update-credit-card payment-form\\\"> <h3>{{::$ctrl.lang.values.updateCreditCard}}</h3> <p>{{::$ctrl.lang.values.updateCreditCardNotice}}</p> <div ng-if=$ctrl.selectedGateway compile=$ctrl.selectedGateway class=\\\"{{'payment-gateway ' + $ctrl.paymentCssClassName}}\\\"> </div> <billing-information-form ng-if=\\\"$ctrl.config.enableBillingInformation && !$ctrl.isNewCard\\\" billing-address=$ctrl.billingAddress condensed=$ctrl.services.mobile.isMobile fulfillment-type=$ctrl.fulfillmentType same-as-delivery-address=true title={{::$ctrl.lang.values.billingAddress}}></billing-information-form> <button ng-if=$ctrl.shouldShowSaveButton() class=\\\"button checkout-save checkout-save-provided dark\\\" ng-click=$ctrl.doSave()> {{::$ctrl.lang.values.save}} </button> </div> </div> \";","module.exports = \"<div class=ic-express-cancellation> <div class=ic-express-cancellation__content> <express-cancel-first-step ng-if=\\\"$ctrl.currentStep === $ctrl.CANCEL_STEPS.FIRST_STEP\\\" use-ic-theme=$ctrl.useIcTheme on-continue-click=$ctrl.nextStep() on-send-reminder-click=$ctrl.turnOnReminders() terms-of-service=$ctrl.termsOfService></express-cancel-first-step> <express-cancel-second-step ng-if=\\\"$ctrl.currentStep === $ctrl.CANCEL_STEPS.SECOND_STEP\\\" use-ic-theme=$ctrl.useIcTheme on-continue-click=$ctrl.nextStep() on-send-reminder-click=$ctrl.turnOnReminders() on-update-membership-click=$ctrl.updateMembership() terms-of-service=$ctrl.termsOfService></express-cancel-second-step> <express-cancel-third-step ng-if=\\\"$ctrl.currentStep === $ctrl.CANCEL_STEPS.THIRD_STEP\\\" use-ic-theme=$ctrl.useIcTheme on-exit-click=$ctrl.exit() on-send-reminder-click=$ctrl.turnOnReminders() on-membership-cancel-click=$ctrl.onMembershipCancel(data)></express-cancel-third-step> <express-cancel-forth-step ng-if=\\\"$ctrl.currentStep === $ctrl.CANCEL_STEPS.FORTH_STEP\\\"></express-cancel-forth-step> <react-express-footer ng-if=\\\"$ctrl.currentStep !== $ctrl.CANCEL_STEPS.THIRD_STEP && $ctrl.currentStep !== $ctrl.CANCEL_STEPS.FORTH_STEP\\\" show-image=true show-text=false></react-express-footer> </div> </div> \";","module.exports = \" <ol ng-if=!flexGrid class=cell-container ng-class=\\\"{'cell-container--css-grid': items.placements.length > 0}\\\" data-analytic-scope={{::analyticScope}}> <li ng-repeat=\\\"placement in items.placements | limitTo: config.productsPerPage track by $index\\\" ng-if=\\\"placement.item_type !== 'product'\\\" class=\\\"cell-wrapper mobile-span-{{($root.mobile.isMobile && placement.promoted_media.mobile.span) ? placement.promoted_media.mobile.span : 1}}\\\"> <div image-cell url=placement.target.url imageurl=\\\"\\\" ng-click=\\\"handleImagePlacementClick(placement, $index)\\\" promoted-media=placement.promoted_media class=\\\"span-{{::($root.mobile.isMobile) ? (placement.promoted_media.mobile.span || placement.promoted_media.desktop.span) : placement.promoted_media.desktop.span}}\\\" analytics-click=\\\"['catalog placement ID ' + placement.id + '', 'click']\\\" use-image-tag=true></div> </li> <li ng-repeat=\\\"placement in items.placements | limitTo: config.productsPerPage track by $index\\\" ng-if=\\\"placement.item_type === 'product'\\\" class=\\\"cell-wrapper mobile-span-{{($root.mobile.isMobile && placement.promoted_media.mobile.span) ? placement.promoted_media.mobile.span : 1}}\\\"> <div product-cell product-details-modal-link=true product=placement.product location={{::addToCartSource}} promoted-product=true promoted-media=placement.promoted_media class=\\\"span-{{::($root.mobile.isMobile) ? (placement.promoted_media.mobile.span || placement.promoted_media.desktop.span) : placement.promoted_media.desktop.span}}\\\"></div> </li> <li ng-repeat=\\\"item in items track by $index\\\" ng-switch=item.item_type class=cell-wrapper> <div ng-switch-when=product product-cell product-details-modal-link=true product=item.product promoted-media=item.promoted_media location=\\\"{{::analyticsFlyerLocation | capitalize}}\\\" index=$index class=\\\"span-{{::($root.mobile.isMobile) ? (item.promoted_media.mobile.span || item.promoted_media.desktop.span) : item.promoted_media.desktop.span}}\\\" role=group aria-label=product></div> <div ng-switch-when=store_product product-cell product-details-modal-link=true product=item.store_product promoted-media=item.promoted_media location={{::addToCartSource}} index=$index class=\\\"span-{{::($root.mobile.isMobile) ? (item.promoted_media.mobile.span || item.promoted_media.desktop.span) : item.promoted_media.desktop.span}}\\\" role=group aria-label=product></div> <div ng-switch-when=collection promo-collection-cell promo-collection=item.collection promoted-media=item.promoted_media class=\\\"span-{{::($root.mobile.isMobile) ? (item.promoted_media.mobile.span || item.promoted_media.desktop.span) : item.promoted_media.desktop.span}}\\\" use-image-tag=true role=group aria-label=collection></div> <div ng-switch-when=offer offer-cell offer=item.offer promoted-media=item.promoted_media class=\\\"span-{{::($root.mobile.isMobile) ? (item.promoted_media.mobile.span || item.promoted_media.desktop.span) : item.promoted_media.desktop.span}}\\\" location={{::location}} role=group aria-label=offer></div> <div ng-switch-when=none> <div image-cell imageurl=\\\"\\\" ng-click=handleImagePlacementClick(item) promoted-media=item.promoted_media class=\\\"span-{{::($root.mobile.isMobile) ? (item.promoted_media.mobile.span || item.promoted_media.desktop.span) : item.promoted_media.desktop.span}}\\\" use-image-tag=true role=group aria-label=image></div> </div> <div class=react-cell ng-switch-default> <div ng-if=\\\"::(!item.item_type && !item.store_product && !item.offer_type && !item.preparation_information)\\\" product-cell product=item product-details-modal-link=true promoted-product=item.placement location={{::addToCartSource}} location-value=\\\"{ 'id': department.params.category_id, 'display_name': department.label }\\\" index=$index class=react-cell role=group></div> <div ng-if=\\\"::(item.offer_type === 'coupon')\\\" offer-cell offer=item location={{::location}} role=group aria-label=coupon></div> <div ng-if=\\\"::(item.offer_type === 'offer')\\\" offer-cell offer=item location={{::location}} role=group aria-label=offer></div> <div ng-if=::item.preparation_information recipe-cell recipe=::item open-details-in-modal=\\\":: !!$root.mobile.isMobile\\\" ng-class=\\\"::{'span-2': $root.mobile.isMobile}\\\" use-image-tag=true role=group aria-label=recipe></div> </div> </li> </ol> <div ng-if=flexGrid class=flexcell-container role=grid> <div ng-repeat=\\\"item in items track by $index\\\" ng-switch=item.item_type class=\\\"flexcell flexcell--width-category\\\" role=gridcell> <div ng-switch-default> <div ng-if=::item.preparation_information recipe-cell recipe=::item breadcrumbs=::breadcrumbs open-details-in-modal=\\\":: !!$root.mobile.isMobile\\\" ng-class=\\\"::{'span-2': $root.mobile.isMobile}\\\" use-image-tag=true></div> </div> </div> </div> \";","module.exports = \"<div class=custom-upsell role=form> <simplified-header ng-if=::!mobileService.isMobile></simplified-header> <div ng-if=::mobileService.isMobile class=fixed-mobile-header> <a ng-click=\\\"$state.go('main.checkout.cart')\\\" class=fixed-mobile-header__back-link href=# aria-label={{::lang.aria.goBack}}> </a> <div class=fixed-mobile-header__title-container> <span role=heading aria-level=1>{{::lang.values.upsellTitle}}</span> </div> </div> <div ng-if=!mobileService.isMobile class=custom-upsell__header> <span role=heading aria-level=1>{{::lang.values.upsellTitle}}</span> </div> <div class=custom-upsell__content> <div class=custom-upsell__top-actions ng-if=!mobileService.isMobile> <a ng-click=\\\"$state.go('main.checkout.cart')\\\" class=button-link> {{::lang.values.backToCart}} </a> <a class=\\\"button dark\\\" ng-if=::moreThanOneRow() id=custom-upsell-continue-button ui-sref=\\\"{{nextState}}({ cart_type: $state.params.cart_type })\\\" analytics-click=\\\"['checkout upsell top continue button', 'click']\\\"> {{::lang.values.continue}} </a> </div> <ol class=\\\"cell-container centered custom-upsell__product-list\\\"> <li ng-repeat=\\\"product in upsellProducts track by $index\\\" ng-class=\\\"{ 'cell-wrapper': !mobileService.isMobile }\\\"> <div product-cell product-details-modal-link=true product=product location=\\\"Custom Upsell\\\" index=$index></div> </li> </ol> <div class=custom-upsell__bottom-actions ng-class=\\\"::{'center' : !moreThanOneRow()}\\\"> <a class=\\\"button dark\\\" id=custom-upsell-continue-button-bottom ui-sref=\\\"{{nextState}}({ cart_type: $state.params.cart_type })\\\" analytics-click=\\\"['checkout upsell bottom continue button bottom', 'click']\\\"> <b ng-if=::mobileService.isMobile> {{::lang.values.checkout}} - {{cartService.getCartTotalForCurrentType() | currency}} </b> <span ng-if=::!mobileService.isMobile> {{::lang.values.continue}} </span> </a> </div> <div ng-if=loading fixed-to-body class=view-loading-indicator></div> </div> </div> \";","module.exports = \"<div class=\\\"checkout-form cart-form\\\"> <div class=checkout-form__left> <ng-include class=icon src=\\\"::$ctrl.utilService.loadStaticImage('ic_bag.svg')\\\" aria-hidden=true /> </div> <div class=checkout-form__content> <h2 class=checkout-form__title>{{$ctrl.title}}</h2> <div class=cart-form__row> <div class=cart-form__images> <div class=cart-form__image ng-repeat=\\\"item in $ctrl.getDisplayItems() track by item.id\\\"> <img src=\\\"{{ $ctrl.imageURLService.getProductImageURL(item.store_product, 'small') }}\\\" alt=\\\"{{ item.store_product.name }}\\\"/> </div> </div> <div class=cart-form__actions> <a class=button-link id=contact-information-edit-button ui-sref=\\\"main.checkout.cart({ cart_type: $ctrl.getCartType() })\\\" ng-click=$ctrl.editItems()> {{::$ctrl.lang.values.edit}} </a> </div> </div> <div>{{$ctrl.cartService.changedSize}}</div> </div> </div> \";","module.exports = \"<div class=\\\"cancellation-step cancellation-step--no-footer\\\"> <div class=cancellation-step__title> {{::$ctrl.config.icExpress.cancellation.thirdStep.title}} </div> <div class=cancellation-step__container> <div class=\\\"cancellation-step__section-title capitalize\\\"> {{:: $ctrl.lang.templateAsString( $ctrl.config.icExpress.cancellation.thirdStep.confirmMembershipCancellation, { plan: $ctrl.plan } ) }} </div> <div> {{::$ctrl.lang.template( $ctrl.config.icExpress.cancellation.thirdStep.subTitle, { expressName: $ctrl.config.icExpress.name } )}} </div> <div class=cancellation-step__form> <div class=cancellation-step__form-group> <div>{{::$ctrl.config.icExpress.cancellation.thirdStep.selectLabel}}</div> <div class=cancellation-step__select-container> <select ng-model=$ctrl.cancelOption class=\\\"cancellation-step__select icon-after-chevron-down\\\" ng-options=\\\"option.label as option.label for option in $ctrl.options\\\" name=cancelOptions id=express-cancel-options-select aria-label={{::lang.aria.subscriptions}}> <option value=\\\"\\\" disabled=disabled selected=selected> {{::$ctrl.config.icExpress.cancellation.thirdStep.selectPlaceholder}} </option> </select> <i class=\\\"select-icon icon-chevron-down\\\"></i> </div> </div> <div class=cancellation-step__form-group> <div>{{::$ctrl.config.icExpress.cancellation.thirdStep.textboxLabel}}</div> <textarea id=express-cancel-textarea cols=30 rows=10 ng-model=$ctrl.cancelText class=\\\"input cancellation-step__textarea\\\" placeholder={{::$ctrl.config.icExpress.cancellation.thirdStep.textboxPlaceholder}}></textarea> </div> <div class=cancellation-step__form-group> <div class=cancellation-step__section-title> {{::$ctrl.getCancellationTitle()}} </div> <p>{{::$ctrl.getCancellattionText()}}</p> <button ng-click=$ctrl.cancelMembership() ng-class=\\\"{ 'ic-theme': $ctrl.useIcTheme }\\\" class=\\\"button cancellation-step__cancel-button\\\"> {{::$ctrl.getCancelButtonLabel()}} </button> </div> </div> </div> <div class=cancellation-step__container> <div class=cancellation-step__action> <div class=\\\"cancellation-step__section-title capitalize\\\"> {{::$ctrl.config.icExpress.cancellation.remindMeLater}} </div> <div>{{::$ctrl.getRenewReminderText()}}</div> <button ng-click=$ctrl.onSendReminderClick() class=\\\"button hollow button--squared capitalize\\\" ng-class=\\\"{ 'ic-theme': $ctrl.useIcTheme }\\\"> {{::$ctrl.config.icExpress.cancellation.remindMeLater}} </button> </div> <hr class=cancellation-step__horizontal-rule> <div class=cancellation-step__action> <div class=\\\"cancellation-step__section-title capitalize\\\"> {{:: $ctrl.lang.templateAsString( $ctrl.config.icExpress.cancellation.keepMembership, { plan: $ctrl._getPlanName() } ) }} </div> <div> {{::$ctrl.lang.templateAsString( $ctrl.config.icExpress.cancellation.keepMembershipDescription, { expressName: $ctrl.config.icExpress.name } )}} </div> <button ng-click=$ctrl.onExitClick() class=\\\"button hollow button--squared capitalize\\\" ng-class=\\\"{ 'ic-theme': $ctrl.useIcTheme }\\\"> {{:: $ctrl.lang.templateAsString( $ctrl.config.icExpress.cancellation.keepMembership, { plan: $ctrl._getPlanName() } ) }} </button> </div> </div> </div>\";","module.exports = \"<div class=fulfillment-content-fixed ng-if=\\\"mobile.isMobile && !cartService.isSubstitutionNotesOpen\\\"> <div class=fulfillment-information-wrapper ng-if=config.newCheckoutFlow.cartReviewPage.enableContextSelectionOnMobile> <div role=button tabindex=0 class=\\\"fulfillment-information fulfillment-info-left\\\" ng-click=\\\"openShoppingSummary('shoppingContext');\\\" ng-disabled=$root.modifyingInstacartOrder> {{ shoppingIntentTitle }} <div class=fulfillment-info-bold> <span class=multiple-banner__image ng-if=::config.multipleBanners.enabled> <banner-image banner-slug=userStore.store_banner.key></banner-image> </span> <span ng-if=intent.delivery() data-test=delivery-address> {{ deliveryAddress.postal_code }} </span> <span ng-if=\\\"intent.inStore() || intent.pickup()\\\" data-test=store-name> {{ userStore.name || lang.values.selectAStore }} </span> </div> </div> <div role=button tabindex=0 class=\\\"fulfillment-information fulfillment-info-right\\\" ng-click=\\\"openShoppingSummary('timeslot')\\\" ng-if=\\\"intent.pickup() || intent.delivery()\\\"> {{::lang.values.yourTimeslot}} <div class=fulfillment-info-bold> {{ reservationService.displayReservation | reservationScheduleToString }} </div> </div> </div> <div ng-if=\\\"hasCartItems() && (intent.pickup() || intent.delivery())\\\" class=text-center> <div ng-if=cartService.isCartBelowMin() class=fulfillment-disabled-alert> <alert type=warn-light disable-border=true small-text=true> <span ng-bind-html=\\\"lang.template(\\n            config.cartMinimum.alertText,\\n           { amount: currencyFilter(getMinCartSpend()) }\\n         )\\\"></span> </alert> </div> <button ng-click=\\\"checkoutCartContinue({ analyticsValue: 'cart bottom continue button' })\\\" ng-class=\\\"{\\n        'disabled': cartService.isCartBelowMin() || cartService.syncing\\n      }\\\" ng-disabled=\\\"cartService.isCartBelowMin() || cartService.syncing\\\" id=checkout-cart-bottom-continue class=\\\"button dark mobile-bottom fulfillment-list__button\\\"> <b ng-if=!cartService.syncing>{{::lang.values.goToCheckout}} - {{ cartService.getCartTotalForCurrentType() | currency }}</b> <loading-dots show=cartService.syncing /> </button> </div> <div class=fulfillment-list__totals-container ng-if=\\\"showOrderOnlineButton && intent.inStore()\\\"> <div class=fulfillment-list__totals-section> <div class=main-amount>{{::lang.values.estTotal}}: <span class=fulfillment-list__amount>{{cartService.getCartTotalForCurrentType()| currency}}</span></div> <div class=secondary-amount>{{::lang.values.savings}}: <span class=fulfillment-list__discount>{{cartService.cart.discount_total | currency}}</span></div> </div> <button ng-click=\\\"openShoppingSummary('shoppingContext')\\\" id=checkout-cart-top-order-online class=\\\"button-link dark shopping-list-button\\\" analytics-click=\\\"['list top order online button', 'click']\\\"> <span aria-hidden=true class=icon-cart></span> {{::lang.values.orderOnline}} </button> </div> </div> \";","module.exports = \"<div class=modal-container> <react-express-promo-plan-change-modal plan=$ctrl.plan() current-subscription=$ctrl.currentSubscription() on-plan-change=$ctrl.onPlanChange on-cancel=$dismiss>'' </react-express-promo-plan-change-modal></div> \";","module.exports = \"<div class=account-address-book> <address-list class=address-list-component show-save-messages=true validate-address=::enableExternalAddressValidation></address-list> </div> \";","module.exports = \"<div class=\\\"loyalty-onboarding-container stand-alone-container\\\"> <div class=loyalty-onboarding-login> <div class=login-container> <div class=login-header> <div class=header-title>{{::lang.values.logIn}}</div> <div class=question-text> {{::lang.values.dontHaveAnAccount}} <a href=\\\"{{('/register' + (redirect ? '?redirect=' + redirect: '')) | rootHref}}\\\" class=question-link>{{::lang.values.signUp}}</a> </div> </div> <shared-login password-reset-fn=forgotPasswordRedirect() lazy-loading></shared-login> </div> <div class=loyalty-footer> <a ng-if=\\\":: !config.externalForgotPasswordHref\\\" href=\\\"{{'/forgot-password' | rootHref}}\\\" id=login-forgot class=loyalty-footer-link analytics-click=\\\"['login forgot password button', 'click']\\\"> {{::lang.values.forgotYourPassword}} </a> <a ng-if=\\\":: config.externalForgotPasswordHref\\\" href={{::config.externalForgotPasswordHref}} id=login-forgot class=loyalty-footer-link analytics-click=\\\"['login forgot password button', 'click']\\\"> {{::lang.values.forgotYourPassword}} </a> </div> </div> </div> \";","module.exports = \"<div class=checkout-page> <div class=fixed-mobile-header-container> <modify-order-banner></modify-order-banner> <div class=fixed-mobile-header> <button ng-click=goBack() class=fixed-mobile-header__back-link aria-label=\\\"Go back to previous page\\\"> </button> <div class=fixed-mobile-header__title-container> <h1 class=fixed-mobile-header__title>{{::lang.values.checkout}}</h1> </div> </div> </div> <main class=checkout-page__content> <checkout-steps ng-if=cartService.cart cart=cartService.cart initial-step=$resolve.initialStep fulfillment-type=intent.toString() on-validate-change=handleValidationChange(isValid) on-step-edit-mode=handleStepEditMode(stepID) on-payment-update=handlePaymentUpdate(payment) on-contact-update=handleContactUpdate(contact) on-checkout-exit=handleCheckoutExit() cart-type=cartType></checkout-steps> <cart-summary ng-if=cartService.cart cart=cartService.cart fulfillment-type=intent.toString() total-label-text=lang.values.estTotal is-place-order-enabled=isPlaceOrderButtonEnabled current-edit-step=currentEditStep condensed=mobileService.isMobile on-place-order=placeOrder() is-placing-order=isPlacingOrder cart-type=cartType></cart-summary> <div ng-if=showTermsAndConditions() class=checkout-page__terms-of-service ng-bind-html=termsAndConditionsMessage()></div> </main> </div> \";","module.exports = \"<div class=\\\"social-sign-on-link-modal modal-container\\\" ng-class=\\\"::{ 'old-loyalty-style': !$ctrl.config.enableLoyaltyOnboarding }\\\"> <div ng-if=\\\":: $ctrl.config.enableLoyaltyOnboarding\\\" class=\\\"modal-header modal-header-collapse-desktop modal-mobile-header-brand\\\"> <img src=\" + require(\"assets/images/footer-logo.svg\") + \" alt=\\\"Brand Logo\\\" class=modal-mobile-header-brand-logo /> <button class=close ng-click=$dismiss() auto-focus=true aria-label={{::lang.aria.close}}> <span class=icon-delete aria-hidden=true></span> </button> </div> <div ng-if=\\\":: !$ctrl.config.enableLoyaltyOnboarding\\\" class=modal-header> {{:: $ctrl.config.socialSignOn.link.headerText}} <button class=close ng-click=$dismiss() auto-focus=true aria-label={{::lang.aria.close}}> <span class=icon-delete aria-hidden=true></span> </button> </div> <div class=modal-content ng-class=\\\"::{ 'loyalty-onboarding-container': $ctrl.config.enableLoyaltyOnboarding }\\\"> <div ng-class=\\\"::{ 'loyalty-onboarding-form': $ctrl.config.enableLoyaltyOnboarding }\\\"> <div ng-if=\\\":: (!$ctrl.isMobile && $ctrl.config.enableLoyaltyOnboarding)\\\" class=form-banner> <img ng-src=\\\"{{:: $ctrl.config.loyaltyOnboarding.form.bannerImageUrl}}\\\" alt={{::lang.aria.cntentImageAlt}}> </div> <div class=form-header> <h2 class=header-title ng-if=\\\":: $ctrl.config.enableLoyaltyOnboarding\\\">{{:: $ctrl.config.socialSignOn.link.headerText}}</h2> <div class=question-text>{{:: $ctrl.config.socialSignOn.link.descriptionText}}</div> </div> <div class=\\\"form-container form-container-bottom-margin\\\"> <form name=linkForm id=social-signon-link-form ng-submit=\\\"$ctrl.link(); analytics.logEvent('link social account', 'submit')\\\"> <div class=form-row> <div class=\\\"icon-email icon-left\\\"> <input type=email class=input required ng-model=$ctrl.linkFormModel.email placeholder=\\\"Email Address\\\" id=link-account-email aria-label={{::lang.aria.email}}> </div> </div> <div class=form-row> <div class=\\\"icon-key icon-left\\\"> <input ng-model=$ctrl.linkFormModel.password type=password class=input required placeholder=Password id=link-account-password aria-label={{::lang.aria.password}}> </div> </div> <div ng-if=::$ctrl.recaptcha.enabled class=\\\"form-row recaptcha-row\\\"> <recaptcha-checkbox action=$ctrl.recaptcha.action on-success=$ctrl.recaptcha.onSuccess on-expired=$ctrl.recaptcha.onExpired /> </div> <button ng-disabled=\\\"linkForm.$invalid || $ctrl.linking\\\" id=link-account-submit class=\\\"button mobile-bottom highest-index\\\" ng-class=\\\"{ loading: $ctrl.linking }\\\" form=social-signon-link-form> <div class=label>Link Account</div> </button> </form> <div ng-if=$ctrl.linkFormModel.errorMessage class=\\\"message error reveal form-row\\\"> <span class=icon-error aria-hidden=true></span> {{$ctrl.linkFormModel.errorMessage}} </div> </div> </div> <div class=\\\"loyalty-footer footer\\\"> <forgot-password-button set-view-fn=$ctrl.forgotPassword()></forgot-password-button> </div> </div> </div> \";","module.exports = \"<div class=select> <span class=chevron-down aria-hidden=true></span> <select ng-model=preferredPhoneNumber ng-attr-id=\\\"{{:: inputIdAttr}}\\\" aria-label={{::lang.preferredPhoneNumber}} name=preferredPhoneNumber ng-disabled=\\\"{{:: disabled}}\\\" ng-options=\\\"option.key as option.label for option in phoneNumberFields\\\"> </select> <div class=selected> <span class=item-selected ng-if=preferredPhoneNumber>{{labels[preferredPhoneNumber]}}</span> <span class=no-item-selected ng-if=!preferredPhoneNumber>{{::lang.values.preferredPhoneNumber}}</span> </div> </div> \";","module.exports = \"<div ng-class=\\\"{user: product.user_rating, reco: !config.disableRecoRating && product.reco_rating !== null}\\\" class=rating analytics-click=\\\"['rating', 'click']\\\"> <button type=button ng-class=\\\"{full: !config.disableRecoRating && product.reco_rating >= 0 && !product.user_rating, 'user-star': product.user_rating >= 1}\\\" aria-label=\\\"{{::lang.template(lang.aria.setRatingOutOf, {stars: 1})}}\\\" class=segment ng-click=\\\"setRating(1, product)\\\" data-test=rating-star-1 aria-current=\\\"{{product.user_rating == 1 ? true : false}}\\\"> <span class=screen-reader-text>{{::lang.template(lang.aria.setRatingOutOf, {stars: 1})}}</span> </button> <button type=button ng-class=\\\"{full: !config.disableRecoRating && product.reco_rating >= 1.5 && !product.user_rating, 'user-star': product.user_rating >= 2}\\\" aria-label=\\\"{{::lang.template(lang.aria.setRatingOutOf, {stars: 2})}}\\\" class=segment ng-click=\\\"setRating(2, product)\\\" data-test=rating-star-2 aria-current=\\\"{{product.user_rating == 2 ? true : false}}\\\"> <span class=screen-reader-text>{{::lang.template(lang.aria.setRatingOutOf, {stars: 2})}}</span> </button> <button type=button ng-class=\\\"{full: !config.disableRecoRating && product.reco_rating >= 2.5 && !product.user_rating, 'user-star': product.user_rating >= 3}\\\" aria-label=\\\"{{::lang.template(lang.aria.setRatingOutOf, {stars: 3})}}\\\" class=segment ng-click=\\\"setRating(3, product)\\\" data-test=rating-star-3 aria-current=\\\"{{product.user_rating == 3 ? true : false}}\\\"> <span class=screen-reader-text>{{::lang.template(lang.aria.setRatingOutOf, {stars: 3})}}</span> </button> <button type=button ng-class=\\\"{full: !config.disableRecoRating && product.reco_rating >= 3.5 && !product.user_rating, 'user-star': product.user_rating >= 4}\\\" aria-label=\\\"{{::lang.template(lang.aria.setRatingOutOf, {stars: 4})}}\\\" class=segment ng-click=\\\"setRating(4, product)\\\" data-test=rating-star-4 aria-current=\\\"{{product.user_rating == 4 ? true : false}}\\\"> <span class=screen-reader-text>{{::lang.template(lang.aria.setRatingOutOf, {stars: 4})}}</span> </button> <button type=button ng-class=\\\"{full: !config.disableRecoRating && product.reco_rating >= 4.5 && !product.user_rating, 'user-star': product.user_rating == 5}\\\" aria-label=\\\"{{::lang.template(lang.aria.setRatingOutOf, {stars: 5})}}\\\" class=segment ng-click=\\\"setRating(5, product)\\\" data-test=rating-star-5 aria-current=\\\"{{product.user_rating == 5 ? true : false}}\\\"> <span class=screen-reader-text>{{::lang.template(lang.aria.setRatingOutOf, {stars: 5})}}</span> </button> </div> <div class=rating-msg> <span ng-if=\\\"!config.disableRecoRating && !product.user_rating\\\"> <span class=screen-reader-text>{{reco_rating}} {{::lang.aria.recommendedRating}} </span> {{::lang.values.ourBestGuessForYou}} </span> {{::lang.values.clickToRate}} </div> \";","var map = {\n\t\"./alt-logo\": \"f462ff388093978c17da\",\n\t\"./alt-logo.svg\": \"f462ff388093978c17da\",\n\t\"./card-help\": \"14199617cc3ad209a49a\",\n\t\"./card-help.jpg\": \"14199617cc3ad209a49a\",\n\t\"./email/logo\": \"2080bc4cc034c64a5f89\",\n\t\"./email/logo.png\": \"2080bc4cc034c64a5f89\",\n\t\"./footer-logo\": \"96721b622c0fadf5b5ae\",\n\t\"./footer-logo.svg\": \"96721b622c0fadf5b5ae\",\n\t\"./header-logo\": \"94a4c9a7ab3eabc6b2de\",\n\t\"./header-logo.svg\": \"94a4c9a7ab3eabc6b2de\",\n\t\"./loyalty-onboarding/loyalty-onboarding-card\": \"4456d764a4727203b926\",\n\t\"./loyalty-onboarding/loyalty-onboarding-card-mobile\": \"1a9f8b7b5c170206c4a4\",\n\t\"./loyalty-onboarding/loyalty-onboarding-card-mobile.png\": \"1a9f8b7b5c170206c4a4\",\n\t\"./loyalty-onboarding/loyalty-onboarding-card.png\": \"4456d764a4727203b926\",\n\t\"./loyalty-onboarding/loyalty-onboarding-form-banner\": \"d6df073192cdc81edcce\",\n\t\"./loyalty-onboarding/loyalty-onboarding-form-banner.png\": \"d6df073192cdc81edcce\",\n\t\"./loyalty-onboarding/loyalty-onboarding-intro-hero\": \"7a4d2e4f5ca64fdc94ac\",\n\t\"./loyalty-onboarding/loyalty-onboarding-intro-hero-mobile\": \"5a3960898debfc06eb27\",\n\t\"./loyalty-onboarding/loyalty-onboarding-intro-hero-mobile.png\": \"5a3960898debfc06eb27\",\n\t\"./loyalty-onboarding/loyalty-onboarding-intro-hero.png\": \"7a4d2e4f5ca64fdc94ac\",\n\t\"./onboarding/deliver\": \"6e7c16403d6db05aad58\",\n\t\"./onboarding/deliver.png\": \"6e7c16403d6db05aad58\",\n\t\"./onboarding/instore\": \"c68a279354649605af98\",\n\t\"./onboarding/instore.png\": \"c68a279354649605af98\",\n\t\"./onboarding/pickup\": \"3609014743e545b3f7ab\",\n\t\"./onboarding/pickup.png\": \"3609014743e545b3f7ab\",\n\t\"./shopping-context\": \"99d4c0c21a1e0099eafa\",\n\t\"./shopping-context.png\": \"99d4c0c21a1e0099eafa\",\n\t\"./small-logo\": \"7168ee05d3e49c88f4f6\",\n\t\"./small-logo.svg\": \"7168ee05d3e49c88f4f6\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"c1d2b2ab40471dcf28b2\";","module.exports = \"<react-user-menu-links show-icons=::$ctrl.showIcons show-logout=::$ctrl.showLogout ic-express-service=::$ctrl.express> </react-user-menu-links>\";","module.exports = \"<div class=card> <div ng-if=updating> <div class=view-loading-indicator></div> </div> <div class=card-header ng-class=\\\"{'no-increment' : !config.hasLoyaltyIncrement}\\\"> <img class=card-img ng-src={{cardImgUrl}} alt=\\\"Card Image\\\"/> <div class=card-heading> <a id=unata-loyalty-print-card class=print-card ng-click=printCard() ng-if=\\\"printable && !mobile.isMobile\\\" data-test=print-card>{{::lang.values.printCard}}</a> <div ng-if=!config.loyalty.hideCardTitle class=card-title>{{::lang.values.loyaltyCard}}</div> <div class=increment-message ng-if=\\\"config.hasLoyaltyIncrement && (!config.loyaltyPreferRedeemPoints || !card.earnings) && pointsRedemptionDeficit\\\">{{::lang.template(lang.values.redeemPoints, {points: (pointsRedemptionDeficit), earnings: (card.earnings_increment | currency)})}}</div> <div class=increment-message ng-if=\\\"config.hasLoyaltyIncrement && config.loyaltyPreferRedeemPoints && card.earnings\\\">{{::lang.template(lang.values.loyaltyRedeem, {points: (card.previous_points_increment), earnings: (card.earnings | currency)})}}</div> </div> <div class=loyalty-progress id=loyalty-progress></div> <div class=points-info ng-if=config.hasLoyaltyPoints> <div ng-if=config.hasLoyaltyIncrement id=unata-loyalty-points-balance class=points-balance data-test=points-balance>{{card.points_balance | number:0}}</div> <div ng-if=config.hasLoyaltyIncrement class=my-points>{{::lang.values.myPoints.toUpperCase()}}</div> <div ng-if=!config.hasLoyaltyIncrement class=points-no-increment data-test=points-balance-no-increment>{{::lang.template(lang.values.loyaltyPointsNoIncrement, {points: card.points_balance})}}</div> <div ng-if=card.expiry_date class=points-expiry> <span>{{lang.values.loyaltyExpiryDate}}: </span> <span>{{card.expiry_date}}</span> </div> <div class=increment ng-if=\\\"config.hasLoyaltyIncrement && card.points_increment && card.earnings_increment\\\">{{card.points_increment + ' ' + lang.values.pointsAbbreviation}} = {{card.earnings_increment | currency}}</div> <div class=redeem-message ng-if=config.loyalty.showLoyaltyRedeemMessage ng-bind-html=::lang.values.loyaltyRedeemInfo></div> </div> </div> <div class=card-body> <div ng-if=\\\"mobile.isMobile && !config.disableAddToWallet\\\" class=passlot-box> <div role=button ng-if=!loyaltyPass ng-click=addToWallet() class=wallet-button data-test=add-to-wallet> {{::lang.values.addToWallet}} </div> <div role=button ng-if=loyaltyPass ng-click=openInWallet() class=wallet-button data-test=open-in-wallet> {{::lang.values.openInWallet}} </div> </div> <react-loyalty-barcode card=::card use-barcode-number-label=::useBarcodeNumberLabel> </react-loyalty-barcode> <div include-if-exists=\\\"'loyaltyCardExtended.html'\\\"></div> </div> </div> \";","module.exports = \"<div class=\\\"tip-picker-modal modal-container\\\"> <div ng-if=!$ctrl.isMobile class=modal-header> <div> {{$ctrl.title}} <button ng-click=$ctrl.dismiss() class=close aria-label={{::lang.aria.close}} auto-focus=true> <span class=icon-delete aria-hidden=true></span> </button> </div> </div> <div ng-if=$ctrl.isMobile class=\\\"modal-header modal-header__light\\\"> <button ng-click=$ctrl.dismiss() class=modal-header__back aria-label={{::lang.aria.close}} auto-focus=true></button> <h1 class=modal-header-title>{{::lang.values.tips}}</h1> </div> <div class=modal-content> <div class=tip-picker-modal__content> <div ng-bind-html=$ctrl.getTipsFormDescriptions() class=tip-picker-modal__content-description></div> <div ng-if=$ctrl.error class=\\\"message error\\\"> <span class=icon-error aria-hidden=true></span> {{$ctrl.error}} </div> <fieldset class=tip-picker-modal__content-tip-options> <legend class=screen-reader-text>{{::lang.aria.amountToTip}}</legend> <div class=tip-picker-modal__tip-percents> <div ng-repeat=\\\"configTip in $ctrl.config.tipPercents track by $index\\\" class=tip-picker-modal__section> <span ng-if=$ctrl.showTipOption(configTip)> <input type=radio value={{configTip}} id=tip-{{configTip}} name=tipPercentage ng-model=$ctrl.tip.option class=radio /> <label for=tip-{{configTip}}> <span ng-if=\\\"configTip !== 0\\\"> {{configTip}}% ({{$ctrl.getTipAmount(configTip) | currency }}) </span> <span ng-if=\\\"configTip === 0\\\">{{::lang.values.zeroTipLabel}}</span> </label> </span> </div> </div> <div class=tip-picker-modal__tip-amount> <input type=radio name=tipPercentage value=custom ng-model=$ctrl.tip.option id=custom-tip-amount class=radio /> <label for=custom-tip-amount> {{::$ctrl.lang.values.otherAmount}} </label> <input class=\\\"input small tip-picker-modal__custom-tip-input\\\" ng-if=\\\"$ctrl.tip.option === 'custom'\\\" ng-model=$ctrl.tip.customAmount type=number min=0 max={{::$ctrl.maxTipValue}} aria-label=\\\"{{::lang.aria.customTipAmount}}. {{ !$ctrl.isCustomTipValid() ? lang.values.tipErrorMsg : ''}}\\\"/> </div> </fieldset> <div class=tip-picker-modal__footer> <button ng-click=$ctrl.applyTip() class=\\\"button dark tip-picker-modal__apply-button\\\" ng-disabled=$ctrl.isLoading> <span ng-if=!$ctrl.isLoading>{{::$ctrl.lang.values.apply}}</span> <span loading-dots show=$ctrl.isLoading></span> </button> </div> </div> </div> </div> \";","module.exports = \"<div class=\\\"modal-container banner-switching-modal\\\"> <div class=\\\"modal-header modal-mobile-header-brand\\\"> <button ng-click=$close() aria-label={{::lang.aria.back}} class=go-back-link auto-focus=true> <span class=icon-chevron-left aria-hidden=true></span> </button> <img ng-if=config.useAltShoppingModalLogo ng-src=\" + require(\"assets/images/alt-logo.svg\") + \" fallback-src=\" + require(\"assets/images/footer-logo.svg\") + \" alt=\\\"Brand Logo\\\" class=modal-mobile-header-brand-logo /> <img ng-if=!config.useAltShoppingModalLogo ng-src=\" + require(\"assets/images/header-logo.svg\") + \" fallback-src=\" + require(\"assets/images/footer-logo.svg\") + \" alt=\\\"Brand Logo\\\" class=modal-mobile-header-brand-logo /> </div> <div class=modal-content role=region> <div class=banner ng-class=\\\"{'no-banner-image': !hasBannerImage}\\\"> <banner-image ng-if=hasBannerImage banner-slug=userStore.store_banner.key class=circle-banner-image></banner-image> <div class=banner-contents data-test=banner-contents> <div class=store-info> <h2 class=store-name>{{getBannerNameTitle(userStore.store_banner)}}</h2> <div class=store-address>{{userStore.address.address1}}</div> </div> <button ng-if=!selectedLoading class=\\\"button small hollow banner-button\\\" ng-click=selectAssociatedStore(userStore) ng-disabled=\\\"!storeSupportsContext(userStore, currentContext)\\\">{{::lang.values.select}}</button> <button ng-if=selectedLoading class=\\\"button small hollow banner-button\\\"> <img src=\" + require(\"static/images/loading-small.svg\") + \" alt=Loading /> </button> </div> </div> <div class=banner ng-repeat=\\\"associatedStore in userStore.associated_stores\\\" ng-class=\\\"{'no-banner-image': !hasBannerImage}\\\"> <banner-image ng-if=hasBannerImage banner-slug=associatedStore.store_banner.key class=circle-banner-image></banner-image> <div class=banner-contents data-test=banner-contents> <div class=store-info> <h2 class=store-name>{{getBannerNameTitle(associatedStore.store_banner)}}</h2> <div class=store-address>{{associatedStore.address.address1}}</div> </div> <button ng-if=!selectedLoading class=\\\"button small hollow banner-button\\\" ng-click=selectAssociatedStore(associatedStore) ng-disabled=\\\"!storeSupportsContext(associatedStore, currentContext)\\\"> {{::lang.values.select}} </button> <button ng-if=selectedLoading class=\\\"button small hollow banner-button\\\"> <img src=\" + require(\"static/images/loading-small.svg\") + \" alt=Loading /> </button> </div> </div> <button class=\\\"button link shop-another-way-button\\\" ng-if=multiShoppingContextsAvailable ng-click=$close();shoppingSelectorService.open(config.defaultSelectorService.mobileNavDelivery) data-test=select-another-mode> {{lang.values.selectModeOfShopping}} </button> </div> </div> \";","module.exports = \"<div class=orders ng-class=\\\"{'no-orders': !orders || orders.length == 0}\\\"> <div class=header> <span aria-hidden=true class=\\\"icon-order header-icon\\\"></span> <h2>{{::lang.values.homeOrdersHeader}}</h2> </div> <div class=content> <div ng-if=\\\"(!orders || orders.length == 0)\\\" class=no-orders> <div class=big>{{::lang.values.orderNone}}</div> <a ui-sref=main.shop class=shop>{{::lang.values.startShopping}}</a> </div> <div ng-if=\\\"(orders && orders.length > 0)\\\"> <ol class=list> <li ng-repeat=\\\"order in ::orders | orderBy:'fulfillment_date':true | limitTo:2\\\" class=order> <a href=\\\"\\\" ng-click=handleViewOrderClick(order) ng-attr-id=\\\"{{ 'home-order-history-order-' + order.id}}\\\" analytics-click=\\\"['homepage order button', 'click', $index]\\\" role=button> <div class=date>{{::order.fulfillment_date | date:\\\"MMMM DD, YYYY\\\":config.apiDateFormat}}</div> <div class=total>{{::lang.values.total}}: <span class=amount>{{::order.final_totals ? order.final_totals.total : order.estimated_totals.total | currency}}</span> <span aria-hidden=true class=icon-after-go></span> </div> </a> </li> </ol> <div class=links-wrapper> <div class=links> <a ng-if=!config.disableSaveForLaterLists ui-sref=lists id=home-order-history-user-lists analytics-click=\\\"['homepage lists button', 'click']\\\"> <span aria-hidden=true class=\\\"icon-list icon-sizing\\\"></span> {{::lang.values.saveForLaterLists}} <span aria-hidden=true class=icon-after-go></span> </a> <a class=my-orders ui-sref=main.account.orderHistory id=home-order-history-orders analytics-click=\\\"['homepage orders button', 'click']\\\"> <span aria-hidden=true class=\\\"icon-clock icon-sizing\\\"></span> {{::lang.values.orderHistory}} <span aria-hidden=true class=icon-after-go></span> </a> </div> </div> </div> </div> </div> \";","module.exports = \"<div ng-if=\\\"!config.disablePriceAlerts && !config.disablePriceAlertsOnProductCells && auth.user.status !== 'trial'\\\"> <button ng-if=small data-test=price-alert-button-badge data-testid={{product.id}} data-active=\\\"{{product.price_alert !== null}}\\\" class=\\\"price-alert-button link-group-small link-group\\\" ng-class=\\\"{'toggled' : product.price_alert !== null}\\\" ng-click=togglePriceAlert() uib-popover=\\\"{{product.price_alert === null ? lang.values.addPriceAlert : lang.values.removePriceAlert}}\\\" popover-trigger=\\\"mouseenter focus\\\" popover-placement=top-right popover-append-to-body=true aria-label={{::lang.aria.togglePriceAlert}} aria-pressed=\\\"{{product.price_alert === null ? false : true}}\\\"> <span class=\\\"icon-price-alert link-group link-group-small\\\" aria-hidden=true></span> <span class=badge aria-hidden=true></span> </button> <button ng-if=!small data-testid={{product.id}} data-test=price-alert-button-badge data-active=\\\"{{product.price_alert !== null}}\\\" class=\\\"price-alert-button button\\\" ng-class=\\\"{'toggled' : product.price_alert !== null}\\\" ng-click=togglePriceAlert() aria-pressed=\\\"{{product.price_alert === null ? false : true}}\\\"> <span class=icon-price-alert aria-hidden=true></span> <span class=badge aria-hidden=true></span> {{product.price_alert === null ? lang.values.addPriceAlert : lang.values.removePriceAlert}} </button> </div> \";","module.exports = \"<div class=ic-express-sidecart ng-class=\\\"$ctrl.enableRetailerTheme ? 'ic-express-sidecart-retailer' : 'ic-express-sidecart-instacart'\\\"> <img class=ic-express-sidecart_icon ng-if=$ctrl.icon ng-src=\\\"{{ $ctrl.utilService.loadAssetImage($ctrl.icon) }}\\\"/> <div ng-click=$ctrl.onClicked() role=button tabindex=0> <div class=ic-express-sidecart__title> {{$ctrl.getTitle()}} </div> <div class=ic-express-sidecart__subtitle> {{ $ctrl.lang.templateAsString( $ctrl.getSubtitle(), { express: $ctrl.config.icExpress.name } ) }} </div> </div> <div tabindex=0 role=button class=ic-express-sidecart__close ng-click=$ctrl.onClosed() aria-label=\\\"Dismiss Instacart Express banner\\\"> <span aria-hidden=true class=icon-delete></span> </div> </div>\";","module.exports = \"<div class=extras ng-if=\\\"tab && product\\\" id=product-details-extras data-test=product-details-extras> <div class=tabs role=tablist tabs-keyboard-control> <button class=tab role=tab id=tab-related aria-controls=panel-related aria-selected=\\\"{{tab === 'related'}}\\\" ng-class=\\\"{active: tab === 'related'}\\\" ng-if=\\\":: !inEComLightMode && !inOrderAddOnMode\\\" ng-click=\\\"activateTab('related')\\\" analytics-click=\\\"['product details related products tab', 'click']\\\" data-test=tab-related> {{::lang.values.relatedProducts}} </button> <button class=tab role=tab id=tab-ingredients aria-controls=panel-ingredients aria-selected=\\\"{{tab === 'ingredients'}}\\\" ng-class=\\\"{active: tab === 'ingredients'}\\\" ng-if=product.ingredients ng-click=\\\"activateTab('ingredients')\\\" analytics-click=\\\"['product details ingredients tab', 'click']\\\" data-test=tab-ingredients> {{::lang.values.ingredients}} </button> <button class=tab role=tab id=tab-instructions aria-controls=panel-instructions aria-selected=\\\"{{tab === 'instructions'}}\\\" ng-class=\\\"{active: tab === 'instructions'}\\\" ng-if=product.instructions ng-click=\\\"activateTab('instructions')\\\" analytics-click=\\\"['product details instructions tab', 'click']\\\" data-test=tab-instructions> {{::lang.values.instructions}} </button> <button class=tab role=tab id=tab-nutrition aria-controls=panel-nutrition aria-selected=\\\"{{tab === 'nutrition'}}\\\" ng-class=\\\"{active: tab === 'nutrition'}\\\" ng-if=product.nutrition ng-click=\\\"activateTab('nutrition')\\\" analytics-click=\\\"['product details nutrition tab', 'click']\\\" data-test=tab-nutrition> {{::lang.values.nutritionInformation}} </button> <button class=tab role=tab id=tab-reviews aria-controls=panel-reviews aria-selected=\\\"{{tab === 'reviews'}}\\\" ng-class=\\\"{active: tab === 'reviews'}\\\" ng-if=config.userReviews.enabled ng-click=\\\"activateTab('reviews')\\\" analytics-click=\\\"['product details reviews tab', 'click']\\\" data-test=tab-reviews> {{::lang.values.reviews}} </button> <button class=tab role=tab id=tab-warnings aria-controls=panel-warnings aria-selected=\\\"{{tab === 'warnings'}}\\\" ng-class=\\\"{active: tab === 'warnings'}\\\" ng-if=product.warnings ng-click=\\\"activateTab('warnings')\\\" analytics-click=\\\"['product details warnings tab', 'click']\\\" data-test=tab-warnings> {{::lang.values.warning}} </button> </div> <div class=extras-content> <div ng-if=\\\"tab === 'related'\\\" role=tabpanel id=panel-related aria-labelledby=tab-related> <div ng-if=\\\"(product && relatedLoading)\\\" class=view-loading-indicator></div> <div class=not-found tabindex=0 ng-if=\\\"(related.length === 0)\\\"> {{::lang.values.noRelatedProducts}} </div> <unata-carousel class=extras__related-products ng-if=related.length name=::lang.values.relatedProducts data-analytic-scope={{::analyticScope}}> <div class=cell-container> <div ng-repeat=\\\"product in ::related\\\" class=cell-wrapper role=group aria-label=\\\"{{::$ctrl.lang.template($ctrl.lang.aria.productItem, { number: $index + 1, count: $ctrl.collection.items.length })}}\\\"> <div product-cell product-details-modal-link=true product=product location=\\\"{{ config.analyticsSourceKeys.productDetailsRelated }}\\\" index=$index></div> </div> </div> </unata-carousel> </div> <div ng-if=\\\"(product.ingredients && tab === 'ingredients')\\\" role=tabpanel id=panel-ingredients aria-labelledby=tab-ingredients tabindex=0> <div ng-bind-html=product.ingredients data-test=product-ingredients></div> </div> <div ng-if=\\\"(product.instructions && tab === 'instructions')\\\" role=tabpanel id=panel-instructions aria-labelledby=tab-instructions tabindex=0> <div ng-bind-html=product.instructions data-test=product-instructions></div> </div> <div ng-if=\\\"(product.warnings && tab === 'warnings')\\\" role=tabpanel id=panel-warnings aria-labelledby=tab-warnings tabindex=0> <div ng-bind-html=product.warnings data-test=product-warnings></div> </div> <div ng-if=\\\"(product.nutrition && tab === 'nutrition')\\\" role=tabpanel id=panel-nutrition aria-labelledby=tab-nutrition> <react-nutrition amount=\\\"::lang.templateAsString(lang.values.servingSize, {amount: product.nutrition.data.amount})\\\" per-container=\\\"::lang.templateAsString(lang.values.servingPerContainer, {amount: product.nutrition.data.per_container})\\\" fields=\\\"product.nutrition.data.fields || []\\\" secondary-fields=product.nutrition.data.secondary_fields nutrition-disclaimer=::lang.values.nutritionDisclaimer> </react-nutrition> </div> <div ng-if=\\\"config.userReviews.enabled && tab === 'reviews'\\\" role=tabpanel id=panel-reviews aria-labelledby=tab-reviews tabindex=0> <react-user-reviews entity-id=product.id entity-ext-id=product.ext_id user=reviewsUserData on-show-all-click=\\\"isModal ? openPDP : null\\\" on-terms-click=\\\"config.userReviews.termsOfUseUrl ? openTermsOfUse : null\\\" show-paging=!isModal on-login-required=openLogin /> </div> </div> <div ng-if=config.enableProductDetailsDisclaimer class=disclaimer-text tabindex=0> {{::lang.values.productDetailsDisclaimerText}} </div> </div> \";","module.exports = \"<style>body.desktop [ui-view=content]{padding-top:0}</style> <div class=\\\"view-loading-indicator fill\\\" style=height:100px></div>\";","module.exports = \"<div class=substitutions> <h3>Global Substitution Preferences</h3> <div class=content-section> <p>{{::lang.values.substitutionInstructions}}</p> <div ng-if=::!mobile.isMobile class=form> <input class=checkbox type=checkbox ng-model=allow id=allowCheckbox ng-change=updateGlobalSubstitutions(allow)> <label for=allowCheckbox>{{::lang.values.allowSubstitution}}</label> </div> <div ng-if=::mobile.isMobile class=\\\"clearfix mobile-global-subs\\\"> <input class=checkbox type=checkbox ng-model=allow id=allowCheckbox aria-label={{::lang.aria.allowSubstitution}} ng-change=updateGlobalSubstitutions(allow)> <label class=\\\"checkbox-switch right\\\" for=allowCheckbox><span></span></label> <div class=left>{{::lang.values.allowSubstitution}}</div> </div> <table class=table ng-if=!_.isEmpty(categorizedItemComments)> <thead> <tr> <td colspan=3>{{::lang.values.productName}}</td> <td colspan=2 ng-if=::!mobile.isMobile>{{::lang.values.allowSubstitution}}</td> </tr> </thead> <tbody ng-repeat=\\\"(category, itemComments) in categorizedItemComments\\\" ng-init=\\\"categoryIndex = $index\\\"> <tr class=category> <td colspan=5>{{category}}</td> </tr> <tr ng-repeat-start=\\\"itemComment in itemComments track by $index\\\"> <td class=action> <button class=\\\"button smaller round darker icon-delete\\\" ng-click=deleteItemComment(itemComment.id) analytics-click=\\\"['substitution delete button', 'click']\\\" aria-label=\\\"{{lang.aria.remove + ' ' + itemComment.store_product.name}}\\\"></button> </td> <td class=action ng-disabled=!itemComment.store_product.status> <div class=item-image ng-attr-style=\\\"background-image: url('{{imageURLService.getProductImageURL(itemComment.store_product, 'small')}}')\\\" analytics-click=\\\"['cart product link', 'click']\\\"></div> </td> <td ng-disabled=!itemComment.store_product.status> <a ng-click=\\\"productDetailsModal.open(itemComment.store_product.id, { location: config.analyticsSourceKeys.substitutions })\\\" class=name analytics-click=\\\"['cart product link', 'click']\\\">{{itemComment.store_product.name}}</a> <div class=right ng-if=::mobile.isMobile> <input class=checkbox ng-model=itemComment.allow_sub ng-change=updateItemComment(itemComment) id=allow-sub-{{categoryIndex}}-{{$index}} aria-label={{::lang.aria.allowQuestion}}? type=checkbox analytics-click=\\\"['cart product substitution checkbox', 'click']\\\"> <label class=checkbox-switch for=allow-sub-{{categoryIndex}}-{{$index}} analytics-click=\\\"['cart product substitution checkbox', 'click']\\\"><span></span></label> </div> <div ng-if=\\\"mobile.isMobile && !itemComment.store_product.status\\\" class=stock>{{::lang.values.outOfStock}}</div> <div ng-if=::!mobile.isMobile product-comments item=itemComment product-comment-callback=updateItemComment(itemComment)></div> </td> <td ng-if=::!mobile.isMobile ng-disabled=!itemComment.store_product.status> <input class=checkbox ng-model=itemComment.allow_sub ng-change=updateItemComment(itemComment) id=allow-sub-{{categoryIndex}}-{{$index}} type=checkbox analytics-click=\\\"['cart product substitution checkbox', 'click']\\\" aria-label=\\\"{{lang.aria.allow + ' ' + itemComment.store_product.name}}\\\"> <label for=allow-sub-{{categoryIndex}}-{{$index}} analytics-click=\\\"['cart product substitution checkbox', 'click']\\\">{{::lang.values.allowQuestion}}?</label> </td> <td ng-if=::!mobile.isMobile> <div ng-if=!itemComment.store_product.status class=stock>{{::lang.values.outOfStock}}</div> </td> </tr> <tr ng-repeat-end ng-if=::mobile.isMobile> <td colspan=3> <div product-comments item=itemComment product-comment-callback=updateItemComment(itemComment)></div> </td> </tr> </tbody> </table> </div> <div class=content-footer> </div> </div> \";","module.exports = \"<div class=payment> <progress-indicator segments=progressSegments current-segment=checkout-payment></progress-indicator> <h1 class=title> {{::lang.values.pay}} <button ng-disabled=\\\"\\n        !paymentTypeValid.ready ||\\n        waitingForCheckout ||\\n        (config.enableBillingInformation && form.paymentForm.$invalid) ||\\n        cartService.syncing ||\\n        !tipIsValid ||\\n        !hasICAccountLinked() ||\\n        hasFailedLoadingMultipleDeliveryAddresses()\\n      \\\" ng-click=paymentPageCompletion() class=\\\"button button-checkout icon-after-go right\\\" id=payment-place-order-top analytics-click=\\\"['checkout payment top submit button', 'click']\\\" ng-class=\\\"{waiting: waitingForCheckout}\\\"> {{::lang.values.checkoutSubmit}} </button> </h1> <div class=content-wrapper> <div class=content> <div class=inner-wrapper> <div class=checkout-tips ng-if=::cartService.isTippingEnabled()> <h2 class=\\\"section-divider-small section-divider-small--align-left\\\"> <span class=title>{{::lang.values.tip}}</span> </h2> <div class=\\\"form-row add\\\"> <tip-picker tip-is-valid-callback=updateTipIsValid(isValid)></tip-picker> </div> </div> <div class=pick-fee ng-if=::!config.disablePickFees> <h2 class=\\\"section-divider-small section-divider-small--align-left\\\"> <span class=title>{{::lang.values.pickFees}}</span> </h2> <div class=fee>{{cartService.cart.pickup_fee | currency}}</div> <div ng-if=\\\"auth.user.subscription && config.hasSubscriptions\\\" class=has-subscription> <div class=label>{{::lang.values.subscribedTo}} {{auth.user.subscription.name}}<br/> {{::lang.template(lang.values.subscriptionExpiry, {endDate: (auth.user.subscription.end_date | daysFromNow) })}}</div> </div> <div ng-if=\\\"!auth.user.subscription && getSubscription() && config.hasSubscriptions\\\" class=bought-subscription> <div class=wrapper> <div class=label> {{::lang.values.subscribedTo}}:<br/> {{subscriptionLabel()}} </div> <button class=\\\"button small\\\" ng-disabled=cartService.syncing ng-click=cartService.removeItem(getSubscription()) analytics-click=\\\"['checkout payment remove subscription button', 'click']\\\">{{::lang.values.remove}}</button> </div> </div> <div ng-if=\\\"!auth.user.subscription && !getSubscription() && config.hasSubscriptions && subscriptions.length > 0\\\" class=buy-subscription> <div class=or>{{::lang.values.or}}</div> <div class=\\\"wrapper button-inline\\\"> <div class=label ng-bind-html=lang.safe(lang.values.subscriptionPrompt)></div> <div class=sub> <div class=\\\"select small\\\"> <div class=selected>{{subscriptionLabel(subscription)}}</div> <span class=chevron-down aria-hidden=true></span> <select required ng-model=subscription ng-options=\\\"product as subscriptionLabel(product) for product in subscriptions\\\" name=subscriptions id=payment-subscription-dropdown aria-label={{::lang.aria.subscriptions}}></select> </div> <button ng-disabled=cartService.syncing ng-click=addSubscription(subscription) class=\\\"button small right\\\" id=payment-subscription-add analytics-click=\\\"['checkout payment subscribe button', 'click']\\\">{{::lang.values.subscribe}}</button> <div class=explain>{{::lang.values.subscriptionFeesAdded}}</div> </div> </div> </div> </div> <div data-test=gift-cards-container class=gift-cards ng-if=::config.showGiftCards> <h2 class=\\\"section-divider-small section-divider-small--align-left\\\"> <span class=title>{{::lang.values.giftCardHeader}}</span> </h2> <div class=\\\"form-row add\\\"> <input type=text placeholder=\\\"Gift Card Number\\\" class=\\\"input number small\\\" ng-model=giftCard.giftCardNumber ng-attr-maxlength=\\\"{{::config.giftCardLength || 9999}}\\\" id=payment-gift-card-number aria-label={{::lang.aria.giftCardNumber}}> <input type=text placeholder=Amount class=\\\"input amount small\\\" ng-model=giftCard.giftCardAmount id=payment-gift-card-amount aria-label={{::lang.aria.amount}}> <button ng-click=addGiftCard() class=\\\"button small\\\" id=payment-gift-card-add analytics-click=\\\"['checkout payment add gift card button', 'click']\\\">Add</button> </div> <span class=\\\"ul-el added\\\"> <span data-test=payment-gift-card ng-repeat=\\\"giftCard in payment.gift_cards\\\" class=\\\"li-el gift-card\\\"> <button ng-click=removeGiftCard($index) class=remove-button id=\\\"payment-gift-card-remove-{{:: giftCard.card_number}}\\\" analytics-click=\\\"['checkout payment remove gift card button', 'click']\\\" aria-label=\\\"{{::lang.aria.removeGiftCard}} {{:: giftCard.card_number}}\\\"></button> <span class=label> <span class=amount>{{giftCard.amount | currency}}</span> <span class=description>{{::lang.template(lang.values.fromGiftCard, {number: giftCard.card_number})}}</span> </span> </span> </span> </div> <div class=payment-method> <h2 class=\\\"section-divider-small section-divider-small--align-left\\\"> <span class=title>{{::lang.values.paymentMethod}}</span> </h2> <div ng-if=shouldShowPaymentWarning() id=payment-warning class=\\\"message warn\\\"> <span class=icon-warning aria-hidden=true></span> {{::lang.values.paymentWarning}} </div> <span class=\\\"ul-el methods\\\"> <span data-test=checkout-payment-option role=button class=\\\"li-el type-button\\\" ng-click=\\\"payment.payment_type = payType; updatePaymentType(true)\\\" ng-class=\\\"{selected: payment.payment_type == payType}\\\" ng-repeat=\\\"payType in getPaymentTypes()\\\" id=\\\"payment-type-{{:: payType}}\\\" analytics-click=\\\"['checkout payment {{payType}} button', 'click']\\\"> <div class=label>{{::lang.values.paymentTypes[payType][reservationService.reservation.timeslot.fulfillment_type]}}</div> <div class=icon> <img ng-src=\\\"{{ loadImage(payType) }}\\\" alt=\\\"{{payType}} payment type\\\"> </div> </span> </span> </div> <div compile=selectedGateway class=payment-gateway></div> <div class=payment-billing-address ng-if=\\\"config.enableBillingInformation && payment.payment_type === 'auth_capture'\\\"> <h2 class=\\\"section-divider-small section-divider-small--align-left\\\"> <span class=title>{{::lang.values.billingAddress}}</span> </h2> <form name=form.paymentForm id=payment-billing-address-form class=payment-billing-address-form> <div class=form-row> <label><input class=\\\"input small\\\" type=text ng-model=auth.user.billing_address.address1 placeholder={{::lang.values.streetAddress}} id=payment-billing-address-street aria-label={{::lang.aria.streetAddress}} required/></label> </div> <div class=form-row> <label><input class=\\\"input small\\\" type=text ng-model=auth.user.billing_address.city placeholder={{::lang.values.city}} id=payment-billing-address-city aria-label={{::lang.aria.city}} required/></label> </div> <div class=form-row> <div class=small province-select province=auth.user.billing_address.province input-id-attr=profileBillingAddressProvince></div> </div> <div class=form-row> <label><input class=\\\"input small\\\" type=text ng-model=auth.user.billing_address.postal_code placeholder={{::lang.values.postalCode}} id=payment-billing-address-postal aria-label={{::lang.aria.postalCode}} pattern={{::config.postalCodePattern}} required/></label> </div> </form> </div> </div> </div> <cart-totals css-class=totals cart-totals=cartService.cart show-fees=cartIsValidated></cart-totals> <div class=bottom-nav> <button ng-disabled=\\\"!paymentTypeValid.ready||\\n          waitingForCheckout ||\\n          (config.enableBillingInformation && form.paymentForm.$invalid) ||\\n          cartService.syncing ||\\n          !tipIsValid ||\\n          !hasICAccountLinked() ||\\n          hasFailedLoadingMultipleDeliveryAddresses()\\n        \\\" ng-click=paymentPageCompletion() class=\\\"button button-checkout icon-after-go right mobile-bottom mobile-fixed\\\" id=payment-place-order-below fixed-to-body analytics-click=\\\"['checkout payment bottom submit button', 'click']\\\" ng-class=\\\"{waiting: waitingForCheckout}\\\"> {{::lang.values.checkoutSubmit}} </button> </div> </div> </div> \";","module.exports = \"<header class=\\\"page-header search\\\" ng-class=\\\"{'has-background': enableBackground}\\\"> <div class=trail> <div class=\\\"label has-search-tabs\\\" ng-class=\\\"{ 'show-header-animation': !hideMobileAnimation, 'no-back-button': !shouldShowMobileBackButton() }\\\"> <div class=navigation> <button ng-if=shouldShowMobileBackButton() ng-click=mobileGoBack() class=back aria-label=\\\"{{:: lang.aria.back}}\\\"></button> <nav aria-label=\\\"search categories\\\"> <ul class=\\\"search-tabs wrapper\\\" ng-class=\\\"{ 'multi-tab': hasMultipleSearchTabs }\\\"> <li ng-repeat=\\\"tab in tabs\\\" data-test=search-tab-{{::tab.label}} class=\\\"tabs search-scroll-tab\\\" ng-class=\\\"{'active': tab.label === activeTab.label}\\\"> <a aria-current=\\\"{{tab.label === activeTab.label ? 'page' : ''}}\\\" ng-attr-href=\\\"{{state.href(tab.state, {\\n                    search_term: state.params.search_term,\\n                    category_id: tabHrefParamCategoryId,\\n                  }, {inherit: false})}}\\\"> {{::tab.label}} <span class=new-tag ng-if=::showNewTag(tab) aria-hidden=true>{{::config.searchTabTag.label}}</span> </a> </li> </ul> </nav> </div> <div class=results> <h1 class=lbl-txt data-test=search-results-text>{{label}} <span class=cat-filters>{{getFacetDisplayNames(selectedFilters)}}</span><loading-dots show=loading></loading-dots></h1> <span ng-if=!!searchReformulationText class=search-reformulation-text data-test=search-reformulation-text> {{searchReformulationText}} </span> <span ng-if=isSpellCorrected class=search-correction-disabled-text data-test=search-correction-disabled-text> {{::lang.values.searchSpellCorrectionDisabled}} <a ui-sref={{searchSpellCorrectionDisabledSref}}>\\\"{{initialSearchTerm}}\\\"</a> </span> </div> </div> </div> <div class=background ng-if=enableBackground ng-attr-style=\\\"background-image: url('{{background}}')\\\"></div> </header> \";","module.exports = \"<div class=product-comments-v2 ng-disabled=disableProductComments() ng-if=!hideProductComments()> <div class=edit-comment> <textarea type=text update-on-enter class=input name=item-note-input ng-model=tempComment ng-disabled=disableProductComments() maxlength={{::config.productNoteMaxLength}} aria-describedby=remaining-character-count-{{item.store_product.id}} aria-label={{::lang.aria.itemNotes}} data-test=item-comment-input> </textarea> <span aria-live=polite aria-atomic=true class=character-count id=remaining-character-count-{{item.store_product.id}} ng-class=\\\"{ alert: (config.productNoteMaxLength - item.comment.length <= 10) }\\\" ng-if=\\\"config.showNoteCharLimit && item.comment.length && config.productNoteMaxLength - item.comment.length <= 10\\\"> {{config.productNoteMaxLength - item.comment.length}} </span> </div> <div class=add-note-actions> <div> <button data-test=item-save-note-button type=button class=\\\"button small\\\" aria-label={{::lang.values.saveNote}} ng-click=onSaveNote(tempComment)> {{::lang.values.saveNote}} </button> <button aria-label={{::lang.values.cancel}} type=button ng-click=onCancel() class=\\\"button link small\\\"> {{::lang.values.cancel}} </button> </div> <div> <button aria-label={{::lang.values.removeNote}} type=button ng-click=removeNote() ng-if=\\\"item.comment.length || tempComment.length\\\" class=\\\"button link alert-color small\\\"> {{::lang.values.removeNote}} </button> </div> </div> </div> \";","module.exports = \"<div id=brain-tree-integration class=brain-tree-integration ng-class=\\\"{ 'brain-tree-is-ready': brainTreeIsReady, 'brain-tree-has-card': hasCard }\\\" ng-controller=BraintreeIntegrationController scroll-into-view> <form id=formBrainTree> <div id=iframeBraintree></div> <button class=\\\"button action\\\" type=submit ng-hide=hasCard id=braintree-add-card>{{::lang.values.addCard}}</button> </form> </div> \";","module.exports = \"<div class=\\\"select province\\\"> <span class=chevron-down aria-hidden=true></span> <select ng-model=province ng-options=\\\"option.value as option.name for option in provinces\\\" ng-attr-id={{::inputIdAttr}} aria-label={{::lang.aria.selectAProvince}} name=province ng-required=provinceIsRequired ng-disabled={{::disabled}} ng-attr-aria-describedby={{::errorElementId}} autocomplete=address-level1> <option disabled=disabled value=\\\"\\\">{{::lang.values.selectAProvince}}</option> </select> <div class=selected> <span class=item-selected ng-if=province>{{province | nameFromValue:provinces}}</span> <span class=validation-icon aria-hidden=true></span> <span class=no-item-selected ng-if=\\\"!province && placeholder\\\">{{::placeholder}}</span> <span class=no-item-selected ng-if=\\\"!province && !placeholder\\\">{{::lang.values.selectAProvince}}</span> </div> </div> \";","module.exports = \"<div class=parent-onboarding ng-class=\\\"{'fade-out-close': !modalOpen}\\\"> <div class=carousel-wrapper role=region aria-label={{::lang.aria.carousel}} tabindex=0> <p class=screen-reader-text>{{::lang.template(lang.aria.carouselInstructionsHeroBanner, {count: slides.length})}}</p> <ul rn-carousel rn-carousel-buffered rn-carousel-index=carouselIndex role=presentation> <li ng-repeat=\\\"slide in slides track by $index\\\" index=$index role=group aria-label=\\\"{{::lang.template(lang.aria.slideNumberOfCount, {number: $index+1, count: slides.length})}}\\\" aria-hidden=\\\"{{!($index==carouselIndex)}}\\\"> <div class=image-wrapper> <img ng-src={{::utilService.loadAssetImage(slide.photo)}} alt=\\\"\\\"> </div> <h1>{{::slide.title}}</h1> <p>{{::slide.description}}</p> </li> </ul> <div class=button-wrapper> <div rn-carousel-indicators ng-if=\\\"slides.length > 1\\\" slides=slides rn-carousel-index=carouselIndex></div> <button class=button ng-click=callToAction() analytics-click=\\\"['onboarding call to action', 'click']\\\">{{callToActionText}}</button> </div> </div> </div> \";","module.exports = \"<div class=shopping-selector-nav data-test=context-wrapper> <div ng-if=\\\":: !$ctrl.isMobile\\\" class=context-wrapper> <react-context-selector on-context-button-click=$ctrl.triageSelectorButtonClicks reservation-timeslot-button-content=$ctrl.reservationTimeslotContent is-disabled=$ctrl.disableContextSelector banner-image-url=\\\"$ctrl.config.multipleBanners.enabled && $ctrl.utilService.getLogoFromBannerSlug($ctrl.auth.user.store.store_banner.key)\\\"> </react-context-selector> </div> <div class=logo-header ng-if=\\\":: $ctrl.isMobile && (!$ctrl.config.shoppingSelector.pickup.exists && !$ctrl.config.shoppingSelector.delivery.exists)\\\"> <img alt={{::lang.aria.headerLogoAlt}} ng-src=\\\"{{ $ctrl.loadImg('header-logo-light.svg') }}\\\" fallback-src=\\\"{{ $ctrl.loadImg('footer-logo.svg') }}\\\"/> </div> <div class=\\\"mobile-nav-top-row-header container-only\\\" ng-if=\\\":: $ctrl.isMobile && ($ctrl.config.shoppingSelector.pickup.exists || $ctrl.config.shoppingSelector.delivery.exists)\\\"> <button type=button class=\\\"current-status current-status-link\\\" ng-class=\\\"{'current-status-shorter': $ctrl.searchIconVisible}\\\" ng-disabled=$ctrl.isDropdownDisabled ng-click=$ctrl.openMobileContextSelector() data-test=context-button> <span class=screen-reader-text>{{$ctrl.lang.values.hereIsHowYoureCurrentlyShopping}}</span> <div class=current-status-info> <div class=current-status-text> {{$ctrl.shoppingModeTitle}} </div> <span class=icon-after-chevron-down aria-hidden=true ng-if=!$ctrl.isDropdownDisabled></span> </div> <div class=fulfillment-information-top-nav ng-if=$ctrl.subTitle> {{$ctrl.subTitle}} </div> </button> </div> </div> \";","module.exports = \"<div ng-if=$ctrl.selectedTagCrumbs.length> <span ng-repeat=\\\"tagCrumb in $ctrl.selectedTagCrumbs\\\" class=tag-crumb> {{$ctrl.getFacetDisplayName(tagCrumb.display_name)}} <button ng-click=$ctrl.removeSelectedTagCrumb($index) class=icon-delete-styles aria-label=\\\"{{::$ctrl.lang.values.remove}} {{::$ctrl.getFacetDisplayName(tagCrumb.display_name)}} {{::$ctrl.lang.values.filter}}\\\"> <span aria-hidden=true class=icon-delete></span> </button> </span> <button ng-click=$ctrl.resetSelectedTagCrumbs() class=tag-crumb-reset>Reset</button> </div> \";","module.exports = \" <div ng-if=\\\"configType === 'custom' && product.product_config.has_pricing && !mobileService.isMobile\\\" class=config-total-price-top> <span class=config-total-text>{{::lang.values.total}}</span> <span class=price-amount> {{totalPrice | currency}}</span> </div> <div ng-if=\\\"configType === 'prep_style'\\\"> <div class=single-configuration ng-repeat=\\\"configuration in product.product_config.options[0].items track by $index\\\"> <div class=single-configuration-label>{{::configuration.name}}</div> <div add-to-cart product=product configuration=configuration location={{location}} location-value=locationValue></div> </div> </div> <div ng-if=\\\"::configType === 'custom'\\\"> <div class=configurable-products-container ng-repeat=\\\"option in ::product.product_config.options track by option.id\\\"> <div class=selection-title> {{::option.name}} <span class=selection-requirement ng-if=::!option.mandatory ng-class=\\\"{'invalid': option.invalid}\\\"> <span ng-if=!option.invalid>(Optional{{ option.maximum_selection ? ' - Maximum: ' + option.maximum_selection : '' }})</span> <span ng-if=option.invalid>({{ option.invalid.reason }})</span> </span> <span class=selection-requirement ng-if=::option.mandatory> <span ng-if=\\\"option.type === 'single_selection' && option.invalid\\\">({{option.invalid.reason}})</span> <span ng-if=\\\"::option.type === 'multiple_selection'\\\"> <span ng-if=!option.invalid>(Select {{ option.maximum_selection ? 'up to ' + option.maximum_selection : 'any' }})</span> <span ng-if=option.invalid>({{ option.invalid.reason }})</span> </span> <span ng-if=\\\"::(option.type === 'text' || option.type === 'text_field')\\\">(Text required)</span> </span> </div> <div class=base-selection-container ng-if=\\\"::option.type === 'base_selection'\\\"> <div ng-repeat=\\\"item in option.items | limitTo : limitToMoreThanOne(option.items.length, limit[$index]) track by item.id\\\" class=base-selection-button data-test=base-selection-input-{{option.id}}> <input id=option-{{option.id}}-item-{{item.id}} type=radio class=radio name={{option.id}} ng-model=option.selected ng-click=\\\"selectSingleParamItem(option, item)\\\" ng-value=item /> <label for=option-{{option.id}}-item-{{item.id}} class=\\\"button light base-selection-label\\\" ng-class=\\\"{'highlight': option.selected == item}\\\"> <span class=config-name>{{item.name}}</span> <span class=config-price>{{displayBaseSelectionTotalPrice(item.price) | currency}}</span> </label> </div> <button ng-if=\\\"option.items.length > limitToMoreThanOne(option.items.length, limit[$index])\\\" ng-click=incrementOptions($index) class=\\\"button dark darker-text hollow see-more\\\">See More</button> </div> <div class=single-selection-container ng-if=\\\"::option.type === 'single_selection'\\\"> <div ng-repeat=\\\"item in option.items | limitTo : limitToMoreThanOne(option.items.length, limit[$index]) track by item.id\\\" class=single-selection-button data-test=single-selection-input-{{option.id}}> <input id=option-{{option.id}}-item-{{item.id}} type=radio class=radio name={{option.id}} ng-model=option.selected ng-click=\\\"selectSingleParamItem(option, item)\\\" ng-value=item /> <label for=option-{{option.id}}-item-{{item.id}} class=\\\"button light single-selection-label\\\" ng-class=\\\"{'highlight': option.selected == item}\\\"> <span class=config-name>{{item.name}}</span> <span class=config-price ng-if=item.price>+{{item.price | currency}}</span> </label> </div> <button ng-if=\\\"option.items.length > limitToMoreThanOne(option.items.length, limit[$index])\\\" ng-click=incrementOptions($index) class=\\\"button dark darker-text hollow see-more\\\">See More</button> </div> <div class=multiple-selection-container ng-if=\\\"::option.type === 'multiple_selection'\\\"> <div ng-repeat=\\\"item in option.items | limitTo : limitToMoreThanOne(option.items.length, multipleLimit[$index]) track by item.id\\\" class=multiple-selection-button data-test=multiple-selection-input-{{option.id}}> <input id=option-{{option.id}}-item-{{item.id}} class=checkbox type=checkbox ng-change=\\\"selectMultiParamItem(option, item)\\\" ng-model=\\\"selectedMap[option.id + '-' + item.id]\\\" ng-disabled=\\\"selectedItems[option.id].items.length >= option.maximum_selection && !selectedMap[option.id + '-' + item.id]\\\" data-test=multi-option-input-{{option.id}} /> <label for=option-{{option.id}}-item-{{item.id}} class=\\\"button light\\\" ng-class=\\\"{'highlight': selectedMap[option.id + '-' + item.id], 'has-price': item.price }\\\"> <div class=config-name>{{item.name}}</div> <div class=config-price ng-if=item.price>+{{item.price | currency}}</div> </label> </div> <button ng-if=\\\"option.items.length > limitToMoreThanOne(option.items.length, multipleLimit[$index])\\\" ng-click=incrementOptionsMultiple($index) class=\\\"button dark darker-text hollow see-more\\\">See More</button> </div> <div ng-if=\\\"::option.type === 'text'\\\" class=text-container> <div class=text-label-container> <input type=text class=input name=text-option-{{$index}} placeholder={{::option.default}} ng-model=option.selected ng-change=consolidateSelectedOptions() maxlength={{::option.max_length}}> <label ng-if=option.price for=text-option-{{$index}}>+ {{::option.price | currency}}</label> </div> <div class=character-count-container ng-if=option.max_length> <span ng-bind=\\\"option.max_length - option.selected.length\\\" class=\\\"character-count configurable-input\\\" ng-class=\\\"{alert: (option.max_length - option.selected.length <= 10)}\\\"></span> <span class=\\\"character-count configurable-input\\\">/{{::option.max_length}}</span> </div> </div> <div ng-if=\\\"::option.type == 'text_field'\\\" data-test=text-field-option-{{option.id}}> <div class=text-label-container ng-class=\\\"{'has-price': option.price}\\\"> <textarea placeholder={{::option.default}} name=text-area-option-{{$index}} ng-model=option.selected ng-change=consolidateSelectedOptions() maxlength={{::option.max_length}} class=input data-test=custom-text-input></textarea> <label ng-if=option.price for=text-area-option-{{$index}}>+ {{::option.price | currency}}</label> </div> <div class=character-count-container ng-if=option.max_length> <span ng-bind=\\\"option.max_length - option.selected.length\\\" class=\\\"character-count configurable-input\\\" ng-class=\\\"{alert: (option.max_length - option.selected.length <= 10)}\\\"></span> <span class=\\\"character-count configurable-input\\\">/{{::option.max_length}}</span> </div> </div> <div ng-if=\\\"::option.type === 'file'\\\"> <file-uploader uploaded=uploaded.file price=option.price></file-uploader> </div> </div> <div ng-if=\\\"configType === 'custom' && product.product_config.has_pricing && mobileService.isMobile\\\" class=config-total-price-bottom> <span class=price-amount> {{totalPrice | currency}}</span> <span class=config-total-text>{{::lang.values.total}}</span> </div> <div class=config-add-to-cart-container> <div add-to-cart product=product configuration=allSelectedConfigurations product-options-validated=\\\"configurableProductService.validateAll(product.product_config.options) === true\\\" customize=false ng-disabled=\\\"configurableProductService.validateAll(product.product_config.options) !== true\\\" data-test=add-to-cart-container-configurable location={{location}} location-value=locationValue></div> <div ng-if=\\\"configType === 'custom' && product.product_config.has_pricing && !mobileService.isMobile\\\" class=config-total-price-bottom> <span class=config-total-text>{{::lang.values.total}}</span> <span class=price-amount> {{totalPrice | currency}}</span> </div> </div> <div class=secondary-actions ng-if=\\\"auth.user.status !== 'trial'\\\"> <div ng-if=\\\"product.price_alert && product.price_alert.id\\\" price-alert product=product source=pdp></div> <add-to-list ng-if=\\\":: !config.disableSaveForLaterLists\\\" products=[product] configuration=allSelectedConfigurations isconfigurationinvalid=\\\"configurableProductService.validateAll(product.product_config.options) !== true\\\"></add-to-list> </div> </div> \";","module.exports = \"<ul> <li ng-repeat=\\\"store in stores\\\" class=\\\"open store\\\" data-test=store-selector-store> <div class=store-info> <div class=marker>{{$index + 1}}</div> <div class=name data-test=store-name>{{store.name}}</div> <div class=address> <div>{{store.address.address1}}</div> <div>{{store.address.address2}}</div> <div>{{store.address.address3}}</div> <div>{{store.address.city}}, {{store.address.province}}</div> <div>{{store.address.postal_code}}</div> <div>{{::lang.template(lang.values.storePhoneNumber, {number: store.phone_number})}}</div> </div> </div> <div class=store-selector-button> <button ng-if=\\\"store.id != auth.user.store.id\\\" ng-click=$parent.updateHomeStore(store) id=shopping-selector-update-home-store-{{store.id}}-not-chosen class=\\\"button small hollow right\\\" analytics-click=\\\"['store selector set home store button', 'click']\\\" data-test=select-store-button>{{::lang.values.setAsHomeStore}}</button> <button ng-if=\\\"store.id == auth.user.store.id\\\" ng-click=$parent.updateHomeStore(store) id=shopping-selector-update-home-store-{{store.id}}-chosen class=\\\"button highlight small right\\\" analytics-click=\\\"['store selector set home store button', 'click']\\\" data-test=select-store-button>{{::lang.values.myHomeStore}}</button> </div> </li> </ul> \";","module.exports = \"<div class=modal-container> <div class=\\\"unsupported-postal-code-modal error-modal\\\"> <h1 class=unsupported-postal-code-modal-header> {{ ::title }} </h1> <div class=error-modal-content> <p class=rx-confirmation-modal-text> {{ ::message }} </p> <a class=\\\"button button--full-width rx-confirmation-modal-button\\\" ng-click=resolve(true);$close() analytics-click=\\\"['mcoxContextChangeSidecart modal continue', 'click']\\\"> {{ ::confirm }} </a> <a class=\\\"button hollow button--full-width\\\" ng-click=resolve(false);$close() analytics-click=\\\"['mcoxContextChangeSidecart modal cancel', 'click']\\\"> {{ ::cancel }} </a> </div> </div> </div>\";","module.exports = \"<div class=related-product ng-class=\\\"{'condensed-layout': condensedLayout, 'horizontal-layout': horizontalLayout, 'is-ic-variant': config.enableInstacartProductCell }\\\" name=related-product-{{product.id}} analytics-product-impression=\\\"[product, location]\\\" send-analytics=!$root.modifyingOrder data-test=related-product-{{product.id}} role=group aria-label=\\\"{{::lang.aria.openModal}} {{product.name}}\\\"> <h3 ng-if=::isMobileApp class=screen-reader-text>{{::product.name}}</h3> <button class=related-product-button ng-click=productDetailsModal.open(product.id)> <div ng-class=\\\"{ 'is-out-of-stock': !isProductInStock }\\\" ng-disabled=!product.availability_status class=related-product-image name=related-product-image-link analytics-product-click=\\\"[product, location]\\\" send-analytics=!$root.modifyingOrder cell-image lazy-load-image=true default-image=\\\"::imageURLService.getProductImageURL(product, 'small')\\\"></div> <div class=info> <div class=related-product-name-price> <span ng-disabled=!product.availability_status class=title name=related-product-title-link analytics-product-click=\\\"[product, location]\\\" send-analytics=!$root.modifyingOrder ng-bind-html=product.name></span> <div ng-if=\\\"(product.sponsored && config.showSponsoredLabel)\\\" class=sponsored>{{::lang.values.sponsored}}</div> <div product-prices product=product inline=true ng-if=::product.availability_status></div> <react-fulfillment-banner store-product=product></react-fulfillment-banner> <div ng-if=\\\"!isProductInStock && horizontalOos\\\" class=related-product__warning uib-popover-html=outOfStockWarningPopover popover-placement=top-left popover-trigger=\\\"mouseenter focus\\\" popover-enable=!isMobile tabindex=\\\"{{!isMobile ? 0 : -1}}\\\"> {{::lang.values.outOfStock}} <span class=\\\"icon-after-info-i related-product__warning-icon\\\" aria-hidden=true></span> </div> <div class=unavailable uib-popover=\\\"{{:: product.availability_message }}\\\" popover-trigger=\\\"mouseenter focus\\\" ng-if=::!product.availability_status tabindex=0>{{::lang.values.unavailable}} </div> </div> <div ng-if=\\\"!isProductInStock && !horizontalOos\\\" class=related-product__warning uib-popover-html=outOfStockWarningPopover popover-trigger=\\\"mouseenter focus\\\" popover-enable=!isMobile tabindex=\\\"{{!isMobile ? '0' : '-1'}}\\\"> {{::lang.values.outOfStock}} <span class=\\\"icon-after-info-i related-product__warning-icon\\\" aria-hidden=true></span> </div> </div> </button> <div add-to-cart small=true product=product is-related-product=true location={{::location}} index=::index ng-if=\\\"inStockOrInStore && !config.enableInstacartProductCell\\\" is-modal=isModal aggregate-quantity=aggregateQuantityCount existing-config-singular=existingConfigSingular> </div> <div class=cell-trigger-container> <div add-to-cart ng-if=\\\"inStockOrInStore && config.enableInstacartProductCell\\\" product=product button-type=trigger location={{::location}} trigger-callback=onQuickAddClick()> </div> </div> <div class=cell-add-to-cart-overlay ng-show=showQuickAdd> <div class=cell-add-to-cart-overlay__background ng-click=\\\"closeQuickAdd($event, true)\\\"></div> <div class=cell-add-to-cart-container> <div add-to-cart product=product button-type=modify remove-callback=\\\"closeQuickAdd($event, true)\\\"></div> </div> </div> </div> \";","/* eslint-disable global-require */\nimport { ShoppingListItem } from '@app/types/shoppingList'\nimport { StoreProduct } from '@app/types/product'\nimport { Category } from '@app/types/category'\nimport { Recipe } from '@app/types/recipe'\nimport escapeImageUrl from '@app/utils/images/escapeImageUrl'\nimport { isRxProduct } from '@instacart/enterprise-services/product/utils'\n\nexport type ImageShape = 'square' | 'rectangle'\nexport type Size = 'small' | 'medium' | 'large'\n\nconst isShoppingListItem = (\n  product: ShoppingListItem | StoreProduct\n): product is ShoppingListItem => (product as ShoppingListItem).item_type !== undefined\n\nconst getProductImageURL = (product: ShoppingListItem | StoreProduct, size?: Size) => {\n  // due to possible incoming product as shoppingList item, need to extract storeProduct from it\n  let storeProduct: StoreProduct\n\n  // Display rx default image when product is Rx otherwise show store product image\n  if (isShoppingListItem(product)) {\n    if (isRxProduct(product)) {\n      return require('static/images/rx-default-image.png')\n    }\n    storeProduct = product.store_product\n  } else {\n    storeProduct = product\n  }\n\n  if (storeProduct && size) {\n    const imageTile = storeProduct?.images?.tile?.[size]\n    if (imageTile) {\n      return escapeImageUrl(imageTile)\n    }\n  }\n\n  return require('static/images/no-product-image.jpg')\n}\n\nconst getDefaultRecipeImageURL = (shape: ImageShape) => {\n  if (shape === 'square') {\n    return require('static/images/no-recipe-image-square.png')\n  }\n\n  if (shape === 'rectangle') {\n    return require('static/images/no-recipe-image-rectangle.png')\n  }\n  return null\n}\n\nconst getRecipeImageURL = (recipe: Recipe, shape: ImageShape) => {\n  const recipeImageURL = recipe?.media?.[0]?.image?.header\n\n  return recipeImageURL ? escapeImageUrl(recipeImageURL) : getDefaultRecipeImageURL(shape)\n}\n\nconst getRecipeCategoryImageURL = (recipeCategory: Category, size?: Size) => {\n  const defaultSize = size || 'medium'\n  const recipeCategoryImageURL = recipeCategory.images?.tile?.[defaultSize]\n\n  return recipeCategoryImageURL\n    ? escapeImageUrl(recipeCategoryImageURL)\n    : getDefaultRecipeImageURL('square')\n}\n\nexport { getProductImageURL, getRecipeImageURL, getRecipeCategoryImageURL }\n","module.exports = \"<div class=ic-express-signin ng-class=\\\"::{\\n    'ic-express-signin-retailer': $ctrl.enableRetailerTheme,\\n    'ic-express-signin-instacart': !$ctrl.enableRetailerTheme,\\n    'small': $ctrl.small,\\n  }\\\" role=region aria-label=\\\"{{\\n    $ctrl.lang.templateAsString(\\n      $ctrl.title,\\n      {\\n        express: $ctrl.config.icExpress.name,\\n        days: $ctrl.config.icExpress.trialDays\\n      }\\n    )\\n  }}\\\"> <div> <div class=ic-express-signin__title> {{ $ctrl.lang.templateAsString( $ctrl.title, { express: $ctrl.config.icExpress.name, days: $ctrl.config.icExpress.trialDays } ) }} </div> <div class=ic-express-signin__subtitle> {{::$ctrl.subtitle}} </div> </div> <div class=ic-express-signin__powered-by> <react-express-powered-by small=true></react-express-powered-by> </div> </div> \";","module.exports = \" <div class=menu ng-if=::mobile.isMobile> <ul ng-if=results.length class=wrapper> <div class=search-scroll-tab ng-class=\\\"{current: !categoryId}\\\"> <a ng-click=filterCategory() analytics-click=\\\"['search menu top link', 'click']\\\">{{::lang.values.searchResultsAll}}</a> </div> <faceted-search-categories class=mobile-faceted-search-categories search-context=\\\"'recipes'\\\" categories=rootCategoryFacets on-category-click=filterCategory(id) selected-category=categoryId> </faceted-search-categories> </ul> </div> <div ng-if=::mobile.isMobile class=\\\"page-header-buttons search\\\"> <button class=\\\"icon icon-filter\\\" ng-click=openFacetedFilterModal() aria-label=\\\"{{::lang.aria.openModal}} - filter\\\"></button> </div> <div ng-if=::!mobile.isMobile filters tags=filterTags show-sort=false subset=search></div> <div class=\\\"not-found left pad-left\\\" ng-if=\\\"results.length == 0\\\"> {{::lang.template(lang.values.nothingFound, {searchResult: term.slice(0, 50)})}} </div> <div ng-init=loadResults()> <placeholder-image type=productCell remove-on=\\\"results && !loading\\\" show-max=10> </placeholder-image> <ol class=flexcell-container> <div ng-repeat=\\\"item in results |\\n        limitTo: config.productsPerPage track by $index\\\" class=\\\"flexcell flexcell--width-category\\\"> <div> <div recipe-cell recipe=::item open-details-in-modal=::!!$root.mobile.isMobile ng-class=\\\"::{'span-2': $root.mobile.isMobile}\\\"></div> </div> </div> </ol> <div class=\\\"text-center clearfix\\\" ng-if=\\\"results && results.length > 0 && !loading\\\"> <ul ng-if=\\\"!mobile.isMobile && (results.item_count > config.productsPerPage)\\\" uib-pagination boundary-links=true previous-text=Prev first-text=First template-url=pagination-modified-uibootstrap-desktop.html next-text=Next total-items=results.item_count max-size=config.maxPaginationLinks items-per-page=config.productsPerPage ng-model=page.current class=pagination analytics-click=\\\"['search pagination', 'click']\\\"></ul> <ul ng-if=\\\"mobile.isMobile && (results.item_count > config.productsPerPage)\\\" uib-pagination boundary-links=true previous-text=Prev first-text=First template-url=pagination-modified-uibootstrap-mobile.html next-text=Next total-items=results.item_count max-size=config.maxPaginationLinks items-per-page=config.productsPerPage ng-model=page.current class=pagination analytics-click=\\\"['search pagination', 'click']\\\"></ul> </div> </div> \";","module.exports = \"<div class=cart-summary> <div ng-if=::!$ctrl.condensed class=cart-summary__place-order> <div ng-if=$ctrl.cartService.isCartBelowMin() class=cart-summary__fulfillment-disabled-alert> <alert type=warn-light disable-border=true small-text=true> <span ng-bind-html=\\\"$ctrl.lang.template(\\n            $ctrl.config.cartMinimum.alertText,\\n            { amount: $ctrl.currencyFilter($ctrl.getMinCartSpend()) }\\n          )\\\"></span> </alert> </div> <button ng-disabled=\\\"!$ctrl.isPlaceOrderEnabled || $ctrl.isPlacingOrder || $ctrl.cartService.isCartBelowMin()\\\" class=\\\"button dark cart-summary__place-order-button\\\" ng-class=\\\"{ disabled: !$ctrl.isPlaceOrderEnabled }\\\" ng-click=$ctrl.onPlaceOrder() id=checkout-place-order-button> <span ng-if=\\\"!($ctrl.cartService.isValidatingCart || $ctrl.cartService.syncing || $ctrl.isPlacingOrder)\\\"> {{$ctrl.cartService.getPlaceOrderButtonText()}} </span> <loading-dots show=\\\"$ctrl.cartService.isValidatingCart || $ctrl.cartService.syncing || $ctrl.isPlacingOrder\\\"></loading-dots> </button> <div class=cart-summary__place-order-notification> <span ng-if=\\\"!$ctrl.isPlaceOrderEnabled && $ctrl.currentEditStep\\\"> {{$ctrl.placeOrderValidationLabel}} </span> </div> </div> <div ng-if=!$ctrl.cartService.isCartBelowMin()> <div ng-if=\\\"::$ctrl.condensed && $ctrl.cartService.isTippingEnabled()\\\" class=cart-summary__section ng-class=\\\"{ 'tip-box-highlighted': $ctrl.config.highlightTipBox }\\\"> <div> <h2 class=cart-summary__label data-test=checkout-tip-label>{{::$ctrl.lang.values.tip}}</h2> <tip-picker-modal label=\\\"{{ $ctrl.lang.values.change }}\\\" fulfillment-type=$ctrl.fulfillmentType on-tip-applied=$ctrl.onTipApplied()> </tip-picker-modal> </div> <span class=cart-summary__amount data-test=checkout-tip-amount> {{$ctrl.cart.tip_total || 0 | currency}} </span> <div class=\\\"cart-summary__dark-text cart-summary__tip-copy\\\"> {{$ctrl.getTipCopy()}} </div> </div> </div> <h2 class=cart-summary__title> {{$ctrl.cartService.getCartSummaryTitleText()}} </h2> <div class=cart-summary__totals-line-items> <react-order-totals line-items=$ctrl.getOrderTotalsLines()></react-order-totals> </div> <div ng-if=!$ctrl.cartService.isCartBelowMin()> <div ng-if=$ctrl.checkoutService.isCartValidated> <ic-express-checkout ng-if=$ctrl.checkoutPlacementEnabled opted-in=$ctrl.express.isIcExpressOptedIn user-subscription=$ctrl.express.userCurrentSubscription cart-total=$ctrl.cartTotals[$ctrl.config.cartTotalKey]></ic-express-checkout> <subscription-select ng-if=::$ctrl.showSubscriptionSelection()></subscription-select> <div ng-if=\\\"::!$ctrl.condensed && $ctrl.cartService.isTippingEnabled()\\\" class=\\\"cart-summary__section cart-summary__section--divider\\\" ng-class=\\\"{ 'tip-box-highlighted': $ctrl.config.highlightTipBox }\\\"> <span class=cart-summary__label data-test=checkout-tip-label> {{::$ctrl.lang.values.tip}} <tip-picker-modal label=\\\"{{ $ctrl.lang.values.change }}\\\" fulfillment-type=$ctrl.fulfillmentType on-tip-applied=$ctrl.onTipApplied()> </tip-picker-modal> </span> <span class=cart-summary__amount data-test=checkout-tip-amount> {{$ctrl.cart.tip_total || 0 | currency}} </span> <div class=\\\"cart-summary__dark-text cart-summary__tip-copy\\\"> {{$ctrl.getTipCopy()}} </div> </div> </div> <div ng-if=$ctrl.checkoutService.isCartValidated class=\\\"cart-summary__footer cart-summary__section--bottom-divider\\\"> <span class=cart-summary__footer__label> {{::$ctrl.lang.values.total}} </span> <span class=cart-summary__footer__amount> {{$ctrl.cartService.getCartFinalTotal() | currency}} </span> </div> </div> <div ng-if=!$ctrl.checkoutService.isCartValidated> <div class=\\\"cart-summary__footer cart-summary__section--bottom-divider\\\"> <span class=cart-summary__footer__label> {{::$ctrl.lang.values.estTotal}} </span> <span class=cart-summary__footer__amount> {{$ctrl.cartTotals.product_total | currency}} </span> </div> <div class=cart-summary__footer__excludedTaxesAndFees> {{::$ctrl.lang.values.excludesTaxesAndFees}} </div> </div> <div class=\\\"cart-summary__section cart-summary__add-promo\\\" ng-if=::$ctrl.config.enablePromoCodes.checkout> <div class=cart-summary__add-promo-content> <div class=cart-summary__add-promo-list> <span class=ul-el ng-if=\\\"$ctrl.cart.offer_progress && $ctrl.cart.offer_progress.length > 0\\\"> <span class=\\\"fulfillment-title li-el\\\" ng-repeat=\\\"promoCode in $ctrl.cart.promo_codes track by $index\\\"> {{promoCode}} </span> </span> </div> <div class=cart-summary__add-promo-link> <button type=button ng-click=$ctrl.openPromoCodeModal()>{{$ctrl.lang.values.addPromoCode}}</button> </div> </div> </div> <div ng-if=$ctrl.showLoyaltyCardBalance() class=\\\"cart-summary__section cart-summary__loyalty-balance\\\"> <react-cart-loyalty-balance title-text=$ctrl.loyaltyReactProps.title value=$ctrl.loyaltyReactProps.getValue() content=$ctrl.loyaltyReactProps.content></react-cart-loyalty-balance> </div> </div> <div ng-if=::$ctrl.condensed class=\\\"cart-summary__section cart-summary__section--top-divider--mobile\\\"> <div ng-if=$ctrl.cartService.isCartBelowMin() class=cart-summary__fulfillment-disabled-alert> <alert type=warn-light disable-border=true small-text=true> <span ng-bind-html=\\\"$ctrl.lang.template(\\n            $ctrl.config.cartMinimum.alertText,\\n            { amount: $ctrl.currencyFilter($ctrl.getMinCartSpend()) }\\n          )\\\"></span> </alert> </div> <button ng-disabled=\\\"!$ctrl.isPlaceOrderEnabled || $ctrl.isPlacingOrder || $ctrl.cartService.isCartBelowMin()\\\" class=\\\"button dark cart-summary__place-order-button\\\" ng-class=\\\"{ disabled: !$ctrl.isPlaceOrderEnabled }\\\" ng-click=$ctrl.onPlaceOrder() id=checkout-place-order-button> <span ng-if=\\\"!($ctrl.cartService.isValidatingCart || $ctrl.cartService.syncing || $ctrl.isPlacingOrder)\\\"> {{$ctrl.cartService.getPlaceOrderButtonText()}} </span> <loading-dots show=\\\"$ctrl.cartService.isValidatingCart || $ctrl.cartService.syncing || $ctrl.isPlacingOrder\\\"></loading-dots> </button> </div> \";","module.exports = \"<h1 class=screen-reader-text>{{lang.values.clientName}}</h1> <div ng-include=\\\"'home.desktop.html'\\\" ng-if=\\\":: !mobile.isMobile\\\"></div> <div ng-include=\\\"'home.mobile.html'\\\" ng-if=::mobile.isMobile></div> \";","module.exports = \"<div class=\\\"reservation checkout-reservation\\\"> <progress-indicator segments=progressSegments current-segment=checkout-reservation></progress-indicator> <div class=content-wrapper> <div class=content> <div ng-include=\\\"'reservation.html'\\\"></div> </div> <cart-totals css-class=totals cart-totals=cartService.cart show-fees=false></cart-totals> </div> <div class=bottom-nav> </div> </div> \";","module.exports = \"<div id=\\\"g-recaptcha-{{:: $ctrl.action}}\\\"/> \";","module.exports = \"<div id=unata-gigya-profile-edit></div> \";","module.exports = \"<div class=\\\"offline-content-view text-center\\\"> <div ng-if=\\\"config.hasLoyalty && card\\\"> <div class=offline-loyalty-container> <div> <h2 class=offline-loyalty-title>{{::lang.values.loyaltyCard}}</h2> <react-loyalty-barcode card=::card> </react-loyalty-barcode> <div ng-if=config.hasLoyaltyPoints class=offline-loyalty-points>{{card.points_balance | number:0}} {{lang.values.points |lowercase}}</div> </div> </div> </div> </div>\";","module.exports = \"<react-user-menu ic-express-service=express ic-express-icon-src=\\\"customIcon && loadImage(customIcon)\\\" menu-align=\\\"'right'\\\" load-image=loadImage on-login-click=showLogin> </react-user-menu> \";","module.exports = \"<div ng-if=$ctrl.hasErrors id=contact-form-error class=\\\"message error checkout-form__error-message\\\"> <span class=icon-error aria-hidden=true></span> {{::$ctrl.lang.values.fillRequiredFieldsErrorMessage}} </div> <div class=\\\"checkout-form contact-form\\\" ng-class=\\\"{'checkout-form--open': $ctrl.editMode}\\\"> <div ng-if=!$ctrl.editMode class=checkout-form__left> <ng-include class=icon src=\\\"::$ctrl.utilService.loadStaticImage('ic_phone.svg')\\\" aria-hidden=true /> </div> <div ng-show=\\\"!$ctrl.editMode && !$ctrl.hideChevron\\\" class=checkout-form__right> <button class=checkout-form__edit-button id=contact-form-edit-button ng-click=$ctrl.enterEditMode() aria-label=\\\"{{ ::$ctrl.lang.values.expandSection }}: {{ ::$ctrl.title }}\\\" data-test=contact-form-save-button> </button> </div> <div class=checkout-form__content> <div class=checkout-form__content-header> <div ng-if=$ctrl.editMode> <ng-include class=icon src=\\\"::$ctrl.utilService.loadStaticImage('ic_phone.svg')\\\"/> </div> <h2 class=checkout-form__title>{{$ctrl.title}}</h2> </div> <div ng-if=!$ctrl.editMode class=checkout-form__readonly> <div ng-if=!$ctrl.hasRequiredInformation() class=checkout-form__confirm> {{$ctrl.lang.values.confirmContactInformation}} </div> <div ng-if=$ctrl.hasRequiredInformation() class=checkout-form__name> {{$ctrl.fullName}} </div> <div ng-if=$ctrl.hasRequiredInformation() class=checkout-form__phone> {{$ctrl.contact.phone_number | telephone}} </div> </div> <form novalidate name=$ctrl.form ng-submit=$ctrl.handleSubmit() ng-if=$ctrl.editMode class=checkout-form__form> <div ng-if=::!$ctrl.condensed class=checkout-form__form-row> <div> <label for=contact-info-first-name class=contact-form__label> {{::$ctrl.lang.aria.firstName}} </label> <input required id=contact-info-first-name name=firstName ng-model=$ctrl.localContact.first_name class=\\\"input small contact-form__input\\\" placeholder={{::$ctrl.lang.aria.firstName}} type=text maxlength={{::$ctrl.config.maxNameLength}} size={{::$ctrl.config.maxNameLength}} data-test=contact-form-first-name-input auto-focus=true aria-describedby=contact-form-error autocomplete=given-name ng-blur=$ctrl.handleBlur() /> </div> <div> <label for=contact-info-last-name class=contact-form__label> {{::$ctrl.lang.aria.lastName}} </label> <input required id=contact-info-last-name name=lastName ng-model=$ctrl.localContact.last_name class=\\\"input small contact-form__input\\\" placeholder={{::$ctrl.lang.aria.lastName}} type=text maxlength={{::$ctrl.config.maxNameLength}} size={{::$ctrl.config.maxNameLength}} data-test=contact-form-last-name-input aria-describedby=contact-form-error autocomplete=family-name ng-blur=$ctrl.handleBlur() /> </div> </div> <div ng-if=::$ctrl.condensed> <div class=checkout-form__form-row> <div> <label for=contact-info-first-name class=contact-form__label> {{::$ctrl.lang.aria.firstName}} </label> <input required id=contact-info-first-name name=firstName ng-model=$ctrl.localContact.first_name class=\\\"input small contact-form__input contact-form__input--expanded\\\" placeholder={{::$ctrl.lang.aria.firstName}} type=text maxlength={{::$ctrl.config.maxNameLength}} size={{::$ctrl.config.maxNameLength}} data-test=contact-form-first-name-input auto-focus=true aria-describedby=contact-form-error autocomplete=given-name ng-blur=$ctrl.handleBlur() /> </div> </div> <div class=checkout-form__form-row> <div> <label for=contact-info-last-name class=contact-form__label> {{::$ctrl.lang.aria.lastName}} </label> <input required id=contact-info-last-name name=lastName ng-model=$ctrl.localContact.last_name class=\\\"input small contact-form__input contact-form__input--expanded\\\" placeholder={{::$ctrl.lang.aria.lastName}} type=text maxlength={{::$ctrl.config.maxNameLength}} size={{::$ctrl.config.maxNameLength}} data-test=contact-form-last-name-input aria-describedby=contact-form-error autocomplete=family-name ng-blur=$ctrl.handleBlur() /> </div> </div> </div> <div class=checkout-form__form-row> <div> <label for=contact-info-phone-number class=contact-form__label> {{::$ctrl.lang.values.phone}} </label> <input required id=contact-info-phone-number name=phoneNumber ng-model=$ctrl.localContact.phone_number class=\\\"input small contact-form__input contact-form__input--expanded\\\" placeholder={{::$ctrl.lang.values.phone}} type=tel data-test=contact-form-phone-number-input pattern={{::$ctrl.config.phoneNumberPattern}} maxlength={{::$ctrl.config.phoneNumberMaxLength}} aria-describedby=contact-form-error autocomplete=tel ng-blur=$ctrl.handleBlur() /> </div> </div> <div class=sub-title ng-if=$ctrl.config.newCheckoutFlow.checkoutPage.contactInformationDisclaimer> <i class=\\\"icon icon-info-i\\\" aria-hidden=true></i> <span>{{::$ctrl.config.newCheckoutFlow.checkoutPage.contactInformationDisclaimer}}</span> </div> <div class=checkout-form__form-row> <div class=contact-form__actions> <button type=submit class=\\\"button dark contact-form__button\\\" id=contact-form-save-button ng-class=\\\"{ 'contact-form__button--expanded': $ctrl.condensed }\\\"> <span ng-if=!$ctrl.isLoading>{{::$ctrl.lang.values.save}}</span> <loading-dots show=$ctrl.isLoading></loading-dots> </button> <span ng-if=!$ctrl.config.profile.disabledNameFields class=contact-form__update-profile> <input data-test=contact-info-save-in-profile-checkbox ng-model=$ctrl.shouldUpdateProfile id=contact-info-update-profile-checkbox class=checkbox type=checkbox /> <label for=contact-info-update-profile-checkbox>{{::$ctrl.lang.values.saveToProfile}}</label> </span> </div> </div> </form> </div> </div> \";","module.exports = \"<button class=\\\"button small hollow tip-picker-modal__link\\\" ng-click=$ctrl.open()> {{::$ctrl.label}} </button> \";","module.exports = \"<div ng-if=$ctrl.mobile.isMobile class=order-add-on-nav-mobile> <span>Request Add On</span> <a ui-sref=\\\"main.account.orderHistory.order({id: $ctrl.orderId})\\\" analytics-click=\\\"['modify order add-on nav back button', 'click']\\\">Back to Order</a> </div> \";","module.exports = \"<div class=cell-slider> <div class=\\\"cell-slider-button less\\\"><div role=button class=\\\"button round\\\" ng-click=prev() aria-label={{::lang.aria.previous}} ng-if=hasLess></div></div> <div class=cell-slider-content ng-include=\\\"'cellContainer.html'\\\"></div> <div class=\\\"cell-slider-button more\\\"><div role=button class=\\\"button round\\\" ng-click=next() aria-label={{::lang.aria.next}} ng-if=hasMore></div></div> </div> \";","module.exports = \"<div class=list-details> <div class=\\\"content-header form\\\"> <div class=form-buttons> <button ng-if=unavailableItemsExist(list) class=\\\"button action\\\" ng-disabled=isRemoving ng-click=removeUnavailable(list) analytics-click=\\\"['account list remove unavailable button', 'click']\\\"> {{::lang.values.removeUnavailableItems}} </button> <button ng-if=list.items.length class=\\\"button action print\\\" data-test=save-for-later-list-print-button analytics-click=\\\"['List View Print Button', 'click']\\\" ng-click=\\\"listPrintService.printList(list.items, list.name)\\\"> {{::lang.values.print}} </button> </div> <h3> <span data-test=save-for-later-list-name ng-if=!toggleEdit>{{list.name}}</span> <button class=right ng-if=\\\"mobile.isMobileApp() && !toggleEdit && !!categorizedProducts && !!orderedCategories\\\" share-list-button sorted-products=categorizedProducts sorted-categories=orderedCategories list-title=list.name hide-text=true aria-label={{::lang.aria.shareList}}></button> <form ng-submit=\\\"analytics.logEvent('account list name', 'submit')\\\" name=nameForm> <input ng-if=toggleEdit required name=name type=text class=input ng-model=list.name data-test=save-for-later-edit-list-input /> <button ng-if=!toggleEdit class=\\\"button edit\\\" ng-click=editListName() data-test=save-for-later-edit-list-button analytics-click=\\\"['account list edit name button', 'click']\\\"> {{::lang.values.editName}} </button> <button ng-if=toggleEdit class=\\\"button save dark\\\" ng-click=editName(list.name) analytics-click=\\\"['account list save name button', 'click']\\\" data-test=save-for-later-edit-list-save-button> {{::lang.values.save}} </button> </form> </h3> </div> <div class=\\\"not-found left\\\" ng-if=!list.items.length> <p data-test=save-for-later-no-lists>{{::lang.values.noProductsInList}}</p> <a ng-if=::!mobile.isMobile class=\\\"button continue-shopping\\\" ui-sref={{::config.continueShoppingRedirect.desktop}} analytics-click=\\\"['account list continue shopping button', 'click']\\\"> {{::lang.values.continueShopping}} </a> <a ng-if=::mobile.isMobile class=\\\"button continue-shopping\\\" ui-sref={{::config.continueShoppingRedirect.mobile}} analytics-click=\\\"['account list continue shopping button', 'click']\\\"> {{::lang.values.continueShopping}} </a> </div> <table class=table ng-if=list.items.length> <thead> <tr> <td colspan=\\\"{{::(mobile.isMobile) ? 3 : 1}}\\\"> <input type=checkbox class=checkbox id=listSelectAll ng-model=form.allSelected ng-change=selectAll() aria-label={{::lang.aria.selectAll}} analytics-click=\\\"['account list select all checkbox', 'click']\\\" data-test=save-for-later-select-all-items-checkbox> <label for=listSelectAll>{{::(mobile.isMobile) ? lang.values.selectAll : '' }}</label> </td> <td ng-if=::!mobile.isMobile colspan=2> {{::lang.values.itemName}} </td> <td ng-if=::!mobile.isMobile> {{::lang.values.currentPrice}} </td> <td ng-if=::!mobile.isMobile> {{::lang.values.quantity}} </td> </tr> </thead> <tbody ng-repeat=\\\"category in orderedCategories\\\" ng-init=\\\"categoryIndex = $index\\\" class=category> <tr ng-if=\\\"categorizedProducts[category].length > 0\\\" class=category> <td colspan=\\\"{{::(mobile.isMobile) ? 3 : 5}}}\\\">{{category}}</td> </tr> <tr class=item ng-if=\\\"item.quantity > 0\\\" id=list-item-{{item.id}} data-test=save-for-later-list-row ng-repeat=\\\"item in categorizedProducts[category]\\\"> <td class=action> <input ng-model=selectedMap[item.store_product.id] class=checkbox type=checkbox ng-disabled=\\\"isItemCurrentlyOutOfStock(item) || !item.store_product.status\\\" ng-change=\\\"selectItem(item); analytics.logEvent('account list item checkbox', 'click')\\\" id=listItem{{categoryIndex}}-{{$index}} aria-label=\\\"{{lang.aria.select + ' ' + item.store_product.name}}\\\"/> <label for=listItem{{categoryIndex}}-{{$index}}></label> </td> <td ng-click=openModal(item) role=button class=\\\"action internal-link\\\" aria-label=\\\"{{lang.aria.openModal + ' ' + item.store_product.name}}\\\" ng-disabled=!item.store_product.status> <div class=item-image ng-class=\\\"{ 'is-out-of-stock': isItemCurrentlyOutOfStock(item) }\\\" ng-attr-style=\\\"background-image: url('{{::imageURLService.getProductImageURL(item.store_product, 'small')}}')\\\"></div> </td> <td> <button ng-click=openModal(item) type=button class=item-name aria-label={{item.store_product.name}}> {{item.store_product.name}} </button> <p ng-if=item.product_config class=configurable-values compile=\\\"configurableProductService.configsString(item, true)\\\"></p> <react-fulfillment-banner store-product=item.store_product> </react-fulfillment-banner> <div ng-if=::mobile.isMobile ng-disabled=!item.store_product.status item=item class=right modify-quantity on-update=list.put() analytics-name=\\\"account list\\\" increment-fn=incrementItem(item) decrement-fn=decrementItem(item) include-zero=true> </div> <div ng-if=::mobile.isMobile product-prices product=item.store_product unit-price=item.unit_price></div> <span ng-if=\\\"!item.store_product.status || isItemCurrentlyOutOfStock(item)\\\" class=out-of-stock-text uib-popover-html=outOfStockWarningPopover popover-trigger=\\\"mouseenter focus\\\" popover-enable=\\\"!item.store_product.status || isItemCurrentlyOutOfStock(item)\\\"> {{::lang.values.outOfStock}} <i class=\\\"icon icon-info-i\\\" aria-hidden=true></i> </span> </td> <td ng-if=::!mobile.isMobile> <div ng-class=\\\"{disable: !item.store_product.status}\\\" product-prices product=item.store_product unit-price=item.unit_price></div> </td> <td ng-if=::!mobile.isMobile ng-disabled=!item.store_product.status> <div modify-quantity item=item increment-fn=incrementItem(item) decrement-fn=decrementItem(item) include-zero=true analytics-name=\\\"account list\\\" ng-disabled=!item.store_product.status></div> </td> </tr> </tbody> </table> <div class=item-actions ng-if=selectedItems.length> <button ng-disabled=isRemoving class=\\\"button remove\\\" ng-click=\\\"removeFromList(selectedItems, list)\\\" analytics-click=\\\"['account list remove from list button', 'click']\\\" data-test=save-for-later-remove-selected-items-button> <span ng-if=!isRemoving>{{::lang.values.removeFromList}}</span> <span ng-if=isRemoving>{{::lang.values.loadingRemove}}</span> </button> <button ng-if=\\\"shopContextIntent !== SHOPPING_MODES.INSTORE_LIST\\\" class=\\\"button action cart\\\" ng-click=addList(selectedItems) analytics-click=\\\"['account list add to cart button', 'click']\\\" data-test=save-for-later-add-to-cart-or-list-button> {{::lang.values.addToCartButtonLabel}} </button> <button ng-if=\\\"shopContextIntent === SHOPPING_MODES.INSTORE_LIST\\\" class=\\\"button action cart\\\" ng-click=addList(selectedItems) analytics-click=\\\"['account list add to cart button', 'click']\\\" data-test=save-for-later-add-to-cart-or-list-button> {{::lang.values.addToListButtonLabel}} </button> </div> </div> \";","module.exports = \"<div class=modal-container> <react-express-plan-modal plans=$ctrl.plans() current-subscription=$ctrl.currentSubscription() on-plan-change=$ctrl.onSave on-cancel=$dismiss></react-express-plan-modal> </div> \";","module.exports = \"<span ng-include=\\\"'checkoutPage.desktop.html'\\\" ng-if=::!mobileService.isMobile></span> <span ng-include=\\\"'checkoutPage.mobile.html'\\\" ng-if=::mobileService.isMobile></span> \";","module.exports = \"<div class=\\\"cell offer-cell\\\" analytics-click=\\\"['promo collection cell', 'click']\\\" analytics-offer-impression=\\\"[offer, location]\\\" send-analytics=!$root.modifyingOrder> <h2 class=screenreadertext>{{::lang.aria.couponGroup}}</h2> <button class=offer-cell-button ng-click=offerDetailsModalService.open(offer)> <div class=cell-image-wrapper> <span class=cell-image cell-image default-image=offer.images.tile.medium use-image-tag=true fallback-image=offer-{{::config.offerIcons[offer.reward.type]}}.svg promoted-media=promotedMedia></span> </div> <div class=cell-content-wrapper> <div class=cell-title> <span class=cell-title-text ng-bind-html=offer.name></span> </div> <div class=\\\"cell-prices cell-prices__offers\\\"> <div ng-if=offer.end_date> {{(lang.values.offerEndDate) ? lang.template(lang.values.offerEndDate, {endDate: (offer.end_date | apiDate:config.offerDateFormat)}) : lang.template(lang.values.saleEndDate, {endDate: (offer.end_date | date:\\\"DD MMM\\\")})}} </div> <div ng-if=offer.limit_basket>{{::lang.template(lang.values.limitPerBasket, {limit: offer.limit_basket})}}</div> <div ng-if=offer.limit_customer>{{::lang.template(lang.values.limitPerCustomer, {limit: offer.limit_customer})}}</div> <div ng-if=offer.limit_total>{{::lang.template(lang.values.limitPerTotal, {limit: offer.limit_total})}}</div> </div> </div> </button> <div ng-if=\\\"offer.offer_type != 'coupon' && offer.offer_type != 'continuity'\\\" class=\\\"cell-badge offer\\\"></div> <div ng-if=\\\"offer.offer_type == 'coupon'\\\" class=\\\"cell-badge coupon\\\"> <div coupon-clipper coupon=offer class=button location={{location}}></div> </div> <div ng-if=\\\"offer.offer_type === 'continuity'\\\"> <div continuity-progress offer=offer></div> </div> </div> \";","module.exports = \"<div class=forgot-password> <form class=form ng-submit=\\\"reset(); analytics.logEvent('forgot password', 'submit')\\\" id=password-reset-form name=passwordResetForm focus-first-input> <p class=required-fields-message>{{::lang.values.requiredFieldsMessage}}</p> <div class=\\\"form-row identifier\\\" ng-if=!message> <label for=password-reset-email>{{::lang.values.email}}</label> <input type=email id=password-reset-email class=input required ng-model=identifier.email name=email placeholder={{::lang.values.email}} aria-label=\\\"{{::lang.aria.email + ' ' + lang.aria.required}}\\\" aria-describedby=password-reset-email-error /> <span id=password-reset-email-error class=required-field ng-if=\\\"passwordResetForm.email.$touched && passwordResetForm.email.$invalid && !message\\\">{{::lang.values.requiredForm.email}}</span> </div> <div ng-if=!message> <recaptcha-checkbox ng-if=::recaptcha.enabled class=recaptcha-container action=recaptcha.action on-success=onRecaptchaSuccess on-expired=onRecaptchaExpired /> </div> <button ng-if=!message type=submit form=password-reset-form class=\\\"button mobile-bottom\\\" ng-class=\\\"{'loading': resetting, 'loyalty-onboarding-call-to-action': loyaltyOnboardingStep}\\\"> <div class=label>{{::lang.values.resetPassword}}</div> </button> <div ng-if=error class=\\\"message error reveal\\\"> <span class=icon-error aria-hidden=true></span> {{error}} </div> <div ng-if=message class=\\\"message success reveal\\\"> <span class=icon-checkmark-circle aria-hidden=true></span> {{message}} </div> </form> <button ng-if=\\\"forgotPasswordContext === 'mainForgotPassword'\\\" ng-click=\\\"setView('login')\\\" class=link analytics-click=\\\"['forgot password return to login button', 'click']\\\"> {{::lang.values.backToLogin}} </button> </div> \";","module.exports = \"<div class=stripe-payment ng-class=\\\"{\\n    'showNewCardCt': $ctrl.shouldShowStripeForm,\\n    'ic-theme': $ctrl.useIcTheme\\n  }\\\" data-test=stripe-container> <div class=stripe-payment-credit-cards ng-if=\\\"$ctrl.paymentInstruments.length > 0\\\"> <h2 ng-if=!$ctrl.hideTitle class=\\\"section-divider-small section-divider-small--align-left unata-payment-action\\\"> <span class=title>{{:: $ctrl.lang.values.selectACard}}</span> </h2> <div class=form-row ng-if=!$ctrl.shouldShowStripeForm> <div ng-class=\\\"{ 'solid-background': $ctrl.enableCreditCardListBackground }\\\"> <credit-card-list use-ic-theme=$ctrl.useIcTheme on-select=$ctrl.setCreditCard(creditCard) credit-cards=$ctrl.paymentInstruments selected-credit-card=$ctrl.selectedCard on-delete-click=$ctrl.handleDeleteClick(creditCard) allow-delete-of-selected=true></credit-card-list> <button ng-if=$ctrl.checkoutSave class=\\\"button dark checkout-save unata-payment-action\\\" ng-click=$ctrl.checkoutSave()> {{:: $ctrl.lang.values.choosePaymentMethod }} </button> </div> <div class=\\\"button-row add-card unata-payment-action\\\"> <button class=add-card-button ng-class=\\\"{ 'ic-theme': $ctrl.useIcTheme }\\\" ng-click=$ctrl.showStripeForm() data-test=add-card-button> {{:: $ctrl.addCardLabel || $ctrl.lang.values.addACard }} </button> <button class=add-card-button ng-if=$ctrl.enableGiftCards ng-click=$ctrl.openGiftCardsModal()> {{:: $ctrl.lang.values.giftCardHeader }} </button> </div> </div> </div> <div ng-show=$ctrl.shouldShowStripeForm class=unata-payment-action> <h2 ng-if=!$ctrl.hideTitle class=section-divider-small> <span class=title>{{:: $ctrl.lang.values.addNewCard}}</span> </h2> <stripe-form auth-type=$ctrl.authType save-label={{::$ctrl.lang.values.continue}} on-cancel-form-click=$ctrl.handleCancelClick() on-after-save=$ctrl.handleCreditCardAdd(card) on-save-error=$ctrl.handleCreditCardAddError(e) use-ic-theme=$ctrl.useIcTheme enable-solid-background=$ctrl.enableFormBackground payment-context=$ctrl.paymentContext credit-cards=$ctrl.paymentInstruments show-save-credit-card-checkbox=$ctrl.showSaveCreditCardCheckbox></stripe-form> </div> </div> \";","module.exports = \"<div class=\\\"dropdown-menu configurable\\\" ng-style=\\\"{ visibility: isDropdownVisible }\\\"> <div ng-if=!$parent.showAllOptions> <div class=single-configuration ng-repeat=\\\"configuration in existingConfig\\\" ng-init=\\\"option = configuration.product_config.options[0].base || configuration.product_config.options[0].item\\\"> <span class=single-configuration-label>{{::option.name}}</span> <div add-to-cart product=product configuration=option is-dropdown=true></div> </div> <div role=button ng-if=\\\"existingConfig.length >= 1\\\" class=\\\"add-another icon-fixed-right icon-after-plus\\\" ng-click=linkToProductDetails(product.id)>Add Another</div> </div> <div ng-if=$parent.showAllOptions> <div class=single-configuration ng-repeat=\\\"configuration in product.product_config.options[0].items\\\"> <span class=single-configuration-label>{{::configuration.name}}</span> <div add-to-cart product=product configuration=configuration is-dropdown=true></div> </div> </div> </div> \";","module.exports = \"<div class=modal-container> <div class=modal-header></div> <div class=\\\"parent-shopping-selector no-fixed-width\\\"> <div class=modal-content> <div class=cart-list-transfer> <div class=shopping-context-main-content> <h1> {{:: $ctrl.lang.templateAsString( $ctrl.lang.values.transferBetweenCartAndList.titleTransferUnavailable, { initialContextTitle: $ctrl.initialContext } ) }} </h1> <p> {{:: $ctrl.lang.templateAsString( $ctrl.lang.values.transferBetweenCartAndList.messageTransferUnavailable.msg, { updatedContextTitle: $ctrl.updatedContext } ) }} </p> <p> {{:: $ctrl.lang.templateAsString( $ctrl.lang.values.transferBetweenCartAndList.messageTransferUnavailable.remainingProducts, { numTotal: $ctrl.itemCount, initialCartOrList: $ctrl.initialContext } ) }} </p> <div class=cart-list-transfer-buttons> <button ng-click=$close() class=button> {{:: $ctrl.lang.templateAsString( $ctrl.lang.values.transferBetweenCartAndList.yesContinue, { updatedContextTitle: $ctrl.updatedContext } ) }} </button> <button ng-click=$dismiss() class=\\\"button empty\\\"> {{::$ctrl.lang.values.cancel}} </button> </div> </div> </div> </div> </div> </div> \";","module.exports = \"<div ng-repeat=\\\"store in storeMap.stores | filter: storeMap.storeFilterFn\\\" ng-class=\\\"{'store-selection-content__selected-store-box': store.id === auth.user.store.id, current: storeMap.currentStore.id ===  store.id}\\\" class=store data-test=store-selector-store> <div class=store-row> <div ng-if=\\\"::config.multipleBanners.enabled && !config.multipleBanners.enableNonTabulatedView\\\" class=store-selector-banner-image-container> <banner-image banner-slug=store.store_banner.key></banner-image> </div> <div class=store-info> <div ng-if=\\\"store.id === auth.user.store.id\\\" class=store-info__current-store-label> Current store: </div> <div class=name data-test=store-name> <h2>{{store.name}}</h2> </div> <div class=non-tabulated-banners ng-if=::config.multipleBanners.enableNonTabulatedView> <div class=banner-tags banner-tags banner-key=store.store_banner.key></div> <div ng-repeat=\\\"associated_store in store.associated_stores\\\"> <div class=banner-tags banner-tags banner-key=associated_store.store_banner.key has-pickup=associated_store.has_pickup has-delivery=associated_store.has_delivery> </div> </div> </div> <div class=address> <div> <span class=\\\"icon icon-pin-light\\\" aria-hidden=true></span> <span> {{store.address.address1}}, {{store.address.address2}} {{store.address.address3 ? ', ' + store.address.address3 : ''}} {{store.address.city}}, {{store.address.province}} {{store.address.postal_code}} </span> </div> <div ng-if=!!store.phone_number> <span class=\\\"icon icon-phone\\\" aria-hidden=true></span> <a href=tel:+1{{store.phone_number}}>{{store.phone_number}}</a> </div> <div ng-if=\\\"store.last_purchased !== null\\\"> <span class=\\\"icon previously-shopped\\\"></span> <span>{{::lang.values.lastOrderedOn}} <span style=white-space:nowrap>{{store.last_purchased | apiDate:'MMM Do, YYYY'}}</span></span> </div> <div> <span class=store-distance ng-if=\\\"store.distance !== undefined && storeMap.preciseLocation\\\"> {{store.distance}} {{storeMap.distanceUnitsAbbreviation}} </span> </div> </div> </div> <div class=store-selector-button ng-class=\\\"{'has-pickup': store.show_pickup}\\\" ng-if=\\\"(storeMap.shopContextIntent === 'pickup' || storeMap.shopContextIntent === 'catering') && $index !== storeMap.loadingIndex\\\"> <div ng-if=\\\"!storeMap.isStoreSelectable(store) && !config.multipleBanners.enableNonTabulatedView\\\" class=store-unavailable>{{::lang.values.pickupInstoreUnavailable}}</div> <div ng-if=storeMap.isStoreSelectable(store)> <button ng-click=\\\"storeMap.updateHomeStore(store, $index)\\\" id=shopping-selector-update-home-store-{{store.id}}-pickup class=\\\"button small hollow\\\" analytics-click=\\\"['store selector set home store button', 'click']\\\" data-test=select-store-button>{{::lang.values.select}} </button> </div> <button ng-if=\\\"!store.show_pickup && storeMap.shopContextIntent === 'pickup' && !config.multipleBanners.enableNonTabulatedView\\\" ng-click=storeMap.shopAnotherWay() id=shopping-selector-set-shopping-stage-{{store.id}} class=\\\"button small hollow darker shop-another-way\\\" analytics-click=\\\"['store selector set home store button', 'click']\\\"> {{::lang.values.shopAnotherWay}} </button> <button ng-if=\\\"!store.show_pickup && storeMap.shopContextIntent === 'pickup' && config.multipleBanners.enableNonTabulatedView\\\" ng-click=storeMap.shopAnotherWay() id=shopping-selector-set-shopping-stage-{{store.id}} class=\\\"button small hollow shop-another-way\\\" analytics-click=\\\"['store selector set home store button', 'click']\\\"> {{::lang.values.switchModes}} </button> <div ng-if=\\\"!storeMap.isStoreSelectable(store) && config.multipleBanners.enableNonTabulatedView\\\" class=switch-modes-unavailbe-message> <span class=icon-info aria-hidden=true></span> {{::lang.values.pickupInstoreUnavailable}} </div> <a class=store-details-link ng-if=store.external_url ng-href=\\\"{{store.external_url | absoluteUrl}}\\\">{{::lang.values.storeDetails}}</a> </div> <div class=\\\"store-selector-button instore\\\" ng-if=\\\"storeMap.shopContextIntent === 'instore' && $index !== storeMap.loadingIndex\\\"> <button ng-click=\\\"storeMap.updateHomeStore(store, $index)\\\" id=shopping-selector-update-home-store-{{store.id}}-instore class=\\\"button small hollow\\\" analytics-click=\\\"['store selector set home store button', 'click']\\\" data-test=select-store-button>{{::lang.values.select}} </button> <a class=store-details-link ng-if=store.external_url ng-href=\\\"{{store.external_url | absoluteUrl}}\\\">{{::lang.values.storeDetails}}</a> </div> <div ng-if=\\\"$index === storeMap.loadingIndex\\\" class=store-selector-button> <img src=\" + require(\"static/images/loading-small.svg\") + \" alt=Loading /> </div> </div> </div> \";","module.exports = \"<div class=password-change> <p class=required-fields-message>{{::lang.values.requiredFieldsMessage}}</p> <h3>{{::lang.values.passwordChange}}</h3> <div class=input-help ng-if=lang.values.passwordInputHelpText> {{::lang.values.passwordInputHelpText}} </div> <form ng-submit=change() name=passwordChangeForm analytics-click=\\\"['account password change', 'submit']\\\"> <div class=content-section> <div class=form-row> <div class=\\\"col-1-3 col-m-1\\\"> <label for=passwordChangeOldPassword class=bold>{{::lang.values.passwordCurrent}}</label> </div> <div class=\\\"col-2-3 col-m-1\\\"> <input id=passwordChangeOldPassword name=oldPassword class=\\\"input small\\\" type=password required placeholder=\\\"{{::lang.values.passwordCurrent}} *\\\" ng-model=oldPassword aria-label=\\\"{{::lang.aria.passwordCurrent + ' ' + lang.aria.required}}\\\"/> <span class=required-field ng-if=\\\"passwordChangeForm.oldPassword.$touched && passwordChangeForm.oldPassword.$invalid\\\">{{::lang.values.requiredForm.password}}</span> </div> </div> <div class=form-row> <div class=\\\"col-1-3 col-m-1\\\"> <label for=passwordChangeNewPassword class=bold>{{::lang.values.passwordNew}}</label> </div> <div class=\\\"col-2-3 col-m-1\\\"> <input id=passwordChangeNewPassword name=newPassword class=\\\"input small\\\" type=password required placeholder=\\\"{{::lang.values.passwordNew}} *\\\" ng-model=newPassword aria-label=\\\"{{::lang.aria.passwordNew + ' ' + lang.aria.required}}\\\" ng-pattern=passwordRegex ng-minlength={{::config.passwordMinLength}} ng-maxlength={{::config.passwordMaxLength}} ng-model-options=\\\"{ updateOn: 'default blur', debounce: { default: 500, blur: 0 } }\\\"/> <span id=new-password-error class=required-field ng-if=\\\"(passwordChangeForm.newPassword.$touched || passwordChangeForm.$submitted) && passwordChangeForm.newPassword.$error.required\\\">{{::lang.values.requiredForm.password}} </span> <span id=new-password-error class=required-field ng-if=\\\"(passwordChangeForm.newPassword.$touched || passwordChangeForm.$submitted) && passwordChangeForm.newPassword.$error.minlength\\\">{{::lang.values.passwordInvalidMinLength}} </span> <span id=new-password-error class=required-field ng-if=\\\"(passwordChangeForm.newPassword.$touched || passwordChangeForm.$submitted) && passwordChangeForm.newPassword.$error.maxlength\\\">{{::lang.values.passwordInvalidMaxLength}} </span> <span id=new-password-error class=required-field ng-if=\\\"(passwordChangeForm.newPassword.$touched || passwordChangeForm.$submitted) &&\\n              !passwordChangeForm.newPassword.$error.minlength &&\\n              !passwordChangeForm.newPassword.$error.maxlength &&\\n              passwordChangeForm.newPassword.$error.pattern\\\">{{::lang.values.passwordInvalid}} </span> </div> </div> <div class=form-row> <div class=\\\"col-1-3 col-m-1\\\"> <label for=passwordChangeConfirmNewPassword class=bold>{{::lang.values.passwordConfirmNew}}</label> </div> <div class=\\\"col-2-3 col-m-1\\\"> <input id=passwordChangeConfirmNewPassword name=newPasswordConfirm class=\\\"input small\\\" type=password required placeholder=\\\"{{::lang.values.passwordConfirmNew}} *\\\" ng-model=confirmNewPassword aria-label=\\\"{{::lang.aria.passwordConfirmNew + ' ' + lang.aria.required}}\\\" ng-pattern=passwordRegex ng-minlength={{::config.passwordMinLength}} ng-maxlength={{::config.passwordMaxLength}} ng-model-options=\\\"{ updateOn: 'default blur', debounce: { default: 500, blur: 0 } }\\\"/> <span id=confirm-new-password-error class=required-field ng-if=\\\"(passwordChangeForm.newPasswordConfirm.$touched || passwordChangeForm.$submitted) && passwordChangeForm.newPasswordConfirm.$error.required\\\">{{::lang.values.requiredForm.password}} </span> <span id=confirm-new-password-error class=required-field ng-if=\\\"(passwordChangeForm.newPasswordConfirm.$touched || passwordChangeForm.$submitted) && passwordChangeForm.newPasswordConfirm.$error.minlength\\\">{{::lang.values.passwordInvalidMinLength}} </span> <span id=confirm-new-password-error class=required-field ng-if=\\\"(passwordChangeForm.newPasswordConfirm.$touched || passwordChangeForm.$submitted) && passwordChangeForm.newPasswordConfirm.$error.maxlength\\\">{{::lang.values.passwordInvalidMaxLength}} </span> <span id=confirm-new-password-error class=required-field ng-if=\\\"(passwordChangeForm.newPasswordConfirm.$touched || passwordChangeForm.$submitted) &&\\n              !passwordChangeForm.newPasswordConfirm.$error.minlength &&\\n              !passwordChangeForm.newPasswordConfirm.$error.maxlength &&\\n              passwordChangeForm.newPasswordConfirm.$error.pattern\\\">{{::lang.values.passwordInvalid}} </span> </div> </div> </div> <div class=content-footer> <button id=passwordChangeSubmit class=\\\"button action\\\" ng-disabled=\\\"changing || passwordChangeForm.$invalid\\\"> {{::lang.values.passwordChange}} </button> <div ng-if=message id=passwordChangeSuccessMsg class=\\\"message success\\\"> <span class=icon-checkmark-circle aria-hidden=true></span> {{message}} </div> <div ng-if=error id=passwordChangeErrorMsg class=\\\"message error\\\"> <span class=icon-error aria-hidden=true></span> {{error}} </div> </div> </form> </div> \";","module.exports = \"<div class=\\\"view scan-not-found text-center\\\"> <div class=not-found> No Product Found <div> <button barcode-scanner-button class=\\\"button highlight\\\">Try Again</button> </div> </div> </div>\";","module.exports = \"<ul> <li class=item-wrapper ng-class=\\\"{ 'out-of-stock': isItemCurrentlyOutOfStock(item) }\\\" ng-if=\\\"item.quantity > 0 && (!item.store_product.product_type || item.store_product.product_type !== 'subscription')\\\" ng-repeat=\\\"item in category track by $index\\\" ng-init=\\\"showEdit = false\\\" data-test=mini-cart-item id=mini-cart-item-{{::item.id}}> <div ng-include=\\\"'sideCartListItem.html'\\\" ng-init=\\\"sideCartReference = sideCartReference\\\"></div> </li> </ul> \";","module.exports = \"<div class=\\\"menu js-mobile-shop-menu\\\" ng-if=\\\"$root.mobile.isMobile && (tree.children.length || showSiblings)\\\"> <ul class=wrapper ng-if=tree.children.length> <li class=\\\"item item--all\\\" ng-hide=\\\"config.internalRedirects && config.internalRedirects.hasOwnProperty('main.shop.flyer')\\\" ng-class=\\\"{current: util.stateIs(tree.current.state, tree.current.params)}\\\"> <a class=item-link--all no-apply-click=\\\"go(tree.current.state, utilService.cleanShopParams(tree.current.params), $event)\\\" analytics-click=\\\"['catalog menu link', 'click']\\\" href=\\\"\\\" ng-attr-aria-current=\\\"{{util.stateIs(tree.current.state, tree.current.params) ? 'page' : undefined }}\\\">All <span class=screen-reader-text ng-if=\\\"util.stateIs(tree.current.state, tree.current.params)\\\">Current</span></a> </li> <li class=item ng-repeat=\\\"child in tree.children track by $index\\\" ng-class=\\\"{current: util.stateIs(child.state, child.params)}\\\"> <a no-apply-click=\\\"go(child.state, utilService.cleanShopParams(child.params), $event)\\\" analytics-click=\\\"['catalog menu link', 'click']\\\" data-test=department-link-{{child.id}} href=\\\"\\\" ng-attr-aria-current=\\\"{{util.stateIs(child.state, child.params) ? 'page' : undefined }}\\\">{{child.name}} <span class=screen-reader-text ng-if=\\\"util.stateIs(child.state, child.params)\\\">Current</span></a> </li> <li role=button class=item ng-repeat=\\\"link in config.categoriesMenuAdditionalLinks.appendedLinks\\\"><a analytics-click=\\\"['category menu appended link', 'click', $index]\\\" href={{link.href}} data-test=appended-link>{{ link.text }}</a></li> </ul> <ul class=wrapper ng-if=showSiblings> <li class=\\\"item item--all\\\" ng-hide=\\\"config.internalRedirects && config.internalRedirects.hasOwnProperty('main.shop.flyer')\\\"> <a class=item-link--all no-apply-click=\\\"go(tree.parents[tree.parents.length - 1].state, utilService.cleanShopParams(tree.parents[tree.parents.length - 1].params), $event)\\\" analytics-click=\\\"['catalog menu link', 'click']\\\" href=\\\"\\\">All</a> </li> <li class=item ng-repeat=\\\"sibling in tree.siblings\\\" ng-class=\\\"{current: util.stateIs(sibling.state, sibling.params)}\\\"> <a no-apply-click=\\\"go(sibling.state, utilService.cleanShopParams(sibling.params), $event)\\\" analytics-click=\\\"['catalog menu link', 'click']\\\" data-test=department-link-{{sibling.id}} href=\\\"\\\" ng-attr-aria-current=\\\"{{util.stateIs(sibling.state, sibling.params) ? 'page' : undefined }}\\\">{{sibling.name}} <span class=screen-reader-text ng-if=\\\"util.stateIs(sibling.state, sibling.params)\\\">Current</span></a> </li> <li role=button class=item ng-repeat=\\\"link in config.categoriesMenuAdditionalLinks.appendedLinks\\\"><a href={{link.href}} analytics-click=\\\"['category menu appended link', 'click', $index]\\\" data-test=appended-link>{{ link.text }}</a></li> </ul> </div> \";","module.exports = \"<div id=wegpay-integration class=wegpay ng-controller=\\\"WegpayIntegrationController as $ctrl\\\" scroll-into-view> <h2 class=\\\"section-divider-small section-divider-small--align-left unata-payment-action\\\"> <span class=title>{{::lang.values.selectACard}}</span> </h2> <credit-card-list ng-if=\\\"!$ctrl.showCardLoader && !$ctrl.showAddInstrument\\\" credit-cards=$ctrl.paymentInstruments on-select=$ctrl.setCreditCard(creditCard) selected-credit-card=$ctrl.paymentInstrument on-delete-click=$ctrl.deleteCard(creditCard) disable-delete=$ctrl.disableDelete allow-delete-of-selected=true include-expiry-date=true disable-card-name=true></credit-card-list> <div ng-if=$ctrl.showCardLoader aria-label={{::lang.aria.loadingImage}} class=\\\"view-loading-indicator wegpay-loader\\\"></div> <button id=wegpay-add-card class=\\\"button action unata-payment-action\\\" ng-click=$ctrl.addPaymentInstrument() ng-if=!$ctrl.showAddInstrument> {{::lang.values.addCard}} </button> <div ng-show=$ctrl.showAddInstrument class=\\\"unata-payment-action wegpay-add-instrument\\\"> <div ng-if=$ctrl.showAddInstrumentLoader aria-label={{::lang.aria.loadingImage}} class=\\\"view-loading-indicator wegpay-loader\\\"></div> <span data-test=wegpay-form ng-include=\\\"'wegpayPaymentForm.html'\\\" ng-show=!$ctrl.showAddInstrumentLoader></span> </div> </div> \";","module.exports = \"<div ng-class=\\\"{ 'ic-theme': $ctrl.useIcTheme }\\\" class=ic-express-plans> <div class=ic-express-plan ng-repeat=\\\"plan in $ctrl.plans track by plan.id\\\" ng-class=\\\"{ current: plan.id === $ctrl.selectedPlan.id }\\\"> <div class=ic-express-plan__title> {{:: plan.name }} </div> <div class=ic-express-plan__main> <div class=ic-express-plan__price> <div class=ic-express-plan__price-title>{{:: plan.price | currency }}</div> <span class=ic-express-plan__price-subtitle> {{:: plan.recurrence }} </span> </div> <div class=ic-express-plan__description>{{:: plan.description }}</div> <div class=ic-express-plan__minimum-amount> <span>{{:: (plan.price | currency) }}+</span> {{:: $ctrl.lang.values.minimumOrder }} </div> </div> <div class=ic-express-plan__actions> <button ng-click=\\\"$ctrl.onPlanSelect({ plan: plan })\\\" class=\\\"button dark button--squared\\\"> {{:: $ctrl.getButtonLabel(plan) }} </button> <span ng-if=\\\"plan.id === $ctrl.selectedPlan.id\\\">{{:: $ctrl.lang.values.currentPlan }}</span> </div> </div> </div>\";","module.exports = \"<div class=profile-container> <div ng-if=\\\"$ctrl.showSaveMessages && $ctrl.successMessage\\\" class=\\\"message success address-list-success-message\\\"> <span class=icon-checkmark-circle aria-hidden=true></span> {{$ctrl.successMessage}} </div> <div class=address-list-header> <p ng-if=$ctrl.textHeader class=address-list-header-text role=heading aria-level=2>{{::$ctrl.textHeader}}</p> </div> <div ng-if=\\\"$ctrl.showIdleMessage && !$ctrl.addressList.hasAddressItems()\\\"> <p class=address-list-idle-message>{{::$ctrl.lang.values.addressListIdleMessage}}</p> </div> <div id=add-new-address-form> <div class=address-list ng-if=\\\"$ctrl.currentEditingId === -1\\\" ng-class=\\\"{'selectable-radios': $ctrl.selectableRadios, 'selectable-buttons': $ctrl.selectableButtons}\\\"> <div class=\\\"address-list-item address-add-new\\\" ng-if=\\\"$ctrl.currentEditingId === -1\\\" ng-class=\\\"{'is-open': $ctrl.currentEditingId === -1}\\\"> <div class=address-list-item-form> <div class=address-list-item-form-title> <p role=heading aria-level=3>{{::$ctrl.lang.values.addressAddTitle}}</p> <p class=address-list-item-form-note>{{::$ctrl.lang.values.requiredFieldsMessage}}</p> </div> <address-list-form data=$ctrl.currentEditingItem on-save=$ctrl.onAddressSave(address) on-cancel=$ctrl.cancelAddressEdit() on-delete=$ctrl.deleteAddressItem(item.id) validate-address=$ctrl.validateAddress use-continue-copy=\\\"$ctrl.selectableButtons && !!$ctrl.selectAddressCallback\\\" optional-fields=$ctrl.optionalFields></address-list-form> </div> </div> </div> </div> <div class=address-list-outer-container ng-if=$ctrl.addressList.hasAddressItems()> <p class=screen-reader-text>{{::$ctrl.lang.values.deliverTo}}</p> <fieldset> <legend class=screen-reader-text>{{::$ctrl.lang.values.addressBookTitle}}</legend> <ul class=address-list auto-focus=true tabindex=-1 ng-class=\\\"{'selectable-radios': $ctrl.selectableRadios, 'selectable-buttons': $ctrl.selectableButtons}\\\" id=saved-address-list data-test=saved-address-list> <li class=address-list-item ng-repeat=\\\"item in $ctrl.addressList.addressItems track by item.id\\\" data-test=saved-address-item> <div class=address-list-item-form ng-if=\\\"$ctrl.currentEditingId === item.id\\\" tabindex=-1> <div class=address-list-item-form-title ng-hide=$ctrl.config.useInstacartAddressBook> <p role=heading aria-level=3>{{::$ctrl.lang.values.addressEditTitle}}</p> <p class=address-list-item-form-note>{{::$ctrl.lang.values.requiredFieldsMessage}}</p> </div> <address-list-form ng-if=\\\"$ctrl.currentEditingId === item.id\\\" data=$ctrl.currentEditingItem on-save=$ctrl.onAddressSave(address) on-cancel=$ctrl.cancelAddressEdit() on-delete=$ctrl.deleteAddressItem(item.id) validate-address=$ctrl.validateAddress optional-fields=$ctrl.optionalFields></address-list-form> </div> <div class=address-list-item-content ng-if=\\\"$ctrl.currentEditingId !== item.id\\\" ng-class=\\\"{disabled: !!$ctrl.currentEditingId}\\\"> <div class=address-list-item-radio-container ng-if=$ctrl.selectableRadios> <input class=radio type=radio id=address-list-item-radio-{{item.id}} name=address-list-item-radio ng-value=item.id ng-model=$ctrl.selectedAddress ng-change=$ctrl.onAddressSelected(item) aria-label={{item.address1}} ng-disabled=!!$ctrl.currentEditingId> <label for=address-list-item-radio-{{item.id}}></label> </div> <div class=address-list-item-preview ng-class=\\\"{selected: $ctrl.selectedAddress === item.id}\\\" aria-selected=\\\"{{$ctrl.selectedAddress === item.id}}\\\"> <p ng-hide=$ctrl.config.useInstacartAddressBook>{{item.first_name}} {{item.last_name}}</p> <p> <span class=display-block-if-mobile>{{item.address1}}, {{item.address2 ? item.address2 + ', ' : ''}} </span> <span class=display-block-if-mobile>{{item.city}}, {{item.province}} {{item.postal_code}}</span></p> <p ng-hide=$ctrl.config.useInstacartAddressBook class=address-list-phone-number>{{item.phone_number}}</p> <p ng-if=\\\"!$ctrl.config.disableDeliveryInstructions && item.instructions\\\"> {{item.instructions}} </p> </div> <div class=address-list-item-actions> <button class=address-list-item-action-edit ng-click=$ctrl.editAddressItem(item.id) ng-if=$ctrl.editableAddresses ng-disabled=\\\"$root.modifyingInstacartOrder || !!$ctrl.currentEditingId\\\" data-test=address-list-item-edit-button> {{::$ctrl.lang.values.edit}} </button> <button class=\\\"address-list-item-action-select button hollow small\\\" ng-click=$ctrl.onAddressSelected(item) ng-if=\\\"$ctrl.selectableButtons && !$ctrl.selectedLoading\\\" data-test=address-list-item-select-button> {{::$ctrl.lang.values.select}} </button> <button ng-if=\\\"$ctrl.selectedLoading && $ctrl.selectableButtons\\\" class=\\\"address-list-item-action-select button hollow small\\\"> <img src=\" + require(\"static/images/loading-small.svg\") + \" alt=Loading /> </button> </div> </div> </li> </ul> </fieldset> <p ng-if=\\\"$ctrl.currentEditingId !== -1\\\" class=address-add-new-link-container> <button class=address-add-new-link ng-click=$ctrl.editAddressItem(-1) aria-controls=add-new-address-form aria-label={{::$ctrl.lang.values.addNewAddress}} aria-expanded=\\\"{{$ctrl.currentEditingId === -1}}\\\"> {{::$ctrl.lang.values.addNewAddress}} </button> </p> </div> </div> \";","module.exports = \"<div class=subscription> <h3>{{::lang.values.subscription}}</h3> <div class=content-section> <p ng-if=!auth.user.subscription class=no-subscription ng-bind-html=::lang.values.noSubscription></p> <table ng-if=auth.user.subscription class=table> <tbody> <tr> <td><b>{{::lang.values.subscriptionType}}</b></td> <td>{{auth.user.subscription.name}}</td> </tr> <tr> <td><b>{{::lang.values.dateExpiration}}</b></td> <td>{{auth.user.subscription.end_date | date:\\\"MMM DD, YYYY\\\"}}</td> </tr> </tbody> </table> </div> </div> \";","module.exports = \"<fieldset ng-repeat=\\\"facet in $ctrl.facetedSideFilters\\\" id=\\\"facet-section-{{ ::facet.group_display_name.replace(' ', '-') }}\\\"> <legend>{{::facet.group_display_name}}</legend> <div ng-repeat=\\\"facetItem in facet.items | sortBySelected: 'name':selectedFacetedSideBrands:selectedFacetedSideFilters | limitTo: $ctrl.facetShowMore[$index] track by facetItem.name\\\"> <faceted-side-filters-checkbox parent=facet item=facetItem selected-faceted-side-filters=selectedFacetedSideFilters selected-faceted-side-brands=selectedFacetedSideBrands data-test=facet-{{::facetItem.name}} /> </div> <button class=faceted-side-filters-button ng-click=\\\"$ctrl.showOrHideMore($index, facet.items.length)\\\" ng-if=\\\"facet.items.length > $ctrl.facetShowMore[$index]\\\" aria-controls=\\\"facet-section-{{ ::facet.group_display_name }}\\\" aria-expanded=false data-test=facet-see-all-section-button>{{::$ctrl.lang.values.seeAll}} ({{::facet.items.length}})</button> <button class=faceted-side-filters-button ng-click=$ctrl.showOrHideMore($index) ng-if=\\\"facet.items.length === $ctrl.facetShowMore[$index] && facet.items.length > $ctrl.baseNumberShown\\\" aria-controls=\\\"facet-section-{{ ::facet.group_display_name }}\\\" aria-expanded=true data-test=facet-minimize-section-button>{{::$ctrl.lang.values.minimize}}</button> </fieldset> \";","module.exports = \"<div id=ic-express-ad class=ic-express-ad ng-class=\\\"$ctrl.enableRetailerTheme ? 'ic-express-ad-retailer' : 'ic-express-ad-instacart'\\\"> <div class=ic-express-ad__items data-test=ic-express-ad__items> <div class=ic-express-ad__item ng-class=\\\"$ctrl.parsedList.length === 1 ? 'ic-express-ad__item__single' : ''\\\" ng-if=\\\"$ctrl.parsedList && $ctrl.parsedList.length > 0\\\" ng-repeat=\\\"item in $ctrl.parsedList track by $index\\\"> <img class=ic-express-ad__icon ng-src=\\\"{{ $ctrl.utilService.loadAssetImage(item.icon) }}\\\" aria-hidden=true /> <div class=ic-express-ad__name>{{:: item.name }}</div> <div class=ic-express-ad__desc> {{:: item.desc }} </div> </div> </div> <div ng-if=$ctrl.showPlanSelector() class=ic-express-ad__plan-selector> <strong>{{:: $ctrl.config.lang.chooseAPlan}}:</strong> <react-express-plans plans=$ctrl.eligibleSubscriptionPlans default-selected-plan-id=$ctrl.planIdToSubscribeTo on-plan-select=$ctrl.onPlanSelectedCallback></react-express-plans> </div> <div ng-if=$ctrl.ctaButtonLabel class=ic-express-ad__actions> <button id=ic-express-ad-link-button class=\\\"button hollow ic-express-ad__button\\\" uib-popover-html=$ctrl.ctaLinkButtonDescription popover-trigger=mouseenter ng-if=$ctrl.ctaLinkButtonShow ng-click=$ctrl.onCtaLinkButtonClicked() data-test=ic-express-ad-link-button> {{ $ctrl.ctaLinkButtonLabel }} </button> <div ng-if=\\\"$ctrl.mobileService.isMobile && $ctrl.ctaLinkButtonShow\\\" ng-bind-html=$ctrl.ctaLinkButtonDescription></div> <button id=ic-express-ad-button class=\\\"button ic-express-ad__button\\\" ng-click=$ctrl.onCtaButtonClicked() data-test=ic-express-ad-button> {{ $ctrl.ctaButtonLabel }} </button> </div> </div> \";","module.exports = \"<div ng-if=$ctrl.hasErrors class=\\\"message error checkout-form__error-message\\\"> <span class=icon-error aria-hidden=true></span> {{::$ctrl.lang.values.orderDeliveryInstructions.saveError}} </div> <div class=\\\"checkout-form order-delivery-instructions-form\\\" ng-class=\\\"{'checkout-form--open': $ctrl.editMode}\\\"> <div ng-if=!$ctrl.editMode class=checkout-form__left> <ng-include class=icon src=\\\"::$ctrl.utilService.loadStaticImage('ic_edit.svg')\\\" aria-hidden=true /> </div> <div class=checkout-form__content> <div class=checkout-form__content-header> <div ng-if=$ctrl.editMode> <ng-include class=icon src=\\\"::$ctrl.utilService.loadStaticImage('ic_edit.svg')\\\" aria-hidden=true /> </div> <h2 class=checkout-form__title>{{$ctrl.lang.values.orderDeliveryInstructions.title}}</h2> </div> <div ng-if=!$ctrl.editMode class=checkout-form__readonly> <div class=checkout-form__instruction>{{$ctrl.messages.comment()}}</div> <div class=checkout-form__leave>{{$ctrl.messages.unattendedDelivery()}}</div> </div> <form novalidate name=$ctrl.form ng-submit=$ctrl.handleSubmit() ng-if=$ctrl.editMode class=checkout-form__form ng-class=\\\"{ 'checkout-form__form--expanded': $ctrl.condensed }\\\"> <div class=\\\"checkout-form__form-row sub-title\\\"> {{::$ctrl.lang.values.orderDeliveryInstructions.subtitle}} </div> <div class=checkout-form__form-row> <textarea class=\\\"checkout-form__form-row__input input\\\" ng-model=$ctrl.draft.comment ng-disabled=$ctrl.isSaving id=checkout-order-delivery-instructions-textarea placeholder={{::$ctrl.lang.values.orderDeliveryInstructions.placeholder}} maxlength={{::$ctrl.config.orderNoteMaxLength}} aria-label={{::$ctrl.lang.values.orderDeliveryInstructions.placeholder}}>\\n        </textarea> </div> <div class=checkout-form__form-row> <input ng-model=$ctrl.draft.leaveUnattended ng-disabled=!$ctrl.enableUnattendedDeliveryCheckbox() id=order-delivery-instructions-leave-checkbox class=checkbox type=checkbox /> <label class=leave-at-door for=order-delivery-instructions-leave-checkbox> {{::$ctrl.lang.values.orderDeliveryInstructions.unattendedDelivery}} </label> </div> <div class=\\\"notice notice-block\\\" ng-class=\\\"{ 'notice-warning': $ctrl.cartService.getHasAlcohol() }\\\"> <i class=icon ng-class=\\\"::$ctrl.cartService.getHasAlcohol() ? 'icon-warning' : 'icon-info-i'\\\" aria-hidden=true></i> <span>{{$ctrl.messages.warning()}}</span> </div> <div class=checkout-form__form-row> <div class=order-delivery-instructions-form__actions> <button type=submit class=\\\"button dark checkout-form__form-row__button\\\" id=order-delivery-instructions-form-save-button ng-disabled=\\\"$ctrl.isLoading || $ctrl.isSaving\\\"> <span ng-if=\\\"!$ctrl.isLoading && !$ctrl.isSaving\\\">{{::$ctrl.lang.values.save}}</span> <loading-dots show=\\\"$ctrl.isLoading || $ctrl.isSaving\\\"></loading-dots> </button> </div> </div> </form> </div> <div ng-if=\\\"!$ctrl.editMode && !$ctrl.hideChevron\\\" class=checkout-form__right> <button class=checkout-form__edit-button id=order-delivery-instructions-form-edit-button ng-click=$ctrl.enterEditMode() aria-label=\\\"{{ ::$ctrl.lang.values.expandSection }}: {{ ::$ctrl.lang.values.orderDeliveryInstructions.title }}\\\"></button> </div> </div> \";","module.exports = \"<div class=\\\"view shop\\\"> <div page-header label=$ctrl.featuredDepartmentName breadcrumbs=$ctrl.breadcrumbs previous-page=true></div> <div ng-if=::mobile.isMobile ng-include=\\\"'shopMenu.mobile.html'\\\"></div> <div class=collections> <div ng-repeat=\\\"collection in $ctrl.featuredDepartmentCollections track by $index\\\" class=collection-wrapper> <div ng-init=\\\"$ctrl.getCollectionData(collection, $index)\\\"> <unata-product-collection collection=$ctrl.collections[$index] ng-if=$ctrl.collections[$index].items.length location=\\\"Featured Department Collection\\\" full-width=true padded=true enable-placements=true></unata-product-collection> </div> </div> <div class=not-found ng-if=\\\"$ctrl.collections.length === 0\\\">{{::lang.values.noItemsFound}}</div> </div> </div> \";","module.exports = \"<div class=\\\"list review-cart\\\" ng-class=\\\"{'new-checkout-cart-bump' : ($ctrl.config.newCheckoutFlow.cartReviewPage.enabled && $ctrl.cartService.cart.items.length > 0), 'remove-bump': $ctrl.isOffline}\\\"> <div ng-if=!$ctrl.model.isLoading> <h1 class=review-cart-title ng-if=\\\"(!mobile.isMobile && !$ctrl.config.newCheckoutFlow.cartReviewPage.enabled) && $ctrl.cartService.cart.items.length > 0\\\"> {{::$ctrl.lang.values.reviewList}} </h1> <div class=actions ng-if=::!mobile.isMobile> <nav class=review-cart__nav ng-if=::config.newCheckoutFlow.cartReviewPage.enabled aria-label=breadcrumbs> <ul class=breadcrumbs> <li> <a ui-sref=main.home class=all analytics-click=\\\"['breadcrumbs home link', 'click']\\\" aria-label={{::lang.aria.goToHomepage}}> <span class=icon-home aria-hidden=true></span> </a> </li> <li ng-repeat=\\\"breadcrumb in $ctrl.breadcrumbs track by $index\\\"> <span class=divider></span> <a ng-if=breadcrumb.state ng-attr-href=\\\"{{$ctrl.$state.href(breadcrumb.state, breadcrumb.params)}}\\\" analytics-click=\\\"['breadcrumbs link', 'click']\\\" ng-class=\\\"{active: $index == $ctrl.breadcrumbs.length - 1}\\\">{{::breadcrumb.label}}</a> </li> </ul> </nav> <h1 class=review-cart-title--new ng-if=\\\"::!mobile.isMobile && $ctrl.config.newCheckoutFlow.cartReviewPage.enabled\\\"> {{::$ctrl.lang.values.reviewList}} </h1> <span ng-if=::!$ctrl.config.newCheckoutFlow.cartReviewPage.enabled> <button id=checkout-cart-empty data-test=checkout-cart-empty class=link-group ng-click=$ctrl.cartService.clear() analytics-click=\\\"['list empty cart button', 'click']\\\"> <span class=icon-trash aria-hidden=true></span> <span class=label>{{::$ctrl.lang.values.emptyList}}</span> </button> <span ng-if=!$ctrl.config.disableAisles uib-dropdown is-open=$ctrl.model.isSortDropdownOpen class=\\\"link-group review-cart-sort-dropdown\\\" aria-hidden=true> <button uib-dropdown-toggle class=link-group> <span class=icon-sort-by aria-hidden=true></span> {{::$ctrl.lang.values.sortList}} </button> <div ng-if=$ctrl.model.isSortDropdownOpen class=\\\"dropdown-menu bottom-right\\\"> <span class=ul-el> <span role=button class=\\\"li-el link\\\" ng-click=\\\"$ctrl.setSortType('aisle')\\\"> {{:: $ctrl.lang.values.sortByAisle}} </span> <span role=button class=\\\"li-el link\\\" ng-click=\\\"$ctrl.setSortType('category')\\\"> {{:: $ctrl.lang.values.sortByDepartment}} </span> </span> </div> </span> <button id=checkout-cart-print class=link-group ng-click=\\\"$ctrl.listPrintService.printList($ctrl.cartService.cart.items, $ctrl.lang.values.shoppingList)\\\" analytics-click=\\\"['list print button', 'click']\\\"> <span class=icon-print aria-hidden=true></span> <span class=label>{{::$ctrl.lang.values.print}}</span> </button> </span> <div class=right ng-if=$ctrl.hasCartItems()> <span ng-if=::$ctrl.config.newCheckoutFlow.cartReviewPage.enabled> <button id=checkout-cart-empty data-test=checkout-cart-empty class=link-group ng-click=$ctrl.cartService.clear() analytics-click=\\\"['list empty cart button', 'click']\\\"> <span class=icon-trash aria-hidden=true></span> <span class=label>{{::$ctrl.lang.values.emptyList}}</span> </button> <span ng-if=!$ctrl.config.disableAisles uib-dropdown is-open=$ctrl.model.isSortDropdownOpen class=\\\"link-group review-cart-sort-dropdown\\\" aria-hidden=true> <button uib-dropdown-toggle class=link-group> <span class=icon-sort-by aria-hidden=true></span> {{::$ctrl.lang.values.sortList}} </button> <div ng-if=$ctrl.model.isSortDropdownOpen class=\\\"dropdown-menu bottom-right\\\"> <span class=ul-el> <span role=button class=\\\"li-el link\\\" ng-click=\\\"$ctrl.setSortType('aisle')\\\"> {{:: $ctrl.lang.values.sortByAisle}} </span> <span role=button class=\\\"li-el link\\\" ng-click=\\\"$ctrl.setSortType('category')\\\"> {{:: $ctrl.lang.values.sortByDepartment}} </span> </span> </div> </span> <button id=checkout-cart-print class=link-group ng-click=\\\"$ctrl.listPrintService.printList($ctrl.cartService.cart.items, $ctrl.lang.values.shoppingList)\\\" analytics-click=\\\"['list print button', 'click']\\\"> <span class=icon-print aria-hidden=true></span> <span class=label>{{::$ctrl.lang.values.print}}</span> </button> </span> <add-to-list ng-if=\\\"(!$ctrl.config.disableSaveForLaterLists && $ctrl.model.nonCustomItems.length > 0)\\\" class=link-group products=$ctrl.model.nonCustomItems toggle-style=text analytics-click=\\\"['list add to list button', 'click']\\\"></add-to-list> <div class=fulfillment-spacing> <form class=actions-form ng-submit=$ctrl.addCustomItem($ctrl.model.customItemInput)> <div class=input-inner-button> <input type=text id=checkout-cart-custom-item-input class=\\\"input review-cart-custom-item-input\\\" ng-model=$ctrl.model.customItemInput placeholder={{::$ctrl.lang.values.addCustomItem}} aria-label={{::$ctrl.lang.values.addCustomItem}} data-test=checkout-cart-custom-item-input> <button type=submit class=\\\"button smaller round darker icon-plus\\\" aria-label={{::$ctrl.lang.values.add}} data-test=checkout-cart-custom-item-add-button></button> </div> </form> </div> <button id=checkout-cart-top-order-online class=\\\"button dark right inlist-button-spacing\\\" analytics-click=\\\"['list top order online button', 'click']\\\" ng-if=\\\"::!$ctrl.config.newCheckoutFlow.cartReviewPage.enabled && $ctrl.showOrderOnlineButton\\\" ng-click=$ctrl.openShoppingSelectorModal()> {{::$ctrl.lang.values.orderOnline}} </button> </div> </div> <div class=content-wrapper> <div class=review-cart-content ng-class=\\\"{'review-cart-content--new': config.newCheckoutFlow.cartReviewPage.enabled}\\\"> <div ng-if=!$ctrl.hasCartItems() class=not-found data-test=in-store-list-empty-message> {{::$ctrl.lang.values.noProductsInList}} <div ng-if=::!$ctrl.isOffline> <a class=\\\"button hollow switch-context\\\" analytics-click=\\\"['list continue shopping switch link', 'click']\\\" ng-click=\\\"$ctrl.shoppingSelectorService.open('shoppingContext')\\\" ng-if=::config.eComLight.enabled> {{::lang.values.switchShoppingMode}} </a> <a ng-if=::!mobile.isMobile class=\\\"button continue-shopping\\\" ui-sref={{::config.continueShoppingRedirect.desktop}} analytics-click=\\\"['list continue shopping link', 'click']\\\"> {{::$ctrl.lang.values.continueShopping}} </a> <a ng-if=::mobile.isMobile class=\\\"button continue-shopping\\\" ui-sref={{::config.continueShoppingRedirect.mobile}} analytics-click=\\\"['list continue shopping link', 'click']\\\"> {{::$ctrl.lang.values.continueShopping}} </a> </div> </div> <div ng-if=$ctrl.hasCartItems() class=cart-content-container> <unata-side-cart-sub-menu sort-list=$ctrl.triggerSortModal() current-sort-type=$ctrl.sortOptionNameByValue($ctrl.model.sortType) empty-list=$ctrl.emptyList() sorted-categories=$ctrl.model.orderedGroups[$ctrl.model.sortType] sorted-products=$ctrl.model.sortedProductsBy[$ctrl.model.sortType] delete-checked-items=$ctrl.deleteCheckedItems() uncheck-all-items=$ctrl.uncheckAllItems() checked-items-count=$ctrl.checkedItemsCount()></unata-side-cart-sub-menu> <div class=cart-table__container> <div class=cart-table__products-container> <div class=visual-headers ng-if=::!mobile.isMobile> <div class=product-header aria-hidden=true>{{::lang.values.product}}</div> <div class=offer-header></div> <div class=price-header aria-hidden=true>{{::lang.values.price}}</div> <div class=quantity-header aria-hidden=true>{{::lang.values.quantity}}</div> <div class=total-header aria-hidden=true>{{::lang.values.total}}</div> </div> <div ng-if=\\\"$ctrl.model.customItems && $ctrl.model.customItems.length > 0\\\" class=\\\"review-cart-custom-items table cart-table__products\\\"> <h2 class=category-label>{{::$ctrl.lang.values.customItems}}</h2> <table class=\\\"row item table\\\" data-test=in-store-list-items-table-custom role=presentation> <tbody> <tr class=\\\"row item\\\" ng-repeat=\\\"item in $ctrl.model.customItems track by $index\\\" id=checkout-cart-item-custom-{{item.pseudo_product.name}} ng-init=\\\"item.showDeleteConfirm = false\\\" ng-class=\\\"{ 'show-delete-confirm': item.showDeleteConfirm }\\\" ng-if=\\\"item.quantity > 0\\\" data-test=in-store-list-items-table-custom-item> <td class=\\\"action delete\\\" ng-if=::!mobile.isMobile> <div> <button class=\\\"button smaller round darker icon-delete\\\" ng-click=\\\"item.showDeleteConfirm = true\\\" name=item-delete-trigger analytics-click=\\\"['list product delete button', 'click']\\\" aria-label={{::lang.aria.deleteListItem}} data-test=item-delete-trigger-button ng-disabled=item.showDeleteConfirm></button> </div> <div class=delete-confirm ng-show=item.showDeleteConfirm> <div class=label>{{::$ctrl.lang.values.wantToRemove}}</div> <button ng-click=\\\"item.quantity = item.quantity || 1; item.showDeleteConfirm = false\\\" class=\\\"button smaller dark\\\" name=item-delete-cancel analytics-click=\\\"['list product delete confirmation cancel button', 'click']\\\"> {{::$ctrl.lang.values.cancel}} </button> <button ng-click=\\\"item.showDeleteConfirm = false; $ctrl.removeCustomItem(item.pseudo_product.name)\\\" class=\\\"button smaller highlight\\\" name=item-delete-confirm analytics-click=\\\"['list product delete confirmation remove button', 'click']\\\" data-test=item-delete-confirm-button> {{::$ctrl.lang.values.remove}} </button> </div> </td> <td ng-if=::mobile.isMobile class=instore-list-checkbox> <div class=completed> <input ng-disabled=$ctrl.isItemCurrentlyOutOfStock(item) class=checkbox id=custom-checkoff{{$index}} ng-model=item.checked ng-change=$ctrl.checkItem(item) type=checkbox data-test=custom-item-checkbox-input> <label for=custom-checkoff{{$index}} class=\\\"name item-checkbox-label\\\"></label> </div> </td> <td colspan=8 class=product-meta> <div ng-disabled=\\\"item.checked && mobile.isMobile\\\" class=name>{{item.pseudo_product.name}}</div> <a ng-if=::!$ctrl.isOffline ng-disabled=\\\"item.checked && mobile.isMobile\\\" class=review-cart-custom-item-link ui-sref=\\\"main.search({search_term: item.pseudo_product.name})\\\" analytics-click=\\\"['list search custom item button', 'click']\\\"> <span class=icon-search aria-hidden=true></span> {{::$ctrl.lang.values.searchThisProduct}} </a> <div class=\\\"action delete-btn-container\\\" ng-if=::mobile.isMobile> <button class=\\\"button icon-trash\\\" ng-click=$ctrl.removeCustomItem(item.pseudo_product.name) name=item-delete analytics-click=\\\"['list product delete confirmation remove button', 'click']\\\" aria-label={{::lang.aria.deleteListItem}}></button> </div> </td> </tr> </tbody> </table> </div> <div class=cart-table__products ng-repeat=\\\"groupName in $ctrl.model.orderedGroups[$ctrl.model.sortType] track by groupName\\\" ng-class=\\\"{'show-mobile-extras': showNotesSubs}\\\"> <h2 class=category-label ng-class=\\\"{'mobile-label': mobile.isMobile}\\\"> <span ng-if=\\\"$ctrl.model.sortType === 'category'\\\">{{groupName}}</span> <span ng-if=\\\"$ctrl.model.sortType === 'aisle'\\\"> {{:: $ctrl.lang.template($ctrl.lang.values.aisleLabel, {aisleText: groupName})}} </span> </h2> <table class=table data-test=in-store-list-items-table role=presentation> <tbody> <tr ng-repeat=\\\"item in $ctrl.model.sortedProductsBy[$ctrl.model.sortType][groupName] track by $index\\\" id=checkout-cart-item-{{item.store_product.id}} class=\\\"row item\\\" ng-init=\\\"item.showDeleteConfirm = false\\\" ng-if=\\\"(!item.store_product.product_type || item.store_product.product_type !== 'subscription') && item.quantity > 0\\\" ng-class=\\\"{\\n                                                'show-delete-confirm': item.showDeleteConfirm,\\n                                                'out-of-stock': $ctrl.isItemCurrentlyOutOfStock(item)\\n                                            }\\\" data-test=in-store-list-items-table-item> <td class=item-checkbox> <div ng-if=::mobile.isMobile class=completed> <input ng-disabled=$ctrl.isItemCurrentlyOutOfStock(item) id=checkoff-{{$index}}-{{item.store_product.id}} class=checkbox ng-model=item.checked ng-change=$ctrl.checkItem(item) type=checkbox data-test=item-checkbox-input> <label for=checkoff-{{$index}}-{{item.store_product.id}} class=\\\"name item-checkbox-label\\\"></label> </div> <div ng-if=::!mobile.isMobile> <button class=\\\"button smaller round darker icon-delete\\\" ng-click=\\\"item.showDeleteConfirm = true\\\" name=item-delete-trigger analytics-click=\\\"['list product delete button', 'click']\\\" aria-label={{::lang.aria.deleteListItem}} data-test=item-delete-trigger-button ng-disabled=item.showDeleteConfirm></button> </div> <div class=delete-confirm ng-show=item.showDeleteConfirm> <div class=label>{{::$ctrl.lang.values.wantToRemove}}</div> <button ng-click=\\\"item.quantity = item.quantity || 1; item.showDeleteConfirm = false\\\" class=\\\"button smaller dark\\\" name=item-delete-cancel analytics-click=\\\"['list product delete confirmation cancel button', 'click']\\\"> {{::$ctrl.lang.values.cancel}} </button> <button ng-click=\\\"$ctrl.removeItem(item, true)\\\" class=\\\"button smaller highlight\\\" name=item-delete-confirm analytics-click=\\\"['list product delete confirmation remove button', 'click']\\\" data-test=item-delete-confirm-button> {{::$ctrl.lang.values.remove}} </button> </div> </td> <td ng-disabled=item.showDeleteConfirm class=product-image-and-details-container> <div class=product-details-and-image> <div ng-disabled=\\\"(mobile.isMobile && item.checked )\\\" ng-click=\\\"!item.checked && $ctrl.goToProductDetailsModal(item)\\\" aria-label=\\\"{{lang.aria.openModal + ' ' + item.store_product.name}}\\\" name=item-image-link analytics-click=\\\"['list product link', 'click']\\\" ng-class=\\\"{ 'item-is-checked': item.checked }\\\"> <div class=\\\"item-image product-image\\\" ng-if=::!$ctrl.isOffline ng-attr-style=\\\"background-image: url('{{$ctrl.imageURLService.getProductImageURL(item.store_product, 'small')}}')\\\"></div> <img class=item-image ng-if=::$ctrl.isOffline ng-src=\\\"{{$ctrl.imageURLService.getProductImageURL(item.store_product, 'small')}}\\\" fallback-src={{$ctrl.getDefaultProductImage()}} /> </div> <div class=\\\"product-details product-meta\\\" ng-class=\\\"{ 'item-is-checked': item.checked }\\\"> <div class=product-meta ng-disabled=\\\"(mobile.isMobile && item.checked)\\\"> <button type=button class=name ng-disabled=\\\"(mobile.isMobile && item.checked ) || item.showDeleteConfirm\\\" ng-click=\\\"!item.checked && $ctrl.goToProductDetailsModal(item)\\\" name=item-title-link analytics-click=\\\"['list product link', 'click']\\\" ng-bind-html=$ctrl.cartService.getItemDescription(item) aria-label={{::lang.aria.goToProductDetail}}></button> <div class=configurable-values-container ng-if=item.product_config.options.length> <p class=configurable-values compile=\\\"$ctrl.configurableProductService.configsString(item, true)\\\"> </p> </div> <react-fulfillment-banner store-product=item.store_product></react-fulfillment-banner> <div ng-if=::mobile.isMobile class=price-quantity> <div product-prices product=item.store_product unit-price=item.unit_price></div> <div ng-if=!$ctrl.isItemCurrentlyOutOfStock(item) modify-quantity item=item increment-fn=$ctrl.incrementItem(item) decrement-fn=$ctrl.decrementItem(item) on-update=\\\"$ctrl.updateItemQuantity(item, $originalQuantity, $onZeroFn)\\\" on-zero-fn=\\\"item.showDeleteConfirm = true\\\" include-zero=true analytics-name=\\\"list product\\\" disable-input=\\\"(item.checked && mobile.isMobile)\\\"></div> <div class=offer-tag ng-if=$ctrl.cartService.itemHasOffer(item)></div> </div> <div product-points product=item.store_product class=small></div> </div> <div ng-if=!$ctrl.isItemCurrentlyOutOfStock(item) product-comments item=item disable-input=\\\"(mobile.isMobile && item.checked) || item.showDeleteConfirm\\\" product-comment-callback=$ctrl.updateItemComment(item) ng-class=\\\"{ 'item-is-checked': item.checked }\\\" class=instore-item-comment></div> <div ng-if=$ctrl.isItemCurrentlyOutOfStock(item)> <span class=out-of-stock-text uib-popover-html=$ctrl.outOfStockWarningPopover popover-trigger=\\\"mouseenter focus\\\" popover-enable=\\\"$ctrl.isItemCurrentlyOutOfStock(item) && !mobile.isMobile\\\" tabindex=\\\"{{$ctrl.isItemCurrentlyOutOfStock(item) ? '0' : '-1'}}\\\"> {{::lang.values.outOfStock}} <i class=\\\"icon icon-info-i\\\" aria-hidden=true></i> </span> </div> </div> <div class=\\\"action delete delete-btn-container\\\" ng-if=::mobile.isMobile> <button class=\\\"button icon-trash\\\" ng-click=$ctrl.removeItem(item) name=item-delete analytics-click=\\\"['list product delete button', 'click']\\\" aria-label={{::lang.aria.deleteListItem}}></button> </div> </div> </td> <td ng-if=::!mobile.isMobile class=offer> <div class=offer-tag ng-if=$ctrl.cartService.itemHasOffer(item)></div> </td> <td class=prices ng-if=::!mobile.isMobile ng-disabled=item.showDeleteConfirm> <div product-prices product=item.store_product unit-price=item.unit_price></div> </td> <td ng-if=::!mobile.isMobile ng-disabled=item.showDeleteConfirm class=product-quantity> <div class=wrapper ng-if=!$ctrl.isItemCurrentlyOutOfStock(item)> <div class=cosmetic><span aria-hidden=true>&times;</span></div> <div modify-quantity item=item increment-fn=$ctrl.incrementItem(item) decrement-fn=$ctrl.decrementItem(item) on-update=\\\"$ctrl.updateItemQuantity(item, $originalQuantity, $onZeroFn)\\\" on-zero-fn=\\\"item.showDeleteConfirm = true\\\" include-zero=true analytics-name=\\\"list product\\\" disable-input=item.showDeleteConfirm></div> <div class=cosmetic><span aria-hidden=true>=</span></div> </div> </td> <td ng-if=::!mobile.isMobile class=product-total ng-disabled=item.showDeleteConfirm name=item-subtotal> <span ng-if=::!$ctrl.isItemCurrentlyOutOfStock(item)> {{item.subtotal | currency}} </span> </td> </tr> </tbody> </table> </div> <div class=\\\"cart-table__offers-container table\\\" id=offers-table ng-if=\\\"$ctrl.hasCartItems() && $ctrl.cartService.cart.offer_progress.length > 0\\\"> <div id=cart-offers class=cart-offers> <h2 class=offer-heading ng-if=::$ctrl.isOffline>{{::$ctrl.lang.values.offersAndTotalUpdateOnline}}</h2> <h2 class=offer-heading ng-class=\\\"::{'disabled' : $ctrl.isOffline}\\\"><span aria-hidden=true class=offer-tag></span> {{::lang.values.offersApplicableToOrder}}</h2> <div class=offers> <ul class=\\\"ul-el offers-list\\\"> <li class=li-el ng-repeat=\\\"offer in $ctrl.cartService.cart.offer_progress\\\" ng-if=offer.offer.name ng-disabled=::$ctrl.isOffline offer-tile=offer location=\\\"Cart Item Offer\\\" disable-coupon-clipping=::$ctrl.isOffline></li> </ul> </div> </div> </div> <div class=\\\"table new-checkout__footer\\\" ng-if=\\\"::!$ctrl.config.newCheckoutFlow.cartReviewPage.enabled && !mobile.isMobile\\\"> <div class=totals-discounts> <div class=content> <div class=discount ng-if=\\\"config.inStoreList.showTotalOffersDiscount && ($ctrl.cartService.cart.offer_total | number) > 0 || config.showZeroDiscount\\\"> <div class=amount>{{$ctrl.cartService.cart.offer_total | currency}}</div> <div class=label>{{::$ctrl.lang.values.totalOfferDiscount}}:</div> </div> <div class=points-total ng-if=\\\"::(config.hasLoyaltyPoints && config.showPointsGained)\\\"> <div class=amount>{{($ctrl.cartService.cart.points.awarded || 0) | number}}</div> <div class=label>{{::$ctrl.lang.values.pointsGained}}:</div> </div> <div class=subtotal> <div class=amount>{{$ctrl.cartService.getCartTotalForCurrentType() | currency}}</div> <div class=label> {{::$ctrl.lang.values.subtotal}}: <div class=asterix>{{::$ctrl.lang.values.excludesTaxesAndFees}}</div> </div> </div> </div> </div> <div class=right> <button id=checkout-cart-bottom-order-online class=\\\"button right\\\" analytics-click=\\\"['list bottom continue button ', 'click']\\\" ng-if=\\\":: $ctrl.showOrderOnlineButton\\\" ng-click=$ctrl.openShoppingSelectorModal()> {{::$ctrl.lang.values.orderOnline}} </button> </div> </div> </div> </div> </div> </div> <fulfillment-list ng-if=$ctrl.onlineCartHasItems()></fulfillment-list> </div> </div> <div ng-if=$ctrl.model.isLoading class=view-loading-indicator></div> <div ng-if=::mobile.isMobile ng-class=\\\"{\\n        'new-checkout-custom-item-bump': $ctrl.onlineCartHasItems(),\\n        'with-context-selector': $ctrl.config.newCheckoutFlow.cartReviewPage.enableContextSelectionOnMobile\\n      }\\\" class=add-custom-item> <div role=button class=toggle-button ng-click=$ctrl.plusButtonClicked(); aria-label={{::$ctrl.lang.aria.addCustomItem}} analytics-click=\\\"['instore list review add custom item button', 'click']\\\"></div> <form ng-class=\\\"{show: $ctrl.model.showAddCustom}\\\" class=action-sheet ng-submit=\\\"$ctrl.addNewCustomItem($ctrl.newCustomItem.name); $ctrl.toggleAddCustom(false);\\\"> <label>{{::$ctrl.lang.values.customItem}}</label> <input type=text id=add-custom-item-input class=input ng-blur=$ctrl.customItemOnBlur() ng-model=$ctrl.newCustomItem.name placeholder=\\\"Type in an item...\\\" aria-label={{::$ctrl.lang.aria.typeInAnItem}}> <span ng-if=::$ctrl.config.enableBarcodeScanner barcode-scanner-button class=icon-scanner role=button aria-label=\\\"Scan Barcode\\\"></span> </form> <div role=button prevent-all-scrolling class=action-sheet-backdrop ng-click=$ctrl.toggleAddCustom(false) ng-class=\\\"{show: $ctrl.model.showAddCustom}\\\"></div> </div> <div class=mobile-flyer-side-cart-actions fixed-to-body ng-if=\\\"::mobile.isMobile && !$ctrl.config.newCheckoutFlow.cartReviewPage.enabled\\\"> <div class=total> <div class=row> <span class=label>{{::$ctrl.lang.values.estimatedTotal}}</span> <span class=value>{{$ctrl.cartService.getCartTotalForCurrentType() | currency}}</span> </div> <div class=row ng-if=\\\"::($ctrl.config.hasLoyaltyPoints && $ctrl.config.showPointsGained)\\\"> <span class=\\\"label points\\\">{{::$ctrl.lang.values.estPoints}}</span> <span class=\\\"value points\\\">+ {{($ctrl.cartService.cart.points.awarded || 0) | number}}</span> </div> </div> </div> </div> \";","module.exports = \"<span ng-include=\\\"'fulfillmentList.desktop.html'\\\" ng-if=::!mobile.isMobile></span> <span ng-include=\\\"'fulfillmentList.mobile.html'\\\" ng-if=::mobile.isMobile></span> \";","module.exports = \"<div class=cart-list-transfer> <div ng-if=\\\"::!$ctrl.mobile.isMobile && !$ctrl.shouldRedirectToDotCom\\\" class=modal-header ng-class=\\\"{'pickup-context': $ctrl.updatedContext == 'pickup', 'delivery-context': $ctrl.updatedContext == 'delivery', 'instore-context': $ctrl.updatedContext == 'instore'}\\\"> <div class=icon ng-class=\\\"{'icon-pickup': $ctrl.updatedContext == 'pickup', 'icon-list': $ctrl.updatedContext == 'instore', 'icon-delivery': $ctrl.updatedContext == 'delivery'}\\\"></div> </div> <div class=shopping-context-main-content> <div ng-class=\\\"{'pickup-context': $ctrl.updatedContext == 'pickup', 'delivery-context': $ctrl.updatedContext == 'delivery', 'instore-context': $ctrl.updatedContext == 'instore'}\\\"> <div ng-if=::$ctrl.mobile.isMobile> <div class=icon ng-class=\\\"{\\n            'icon-pickup': $ctrl.updatedContext == 'pickup',\\n            'icon-list': $ctrl.updatedContext == 'instore',\\n            'icon-delivery': $ctrl.updatedContext == 'delivery'\\n          }\\\"></div> </div> <div data-test=custom-cart-compare-message class=\\\"message warn custom-cart-compare-message\\\" ng-if=\\\"\\n          $ctrl.config.customCartCompare.enabled &&\\n          $ctrl.cartListTransferService.transferData &&\\n          $ctrl.cartListTransferService.transferData.customCartCompare &&\\n          $ctrl.cartListTransferService.transferData.customCartCompare.message\\n        \\\"> <span class=icon-warning aria-hidden=true></span> {{ $ctrl.cartListTransferService.transferData.customCartCompare.message }} </div> <h1>{{::$ctrl.cartListTransferTitle}}</h1> <p>{{::$ctrl.cartListTransferMsg}}</p> <p>{{::$ctrl.cartListTransferFollowUp}}</p> <div class=cart-list-transfer-buttons> <button ng-if=\\\":: ($ctrl.numTransferable > 0)\\\" ng-click=$ctrl.transferItems() ng-disabled=$ctrl.transferStatus.inProgress ng-hide=\\\"$ctrl.hideButton.yes && $ctrl.transferStatus.inProgress\\\" id=cart-list-transfer-items class=button data-test=cart-transfer-button> {{:: $ctrl.lang.template($ctrl.lang.values.transferBetweenCartAndList.yesTransferItems, { numTransferable: $ctrl.numTransferable })}} </button> <span ng-if=\\\"$ctrl.hideButton.yes && $ctrl.transferStatus.inProgress\\\" class=small-loading-indicator> <img ng-src=\\\"{{ $ctrl.loadImg('loading-small.svg') }}\\\" alt=Loading /> </span> <button ng-click=\\\"$ctrl.hideButton.no = true; $ctrl.completeContextSwitch()\\\" ng-disabled=$ctrl.transferStatus.inProgress ng-hide=\\\"$ctrl.hideButton.no && $ctrl.transferStatus.inProgress\\\" id=cart-list-skip-transfer class=button ng-class=\\\"::{ 'hollow': ($ctrl.numTransferable > 0) }\\\"> {{:: $ctrl.doNotTransferTxt}} </button> <span ng-if=\\\"$ctrl.hideButton.no && $ctrl.transferStatus.inProgress\\\" class=small-loading-indicator> <img ng-src=\\\"{{ $ctrl.loadImg('loading-small.svg') }}\\\" alt=Loading /> </span> <button ng-click=$ctrl.cancelContextSwitch() ng-disabled=$ctrl.transferStatus.inProgress class=\\\"button empty\\\" id=cart-list-cancel-context-switch> {{::$ctrl.stayInShoppingModeText}} </button> </div> </div> </div> </div> \";","module.exports = \"<react-subscription-page initial-subscription-code=::initialSubscriptionCode on-add-subscription-plan-click=(onAddSubscriptionPlanClick) on-redeem-subscription-success=(onRedeemSubscriptionSuccess)></react-subscription-page> \";","module.exports = \" <div ng-if=isLoading class=profile-page-loading> <react-lazy-loading-indicator/> </div> <div ng-if=!isLoading> <ic-express-profile username={{auth.user.first_name}} membership-status=express.getMembershipStatus() use-ic-theme=!config.icExpress.enableRetailerTheme ng-if=\\\"express.isPlacementConfigEnabled(IC_PLACEMENTS.PROFILE) && mobileService.isMobile\\\"></ic-express-profile> <div class=express-profile-page> <div ng-if=express.topMessage class=\\\"express-profile-page__message message success\\\"> <span class=icon-checkmark-circle aria-hidden=true></span> <div class=express-profile-page__message-title>{{express.topMessage.title}}</div> <div class=express-profile-page__message-body> {{express.topMessage.message}} <a ng-click=express.dismissMessage(MESSAGE_PLACEMENTS.TOP)> {{::lang.values.dismiss}} </a> </div> </div> <div ng-if=showCouponMessage() class=express-profile-page__message-coupon> <span class=\\\"express-profile-page__message-coupon-icon icon-info-i\\\" aria-hidden=true></span> <div class=express-profile-page__message-coupon-body ng-bind-html=\\\"lang.template(\\n                    lang.values.icExpress.couponDurationText,\\n                    { date: membershipEndDate() }\\n                )\\\"> </div> </div> <h2 class=\\\"express-profile-page__title section-divider-small\\\"> <span class=title>{{::lang.values.membershipPlan}}</span> <a ng-if=membershipStatus().active ui-sref=main.icExpressCancel ng-disabled=isCoupon() class=\\\"express-profile-page__button alert\\\"> {{:: lang.values.cancelMembership }} </a> </h2> <div class=express-profile-page__content data-test=express-profile-page__content> <div ng-if=express.membershipMessage class=\\\"express-profile-page__message message success\\\"> <span class=icon-checkmark-circle aria-hidden=true></span> <div class=express-profile-page__message-title> {{express.membershipMessage.title}} <button class=\\\"close-button icon-delete\\\" ng-click=express.dismissMessage(MESSAGE_PLACEMENTS.MEMBERSHIP)> </button> </div> <div class=express-profile-page__message-body> {{express.membershipMessage.message}} </div> </div> <div class=express-profile-page__membership-block ng-if=isTrial()> <p> <span class=express-profile-page__membership-heading>Free Trial</span> <span class=\\\"express-badge badge-success\\\"> {{getTrialRemainingDays()}} days remaining </span> </p> <p> <span ng-bind-html=\\\"lang.template(lang.values.icExpress.trialRemainingDays, { days: getTrialRemainingDays() })\\\"></span> <br> <span ng-if=\\\"membershipStatus().active && express.userCurrentSubscription.subscription.send_reminder_on\\\" ng-bind-html=\\\"lang.template(\\n                        lang.values.icExpress.getReminderBeforeRenew, {days: 3}\\n                    )\\\"></span> <span ng-if=!membershipStatus().active ng-bind-html=\\\"lang.template(\\n                        lang.values.icExpress.notRenewForPlan, {plan: config.icExpress.name}\\n                    )\\\"></span> </p> </div> <div class=express-profile-page__membership-block ng-if=!isTrial()> <p> <span class=express-profile-page__membership-heading> <span ng-if=!isTrial()>{{getCurrentSubscription().name}}</span><span ng-if=isTrial()>{{getNextSubscriptionPlan().name}}</span> Plan </span> <span class=\\\"express-badge badge-success\\\" ng-if=membershipStatus().active> <span ng-if=getNextSubscriptionPlan().id> {{express.getMembershipRemainingString()}} remaining </span> <span ng-if=!getNextSubscriptionPlan().id> Active </span> </span> </p> <p> Your <span ng-if=isTrial()>free trial</span><span ng-if=!isTrial()>membership</span> expires <b>{{membershipEndDate()}}</b> <br> <span ng-if=\\\"isAutoRenew() && express.userCurrentSubscription.subscription.send_reminder_on\\\" ng-bind-html=\\\"lang.template(\\n                        lang.values.icExpress.getReminderBeforeRenew, {days: 3}\\n                    )\\\"></span> </p> </div> <div class=express-profile-page__membership-block ng-if=showNextPlanSection()> <p> <span class=express-profile-page__membership-heading> {{getNextSubscriptionPlan().name}} Plan <span ng-if=getNextSubscriptionPlan().promo> {{config.currencySymbol}}{{getNextSubscriptionPlan().price}} </span> </span> <span class=express-badge> Activates on {{getNextPlanDate().format('MMMM D, YYYY')}} </span> </p> <p> {{ nextPlanDescriptionText() }} </p> </div> <div> <a ng-if=showChangePlanButton() ng-click=openPlansModalNew() class=express-profile-page__button> {{::lang.values.changeMyPlan}} </a> </div> <react-express-promo-plan-change ng-if=shouldShowPromoPlanChange() promo-plan=getPromoPlan() on-button-click=openPromoPlanChangeModal></react-express-promo-plan-change> </div> <h2 class=\\\"express-profile-page__title section-divider-small\\\"> <span class=title>{{::lang.values.payment}}</span> </h2> <div ng-if=express.paymentMessage class=\\\"express-profile-page__message message success\\\"> <span class=icon-checkmark-circle aria-hidden=true></span> <div class=express-profile-page__message-title>{{express.paymentMessage.title}}</div> <div class=express-profile-page__message-body> {{ express.paymentMessage.message }} <button class=\\\"close-button icon-delete\\\" ng-click=express.dismissMessage(MESSAGE_PLACEMENTS.PAYMENT)> </button> </div> </div> <div class=express-profile-page__content> <div ng-if=isAutoRenew() class=express-profile-page__payment-block> <p> {{getNextPaymentString()}} <b>{{getNextPlanString()}}</b> <br/> <span ng-if=express.userCurrentSubscription.subscription.send_reminder_on> {{getReminderString()}} </span> </p> </div> <div ng-if=isAutoRenew()> <a ng-click=toggleReminder() ng-disabled=isCoupon() class=express-profile-page__button> <span ng-if=!express.userCurrentSubscription.subscription.send_reminder_on>{{::lang.values.turnOnReminder}}</span> <span ng-if=express.userCurrentSubscription.subscription.send_reminder_on>{{::lang.values.turnOffReminder}}</span> </a> </div> <div class=block-list> <div class=block ng-if=config.icExpress.showExpressRenewByGiftcard> <div class=block-content> <div class=block-preview> {{:: lang.values.expressGiftcardCTA }} </div> <div class=block-actions> <a class=express-profile-page__button ng-click=openGiftCardRedeemModal()>Redeem</a> </div> </div> </div> <div class=block> <div class=block-content> <div class=block-preview> {{ currentCreditCard().provider ? lang.templateAsString( lang.values.creditCardFormat, { name: currentCreditCard().provider, lastFourDigits: currentCreditCard().last_four_digits } ) : lang.values.noCreditCardSelected }} </div> <div class=block-actions> <a class=express-profile-page__button ng-click=openAddCreditCardModal()>{{:: lang.values.changePayment }}</a> </div> </div> </div> </div> </div> </div> </div> \";","module.exports = \"<div class=\\\"modal-container mobile-overflow\\\"> <react-account-import-modal on-import-click=(onImportClick) cancel=(cancel) /> </div> \";","module.exports = \"<div class=fulfillment-not-available-modal> <react-fulfillment-not-available-modal on-continue=(continue) on-close=(close) /> </div> \";","/**\n * Product selectors are designed to be Redux-ready\n */\nimport { createSelector } from 'reselect'\nimport { auth as authService } from '@instacart/enterprise-services'\nimport { LabelTypes, StockLevels, StoreProduct } from '@app/types/product'\nimport { formatCurrency } from '@app/utils/currency'\nimport authSelectors from '@instacart/enterprise-services/auth/selectors'\nimport { getProductImageURL } from '@app/utils/images/productImages'\nimport { ShoppingListItem } from '@app/types/shoppingList'\nimport { FulfillmentType } from '@app/types/config'\nimport interpolate from '@instacart/enterprise-services/lang/interpolate'\nimport dayjs from 'dayjs'\nimport { PromoMarkerProps } from '@app/react/ids/enterprise/molecules/ItemB/ItemPromoMarker'\nimport { SaveForLaterList } from '@app/react/ids/enterprise/organisms/SaveForLater/types'\nimport { configSelector, langAriaSelector, langSelector } from '../config/selectors'\nimport { isMobileSelector } from '../browser/selectors'\nimport { userListsSelector } from '../userList/selectors'\nimport { findItemInList } from '../userList/utils'\n\ntype FormatPriceProps = {\n  price: number\n  quantity: number\n  priceWithNumberTemplate: string\n  unit?: string\n}\n\nconst formatPrice = ({\n  price,\n  quantity,\n  priceWithNumberTemplate,\n  unit,\n}: FormatPriceProps): string => {\n  const priceString = formatCurrency(price)\n\n  if (quantity > 1) {\n    const qty = unit === 'ea' || !unit ? `${quantity}` : `${quantity} ${unit}`\n    return interpolate(priceWithNumberTemplate, { price: priceString, quantity: qty })\n  }\n\n  if (unit) return `${priceString} /${unit}`\n\n  return priceString\n}\n\n// TODO: The current implementation of this selector is a placeholder for when\n// we source products from Redux.\nexport const productSelector = (_state: unknown, props: Record<'product', StoreProduct>) =>\n  props.product\n\n/**\n * Returns the associated ShoppingListItem object, if one exists in the cart.\n * TODO: This selector needs to be updated. Right now it expects you to feed it\n * the ShoppingListItem because right now the shopping cart is not in the main redux\n * store. It's a bit of a hack/placeholder for future implementation. It exists to allow\n * other selectors to use it already.\n */\nexport const shoppingCartItemSelector = (\n  _state: unknown,\n  props: Record<'cartItem', ShoppingListItem | undefined>\n) => props.cartItem\n\nexport const hasLoyaltyCardSelector = (_state: unknown, props: Record<'hasLoyaltyCard', boolean>) =>\n  props.hasLoyaltyCard\n\nexport const promoDiscountSelector = createSelector(\n  productSelector,\n  configSelector,\n  hasLoyaltyCardSelector,\n  langSelector,\n  isMobileSelector,\n  // eslint-disable-next-line max-params\n  (product, config, hasLoyaltyCard, lang, isMobile): PromoMarkerProps | undefined => {\n    const { loyalty_price, promo_tag, sale_price, sale_end_date, loyalty_end_date } = product\n    const { enableLoyaltyPricing, showSaleEndDate } = config\n\n    const result: PromoMarkerProps = {\n      isLoyalty: false,\n      text: '',\n    }\n\n    if (promo_tag) {\n      if (enableLoyaltyPricing && loyalty_price) {\n        result.isLoyalty = true\n\n        if (hasLoyaltyCard) {\n          result.text = promo_tag as string\n\n          if (showSaleEndDate && !isMobile && loyalty_end_date) {\n            result.tooltipText = interpolate(lang.saleEndDate, {\n              endDate: dayjs(loyalty_end_date).format('MMM D'),\n            })\n          }\n        } else {\n          result.text = lang.loyaltyPricing.tag\n\n          if (!isMobile) {\n            result.tooltipText = interpolate(lang.loyaltyPricing.tagTooltip, { promo: promo_tag })\n          }\n        }\n\n        return result\n      }\n      if (sale_price) {\n        result.text = promo_tag as string\n\n        if (showSaleEndDate && !isMobile && sale_end_date) {\n          result.tooltipText = interpolate(lang.saleEndDate, {\n            endDate: dayjs(sale_end_date).format('MMM D'),\n          })\n        }\n\n        return result\n      }\n    }\n\n    return undefined\n  }\n)\n\nexport const promoOfferSelector = createSelector(\n  productSelector,\n  configSelector,\n  langSelector,\n  // eslint-disable-next-line max-params\n  (product, config, lang): PromoMarkerProps | undefined => {\n    const { offer_title, offers } = product\n    const { enableOfferBadgeTypes, enableOfferBadge } = config\n\n    const result: PromoMarkerProps = {\n      isLoyalty: false,\n      text: '',\n    }\n\n    if (offer_title?.length) {\n      result.text = offer_title\n\n      return result\n    }\n\n    const thereAreSupportedOffers = offers?.some(offer =>\n      enableOfferBadgeTypes.includes(offer.offer_type)\n    )\n    if (enableOfferBadge && thereAreSupportedOffers) {\n      result.text = lang.offerInside\n\n      return result\n    }\n\n    return undefined\n  }\n)\n\nexport const promotionsSelector = createSelector(\n  promoDiscountSelector,\n  promoOfferSelector,\n  (discount, offer): PromoMarkerProps[] => [\n    ...(discount ? [discount] : []),\n    ...(offer ? [offer] : []),\n  ]\n)\n\n/**\n * Returns whether or not UOM should be displayed for a given product\n * Takes into account possible whitelist in the config\n */\nexport const shouldShowUOMSelector = createSelector(\n  productSelector,\n  configSelector,\n  (product, config) => {\n    const uom = product?.uom_price?.uom || ''\n    const whitelist = config.displayPriceUnitOfMeasurementAllowlist\n\n    // If the white list is null, consider all uoms ok\n    const enabled = whitelist === null || whitelist?.includes(uom)\n    return Boolean(enabled && uom)\n  }\n)\n\n/**\n * Returns current price per unit, e.g. $0.39/oz\n */\nexport const pricePerUnitStringSelector = createSelector(\n  shouldShowUOMSelector,\n  productSelector,\n  (enabled, product) => {\n    if (!enabled) return undefined\n    if (!product.uom_price) return undefined\n\n    const { price, uom } = product.uom_price\n\n    return `${formatCurrency(price)}/${uom}`\n  }\n)\n\n/**\n * Returns regular/base price without any discounts of promos\n */\nexport const regularPriceSelector = createSelector(productSelector, product => product.base_price)\n\n/**\n * Returns formatted regular price string\n */\nexport const regularPriceStringSelector = createSelector(\n  productSelector,\n  langSelector,\n  (product, lang) => {\n    const { base_price, display_uom, base_quantity } = product\n\n    return formatPrice({\n      price: base_price,\n      priceWithNumberTemplate: lang.priceWithQuantity,\n      quantity: base_quantity,\n      unit: display_uom,\n    })\n  }\n)\n\n/**\n * returns loyalty loyalty price, if set\n */\nexport const loyaltyPriceSelector = createSelector(\n  productSelector,\n  product => product.loyalty_price || undefined\n)\n\n/**\n * Returns formatted loyalty price, if set\n */\nexport const loyaltyPriceStringSelector = createSelector(\n  productSelector,\n  langSelector,\n  (product, lang) => {\n    if (!product.loyalty_price) return\n\n    const { loyalty_price, loyalty_quantity, display_uom } = product\n\n    return formatPrice({\n      price: loyalty_price,\n      priceWithNumberTemplate: lang.priceWithQuantity,\n      quantity: loyalty_quantity || 1,\n      unit: display_uom,\n    })\n  }\n)\n\n/**\n * returns sale price, if set\n */\nexport const salePriceSelector = createSelector(\n  productSelector,\n  product => product.sale_price || undefined\n)\n\n/**\n * returns formatted sale price, if set\n */\nexport const salePriceStringSelector = createSelector(\n  productSelector,\n  langSelector,\n  (product, lang) => {\n    const { sale_price, sale_quantity, display_uom } = product\n\n    if (!sale_price) return\n\n    return formatPrice({\n      price: sale_price,\n      priceWithNumberTemplate: lang.priceWithQuantity,\n      quantity: sale_quantity || 1,\n      unit: display_uom,\n    })\n  }\n)\n\n/**\n * Returns the current price which in the following order:\n * 1) Loyalty Price\n * 2) Sale Price\n * 3) Regular Price\n */\nexport const currentPriceSelector = createSelector(\n  regularPriceSelector,\n  salePriceSelector,\n  loyaltyPriceSelector,\n  (regularPrice, salePrice, loyaltyPrice): number => {\n    return loyaltyPrice || salePrice || regularPrice\n  }\n)\n\n/**\n * Returns the formatted current price\n */\nexport const currentPriceStringSelector = createSelector(\n  regularPriceStringSelector,\n  salePriceStringSelector,\n  loyaltyPriceStringSelector,\n  (regularPrice, salePrice, loyaltyPrice) => {\n    return loyaltyPrice || salePrice || regularPrice\n  }\n)\n\n/**\n * Returns whether or not the product has promo pricing,\n * e.g. sale or loyalty pricing. Does not take other offers\n * into consideration\n */\nexport const hasPromoPriceSelector = createSelector(\n  loyaltyPriceSelector,\n  salePriceSelector,\n  (loyalty, sale) => Boolean(loyalty || sale)\n)\n\n/*\n * Indicates that current price has confirmed discount that comes from sale promo type or\n * loyalty type + loyalty card on file\n */\nexport const discountedPriceIsConfirmedSelector = createSelector(\n  promoDiscountSelector,\n  hasLoyaltyCardSelector,\n  (promo, hasLoyaltyCard): boolean =>\n    (promo?.isLoyalty === true && hasLoyaltyCard) || promo?.isLoyalty === false\n)\n\n/**\n * Returns whether the product is available or out of stock\n */\nexport const isAvailableSelector = createSelector(\n  productSelector,\n  configSelector,\n  (product, config) => {\n    if (!config.enableOutOfStockUIBehaviour) {\n      return true\n    }\n    const stockLevel = product.availability?.stock_level\n\n    return stockLevel !== StockLevels.OUT_OF_STOCK\n  }\n)\n\n/**\n * Returns whether the product can be customized\n */\nexport const isCustomizableSelector = createSelector(productSelector, product =>\n  Boolean(product.product_config?.options?.length)\n)\n\n/**\n * Check against config, if the item can be added to cart regardless of its stock level\n */\nexport const allowOutOfStockAddSelector = createSelector(\n  authService.selectors.getUserIntent,\n  configSelector,\n  (intent, { enableOutOfStockAddToCartContexts }) =>\n    Boolean(intent && enableOutOfStockAddToCartContexts?.includes(intent))\n)\n\nexport const showPriceAlertSelector = createSelector(\n  configSelector,\n  authSelectors.getUser,\n  (config, user): boolean =>\n    !(\n      config.disablePriceAlerts ||\n      config.disablePriceAlertsOnProductCells ||\n      !user?.status ||\n      user?.status === 'trial'\n    )\n)\n\nexport const showSaveForLaterSelector = createSelector(\n  configSelector,\n  authSelectors.getUser,\n  productSelector,\n  (config, user, product) =>\n    !(\n      config.disableSaveForLaterLists ||\n      product.product_config ||\n      !user?.status ||\n      user?.status === 'trial'\n    )\n)\n\n/**\n * Returns the quantity of the product in the shopping cart\n */\nexport const quantityInCartSelector = createSelector(\n  shoppingCartItemSelector,\n  shoppingCartItem => shoppingCartItem?.quantity || 0\n)\n\n/**\n * Return maximum allowed quantity of the product in the cart\n */\nexport const maxQuantitySelector = createSelector(\n  productSelector,\n  product => product?.ext_data?.max_in_cart ?? product.ordering_parameters.max\n)\n\n/**\n * Returns minimum allowed quantity of the product in the cart\n */\nexport const minQuantitySelector = createSelector(\n  productSelector,\n  product => product.ordering_parameters.min\n)\n\n/**\n * Returns the quantity of product each cart add will increment by\n */\nexport const incrementQuantitySelector = createSelector(\n  productSelector,\n  product => product.ordering_parameters.increment\n)\n\n/**\n * Returns the quantity of product that will be\n * added to cart if no specific quantity is requested.\n * If the product is in the cart already, will be equal to\n * increment quantity. Otherwise, return minimum cart quantity\n */\nexport const defaultAddToCartQty = createSelector(\n  incrementQuantitySelector,\n  minQuantitySelector,\n  quantityInCartSelector,\n  (increment, min, qtyInCart) => {\n    return qtyInCart > 0 ? increment : min\n  }\n)\n\nexport const orderByUnitSelector = createSelector(\n  productSelector,\n  product => product.ordering_parameters.display_name\n)\n\nexport const ratingSelector = createSelector(\n  productSelector,\n  product => product.product_rating.average_rating\n)\n\nexport const numberOfRatingsSelector = createSelector(\n  productSelector,\n  product => product.product_rating.user_count\n)\n\nexport const sizeSelector = createSelector(\n  productSelector,\n  product => product.size_string || undefined\n)\n\nexport const sizeWithPricePerUnitSelector = createSelector(\n  sizeSelector,\n  pricePerUnitStringSelector,\n  (size, pricePerUnit) => {\n    if (size && pricePerUnit) {\n      return `${size} (${pricePerUnit})`\n    }\n\n    return size || pricePerUnit\n  }\n)\n\nexport const subscribedForPriceAlertSelector = createSelector(productSelector, product =>\n  Boolean(product.price_alert)\n)\n\n/**\n * Returns whether or not the product is allowed\n * to be added to cart. Takes into account max order quantity\n * and product availability\n */\nexport const allowAddToCartSelector = createSelector(\n  defaultAddToCartQty,\n  maxQuantitySelector,\n  isAvailableSelector,\n  allowOutOfStockAddSelector,\n  quantityInCartSelector,\n  (_arg0: unknown, props: Record<'addToCartQty', number | undefined>) => props.addToCartQty,\n  // eslint-disable-next-line max-params\n  (defaultQtyToAdd, max, isAvailable, allowOOS, currentQty, qtyToAdd) => {\n    const newQty = currentQty + (qtyToAdd || defaultQtyToAdd)\n    return Boolean(newQty <= max && (isAvailable || allowOOS))\n  }\n)\n\nexport const allowDecrementCartQuantitySelector = createSelector(\n  quantityInCartSelector,\n  minQuantitySelector,\n  (qty, min) => qty >= min\n)\n\nexport const decrementCartQuantityType = createSelector(\n  quantityInCartSelector,\n  minQuantitySelector,\n  (qty, min) => (qty > min ? 'subtract' : 'trash')\n)\n\n// TODO: Implement existing logic from Angular\nexport const titleSelector = createSelector(productSelector, langSelector, (product, lang) => {\n  if (product.average_weight) {\n    const averageWeight = interpolate(lang.avgWeight, {\n      product: product.average_weight,\n      unit: product.display_uom,\n    })\n    return `${product.name} (${averageWeight})`\n  }\n\n  return product.name\n})\n\nexport const aisleSelector = createSelector(productSelector, product => product.aisle || undefined)\n\n/**\n * addToCart Aria label\n */\nexport const addToCartLabelSelector = createSelector(\n  authService.selectors.getUserIntent,\n  langSelector,\n  (intent, lang) => {\n    if (intent === FulfillmentType.InStore) {\n      return lang.addToListButtonLabel\n    }\n    // TODO: Modifying order\n    // return $rootScope.modifyingOrder ? lang.addToOrderButtonLabel : lang.addToCartButtonLabel\n    return lang.addToCartButtonLabel\n  }\n)\n\nexport const featuredLabelSelector = createSelector(\n  configSelector,\n  langSelector,\n  (_state: unknown, props: Record<'featured', boolean>) => props.featured,\n  (config, lang, isFeatured) => {\n    if (!isFeatured || !config.showFeaturedLabel) return undefined\n\n    return lang.featured\n  }\n)\n\n/**\n * Returns the text for the \"Sponsored\" label\n * It could either be the default language or custom text depending on\n * who sponsored the product.\n */\nexport const sponsoredLabelSelector = createSelector(\n  productSelector,\n  configSelector,\n  langSelector,\n  (product, config, lang) => {\n    if (!product.sponsored || !config.showSponsoredLabel || product.sponsoredLabel === false)\n      return undefined\n\n    if (product.sponsoredBy && Object.keys(lang.sponsoredBy).includes(product.sponsoredBy)) {\n      return lang.sponsoredBy[product.sponsoredBy as keyof typeof lang.sponsoredBy]\n    }\n\n    return lang.sponsored\n  }\n)\n\nexport const previouslyPurchasedSelector = createSelector(productSelector, product =>\n  product.tags.includes('purchased')\n)\n\nexport const previouslyPurchasedLabelSelector = createSelector(\n  previouslyPurchasedSelector,\n  configSelector,\n  (showLabel, config) => (showLabel ? config.buyItAgain.displayName : undefined)\n)\n\n/**\n * Returns the label text, e.g. \"Featured\" or \"Buy it again\".\n */\nexport const labelSelector = createSelector(\n  featuredLabelSelector,\n  sponsoredLabelSelector,\n  previouslyPurchasedLabelSelector,\n  (featured, sponsored, previouslyPurchased) => {\n    return featured || sponsored || previouslyPurchased\n  }\n)\n\nexport const labelTypeSelector = createSelector(\n  featuredLabelSelector,\n  sponsoredLabelSelector,\n  previouslyPurchasedLabelSelector,\n  (featured, sponsored, previouslyPurchased) => {\n    if (featured) return LabelTypes.Featured\n    if (sponsored) return LabelTypes.Sponsored\n    if (previouslyPurchased) return LabelTypes.Purchased\n    return undefined\n  }\n)\n\n// Item Tile-specific selectors\n\nexport const itemTileLangSelector = createSelector(\n  langSelector,\n  langAriaSelector,\n  addToCartLabelSelector,\n  (lang, langAria, addToCart) => ({\n    accessibleLabel: addToCart,\n    addPriceAlert: lang.addPriceAlert,\n    customizable: lang.customizable,\n    decrementQuantity: lang.decrementQuantity,\n    incrementQuantity: lang.incrementQuantity,\n    item: lang.item,\n    or: lang.or,\n    quantity: lang.quantity,\n    removeItem: lang.removeItem,\n    removePriceAlert: lang.removePriceAlert,\n    reviews: lang.reviews,\n    togglePriceAlert: langAria.togglePriceAlert,\n  })\n)\n\nexport const saveForLaterLangSelector = createSelector(\n  langSelector,\n  langAriaSelector,\n  (lang, langAria) => ({\n    ariaAddedToList: langAria.addedToList,\n    ariaCloseButton: langAria.modalClose,\n    ariaCreateList: langAria.createList,\n    ariaEditList: langAria.editList,\n    ariaLoading: langAria.loading,\n    ariaPopoverDisclosure: `${\n      // TODO $ctrl.productsAreInOneList() && $ctrl.products.length !== 0 ? lang.addedTo : lang.addTo\n      lang.addTo\n    } ${lang.saveForLaterLists}`,\n    ariaPopoverLabel: langAria.saveItemForLater,\n    closeModalActionLabel: lang.close,\n    createListInputLabel: lang.createANewList,\n    createListInputPlaceholderText: lang.enterNewListName,\n    editListActionLabel: lang.edit,\n    popoverTitle: lang.saveForLater,\n    tooltipText: `${lang.addTo} ${lang.saveForLaterLists}`,\n  })\n)\n\nexport const itemTileImageSizeSelector = createSelector(isMobileSelector, isMobile =>\n  isMobile ? 'medium' : 'small'\n)\n\nexport const itemTileImageSelector = createSelector(\n  productSelector,\n  itemTileImageSizeSelector,\n  (product, imageSize) => getProductImageURL(product, imageSize)\n)\n\nexport const saveForLaterListsSelector = createSelector(\n  productSelector,\n  userListsSelector,\n  (product, userLists) =>\n    userLists.map(\n      userList =>\n        // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n        ({\n          ...userList,\n          selected: findItemInList(product, userList),\n        } as SaveForLaterList)\n    )\n)\n","module.exports = \"<nav aria-label=page> <ul class=pagination ng-init=\\\"middleval = $root.config.maxPaginationLinks % 2 == 0 ? $root.config.maxPaginationLinks : ($root.config.maxPaginationLinks + 1) / 2;\\\" role=group> <li ng-if=::directionLinks ng-class=\\\"{disabled: noPrevious()||ngDisabled}\\\" class=pagination-prev> <button class=\\\"button small round\\\" ng-click=\\\"selectPage(page - 1, $event)\\\" aria-label=\\\"{{ $root.config.lang.previous }}\\\"> <span class=icon-chevron-left></span> </button> </li> <li ng-if=\\\"::boundaryLinks && totalPages > $root.config.maxPaginationLinks &&  page > middleval\\\" ng-class=\\\"{disabled: noPrevious()||ngDisabled}\\\" class=\\\"pagination-first pager-item\\\"> <button ng-click=\\\"selectPage(1, $event)\\\">{{::getText('first')}}</button> </li> <li ng-if=\\\"totalPages > $root.config.maxPaginationLinks && page > middleval + 1\\\" class=\\\"dots pager-item pagination-page\\\"> ... </li> <li ng-repeat=\\\"page in pages track by $index\\\" ng-class=\\\"{active: page.active,disabled: ngDisabled && !page.active}\\\" class=\\\"pagination-page pager-item\\\" aria-current=\\\"{page: page.active, disabled: ngDisabled && !page.active}\\\"> <button ng-click=\\\"selectPage(page.number, $event)\\\">{{page.text}}</button> </li> <li ng-if=\\\"totalPages > $root.config.maxPaginationLinks && page < totalPages - middleval\\\" class=\\\"dots pagination-page pager-item\\\"> ... </li> <li ng-if=\\\"::boundaryLinks && totalPages > $root.config.maxPaginationLinks &&  page < totalPages + 1 - middleval\\\" ng-class=\\\"{disabled: noNext()||ngDisabled}\\\" class=\\\"pagination-last pager-item\\\"> <button ng-click=\\\"selectPage(totalPages, $event)\\\">{{::totalPages}}</button> </li> <li ng-if=::directionLinks ng-class=\\\"{disabled: noNext()||ngDisabled}\\\" class=pagination-next> <button class=\\\"button small round\\\" ng-click=\\\"selectPage(page + 1, $event)\\\" aria-label=\\\"{{ $root.config.lang.next }}\\\"> <span aria-hidden=true class=icon-after-chevron-right></span> </button> </li> </ul> </nav> \";","module.exports = \"<div class=\\\"view mobile-app\\\" trap-focus fixed-to-body ng-init=logMobileAppView() aria-modal=true> <div class=mobile-app__header> <h1 class=mobile-app__title>{{::lang.values.aboutThisApp || 'About this app'}}</h1> <button class=\\\"close-button mobile-app__close-button\\\" ng-click=util.goBack() aria-label={{::lang.aria.modalClose}}></button> </div> <div class=mobile-app__content> <p style=margin-top:0 ng-if=mobileAppVersion><b>Mobile:</b> {{::mobileAppVersion}}</p> <p><b>Web:</b> {{webAppVersion}}</p> <p><b>Config:</b> {{::configs}}</p> <p ng-if=dependencies><b>Dependencies timestamp:</b> {{::dependencies}}</p> <p ng-if=codepush><b>Codepush:</b> {{codepush}}</p> <p ng-if=userID><b>User id:</b> {{userID}}</p> <p ng-if=UAchannel> <b>Channel:</b><br> {{UAchannel}} </p> </div> </div> \";","module.exports = \"<div class=modal-container> <div class=\\\"unsupported-postal-code-modal error-modal\\\"> <h1 class=unsupported-postal-code-modal-header> {{::$ctrl.lang.values.unsupportedPostalCodeModalHeaderText}} </h1> <div class=error-modal-content> <p class=unsupported-postal-code-modal-text>{{::$ctrl.lang.values.unsupportedPostalCodeModalBodyText}}</p> <a class=\\\"button button--full-width\\\" ng-href={{::config.pbiLink}} analytics-click=\\\"['unsupported modal continue', 'click']\\\">{{::$ctrl.lang.values.continueToExternal}}</a> <button class=\\\"button empty button--full-width\\\" ng-click=$dismiss() analytics-click=\\\"['unsupported modal cancel', 'click']\\\">{{::$ctrl.lang.values.cancel}}</button> </div> </div> </div> \";","module.exports = \"<button type=button class=\\\"skip-link screen-reader-text screen-reader-focusable\\\" aria-label=\\\"Skip reviewing side cart items?\\\" ng-click=handleSideCartSkip() ng-if=::!mobile.isMobile>Skip side cart section</button> <div class=side-cart ng-class=\\\"{ 'one-cart': isOneCartEnabled(), 'side-cart-open': $root.isSideCartOpen }\\\" role=navigation tab-enter=enter tab-exit-fn=tabExit() tab-enter-fn=tabEnter() id=side-cart-container data-test=mini-cart> <div class=side-cart-header ng-if=\\\"::!mobile.isMobile || isOneCartEnabled()\\\"> <div class=side-cart-title> <div class=side-cart-left-contents ng-if=isOneCartEnabled()> <button class=side-cart-close-button aria-label=\\\"Close Cart\\\" data-test=mini-cart-close-button ng-click=closeSideCart()> <i aria-hidden=true class=\\\"{{:: mobile.isMobile ? 'icon-chevron-left' : 'icon-delete' }}\\\"></i> </button> <h2 class=title> {{ sideCartLabel }} </h2> </div> <div class=side-cart-left-contents ng-if=!isOneCartEnabled()> <h2 class=title> <i aria-hidden=true class=icon-chevron-left></i> {{ sideCartLabel }} </h2> </div> <div uib-dropdown is-open=sideCartMenu.isOpen> <button uib-dropdown-toggle class=details aria-label=\\\"More cart options\\\" data-test=mini-cart-options-button> <i aria-hidden=true class=icon-more></i> </button> <div ng-if=sideCartMenu.isOpen ng-click=\\\"sideCartMenu.isOpen = false\\\" class=\\\"dropdown-menu bottom-left side-cart-menu\\\"> <ul> <li tabindex=0 data-test=mini-cart-clear-cart-button role=button class=link ng-click=cartService.clear()> {{ inStoreIntent ? lang.values.emptyList : lang.values.emptyCart }} </li> <li class=link role=button tabindex=0 analytics-click=\\\"['side cart print button', 'click']\\\" ng-click=\\\"listPrintService.printList(cartService.cart.items, sideCartLabel)\\\" ng-if=::!mobile.isMobile> {{:: lang.values.print }} </li> <li role=button tabindex=0 class=link ng-click=\\\"setSortType('aisle')\\\" ng-if=\\\"!config.disableAisles && inStoreIntent\\\" data-test=mini-cart-sort-by-aisle-button> {{:: lang.values.sortByAisle }} </li> <li role=button tabindex=0 class=link ng-click=\\\"setSortType('category')\\\" ng-if=\\\"!config.disableAisles && inStoreIntent\\\"> {{:: lang.values.sortByDepartment }} </li> </ul> </div> </div> </div> </div> <div class=side-cart-content data-test=mini-cart-content> <div ng-if=isCartFullyEmpty() class=not-found> <div class=cart-empty-msg>{{ inStoreIntent ? lang.values.noProductsInList : emptyCartMessage}}</div> <div ng-if=inCatering>{{::lang.values.seperateFromOtherCarts}}</div> <div> <a class=\\\"button hollow switch-context\\\" analytics-click=\\\"['cart continue shopping switch link', 'click']\\\" ng-click=\\\"shoppingSelectorService.open('shoppingContext')\\\" ng-if=::config.eComLight.enabled> {{::lang.values.switchShoppingMode}} </a> </div> <div> <a ui-sref=\\\"{{::mobile.isMobile ? config.continueShoppingRedirect.mobile : config.continueShoppingRedirect.desktop}}\\\" class=\\\"button action continue-shopping\\\" ng-click=onContinueShopping() analytics-click=\\\"['cart continue shopping link', 'click']\\\"> {{::lang.values.continueShopping}} </a> </div> </div> <div class=text-items ng-if=inStoreIntent> <unata-side-cart-sub-menu sort-list=triggerSortModal() current-sort-type=$ctrl.sortOptionNameByValue($ctrl.model.sortType) empty-list=cartService.clear() delete-checked-items=cartService.deleteCheckedItems() uncheck-all-items=cartService.uncheckAllItems() checked-items-count=cartService.getCheckedItemsCount()></unata-side-cart-sub-menu> <div ng-if=::!mobile.isMobile class=add-custom-item> <form ng-if=\\\"((showAddCustom && !editMode) || !mobile.isMobile)\\\" ng-submit=\\\"addCustomItem(newCustomItem.name); showAddCustom = false;\\\"> <label>{{:: lang.values.customItem }}</label> <div class=\\\"form-row button-right\\\"> <input type=text class=input ng-model=newCustomItem.name placeholder=\\\"Type in an item...\\\" aria-label={{::lang.aria.typeInAnItem}} data-test=mini-cart-custom-item-input> <button type=submit class=\\\"button smaller round darker icon-plus\\\" aria-label={{::lang.aria.add}}></button> </div> </form> </div> <div ng-if=\\\"mobile.isMobile && showSortModal == false\\\" fixed-to-body class=add-custom-item> <div role=button tabindex=0 class=toggle-button ng-click=toggleAddCustom(true); ng-if=!editMode aria-label={{::lang.aria.addCustomItem}}></div> <form ng-class=\\\"{show: showAddCustom}\\\" class=action-sheet ng-submit=\\\"addCustomItem(newCustomItem.name); toggleAddCustom(false);\\\"> <label>{{:: lang.values.customItem }}</label> <input type=text class=input ng-model=newCustomItem.name placeholder=\\\"Type in an item...\\\" aria-label=\\\"{{:: lang.aria.typeInAnItem }}\\\" data-test=mini-cart-custom-item-input> <div barcode-scanner-button ng-if=::config.enableBarcodeScanner></div> </form> <div role=button tabindex=0 prevent-all-scrolling class=action-sheet-backdrop ng-click=toggleAddCustom(false) ng-class=\\\"{show: showAddCustom}\\\"></div> </div> <div class=custom-items ng-if=customItems().length> <h2 ng-if=::config.showCategoryHeadersInSideCart class=category-header>{{:: lang.values.customItems }}</h2> <ul class=items> <li class=item ng-repeat=\\\"item in customItems()\\\" data-test=mini-cart-custom-item> <button class=\\\"button delete round\\\" ng-if=editMode ng-click=removeCustomItem(item) aria-label=\\\"{{:: lang.aria.delete }}\\\" data-test=mini-cart-custom-item-delete-button></button> <div class=controls> <button ng-if=::!mobile.isMobile ng-click=removeCustomItem(item) aria-label={{::lang.aria.delete}} send-analytics=!$root.modifyingOrder class=\\\"button smaller round hollow icon-delete\\\" analytics-click=\\\"['side cart delete custom item button', 'click']\\\" data-test=mini-cart-custom-item-delete-button></button> <a aria-label={{::lang.aria.search}} class=\\\"button smaller round icon-search\\\" ui-sref=\\\"main.search({search_term: item.pseudo_product.name})\\\" analytics-click=\\\"['side cart search custom item button', 'click']\\\"></a> </div> <div class=completed ng-if=\\\"(inStoreIntent && mobile.isMobile)\\\"> <input type=checkbox class=checkbox ng-if=!editMode ng-model=item.checked id=custom-checkoff{{$index}} ng-change=$ctrl.checkItem(item)> <label for=custom-checkoff{{$index}} class=name>{{:: item.pseudo_product.name }}</label> </div> <div class=name ng-if=\\\"(inStoreIntent && !mobile.isMobile)\\\">{{:: item.pseudo_product.name }}</div> </li> </ul> </div> </div> <div class=items ng-if=::!config.react.enableMiniCartList> <div ng-if=useMultiContextCart ng-repeat=\\\"(storeName, store) in dataByCartType track by storeName\\\"> <h2 class=store-header> <img class=store-header-logo ng-src=\\\"{{store.banner.logoImageUrl ? loadImg(store.banner.logoImageUrl) : loadImg('images/header-logo.svg')}}\\\" alt={{::lang.values.clientName}}> <span class=store-header-title> {{store.banner.name ? store.banner.name : lang.values.clientName}} </span> <span class=store-header-total> {{ store.product_total | currency }} </span> <div ng-if=store.cartMinMsg ng-bind-html=store.cartMinMsg class=mcox-cart-min-msg></div> </h2> <div ng-repeat=\\\"(categoryName, category) in store.categorizedItems track by categoryName\\\"> <h3 ng-if=::config.showCategoryHeadersInSideCart class=category-header> <span ng-if=\\\"sortType === 'category'\\\"> {{ categoryName }} </span> <span ng-if=\\\"sortType === 'aisle'\\\" data-test=items-sorted-by-aisle-header> {{:: lang.template(lang.values.aisleLabel, { aisleText: groupName }) }} </span> </h3> <div ng-include=\\\"'sideCartListMultiContext.html'\\\" ng-init=\\\"sideCartReference = $index\\\"></div> </div> </div> <div ng-if=!useMultiContextCart ng-repeat=\\\"groupName in orderedGroups[sortType]\\\"> <h2 ng-if=::config.showCategoryHeadersInSideCart class=category-header> <span ng-if=\\\"sortType === 'category'\\\"> {{ groupName }} </span> <span ng-if=\\\"sortType === 'aisle'\\\" data-test=items-sorted-by-aisle-header> {{:: lang.template(lang.values.aisleLabel, { aisleText: groupName }) }} </span> </h2> <div ng-include=\\\"'sideCartList.html'\\\" ng-init=\\\"sideCartReference = $index\\\"></div> </div> </div> <react-mini-cart-list ng-if=::config.react.enableMiniCartList items=cartService.cart.items has-eligible-ebt-card=hasEligibleEbtCard on-click=(goToProductDetailsModal) on-item-update=(cartService.sync) obfuscated-rx-items=cartService.obfuscatedRxItems cart-totals=cartService.cart.cart_totals is-instore-list=inStoreIntent> </react-mini-cart-list> <div class=cart-offers data-test=cart-offers ng-if=\\\"config.showOffersInSideCart && cartService.cart.offer_progress.length > 0\\\"> <h2 ng-if=::config.showCategoryHeadersInSideCart class=category-header> <span aria-hidden=true class=offer-tag></span> {{:: lang.template( lang.values.offersApplicableTo, { option: inStoreIntent ? lang.values.list : lang.values.order } ) }} </h2> <ul> <li ng-repeat=\\\"offer in cartService.cart.offer_progress\\\" offer-tile=offer location=\\\"Side Cart\\\"></li> </ul> </div> <div class=rewards-section ng-if=\\\"rewards.length && auth.user.ic_linked\\\" ng-repeat=\\\"reward in rewards track by reward.id\\\"> <react-cart-loyalty-balance title-text=reward.label value=\\\"reward.amount | currency\\\" content=\\\"reward.primaryInfo + reward.secondaryInfo\\\" native-href-click-handler></react-cart-loyalty-balance> </div> </div> <side-cart-bottom-buttons class=side-cart-bottom-buttons close-side-cart=closeSideCart() handle-checkout-click=handleCheckoutClick($event) in-store-intent=inStoreIntent show-cart-minimum-alert=isShowCartMinimumAlert(dataByCartType) mcox-cart-data=dataByCartType show-order-online-button=showOrderOnlineButton> <ic-express-side-cart ng-if=showIcExpressSideCart() subtitle=icExpressSideCartSubtitle on-clicked=acceptIcExpressSideCart() on-closed=dismissIcExpressSideCart() enable-retailer-theme=config.icExpress.enableRetailerTheme></ic-express-side-cart> <div class=loyalty-placement-sidecart ng-if=showLoyaltySideCartPlacement()> <loyalty-placement savings=cartService.cart.potential_loyalty_savings></loyalty-placement> </div> </side-cart-bottom-buttons> <div fixed-to-body class=mobile-flyer-side-cart-actions ng-if=\\\"inStoreIntent && mobile.isMobile && !showSortModal && !showOrderOnlineButton\\\"> <div role=button tabindex=0 class=done-editing ng-if=$parent.editMode ng-click=\\\"$parent.editMode = false\\\"> {{:: lang.values.done }} </div> <div class=total ng-if=!$parent.editMode> <div class=row> <span class=label>{{:: lang.values.estTotal }}</span> <span class=value>{{ cartService.cart.product_total | currency }}</span> </div> <div class=row ng-if=\\\"::(config.hasLoyaltyPoints && config.showPointsGained)\\\"> <span class=\\\"label points\\\">{{:: lang.values.estPoints }}</span> <span class=\\\"value points\\\">+ {{ (cartService.cart.points.awarded || 0) | number }}</span> </div> </div> </div> </div> <button type=button class=\\\"skip-link screen-reader-text screen-reader-focusable\\\" aria-label=\\\"Review side cart items?\\\" ng-click=handleSideCartReView() ng-if=::!mobile.isMobile>Re-view side cart section</button> \";","module.exports = \"<div role=button class=\\\"cell offer-cell\\\" ng-click=offerDetailsModalService.open(offer) analytics-click=\\\"['promo collection cell', 'click']\\\"> <div class=continuity-cell-content-wrapper> <div id=unata-loyalty-offer-expiry-{{offer.id}} class=offer-expiry ng-if=\\\"offer.end_date && !offer.continuity.rwd_count > 0\\\">{{::lang.template(lang.values.saleEndDate, {endDate: (offer.end_date | date:\\\"DD MMM\\\")})}}</div> <div id=unata-loyalty-offer-expiry-{{offer.id}} class=offer-expiry ng-if=\\\"!offer.end_date && !offer.continuity.rwd_count > 0\\\">No end date</div> <div id=unata-loyalty-offer-expiry-{{offer.id}} class=\\\"offer-expiry complete\\\" ng-if=\\\"offer.continuity.rwd_count > 0\\\">{{ ::config.continuityOffers.rewardComplete }}</div> <div class=\\\"cell-title cell-title-continuity-offer\\\"> <span id=unata-loyalty-offer-title-{{offer.id}} class=cell-title-text>{{offer.name}}</span> </div> <div class=continuity-cell-image-wrapper> <div offer-icon offer=offer></div> </div> <div ng-if=\\\"offer.offer_type === 'continuity'\\\"> <div continuity-progress offer=offer></div> </div> <div ng-if=\\\"offer.continuity.rwd_count > 0 && offer.continuity.rwd_offer_id\\\" class=view-continuity-offer-button> <button id=unata-loyalty-offer-start-button-{{offer.id}} type=button name=button ng-click=unlockContinuityOfferReward(offer.continuity.rwd_offer_id)>{{ ::config.continuityOffers.viewReward }}</button> </div> </div> </div> \";","module.exports = \"<error-page-component ng-if=!$ctrl.isReactRoute image=$ctrl.image button-url=$ctrl.buttonUrl button-text=$ctrl.buttonText title=$ctrl.title message=$ctrl.message> </error-page-component> <div ng-if=$ctrl.isReactRoute></div> \";","export const getSortOptions = lang => [\n  { name: lang.values.department, value: 'category' },\n  { name: lang.values.aisle, value: 'aisle' },\n]\n","module.exports = \"<div ng-if=config.flyerFlipp.enabled> <div ng-if=error>{{::lang.values.flyerFlippLoadError}}</div> <div ng-if=!error ng-init=init() id=flipp-container></div> </div> <div class=not-found ng-if=!config.flyerFlipp.enabled>{{::lang.values.flyerFlippDisabled}}</div>\";","module.exports = \"<div class=rx-redirect-error-modal> <react-rx-redirect-error-modal on-continue=(continue) /> </div> \";","module.exports = \"<div class=add-to-cart-button ng-if=\\\"!(productOptionsValidated === false) && (isProductInStock || !isProductInStock && enableOutOfStockAdd)\\\" ng-class=\\\"{'in-cart': cartItem && quantity}\\\" uib-popover-html=outOfStockWarningPopover popover-trigger=\\\"mouseenter focus\\\" popover-enable=\\\"!isProductInStock && !mobile.isMobile\\\" tabindex=\\\"{{ !isProductInStock && !mobile.isMobile ? '0' : null }}\\\"> <div ng-if=\\\"!product.product_config || (product.product_config && product.product_config.options.length === 0)\\\"> <div ng-if=product.order_by_weight class=weight> <button data-test=decrement-quantity-button aria-label={{::lang.aria.remove}} ng-if=\\\"cartItem && quantity\\\" ng-click=\\\"\\n          cartService.removeItem(product);\\n          cartAnalytics.removeItem(product, $parent.quantity, index, location, locationValue, { is_modal: isModal, corner_distance: getCornerDistance(), is_dynamic_collection: isDynamicCollection });\\n        \\\" analytics-click=\\\"['add to cart weighted product remove from cart button', 'click']\\\" send-analytics=!$root.modifyingOrder id=\\\"add-to-cart-button-cart-service-remove-item-{{ product.id + idStringContext }}\\\" class=\\\"button round remove icon-minus\\\" ng-class=\\\"{small: small}\\\"></button> <div class=select-button data-test=add-to-cart-select-handle-button aria-hidden=true> <button ng-if=\\\"!cartItem || !quantity\\\" class=\\\"selected cart button dropdown icon-fixed-right icon-after-caret-down\\\" ng-class=\\\"{small: small, 'icon-list': auth.getContext().intent === 'instore', 'icon-cart': auth.getContext().intent !== 'instore', 'product-details': isProductDetails}\\\" tabindex=-1> {{ getAddToCartLabel() }} </button> <button ng-if=\\\"cartItem && quantity\\\" class=\\\"selected cart button dropdown icon-fixed-right icon-after-caret-down\\\" ng-class=\\\"{small: small, 'icon-list': auth.getContext().intent === 'instore', 'icon-cart': auth.getContext().intent !== 'instore', 'product-details': isProductDetails}\\\" tabindex=-1> {{ quantity }} {{ product.ordering_parameters.display_name }} {{ !mobile.isMobile ? lang.values.addtoCartButtonAdded : '' }} </button> </div> <select class=weight-dropdown ng-model=selectedQuantity.value ng-change=\\\"updateWeight(configuration, selectedQuantity.value); appReviewCheck();\\\" aria-label={{::lang.aria.updateWeight}} ng-options=\\\"weight.value as weight.label for weight in orderWeightOptions\\\" id=\\\"add-to-cart-button-cart-service-select-item-weight-{{ product.id + idStringContext }}\\\" data-test=add-to-cart-button-select> <option value=\\\"\\\" selected=selected disabled=disabled>{{ lang.values.selectWeight }}</option> </select> </div> <div ng-if=!product.order_by_weight class=each uib-popover-html=maxQuantityWarningPopover popover-trigger=\\\"mouseenter focus\\\" popover-enable=\\\"!mobile.isMobile && hasReachedProductAddLimit()\\\" tabindex=\\\"{{ !mobile.isMobile && hasReachedProductAddLimit() ? '0' : null }}\\\"> <span id=add-to-cart-ada-increment-{{product.id}} class=screen-reader-text aria-live=polite></span> <div ng-if=\\\"cartItem && quantity\\\"> <button data-test=decrement-quantity-button ng-click=\\\"\\n            cartService.updateItemQuantity(product, quantity - 1);\\n            accessibleItemRemoved();\\n            cartAnalytics.removeItem(product, 1, index, location, locationValue, { is_modal: isModal, corner_distance: getCornerDistance(), is_dynamic_collection: isDynamicCollection });\\n          \\\" analytics-click=\\\"['add to cart product decrement cart quantity button', 'click']\\\" id=\\\"add-to-cart-button-cart-service-update-item-quantity-decrement-{{\\n            product.id + idStringContext\\n          }}\\\" class=\\\"button round remove icon-minus\\\" ng-class=\\\"{small: small, 'product-details': isProductDetails}\\\" aria-label=\\\"{{::lang.aria.removeItem}} {{::product.name}}\\\"></button> <span id=add-to-cart-ada-decrement-{{product.id}} class=screen-reader-text aria-live=polite></span> <button data-test=add-to-cart-button ng-click=\\\"\\n            cartService.updateItemQuantity(product, quantity + 1);\\n            productsService.getBeacon(product.onAddToCartBeacon);\\n            accessibleItemAdded();\\n            cartAnalytics.addItem(product, 1, index, location, locationValue, { is_modal: isModal, corner_distance: getCornerDistance(), is_dynamic_collection: isDynamicCollection });\\n            analytics.logFBAddToCart(product);\\n            appReviewCheck();\\n          \\\" analytics-click=\\\"['add to cart product increment cart quantity button', 'click']\\\" send-analytics=!$root.modifyingOrder id=\\\"add-to-cart-button-cart-service-update-item-quantity-increment-{{\\n            product.id + idStringContext\\n          }}\\\" class=\\\"button full cart add icon-fixed-right icon-after-plus\\\" ng-class=\\\"{small: small, 'icon-list': auth.getContext().intent === 'instore', 'icon-cart': auth.getContext().intent !== 'instore', 'product-details': isProductDetails}\\\" aria-label=\\\"{{::lang.aria.addItem}} {{::product.name}}  {{ cartItem.quantity > 0 ? lang.templateAsString(lang.values.itemsAlreadyAdded, { quantity: cartItem.quantity }) : '' }}\\\" ng-disabled=hasReachedProductAddLimit()> {{ cartItem.quantity }} {{ !mobile.isMobile ? lang.values.addtoCartButtonAdded : '' }} {{ hasReachedProductAddLimit() ? '(' + lang.values.max + ')' : ''}} </button> </div> <div ng-if=\\\"!cartItem || !quantity\\\"> <button data-test=add-to-cart-button ng-click=\\\"\\n            tellParents();\\n            cartService.addItem(product, 1, product.uoms[0]);\\n            productsService.getBeacon(product.onAddToCartBeacon);\\n            accessibleItemAdded();\\n            cartAnalytics.addItem(product, 1, index, location, locationValue, { is_modal: isModal, corner_distance: getCornerDistance(), is_dynamic_collection: isDynamicCollection });\\n            analytics.logFBAddToCart(product);\\n            appReviewCheck();\\n\\n          \\\" analytics-click=\\\"['add to cart product add button', 'click']\\\" send-analytics=!$root.modifyingOrder id=\\\"add-to-cart-button-cart-service-add-item-{{ product.id + idStringContext }}\\\" class=\\\"button full cart add icon-fixed-right icon-after-plus\\\" ng-class=\\\"{small: small, 'product-details': isProductDetails}\\\" aria-label=\\\"{{ addButtonARIALabel }}\\\"> <span aria-hidden=true ng-class=\\\"{'icon-list': auth.getContext().intent === 'instore', 'icon-cart': auth.getContext().intent !== 'instore'}\\\" class=cart-icon></span> {{ getAddToCartLabel() }} </button> </div> </div> </div> <div ng-if=\\\"product.product_config && product.product_config.options.length > 0\\\"> <div ng-if=\\\"product.order_by_weight && product.product_config.config_type === 'prep_style' && isRelatedProduct\\\" class=weight> <div ng-if=\\\"!aggregateQuantity || aggregateQuantity === 0\\\"> <button data-test=add-to-cart-button ng-click=linkToProductDetails(product.id) class=\\\"button full cart\\\" ng-class=\\\"{small: small, 'icon-list': auth.getContext().intent === 'instore', 'icon-cart': auth.getContext().intent !== 'instore'}\\\"> {{ getAddToCartLabel() }} </button> </div> <div ng-if=\\\"aggregateQuantity > 0\\\"> <button data-test=add-to-cart-button ng-click=linkToProductDetails(product.id) class=\\\"button full related-configurable cart\\\" ng-class=\\\"{small: small, 'icon-list': auth.getContext().intent === 'instore', 'icon-cart': auth.getContext().intent !== 'instore'}\\\"> {{ aggregateQuantity }} {{ product.ordering_parameters.display_name }} {{ !mobile.isMobile ? lang.values.addtoCartButtonAdded : '' }} </button> </div> </div> <div ng-if=\\\"product.order_by_weight && product.product_config.config_type === 'prep_style' && !isRelatedProduct\\\" class=weight> <div ng-if=!isDropdown> <button ng-if=\\\"cartItem && quantity\\\" ng-click=\\\"\\n            cartService.removeItem(product, configuration);\\n            cartAnalytics.removeItem(product, $parent.quantity, index, location, locationValue, { is_modal: isModal, corner_distance: getCornerDistance(), is_dynamic_collection: isDynamicCollection });\\n          \\\" aria-label={{::lang.aria.remove}} analytics-click=\\\"['add to cart weighted product remove from cart button', 'click']\\\" send-analytics=!$root.modifyingOrder class=\\\"button round remove icon-minus\\\" ng-class=\\\"{small: small}\\\"></button> <div class=select-button data-test=add-to-cart-select-handle-button> <button ng-if=\\\"!cartItem || !quantity\\\" class=\\\"selected cart button dropdown icon-fixed-right icon-after-caret-down\\\" ng-class=\\\"{small: small, 'icon-list': auth.getContext().intent === 'instore', 'icon-cart': auth.getContext().intent !== 'instore'}\\\"> {{ getAddToCartLabel() }} </button> <button ng-if=\\\"cartItem && quantity\\\" class=\\\"selected cart button dropdown icon-fixed-right icon-after-caret-down\\\" ng-class=\\\"{small: small, 'icon-list': auth.getContext().intent === 'instore', 'icon-cart': auth.getContext().intent !== 'instore'}\\\"> {{ quantity }} {{ product.ordering_parameters.display_name }} {{ !mobile.isMobile ? lang.values.addtoCartButtonAdded : '' }} </button> <select ng-model=selectedQuantity.value ng-change=\\\"updateWeight(configuration, selectedQuantity.value); appReviewCheck();\\\" aria-label={{::lang.aria.updateWeight}} ng-options=\\\"weight.value as weight.label for weight in orderWeightOptions\\\" data-test=add-to-cart-button-select> <option value=\\\"\\\" selected=selected disabled=disabled>{{::lang.values.selectWeight }}</option> </select> </div> </div> <div ng-if=isDropdown class=configurable-dropdown> <button ng-if=\\\"cartItem && quantity\\\" ng-click=\\\"\\n            cartService.removeItem(product, configuration);\\n            cartAnalytics.removeItem(product, $parent.quantity, index, location, locationValue, { is_modal: isModal, corner_distance: getCornerDistance(), is_dynamic_collection: isDynamicCollection });\\n          \\\" aria-label={{::lang.aria.remove}} analytics-click=\\\"['add to cart weighted product remove from cart button', 'click']\\\" send-analytics=!$root.modifyingOrder class=\\\"button round remove icon-minus\\\"></button> <div class=select-button data-test=add-to-cart-select-handle-button> <button ng-if=\\\"!cartItem || !quantity\\\" class=\\\"selected add-to-cart-label cart button quantity-box\\\"> {{ getAddToCartLabel() }} <div class=\\\"action-icon icon-after-caret-down\\\"></div> </button> <button ng-if=\\\"cartItem && quantity\\\" class=\\\"selected cart button quantity-box\\\"> {{ quantity }} {{ product.ordering_parameters.display_name }} <div class=\\\"action-icon icon-after-caret-down\\\"></div> </button> <select ng-model=selectedQuantity.value ng-change=\\\"updateWeight(configuration, selectedQuantity.value); appReviewCheck();\\\" aria-label={{::lang.aria.updateWeight}} ng-options=\\\"weight.value as weight.label for weight in orderWeightOptions\\\" data-test=add-to-cart-button-select> <option value=\\\"\\\" selected=selected disabled=disabled>{{::lang.values.selectWeight }}</option> </select> </div> </div> </div> <div ng-if=\\\"!product.order_by_weight && product.product_config.config_type === 'prep_style' && isRelatedProduct\\\" class=each> <div ng-if=\\\"!aggregateQuantity || aggregateQuantity === 0\\\"> <button data-test=add-to-cart-button ng-click=linkToProductDetails(product.id) class=\\\"button full cart\\\" ng-class=\\\"{small: small, 'icon-list': auth.getContext().intent === 'instore', 'icon-cart': auth.getContext().intent !== 'instore'}\\\"> {{ getAddToCartLabel() }} </button> </div> <div ng-if=\\\"aggregateQuantity > 0\\\"> <button data-test=add-to-cart-button ng-click=linkToProductDetails(product.id) class=\\\"button full related-configurable cart\\\" ng-class=\\\"{small: small, 'icon-list': auth.getContext().intent === 'instore', 'icon-cart': auth.getContext().intent !== 'instore'}\\\"> {{ aggregateQuantity }} {{ !mobile.isMobile ? lang.values.addtoCartButtonAdded : '' }} </button> </div> </div> <div ng-if=\\\"!product.order_by_weight && product.product_config.config_type === 'prep_style' && !isRelatedProduct\\\" class=each uib-popover-html=maxQuantityWarningPopover popover-trigger=\\\"mouseenter click focus \\\" popover-append-to-body=true popover-animation=false popover-enable=\\\"!mobile.isMobile && hasReachedProductAddLimit()\\\"> <div ng-if=!isDropdown> <div ng-if=\\\"cartItem && quantity\\\"> <button ng-click=\\\"\\n              cartService.updateItemQuantity(product, quantity - 1, [configuration]);\\n              cartAnalytics.removeItem(product, 1, index, location, locationValue, { is_modal: isModal, corner_distance: getCornerDistance(), is_dynamic_collection: isDynamicCollection });\\n            \\\" analytics-click=\\\"['add to cart product decrement cart quantity button', 'click']\\\" class=\\\"button round remove icon-minus\\\" ng-class=\\\"{small: small}\\\" aria-label=\\\"{{::lang.aria.removeItem}} {{::product.name}}\\\"></button> <button data-test=add-to-cart-button ng-click=\\\"\\n              cartService.updateItemQuantity(product, quantity + 1, [configuration]);\\n              productsService.getBeacon(product.onAddToCartBeacon);\\n              cartAnalytics.addItem(product, 1, index, location, locationValue, { is_modal: isModal, corner_distance: getCornerDistance(), is_dynamic_collection: isDynamicCollection });\\n              analytics.logFBAddToCart(product);\\n              appReviewCheck();\\n            \\\" analytics-click=\\\"['add to cart product increment cart quantity button', 'click']\\\" send-analytics=!$root.modifyingOrder class=\\\"button full cart add icon-fixed-right icon-after-plus\\\" ng-class=\\\"{small: small, 'icon-list': auth.getContext().intent === 'instore', 'icon-cart': auth.getContext().intent !== 'instore'}\\\" aria-label=\\\"{{::lang.aria.addItem}} {{::product.name}}\\\" ng-disabled=hasReachedProductAddLimit()> {{ cartItem.quantity || quantity }} {{ !mobile.isMobile ? lang.values.addtoCartButtonAdded : '' }} {{ hasReachedProductAddLimit() ? '(' + lang.values.max + ')' : ''}} </button> </div> <div ng-if=\\\"!cartItem || !quantity\\\"> <button data-test=add-to-cart-button ng-click=\\\"\\n              tellParents();\\n              cartService.addItem(product, product.uoms[0], [configuration]);\\n              productsService.getBeacon(product.onAddToCartBeacon);\\n              cartAnalytics.addItem(product, product.uoms[0], index, location, locationValue, { is_modal: isModal, corner_distance: getCornerDistance(), is_dynamic_collection: isDynamicCollection });\\n              analytics.logFBAddToCart(product);\\n              appReviewCheck();\\n            \\\" analytics-click=\\\"['add to cart product add button', 'click']\\\" send-analytics=!$root.modifyingOrder class=\\\"button full cart add icon-fixed-right icon-after-plus\\\" ng-class=\\\"{small: small, 'icon-list': auth.getContext().intent === 'instore', 'icon-cart': auth.getContext().intent !== 'instore'}\\\" aria-label=\\\"{{ addButtonARIALabel }}\\\"> {{ getAddToCartLabel() }} </button> </div> </div> <div ng-if=isDropdown class=configurable-dropdown> <div ng-if=\\\"cartItem && quantity\\\"> <button ng-click=\\\"\\n              cartService.updateItemQuantity(product, quantity - 1, [configuration]);\\n              cartAnalytics.removeItem(product, 1, index, location, locationValue, { is_modal: isModal, corner_distance: getCornerDistance(), is_dynamic_collection: isDynamicCollection });\\n            \\\" analytics-click=\\\"['add to cart product decrement cart quantity button', 'click']\\\" class=\\\"button round remove icon-minus\\\" aria-label=\\\"{{::lang.aria.removeItem}} {{::product.name}}\\\"></button> <button data-test=add-to-cart-button ng-click=\\\"\\n              cartService.updateItemQuantity(product, quantity + 1, [configuration]);\\n              productsService.getBeacon(product.onAddToCartBeacon);\\n              cartAnalytics.addItem(product, 1, index, location, locationValue, { is_modal: isModal, corner_distance: getCornerDistance(), is_dynamic_collection: isDynamicCollection });\\n              analytics.logFBAddToCart(product);\\n              appReviewCheck();\\n            \\\" analytics-click=\\\"['add to cart product increment cart quantity button', 'click']\\\" send-analytics=!$root.modifyingOrder class=\\\"button full cart quantity-box add icon-fixed-right\\\" aria-label=\\\"{{::lang.aria.addItem}} {{::product.name}}\\\"> {{ cartItem.quantity || quantity }} <div class=\\\"icon-after-plus action-icon\\\"></div> </button> </div> <div ng-if=\\\"!cartItem || !quantity\\\"> <button data-test=add-to-cart-button ng-click=\\\"\\n              tellParents();\\n              cartService.addItem(product, product.uoms[0], [configuration]);\\n              productsService.getBeacon(product.onAddToCartBeacon);\\n              cartAnalytics.addItem(product, 1, index, location, locationValue, { is_modal: isModal, corner_distance: getCornerDistance(), is_dynamic_collection: isDynamicCollection });\\n              analytics.logFBAddToCart(product);\\n              appReviewCheck();\\n            \\\" analytics-click=\\\"['add to cart product add button', 'click']\\\" send-analytics=!$root.modifyingOrder class=\\\"button full cart quantity-box add add-to-cart-label\\\" aria-label=\\\"{{ addButtonARIALabel }}\\\"> {{ getAddToCartLabel() }} <div class=\\\"icon-after-plus action-icon\\\"></div> </button> </div> </div> </div> <div ng-if=\\\"product.product_config.config_type === 'custom' && !isProductCell && !isRelatedProduct\\\" class=each> <div ng-if=\\\"cartItem && quantity\\\"> <button ng-click=\\\"\\n            cartService.updateItemQuantity(product, quantity - 1, configuration)\\n            cartAnalytics.removeItem(product, 1, index, location, locationValue, { is_modal: isModal, corner_distance: getCornerDistance(), is_dynamic_collection: isDynamicCollection });\\n          \\\" analytics-click=\\\"['add to cart product decrement cart quantity button', 'click']\\\" class=\\\"button round remove icon-minus\\\" ng-class=\\\"{small: small}\\\" aria-label=\\\"{{::lang.aria.removeItem}} {{::product.name}}\\\"></button> <button data-test=add-to-cart-button ng-click=\\\"\\n            cartService.updateItemQuantity(product, quantity + 1, configuration);\\n            productsService.getBeacon(product.onAddToCartBeacon);\\n            cartAnalytics.addItem(product, 1, index, location, locationValue, { is_modal: isModal, corner_distance: getCornerDistance(), is_dynamic_collection: isDynamicCollection });\\n            analytics.logFBAddToCart(product);\\n            appReviewCheck();\\n          \\\" analytics-click=\\\"['add to cart product increment cart quantity button', 'click']\\\" send-analytics=!$root.modifyingOrder class=\\\"button full cart add icon-fixed-right icon-after-plus\\\" ng-class=\\\"{small: small, 'icon-list': auth.getContext().intent === 'instore', 'icon-cart': auth.getContext().intent !== 'instore'}\\\" aria-label=\\\"{{::lang.aria.addItem}} {{::product.name}}\\\"> {{ cartItem.quantity }} {{ !mobile.isMobile ? lang.values.addtoCartButtonAdded : '' }} </button> </div> <div ng-if=\\\"!cartItem || !quantity\\\"> <button data-test=add-to-cart-button ng-if=\\\"!isProductCell && !isRelatedProduct\\\" ng-click=\\\"\\n            tellParents();\\n            cartService.addItemConfigurable(product, product.uoms[0], configuration);\\n            productsService.getBeacon(product.onAddToCartBeacon);\\n            cartAnalytics.addItem(product, 1, index, location, locationValue, { is_modal: isModal, corner_distance: getCornerDistance(), is_dynamic_collection: isDynamicCollection });\\n            analytics.logFBAddToCart(product);\\n          \\\" analytics-click=\\\"['add to cart product add button', 'click']\\\" send-analytics=!$root.modifyingOrder class=\\\"button full cart add icon-fixed-right icon-after-plus\\\" ng-class=\\\"{small: small, 'icon-list': auth.getContext().intent === 'instore', 'icon-cart': auth.getContext().intent !== 'instore'}\\\" aria-label=\\\"{{ addButtonARIALabel }}\\\"> {{ getAddToCartLabel() }} </button> </div> </div> <div ng-if=\\\"product.product_config.config_type === 'custom' && (isProductCell || isRelatedProduct)\\\" class=each> <button data-test=add-to-cart-button ng-click=linkToProductDetails(product.id) class=\\\"button full cart customize\\\" ng-class=\\\"{small: small}\\\"> {{::lang.values.customize}} </button> </div> </div> </div> <button ng-if=\\\"(productOptionsValidated === false) && isProductInStock\\\" class=\\\"button full cart add icon-fixed-right icon-after-plus disabled\\\" ng-class=\\\"{small: small, 'icon-list': auth.getContext().intent === 'instore', 'icon-cart': auth.getContext().intent !== 'instore'}\\\"> {{ getAddToCartLabel() }} </button> <button class=\\\"button full cart icon-after-info-i disabled add-to-cart-unavailable-button\\\" ng-class=\\\"{small: small}\\\" ng-if=\\\"!isProductInStock && !enableOutOfStockAdd\\\" uib-popover-html=outOfStockWarningPopover popover-trigger=\\\"mouseenter focus\\\" popover-enable=!mobile.isMobile> {{::lang.values.outOfStock}} </button> \";","module.exports = \" <a ng-if=\\\"prevCategory && config.showShopNextCategoryPagination\\\" ng-href=\\\"{{state.href(prevCategory.state, utilService.withoutPage(prevCategory.params))}}\\\" class=\\\"pagination-left button small hollow\\\"> <span class=icon-chevron-left aria-hidden=true></span> {{prevCategory.name}} </a> <ul uib-pagination boundary-links=true first-text=1 template-url=pagination-modified-uibootstrap-desktop.html ng-if=\\\"items.item_count > config.productsPerPage\\\" previous-text=\\\"\\\" next-text=\\\"\\\" total-items=items.item_count max-size=config.maxPaginationLinks items-per-page=config.productsPerPage ng-model=page.current class=pagination ng-click=\\\"analytics.logEvent('catalog products pagination', 'click')\\\"></ul> <a ng-if=\\\"nextCategory && config.showShopNextCategoryPagination\\\" ng-href=\\\"{{state.href(nextCategory.state, utilService.withoutPage(nextCategory.params))}}\\\" class=\\\"pagination-right button small hollow\\\"> {{nextCategory.name}} <span class=icon-after-chevron-right aria-hidden=true></span> </a> \";","export const ACTIONS = {\n  CHECKOUT: 'CHECKOUT',\n  LOGIN: 'LOGIN',\n  PASSWORD_RESET: 'PASSWORD_RESET',\n  REGISTER: 'REGISTER',\n}\n","module.exports = \"<div class=\\\"order modify-cart\\\" ng-class=\\\"{'extra-padding-bottom': mobileShowNotesAndSubs, 'order_status-cancelled': order.status === 'cancelled', 'watson-extra-padding': config.chatIntegration.enabled}\\\"> <button ng-if=\\\"config.orderHistoryView.useItemEditAddFlow && order.can_modify\\\" class=\\\"button cart action order-add-items-button\\\" ng-click=addItemsToOrder() data-test=order-add-items-button> {{::lang.values.addItemsToOrder}} </button> <div class=content-header> <span class=order-info-message> <strong> {{order.fulfillment_type === 'delivery' ? lang.values.deliveryTime : lang.values.pickupTime}}: </strong> {{::timeslotLabelFn()}} </span> </div> <div class=mobile-actions ng-if=::mobile.isMobile> <div class=subs ng-if=!mobileShowNotesAndSubs> <span role=button class=mode-toggle ng-click=setMobileShowNotesAndSubs(true)> <span class=\\\"icon-note mode-toggle-icon\\\" aria-hidden=true></span> <span class=mode-toggle-text>{{::lang.values.editNotesOnSubstitution}}</span> </span> </div> <div class=subs ng-if=mobileShowNotesAndSubs> <input class=checkbox ng-model=substitutions.allowAllSubstitutions ng-change=toggleAllowAllSubstitutions() id=allow-all-sub-mob type=checkbox /> <label class=\\\"checkbox-switch right\\\" for=allow-all-sub-mob> <span></span> </label> <div class=subs-label>{{::lang.values.allowSubstitutionCart}}</div> </div> <button class=\\\"button dark mobile-bottom\\\" fixed-to-body ng-if=mobileShowNotesAndSubs ng-click=setMobileShowNotesAndSubs(false)> {{::lang.values.done}} </button> </div> <div> <div class=\\\"content-section details\\\"> <alert ng-if=!order.can_modify type=warn-light> <span>{{::lang.values.orderCantBeModified}}</span> </alert> <div ng-if=hasAppendedItems class=order-update-tooltip> <i class=\\\"icon icon-info-i\\\"></i> {{::lang.values.newItemsAppended}} </div> <table role=\\\"{{ ::mobile.isMobile ? 'presentation' : null }}\\\" ng-if=\\\"order.can_modify && modifyOrderItems.length\\\" class=\\\"table order-edit-table\\\"> <thead ng-if=::!mobile.isMobile> <tr> <th colspan=3 scope=col>{{::lang.values.product}}</th> <th scope=col> <input class=checkbox ng-model=substitutions.allowAllSubstitutions ng-change=toggleAllowAllSubstitutions() id=allow-all-sub type=checkbox aria-describedby=substitution-help /> <label for=allow-all-sub class=screen-reader-text> {{::lang.values.substitutionForAllItems}} </label> <span aria-hidden=true>{{::lang.values.substitution}}</span> <span class=\\\"help question\\\" help=lang.values.substitutionHelp description-id=substitution-help></span> </th> <th></th> <th scope=col>{{::lang.values.price}}</th> <th></th> <th scope=col> {{::lang.values.quantity}} </th> <th></th> <th scope=col>{{::lang.values.total}}</th> </tr> </thead> <tbody ng-repeat=\\\"category in orderedCategories\\\" ng-init=\\\"categoryIndex = $index\\\"> <tr class=category> <td scope=rowgroup colspan=\\\"{{::(mobile.isMobile ? 3 : 10)}}\\\">{{category}}</td> </tr> <tr class=\\\"parent row\\\" ng-if=\\\"item.store_product.product_type === 'product'\\\" ng-repeat-start=\\\"item in categorizedProducts[category] track by generateUniqueItemId(item)\\\" ng-class=\\\"{\\n              'show-delete-confirm': item.showDeleteConfirm\\n            }\\\" data-test=order-edit-item-{{item.store_product.id}}> <td class=\\\"action delete\\\"> <button data-test=remove-item-button class=\\\"button round remove-item-button\\\" ng-class=\\\"{ 'darker small': !mobile.isMobile, empty: mobile.isMobile }\\\" ng-click=\\\"item.showDeleteConfirm = true\\\" name=item-delete-trigger aria-label=\\\"{{\\n                  ::lang.templateAsString(\\n                    lang.aria.removeItemFromCart,\\n                    { item: item.store_product.name }\\n                  )\\n                }}\\\" ng-disabled=item.showDeleteConfirm> <span class=\\\"{{:: mobile.isMobile ? config.cartReview.mobile.deleteIcon : 'icon-delete'}}\\\" aria-hidden=true></span> </button> <div ng-show=item.showDeleteConfirm class=delete-confirm data-test=delete-confirm-button> <div class=label> {{::lang.values.wantToRemove}} <span auto-focus=true class=screen-reader-text tabindex=-1> {{:: lang.templateAsString( lang.aria.removeItemFromCartConfirmation, { item: item.store_product.name } ) }} </span> </div> <button ng-click=cancelRemoveItem(item) class=\\\"button smaller dark\\\" name=item-delete-cancel aria-label={{::lang.aria.cancel}}> {{::lang.values.cancel}} </button> <button ng-click=removeItem(item) class=\\\"button smaller highlight\\\" name=item-delete-confirm aria-label={{::lang.aria.removeItem}} data-test=remove-item-confirm-button> {{::lang.values.remove}} </button> </div> </td> <td ng-disabled=item.showDeleteConfirm> <div class=item-image ng-attr-style=\\\"background-image: url('{{::imageURLService.getProductImageURL(item.store_product, 'small')}}')\\\"></div> </td> <td class=product-meta ng-disabled=item.showDeleteConfirm> <div class=item-name> {{item.store_product.name}} </div> <div class=configurable-values-container ng-if=item.product_config.options.length> <p class=configurable-values compile=\\\"configurableProductService.configsString(item, true)\\\"></p> </div> <div ng-if=::mobile.isMobile> <div class=right ng-if=mobileShowNotesAndSubs> <input class=checkbox ng-model=item.allow_substitutions ng-change=toggleAllowSubstitutions(item) ng-disabled=\\\"isItemCurrentlyOutOfStock(item) || isAllowSubstitutionsDisabled(item)\\\" id=allow-sub-{{categoryIndex}}-{{$index}} type=checkbox /> <label class=checkbox-switch for=allow-sub-{{categoryIndex}}-{{$index}}> <span></span> </label> </div> <div class=right ng-if=!mobileShowNotesAndSubs> <div modify-quantity item=item increment-fn=incrementItem(item) decrement-fn=decrementItem(item) on-update=\\\"updateItemQuantity(item, $originalQuantity, $onZeroFn)\\\" on-zero-fn=handleItemZeroQuantity(item) include-zero=true disable-input=item.showDeleteConfirm></div> </div> <div product-prices product=item.store_product unit-price=item.unit_price></div> <div class=offer-tag ng-if=itemHasOffer(item)></div> </div> <div product-points product=item.store_product class=small></div> <div ng-if=::!mobile.isMobile> <div ng-if=!isItemCurrentlyOutOfStock(item) product-comments item=item product-comment-callback=updateItemComment(item) disable-input=item.showDeleteConfirm></div> <div ng-if=isItemCurrentlyOutOfStock(item)> <span class=out-of-stock-text tabindex=\\\"{{ isItemCurrentlyOutOfStock(item) ? '0' : '-1' }}\\\" uib-popover-html=outOfStockWarningPopover popover-trigger=\\\"mouseenter focus\\\" popover-enable=isItemCurrentlyOutOfStock(item)> {{::lang.values.outOfStock}} <i class=\\\"icon icon-info-i\\\" aria-hidden=true></i> </span> </div> </div> </td> <td ng-if=::!mobile.isMobile> <input class=\\\"checkbox qa-item-allow-sub\\\" ng-model=item.allow_substitutions ng-change=toggleAllowSubstitutions(item) ng-disabled=\\\"item.showDeleteConfirm || isItemCurrentlyOutOfStock(item) || isAllowSubstitutionsDisabled(item)\\\" id=allow-sub-{{categoryIndex}}-{{$index}} type=checkbox /> <label for=allow-sub-{{categoryIndex}}-{{$index}} class=screen-reader-text> {{::lang.template(lang.values.substituteFor, {substitute: lang.values.substitute, product: item.store_product.name})}} </label> <span class=allow-sub-label aria-label={{::lang.aria.allowSubstitution}} aria-hidden=true> {{::lang.values.allowQuestion}}? </span> </td> <td ng-if=::!mobile.isMobile ng-disabled=item.showDeleteConfirm> <div class=offer-tag ng-if=itemHasOffer(item)></div> </td> <td class=prices ng-if=::!mobile.isMobile ng-disabled=item.showDeleteConfirm> <div product-prices product=item.store_product unit-price=item.unit_price></div> </td> <td class=cosmetic ng-if=::!mobile.isMobile ng-disabled=item.showDeleteConfirm> <span>&times;</span> </td> <td ng-if=::!mobile.isMobile ng-disabled=item.showDeleteConfirm> <div> <div modify-quantity item=item increment-fn=incrementItem(item) decrement-fn=decrementItem(item) on-update=\\\"updateItemQuantity(item, $originalQuantity, $onZeroFn)\\\" on-zero-fn=handleItemZeroQuantity(item) include-zero=true disable-input=item.showDeleteConfirm></div> </div> </td> <td class=cosmetic ng-if=::!mobile.isMobile ng-disabled=item.showDeleteConfirm> <span>=</span> </td> <td ng-if=::!mobile.isMobile name=item-subtotal data-test=item-subtotal ng-disabled=item.showDeleteConfirm> <span ng-class=\\\"{'subtotal-is-loading': isCalculationLoading()}\\\">{{item.sub_total | currency}}</span> </td> </tr> <tr ng-repeat-end ng-class=\\\"{ 'out-of-stock': isItemCurrentlyOutOfStock(item) }\\\"> <td colspan=4 class=mobile-extras ng-if=\\\"mobile.isMobile && !isItemCurrentlyOutOfStock(item) && mobileShowNotesAndSubs\\\"> <div product-comments item=item product-comment-callback=updateItemComment(item)></div> </td> <td colspan=4 class=out-of-stock-bottom ng-if=\\\"mobile.isMobile && isItemCurrentlyOutOfStock(item) && !mobileShowNotesAndSubs\\\"> <span class=\\\"out-of-stock-text out-of-stock-text-offset\\\" tabindex=\\\"{{ isItemCurrentlyOutOfStock(item) ? '0' : '-1' }}\\\" uib-popover-html=outOfStockWarningPopover popover-trigger=\\\"mouseenter focus\\\" popover-enable=isItemCurrentlyOutOfStock(item)> {{::lang.values.outOfStock}} <i class=\\\"icon icon-info-i\\\" aria-hidden=true></i> </span> </td> </tr> </tbody> <tbody id=cart-offers class=cart-offers ng-if=\\\"!mobileShowNotesAndSubs && !isCalculationLoading()\\\"> <tr ng-if=\\\"modifyOfferProgress.length > 0\\\" class=category> <td colspan=\\\"{{::mobile.isMobile ? 3 : 11}}\\\"> <div class=offer-heading><span aria-hidden=true class=offer-tag></span> {{::lang.values.offersApplicableToOrder}}</div> </td> </tr> <tr data-test=offers-section ng-if=\\\"modifyOfferProgress.length > 0\\\" class=offers> <td colspan=\\\"{{::mobile.isMobile ? 3 : 11}}\\\"> <loyalty-opt-in-placement ng-if=::config.loyalty.enableLoyaltyOptInPlacements is-info-box=true></loyalty-opt-in-placement> <span class=\\\"ul-el {{:: config.newCheckoutFlow.cartReviewPage.enabled ? 'offers-list--new' : 'offers-list' }}\\\"> <span class=li-el ng-repeat=\\\"offer in modifyOfferProgress\\\" offer-tile=offer location=\\\"Cart Item Offer\\\"></span> </span> </td> </tr> </tbody> </table> </div> </div> <div class=content-header ng-if=order.can_modify> <div class=totals-table> <div class=order-totals-column-wrapper> <react-order-totals bold-labels=true line-items=orderTotalLines></react-order-totals> </div> </div> </div> <div class=content-header ng-if=\\\"order.can_modify && isTotalBelowMin()\\\"> <div> <div class=order-totals-column-wrapper> <alert type=warn-light> <span ng-bind-html=\\\"lang.template(\\n              config.cartMinimum.tooltipText,\\n              { amount: currencyFilter(getMinCartSpend()) }\\n            )\\\"></span> </alert> </div> </div> </div> <div class=\\\"content-header order-edit-item-actions\\\" ng-if=order.can_modify> <div class=footer-actions> <button class=\\\"button cart action order-edit-save-button\\\" ng-click=saveOrderModifications() ng-disabled=\\\"modifyOrderItems.length === 0 || isCalculationLoading() || isTotalBelowMin()\\\" data-test=order-edit-save-button> <span ng-if=!isCalculationLoading()>{{::lang.values.saveChanges}}</span> <loading-dots show=isCalculationLoading() /> </button> <button class=\\\"button hollow cart action\\\" ng-click=discardOrderModifications() ng-disabled=\\\"modifyOrderItems.length === 0\\\"> {{::lang.values.discardChanges}} </button> </div> </div> </div> \";","module.exports = \"<div ng-controller=MobileNavController> <div class=mobile-nav ng-class=\\\"{\\n      'hide-search-space': inCheckoutOrList,\\n      'with-background': useAngularHeader &&  (!config.dotComModule.enableHeaderFooterSync || headerSyncError) && !dotComHeaderIsLoading\\n    }\\\" ng-click=mobileNavHeaderClick()> <div class=banner-row ng-if=hasShowableBanners()> <div ng-repeat=\\\"headerBanner in headerBanners | reverse track by $index\\\" ng-class=headerBanner.media.cssClass ng-if=\\\"headerBanner.media.text || headerBanner.media.image\\\" class=banner ng-click=\\\"logPromotedPlacement(headerBanner, 'Header Banner', $index)\\\" role=region aria-label={{::lang.aria.headerBanner}}> <a ng-href={{headerBanner.target.url}} ng-switch=headerBanner.media.type id=nav-header-banner-{{headerBanner.id}} class=fullwidth-focusable-outline-offset ng-click=\\\"acknowledgeHeaderBanner(headerBanner, !!headerBanner.target.dismissOnClick)\\\" aria-label=\\\"{{headerBanner.media.alt_text || headerBanner.media.text}}\\\" ng-attr-target=\\\"{{ bannerTarget(headerBanner.target) }}\\\" analytics-click=\\\"['header banner link', 'click', headerBanner.id, headerBanner.target.url]\\\" data-test=header-banner tabindex=0> <span ng-switch-when=text class=text>{{headerBanner.media.text}}</span> <img ng-switch-when=image class=image ng-src={{imageTransform(headerBanner.media.image)}} alt={{headerBanner.media.alt_text}} /> </a> <button id=nav-acknowledge-header-banner-mobile-{{headerBanner.id}} aria-label=Close class=\\\"close smaller icon-delete\\\" ng-class=\\\":: { 'add-text-shadow': (headerBanner.media.type !== 'text') }\\\" ng-click=acknowledgeHeaderBanner(headerBanner)> </button> </div> </div> <modify-order-banner></modify-order-banner> <div class=\\\"top-row mobile-header-sync\\\" ng-if=\\\"!forceDefaultHeaderOnMobileWeb && !(mobileService.isMobileApp() && config.forceDefaultHeaderOnMobileApp) && (config.dotComModule.enableHeaderFooterSync && !headerSyncError) && useAngularHeader\\\"> <div data-test=cms-mobile-header bind-html-compile=dotComHeader after-compile-handler=afterHeaderLoaded></div> </div> <div data-test=app-mobile-header ng-if=\\\"forceDefaultHeaderOnMobileWeb || (mobileService.isMobileApp() && config.forceDefaultHeaderOnMobileApp) || (!config.dotComModule.enableHeaderFooterSync || headerSyncError) && useAngularHeader\\\"> <div ng-if=!showAltNavBar class=\\\"top-row with-background\\\" ng-class=\\\"{'searching': searching}\\\"> <react-mobile-menu-with-express-popover ng-click=mobileNavService.showSlideOutMenu()></react-mobile-menu-with-express-popover> <unata-mobile-header-home-button ng-if=::config.enableMobileHeaderHomeButton></unata-mobile-header-home-button> <unata-shopping-selector-nav></unata-shopping-selector-nav> <button type=button ng-if=\\\"auth.getContext().intent == 'instore' && config.hasLoyalty && !config.disableLoyaltyLinks && !hideSearch && !hideLoyaltyCard\\\" class=\\\"inner-link loyalty-card-button\\\" ng-click=openLoyalty() aria-label={{::lang.values.myRewards}}> <i class=icon-rewards aria-hidden=true></i> </button> <button ng-if=hideSearch class=\\\"inner-link search-button\\\" ng-click=focusSearch() aria-label=Search aria-controls=\\\"{{ showSearchBar() ? 'mobile-search-bar' : '' }}\\\" aria-expanded=\\\"{{ showSearchBar() ? 'true' : 'false' }}\\\"> <span class=icon-search aria-hidden=true></span> </button> <unata-nav-cart></unata-nav-cart> </div> <div ng-if=showAltNavBar class=\\\"top-row with-background\\\" ng-class=\\\"{'searching': searching}\\\"> <button ng-if=\\\"::!config.enableMobileMenuButtonPostCheckout && !inCheckoutConfirmationPage\\\" class=go-back-link ng-click=goBack($event) aria-label=\\\"Go back to previous page\\\"> <span class=icon-chevron-left aria-hidden=true></span> </button> <button ng-if=::config.enableMobileMenuButtonPostCheckout class=menu-toggle ng-click=mobileNavService.showSlideOutMenu() aria-label=\\\"Main Menu\\\"></button> <unata-mobile-header-home-button ng-if=::config.enableMobileHeaderHomeButton></unata-mobile-header-home-button> <h1 class=mobile-nav-top-row-header> <span ng-if=inInstoreListPage>{{::(config.shoppingSelector.instore.shortTitle || config.shoppingSelector.instore.title)}}</span> <span ng-if=inCheckoutCartPage>{{::lang.values.cart}}</span> <span ng-if=inDedicatedCheckoutFlow>{{::lang.values.checkout}}</span> </h1> <button ng-if=\\\"auth.getContext().intent == 'instore' && config.hasLoyalty && !hideLoyaltyCard\\\" class=\\\"inner-link loyalty-card-button\\\" ng-click=openLoyalty() aria-label={{::lang.values.myRewards}}> <i class=icon-rewards aria-hidden=true></i> </button> <button ng-if=\\\"!inCheckoutOrList && hideSearch\\\" class=\\\"inner-link search-button\\\" ng-click=focusSearch() aria-label=Search aria-controls=\\\"{{ showSearchBar() ? 'mobile-search-bar' : '' }}\\\" aria-expanded=\\\"{{ showSearchBar() ? 'true' : 'false' }}\\\"> <span class=icon-search aria-hidden=true></span> </button> <button ng-if=\\\"inListOrCartPage || config.enableSearchInCartReview\\\" class=\\\"mobile-right-search-button search-button\\\" ng-click=focusSearch() aria-label=Search aria-controls=\\\"{{ showSearchBar() ? 'mobile-search-bar' : '' }}\\\" aria-expanded=\\\"{{ showSearchBar() ? 'true' : 'false' }}\\\"> <span class=icon-search aria-hidden=true></span> </button> </div> </div> <div ng-if=showSearchBar() class=mobile-search-bar id=mobile-search-bar ng-class=\\\"{ 'hide-search': hideSearch, 'searching': searching }\\\"> <unata-search-nav set-searching-to=setSearchingTo(newValue) focus-search-bar=focusSearchBar is-searching=searching search-term=searchTerm></unata-search-nav> </div> <div class=nav-backdrop ng-class=\\\"{show: searching}\\\" ng-click=focusSearch()></div> </div> <a class=close-button ui-sref=main.shop.categories ng-if=isCloseButtonVisible() aria-label={{::lang.values.close}}></a> </div> \";","/**\n * Converts normal seconds number into an ISO-8601 readable format.\n * @param {number} seconds\n */\nconst formatSecondsToISO8601 = seconds => (seconds ? `PT${seconds}S` : undefined)\n\nexport default formatSecondsToISO8601\n","import formatSecondsToISO8601 from './formatSecondsToISO8601'\nimport { setJsonLdInHead, getCurrentJsonLd } from './jsonLd'\n\n/**\n * Add script tag to head for product structured data\n *\n * @param {Object} product\n * @param {String} clientName\n */\n\nexport const appendProductStruturedData = (product, clientName = '') => {\n  const scriptEl = getCurrentJsonLd()\n\n  const data = {\n    '@context': 'https://schema.org/',\n    '@type': 'Product',\n    name: product.name,\n    image: Object.values(product.images?.tile || []),\n    description: product.description || `${product.name} on ${clientName}`,\n    sku: product.ext_id,\n    brand: {\n      '@type': 'Brand',\n      name: product.brand_name,\n    },\n    aggregateRating: {\n      '@type': 'AggregateRating',\n      ratingValue: product.product_rating.average_rating,\n      reviewCount: product.product_rating.user_count,\n    },\n  }\n\n  setJsonLdInHead(scriptEl, data)\n}\n\n/**\n * Add script tag to head for recipe structured data\n *\n * @param {Object} recipe\n * @param {String} clientName\n */\nexport const appendRecipeStruturedData = (recipe, clientName = '') => {\n  const scriptEl = getCurrentJsonLd()\n\n  const caloriesQuantity = recipe.nutrients?.find(({ name }) => name === 'Calories')?.quantity\n\n  const data = {\n    '@context': 'https://schema.org/',\n    '@type': 'Recipe',\n    name: recipe.name,\n    image: [recipe.media[0]?.image?.header],\n    author: {\n      '@type': 'Organization',\n      name: clientName,\n    },\n    description: recipe.description || `${recipe.name} Recipe from ${clientName}`,\n    prepTime: `${recipe.preparation_information.preparation_time}`,\n    // keywords: recipe.categories?.reverse()[0].name, // TODO: Figure out how to do keywords\n    recipeYield: recipe.preparation_information.serving_size,\n    recipeCategory: [...recipe.categories]?.reverse()[0]?.name || '',\n    // recipeCuisine: 'American', // TODO: Figure out how to do cuisine\n    recipeIngredient: recipe.ingredients,\n    recipeInstructions: recipe.directions,\n    aggregateRating: {\n      '@type': 'AggregateRating',\n      ratingValue: recipe.recipe_rating.average_rating,\n      ratingCount: recipe.recipe_rating.user_count,\n    },\n  }\n\n  if (caloriesQuantity) {\n    data.nutrition = {\n      '@type': 'NutritionInformation',\n      calories: `${caloriesQuantity} calories`,\n    }\n  }\n\n  if (recipe.preparation_information?.preparation_time)\n    data.prepTime = formatSecondsToISO8601(recipe.preparation_information?.preparation_time)\n\n  if (recipe.preparation_information?.cook_time)\n    data.cookTime = formatSecondsToISO8601(recipe.preparation_information?.cook_time)\n\n  if (recipe.preparation_information?.total_time)\n    data.totalTime = formatSecondsToISO8601(recipe.preparation_information?.total_time)\n\n  setJsonLdInHead(scriptEl, data)\n}\n\nexport const appendItemListStructuredData = recipes => {\n  const scriptEl = getCurrentJsonLd()\n  const origin = window?.location?.origin || ''\n  const data = {\n    '@context': 'https://schema.org',\n    '@type': 'ItemList',\n    itemListElement: [],\n  }\n\n  Object.values(recipes)\n    .filter(recipe => recipe && recipe.id)\n    .forEach((recipe, idx) => {\n      if (recipe.href) {\n        data.itemListElement.push({\n          '@type': 'ListItem',\n          position: idx + 1,\n          url: `${origin}${recipe.href}`,\n        })\n      }\n    })\n\n  setJsonLdInHead(scriptEl, data)\n}\n"],"sourceRoot":""}